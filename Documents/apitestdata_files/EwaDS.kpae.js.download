(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1018:function(u,D,b){function a(N,H,Q){this.wQb=null;this.yF={};this.nRb=this.gx=null;l.ULS.sendTraceTag(537159566,0,50,"BorderFormatManager: Request new instance");this.$=N;this.t3d=a.Y4c;this.u3d=a.borderStyleSolidLine;this.Gg=H;this.Va=Q;A.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")||this.$.da.Ga(296,this);this.CU=new c(this.$,this.Gg);this.NC=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",
!1);l.ULS.sendTraceTag(537159565,0,50,"BorderFormatManager: register BorderFormatManager with ServiceName {0}","296")}function c(N,H){var Q=this;this.jGb=this.ribbonCommandInfo=this.cellFormat=this.Dr=this.qb=this.ha=null;this.Erc=!1;this.QHf=this.pLa=this.YHf=this.g7d=this.bza=this.pma=null;this.A0b=this.Mta=this.XHf=0;this.borderStyle=this.HZa=this.borderColor=null;this.jB=!1;this.J0a=this.P$a=null;this.g0=function(){if(!Q.jB||J.g(Q.$).mz)Q.jB=!1,J.g(Q.$).mz=!1,Q.Mta=0,J.g(Q.$).ig.zo(w.a.m4),1===
Q.$.Ka.dH()&&(J.g(Q.$).fV(y.a.clone(Q.YHf),Q.XHf,Q.$.pa?Q.$.pa.sheetName:null,null,Q.QHf.clone(),null,null,0,K.a.Rhh,!0),J.g(Q.$).RRa(!0)),Q.tv(),Q.bXd(),Q.Uj(),Q.Erc=!1,Q.pma=null,Q.bza=null,Q.Dr&&(Q.Dr.cancel(),Q.Dr.dispose()),l.ULS.sendTraceTag(537159516,0,50,"DrawBorderBehavior.ResetBehavior : Ending ResetBehavior ")};this.onPointerDown=function(ca){try{if(ca=Q.Sd(ca),J.g(Q.$).mz=!0,Q.pma={},Q.bza={},Q.P$a=null,Q.Pob(Q.A0b),2===ca.mb){var X=J.g(Q.$).ha.Kn(ca.clientPoint,ca.zb,5,void 0,void 0,
!1);X&&(Q.pLa=X,Q.J0a=X,Q.M7i())}}catch(Z){J.g(Q.$).mz=!1}return!0};this.xh=function(ca){try{ca=Q.Sd(ca);var X=J.g(Q.$).ha.Kn(ca.clientPoint,ca.zb,5,void 0,void 0,!1),Z=J.g(Q.$).Ea.Mr(X);if(!Q.jGb||Z&&(Z.YJ!==Q.jGb.YJ||Z.XJ!==Q.jGb.XJ))if(Q.jB=!0,Q.jGb=Z,X){var ea=new I.Range(Q.pLa.top,Q.pLa.left,Q.pLa.top,Q.pLa.left,!0,!1);ea.union(X);ea=J.g(Q.$).ha.KUh(ea);Q.E0b(X);Q.WSf(Q.P$a,ea);if(Q.bottomRightCorner(ea.bottom,ea.right))return l.ULS.sendTraceTag(537159515,0,15,"DrawBorderBehavior.OnPointerMove - Bottom-right corner of sheet reached, cannot expand further."),
!1;var ka=new I.Range(ea.top,ea.left,ea.bottom+1,ea.right+1,!0,!1),Y=J.g(Q.$).H$("DrawBorderBehavior.OnPointerMove",[ka]);if(Q.pma&&Q.bza)for(;Y.$$mn();){var qa=Y.$$cu(),fa=qa.cell.getRange().toString();fa in Q.pma&&1!==Q.Mta||(Q.pma[fa]=qa,Q.bza[fa]=qa.cell.zM())}Q.P$a=ka;Q.J0a=ea;J.g(Q.$).fV([ea],0,Q.$.pa.sheetName,null,ea.topLeft,null,null,0,K.a.Ohh,!0);Q.Gg.Mda(J.g(Q.$),-1690267012,Q.cellFormat,!0,null,[ea])}return!0}catch(ha){return J.g(Q.$).mz=!1}};this.pf=function(ca){ca=Q.Sd(ca);(ca=J.g(Q.$).ha.Kn(ca.clientPoint,
ca.zb,5,void 0,void 0,!1))?Q.jB&&(Q.E0b(ca),Q.pLa.union(ca),3===Q.Mta?Q.Pob(0):Q.Pob(Q.A0b),J.g(Q.$).fV([Q.pLa],0,Q.$.pa.sheetName,null,null,null,null,0,K.a.Phh,!0),Q.Gg.formatCells(-1690267012,Q.cellFormat,Q.ribbonCommandInfo)):(3===Q.Mta?Q.Pob(0):Q.Pob(Q.A0b),J.g(Q.$).fV([Q.J0a],0,Q.$.pa.sheetName,null,null,null,null,0,K.a.Qhh,!0),Q.Gg.formatCells(-1690267012,Q.cellFormat,Q.ribbonCommandInfo));Q.jB=!1;Q.bXd();Q.pma=null;Q.bza=null;return!0};this.onKeyDown=function(ca){ca=Q.Sd(ca);if(Q.jB||Array.contains([17,
16,18,20],ca.Ca.keyCode))return!0;Q.g0();return!1};this.onKeyUp=function(ca){ca=Q.Sd(ca);if(ca.Ca.keyCode===x.a.lL&&Q.jB)return Q.jB=!1,Q.WSf(Q.P$a,Q.J0a,!0),Q.bXd(),!0;if(Q.jB||ca.Ca.keyCode===x.a.Z7||ca.Ca.keyCode===x.a.g0d||ca.Ca.keyCode===x.a.f0d||Array.contains([17,16,18,20,37,39,38,40,33,34,9,13],ca.Ca.keyCode)||ca.Ca.keyCode===x.a.Ejg||ca.Ca.keyCode===x.a.Ajg||ca.Ca.keyCode===x.a.wjg)return!0;Q.g0();return!1};this.oR=function(ca,X){J.g(Q.$).mz&&!Array.contains(Q.H7h,X.Ed.command)&&(l.ULS.sendTraceTag(537159512,
0,50,"DrawBorderBehavior.OnCommandExecutionStarting : Command Triggered : {0} ",X.Ed),Q.g0())};this.$=N;this.Gg=H}function d(N){N.ANf()}function e(){this.iconName=this.title=this.key=null}function k(N,H,Q,ca,X,Z,ea,ka){this.flg=N;this.glg=H;this.elg=Q;this.sga=ca;this.Hwg=X;this.Psg=Z;this.pjb=ea;this.Org=ka}b.r(D);u=b(0);var l=b(15),m=b(1025),f=b(934),w=b(5),n=b(76),z=b(53),r=b(203),v=b(34),A=b(1),B=b(14);k.JPg=function(){return new k("BorderStyleSolidLine",1933,1,"1","",1,8,0)};k.FPg=function(){return new k("BorderStyleDashedLine",
1934,3,"1","5,3",1,8,0)};k.GPg=function(){return new k("BorderStyleDottedLine",1935,4,"1","1,1",1,8,0)};k.IPg=function(){return new k("BorderStyleMediumLine",1936,2,"2","",1,8,0)};k.KPg=function(){return new k("BorderStyleThickLine",1937,5,"3","",1,8,0)};k.HPg=function(){return new k("BorderStyleDoubleLine",1938,6,"1","",2,8,3)};Af.Object.defineProperties(k.prototype,{ste:{configurable:!0,enumerable:!0,get:function(){return this.flg}},y0b:{configurable:!0,enumerable:!0,get:function(){return this.glg}},
rte:{configurable:!0,enumerable:!0,get:function(){return this.elg}},width:{configurable:!0,enumerable:!0,get:function(){return this.sga}},MFj:{configurable:!0,enumerable:!0,get:function(){return this.Hwg}},QEi:{configurable:!0,enumerable:!0,get:function(){return this.Psg}},lineHeight:{configurable:!0,enumerable:!0,get:function(){return this.pjb}},csi:{configurable:!0,enumerable:!0,get:function(){return this.Org}}});Object(u.a)(k,"BorderLineStyleProperties",null,[]);Object(u.a)(e,"BorderLineStyleProps",
null,[]);d.prototype.getBorderLineStyleProps=function(){var N=b(1018).BorderFormatManager.GZa,H=Array(Object.keys(N).length),Q=0,ca;for(ca in N){var X=ca,Z=N[ca];H[Q]=new e;H[Q].key=X;X=Z;H[Q].title=B.a.instance.ga(X.y0b);H[Q].iconName=X.ste;Q++}return H};Object(u.a)(d,"BorderMenuController",null,[697]);var y=b(279),x=b(86),C=b(245),G=b(13),E=b(109),I=b(24),U=b(47),M=b(44),T=b(217),F=b(10),K=b(95),J=b(21),O=b(33);c.prototype.nzg=function(N){l.ULS.sendTraceTag(537159517,0,50,"DrawBorderBehavior.ActivateBehavior : Starting ActivateBehavior ");
this.ha=J.g(this.$).ha;this.qb=J.g(this.$).qb;this.ribbonCommandInfo=N;this.YHf=y.a.clone(this.ha.sa.selectedRanges);this.XHf=this.ha.sa.Xs;this.QHf=this.ha.sa.activeCell.clone();this.qb&&this.qb.Vid();this.ev();this.Ti()};c.prototype.dispose=function(){this.g0();this.jGb=this.ribbonCommandInfo=this.cellFormat=null};c.prototype.Pob=function(N){var H=b(1018).BorderFormatManager;this.cellFormat={};var Q={};this.borderColor=this.borderColor||H.Y4c;var ca=r.a.ZG(this.borderColor,!1);Q.Color=[ca,ca,ca,
ca];A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&this.HZa&&(Q.ThemeBorderColor=[this.HZa,this.HZa,this.HZa,this.HZa],Q.ColorTypeOption=1);ca=b(1018).BorderFormatManager.GZa;this.borderStyle=this.borderStyle||H.borderStyleSolidLine;H=ca[this.borderStyle].rte;Q.LineStyle=[H,H,H,H];this.cellFormat.BorderFormat=Q;this.cellFormat.ValidMembers=128;this.cellFormat.Border=N};c.prototype.ev=function(){for(var N=ak(J.g(this.$).hn),H=N.next();!H.done;H=N.next())C.a.instance.qa(G.a.pointerDown,
H.value.domElement,this.onPointerDown);E.KeyInputManager.instance.qa(G.a.Lb,document.documentElement,this.onKeyDown);E.KeyInputManager.instance.qa(G.a.Gd,document.documentElement,this.onKeyUp)};c.prototype.M7i=function(){for(var N=ak(J.g(this.$).hn),H=N.next();!H.done;H=N.next())H=H.value,C.a.instance.qa(G.a.hh,H.domElement,this.xh),C.a.instance.qa(G.a.Nd,H.domElement,this.pf);C.a.instance.qa(G.a.Nd,document.documentElement,this.pf);C.a.instance.qa(G.a.my,document.documentElement,this.pf);this.Erc=
!0};c.prototype.tv=function(){try{for(var N=ak(J.g(this.$).hn),H=N.next();!H.done;H=N.next())C.a.instance.Aa(G.a.pointerDown,H.value.domElement,this.onPointerDown);E.KeyInputManager.instance.Aa(G.a.Lb,document.documentElement,this.onKeyDown);E.KeyInputManager.instance.Aa(G.a.Gd,document.documentElement,this.onKeyUp)}catch(Q){J.g(this.$).mz=!1,l.ULS.sendTraceTag(537159514,0,10,"DrawBorderBehavior.UnregisterHandlers: Unregistering of Handlers failed with Exception {0}",Q)}};c.prototype.bXd=function(){if(this.Erc)try{this.Erc=
!1;for(var N=ak(J.g(this.$).hn),H=N.next();!H.done;H=N.next()){var Q=H.value;C.a.instance.Aa(G.a.hh,Q.domElement,this.xh);C.a.instance.Aa(G.a.Nd,Q.domElement,this.pf)}C.a.instance.Aa(G.a.Nd,document.documentElement,this.pf);C.a.instance.Aa(G.a.my,document.documentElement,this.pf)}catch(ca){J.g(this.$).mz=!1,l.ULS.sendTraceTag(537159513,0,10,"DrawBehavior.UnregisterDrawHandlersForMouse: Unregistering of Handlers failed with Exception {0}",ca)}};c.prototype.Ti=function(){this.$.va.Kf(this.g0);J.g(this.$).Wb.Bk(this.g0);
J.g(this.$).XD(this.g0);this.$.Ka.yFa(this.oR)};c.prototype.Uj=function(){this.$.va.wg(this.g0);J.g(this.$).Wb.wk(this.g0);J.g(this.$).DF(this.g0);this.$.Ka.Cza(this.oR)};c.prototype.WSf=function(N,H,Q){Q=void 0===Q?!1:Q;if(N&&this.pma&&this.bza)for(N=J.g(this.$).H$("DrawBorderBehavior.ApplyBordersOnPreviewCells",[N]);N.$$mn();){var ca=N.$$cu().cell.getRange();if(Q||!H.contains(ca)||1===this.Mta){ca=ca.toString();var X=v.a.zc(this.pma,ca);if(X){var Z=v.a.zc(this.bza,ca);this.setBorders(X,Z);delete this.pma[ca];
delete this.bza[ca]}}}};c.prototype.setBorders=function(N,H){var Q=N.cell,ca=Q.getRange();Q.Nab();ca.right!==this.P$a.right&&(Q=new I.Range(ca.top,ca.left-1,ca.bottom,ca.left-1,!0,!1),J.g(this.$).Ea.Mr(Q).RPa(3));ca.bottom!==this.P$a.bottom&&(Q=new I.Range(ca.top-1,ca.left,ca.top-1,ca.right,!0,!1),J.g(this.$).Ea.Mr(Q).RPa(1));if(null===H||void 0===H?0:H.Borders.length){var X={};Q=0;for(var Z=Array(4),ea=Array(4),ka=0;4>ka;ka++)Z[ka]=1,ea[ka]=0;H=ak(H.Borders);for(ka=H.next();!ka.done;ka=H.next()){ka=
ka.value;var Y=ka.BorderPosition;Z[Y]=ka.BorderLineStyle;var qa=new T.a(ka.Color.Red,ka.Color.Green,ka.Color.Blue);ea[Y]=qa.nS();Q|=F.HelperMethods.h3a(ka.BorderPosition)}X.LineStyle=Z;X.Color=ea;X={BorderFormat:X};X.Border=Q;this.Gg.Qrj(N,X,ca)}};c.prototype.E0b=function(N){var H=this,Q=new I.Range(Math.max(1,N.top-1),Math.max(1,N.left-1),N.bottom+1,N.right+1,!1,!1);J.g(this.$).YQ(Q)||this.Dr&&this.Dr.Qp||(this.Dr=U.a.instance.create(function(){J.g(H.$).hr(Q,60,K.a.Mhh)},40,M.a.Nhh))};c.prototype.bottomRightCorner=
function(N,H){return 1048576<=N||16384<=H?!0:!1};c.prototype.Sd=function(N){return O.a(this.$).Sd(N)};Af.Object.defineProperties(c.prototype,{H7h:{configurable:!0,enumerable:!0,get:function(){return this.g7d||(this.g7d=[1256700402,-1756763834,-1418159950,-236759591,-2118943501,1981159862,395594266,-1502853784,-111689794,-1059615499,-1027730316,-1104934572,1872288872,2045211913,1504715724,46555851,-70383382,-28797232])}}});Object(u.a)(c,"DrawBorderBehavior",null,[10]);b.d(D,"BorderFormatManager",function(){return a});
a.prototype.h4e=function(N,H){l.ULS.sendTraceTag(537159564,0,50,"HandleBorderCommand : Begin handling, Command being executed: {0}",H.command.toString());var Q={},ca={};var X=r.a.ZG(this.h3,!1);ca.Color=[X,X,X,X];this.NC&&this.fta&&(ca.ThemeBorderColor=[this.fta,this.fta,this.fta,this.fta],ca.ColorTypeOption=1);N=-600086683===H.command?"OutsideBorders":N[n.a.Nc];ca.LineStyle=v.a.zc(a.aHf,N);ca.LineStyle?l.ULS.sendTraceTag(537159562,0,50,"RibbonCommand.Border is using the BorderFormat information, the predefined borderStyle requested is {0}",
N):(X=a.GZa[this.EHa].rte,ca.LineStyle=[X,X,X,X],l.ULS.sendTraceTag(537159563,0,50,"RibbonCommand.Border is using the BorderFormat information, the custom borderStyle requested is {0}",this.EHa));X=v.a.Wp(a.GOg,N,0);l.ULS.sendTraceTag(40732555,0,50,"RibbonCommand.Border is using the BorderFormat information, the border type requested is {0}, the border color selected is {1}",N,this.h3);Q.BorderFormat=ca;4!==X&&8!==X||!this.$.pa.displayRtl||(X=4===X?8:4);Q.ValidMembers=128;Q.Border=X;this.Gg.formatCells(-1690267012,
Q,H);l.ULS.sendTraceTag(537159561,0,50,"HandleBorderCommand : Successfully handled, Command executed: {0}",H.command.toString());return!0};a.prototype.ghd=function(N,H,Q){l.ULS.sendTraceTag(537159560,0,50,"RibbonCommand:{0} is being executed, the previous border color is {1}",N.toString(),this.h3);if(this.NC){if((H.SqmControlId||"").includes("ThemeColorPicker")){var ca=this.themesManager.getThemeColor(H.Color);var X=ca.themeIndex;var Z=ca.cBa;ca.returnValue?(this.nRb={},this.fta.ThemeColorIndex=X,
this.fta.ThemeColorRow=Z):this.nRb=null}else this.nRb=null;this.CU.HZa=this.fta}this.t3d=-1803452024===N?a.Y4c:H.Color;this.CU.borderColor=this.h3;this.kKe(Q);this.$.jf();l.ULS.sendTraceTag(40944211,0,50,"RibbonCommand:{0} is being executed, the updated border color is {1}",N.toString(),this.h3);return!0};a.prototype.b3h=function(N){l.ULS.sendTraceTag(537159559,0,50,"RibbonPopulateCommand.PopulateBorderStyle command Invoked");var H=this.Va.mq(),Q=this.Va.Bc();H.pc.push(Q);var ca=this.Va.qC("StyleDashGallery",
1,"Size120by20");Q.buttons.push(ca);Q=a.GZa;for(var X in Q){var Z=X,ea=Q[X],ka=B.a.instance.ga(ea.y0b);ca.Dt(Z,-2118943501,"QueryBorderStyle",ea.y0b,Z,Z,void 0,void 0,ka)}l.ULS.sendTraceTag(537159557,0,50,"RibbonPopulateCommand, Invoke BuildMenuProps");N.MenuItems=H.eE();l.ULS.sendTraceTag(537159556,0,50,"RibbonPopulateCommand handled")};a.prototype.z1h=function(N,H){l.ULS.sendTraceTag(537159555,0,50,"RibbonCommand.BorderStyle: Begin handling, Current Border Style is {0}",this.EHa);N=N[n.a.Nc];if(a.boi(N))this.u3d=
N,l.ULS.sendTraceTag(537159554,0,50,"RibbonCommand.BorderStyle: Updated Border Style is {0}",this.EHa);else return l.ULS.sendTraceTag(537159553,0,15,"RibbonCommand.BorderStyle: Invalid Border Style encountered, Requested Border Style : {0}",N),!0;this.CU.borderStyle=this.EHa;this.kKe(H);this.$.jf();l.ULS.sendTraceTag(40944220,0,50,"RibbonCommand.BorderStyle: Successfully handled Current Border Style is {0}",this.EHa);return!0};a.prototype.lhd=function(N){l.ULS.sendTraceTag(537159552,0,50,"HandleDrawBorderCommand : Begin handling, Command being executed: {0}",
N.command.toString());this.$Sc(N,64,this.h3,108,1);return!0};a.prototype.mhd=function(N){l.ULS.sendTraceTag(537159523,0,50,"HandleDrawBorderGridCommand : Begin handling, Command being executed: {0}",N.command.toString());this.$Sc(N,112,this.h3,109,2);return!0};a.prototype.u4e=function(N){l.ULS.sendTraceTag(537159522,0,50,"HandleEraseBorderCommand : Begin handling, Command being executed: {0}",N.command.toString());this.$Sc(N,112,"white",110,3);return!0};a.prototype.f3h=function(N){this.yqj(this.IOg,
N,N.MenuItemId?N.MenuItemId:a.borderStyleSolidLine)};a.prototype.yqj=function(N,H,Q){Q in N?(N=N[Q],l.ULS.sendTraceTag(537159521,0,50,"HandleQueryBorderStyleCommand:SetIcon command {0}",Q),this.Aqj(H,N)):l.ULS.sendTraceTag(537159520,0,15,"HandleQueryBorderStyleCommand: cannot find dashes '{0}' in BorderLineStyleButtons dictionary",Q)};a.prototype.q3h=function(N,H){var Q=N[n.a.Nc];return"DrawBorder"===Q?this.lhd(H):"DrawBorderGrid"===Q?this.mhd(H):"EraseBorder"===Q?this.u4e(H):this.h4e(N,H)};a.prototype.ANf=
function(){this.wQb||this.LPg()};a.prototype.WIh=function(){return new d(this)};a.prototype.LPg=function(){this.wQb={};var N=0,H=a.GZa,Q={},ca;for(ca in H){Q.Cea=H[ca];var X=Q.Cea.ste;B.a.instance.ga(Q.Cea.y0b);var Z=function(ea){return function(){return appChrome.buildBorderStyleIconNew(ea.Cea.MFj,ea.Cea.width,ea.Cea.QEi,ea.Cea.lineHeight,ea.Cea.csi)}}(Q);this.wQb[X]=X;this.Gab(X,Z);N++;Q={Cea:Q.Cea}}};a.prototype.Gab=function(N,H){if(!(N in this.yF)){var Q={};H=H();Q[N]=H;appChrome.api.registerIconProvider(function(){return Q});
this.yF[N]=!0}return N};a.prototype.Aqj=function(N,H){N.MenuItemId&&(N[m.a.On]=N.MenuItemId===this.EHa,N[f.a.Icon]=H)};a.prototype.$Sc=function(N,H,Q,ca,X){l.ULS.sendTraceTag(537159519,0,50,"BorderFormatManager.ActivateDrawBorderBehavior : Starting ActivateDrawBorderBehavior ");this.CWg(N,X)?(l.ULS.sendTraceTag(537159518,0,50,"BorderFormatManager.CheckDrawBorderBehaviorTriggered : Toggled Ribbon menu button "),this.CU.g0()):(J.g(this.$).mz&&this.CU.g0(),z.a.current&&(ca=String.format(w.a.kta,z.a.current.Uo(ca)),
J.g(this.$).ig.zo(ca)),this.CU.A0b=H,this.CU.borderColor=Q,J.g(this.$).mz=!0,this.CU.nzg(N),this.CU.Mta=X)};a.prototype.kKe=function(N){if(N)switch(this.CU.Mta){case 2:this.mhd(N);break;default:this.lhd(N)}};a.prototype.CWg=function(N,H){return this.CU.Mta===H&&-236759591!==N.command&&-2118943501!==N.command?!0:!1};a.boi=function(N){return N?N in a.aHf||N in a.GZa:!1};Af.Object.defineProperties(a.prototype,{EHa:{configurable:!0,enumerable:!0,get:function(){return this.u3d}},h3:{configurable:!0,enumerable:!0,
get:function(){return this.t3d}},fta:{configurable:!0,enumerable:!0,get:function(){return this.nRb}},themesManager:{configurable:!0,enumerable:!0,get:function(){this.gx||(this.gx=this.$.da.za(422));return this.gx}},IOg:{configurable:!0,enumerable:!0,get:function(){this.ANf();return this.wQb}}});Af.Object.defineProperties(a,{GZa:{configurable:!0,enumerable:!0,get:function(){var N={};return a.F1d||(a.F1d=(N.BorderStyleSolidLine=k.JPg(),N.BorderStyleDashedLine=k.FPg(),N.BorderStyleDottedLine=k.GPg(),
N.BorderStyleMediumLine=k.IPg(),N.BorderStyleThickLine=k.KPg(),N.BorderStyleDoubleLine=k.HPg(),N))}},GOg:{configurable:!0,enumerable:!0,get:function(){var N={};return a.E1d||(a.E1d=(N.NoBorder=0,N.BottomBorder=1,N.TopBorder=2,N.LeftBorder=4,N.RightBorder=8,N.OutsideBorders=64,N.AllBorders=112,N.ThickOutsideBorders=64,N.InsideBorders=48,N.InsideHorizontalBorders=16,N.InsideVerticalBorders=32,N.BottomDoubleBorder=1,N.ThickBottomBorder=1,N.TopBottomBorder=3,N.TopThickBottomBorder=3,N.TopDoubleBottomBorder=
3,N))}},aHf:{configurable:!0,enumerable:!0,get:function(){var N={};return a.Zce||(a.Zce=(N.ThickOutsideBorders=[2,2,2,2],N.BottomDoubleBorder=[1,6,1,1],N.ThickBottomBorder=[1,2,1,1],N.TopBottomBorder=a.pch,N.TopThickBottomBorder=[1,2,1,1],N.TopDoubleBottomBorder=[1,6,1,1],N))}}});a.E1d=null;a.F1d=null;a.Zce=null;a.Y4c="black";a.borderStyleSolidLine="BorderStyleSolidLine";a.pch=[1,1,1,1];Object(u.a)(a,"BorderFormatManager",null,[600])},1048:function(u,D,b){function a(y,x,C){window.performance.measure(y,
x,C);x=window.performance.getEntriesByName(y);x.length||w.ULS.sendTraceTag(537167063,0,10,"ContextMenuHelper.MeasureTime: measure name [{0}] returned no measures.",y);return x[x.length-1]?x[x.length-1].duration:-1}function c(){if(n.a.Kob){var y=a("OnContextMenuHandling","ContextMenuPerf.A","ContextMenuPerf.B"),x=a("PrepInfraWork","ContextMenuPerf.B","ContextMenuPerf.C1"),C=a("EWAPopulation","ContextMenuPerf.C2","ContextMenuPerf.D");w.ULS.sendTraceTag(537167064,0,50,"ContextMenuHelper.ReportPerformanceIfSupported: OnContextMenuHandling=[{0}], PrepInfraWork=[{1}], EWAPopulation =[{2}]",
y,x,C)}}function d(y,x){A.HelperMethods.fYc&&window.performance.mark(x)}function e(y){y=B.g(y).ha.sa;return y.tg&&(y.Vc.isRow||y.Vc.Ue)}function k(y){return y.Ab.c5(y.ha.sa.activeCell)}function l(y,x,C,G,E){y=G.pk("ContextMenuHelper.FindFirstCellInViewportArea",y,x,C);try{for(y.$$rst();y.$$mn();){var I=y.$$cu();if(I&&m(I,G,E))return I.cell}}finally{y&&y.dispose()}return null}function m(y,x,C){var G=x.rtl,E=C.isChromeRtl;y=y.cell;return(C=B.g(C).OJ(y))?(C=C.topLeft,G=C.x+=G===E?y.offsetWidth:0,E=C.y+=
y.offsetHeight,x.view.visibleArea.contains(new r.a(G,E,0,0))):!1}function f(y,x){var C=y.Ub(null);if((null===C||void 0===C?0:C.cell.tk)&&m(C,y,x))return y.getCellBounds(C.cell);C=y.ha.sa.activeCell;return(x=l(new v.Range(C.top,C.left,z.a.vh,C.left,!1,!1),2,!0,y,x)||l(new v.Range(1,C.left,C.top,C.left,!1,!1),2,!1,y,x)||l(new v.Range(C.top,C.right,C.top,z.a.Eh,!1,!1),1,!0,y,x)||l(new v.Range(C.top,1,C.top,C.right,!1,!1),1,!1,y,x)||null)&&x.tk?y.getCellBounds(x):Sys.UI.DomElement.getBounds(y.N4a.jc)}
b.d(D,"i",function(){return"ContextMenuPerf.A"});b.d(D,"b",function(){return"ContextMenuPerf.B"});b.d(D,"d",function(){return"ContextMenuPerf.C1"});b.d(D,"a",function(){return"ContextMenuPerf.C2"});b.d(D,"c",function(){return"ContextMenuPerf.D"});b.d(D,"e",function(){return f});b.d(D,"f",function(){return k});b.d(D,"g",function(){return e});b.d(D,"h",function(){return d});b.d(D,"j",function(){return c});var w=b(15),n=b(334),z=b(8),r=b(60),v=b(24),A=b(10),B=b(21)},1049:function(u,D,b){function a(){}
b.d(D,"a",function(){return a});u=b(0);a.edit="Edit";a.clipboard="Clipboard";a.copy="Copy";a.color="Color";a.KMg="AutoFill";a.uij="RowOperations";a.TZg="ColumnOperations";a.eWj="ViewModeRowOperations";a.dWj="ViewModeColumnOperations";a.hyperlink="Hyperlink";a.openHyperlink="OpenHyperlink";a.Cuj="ShapeStyle";a.IBh="FloatingObjectClipboard";a.ZFf="PivotTableCopyDelete";a.aGf="PivotTableFieldListActions";a.zwe="CellFloatie";a.yuj="ShapeFloatie";a.contextMenu="ContextMenu";a.J0h="GridContextMenu";a.eYi=
"PivotTableContextMenu";a.JBh="FloatingObjectContextMenu";a.FVg="CellRTEFloatie";a.h0f="ShapeRTEFloatie";Object(u.a)(a,"FloatieGroupIdentifiers",null,[])},1050:function(u,D,b){function a(z,r,v){var A=n.call(this,r)||this;A.dR=!1;A.Cjc=!1;A.jNa=null;A._selectedRowListBox=null;A.Gn=null;A.Yxf=function(B){return A.onItemClick(B)};A.Uzd=function(B){f.g(B.Ca);A.raiseEvent(a.k4a);A.raiseEvent(a.ANd);return!0};A.onScroll=function(B){f.g(B);A.wFd();A.raiseEvent(a.k4a)};A.onBlur=function(B){f.g(B);A.wFd()};
A.onPointerDown=function(){A.wFd();A.raiseEvent(a.k4a);A.raiseEvent(a.ePa);return!1};A.jEb=function(B){var y=B.Ca;if(y.button===Sys.UI.MouseButton.leftButton||y.button===Sys.UI.MouseButton.rightButton||l.EwaSettings.isChangeGateEnabled("OfficeVSO:6154487_EnableTouchInputInDVDropDown")&&y.type.includes("touch"))A.Pk=A.dac(y),A.onPointerDown(B);A.raiseEvent(a.brd);return!1};A.jb=z;A.qBb=v;A.PAa(!0);return A}b.d(D,"a",function(){return a});u=b(0);var c=b(90),d=b(233),e=b(13),k=b(245);D=b(244);var l=
b(1),m=b(12),f=b(69),w=b(21),n=D.a;Rk(a,n);a.prototype.C9=function(z){this.get_events().addHandler(a.k4a,z)};a.prototype.gda=function(z){this.get_events().removeHandler(a.k4a,z)};a.prototype.eZb=function(z){this.get_events().addHandler(a.Njd,z)};a.prototype.wsc=function(z){this.get_events().removeHandler(a.Njd,z)};a.prototype.hnb=function(z){this.get_events().addHandler(a.ANd,z)};a.prototype.$Hb=function(z){this.get_events().removeHandler(a.ANd,z)};a.prototype.xYa=function(z){this.get_events().addHandler(a.ePa,
z)};a.prototype.dbb=function(z){this.get_events().removeHandler(a.ePa,z)};a.prototype.HUc=function(z){this.get_events().addHandler(a.brd,z)};a.prototype.BId=function(z){this.get_events().removeHandler(a.brd,z)};a.prototype.dispose=function(){this.B7(!1);this.PAa(!1);c.a.oc([this.jNa]);this.jNa=null;n.prototype.dispose.call(this)};a.prototype.dac=function(z){return m.DOMElementExtensions.udd(z.target,"tr",!0)};a.prototype.pB=function(z){if(z){if(!this.Pk){var r=this.Gn;if(!r||!r.rows.length)return;
this.Pk=r.rows[0];0<z?z--:z++}r=this.Pk;for(var v=0,A=Math.abs(z);v<A;v++)if(0>z){if(!r.previousSibling)break;r=r.previousSibling}else{if(!r.nextSibling)break;r=r.nextSibling}r&&(this.Pk=r)}};a.prototype.Omb=function(z,r){m.DOMElementExtensions.toggleCssClass(z,this.qBb.ListTableClassInTouch,r)};a.prototype.B7=function(z){var r=this.Gn;r&&(z&&!this.Cjc?(d.a.instance.qa(e.a.click,r,this.Yxf),d.a.instance.qa(e.a.$j,r,this.Uzd),k.a.instance.qa(e.a.pointerDown,r,this.jEb),this.Cjc=!0):this.Cjc&&(d.a.instance.Aa(e.a.click,
r,this.Yxf),d.a.instance.Aa(e.a.$j,r,this.Uzd),k.a.instance.Aa(e.a.pointerDown,r,this.jEb),this.Cjc=!1))};a.prototype.iBa=function(z){var r=null;z&&(r=m.DOMElementExtensions.Cj(z,this.qBb.ListCellClass))&&r.classList.toggle(this.qBb.ListCellSelectedClass);return r};a.prototype.PAa=function(z){this.Qf&&(z&&!this.dR?(this.jNa=this.ke.Td(this.Qf),this.jNa.ka("scroll",this.onScroll),this.jNa.ka("blur",this.onBlur),k.a.instance.qa(e.a.pointerDown,this.domElement,this.onPointerDown),this.dR=!0):this.dR&&
(c.a.Ia(this.jNa),this.jNa=null,k.a.instance.Aa(e.a.pointerDown,this.domElement,this.onPointerDown),this.dR=!1))};a.prototype.onItemClick=function(z){return this.Uzd(z)};a.prototype.Duc=function(z){if(z){var r=z.offsetTop,v=this.Qf.scrollTop;r<v?this.QVf(!0):r+z.offsetHeight>v+this.Qf.clientHeight&&this.QVf(!1)}};a.prototype.QVf=function(z){this.Qf.scrollTop=z?this.Pk.offsetTop:this.Pk.offsetTop+this.Pk.offsetHeight-this.Qf.clientHeight};a.prototype.wFd=function(){w.g(this.$).isEditing&&this.raiseEvent(a.Njd)};
Af.Object.defineProperties(a.prototype,{Pk:{configurable:!0,enumerable:!0,get:function(){return this._selectedRowListBox},set:function(z){this.iBa(this._selectedRowListBox);z?(this._selectedRowListBox=z,this.iBa(this._selectedRowListBox),this.Duc(z)):this._selectedRowListBox=null}},m_:{configurable:!0,enumerable:!0,get:function(){return this.qBb.ListCellClass}},Uba:{configurable:!0,enumerable:!0,get:function(){return this.qBb.ListTableClass}},MH:{configurable:!0,enumerable:!0,get:function(){return 8}},
kCb:{configurable:!0,enumerable:!0,get:function(){return 5}},Bjc:{configurable:!0,enumerable:!0,get:function(){return 24}},Ajc:{configurable:!0,enumerable:!0,get:function(){return 35}},Qf:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},$:{configurable:!0,enumerable:!0,get:function(){return this.jb}}});a.k4a="GotFocus";a.Njd="IgnoreBlur";a.ANd="SetCell";a.ePa="PointerDown";a.brd="ItemPointerDown";Object(u.a)(a,"ListBox",D.a,[570,10])},1116:function(u,D,b){function a(){}b.d(D,
"a",function(){return a});u=b(0);var c=b(22);a.prototype.compare=function(d,e){return c.a.compare(d,e,!0)};Object(u.a)(a,"IgnoreCaseComparer",null,[561])},1117:function(u,D,b){function a(k,l){this.Ea=k;this.m2a=l}b.d(D,"a",function(){return a});u=b(0);var c=b(24),d=b(10),e=b(206);a.prototype.aKb=function(k,l,m){var f=l.Border;l=l.BorderFormat;var w=0,n=!1;if(0===f)k.cell.Nab(),this.tHb(k.cell.getRange());else{for(var z=0;3>=z;z++)a.Nvj(k,m,z,f)&&(w|=d.HelperMethods.h3a(z),this.wXd(k.cell.getRange(),
z,l),n=!0);d.HelperMethods.VQ(f,16)&&!e.c(k,0,m)&&(w|=2,this.wXd(k.cell.getRange(),0,l),n=!0);d.HelperMethods.VQ(f,32)&&!e.c(k,2,m)&&(w|=4,this.wXd(k.cell.getRange(),2,l),n=!0);n&&(m=k.cell.Vt.kf,d.HelperMethods.VQ(w,2)&&this.A1f(k,m,0)&&(w&=-3),d.HelperMethods.VQ(w,1)&&this.z1f(k,m,1)&&(w&=-2),d.HelperMethods.VQ(w,4)&&this.A1f(k,m,2)&&(w&=-5),d.HelperMethods.VQ(w,8)&&this.z1f(k,m,3)&&(w&=-9),k.cell.setBorders(l,w,!1))}};a.prototype.xQ=function(k,l){k=a.IVe(k,l);return k.isValidRange?(k=this.Ea.Fua(k))&&
k.length?k:null:null};a.prototype.tHb=function(k){for(var l=0;3>=l;l++){var m=a.IVe(k,l);if(m.isValidRange&&(m=this.Ea.Fua(m))&&m.length)for(var f=a.N_e(l),w=0;w<m.length;w++)m[w].RPa(f)}};a.prototype.wXd=function(k,l,m){if(k=this.xQ(k,l))for(var f=a.N_e(l),w=d.HelperMethods.h3a(f),n=0;n<k.length;n++){var z=k[n];this.Pei(z,f)&&a.setBorders(z,m,w,l,f)}};a.prototype.Pei=function(k,l){var m=k.Vt.kf,f=k.getRange();f=this.xQ(f,l);var w=!1,n=!1,z=!1,r=!1;f&&(w=a.j6a(f,!0),n=a.j6a(f,!1),r=a.rod(f),z=1===
f.length?!0:!1);switch(l){case 0:return a.gei(k,m,r,n,z);case 1:return a.dei(k,m,r,w,z);case 2:return a.eei(k,m,r,w,z);case 3:return a.fei(k,m,r,n,z)}return!1};a.prototype.A1f=function(k,l,m){if(!k.cell.SM)return!1;var f=k.range,w=this.xQ(f,m),n=e.c(k,m,l),z=!1;l=0===m?f.top<l.top:f.left<l.left;!a.gzb(k.cell)&&w&&1!==w.length&&(z=(0===m?a.j6a(w,!0):a.j6a(w,!1))?!1:!0);return!n&&z||l?!0:!1};a.prototype.z1f=function(k,l,m){var f=k.cell,w=this.xQ(f.getRange(),m);k=e.c(k,m,l);l=!1;if(w){var n=a.j6a(w,
!0),z=a.j6a(w,!1),r=n&&!z;z=z&&!n;1!==m||a.dAb(f)?3!==m||a.Xyb(f)||a.Uvj(f,w,z,r)&&(l=!0):a.Tvj(f,w,n,z)&&(l=!0)}return!k&&l||a.gzb(f)?!0:!1};a.EPg=function(k,l,m){var f={};f.LineStyle=Array(4);f.LineStyle[m]=k.LineStyle[l];f.Color=Array(4);f.Color[m]=k.Color[l];return f};a.Saf=function(k,l,m,f,w){return d.HelperMethods.VQ(k,w)&&e.c(l,m,f)};a.Nvj=function(k,l,m,f){return a.Saf(f,k,m,l,d.HelperMethods.h3a(m))||a.Saf(f,k,m,l,64)||112===f};a.setBorders=function(k,l,m,f,w){l=a.EPg(l,f,w);k.setBorders(l,
m,!1)};a.IVe=function(k,l){switch(l){case 0:return new c.Range(k.top-1,k.left,k.top-1,k.right,!1,!1);case 2:return new c.Range(k.top,k.left-1,k.bottom,k.left-1,!1,!1);case 1:return new c.Range(k.bottom+1,k.left,k.bottom+1,k.right,!1,!1);case 3:return new c.Range(k.top,k.right+1,k.bottom,k.right+1,!1,!1)}return k};a.N_e=function(k){switch(k){case 0:return 1;case 2:return 3;case 1:return 0;default:return 2}};a.j6a=function(k,l){for(var m=0;m<k.length;m++){var f=k[m];if(f.SM)return l?a.Xyb(f):a.dAb(f)}return!1};
a.gzb=function(k){var l=k.Vt.kf,m=k.getRange();return k.SM&&(m.top<l.top||m.bottom>l.bottom||m.left<l.left||m.right>l.right)?!0:!1};a.rod=function(k){for(var l=0;l<k.length;l++)if(a.gzb(k[l]))return!0;return!1};a.Tvj=function(k,l,m,f){if(!k.SM){if(!m||a.rod(l))return!0}else if(a.Xyb(k)&&(1===l.length&&a.QKg(k,l[0])||!m))return!0;return f};a.Uvj=function(k,l,m,f){if(!k.SM){if(!m||a.rod(l))return!0}else if(a.dAb(k)&&(1===l.length&&a.RKg(k,l[0])||!m))return!0;return k.Fka||f};a.gei=function(k,l,m,f,
w){var n=k.getRange();return a.Xyb(k)?a.gzb(k)||w:l.top===n.top||!f||m};a.dei=function(k,l,m,f,w){var n=k.getRange();return a.Xyb(k)?l.bottom===n.bottom&&w:f&&!m||l.bottom===n.bottom};a.eei=function(k,l,m,f,w){var n=k.getRange();return a.dAb(k)?a.gzb(k)||w:l.left===n.left||!f||m};a.fei=function(k,l,m,f,w){var n=k.getRange();return k.Fka?!1:a.dAb(k)?l.right===n.right&&w:f&&!m||l.right===n.right};a.Xyb=function(k){return 0<k.getRange().right-k.getRange().left};a.dAb=function(k){return 0<k.getRange().bottom-
k.getRange().top};a.RKg=function(k,l){k=k.getRange();l=l.getRange();return k.top===l.top&&k.bottom===l.bottom};a.QKg=function(k,l){k=k.getRange();l=l.getRange();return k.left===l.left&&k.right===l.right};Object(u.a)(a,"BorderModelAccessorHelper",null,[])},1119:function(u,D,b){function a(m,f){var w=l.call(this,f.textBox.domElement)||this;w.bXc=null;w.qGi=function(){w.wyd()};w.Svf=function(n,z){w.Df(n,z)};w.Wvf=function(n,z){w.Gh(n,z)};w.jb=m;w.GI=f;f.rY&&(f.rY.add(w),f.Bk(w.Wvf),f.vm(w.Svf));return w}
b.d(D,"a",function(){return a});u=b(0);var c=b(90);D=b(87);var d=b(47),e=b(44),k=b(69),l=D.a;Rk(a,l);a.prototype.dispose=function(){var m=this.GI;if(null===m||void 0===m?0:m.rY)m.rY.remove(this),m.wk(this.Wvf),m.Nl(this.Svf);c.a.Ia(this.bXc);this.GI=null;l.prototype.dispose.call(this)};a.prototype.Kh=function(m,f){switch(f){case -1470715894:case -1231471547:this.dU(!1);break;default:if(this.aFd(m,f))return k.g(m),!0;a.Oji(f)||this.dU(!1)}return!1};a.prototype.dU=function(){c.a.Ia(this.bXc);this.bXc=
d.a.instance.create(this.qGi,10,e.a.ksi)};a.prototype.Gh=function(){this.dU(!1)};a.Oji=function(m){switch(m){case 137938150:case -798660877:case 742457698:case 2091832999:return!0}return!1};Af.Object.defineProperties(a.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.jb}},Ya:{configurable:!0,enumerable:!0,get:function(){return this.GI}}});Object(u.a)(a,"ListAutoCompleteBehavior",D.a,[572,10])},1286:function(u,D,b){function a(){c.a.vi('.ewa-ac{position:absolute;z-index:102;margin-top:1px;width:auto}.ewa-ac .ewa-ac-param{white-space:nowrap;margin-bottom:3px;direction:ltr}.ewa-ac .ewa-ac-param function_param_table{position:absolute}.ewa-ac .ewa-ac-param .ewa-function-help-link{text-decoration:underline}.ewa-lb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#262626;font-size:12px;font-family:"Segoe UI";z-index:102;height:auto;margin:0 8px;-ms-touch-action:manipulation;touch-action:manipulation;vertical-align:middle}.ewa-lb.ewa-fb-refactor{position:relative;margin:0}.ewa-lb table{left:0;right:0;border-collapse:collapse}.ewa-lb table td{white-space:nowrap}.ewa-lb table td div.clip16x16{margin:0 0 0 2px}.ewa-lb table td.list-item{height:24px;padding:0 8px}.ewa-lb table td.list-item-selected{background-color:#d3f0e0}@media screen and (-ms-high-contrast:active){.ewa-lb table td.list-item-selected{border:2px solid #fff}}.ewa-lb table.list-table-touch td.list-item{height:35px}div#suggested_cells_list_box{margin:0}div#suggested_cells_list_box .list-table .ewa-suggested-cell-name{float:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}@font-face{font-family:"Segoe UI Semibold";font-weight:600;src:local("Segoe UI Semibold"),local("Segoe UI")}.ewa-lb table td.columnName-header{color:#666;font-size:12px;font-family:"Segoe UI Semibold";text-align:left;padding:3px 8px;text-overflow:ellipsis}.ewa-tt{background-color:#f7f7f7;border:1px solid #a2a6ab;color:#444;height:auto;vertical-align:middle;width:auto;z-index:102;font-size:8pt;margin:0;padding-bottom:3px;padding-top:2px}.ewa-root-ltr .ewa-tt{text-align:left;padding-left:5px;padding-right:7px}.ewa-root-rtl .ewa-tt{text-align:right;padding-left:7px;padding-right:5px}.ewa-dlg-function-link-container .ewa-fdb-help-link,.ewa-tt-rtl .ewa-fdb-help-link,.ewa-tt-ltr .ewa-fdb-help-link{color:#00f;text-decoration:underline}.ewa-function-link-container .ewa-function-udf-name,.ewa-function-link-container-udf .ewa-function-help-link{display:none}.ewa-root.rtl .ewa-function-link-container{text-align:left}')}
b.d(D,"a",function(){return a});var c=b(559)},1287:function(u,D,b){function a(c,d){this.command=0;this.selectedRanges=null;this.command=c;this.selectedRanges=d}b.d(D,"a",function(){return a});u=b(0);a.prototype.Ut=function(){return this.command};Object(u.a)(a,"MacroRecorderRangeOperationAppliedPayload",null,[409])},1288:function(u,D,b){function a(){c.a.vi(".TabsContainer{width:100%}.TabTitlesContainer{width:100%;display:table;table-layout:fixed;padding:0}.TabTitlesContainer>.TabTitle{display:table-cell;text-align:center}.TabTitlesContainer>.TabTitle:hover:not(.TabTitleActive){font-weight:bold}.TabTitleText{text-decoration:none}div#dataFieldCustomLabel,div#dataFieldSourceLabel{font-weight:600;padding-left:10px}div#summarizeValuesByControlBody{background-color:#fff;padding:10px}.valueFielsSettingsControlTitle{font-weight:bold;border-bottom:1px solid #a2a6ab}div#summarizeValuesByControlBody>.summarizeValuesByControlDescription{font-weight:600}div#summarizeValuesByControlBody>select{width:100%}div#showValueAsControlBody{background-color:#fff;padding:10px}select#showValueAsSelect{width:100%;margin-bottom:5px}select#showValueAsBaseFieldSelect{width:100%}select#showValueAsBaseItemSelect{width:100%;overflow:hidden}div#showValueAsControlBody>.showValueAsControlSelectRegion{width:48%;display:inline-block;position:relative}div#showValueAsControlBody>.showValueAsControlSelectRegionSeparator{width:4%;display:inline-block}.showValueAsControlSelectRegion>div{width:100%}input#valueFieldsSettingsFieldName{width:273px}div#valueFieldSettingTabs{width:380px}")}
b.d(D,"a",function(){return a});var c=b(559)},1289:function(u,D,b){b.d(D,"a",function(){return"FieldInfoListContextLoaded"});b.d(D,"k",function(){return"GetFieldInfoListContextOperationFailed"});b.d(D,"f",function(){return"Days from Today"});b.d(D,"i",function(){return"Total Weekdays from Today"});b.d(D,"j",function(){return"Years from Today"});b.d(D,"e",function(){return"Day of the Week"});b.d(D,"h",function(){return"Month of the Year"});b.d(D,"g",function(){return"End of Month"});b.d(D,"c",function(){return"Next Month"});
b.d(D,"d",function(){return"Next Week"});b.d(D,"b",function(){return"Next Day"})},1290:function(u,D,b){function a(){c.a.vi(".ewa-dv{position:relative;z-index:100;width:auto}.ewa-dv-buttonarea{position:absolute;border:0;padding:1;z-index:100;margin:0;overflow:hidden;width:auto;height:auto}.ewa-dv-listbutton{margin:0;cursor:pointer}.ewa-dv-listbutton span.clip17x17{display:inline-block;margin:0}.ewa-dlb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:100;height:auto;margin:0}.ewa-dlb table{left:0;right:0;border-collapse:collapse;empty-cells:show}.ewa-dlb table td{white-space:nowrap;padding:0 2px 0 2px}.ewa-dlb table.list-table td.list-item{height:24px}.ewa-dlb table.list-table td.list-item-selected{height:24px;background-color:#d3f0e0;color:#444}.ewa-dlb table.list-table-touch td.list-item{height:35px}.ewa-dlb table.list-table-touch td.list-item-selected{height:35px;background-color:#d3f0e0;color:#444}@media screen and (-ms-high-contrast:active){.ewa-dlb table.list-table td.list-item-selected{background-color:highlight;-ms-high-contrast-adjust:none;color:highlighttext}}.ewa-dpb{position:absolute;border:1px solid #a2a6ab;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:99;margin:0;max-width:230px}.ewa-dpb p{padding:0 2px 0 2px;margin:0;border-collapse:collapse;width:230px}.ewa-dv-ltr .ewa-dpb p{text-align:left}.ewa-dv-rtl .ewa-dpb p{text-align:right}.ewa-dpb p.dv-prompt-title{font-weight:bold}.ewa-dpb p.dv-prompt-message{word-wrap:break-word;overflow:hidden}")}
b.d(D,"a",function(){return a});var c=b(559)},1291:function(u,D,b){function a(){c.a.vi(".DataValidationDialogPanel{min-width:0}.DataValidationDialogPanel .TabTitlesContainer{width:300px}.DataValidationDialogPanel div#WACDialogBodyPanel{height:312px}.TabTitlesContainer{border-bottom:solid 1px #c3cbd0}.TabTitle{text-align:center;cursor:default}.TabTitleText{display:inline-block}.TabTitleActive{color:#217346;font-weight:bold}.TabTitleActive>.TabTitleText{padding-bottom:10px;border-bottom:solid 4px}.DataValidationEditTabContent{padding-top:7px}.DataValidationButtonPanel{float:none}.AppRtl .DataValidationButtonPanel{float:none}.DataValidationButtonClearAll{float:left;margin-left:0;margin-right:10px}.AppRtl .DataValidationButtonClearAll{float:right;margin-left:10px;margin-right:0}.DataValidationRow{margin-bottom:10px;display:table}.DataValidationNonBorderRow{margin-bottom:8px;display:table}.DataValidationEditElementLabel{width:95px;display:inline-block;margin-top:4px;margin-bottom:4px;vertical-align:top}.DataValidationEditElement{display:inline-block;margin-top:0;margin-bottom:0;padding:1px;font-size:9pt;font:inherit;border:solid 1px #c3cbd0}.DataValidationEditNoBorderElement{display:inline-block;margin-top:0;margin-bottom:0;font-size:9pt;font:inherit;width:210px;height:22px}.DataValidationEditSelect{width:calc(210px + 4px);height:calc(22px + 4px);padding:0;color:#000}.DataValidationEditSelect:disabled{color:graytext}.DataValidationEditSelectFocus:focus{outline:-webkit-focus-ring-color auto 5px !important}.DataValidationEditInput{width:210px;height:22px}.DataValidationEditTextArea{width:210px;height:50px;resize:none;overflow-y:auto;overflow-x:hidden}.DataValidationEditErrorMessage{margin-bottom:-15px;margin-top:-6px;font-size:9pt;color:#d90000;width:300px;height:65px}.DataValidationEditCheckBoxWithText{margin-top:0;margin-bottom:0;display:inline-block}.DataValidationEditCheckBoxNoText{margin-top:6px;margin-bottom:0;display:inline-block}.DataValidationEditRadio{margin-top:0;margin-bottom:0}.DataValidationEditLabel{margin-top:5px;margin-bottom:0;display:inline-block}div#listDescriptionSubDivID{height:37px;width:210px}label#listDescriptionLabelId{font-size:8pt;margin-top:0}div#ignoreBlankCheckboxDivID{margin-bottom:8px}")}
b.d(D,"a",function(){return a});var c=b(559)},1293:function(u,D,b){function a(){c.a.vi(".ewa-facp-text-box{position:absolute}")}b.d(D,"a",function(){return a});var c=b(559)},1294:function(u,D,b){b.d(D,"b",function(){return"MinorThemeFont"});b.d(D,"a",function(){return"MajorThemeFont"})},1296:function(u,D,b){function a(){c.a.vi('.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media(forced-colors:active){.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}')}
b.d(D,"a",function(){return a});var c=b(559)},1297:function(u,D,b){function a(n){var z=w.call(this,document.createElement("div"))||this;z.hIa=!1;z.iIa=!1;z.gIa=!1;z.eIa=!1;z.fIa=!1;z.dR=!1;z.GI=null;z.visible=void 0;z.$mc=function(r,v){z.$s(r,v)};z.gLa=function(){z.Ya.textBox.WJ=!0};z.yya=function(){z.Ny(!0)};z.xtf=function(){z.Ya.textBox.focus()};z.Fh=function(){l.g(z.$).inRangePicker||(z.isListVisible=!1)};z.$=n;l.g(n)&&l.g(n).ha&&l.g(z.$).ha.kJ(z.Fh);z.Dk=d.a.J4();z.V5a=e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixKeydownLayoutTrashingBottleneck",
!1);return z}b.d(D,"a",function(){return a});u=b(0);D=b(244);var c=b(5),d=b(36),e=b(1),k=b(10),l=b(21),m=b(33),f=b(4),w=D.a;Rk(a,w);a.prototype.get_visible=function(){return this.V5a?void 0!==this.visible?this.visible:this.visible=w.prototype.get_visible.call(this):w.prototype.get_visible.call(this)};a.prototype.set_visible=function(n){if(!this.V5a)return w.prototype.set_visible.call(this,n);if(this.visible===n)return n;this.visible=n;return w.prototype.set_visible.call(this,n)};a.prototype.$s=function(){this.xBa(!1);
this.Jt.$s()};a.prototype.dispose=function(){this.$&&l.g(this.$)&&l.g(this.$).ha&&l.g(this.$).ha.UN(this.Fh);this.$=null;w.prototype.dispose.call(this)};a.prototype.Kh=function(n,z,r){n=!1;if((this.A0a||(void 0===r?0:r))&&!this.Cwa()&&this.get_visible()&&this.isListVisible)switch(this.Dk&&this.bBc(z),z){case 1872288872:this.isListVisible=!1;n=!0;break;case -798660877:this.Jt.pB(1);n=!0;break;case 137938150:this.Jt.pB(-1);n=!0;break;case 2091832999:this.Jt.pB(this.MH-1);n=!0;break;case 742457698:this.Jt.pB(-(this.MH-
1));n=!0;break;case 125627505:n=this.Ny(!1);break;case 267796030:d.a.J4()&&(n=this.Ny(!1))}return n};a.prototype.xBa=function(n){if(this.isListVisible||n){var z=l.g(this.$);n=z.domElement;var r=this.GI.textBox.domElement,v=m.a(this.$).ii(r.offsetHeight),A=m.a(this.$).ii(r.offsetTop),B=m.a(this.$).ii(r.offsetWidth);r=m.a(this.$).ii(r.offsetLeft);z=z.sj;var y=f.AFrameworkApplication.ta&&f.AFrameworkApplication.ta.Pa.Pf,x=$get(this.$.yb+c.a.D_a,this.$.domElement);y&&(x=document.getElementById("EditorContainer"));
var C=new Sys.UI.Point(z?this.Jt.i$b:0,z?this.rDh:a.f1h);v=x.offsetTop+C.y+(d.a.TM(this.$)&&z?0:v+A);this.$.sba||(A=$get(c.a.$Fa,this.$.domElement),v+=A&&!y?A.offsetHeight:0);A=this.domElement;A.style.top=k.HelperMethods.hc(v);r=x.offsetLeft+r+C.x;!d.a.TM(this.$)&&this.$.isChromeRtl?A.style.right=k.HelperMethods.hc(z?this.Jt.i$b:n.offsetLeft+n.offsetWidth-r-B):A.style.left=k.HelperMethods.hc(r)}};a.prototype.tSa=function(n){this.Jt&&(n&&!this.dR?(this.Jt.C9(this.xtf),this.Jt.eZb(this.gLa),this.Jt.hnb(this.yya),
this.dR=!0):this.dR&&(this.Jt.gda(this.xtf),this.Jt.wsc(this.gLa),this.Jt.$Hb(this.yya),this.dR=!1))};a.prototype.bBc=function(n){switch(n){case -798660877:case 137938150:case 2091832999:case 742457698:this.hIa=!0;break;case 125627505:this.gIa=!0;break;case 267796030:d.a.J4()&&(this.eIa=!0)}};Af.Object.defineProperties(a.prototype,{MH:{configurable:!0,enumerable:!0,get:function(){return this.Jt.MH}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return this.Jt.isListVisible},set:function(n){this.Jt.isListVisible=
n}},Ya:{configurable:!0,enumerable:!0,get:function(){return this.GI},set:function(n){(this.GI=n)&&this.GI.zZd.add(this)}},rDh:{configurable:!0,enumerable:!0,get:function(){return d.a.TM(this.$)?-5:-40}}});a.i$b=0;a.f1h=1;Object(u.a)(a,"AutoCompleteControl",D.a,[526])},1298:function(u,D,b){function a(d,e,k,l){e=void 0===e?0:e;k=void 0===k?"":k;l=void 0===l?"":l;var m=c.call(this)||this;m.length=d;m.selectedIndex=e;m.OF=k;m.description=l;return m}b.d(D,"a",function(){return a});u=b(0);var c=Sys.EventArgs;
Rk(a,c);Object(u.a)(a,"ListEventArgs",Sys.EventArgs,[])},1299:function(u,D,b){function a(A,B){A=v.call(this,A,B,new r.a(e.a.listItem,e.a.rBb,e.a.uBb,e.a.vBb))||this;A.Hcc=!1;A.pq=null;A.jlb=null;A.mUe=!1;A.visible=void 0;A.PAa(!0);A.mUe=w.EwaSettings.isChangeGateEnabled("OfficeVSO:5893822_FixFormulaBarXOffsetCrash");A.V5a=w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixKeydownLayoutTrashingBottleneck",!1);return A}b.d(D,"a",function(){return a});u=b(0);var c=b(15),d=b(25);D=b(1050);
var e=b(986),k=b(5),l=b(76),m=b(36),f=b(12),w=b(1),n=b(117),z=b(21),r=b(1118),v=D.a;Rk(a,v);a.prototype.Qxa=function(){var A=460,B=z.g(this.$),y=B.domElement,x=this.QSa.style,C=this.Qf.offsetTop+this.Pk.offsetHeight*this.Pk.sectionRowIndex-this.Qf.scrollTop;x.width="auto";x.whiteSpace="nowrap";x.position=d.a.xgc?"relative":"absolute";var G=y.offsetLeft+y.offsetWidth-(this.domElement.offsetLeft+this.Qf.offsetLeft+this.Qf.offsetWidth+3);y=this.domElement.offsetLeft-3-(y.offsetLeft+this.i$b);A=Math.min(this.QSa.offsetWidth,
A,Math.max(G,y));f.DOMElementExtensions.vr(this.QSa,A);x.whiteSpace="";x.position="absolute";C+3>this.Qf.offsetTop+this.Qf.offsetHeight||C<this.Qf.offsetTop||(A=this.Qf.offsetLeft-3-this.QSa.offsetWidth,x=this.Qf.offsetLeft+this.Qf.offsetWidth+3,f.DOMElementExtensions.updatePosition(this.QSa,y>G!==B.rtl?A:x,C,!1))};a.prototype.pB=function(A){v.prototype.pB.call(this,A);this.Qxa()};a.prototype.$s=function(){this.Qxa()};a.prototype.Ira=function(){var A=this.Gn,B=this.Qf,y=3===l.a.Cb||d.a.Zo,x=y?this.kCb:
this.MH;this.isListVisible=!0;B.style.height="auto";this.hGa.set_visible(!0);this.Omb(A,y);this.pq.length>x?(f.DOMElementExtensions.xI(B,Math.floor(B.offsetHeight*x/this.pq.length)),B.style.overflowY="auto"):(B.style.height="auto",B.style.overflowY="hidden");f.DOMElementExtensions.vr(B,A.offsetWidth+(this.pq.length>x?n.a.gv:0))};Af.Object.defineProperties(a.prototype,{i$b:{configurable:!0,enumerable:!0,get:function(){if(m.a.TM(this.$)){var A=document.getElementById(this.$.yb+k.a.lUe);return!this.mUe||
A?f.DOMElementExtensions.getBoundingClientRect(A).x:0}A=w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddNamedRange",!1)?document.getElementById(k.a.rwd):document.getElementById(this.$.yb+k.a.rwd+"-"+k.a.vqf);c.ULS.shipAssertTag(537170323,0,!!A||this.$.VM,"AutoCompleteListBox.FormulaBarXOffset : Can't find the name box combobox element.");return A?A.offsetWidth:0}},he:{configurable:!0,enumerable:!0,get:function(){return this.jlb},set:function(A){this.jlb=A}},isListVisible:{configurable:!0,
enumerable:!0,get:function(){return this.V5a?void 0!==this.visible?this.visible&&0<this.pq.length:(this.visible=f.DOMElementExtensions.isVisible(this.Qf))&&0<this.pq.length:f.DOMElementExtensions.isVisible(this.Qf)&&0<this.pq.length},set:function(A){this.V5a&&this.visible===A||(f.DOMElementExtensions.setVisible(this.Qf,A),f.DOMElementExtensions.setVisible(this.QSa,A),this.V5a&&(this.visible=A));var B=z.g(this.$).view;A?this.Hcc||(B.Gs(this.hGa.$mc),this.Hcc=!0):(Array.clear(this.pq),this.Hcc&&(B.Iq(this.hGa.$mc),
this.Hcc=!1))}}});Object(u.a)(a,"AutoCompleteListBox",D.a,[])},1300:function(u,D,b){function a(r,v,A,B,y,x,C,G,E,I){var U=z.call(this,document.createElement("a"))||this;U.tl=!1;U.$c=function(M){U.raiseEvent("ClickButton",M);return!0};U.onKeyDown=function(M){U.raiseEvent("KeyDown",M);return!1};U.tw=function(){U.hovered=!0;U.raiseEvent("PointerOver");return!1};U.yN=function(){U.hovered=!1;U.raiseEvent("PointerOut");return!1};U.onBlur=function(M){n.g(M);U.focused=!1;U.raiseEvent("Blur")};U.onFocus=function(M){n.g(M);
U.focused=!0;U.raiseEvent("Focus")};U.jkh=G;U.ufh=E;U.OI=a.nb(U.domElement,v,A,B,y,x,C,I);U.yc.ka("contextmenu",function(M){n.g(M)});U.enable();U.hovered=!1;U.focused=!1;r.appendChild(U.domElement);return U}b.d(D,"a",function(){return a});u=b(0);var c=b(233),d=b(13),e=b(109),k=b(245);D=b(244);var l=b(618),m=b(5),f=b(53),w=b(12),n=b(69),z=D.a;Rk(a,z);a.prototype.xUc=function(r){this.get_events().addHandler("ClickButton",r)};a.prototype.oId=function(r){this.get_events().removeHandler("ClickButton",
r)};a.prototype.JUc=function(r){this.get_events().addHandler("KeyDown",r)};a.prototype.CId=function(r){this.get_events().removeHandler("KeyDown",r)};a.prototype.sZb=function(r){this.get_events().addHandler("PointerOver",r)};a.prototype.NId=function(r){this.get_events().removeHandler("PointerOver",r)};a.prototype.rZb=function(r){this.get_events().addHandler("PointerOut",r)};a.prototype.MId=function(r){this.get_events().removeHandler("PointerOut",r)};a.prototype.Umb=function(r){this.get_events().addHandler("Blur",
r)};a.prototype.KHb=function(r){this.get_events().removeHandler("Blur",r)};a.prototype.C9=function(r){this.get_events().addHandler("Focus",r)};a.prototype.gda=function(r){this.get_events().removeHandler("Focus",r)};a.prototype.enable=function(){this.domElement&&(this.domElement.classList.remove(l.a.nU),this.domElement.style.cursor="",c.a.instance.qa(d.a.click,this.domElement,this.$c),e.KeyInputManager.instance.qa(d.a.Lb,this.domElement,this.onKeyDown),k.a.instance.qa(d.a.pointerOver,this.domElement,
this.tw),k.a.instance.qa(d.a.pointerOut,this.domElement,this.yN),this.yc.an("blur")||this.yc.ka("blur",this.onBlur),this.yc.an("focus")||this.yc.ka("focus",this.onFocus),this.domElement.title=this.jkh,this.tl=!0)};a.prototype.disable=function(){this.domElement&&(this.domElement.classList.add(l.a.nU),this.domElement.style.cursor="",this.isEnabled&&(c.a.instance.Aa(d.a.click,this.domElement,this.$c),e.KeyInputManager.instance.Aa(d.a.Lb,this.domElement,this.onKeyDown),k.a.instance.Aa(d.a.pointerOver,
this.domElement,this.tw),k.a.instance.Aa(d.a.pointerOut,this.domElement,this.yN)),this.domElement.title=this.ufh,this.tl=!1)};a.prototype.dispose=function(){this.isEnabled&&(c.a.instance.Aa(d.a.click,this.domElement,this.$c),e.KeyInputManager.instance.Aa(d.a.Lb,this.domElement,this.onKeyDown),k.a.instance.Aa(d.a.pointerOver,this.domElement,this.tw),k.a.instance.Aa(d.a.pointerOut,this.domElement,this.yN),this.tl=!1);w.DOMElementExtensions.setVisible(this.domElement,!1);z.prototype.dispose.call(this)};
a.nb=function(r,v,A,B,y,x,C,G){r.removeAttribute("Href");r.setAttribute(m.a.Hd,m.a.Hs);r.className=v;r.tabIndex=G;v=document.createElement("span");v.className=C;v.classList.add(A);v.tabIndex=-1;r.appendChild(v);r=document.createElement("img");r.src=f.a.Te(B);r.className=y;r.alt=x;r.tabIndex=-1;v.appendChild(r);return r};Af.Object.defineProperties(a.prototype,{ll:{configurable:!0,enumerable:!0,get:function(){return this.OI}},isEnabled:{configurable:!0,enumerable:!0,get:function(){return this.tl}}});
Object(u.a)(a,"ListButton",D.a,[772,10])},1343:function(u,D,b){function a(){r.initData();Oc.a.Fa(function(jb){n.ka(jb);c.ka(jb);r.ka(jb);d.ka(jb)})}function c(jb){var Eb=qc.call(this)||this;Eb.$=jb;Eb.Eb();return Eb}function d(jb,Eb,nc){var $c=this;this.Rxc={};this.Ad=!1;this.Jl=function(od,de){$c.showContextMenu(void 0===de?null:de)};this.dvf=function(od,de){de.Tzi===d.K0h&&Ya.g($c.$).focus()};this.oR=function(od,de){od=$c.$.Ka.Daa(de.Ed.command);(null===od||void 0===od?0:od.dismissesContextualUI)&&
$c.r3()};this.X5=function(){$c.$.da.xU(342);P.TaskExtensions.Ba(nb.GetServiceTaskFactory.create($c.$.da,338,$c.$.la,3),function(od){od=od.result;for(var de=ak($c.Rxc),ae=de.next();!ae.done;ae=de.next())ae.value.jNf(od)},$c.$.la)};this.$=jb;this.contextMenuController=nc;this.B5d=new e(this.$);jb.da.Ga(8,this);for(nc=0;nc<Eb.length;nc++)this.Rxc[d.h2g[nc]]=Eb[nc];this.ha=Ya.g(jb).ha;this.ha.WYb(this.Jl);this.$.Ka.vYa(this.dvf);Bb.a.instance.Qsj();Ab.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&
this.$.Ka.yFa(this.oR);Ab.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.p2(this.X5)}function e(jb){this.cSe=null;this.$=jb;this.r8a=new m;Ab.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&Ab.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||(this.cSe=new k(this.$))}function k(jb){var Eb=this;this.tZa=null;this.wQd=!1;this.iBb=0;this.m8c=1;this.NLe=0;this.fEb=function(nc){Eb.JJf(nc.domElement,nc.hashCode)};
this.zNf=function(nc){for(var $c=0;window.performance.now()-nc<Eb.cmh&&0<Eb.tZa.length;)Eb.kle(Eb.tZa.shift()),$c++;W.ULS.sendTraceTag(537167052,1,50,"FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Batch number: {0}, Events Registered in this frame: {1}, Events in queue: {2}",Eb.m8c,$c,Eb.tZa.length);0<Eb.tZa.length?Eb.iBb=window.requestAnimationFrame(Eb.zNf):(W.ULS.sendTraceTag(537167051,1,50,"FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Finished batch number: {0}, Total time in MS: {1}",
Eb.m8c,window.performance.now()-Eb.NLe),Eb.m8c++,Eb.iBb=0)};this.onPointerDown=function(nc){fc.a.slim(nc.Ca.rawEvent);return!1};this.$=jb;this.gridView=Ya.g(this.$);this.Y8h();this.cmh=this.$.ya.AutoFilterEventRegistrationTimeLimit}function l(){this.Kd=this.ose=this.cell=null}function m(){this.rdc={}}function f(){this.menuModel=null;this.CEe=0}function w(){this.dictionary=this.Ed=null}function n(jb){var Eb=Xe.call(this)||this;Eb.y9e=!1;Eb.Ekd=function(){var nc;(nc=Eb.$.da.za(342))?Eb.pb(nc):Eb.$.eB(function($c){$c.uec().then(function(od){(nc=
Eb.$.da.za(342))?Eb.pb(nc):(nc=new z(Eb.$,od),Eb.pb(Eb.$.da.Ga(342,nc)))})})};Eb.$=jb;Eb.Eb();return Eb}function z(jb,Eb){this.Dqb=Eb;this.$=jb}function r(jb){return yd.call(this,jb)||this}function v(jb,Eb,nc,$c){jb=Tb.call(this,jb,"PopulateTimeSlicerLevelMenu",-227942804,1634477200,v.hJj,!0,!1,v.PIb,Eb,nc,!1,$c)||this;jb.E0a=0;jb.vsa=null;jb.YJa=null;jb.tJe=null;return jb}function A(jb,Eb,nc){this.type=jb;this.c2g=Eb;this.pr=nc}function B(jb,Eb,nc,$c){return hb.call(this,jb,"PopulateSlicerContextMenu",
-1920954846,723126814,"SlicerContextMenu",!0,!1,"SlicerContextMenuRootName",Eb,nc,!0,$c)||this}function y(jb,Eb,nc,$c){jb=Xa.call(this,jb,"PopulateSheetOpsContextMenu",274207288,-1497523576,ve,!0,!1,"SheetTabContextMenuRootName",Eb,nc,!1,$c)||this;jb.pgc=!1;jb.Thc=!1;return jb}function x(jb,Eb,nc,$c){Eb=lf.call(this,jb,"PopulateRichTextContextMenu",679816325,1151222423,Ze,!0,!1,Ze,Eb,nc,!0,$c)||this;Eb.grid=Ya.g(jb);return Eb}function C(jb,Eb,nc,$c){Eb=Me.call(this,jb,"PopulateTableFieldListContextMenu",
-751848458,-1085236154,ge,!0,!1,"TableFieldListContextMenuRoot",Eb,nc,!1,$c)||this;Eb.Y4b=null;Eb.Nxd=0;Eb.rEa=null;Eb.grid=Ya.g(jb);return Eb}function G(){}function E(jb,Eb,nc,$c){var od=Qc.call(this,jb,"PopulatePivotTableContextMenu",-1475408662,1114549926,Ic,!0,!1,"PivotTableContextMenuRootName",Eb,nc,!0,$c)||this;od.rc=null;od.activeCell=null;od.QZd=null;od.eic=!1;od.snd=!1;od.expandCollapse=!1;od.refresh=!1;od.eZ=!1;od.Ee=null;od.Wz=null;od.h0a=null;od.rb=null;od.M$a=null;od.yba=!1;od.OLi=function(de){de&&
!Da.a.Rg(de.Errors)&&od.rc&&(od.rc.Io=de.Result,od.eKb());od.showPivotTableContextMenu()};od.NLi=function(){};od.zPi=function(){od.ubb()};od.yPi=function(){od.ubb()};od.pGi=function(){od.ubb()};od.oGi=function(){od.ubb()};od.gy=function(){od.mXd();od.yba=!1};od.Dq=function(){if(od.yba){W.ULS.sendTraceTag(537167E3,0,50,"PivotTableContextMenu.OnAfterAllBlocksUpdated: Context menu was closed after changes were made by other users");var de=od.rc;od.grid.Ab.To(od.grid.ha.sa.activeCell)!==de&&(od.ubb(),
od.b6h())}};od.shh=new DOMParser;od.Wvj=!0;od.grid=Ya.g(jb);od.Mkc=!0;return od}function I(jb,Eb,nc,$c){return X.call(this,jb,"PopulatePivotContextMenu",2123758504,912277356,Eb,nc,$c)||this}function U(jb,Eb,nc,$c){jb=rd.call(this,jb,"PopulateFieldWellContextMenu",1374696078,495005930,td,!0,!1,td,Eb,nc,!1,$c)||this;jb.cell=null;jb.io=null;jb.vo=null;jb.externalSourceIndex=-1;jb.k_d=-1;jb.eSa=0;jb.cyc=-1;jb.mL=null;jb.isOlap=!1;jb.wV=!1;jb.p2a=!1;return jb}function M(jb,Eb,nc,$c,od,de,ae,ze,Xd){var te=
Vc.call(this,od,sb.a.instance.lb(61),!0,2,!0)||this;te.e2f=!0;te.nie=null;te.URa=null;te.Efa=null;te.Grb=null;te.B4c=null;te.mRc=null;te.jGi=function(af){jd.a.any(af.Errors,function(cf){return-103190598===cf.MessageId})&&te.xSa.bhj()};te.xMi=function(af){af&&!rb.a(af)&&(af=af.Result,te.B4c.innerHTML=sb.a.instance.ga(1078)+Sd.a.Ag(af.ValueFieldSourceName),te.isOlap&&!te.wV?(te.xSa.enabled=!1,te.Efa.activeTab=te.Efa.bzc-1):(te.xSa.enabled=!0,te.Efa.activeTab=0),te.xSa.Jrj(af.PivotValueFieldSettingsSummarizeValueByInfo),
te.URa.Krj(af.PivotValueFieldShowValueAsInitialInfo),te.hf())};te.cell=jb;te.vo=Eb;te.externalSourceIndex=nc;te.Leg=$c;te.Ed=de;te.Sha=ae;te.isOlap=ze;te.wV=Xd;return te}function T(jb){jb=Xb.call(this,jb)||this;jb.Nce=null;jb.get_visible=jb.Gja;jb.set_visible=jb.tna;jb.Zja();return jb}function F(){}function K(jb,Eb,nc,$c,od,de,ae,ze){var Xd=Qb.call(this,jb)||this;Xd.lF=null;Xd.x5b=null;Xd.j0b=null;Xd.r1d=null;Xd.s1d=null;Xd.J3d=null;Xd.kvf=function(){var te=parseInt(Xd.n3.he.value,10);Xd.qUg(te)?
(Xd.QT.Nn.disabled=!0,Xd.wP.Nn.disabled=!0,Xd.wP.clear(),K.Oaf(te)?(Xd.QT.Nn.disabled=!1,Xd.LNb(!0)):K.Paf(te)?(Xd.QT.Nn.disabled=!1,Xd.wP.Nn.disabled=!1,Xd.LNb(!0),Xd.hkf()):Xd.LNb(!1)):(te=Da.a.Wc(1,0,0,1108,0,7896227,"FormatRequiresBaseFieldsOrBaseItems"),jc.a(Xd.$).qr([te]),Xd.n3.fhj())};Xd.uGi=function(){0>Xd.QT.selectedIndex||Xd.wP.Nn.disabled||(Xd.LNb(!0),Xd.hkf())};Xd.yMi=function(te){Xd.lF.Cdb();Xd.wP.Nn.style.overflowY="scroll";if(te&&!rb.a(te)){te=te.Result;Xd.wP.clear();for(var af=ak(te.BaseItems),
cf=af.next();!cf.done;cf=af.next())cf=cf.value,Xd.wP.QL(cf.DisplayString,cf.Id.toString(),cf.Id===te.SelectedBaseItem);Xd.LNb(!1)}};Xd.get_visible=Xd.Gja;Xd.set_visible=Xd.tna;Xd.$=Eb;Xd.cell=nc;Xd.vo=$c;Xd.externalSourceIndex=od;Xd.Ed=de;Xd.Sha=ae;Xd.Nji=ze;Xd.lSj=Ab.EwaSettings.isChangeGateEnabled("OfficeVSO:4859461_DisableOKButtonWhenLoadingIndictorIsOn");Xd.Zja();return Xd}function J(){}function O(jb,Eb,nc,$c,od){this.externalSourceIndex=0;this.pivotFieldTitle=this.activeCell=null;this.summarizeBy=
0;this.showAsValueParameters=null;this.externalSourceIndex=jb;this.activeCell=Eb;this.pivotFieldTitle=nc;this.summarizeBy=$c;this.showAsValueParameters=od}function N(jb,Eb,nc){this.baseItemIndex=this.baseFieldIndex=this.dataFormat=0;this.dataFormat=jb;this.baseFieldIndex=Eb;this.baseItemIndex=nc}function H(){}function Q(){}function ca(jb,Eb,nc,$c){return X.call(this,jb,"PopulateFieldListPivotMenu",-1793121409,1378457149,Eb,nc,$c,Gd)||this}function X(jb,Eb,nc,$c,od,de,ae,ze){ze=void 0===ze?Hc:ze;var Xd=
ud.call(this,jb,Eb,nc,$c,ze,!0,!1,"PivotFilterMenuRootName",od,de,!1,ae)||this;Xd.T4b=null;Xd.Aif=null;Xd.cmb=null;Xd.pivotData=null;Xd.Xxd=null;Xd.cmc=null;Xd.sDb=0;Xd.Q1b=0;Xd.oY=0;Xd.rrb=null;Xd.CLi=function(te,af){if(af)if(rb.a(te))Xd.bvd(af,!1);else if(te=te.Result){Xd.dsb=ea.wed(af,Xd.$,Xd.pivotData.cell,Xd.oY);var cf=Xd.hpf(te.MenuModel.Sections);Xd.rrb=cf;X.fN.set(Xd.pivotData.cell,af,cf,Xd.oY);Qd.a(Xd.$).BFj(te);Xd.bvd(af,!0)}};Xd.BLi=function(te,af){Xd.bvd(af,!1)};Xd.ff=function(te,af){X.fN.f7b(af.Zc.hash)};
Xd.Fm=function(te,af){X.fN.f7b(af.Zc.hash)};Xd.Sca=null;Xd.Yxd=Xd.sDb=-1;Xd.Uwe=Xd.Q1b=-1;Xd.Xoe=Xd.oY=0;Xd.Ux=Ab.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");X.fN||(X.fN=new ea(Xd.$),Ya.g(Xd.$).Ea.Fs(Xd.ff),Ya.g(Xd.$).Ea.xG(Xd.Fm),Ya.g(Xd.$).Ea.Gga(Xd.ff));return Xd}function Z(){this.cell=null;this.dataSourceIndex=0;this.vo=this.pivotName=null}function ea(jb){this.$=jb;this.fN={}}function ka(jb,Eb,nc,$c){jb=Ie.call(this,jb,"PopulateFieldListContextMenu",-1045020714,-170383950,
He,!0,!1,He,Eb,nc,!1,$c)||this;jb.io=null;jb.mL=null;jb.SZ=!1;jb.wV=!1;jb.isOlap=!1;jb.PTd=!1;return jb}function Y(jb,Eb,nc,$c){jb=qa.call(this,jb,Eb,nc,$c,"PopulateChartContextMenu",-498523270,1640762262,Ee)||this;jb.CAa=!1;jb.Jva=!1;jb.eZ=!1;jb.refresh=!1;jb.isPivotChart=!1;return jb}function qa(jb,Eb,nc,$c,od,de,ae,ze,Xd,te){ze=void 0===ze?Kb.a.a2g:ze;jb=xb.call(this,jb,void 0===od?"PopulateFloatingObjectContextMenu":od,void 0===de?-2017893763:de,void 0===ae?1350204367:ae,ze,void 0===Xd?!0:Xd,
void 0===te?!1:te,ze,Eb,nc,!0,$c)||this;jb.floatingObject=null;jb.mb=0;jb.Mkc=!0;return jb}function fa(jb,Eb,nc,$c){jb=Gc.call(this,jb,"PopulateAutoFilterFieldListContextMenu",474690375,216058793,fa.Dyh,!0,!1,fa.PIb,Eb,nc,!1,$c)||this;jb.cm=null;return jb}function ha(){}function ia(jb,Eb){jb=wa.call(this,jb,2,0,null)||this;jb.nse=Eb;return jb}function wa(jb,Eb,nc,$c){this.ssg=jb;this.Kmg=Eb;this.Omg=nc;this.Qwg=$c}function Qa(){}function S(jb,Eb,nc,$c){var od=Kc.call(this,jb,"PopulateAutoFilterContextMenu",
1675506831,1651433993,Pc,!0,!1,"AutoFilterContextMenuRoot",Eb,nc,!1,$c)||this;od.rrb=null;od.sheetName=null;od.TSa=null;od.dWc=null;od.Ckf=!1;od.q2a=!1;od.$Fb=null;od.ULb=null;od.w9c=null;od.zbc=null;od.YOa=null;od.TEe=null;od.q$a=null;od.$3c=null;od.TV=function(){od.ayc();od.$.ea.Ln(od.TV)};od.iLi=function(de){function ae(Sb,Jc,nd){od.$3c=wc.o(od.$.oa.xa,te,Aa.b(Sb,af),od.q2a?Aa.a(Jc,cf):Jc,nd,null,Pa);return od.$3c}od.q2a||kb.b(od.$).Cd(qb.a.Wwf,od.dm(),void 0,!0);var ze={};od.$.Oj(ze);var Xd=od.$.ea.isNamedObjectViewMode,
te=Va.a.Vh(od.dWc);te.SheetName=Xd?ze.NamedObjectName:ze.SheetName;te.NamedObjectView=Xd;ze=!!de.searchText;Xd=586;od.q2a&&(ze&&(te.ItemListOptions=od.H4g(de.searchText),Xd=597),de={},kb.b(od.$).Cd(qb.a.Wwf,(de.UserOperation=Xd.toString(),de),void 0,!0));var af=od.Bzd(ze),cf=od.jLi(),Pa=od.$.oa.xa.Pb();od.TEe=Pa.RequestId;od.q2a&&od.zbc&&!od.zbc.dequeueUtcTime&&(od.$.userOperationManager.vta(od.zbc),od.CUg());de=Ab.EwaSettings.Zb()?new db.a(Xd,0,ae,80):new bb.a(Xd,0,ae,16);od.zbc=od.$.userOperationManager.Sb(de,
null);od.q$a=od.$3c;od.YOa=od.TEe};od.onMenuItemClick=function(de,ae,ze){kb.b(od.$).Cd(qb.a.dQi,od.dm(),void 0,!0);var Xd={};ae=(Xd.CommandValueId=ae,Xd.MenuItemId=ae,Xd.InputMethod=ze,Xd.TopCellAddress=od.TSa,Xd);Xd=new $a.a(de,ze,od.$.isEditMode?2:1,19,null);od.$.Ka.Kb(Xd,ae);W.ULS.sendTraceTag(537167131,0,50,"AutoFilterContextMenu::OnMenuItemClick {0}, {1}",de,ze)};od.fGi=function(de){if(de.checkedItems&&de.checkedItems.length){kb.b(od.$).Cd(qb.a.mtf,od.dm(),void 0,!0);var ae=Va.a.Vh(od.dWc),ze=
{};od.$.Oj(ze);ze.FirstRow=0;ze.FirstColumn=ae.Column;var Xd=od.$.ea.isNamedObjectViewMode;ae.NamedObjectView=Xd;ae.SheetName=Xd?ze.NamedObjectName:ze.SheetName;var te=function(Pa){if(lb.a.Zwc(Pa)){var Sb=lb.a.O$b(Pa);od.jMa?lb.a.cQa(ac.a.applyItemFilter,Sb.MessageIdName,Zb.a.$ra,!0,lb.a.isSessionEndingError(Sb.MessageId)):W.ULS.sendTraceTag(537167129,0,10,"AutoFilterContextMenu::OnApplyFilterByValue failed with AutoFilterException -{0}",Sb.MessageIdName)}rb.a(Pa)||(W.ULS.sendTraceTag(537167128,0,
50,"AutoFilterContextMenu::OnApplyFilterByValue service call succeeded"),kb.b(od.$).Cd(qb.a.Qwf,od.dm(),void 0,!0),Pa=Object(va.a)(new la,{isSuccess:!0}),od.ULb.onApplyFilterByValueFinish(Pa),od.jL(od.TSa))},af=od.F2c(ae,ze),cf=new db.a(208,0,function(Pa,Sb,Jc){return wc.a(od.$.oa.xa,af,de.checkedItems,Aa.b(Pa,te),Sb,Jc,null,null)},6,function(){return new yb.a(de.checkedItems,af)});od.c3f(function(){od.$.userOperationManager.Sb(cf,null)})}else W.ULS.sendTraceTag(537167130,0,15,"AutoFilterContextMenu::OnApplyFilterByValue Received Zero checked items to apply filter on")};
od.AKg=function(de){var ae=dc.o(od.TSa,od.$),ze=dc.v(od.TSa,od.$),Xd=Object(va.a)(new fb.a,{SortConditionType:de.type,RowColOffset:ae.FirstColumn-ze.FirstColumn,SortColor:de.color,SortIconSet:de.icon.IconSet,SortIcon:de.icon.Icon,IsAscending:!0}),te={SortOptions:Object(va.a)(new Ma.a,{OperationType:1,ActiveCell:ae,SelectedRange:ze,SortConditions:[Xd],SortTopToBottom:!0,GuessHeader:!0,IsCaseSensitive:!1}),SelectedRange:ze,OriginalActiveCell:ae,ShouldRestoreSelection:!1};te.ShouldPromptNamedSheetViewTeachingDialog=
Ab.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures");W.ULS.sendTraceTag(537167119,0,50,"AutoFilterContextMenu.ApplySortByColorOrIcon: Aplying Sort, type: {0}",de.type);Ab.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures")?(de={},od.$.Fd(-1089513346,Db.a.Cb,19,(de.CustomSortCommandData=te,de))):od.c3f(function(){var af={};od.$.Fd(1659552324,Db.a.Cb,19,(af.CustomSortCommandData=te,af))})};od.jMa=lb.a.Xld();od.Ux=Ab.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");
return od}function da(){this.top=this.left=0}function xa(){this.onMenuItemClick=this.applyFilterByValueRequest=this.getFilterByValueItemsRequest=null;this.autoFilterMenuWidth=0;this.applySortByColorOrIconRequest=null}function ta(){this.autoFilterMenu=this.targetPoint=null}function ab(){this.filterByValueItems=null;this.hasMoreRecords=!1;this.searchText=null}function Na(){this.selectedSortIcon=this.selectedSortFontColor=this.selectedSortCellColor=this.getColorName=this.icons=this.fontColors=this.cellColors=
null}function Ka(){this.displayText=null;this.state=0;this.children=this.parent=this.key=null;this.indentationLevel=0;this.expanded=!1}function la(){this.isSuccess=!1}function Ea(){this.Title=this.MenuItems=this.Id=null;this.DisplayType=0}function ra(){this.Disabled=!1;this.RibbonCommand=this.Identifier=this.Type=0;this.SubMenu=this.Label=this.CommandData=null;this.IsChecked=!1;this.TooltipText=this.Id=this.IconName=null}function na(){this.Sections=this.Id=null}var ba=b(0),sa=b(905),ya=b(155),va=
b(7),W=b(15),La=b(84),Ia=b(4),mb=b(162),fb=b(1280),Ma=b(1278),Hb=b(927),Kb=b(5),Ub=b(495),gb=b(624),Db=b(76),Va=b(54),yb=b(1115),qb=b(133),dc=b(45),bb=b(564),db=b(177),wc=b(61),nb=b(51),zb=b(961),ma=b(151),P=b(37),oa=b(121),Ja=b(217),$a=b(92),Ta=b(69),pa=b(34),Da=b(29),rb=b(296),Ab=b(1),ob=b(186),sb=b(14),Pb=b(62),Aa=b(295),Ya=b(21),kb=b(134),lb=b(983),ac=b(984),Dc=b(126),Zb=b(112),mc=b(50),Lb=b(33),Sa=b(446);Object(ba.a)(na,"AutoFilterMenu",null,[]);Object(ba.a)(ra,"MenuItem",null,[]);Object(ba.a)(Ea,
"MenuSection",null,[]);Object(ba.a)(la,"ApplyFilterByValueResponse",null,[]);Object(ba.a)(Ka,"FilterByValueItem",null,[]);Object(ba.a)(Na,"GetColorsAndIconsResponse",null,[]);Object(ba.a)(ab,"GetFilterByValueItemsResponse",null,[]);Object(ba.a)(ta,"ShowSortFilterMenuParams",null,[]);Object(ba.a)(xa,"SortFilterControllerFactoryParams",null,[]);Object(ba.a)(da,"TargetPoint",null,[]);var Cb=b(58),ec=b(259),wb=b(36),rc=b(163),Mc=b(223),Pc=Kb.a.V1g,Kc=Hb.a;Rk(S,Kc);S.prototype.executeCommand=function(jb,
Eb,nc){var $c=this;jb=Eb.command;switch(jb){case 1701016594:return Hb.a.Nwh(nc),Cb.Task.Ua(!0);case 966232027:if(Ab.EwaSettings.xl()){var od=new mb.a;P.TaskExtensions.Ba(nb.GetServiceTaskFactory.Ra(this.$.da,8,9,0),function(de){$c.r5e(Eb,nc,de.result);od.setResult(!0)},this.la,3).continueWith(function(){od.setResult(!1)},5,this.la,Mc.a.instance);return od.task}this.r5e(Eb,nc);return Cb.Task.Ua(!0);default:return ob.a(jb)}};S.prototype.r5e=function(jb,Eb,nc){var $c=this,od=Eb.domEvent;if(Ta.e(od.rawEvent)&&
(Ta.g(od),od.target)){var de=new ma.a(this.$.va);if(de.Vd(4096)||de.Vd(2048)){var ae=Va.a.Vh(Eb[Db.a.Vf]);this.B1f(ae)&&(this.Ckf?this.Tsc(od,od.target,ae,jb,nc):(this.$Fb=function(){$c.B1f(ae)&&($c.Pai(),$c.Tsc(od,od.target,ae,jb,nc),$c.q2a=Ab.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FilterByValueSearch",!1),$c.Ckf=!0)},this.ayc()))}}};S.prototype.Ac=function(jb,Eb,nc){if(jb=!!nc)switch(Eb.command){case 1701016594:case 966232027:Ab.EwaSettings.xl()||Ub.a(this.$)||(jb=!1,W.ULS.sendTraceTag(537167137,
0,15,"AutoFilterContextMenu.CanExecuteCommand: ContextMenuManager is not ready. RibbonCommand was {0}",mc.b().fi(Eb.command)));break;default:jb=!1}return jb};S.prototype.dDd=function(jb){Array.addRange(jb.MenuSectionList,this.rrb)};S.prototype.Pai=function(){var jb=this;Sa.a(function(){jb.ULb=sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController(Object(va.a)(new xa,{getFilterByValueItemsRequest:jb.iLi,applyFilterByValueRequest:jb.fGi,onMenuItemClick:jb.onMenuItemClick,autoFilterMenuWidth:S.mse,
applySortByColorOrIconRequest:jb.AKg}))});this.w9c=La.a.instance.nh("Common.IExternalUICommandDefinitionMapping")||new gb.a(this.$.yb,this.$)};S.prototype.Tsc=function(jb,Eb,nc,$c,od){kb.b(this.$).Cd(qb.a.Tsc,this.dm(),void 0,!0);W.ULS.shipAssertTag(537167135,0,!!nc,"Attempt at opening AutoFilterContextMenu failed, autoFilterData is null.");jb=this.vIh(nc,od);od=Sys.UI.DomElement.getBounds(Eb);$c=od.x+od.width;od=od.y;if(this.Ux&&!nc.IsHeaderSnapped){if(Ab.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")&&
!Hb.a.Amd(this.$,nc.Cell))return;nc=Hb.a.Jcd(this.$,nc.Cell,!0);$c=nc.x;od=nc.y}nc=Ya.g(this.$).rtl?new Sys.UI.Point($c-Lb.a(this.$).PFa(S.mse),od):new Sys.UI.Point($c,od);this.qTa(nc,Eb);nc=Lb.a(this.$).xja(nc);Eb=Object(va.a)(new ta,{targetPoint:Object(va.a)(new da,{left:nc.x,top:nc.y}),autoFilterMenu:jb});this.ULb.showSortFilterMenu(Eb);this.$.Fd(-544117314,-1,0,null)};S.prototype.B1f=function(jb){return Ab.EwaSettings.isChangeGateEnabled("OfficeVSO:5819197_CheckActiveItemBeforeRenderingAutofilterMenu")&&
jb.Cell.SheetName?Ya.g(this.$).Z4?jb.Cell.SheetName===this.$.pa.name:jb.Cell.SheetName===this.$.pa.sheetName:!0};S.prototype.vIh=function(jb,Eb){return(jb=this.wIh(jb,Eb))?this.CIf(jb):null};S.prototype.CIf=function(jb){for(var Eb=[],nc=ak(jb.Sections),$c=nc.next();!$c.done;$c=nc.next())$c=$c.value,Object(rc.f)(this.$)&&Ab.EwaSettings.isChangeGateEnabled("OfficeVSO:6122433_NSVTitleEnabled")&&$c.Title===sb.a.instance.ga(1926)||($c=this.W0i($c),Eb.push($c));return Object(va.a)(new na,{Id:jb.Id,Sections:Eb})};
S.prototype.W0i=function(jb){for(var Eb=[],nc=ak(jb.MenuItems),$c=nc.next();!$c.done;$c=nc.next())if($c=$c.value,2===$c.Identifier)this.dWc=$c.CommandData;else switch($c.Type){case 3:case 2:Eb.push(this.U0i($c,2===$c.Type));break;case 1:Eb.push(this.V0i($c))}return Object(va.a)(new Ea,{MenuItems:Eb,DisplayType:jb.DisplayType,Id:this.JFh(jb)})};S.prototype.V0i=function(jb){var Eb=this.jVe(jb);var nc=Eb.label;var $c=Eb.cLa;Eb=this.CIf(jb.SubMenu);var od=this.$Ue(jb);$c=this.w9c.Mac($c);nc=nc||jb.Label;
return Object(va.a)(new ra,{Disabled:jb.Disabled,Type:jb.Type,Identifier:jb.Identifier,Id:od,CommandData:jb.CommandData,Label:nc,SubMenu:Eb,IsChecked:jb.IsChecked,IconName:"MissingIcon_20"===$c?null:$c})};S.prototype.U0i=function(jb,Eb){var nc=this.y$b(jb,Eb&&jb.IsChecked);Eb=nc.label;var $c=nc.cLa;nc=nc.pr;var od=this.Ibd(jb,Eb);$c=this.w9c.Mac($c);return Object(va.a)(new ra,{Disabled:jb.Disabled,Type:jb.Type,Identifier:jb.Identifier,Id:od,RibbonCommand:nc,CommandData:jb.CommandData,Label:Eb||jb.Label,
SubMenu:null,IsChecked:jb.IsChecked,IconName:"MissingIcon_20"===$c?null:$c})};S.prototype.wIh=function(jb,Eb){var nc;this.TSa=nc=dc.C(jb.Cell);this.sheetName=this.$.pa.sheetName;Eb=Eb||Ub.a(this.$);if(jb.IsHeaderSnapped)nc=Eb.n9b.GPh(nc);else{Eb=Ya.g(this.$).Ea.$Ja(nc);if(!Eb)return this.jMa?lb.a.cQa(ac.a.UKf,Dc.a.T0h,Zb.a.uZa,!0,!1):W.ULS.sendTraceTag(537167134,0,10,"AutoFilterContextMenu.GetAutoFilterMenuProps: gridModelCellProxy that is supposed to hold model is null. Range requested {0}, visible range: {1}",
nc,Ya.g(this.$).view.visibleArea),null;nc=Eb.autoFilterMenu}if(!nc)return this.jMa?lb.a.cQa(ac.a.UKf,Dc.a.Pzi,Zb.a.uZa,!0,!1):W.ULS.sendTraceTag(537167133,0,10,"AutoFilterContextMenu.GetMenuPropsFromCachedBlock: a cell that's supposed to have an autofilter menu returned a null menu."),null;this.dsb=jb.Cell.FirstRow+"_"+jb.Cell.FirstColumn;return nc};S.prototype.ayc=function(){var jb=this;if(this.$.ea.fh){var Eb=nb.GetServiceTaskFactory.Ra(this.$.da,283,284,1);P.TaskExtensions.Ba(Eb,function(){jb.jMa?
Eb.result.tn.loadScript("sortFilter").then(function(){jb.$Fb()},function(nc){Pb.a.gk(nc,"AutoFilterContextMenu.SortFilterScriptLoad");lb.a.cQa(ac.a.ayc,Dc.a.aDj,Zb.a.uZa,!1,!1)}):P.TaskExtensions.Ba(ec.c(Eb.result.tn.loadScript("sortFilter")),function(){jb.$Fb()},jb.$.la,3)},this.$.la,3)}else this.$.ea.wl(this.TV)};S.prototype.H4g=function(jb){var Eb={};Eb.SearchText=jb;Eb.Page=1;Eb.DateNodeType=-1;return Eb};S.prototype.CUg=function(){this.YOa&&(W.ULS.sendTraceTag(537167132,0,15,"AutoFilterContextMenu.CancelGetAutoFilterItemListWebRequest Cancelling pending getAutoFilterItemList request with ID={0}",
this.YOa),wc.h(this.$.oa.xa,this.YOa,null,null,null),this.YOa=null);this.q$a&&(Ia.AFrameworkApplication.qd.nu(this.q$a.Ht),this.q$a=null)};S.prototype.Bzd=function(jb){var Eb=this;return function(nc){Eb.YOa=null;Eb.q$a=null;if(lb.a.Zwc(nc)){var $c=lb.a.O$b(nc);Eb.jMa?lb.a.cQa(jb?ac.a.searchAutoFilterItemList:ac.a.getAutoFilterItemList,$c.MessageIdName,Zb.a.uZa,!0,!0):W.ULS.sendTraceTag(537167127,0,10,"AutoFilterContextMenu::OnGetFilterByValueItemsSuccessCallback failed with AutoFilterException -{0}",
$c.MessageIdName)}if(!rb.a(nc)){W.ULS.sendTraceTag(537167126,0,50,"AutoFilterContextMenu::OnGetFilterByValueItems service call succeeded");nc=nc.Result;$c=new pa.a(!0);var od=nc.AutoFilterDateNodes?!0:!1;nc.AutoFilterItems&&$c.add("AutoFilterItemsCount",nc.AutoFilterItems.length);od&&$c.add("AutoFilterDateItemsCount",nc.AutoFilterDateNodes.length);$c.add("Location","contextMenu");kb.b(Eb.$).Cd(qb.a.Bzd,$c.cu,void 0,!0);$c=Eb.q2a?Object(va.a)(new ab,{filterByValueItems:Eb.nBe(nc),hasMoreRecords:nc.ItemListMaxExceeded,
searchText:nc.SearchText}):Object(va.a)(new ab,{filterByValueItems:Eb.nBe(nc),hasMoreRecords:nc.ItemListMaxExceeded});Eb.ULb.onGetFilterByValueItemsFinish($c);jb||(W.ULS.shipAssertTag(529063959,0,null!==nc.FontColors&&null!==nc.CellColors&&null!==nc.Icons&&null!==nc.SelectedSortFontColors&&null!==nc.SelectedSortCellColors&&null!==nc.SelectedSortIcons,"AutoFilterContextMenu.onGetFilterByValueItemsSuccessCallback: SortByColor items should not be null"),nc=Object(va.a)(new Na,{fontColors:nc.FontColors,
cellColors:nc.CellColors,icons:nc.Icons,selectedSortFontColor:0<nc.SelectedSortFontColors.length?nc.SelectedSortFontColors[0]:null,selectedSortCellColor:0<nc.SelectedSortCellColors.length?nc.SelectedSortCellColors[0]:null,selectedSortIcon:0<nc.SelectedSortIcons.length?nc.SelectedSortIcons[0]:null,getColorName:Eb.getColorName}),Eb.ULb.onGetColorsAndIconsFinish(nc))}}};S.prototype.jLi=function(){var jb=this;return function(Eb){jb.YOa=null;jb.q$a=null;Eb=oa.a.Of(Eb.data);W.ULS.sendTraceTag(537167125,
0,10,"AutoFilterContextMenu.OnGetFilterByValueItemsFailureCallback Errors: [{0}].",Da.a.Dc(Eb))}};S.prototype.nBe=function(jb){var Eb=this.w2g(jb),nc=this.D2g(jb.AutoFilterItems),$c=[],od=0;jb.HasBlanks&&(jb=S.T2c(sb.a.instance.ga(781),jb.IsBlanksSelected?1:0,Kb.a.lse),$c[od++]=jb);Eb=ak(Eb);for(jb=Eb.next();!jb.done;jb=Eb.next())jb=jb.value,$c[od++]=jb;nc=ak(nc);for(jb=nc.next();!jb.done;jb=nc.next())Eb=jb.value,$c[od++]=Eb;return $c};S.prototype.w2g=function(jb){var Eb=[];if(!jb.AutoFilterDateNodes||
!jb.AutoFilterDateNodes.length)return Eb;for(var nc=[this.I3a(jb.YearKeys,jb.YearValues),this.I3a(jb.MonthKeys,jb.MonthValues),this.I3a(jb.DayKeys,jb.DayValues),this.I3a(jb.HourKeys,jb.HourValues),this.I3a(jb.MinuteKeys,jb.MinuteValues),this.I3a(jb.SecondKeys,jb.SecondValues)],$c=!1,od=!1,de=0,ae=null,ze=Array(6),Xd=null,te=ak(jb.AutoFilterDateNodes),af=te.next();!af.done;af=te.next()){af=af.value;ze[0]&&(Xd.Year!==af.Year?($c=!0,de=0,ae=null):Xd.Month!==af.Month?(od=!0,de=1,ae=ze[0]):Xd.Day!==af.Day?
(de=2,ae=ze[1]):jb.ShowTime&&(Xd.Hour!==af.Hour?(de=3,ae=ze[2]):Xd.Minute!==af.Minute?(de=4,ae=ze[3]):(de=5,ae=ze[4])));for(;6>de;){switch(de){case 0:var cf=af.Year;Xd=nc[0].getItem(cf.toString());break;case 1:cf=af.Month;Xd=nc[1].getItem(cf.toString());break;case 2:cf=af.Day;Xd=nc[2].getItem(cf.toString());break;case 3:cf=af.Hour;Xd=nc[3].getItem(cf.toString());break;case 4:cf=af.Minute;Xd=nc[4].getItem(cf.toString());break;case 5:cf=af.Second;Xd=nc[5].getItem(cf.toString());break;default:throw Error.invalidOperation("Unknown AutoFilterDateNodeType.");
}Xd=S.T2c(Xd,-1!==af.NodeType&&de>=af.NodeType?1:0,ae?ae.key+";"+cf:Kb.a.eXc+cf,!1,[]);ae=ae?ae.children:Eb;ae=ae[ae.length]=Xd;ze[de]=Xd;switch(de){case 5:de=6;break;case 2:de=jb.ShowTime?de+1:6;break;default:de++}}Xd=af}$c||(ze[0].expanded=!0,od||(ze[1].expanded=!0));return Eb};S.prototype.D2g=function(jb){var Eb=[];if(!jb)return Eb;var nc=0;jb=ak(jb);for(var $c=jb.next();!$c.done;$c=jb.next())$c=$c.value,Eb[nc++]=S.T2c($c.DisplayString,$c.Selected?1:0,Kb.a.fXc+$c.DisplayString);return Eb};S.prototype.I3a=
function(jb,Eb){var nc=new pa.a(!0);if(!jb||!Eb)return nc;for(var $c=jb.length<Eb.length?jb.length:Eb.length,od=0;od<$c;od++)nc.add(jb[od].toString(),Eb[od]);return nc};S.prototype.F2c=function(jb,Eb){var nc={};nc.Location=Eb;nc.FieldId=jb.Id.toString();nc.DataSourceIndex=-1;nc.FilterType=jb.AutoFilterType;nc.AnchorType=0;nc.ChartId=null;nc.AnchorValue1=-1;nc.AnchorValue2=-1;nc.Property=jb.RichProperty;return nc};S.prototype.jL=function(jb){wb.a.Bba(this.$)&&P.TaskExtensions.Ba(nb.GetServiceTaskFactory.Ra(this.$.da,
430,431,1),function(Eb){Eb.result.iea(jb);W.ULS.sendTraceTag(537167123,306,50,"AutoFilterContextMenu:TriggerPivotTableHandRaise Trigger hand raise from filter context menu.")},this.$.la,3)};S.prototype.dm=function(){var jb={};return jb.Location="contextMenu",jb};S.prototype.getColorName=function(jb){return zb.a.ZJa(Ja.a.YG(jb))};S.prototype.c3f=function(jb){P.TaskExtensions.Ba(nb.GetServiceTaskFactory.Ra(this.$.da,309,310,3),function(Eb){Eb.result.FAa().continueWith(function(nc){nc.result&&jb()})},
this.$.la,3)};S.T2c=function(jb,Eb,nc,$c,od){jb=void 0===jb?null:jb;Eb=void 0===Eb?0:Eb;nc=void 0===nc?null:nc;$c=void 0===$c?!1:$c;od=void 0===od?null:od;return Object(va.a)(new Ka,{displayText:jb?Hb.a.rh(jb):jb,state:Eb,key:nc,parent:null,children:od,indentationLevel:0,expanded:$c})};Af.Object.defineProperties(S.prototype,{yw:{configurable:!0,enumerable:!0,get:function(){return"PopulateAutoFilterContextMenu"}},wB:{configurable:!0,enumerable:!0,get:function(){return Kb.a.SKf}}});S.mse=268;Object(ba.a)(S,
"AutoFilterContextMenu",Hb.a,[]);var ub=b(934),Fb=b(85),pc=b(202),eb=b(66),ic=b(18);Qa.ZRe=26;Qa.A$c=[230,231,0,99,0,95,94];Object(ba.a)(Qa,"Constants",null,[]);Af.Object.defineProperties(wa.prototype,{sji:{configurable:!0,enumerable:!0,get:function(){return 3===this.I4b}},Xmi:{configurable:!0,enumerable:!0,get:function(){return 4===this.I4b&&!!this.subMenu}},subMenu:{configurable:!0,enumerable:!0,get:function(){return this.Qwg}},lpf:{configurable:!0,enumerable:!0,get:function(){return this.ssg}},
I4b:{configurable:!0,enumerable:!0,get:function(){return this.Kmg}},o4c:{configurable:!0,enumerable:!0,get:function(){return this.Omg}}});Object(ba.a)(wa,"FiltersMenuData",null,[]);Rk(ia,wa);Object(ba.a)(ia,"AutoFilterFiltersMenuData",wa,[]);ha.gIj=[new wa(100,2,0,null),new wa(101,2,1,null),new wa(0,3,0,null),new wa(172,2,2,null),new wa(174,2,4,null),new wa(0,3,0,null),new wa(176,2,6,null),new wa(177,2,7,null),new wa(0,3,0,null),new wa(108,0,0,null)];ha.EEi=[new wa(100,2,0,null),new wa(101,2,1,null),
new wa(0,3,0,null),new wa(102,2,8,null),new wa(103,2,10,null),new wa(104,2,12,null),new wa(0,3,0,null),new wa(105,1,0,null),new ia(106,1),new ia(107,2),new wa(0,3,0,null),new wa(108,0,0,null)];ha.tbh=[new wa(100,2,0,null),new wa(0,3,0,null),new wa(112,2,10,null),new wa(113,2,8,null),new wa(104,2,12,null),new wa(0,3,0,null),new ia(110,8),new ia(109,9),new ia(111,10),new wa(0,3,0,null),new ia(115,11),new ia(114,12),new ia(116,13),new wa(0,3,0,null),new ia(117,14),new ia(118,15),new ia(119,16),new wa(0,
3,0,null),new ia(120,17),new ia(121,18),new ia(122,19),new wa(0,3,0,null),new ia(123,20),new ia(124,21),new ia(125,22),new wa(0,3,0,null),new ia(126,23),new wa(127,2,12,[new ia(128,24),new ia(129,25),new ia(130,26),new ia(131,27),new wa(0,3,0,null),new ia(132,28),new ia(133,29),new ia(134,30),new ia(135,31),new ia(136,32),new ia(137,33),new ia(138,34),new ia(139,35),new ia(140,36),new ia(141,37),new ia(142,38),new ia(143,39)]),new wa(0,3,0,null),new wa(108,0,0,null)];Object(ba.a)(ha,"Constants",null,
[]);var Ac=b(1116),lc=b(77),Gc=Hb.a;Rk(fa,Gc);fa.prototype.executeCommand=function(jb,Eb,nc){jb=Eb.command;switch(jb){case -699941697:this.applyAutoFilterFieldList(Eb,nc);break;case 216058793:String.format("TableFieldListContextMenu:AutoFilterFieldListContextMenuClose");break;case -1494291901:break;default:return ob.a(jb)}return Cb.Task.Ua(!0)};fa.prototype.Acd=function(jb,Eb){return!jb||jb.length<=Eb?(W.ULS.sendTraceTag(537167117,0,10,"AutoFilterFieldListContextMenu:GetCommandId - incomplete id list"),
-1):parseInt(jb[Eb],10)};fa.prototype.JEd=function(jb,Eb,nc,$c,od,de){var ae=this.Acd(od,de);0>ae&&W.ULS.sendTraceTag(537167116,0,10,"AutoFilterFieldListContextMenu:ProcessCommand - command id not found");switch(Qa.A$c[ae]){case 99:jb=new $a.a(-2058042992,Eb.method,Eb.mode,Eb.Me,Eb.tabName);this.cm.DG.ltb(this.$,$c,0,jb);break;case 230:jb=new $a.a(504133448,Eb.method,Eb.mode,Eb.Me,Eb.tabName);this.cm.DG.ltb(this.$,$c,0,jb);break;case 231:jb=new $a.a(-798968736,Eb.method,Eb.mode,Eb.Me,Eb.tabName);
this.cm.DG.ltb(this.$,$c,0,jb);break;case 235:jb=new $a.a(-1677817820,Eb.method,Eb.mode,Eb.Me,Eb.tabName);this.cm.DG.ltb(this.$,$c,0,jb);break;case 95:this.SIf(jb,Eb,$c,nc,od,de+1);break;case 94:this.cm.DG.Xqi(this.$,$c)}};fa.prototype.SIf=function(jb,Eb,nc,$c,od,de){var ae=this.Acd(od,de);0>ae&&W.ULS.sendTraceTag(537167115,0,10,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand - command id not found");if(!$c||ae>=$c.length)W.ULS.sendTraceTag(537167114,0,15,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand() - no menuData.");
else switch($c=$c[ae],$c.I4b){case 1:this.cm.DG.qri(this.$,nc);break;case 2:(od=Object(Fb.a)(ia,$c))?(jb=new $a.a(-2058042992,Eb.method,Eb.mode,Eb.Me,Eb.tabName),this.cm.DG.ltb(this.$,nc,od.nse,jb)):this.cm.DG.qjf(this.$,jb,nc,$c.o4c);break;case 0:this.cm.DG.qjf(this.$,jb,nc,$c.o4c);break;case 4:this.SIf(jb,Eb,nc,$c.subMenu,od,de+1)}};fa.prototype.applyAutoFilterFieldList=function(jb,Eb){var nc=Eb[ub.a.TF];if(nc)if(nc=nc.split(eb.a.BU),3>nc.length)W.ULS.sendTraceTag(537167112,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - unexpected SourceIdControl string.");
else{var $c=this.Acd(nc,1),od=this.NJa($c),de=this.gpf($c).returnValue;de?this.JEd(Eb,jb,de,od,nc,2):W.ULS.sendTraceTag(537167111,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - menu data not found for index "+$c.toString()+eb.a.BU)}else W.ULS.sendTraceTag(537167113,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - SourceIdControl string is null.")};fa.prototype.Ac=function(jb,Eb){if(jb=this.$.isEditMode)switch(Eb.command){case 216058793:break;case -699941697:break;
case -1494291901:jb=!0;break;default:jb=!1}return jb};fa.prototype.y0=function(jb,Eb,nc){this.$.isEditMode&&((this.cm=Object(Fb.a)(689,nc))||W.ULS.sendTraceTag(537167110,0,10,"AutoFilterFieldListContextMenu:ShowDropDown() - filterInfoManager not found."),this.QY(),Gc.prototype.y0.call(this,jb,Eb,null,null,!0))};fa.prototype.N2c=function(){if(!this.cm||!this.cm.Hk||1!==this.cm.Hk.length)return W.ULS.sendTraceTag(537167109,0,15,"AutoFilterFieldListContextMenu:CreateContextMenuItemList() - incorrect fields list."),
null;var jb=this.cm.Hk[0],Eb=new pc.a;Eb.add(sb.a.instance.ga(251));Eb=lc.OBc(lc.concat(Eb,lc.select(lc.asEnumerable(jb.FieldInfoDataList),function(nc){return nc.Name})),function(nc){return nc},new Ac.a);return lc.toArray(Eb)};fa.prototype.fieldIndex=function(jb){if(!this.cm||!this.cm.Hk||1!==this.cm.Hk.length||!this.cm.Hk[0].FieldInfoDataList)return-1;for(var Eb=0;Eb<this.cm.Hk[0].FieldInfoDataList.length;++Eb)if(this.cm.Hk[0].FieldInfoDataList[Eb].Name===jb)return Eb;return-1};fa.prototype.NJa=
function(jb){return 0>jb||!this.cm||!this.cm.Hk||1!==this.cm.Hk.length||!this.cm.Hk[0].FieldInfoDataList||this.cm.Hk[0].FieldInfoDataList.length<jb?null:this.cm.Hk[0].FieldInfoDataList[jb].Name};fa.prototype.QY=function(){var jb=this,Eb=this.N2c();if(!Eb||!Eb.length)return null;for(var nc=this.Va,$c=nc.Bc(),od={},de=0;de<Eb.length;od={Jfb:od.Jfb},++de){var ae=Eb[de];od.Jfb=0<de?this.fieldIndex(ae):-1;for(var ze=fa.G4f+od.Jfb.toString()+eb.a.BU,Xd=null,te=this.cm.DG.E4h(0<de?ae:null),af=this.W2c(nc,
te,fa.G4f+od.Jfb.toString(),ae),cf={},Pa=0;Pa<Qa.A$c.length;cf={oPb:cf.oPb,Ifb:cf.Ifb},++Pa){var Sb=Qa.A$c[Pa],Jc=ze+Pa.toString();Xd||(Xd=nc.Bc());switch(Sb){case 230:Xd.buttons.push(nc.Pc(223,Jc,-699941697,this.cm.DG.Imi(0<de?ae:null)?ic.a.s8b:ic.a.HIa,8,230,!1,null));break;case 231:Xd.buttons.push(nc.Pc(224,Jc,-699941697,this.cm.DG.Jmi(0<de?ae:null)?ic.a.t8b:ic.a.IIa,8,231,!1,null));break;case 235:Xd.buttons.push(nc.Pc(225,Jc,-699941697,ic.a.q8b,1,235,!1,null));break;case 99:Sb=this.bRg(ae);Jc=
nc.rHa(Jc+(te?".enabled":".disabled"),Sb,-699941697,null,"None",null,!te,void 0,!0);Jc.bS("Image16by16",8,ic.a.d2a);Xd.buttons.push(Jc);break;case 95:cf.oPb=void 0;cf.Ifb=void 0;var nd=function(zd,Zd){return function(){var be=jb.gpf(zd.Jfb);Zd.oPb=be.hSe;Zd.Ifb=be.isChecked;return be}}(od,cf)().returnValue;if(!nd)return null;Sb=this.W2c(nc,cf.Ifb&&te,Jc,cf.oPb);Jc=this.oVe(Sb.menu,nc,Jc+eb.a.BU,nd,cf.Ifb&&te);Sb.menu.pc.push(Jc);Xd.buttons.push(Sb);break;case 0:Xd&&(af.menu.pc.push(Xd),Xd=null);break;
default:Jc=nc.rHa(Jc,sb.a.instance.ga(Sb),-699941697,null,"None",null,!1,void 0,!0),this.UXf(Jc,te&&94===Sb&&this.cm.DG.filter(),sb.a.instance.ga(Sb)),Xd.buttons.push(Jc)}}af.menu.pc.push(Xd);$c.buttons.push(af)}Eb=nc.mq(this.menuId);Eb.pc.push($c);return Eb};fa.prototype.oVe=function(jb,Eb,nc,$c,od){for(var de=null,ae=0;ae<$c.length;++ae){var ze=$c[ae],Xd=nc+ae.toString(),te=!1;switch(ze.I4b){case 1:te=od&&this.cm.DG.Jh.IsTop10;break;case 2:te=Object(Fb.a)(ia,ze);te=od&&this.cm.DG.cgi(te?te.nse:
0,ze.o4c);break;case 0:te=od&&this.cm.DG.Jh.IsCustomSupportedAndNotPresent}de||(de=Eb.Bc());if(ze.sji)de&&(jb.pc.push(de),de=null);else if(ze.Xmi){var af=sb.a.instance.ga(ze.lpf);af=this.W2c(Eb,te,Xd,af);af.menu.pc.push(this.oVe(af.menu,Eb,Xd+eb.a.BU,ze.subMenu,te));de.buttons.push(af)}else ze=sb.a.instance.ga(ze.lpf),Xd=Eb.rHa(Xd,ze,-699941697,null,"None",null,!1,void 0,!0),this.UXf(Xd,te,ze),de.buttons.push(Xd)}return de};fa.prototype.UXf=function(jb,Eb,nc){Eb?jb.bS("Image16by16",8,ic.a.eua):jb.bS("None",
0,null);jb.$R(nc);jb.label=nc};fa.prototype.W2c=function(jb,Eb,nc,$c){return Eb?jb.O2c(nc,this.menuId,$c,798637440,8,ic.a.eua):jb.Tv(nc,this.menuId,$c,798637440)};fa.prototype.uh=function(jb){return!jb||!jb.length};fa.prototype.gpf=function(jb){var Eb=0>jb?0:this.cm.Hk[0].FieldInfoDataList[jb].MajorityDataTypeForField;var nc=null;jb=this.cm.DG.D4h(Eb);switch(Eb){case 0:nc=96;Eb=ha.gIj;break;case 1:nc=95;Eb=ha.EEi;break;case 2:nc=97;Eb=ha.tbh;break;default:return W.ULS.sendTraceTag(537167108,0,10,
"AutoFilterFieldListContextMenu:MenuDataForDataType() - unknown data type."),{returnValue:null,hSe:nc,isChecked:jb}}nc=sb.a.instance.ga(nc);return{returnValue:Eb,hSe:nc,isChecked:jb}};fa.prototype.bRg=function(jb){!jb||this.uh(jb.trim())?jb=sb.a.instance.ga(98):jb.length>Qa.ZRe?(jb=jb.substring(0,Qa.ZRe),jb=String.format(sb.a.instance.lb(155),jb)):jb=String.format(sb.a.instance.lb(156),jb);return jb};Af.Object.defineProperties(fa.prototype,{yw:{configurable:!0,enumerable:!0,get:function(){return"PopulateAutoFilterFieldListContextMenu"}},
wB:{configurable:!0,enumerable:!0,get:function(){return Kb.a.TKf}}});fa.Dyh=Kb.a.U1g;fa.PIb="AutoFilterFieldListContextMenuRoot";fa.G4f="ApplyAutoFilterFieldList.";Object(ba.a)(fa,"AutoFilterFieldListContextMenu",Hb.a,[]);var ed=b(611),fd=b(1049),Bc=b(10),ld=b(122),Bd=b(391),xb=Hb.a;Rk(qa,xb);qa.prototype.executeCommand=function(jb,Eb,nc){jb=Object(Fb.a)(ed.a,nc.eventArgs);switch(Eb.command){case -1372040782:nc=Ya.g(this.$).ha.Oa.Yb;W.ULS.shipAssertTag(537167048,0,!!nc);nc&&(this.floatingObject=nc.floatingObject,
this.mb=Eb.method,Eb=this.qac(jb),this.np(Eb,!0,jb.mb));break;case 848910589:jb&&(Eb=[fd.a.h0f],jb=new Sys.UI.Point(jb.Ca.clientX,jb.Ca.clientY),this.showFloatie(Eb,new Sys.UI.Bounds(jb.x,jb.y,0,0),2))}return Cb.Task.Ua(!0)};qa.prototype.Ac=function(jb,Eb,nc){switch(Eb.command){case -1372040782:return!!nc&&this.Fgf(jb);case 848910589:return jb=Ya.g(this.$).ha.Oa.Yb,!!nc&&!!jb&&jb.isEditing;default:return!1}};qa.prototype.Fgf=function(jb){switch(jb){case 8:case 2:case 64:case 4:case 256:return!0;default:return!1}};
qa.prototype.JTc=function(jb,Eb,nc){Bd.a(this.$)?Ya.g(this.$).eb.Ni||(Lb.a(this.$).KQd()?nc.buttons.push(jb.nb(265)):nc.buttons.push(jb.nb(264))):(this.$.isEditMode&&3===this.mb&&!this.S9b()&&nc.buttons.push(jb.nb(101)),5!==this.floatingObject.type||ld.a.yH(this.floatingObject.xb)||this.floatingObject.xb.IsGroup||(Ab.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&this.Lpd()?nc.buttons.push(jb.nb(186)):nc.buttons.push(jb.nb(147))),this.S9b()||this.Lpd()||nc.buttons.push(jb.nb(146)),
Ab.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeFOZOrder",!1)&&(this.LEh(nc),this.mGh(nc)),Ab.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&0===this.floatingObject.type&&nc.buttons.push(jb.nb(287)),Ab.EwaSettings.ma(167)&&0===this.floatingObject.type&&nc.buttons.push(jb.nb(249)),5===this.floatingObject.type&&Ya.g(this.$).ha.Oa.Yb.g5()&&this.$.xka&&this.$.Wga&&nc.buttons.push(jb.nb(273)))};qa.prototype.PJa=function(jb){var Eb=[];if(Bd.a(this.$))return Eb;
3===jb?(jb=!!this.$.Lf.get(5)&&this.floatingObject.NTd(),this.S9b()||(this.$.isEditMode?(jb&&Eb.push(fd.a.IBh),5===Ya.g(this.$).ha.Oa.sC.floatingObject.type&&Eb.push(fd.a.Cuj)):jb&&Eb.push(fd.a.copy)),Eb.push(fd.a.JBh)):2===jb&&(Ab.EwaSettings.isChangeGateEnabled("OfficeVSO:4840604_JsCrashInGetFloatieGroupsForSelection")?Ya.g(this.$).ha.Oa.Yb&&this.c_e(Ya.g(this.$).ha.Oa.Yb,Eb):this.c_e(Ya.g(this.$).ha.Oa.sC,Eb));return Eb};qa.prototype.QY=function(){var jb=this.Va,Eb=jb.mq(this.menuId),nc=Bd.a(this.$);
if(this.$.isEditMode){var $c=jb.Bc();this.JTc(jb,Eb,$c);Eb.pc.push($c)}this.$.Lf.get(5)&&this.floatingObject.NTd()&&!this.S9b()&&!nc&&($c=jb.Bc(),this.FAg(jb,$c),Eb.pc.push($c));($c=this.$.va.pa)&&$c.Md&&($c=$c.Md.Wx||$c.Md.dK,!Ab.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||0!==this.floatingObject.type||this.$.ea.isNamedObjectViewMode||nc||this.$.isMobileMode||$c||(nc=jb.Bc(),this.ACg(jb,nc),Eb.pc.push(nc)));return Eb};qa.prototype.qac=function(jb){var Eb=Ya.g(this.$).ha.Oa.Yb;
jb=jb&&1!==jb.mb&&jb.clientPoint?jb.clientPoint:Sys.UI.DomElement.getLocation(Eb.domElement);var nc=this.$.domElement,$c=Ya.g(this.$).rtl;(Eb=Bc.HelperMethods.FC(Eb.dg.domElement,nc,$c))?(jb.y=Math.max(jb.y,Eb.y),jb.x=Math.max(jb.x,Eb.x)):W.ULS.sendTraceTag(537167047,5,15,"FloatingObjectContextMenu.GetContextMenuClientPoint sheetContentDivLocation is null if the offset parent is null. IsShuttingdown : {0}",Ia.AFrameworkApplication.Bg);return jb};qa.prototype.Lpd=function(){var jb=Ya.g(this.$).ha.Oa.Yb;
return!!jb&&jb.isEditing};qa.prototype.FAg=function(jb,Eb){if(this.$.isEditMode){Eb.buttons.push(jb.nb(42));Eb.buttons.push(jb.nb(43));var nc=this.$.da.za(254,!0);(nc&&2===nc.UAb()||Ab.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&this.Lpd())&&Eb.buttons.push(jb.nb(44))}else Eb.buttons.push(jb.nb(43))};qa.prototype.ACg=function(jb,Eb){Eb.buttons.push(jb.nb(274))};qa.prototype.S9b=function(){return Ab.EwaSettings.ma(467)&&!!Ya.g(this.$).ha.Oa.Bo};qa.prototype.c_e=function(jb,
Eb){5===jb.floatingObject.type?Ab.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&jb.isEditing?Eb.push(fd.a.h0f):Eb.push(fd.a.yuj):Eb.push(Hb.a.nTe)};qa.prototype.LEh=function(jb){var Eb=this.Va.Bc();Eb.buttons.push(this.Va.nb(282));Eb.buttons.push(this.Va.nb(281));var nc=this.Va.Tv("BringToFront","BringToFrontMenuId",sb.a.instance.ga(821),-1777747317);nc.menu.pc.push(Eb);jb.buttons.push(nc)};qa.prototype.mGh=function(jb){var Eb=this.Va.Bc();Eb.buttons.push(this.Va.nb(284));
Eb.buttons.push(this.Va.nb(283));var nc=this.Va.Tv("SendToBack","SendToBackMenuId",sb.a.instance.ga(822),-1777747317);nc.menu.pc.push(Eb);jb.buttons.push(nc)};Af.Object.defineProperties(qa.prototype,{yw:{configurable:!0,enumerable:!0,get:function(){return"PopulateFloatingObjectContextMenu"}},wB:{configurable:!0,enumerable:!0,get:function(){return Kb.a.aLf}}});Object(ba.a)(qa,"FloatingObjectContextMenu",Hb.a,[]);var Fd=b(1E3),Vd=b(103),se=b(620),ue=b(565),Ee=Kb.a.X1g;Rk(Y,qa);Y.prototype.executeCommand=
function(jb,Eb,nc){var $c=this.$;this.mb=Eb.method;Eb=nc[Y.p_c];if(!(jb&68)){if(!Eb){if(8===jb)Eb=ue.a($c).Oc;else{var od=Ya.g($c).ha.Oa.Yb;if(null===od||void 0===od?0:od.floatingObject)Eb=od.floatingObject.Oc}if(!Eb)return Cb.Task.Ua(!0)}this.isPivotChart=!!(Eb.Attributes&4)}if(this.isPivotChart||$c.isEditMode)if(this.refresh=this.eZ=this.Jva=this.CAa=!1,od=Ya.g(this.$).ha.Oa.Yb,W.ULS.shipAssertTag(537167107,0,!!od),od){this.floatingObject=od.floatingObject;od=se.a($c);if(null===od||void 0===od?
0:od.gQd)this.CAa=od=Vd.f($c.ng),this.Jva=!od;od=$c.ic;this.eZ=!!Fd.a($c)&&!!Eb&&!!(Eb.Attributes&512)&&!(jb&8)&&od.x2(32768);od.allowManualDataRefresh&&od.allowInteractivity&&(this.refresh=!0);jb=this.qac(Object(Fb.a)(ed.a,nc.eventArgs));this.np(jb,!0)}return Cb.Task.Ua(!0)};Y.prototype.Ac=function(jb,Eb,nc){return-149612405===Eb.command&&!!nc&&this.Fgf(jb)};Y.prototype.JTc=function(jb,Eb,nc){this.isPivotChart&&(this.refresh&&nc.buttons.push(jb.nb(100)),this.eZ&&nc.buttons.push(jb.nb(99)),this.CAa?
nc.buttons.push(jb.nb(59)):this.Jva&&nc.buttons.push(jb.nb(58)));qa.prototype.JTc.call(this,jb,Eb,nc)};Af.Object.defineProperties(Y.prototype,{yw:{configurable:!0,enumerable:!0,get:function(){return"PopulateChartContextMenu"}},wB:{configurable:!0,enumerable:!0,get:function(){return Kb.a.VKf}}});Af.Object.defineProperties(Y,{p_c:{configurable:!0,enumerable:!0,get:function(){return"chartMetaData"}}});Object(ba.a)(Y,"ChartContextMenu",qa,[]);var qe=b(12),He=Kb.a.Z1g,Ie=Hb.a;Rk(ka,Ie);ka.prototype.executeCommand=
function(jb,Eb,nc){jb=Eb.command;switch(jb){case 330754562:Eb=nc.domElement;this.isOlap=nc.isOlap;this.mL=nc.versionkey;this.io=nc.fieldItem;this.SZ=nc.isChart;this.wV=nc.isPpm;this.PTd="supportsImplicitMeasures"in nc?nc.supportsImplicitMeasures:!1;Ya.g(this.$).Ao(!0);jb=qe.DOMElementExtensions.getBounds(Eb);jb=new Sys.UI.Point(jb.x+jb.width,jb.y+jb.height/2);this.qTa(jb,Eb);"isKeyboardInput"in nc&&nc.isKeyboardInput?this.np(jb,!1,1):this.np(jb,!1);break;case 926905850:this.PTd&&this.io&&5===this.io.TypeTag&&
!this.io.IsCollapsible&&W.ULS.sendTraceTag(537167057,0,50,"Add implicit measurement from field list.");se.a(this.$).DJ(this.io,8,-1,this.mL,Eb);break;case -67292059:se.a(this.$).DJ(this.io,1,-1,this.mL,Eb);break;case 745182485:se.a(this.$).DJ(this.io,2,-1,this.mL,Eb);break;case 359279088:se.a(this.$).DJ(this.io,4,-1,this.mL,Eb);break;case 547535945:se.a(this.$).R4i(this.io);break;default:return ob.a(jb)}return Cb.Task.Ua(!0)};ka.prototype.Ac=function(jb,Eb,nc){jb=!1;switch(Eb.command){case 330754562:jb=
!!nc;break;case 926905850:case -67292059:case 745182485:case 359279088:case 547535945:jb=!0}return jb};ka.prototype.QY=function(){var jb=this.Va.mq(this.menuId);this.pZi(jb);this.SZ||this.isOlap||this.oZi(jb);return jb};ka.prototype.pZi=function(jb){var Eb=this.Va,nc=Eb.Bc(),$c=!1;Ab.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1)&&($c=this.isOlap&&!this.wV&&this.PTd&&5===this.io.TypeTag&&!this.io.IsCollapsible);3!==this.io.TypeTag&&37!==this.io.TypeTag||this.io.IsSet?
17===this.io.TypeTag||this.wV?(nc.buttons.push(Eb.nb(79)),nc.buttons.push(Eb.nb(this.SZ?91:80)),nc.buttons.push(Eb.nb(this.SZ?92:81)),nc.buttons.push(Eb.nb(82))):13===this.io.TypeTag||this.io.IsSet?(nc.buttons.push(Eb.nb(83)),nc.buttons.push(Eb.nb(this.SZ?91:80)),nc.buttons.push(Eb.nb(this.SZ?92:81)),nc.buttons.push(Eb.nb(86))):(nc.buttons.push(Eb.nb(79)),nc.buttons.push(Eb.nb(this.SZ?91:80)),nc.buttons.push(Eb.nb(this.SZ?92:81)),nc.buttons.push(Eb.nb($c?82:86))):(nc.buttons.push(Eb.nb(83)),nc.buttons.push(Eb.nb(this.SZ?
93:84)),nc.buttons.push(Eb.nb(this.SZ?94:85)),nc.buttons.push(Eb.nb(82)));jb.pc.push(nc)};ka.prototype.oZi=function(jb){var Eb=this.Va.Bc();Eb.buttons.push(this.Va.nb(78));jb.pc.push(Eb)};Af.Object.defineProperties(ka.prototype,{yw:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldListContextMenu"}},wB:{configurable:!0,enumerable:!0,get:function(){return Kb.a.SFd}}});Object(ba.a)(ka,"FieldListContextMenu",Hb.a,[]);var ef=b(440),Ye=b(64);ea.prototype.get=function(jb,Eb,nc){var $c=this.F$f(jb,
"PivotFilterContextMenuCache.Get");return $c&&this.fN[$c]?this.fN[$c][ea.wed(Eb,this.$,jb,nc)]:null};ea.prototype.set=function(jb,Eb,nc,$c){var od=this.F$f(jb,"PivotFilterContextMenuCache.Set");od&&(this.fN[od]||(this.fN[od]={}),this.fN[od][ea.wed(Eb,this.$,jb,$c)]=nc)};ea.prototype.f7b=function(jb){jb in this.fN&&this.fN[jb]&&(this.fN[jb]=null)};ea.prototype.F$f=function(jb,Eb){return Ye.f(this.$.pa)?this.$.activeItemName:(jb=this.UMj(jb,Eb))?jb.Kd:null};ea.prototype.UMj=function(jb,Eb){jb=dc.C(jb);
jb=Ya.g(this.$).Ea.$ua(jb,this.$.activeItemName);W.ULS.shipAssertTag(537167008,0,!!jb,"PivotFilterContextMenuBase.TryGetBlockModelProxyFromCell: Can't query the menuCache as block wasn't found in the BlockManager (returned null). Called from: {0}",Eb);return jb};ea.wed=function(jb,Eb,nc,$c){return Ab.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&0===$c?Eb.pa.index+"_"+jb.id+"_"+nc.FirstRow.toString()+"_"+nc.FirstColumn.toString():Eb.pa.index+"_"+jb.id};Object(ba.a)(ea,"PivotFilterContextMenuCache",
null,[]);Object(ba.a)(Z,"ShowPivotFilterData",null,[]);var pe=b(492),Qd=b(1495),fe=b(53),Hc=Kb.a.aBe,ud=Hb.a;Rk(X,ud);X.prototype.D9c=function(jb,Eb){var nc=this,$c=jb.rawEvent,od=jb.cell,de=jb.requiresConfirmation;pe.a(this.$).xx(de,function(ae){if(ae){ae=$c?new Sys.UI.DomEvent($c):null;nc.pivotData=new Z;nc.pivotData.pivotName=jb.pivotName;nc.pivotData.dataSourceIndex=jb.dataSourceIndex;nc.pivotData.cell=od;nc.pivotData.vo=jb.optionalPivotMenuAnchorParameter;if(nc.pivotData.vo&&0<nc.pivotData.vo.AnchorType){nc.cmc=
jb.objectId;nc.sDb=jb.objectVersion;var ze=nc.pivotData.vo.AnchorType;if(4===ze||5===ze||6===ze||11===ze||9===ze||10===ze||8===ze)nc.cmb=jb.location}else nc.Xxd=nc.cmc=null,nc.Yxd=nc.sDb=-1;Ya.g(nc.$).Ao(!0);nc.$.Oj(od);nc.y0(ae,ae?ae.target:jb.domElement,nc.pivotData,Eb,nc.NLa())}});return!0};X.prototype.y0=function(jb,Eb,nc,$c){var od=this;if(Object(ef.a)(Z,nc)){this.pivotData=nc;this.T4b=Eb;this.Aif=jb;this.Q1b=this.pivotData.vo?this.pivotData.vo.AnchorValue1:-1;this.oY=this.pivotData.vo?this.pivotData.vo.AnchorType:
0;var de=!1,ae=null;ae=X.fN.get(this.pivotData.cell,Eb,this.oY);de=!!ae;var ze=!0;switch(this.oY){case 4:case 5:case 6:this.Sca=new Sys.UI.Point(this.cmb.x,this.cmb.y);ze=!1;break;case 7:var Xd=Sys.UI.DomElement.getBounds(Eb);ze=Xd.x+(0<=Xd.x?0:Xd.width);Xd=Xd.y+(0<=Xd.y?0:Xd.height);this.Sca=new Sys.UI.Point(0<=ze?ze:0,0<=Xd?Xd:0);ze=!1;break;case 8:case 10:case 9:case 11:this.Sca=new Sys.UI.Point(this.cmb.x,this.cmb.y);break;default:this.Sca=null}de&&this.cmc===this.Xxd&&this.sDb===this.Yxd&&this.Q1b===
this.Uwe&&this.oY===this.Xoe?(W.ULS.sendTraceTag(537167042,0,50,"PivotFilterContextMenuBase.ShowDropDown: rendering pivot filter context menu from menu cache"),this.rrb=ae,this.Sca?(this.qTa(this.Sca,Eb),this.np(this.Sca,this.NLa())):this.Ux?(!Ab.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")||Hb.a.Amd(this.$,this.pivotData.cell))&&this.np(Hb.a.Jcd(this.$,this.pivotData.cell,!1),this.NLa()):ud.prototype.y0.call(this,jb,Eb,nc,$c,this.NLa())):1!==X.QNh(Eb)&&(ze&&(Eb.parentNode.menuFetchStates=
1,this.cpj(Eb),this.CXf(!0)),this.$.userOperationManager.Sb(new db.a(126,0,function(te,af,cf){var Pa=od.$;return wc.q(Pa.oa.xa,od.pivotData.cell,od.pivotData.dataSourceIndex,od.pivotData.pivotName,Pa.domElement.id,Pa.isChromeRtl,Pa.workbookContext.NovMode,Aa.b(te,od.CLi),Aa.a(af,od.BLi),cf,Eb,od.pivotData.vo)},16),$c))}};X.prototype.dDd=function(jb){Array.addRange(jb.MenuSectionList,this.rrb)};X.prototype.bvd=function(jb,Eb){jb.parentNode.menuFetchStates=2;this.CXf(!1);if(Eb){if(this.T4b!==jb||this.Qzi())this.qTa(this.Sca,
jb),this.np(this.Sca,this.NLa());else if(this.Ux&&!this.Sca){if(Ab.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")&&!Hb.a.Amd(this.$,this.pivotData.cell))return;this.np(Hb.a.Jcd(this.$,this.pivotData.cell,!1),this.NLa())}else ud.prototype.y0.call(this,this.Aif,jb,null,null,this.NLa());this.Xxd=this.cmc;this.Yxd=this.sDb;this.Xoe=this.oY;this.Uwe=this.Q1b}};X.prototype.NLa=function(){return 8!==this.oY&&9!==this.oY&&10!==this.oY&&11!==this.oY};X.prototype.Qzi=function(){switch(this.pivotData.vo?
this.pivotData.vo.AnchorType:0){case 1:case 2:case 3:case 4:case 5:case 6:case 7:return!0;default:return!1}};X.prototype.CXf=function(jb){var Eb=this.T4b;if(Eb){if(Ab.EwaSettings.isChangeGateEnabled("OfficeVSO:5041973_FixDropdownImageDisappearing")){var nc=qe.DOMElementExtensions.oZ(Eb,"ewaprevsrc","");nc=!!nc&&"null"!==nc}else nc=!!qe.DOMElementExtensions.oZ(Eb,"ewaprevsrc","");jb&&nc||!jb&&!nc||(jb?(Eb.setAttribute("ewaprevsrc",Eb.src),Eb.src=fe.a.current.Uo(99)):(jb=qe.DOMElementExtensions.oZ(Eb,
"ewaprevsrc",""),Eb.src=jb,Eb.setAttribute("ewaprevsrc",null)))}};X.prototype.cpj=function(jb){this.T4b=jb};X.QNh=function(jb){var Eb=jb.parentNode.menuFetchStates;void 0===Eb&&(jb.parentNode.menuFetchStates=0);return Eb};X.fN=null;Object(ba.a)(X,"PivotFilterContextMenuBase",Hb.a,[]);var Gd="FieldList"+Kb.a.aBe;Rk(ca,X);ca.prototype.executeCommand=function(jb,Eb,nc){return this.D9c(nc,Eb)?Cb.Task.Ua(!0):ob.a(Eb.command)};ca.prototype.Ac=function(jb,Eb,nc){return-1065117584===Eb.command&&!!nc};Af.Object.defineProperties(ca.prototype,
{yw:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldListPivotMenu"}},wB:{configurable:!0,enumerable:!0,get:function(){return Kb.a.ZKf}}});Object(ba.a)(ca,"FieldListPivotContextMenu",X,[]);var jd=b(279),Sd=b(30),Wd=b(90),Le=b(938);Object(ba.a)(Q,"PivotValueFieldSettingsApplyData",null,[]);H.Zah="dataFieldCustomLabel";H.jFe="dataFieldSourceLabel";H.TRd="showValueAsSelect";H.RRd="showValueAsBaseFieldSelect";H.SRd="showValueAsBaseItemSelect";H.cZd="valueFieldsSettingsFieldName";H.Meg=
"valueFieldSettingTabs";Object(ba.a)(H,"CssElementIds",null,[]);var Pd=b(118);Object(ba.a)(N,"MacroRecorderPivotFieldShowValueAsParameters",null,[]);O.prototype.getActiveCell=function(){return this.activeCell};Object(ba.a)(O,"MacroRecorderPivotValueFieldSettingAppliedPayload",null,[409]);var Re=b(244);Object(ba.a)(J,"PivotValueFieldShowValueAsApplyData",null,[]);var Qe=b(937),jc=b(42),Fa="<div id='showValueAsControlBody'><label for='"+H.TRd+"' class='"+Pd.a.Cn+" valueFielsSettingsControlTitle'>{0}</label><div><select size=1 id='"+
H.TRd+"' class='"+Pd.a.AC+"'></select></div><div class='showValueAsControlSelectRegion'><label for='"+H.RRd+"'>{1}</label><div><select size=6 id='"+H.RRd+"' class='"+Pd.a.AC+"'></select></div></div><div class='showValueAsControlSelectRegionSeparator'></div><div class='showValueAsControlSelectRegion'><label for='"+H.SRd+"'>{2}</label><div><select size=6 id='"+H.SRd+"' class='"+Pd.a.AC+"'></select></div></div></div>",Qb=Re.a;Rk(K,Qb);K.prototype.Gja=function(){return this.isVisible};K.prototype.tna=
function(jb){return this.isVisible=jb};K.prototype.setFocus=function(){qe.DOMElementExtensions.setFocus(this.n3.Nn)};K.prototype.render=function(jb){jb.appendChild(this.domElement)};K.prototype.dispose=function(){Wd.a.oc([this.n3,this.QT,this.wP,this.x5b,this.j0b]);Qb.prototype.dispose.call(this)};K.prototype.Krj=function(jb){Wd.a.oc([this.x5b,this.j0b]);this.n3.clear();for(var Eb=ak(jb.DataFormatTypes),nc=Eb.next();!nc.done;nc=Eb.next())nc=nc.value,this.n3.QL(K.aMh(nc),nc.toString(),nc===jb.SelectedDataFormat);
this.x5b=this.ke.Td(this.n3.domElement);this.x5b.ka("change",this.kvf);this.QT.clear();Eb=ak(jb.BaseFieldList);for(nc=Eb.next();!nc.done;nc=Eb.next())nc=nc.value,this.QT.QL(nc.DisplayString,nc.Id.toString(),nc.Id===jb.SelectedBaseField);this.j0b=this.ke.Td(this.n3.domElement);this.j0b.ka("change",this.uGi);this.lF=this.Sha.lrb(this.wP.Nn.parentNode,1E3,null,"",739);this.kvf(null)};K.prototype.KQ=function(jb){this.n3.KQ(jb);this.QT.KQ(jb);this.wP.KQ(jb)};K.prototype.Zja=function(){this.domElement.innerHTML=
String.format(Fa,sb.a.instance.ga(1097),sb.a.instance.ga(1098),sb.a.instance.ga(1099));this.J3d=new Qe.a(qe.DOMElementExtensions.getElementById(this.domElement,H.TRd),!1);this.r1d=new Qe.a(qe.DOMElementExtensions.getElementById(this.domElement,H.RRd),!1);this.s1d=new Qe.a(qe.DOMElementExtensions.getElementById(this.domElement,H.SRd),!1)};K.prototype.qUg=function(jb){return this.Nji||!K.Oaf(jb)&&!K.Paf(jb)?!0:!!this.QT.count};K.prototype.getValueFieldSettingsShowValueAsBaseItemsInfo=function(){var jb=
this;this.$.userOperationManager.Sb(new db.a(108,0,function(Eb,nc,$c){var od=jb.$.oa.xa,de=parseInt(jb.QT.he.value,10);Eb=Aa.b.call(null,Eb,jb.yMi);var ae=wc.M(od,jb.cell,jb.externalSourceIndex,jb.vo);ae.selectedBaseField=de;return wc.g(od,"GetPivotValueFieldSettingsShowValueAsBaseItems",ae,Eb,nc,$c,null,4)},16),this.Ed)};K.prototype.hkf=function(){this.wP.clear();this.QT.he&&(this.lF.jSa(),this.wP.Nn.style.overflowY="hidden",this.getValueFieldSettingsShowValueAsBaseItemsInfo())};K.prototype.LNb=
function(jb){var Eb=document.getElementById("WACDialogActionButton");this.lSj&&Eb&&(Eb.disabled=jb)};K.aMh=function(jb){switch(jb){case 0:return sb.a.instance.ga(1100);case 1:return sb.a.instance.ga(1101);case 2:return sb.a.instance.ga(1102);case 3:return sb.a.instance.ga(1103);case 4:return sb.a.instance.ga(1104);case 5:return sb.a.instance.ga(1105);case 6:return sb.a.instance.ga(1106);case 7:return sb.a.instance.ga(1107);case 8:return sb.a.instance.ga(1109);case 9:return sb.a.instance.ga(1110);
case 10:return sb.a.instance.ga(1111);case 11:return sb.a.instance.ga(1112);case 12:return sb.a.instance.ga(1113);case 13:return sb.a.instance.ga(1114);case 14:return sb.a.instance.ga(1115);default:return""}};K.Oaf=function(jb){return 11===jb||12===jb||14===jb||13===jb||4===jb};K.Paf=function(jb){return 1===jb||3===jb||2===jb};Af.Object.defineProperties(K.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return sb.a.instance.ga(1096)}},Cvb:{configurable:!0,enumerable:!0,get:function(){var jb=
this.n3.he?parseInt(this.n3.he.value,10):-1,Eb=this.QT.he?parseInt(this.QT.he.value,10):-1,nc=this.wP.he?parseInt(this.wP.he.value,10):-1;return Object(va.a)(new J,{SelectedDataFormat:0<=jb?jb:-1,SelectedBaseField:Eb,SelectedBaseItem:nc})}},QT:{configurable:!0,enumerable:!0,get:function(){return this.r1d}},wP:{configurable:!0,enumerable:!0,get:function(){return this.s1d}},n3:{configurable:!0,enumerable:!0,get:function(){return this.J3d}}});Object(ba.a)(K,"ShowValueAsControl",Re.a,[673,10]);Object(ba.a)(F,
"PivotValueFieldSummarizeValueByApplyData",null,[]);var cb="<div id='summarizeValuesByControlBody'><label class='"+(Pd.a.Cn+" valueFielsSettingsControlTitle' for='pivotDataFieldSelect'>{0}</label><div id='pivotDataFieldSelectDescription' class='")+(Pd.a.Cn+" summarizeValuesByControlDescription'>{1}</div><div><select class='")+(Pd.a.AC+"' size=6 id='pivotDataFieldSelect' style='width: 100%' "+Kb.a.AG+"='pivotDataFieldSelectDescription'></select></div></div>"),Xb=Re.a;Rk(T,Xb);T.prototype.Gja=function(){return this.isVisible};
T.prototype.tna=function(jb){return this.isVisible=jb};T.prototype.setFocus=function(){qe.DOMElementExtensions.setFocus(this.Yk.Nn)};T.prototype.render=function(jb){jb.appendChild(this.domElement)};T.prototype.dispose=function(){Wd.a.Ia(this.Yk);Xb.prototype.dispose.call(this)};T.prototype.focus=function(){qe.DOMElementExtensions.setFocus(this.Yk.Nn)};T.prototype.Jrj=function(jb){this.Yk.QSd();for(var Eb=ak(jb.AggregationTypes),nc=Eb.next();!nc.done;nc=Eb.next()){nc=nc.value;var $c=nc===jb.SelectedAggregation;
this.Yk.HTc(T.DHh(nc),nc.toString(),$c,"")}this.Yk.n7c();this.Yk.Nn.disabled=jb.AggregationsDisabled};T.prototype.bhj=function(){this.Yk.chj()};T.prototype.Zja=function(){this.domElement.innerHTML=String.format(cb,sb.a.instance.ga(1080),sb.a.instance.ga(1081));this.Nce=new Qe.a(qe.DOMElementExtensions.getElementById(this.domElement,T.WFf),!1)};T.DHh=function(jb){switch(jb){case 0:return sb.a.instance.ga(1083);case 1:return sb.a.instance.ga(1084);case 2:return sb.a.instance.ga(1085);case 3:return sb.a.instance.ga(1086);
case 4:return sb.a.instance.ga(1087);case 5:return sb.a.instance.ga(1088);case 6:return sb.a.instance.ga(1089);case 7:return sb.a.instance.ga(1090);case 8:return sb.a.instance.ga(1091);case 9:return sb.a.instance.ga(1092);case 10:return sb.a.instance.ga(1093);case 11:return sb.a.instance.ga(1094);default:return""}};Af.Object.defineProperties(T.prototype,{Cvb:{configurable:!0,enumerable:!0,get:function(){var jb=this.Yk.he?parseInt(this.Yk.he.value,10):-1;return Object(va.a)(new F,{Aggregation:0<=jb?
jb:-1})}},title:{configurable:!0,enumerable:!0,get:function(){return sb.a.instance.ga(1095)}},enabled:{configurable:!0,enumerable:!0,get:function(){return!this.Yk.Nn.disabled},set:function(jb){this.Yk.Nn.disabled=!jb}},Yk:{configurable:!0,enumerable:!0,get:function(){return this.Nce}}});T.WFf="pivotDataFieldSelect";Object(ba.a)(T,"SummarizeValuesByControl",Re.a,[673,10]);var kc=b(218),Wc=b(498),id=b(1442),Vc=Le.a;Rk(M,Vc);M.prototype.dispose=function(){this.B4c=this.Grb=this.URa=this.mRc=null;Wd.a.Ia(this.Efa);
this.Efa=null;Vc.prototype.dispose.call(this)};M.prototype.initialize=function(){var jb="<div id='"+H.jFe+"' class='"+Pd.a.Cn+"'></div><div id='"+H.Zah+"' class='"+Pd.a.Cn+"'><label for='"+H.cZd+"'>{0}</label><input type='text' id='"+H.cZd+"' value='{1}' class='"+Pd.a.AC+" UIFont' /></div><div id='"+H.Meg+"'></div>";jb=String.format(jb,sb.a.instance.ga(1079),Sd.a.Ag(this.Leg));this.Gb.innerHTML=jb;this.Be||(this.o2(),this.El());this.nie=[-103190598];this.h_h();Vc.prototype.initialize.call(this)};
M.prototype.close=function(jb){1===jb&&(this.e2f=!1);Vc.prototype.close.call(this,jb)};M.prototype.kHe=function(jb){this.QQ=jb;this.domElement.disabled=jb;for(var Eb=["input","option","select"],nc=0,$c=Eb.length;nc<$c;++nc)for(var od=this.domElement.getElementsByTagName(Eb[nc]),de=0;de<od.length;++de)od[de].disabled=jb};M.prototype.El=function(){this.Grb=document.getElementById(H.cZd);this.B4c=qe.DOMElementExtensions.getElementById(this.Gb,H.jFe);var jb=qe.DOMElementExtensions.getElementById(this.Gb,
H.Meg);this.mRc=new T(document.createElement("div"));this.URa=new K(document.createElement("div"),this.$,this.cell,this.vo,this.externalSourceIndex,this.Ed,this.Sha,!this.isOlap);var Eb;this.Efa=new id.a(jb,(Eb=new pc.a,Eb.add(this.xSa),Eb.add(this.URa),Eb));this.Efa.sQf()};M.prototype.pDd=function(){var jb=new M(this.cell,this.vo,this.externalSourceIndex,this.Leg,this.$,this.Ed,this.Sha,this.isOlap,this.wV);jb.initialize();jb.hf()};M.prototype.kfb=function(){var jb=new Wc.a;if(!this.e2f)return jb.isValid=
!0,jb;this.Grb.value.length?jb.isValid=!0:(this.kHe(!0),jb.error=Da.a.Wc(1,0,754,769,0,1783218700,"PivotTableValueFieldNoBlank"),this.QQ=!0,this.Be||(this.wx.disabled=!0),jb.isValid=!1);return jb};M.prototype.v4e=function(){this.QQ=!1;this.Be||(this.wx.disabled=!1);this.kHe(!1)};M.prototype.iya=function(jb){var Eb=new $a.a(2105621672,0,this.$.Jc,30,null);this.$.Ka.Kb(Eb);this.BW(5,jb.mb,"Number Format");return!0};M.prototype.pn=function(){this.hBa=String.format(sb.a.instance.lb(61),null);Vc.prototype.pn.call(this)};
M.prototype.setFocus=function(){if(this.Be){var jb=qe.DOMElementExtensions.getElementById(this.Gb,T.WFf);kc.a.BAc(jb)}else this.Efa.setFocus()};M.prototype.dj=function(){var jb=this,Eb=this.URa.Cvb,nc=new N(Eb.SelectedDataFormat,Eb.SelectedBaseField,Eb.SelectedBaseItem);return function(){return new O(jb.externalSourceIndex,jb.cell,jb.Grb.value,jb.xSa.Cvb.Aggregation,nc)}};M.prototype.Py=function(){var jb=this,Eb=Object(va.a)(new Q,{PivotValueFieldSummarizeValueByApplyData:this.xSa.Cvb,PivotValueFieldShowValueAsApplyData:this.URa.Cvb,
PivotValueFieldTitle:this.Grb.value});return function(nc,$c,od){var de=jb.$.oa.xa;nc=Aa.b(nc,jb.jGi);var ae=wc.M(de,jb.cell,jb.externalSourceIndex,jb.vo);ae.pivotValueFieldSettingsApplyData=Eb;return wc.g(de,"ApplyPivotValueFieldSettings",ae,nc,$c,od,null,0)}};M.prototype.KQ=function(jb){var Eb=this;this.$.da.Za(40,function(){Eb.URa.KQ(jb)})};M.prototype.h_h=function(){var jb=this;this.$.userOperationManager.Sb(new db.a(123,0,function(Eb,nc,$c){var od=jb.$.oa.xa;Eb=Aa.b.call(null,Eb,jb.xMi);var de=
wc.M(od,jb.cell,jb.externalSourceIndex,jb.vo);return wc.g(od,"GetPivotValueFieldSettingsInitial",de,Eb,nc,$c,null,4)},16),this.Ed)};Af.Object.defineProperties(M.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"ValueFieldSettingsDialog"}},wea:{configurable:!0,enumerable:!0,get:function(){return this.nie}},OCb:{configurable:!0,enumerable:!0,get:function(){return this.Efa}},xSa:{configurable:!0,enumerable:!0,get:function(){return this.mRc}},uv:{configurable:!0,enumerable:!0,get:function(){return 560}}});
Object(ba.a)(M,"ValueFieldSettingsDialog",Le.a,[]);var td=Kb.a.$1g,rd=Hb.a;Rk(U,rd);U.prototype.executeCommand=function(jb,Eb,nc,$c){var od=this;jb=Eb.command;switch(jb){case -1453503574:$c=nc.domElement;this.io=nc.fieldItem;this.k_d=nc.zoneCount;this.eSa=nc.sourceAxis;this.cyc=nc.sourceAxisPos;this.vo=nc.optionalPivotMenuAnchorParameter;this.mL=nc.versionkey;this.isOlap=nc.isOlap;this.wV=nc.isPpm;this.p2a="fieldItemsupportsImplicitMeasures"in nc?nc.fieldItemsupportsImplicitMeasures:!1;this.cell=
nc.cell;this.externalSourceIndex=nc.externalSourceIndex;Ya.g(this.$).Ao(!0);jb=qe.DOMElementExtensions.getBounds($c);var de=new Sys.UI.Point(jb.x,jb.y+jb.height);this.$.isChromeRtl&&(de.x+=jb.width);this.qTa(de,$c);"isKeyboardInput"in nc&&nc.isKeyboardInput?this.np(de,!1,1):this.np(de,!1);break;case 495005930:break;case -1170196828:se.a(this.$).DJ(this.io,this.eSa,this.cyc-1,this.mL,Eb);break;case -889576107:se.a(this.$).DJ(this.io,this.eSa,this.cyc+2,this.mL,Eb);break;case 2033235475:se.a(this.$).DJ(this.io,
this.eSa,this.k_d,this.mL,Eb);break;case 389774337:se.a(this.$).DJ(this.io,this.eSa,0,this.mL,Eb);break;case -96230454:se.a(this.$).DJ(this.io,4,-1,this.mL,Eb);break;case 74086617:se.a(this.$).DJ(this.io,1,-1,this.mL,Eb);break;case 1529312473:se.a(this.$).DJ(this.io,2,-1,this.mL,Eb);break;case 563292088:this.p2a&&W.ULS.sendTraceTag(537167056,0,50,"Move a field into values area as implicit measurement.");se.a(this.$).DJ(this.io,8,-1,this.mL,Eb);break;case -1092351914:se.a(this.$).DJ(this.io,0,-1,this.mL,
Eb);break;case -2141589616:var ae=nb.GetServiceTaskFactory.Ra(this.$.da,12,477,$c.zja());return P.TaskExtensions.Ba(ae,function(){(new M(od.cell,od.vo,od.externalSourceIndex,od.io.Name,od.$,Eb,ae.result,od.isOlap,od.wV)).initialize()},this.la);default:return ob.a(jb)}return Cb.Task.Ua(!0)};U.prototype.Ac=function(jb,Eb,nc){jb=!1;switch(Eb.command){case -1453503574:jb=!!nc;break;case 495005930:case -1170196828:case -889576107:case 2033235475:case 389774337:case -96230454:case 74086617:case 1529312473:case 563292088:case -1092351914:case -2141589616:jb=
!0}return jb};U.prototype.QY=function(){var jb=this.Va.mq(this.menuId);this.wZi(jb,this.cyc,this.k_d);this.xZi(jb,this.eSa);this.yZi(jb);8===this.eSa&&this.uZi(jb);return jb};U.prototype.wZi=function(jb,Eb,nc){var $c=this.Va,od=$c.Bc();Eb||Eb!==nc-1?!Eb&&Eb<nc-1?(od.buttons.push($c.nb(64)),od.buttons.push($c.nb(61)),od.buttons.push($c.nb(66)),od.buttons.push($c.nb(63))):0<Eb&&Eb<nc-1?(od.buttons.push($c.nb(60)),od.buttons.push($c.nb(61)),od.buttons.push($c.nb(62)),od.buttons.push($c.nb(63))):0<Eb&&
Eb===nc-1&&(od.buttons.push($c.nb(60)),od.buttons.push($c.nb(65)),od.buttons.push($c.nb(62)),od.buttons.push($c.nb(67))):(od.buttons.push($c.nb(64)),od.buttons.push($c.nb(65)),od.buttons.push($c.nb(66)),od.buttons.push($c.nb(67)));jb.pc.push(od)};U.prototype.xZi=function(jb,Eb){var nc=this.Va,$c=nc.Bc(),od=1!==Eb&&(!this.isOlap||this.wV||8!==Eb||this.p2a),de=2!==Eb&&(!this.isOlap||this.wV||8!==Eb||this.p2a),ae=8!==Eb&&-2!==this.io.PivotTableIndex&&(!this.isOlap||this.wV||this.p2a);$c.buttons.push(nc.nb(4===
Eb||this.io.IsSet||-2===this.io.PivotTableIndex||this.isOlap&&!this.wV&&8===Eb&&!this.p2a?72:68));8===this.vo.AnchorType||10===this.vo.AnchorType?($c.buttons.push(nc.nb(od?95:97)),$c.buttons.push(nc.nb(de?96:98))):($c.buttons.push(nc.nb(od?69:73)),$c.buttons.push(nc.nb(de?70:74)));$c.buttons.push(nc.nb(ae?71:75));jb.pc.push($c)};U.prototype.yZi=function(jb){var Eb=this.Va.Bc();Eb.buttons.push(this.Va.nb(76));jb.pc.push(Eb)};U.prototype.uZi=function(jb){var Eb=this.Va.Bc();Eb.buttons.push(this.Va.nb(77));
jb.pc.push(Eb)};Af.Object.defineProperties(U.prototype,{yw:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldWellContextMenu"}},wB:{configurable:!0,enumerable:!0,get:function(){return Kb.a.TFd}}});Object(ba.a)(U,"FieldWellContextMenu",Hb.a,[]);var za=b(1421);Rk(I,X);I.prototype.executeCommand=function(jb,Eb,nc){var $c=!1,od=Eb.command;switch(od){case 37023044:$c=this.D9c(nc,Eb);break;case 541421805:case -569786022:$c=this.Phd(jb,Eb)}return $c?Cb.Task.Ua(!0):ob.a(od)};I.prototype.Ac=
function(jb,Eb,nc){jb=!1;switch(Eb.command){case 37023044:jb=!!nc;break;case 541421805:case -569786022:jb=!0}return jb};I.prototype.Phd=function(jb,Eb){var nc=8===jb,$c=this.$,od=ue.a($c),de=Ya.g($c).ha.Oa.Yb,ae=jb=null;nc&&od?(jb=od.chartId,ae=od.Oc):!nc&&de&&(jb=de.floatingObject.id,ae=de.floatingObject.Oc);return I.Wqe(ae,260)?(nc={},$c.Oj(nc),nc.FirstColumn=nc.FirstRow=-1,$c={},ae=($c.rawEvent=null,$c.pivotName=null,$c.cell=nc,$c.requiresConfirmation=I.Wqe(ae,64),$c.dataSourceIndex=ae.ExternalSourceIndex,
$c),de?(od=de.floatingObject,ae.domElement=de.domElement,ae.objectId=od.id,ae.objectVersion=od.version):od&&(ae.domElement=od.ll,ae.objectId=od.chartId,ae.objectVersion=od.Wwe),de={AnchorType:7},de.ChartId=jb,de.AnchorValue1=-1,de.AnchorValue2=-1,ae.optionalPivotMenuAnchorParameter=de,this.D9c(ae,Eb)):!1};I.Wqe=function(jb,Eb){return(jb.Attributes&Eb)===Eb};Af.Object.defineProperties(I.prototype,{yw:{configurable:!0,enumerable:!0,get:function(){return"PopulatePivotContextMenu"}},wB:{configurable:!0,
enumerable:!0,get:function(){return Kb.a.eLf}}});Object(ba.a)(I,"PivotFilterContextMenu",X,[]);var tb=b(1494),Wb=b(1048),fc=b(153),xc=b(389),Yb=b(258),Ec=b(28),bd=b(22),Ic=Kb.a.d2g,Md=Ic+".RemoveField",ne=Ic+".Subtotal",le=Ic+".ClearFilter",Ke=Ic+".LayoutSameColumn",oc=Ic+".LayoutNextColumn",Qc=Hb.a;Rk(E,Qc);E.prototype.executeCommand=function(jb,Eb,nc){Eb=Eb.command;jb=null;this.grid=Ya.g(this.$);this.activeCell=dc.o(this.grid.ha.sa.activeCell,this.$);if(this.$.isEditMode&&(this.rc=this.grid.Ab.To(this.grid.ha.sa.activeCell),
!this.rc))return W.ULS.sendTraceTag(537167007,0,10,"No PivotTable range found."),P.TaskExtensions.Qaa();this.QZd=this.$.oa.xa;this.h0a=Object(Fb.a)(ed.a,nc.eventArgs);switch(Eb){case 671488277:this.Fxj()?this.ETh():(this.ubb(),this.showPivotTableContextMenu());break;case 1801458190:this.performPivotTableOperation(1801458190,1);break;case -2016405815:this.performPivotTableOperation(-2016405815,6);break;case 671485366:this.performPivotTableOperation(671485366,7);break;case 772221736:this.performPivotTableOperation(772221736,
8);break;case 1600778266:this.performPivotTableOperation(1600778266,2);break;case -556893687:this.performPivotTableOperation(-556893687,3);break;case -1966978671:this.performPivotTableOperation(-1966978671,4);break;case -1951357930:this.performPivotTableOperation(-1951357930,5);break;case -1390365353:this.performPivotTableOperation(-1390365353,9);break;case -1457478532:this.performPivotTableOperation(-1457478532,10);break;case -771066011:this.Wz.PivotValueFieldSummarizeValueByApplyData.Aggregation=
2;this.applyValueFieldSettingsToPivotTable(-771066011,!0);break;case 1746132849:this.Wz.PivotValueFieldSummarizeValueByApplyData.Aggregation=1;this.applyValueFieldSettingsToPivotTable(1746132849,!0);break;case 1475494885:this.Wz.PivotValueFieldSummarizeValueByApplyData.Aggregation=6;this.applyValueFieldSettingsToPivotTable(1475494885);break;case 376946683:this.Wz.PivotValueFieldSummarizeValueByApplyData.Aggregation=11;this.applyValueFieldSettingsToPivotTable(376946683,!0);break;case 835007294:this.Wz.PivotValueFieldSummarizeValueByApplyData.Aggregation=
3;this.applyValueFieldSettingsToPivotTable(835007294,!0);break;case 929115636:this.Wz.PivotValueFieldSummarizeValueByApplyData.Aggregation=4;this.applyValueFieldSettingsToPivotTable(929115636,!0);break;case 1935475057:this.Wz.PivotValueFieldSummarizeValueByApplyData.Aggregation=5;this.applyValueFieldSettingsToPivotTable(1935475057,!0);break;case 588680636:this.Wz.PivotValueFieldSummarizeValueByApplyData.Aggregation=7;this.applyValueFieldSettingsToPivotTable(588680636);break;case -910892852:this.Wz.PivotValueFieldSummarizeValueByApplyData.Aggregation=
8;this.applyValueFieldSettingsToPivotTable(-910892852);break;case -1255320719:this.Wz.PivotValueFieldSummarizeValueByApplyData.Aggregation=0;this.applyValueFieldSettingsToPivotTable(-1255320719,!0);break;case 1668427539:this.Wz.PivotValueFieldSummarizeValueByApplyData.Aggregation=9;this.applyValueFieldSettingsToPivotTable(1668427539);break;case -1751371357:this.Wz.PivotValueFieldSummarizeValueByApplyData.Aggregation=10;this.applyValueFieldSettingsToPivotTable(-1751371357);break;case -841863025:this.tRa(0,
0);this.applyValueFieldSettingsToPivotTable(-841863025);break;case -178796371:this.tRa(7,0);this.applyValueFieldSettingsToPivotTable(-178796371);break;case 786592977:this.tRa(6,0);this.applyValueFieldSettingsToPivotTable(786592977);break;case 767774849:this.tRa(5,0);this.applyValueFieldSettingsToPivotTable(767774849);break;case 282586693:this.tRa(9,0);this.applyValueFieldSettingsToPivotTable(282586693);break;case -1067664355:this.tRa(10,0);this.applyValueFieldSettingsToPivotTable(-1067664355);break;
case -2031744961:nc=Number.parseInvariant(nc.MenuItemId.split(".")[2]);this.tRa(11,nc);this.applyValueFieldSettingsToPivotTable(-2031744961);break;case -1007663920:this.applyPivotSort(1);break;case 234234584:this.applyPivotSort(2);break;case 1194992911:this.$.Fd(-1556797033,Db.a.Cb,8,null);break;case 1514686611:this.dri();break;case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:nc=Number.parseInvariant(nc.MenuItemId);this.iYg(nc);break;case 1778578888:nc=Number.parseInvariant(nc.MenuItemId);
this.lKg(nc);break;case 2059542618:this.performPivotTableOperation(2059542618,11);break;case 713270357:this.performPivotTableOperation(713270357,12);break;case -1842411134:this.performPivotTableOperation(-1842411134,13);break;case 2054968064:this.performPivotTableOperation(2054968064,14);break;default:jb=ob.a(Eb)}return jb||P.TaskExtensions.Qaa()};E.prototype.Ac=function(jb,Eb){jb=!1;switch(Eb.command){case 671488277:jb=Wb.f(this.grid);break;case 1801458190:case -2016405815:case 671485366:case 772221736:jb=
!0;break;case 1600778266:jb=!0;break;case -556893687:jb=!0;break;case -1966978671:jb=!0;break;case -1951357930:jb=!0;break;case -1390365353:case -1457478532:jb=!0;break;case -249874296:case -771066011:case 1746132849:case 1475494885:case 376946683:case 835007294:case 929115636:case 1935475057:case 588680636:case -910892852:case -1255320719:case 1668427539:case -1751371357:jb=!0;break;case -1128612833:case -841863025:case -178796371:case 767774849:case 786592977:case 282586693:case -1067664355:case -2031744961:jb=
!0;break;case -1007663920:case 234234584:case 1194992911:jb=!0;break;case 1514686611:case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:case 1778578888:jb=!0;break;case 2059542618:case 713270357:case -1842411134:case 2054968064:jb=Ab.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)}return jb};E.prototype.Fxj=function(){if(!this.$.isEditMode||this.rc.Yfc)return!1;var jb=this.c1f(!1);return Ab.EwaSettings.isChangeGateEnabled("OfficeVSO:6214209_EnableFullRightClickMenuForExtNativePT")?
!this.rc.isOlap||jb:!this.rc.Hod()||jb};E.prototype.Lc=function(jb,Eb){var nc=!1;switch(Eb){case -249874296:case -1128612833:case 1801458190:case -1951357930:case -1390365353:case -1457478532:case 1600778266:case -556893687:case -1966978671:case 1514686611:case 1778578888:nc=this.dS();break;case -1007663920:case 234234584:nc=this.lwj()||this.dS();break;case 1194992911:nc=this.mwj()||this.dS();break;case 1217404289:nc=!tb.j(this.rb.LabelOrDateFilterType)||this.dS();break;case -743135194:nc=!tb.m(this.rb.ValueFilterType)&&
!tb.l(this.rb.ValueFilterType)||this.dS();break;case 771421327:nc=0===this.rb.LabelOrDateFilterType&&0===this.rb.ValueFilterType&&!this.rb.HasManualFilter||this.dS();break;case 1015867427:nc=!tb.i(this.rb.LabelOrDateFilterType)||this.dS();break;case 1105960559:nc=!tb.k(this.rb.LabelOrDateFilterType)||this.dS()}return nc||Qc.prototype.Lc.call(this,jb,Eb)};E.prototype.ubb=function(){this.M$a=this.rb=this.Ee=null};E.prototype.BTd=function(){this.grid.pP(this.Dq);this.$.Ka.vYa(this.gy)};E.prototype.mXd=
function(){this.grid.GK(this.Dq);this.$.Ka.UHb(this.gy)};E.prototype.eKb=function(){if(this.rc&&this.rc.Io){this.Ee=this.rc.Io;this.rb=this.rc.uac();if(this.R1f()){var jb=this.rc.NK[4===this.Ee.CellType?this.rc.D4c-1:this.Ee.CurrentFieldIndex-1];jb&&(this.M$a=-2===jb.Index?this.rc.oFe:jb.Caption)}this.Q9h();this.rb&&8===this.Ee.CellArea&&(this.Wz.PivotValueFieldSummarizeValueByApplyData.Aggregation=this.rb.DataFieldAggregationType,this.Wz.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=this.rb.DataFieldFormatType,
this.Wz.PivotValueFieldShowValueAsApplyData.SelectedBaseField=this.rb.BaseFieldIndex,this.Wz.PivotValueFieldTitle=this.rb.Caption)}};E.prototype.c1f=function(jb){return this.rc?this.rc.isOlap&&!this.rc.a7a(!jb):!1};E.prototype.twj=function(){var jb=Ab.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1);return 1!==this.rb.MeasureType&&(!this.rc.tff||jb&&2===this.rb.MeasureType)};E.prototype.QY=function(){var jb=this.Va.mq(this.menuId),Eb=this.Va.Bc(),nc=Ya.g(this.$).Ub(null);
if(this.rc)this.Ee&&this.rc.Io&&this.Ee!==this.rc.Io&&W.ULS.shipAssertTag(537167006,0,!1,"CurrentCellInfo is out of sync with cell info from PivotTable Range"),this.rb&&this.rb!==this.rc.uac()&&W.ULS.shipAssertTag(537167005,0,!1,"CurrentField is out of sync with field from PivotTable Range");else return jb;this.PEh(jb);if(this.$.isEditMode){this.refresh&&this.fGh(jb);if(this.Ee&&this.rb){var $c=this.Va.Bc();this.uGh($c);this.dFh($c);jb.pc.push($c)}this.eZ&&Eb.buttons.push(this.Va.nb(99));this.Ee&&
this.rb&&this.BFh(jb);if(this.expandCollapse){$c=this.Va.Tv("ContextMenu.PivotExpandCollapse",null,sb.a.instance.ga(1144),589118293);var od=this.Va.Bc();od.buttons.push(this.Va.nb(243));od.buttons.push(this.Va.nb(244));od.buttons.push(this.Va.nb(245));od.buttons.push(this.Va.nb(246));$c.menu.pc.push(od);$c&&0<od.buttons.length&&Eb.buttons.push($c)}this.Ee&&($c=this.Va.Bc(),Ab.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)&&this.MFh($c),this.gGh($c),0<$c.buttons.length&&
jb.pc.push($c));this.Ee&&this.rb&&8===this.Ee.CellArea&&8!==this.Ee.CellType&&($c=this.Va.Bc(),this.twj()&&this.wGh($c),3!==this.Ee.CellType&&this.rGh($c),jb.pc.push($c));!this.rc.isOlap&&""!==(null===nc||void 0===nc?void 0:nc.text)&&this.Ee&&0===this.Ee.CellType&&Ab.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)&&this.qGh(jb);this.uki()?Eb.buttons.push(this.Va.nb(257)):Eb.buttons.push(this.Va.nb(258));this.snd?Eb.buttons.push(this.Va.nb(59)):Eb.buttons.push(this.Va.nb(58))}jb.pc.push(Eb);
return jb};E.prototype.OQd=function(){return this.rb&&this.rb.Caption?20<this.rb.Caption.length:!1};E.prototype.pdd=function(jb){return this.rb&&this.rb.Caption?jb?this.rb.Caption.substring(0,20)+"...":this.rb.Caption:""};E.prototype.ava=function(jb){return Ab.EwaSettings.isChangeGateEnabled("OfficeVSO:5548525_FixLoggingColumnNameInButtonId")?bd.a.hashCode(jb).toString():jb};E.prototype.uGh=function(jb){if(this.Ee&&this.rb&&4!==this.Ee.CellArea){var Eb=this.eja(this.bH("PivotTableContextMenu.Sort",
this.ava(this.rb.Caption)),-1777747317,0,0!==this.rb.SortInfo,sb.a.instance.ga(229)),nc=this.Va.Bc();nc.buttons.push(this.Pd("PivotTableContextMenu.SortAscending",-1007663920,0,1===this.rb.SortInfo,sb.a.instance.ga(230)));nc.buttons.push(this.Pd("PivotTableContextMenu.SortDescending",234234584,0,2===this.rb.SortInfo,sb.a.instance.ga(231)));1!==this.Ee.CellArea&&2!==this.Ee.CellArea||nc.buttons.push(this.Pd("PivotTableContextMenu.SortByValue",1194992911,0,3===this.rb.SortInfo||4===this.rb.SortInfo,
sb.a.instance.ga(156)));Eb.menu.pc.push(nc);Eb&&0<nc.buttons.length&&jb.buttons.push(Eb)}};E.prototype.dFh=function(jb){if(this.Ee&&this.rb&&(1===this.Ee.CellArea||2===this.Ee.CellArea)){var Eb=this.Exj(),nc=this.eja(this.bH("PivotTableContextMenu.Filter",this.ava(this.rb.Caption)),-1777747317,0,Eb,sb.a.instance.ga(654)),$c=this.Va.Bc(),od="",de=this.OQd(),ae=String.format(sb.a.instance.lb(156),this.pdd(de));de&&(od=String.format(sb.a.instance.lb(156),this.rb.Caption));Eb=this.ava(this.rb.Caption)+
"."+(Eb?"enabled":"disabled");od=this.Pd(this.bH(le,Eb),771421327,0,!1,ae,"0",od,8,ic.a.d2a);Eb=this.ava(this.rb.Caption)+"."+this.rb.LabelOrDateFilterType.toString();this.rb.IsDateField?(ae=this.eja(this.bH("PivotTableContextMenu.DateFilter",Eb),-1777747317,0,0!==this.rb.LabelOrDateFilterType,sb.a.instance.ga(97)),this.SEh(ae.menu)):(ae=this.eja(this.bH("PivotTableContextMenu.LabelFilter",Eb),-1777747317,0,0!==this.rb.LabelOrDateFilterType,sb.a.instance.ga(652)),this.AFh(ae.menu));Eb=this.ava(this.rb.Caption)+
"."+this.rb.ValueFilterType.toString();Eb=this.eja(this.bH("PivotTableContextMenu.ValueFilter",Eb),-1777747317,0,0!==this.rb.ValueFilterType,sb.a.instance.ga(653));this.IGh(Eb.menu);de=this.Va.Bc();de.buttons.push(this.Pd("PivotTableContextMenu.ManualFilter",1514686611,0,this.rb.HasManualFilter,sb.a.instance.ga(94)));$c.buttons.push(od);$c.buttons.push(ae);$c.buttons.push(Eb);nc.menu.pc.push($c);nc.menu.pc.push(de);nc&&0<$c.buttons.length&&jb.buttons.push(nc)}};E.prototype.SEh=function(jb){jb.pc.push(this.Sac(!0,
!1));jb.pc.push(this.eMh());jb.pc.push(this.dMh());jb.pc.push(this.VNh());jb.pc.push(this.YNh());jb.pc.push(this.WNh());jb.pc.push(this.XNh());jb.pc.push(this.ZNh());jb.pc.push(this.$Nh());jb.pc.push(this.SLh())};E.prototype.HEh=function(jb){jb.pc.push(this.Sac(!0,!0));jb.pc.push(this.DUh());jb.pc.push(this.QRh())};E.prototype.AFh=function(jb){jb.pc.push(this.Sac(!0,!1));jb.pc.push(this.cYe(!0));jb.pc.push(this.BIh());jb.pc.push(this.bLh());jb.pc.push(this.cXe(!0));jb.pc.push(this.kWe(!0))};E.prototype.IGh=
function(jb){jb.pc.push(this.Sac(!1,!1));jb.pc.push(this.cYe(!1));jb.pc.push(this.cXe(!1));jb.pc.push(this.kWe(!1));jb.pc.push(this.dZh())};E.prototype.dZh=function(){var jb=this.Va.Bc();jb.buttons.push(this.Pd("PivotTableContextMenu.Top10",-1611233597,0,tb.l(this.rb.ValueFilterType),sb.a.instance.ga(105)));return jb};E.prototype.bLh=function(){var jb=this.Va.Bc();this.rb&&(jb.buttons.push(this.Pd("PivotTableContextMenu.Contains",786260386,0,10===this.rb.LabelOrDateFilterType,sb.a.instance.ga(655),
"10")),jb.buttons.push(this.Pd("PivotTableContextMenu.DoesNotContain",786260386,0,11===this.rb.LabelOrDateFilterType,sb.a.instance.ga(656),"11")));return jb};E.prototype.BIh=function(){var jb=this.Va.Bc();this.rb&&(jb.buttons.push(this.Pd("PivotTableContextMenu.BeginsWith",786260386,0,6===this.rb.LabelOrDateFilterType,sb.a.instance.ga(657),"6")),jb.buttons.push(this.Pd("PivotTableContextMenu.DoesNotBeginWith",786260386,0,7===this.rb.LabelOrDateFilterType,sb.a.instance.ga(658),"7")),jb.buttons.push(this.Pd("PivotTableContextMenu.EndsWith",
786260386,0,8===this.rb.LabelOrDateFilterType,sb.a.instance.ga(659),"8")),jb.buttons.push(this.Pd("PivotTableContextMenu.DoesNotEndWith",786260386,0,9===this.rb.LabelOrDateFilterType,sb.a.instance.ga(660),"9")));return jb};E.prototype.cYe=function(jb){var Eb=this.Va.Bc();if(this.rb){var nc=jb?tb.c:tb.f;Eb.buttons.push(this.Pd(this.bH("PivotTableContextMenu.Equals",nc),786260386,0,jb?4===this.rb.LabelOrDateFilterType:18===this.rb.ValueFilterType,sb.a.instance.ga(100),jb?"4":"18"));Eb.buttons.push(this.Pd(this.bH("PivotTableContextMenu.DoesNotEqual",
nc),786260386,0,jb?5===this.rb.LabelOrDateFilterType:19===this.rb.ValueFilterType,sb.a.instance.ga(101),jb?"5":"19"))}return Eb};E.prototype.cXe=function(jb){var Eb=this.Va.Bc();if(this.rb){var nc=jb?tb.c:tb.f;Eb.buttons.push(this.Pd(this.bH("PivotTableContextMenu.GreaterThan",nc),786260386,0,jb?12===this.rb.LabelOrDateFilterType:20===this.rb.ValueFilterType,sb.a.instance.ga(102),jb?"12":"20"));Eb.buttons.push(this.Pd(this.bH("PivotTableContextMenu.GreaterThanOrEqualTo",nc),786260386,0,jb?13===this.rb.LabelOrDateFilterType:
21===this.rb.ValueFilterType,sb.a.instance.ga(661),jb?"13":"21"));Eb.buttons.push(this.Pd(this.bH("PivotTableContextMenu.LessThan",nc),786260386,0,jb?14===this.rb.LabelOrDateFilterType:22===this.rb.ValueFilterType,sb.a.instance.ga(103),jb?"14":"22"));Eb.buttons.push(this.Pd(this.bH("PivotTableContextMenu.LessThanOrEqualTo",nc),786260386,0,jb?15===this.rb.LabelOrDateFilterType:23===this.rb.ValueFilterType,sb.a.instance.ga(662),jb?"15":"23"))}return Eb};E.prototype.kWe=function(jb){var Eb=this.Va.Bc();
if(this.rb){var nc=jb?tb.c:tb.f;Eb.buttons.push(this.Pd(this.bH("PivotTableContextMenu.Between",nc),786260386,0,jb?16===this.rb.LabelOrDateFilterType:24===this.rb.ValueFilterType,sb.a.instance.ga(104),jb?"16":"24"));Eb.buttons.push(this.Pd(this.bH("PivotTableContextMenu.NotBetween",nc),786260386,0,jb?17===this.rb.LabelOrDateFilterType:25===this.rb.ValueFilterType,sb.a.instance.ga(663),jb?"17":"25"))}return Eb};E.prototype.Sac=function(jb,Eb){var nc=this.Va.Bc();if(this.rb){var $c=sb.a.instance.ga(98),
od=jb?this.rb.LabelOrDateFilterType.toString():this.rb.ValueFilterType.toString(),de=["PivotTableContextMenu.ClearFilter",this.ava(this.rb.Caption),od];jb=jb?this.rb.IsDateField?Eb?1015867427:1105960559:1217404289:-743135194;de.push(jb.toString());de=de.join(".");$c=this.Pd(de,jb,0,!1,$c,od,$c,8,ic.a.d2a);nc.buttons.push($c)}return nc};E.prototype.eMh=function(){var jb=this.Va.Bc();this.rb&&jb.buttons.push(this.Pd(this.bH("PivotTableContextMenu.Equals",tb.d),786260386,0,26===this.rb.LabelOrDateFilterType,
sb.a.instance.ga(100),"26"));return jb};E.prototype.dMh=function(){var jb=this.Va.Bc();this.rb&&(jb.buttons.push(this.Pd("PivotTableContextMenu.Before",786260386,0,27===this.rb.LabelOrDateFilterType,sb.a.instance.ga(112),"27")),jb.buttons.push(this.Pd("PivotTableContextMenu.After",786260386,0,28===this.rb.LabelOrDateFilterType,sb.a.instance.ga(113),"28")),jb.buttons.push(this.Pd("PivotTableContextMenu.Between",786260386,0,29===this.rb.LabelOrDateFilterType,sb.a.instance.ga(104),"29")));return jb};
E.prototype.VNh=function(){var jb=this.Va.Bc();this.rb&&(jb.buttons.push(this.Pd("PivotTableContextMenu.Tomorrow",1778578888,0,30===this.rb.LabelOrDateFilterType,sb.a.instance.ga(110),"30")),jb.buttons.push(this.Pd("PivotTableContextMenu.Today",1778578888,0,31===this.rb.LabelOrDateFilterType,sb.a.instance.ga(109),"31")),jb.buttons.push(this.Pd("PivotTableContextMenu.Yesterday",1778578888,0,32===this.rb.LabelOrDateFilterType,sb.a.instance.ga(111),"32")));return jb};E.prototype.YNh=function(){var jb=
this.Va.Bc();this.rb&&(jb.buttons.push(this.Pd("PivotTableContextMenu.NextWeek",1778578888,0,33===this.rb.LabelOrDateFilterType,sb.a.instance.ga(115),"33")),jb.buttons.push(this.Pd("PivotTableContextMenu.ThisWeek",1778578888,0,34===this.rb.LabelOrDateFilterType,sb.a.instance.ga(114),"34")),jb.buttons.push(this.Pd("PivotTableContextMenu.LastWeek",1778578888,0,35===this.rb.LabelOrDateFilterType,sb.a.instance.ga(116),"35")));return jb};E.prototype.WNh=function(){var jb=this.Va.Bc();this.rb&&(jb.buttons.push(this.Pd("PivotTableContextMenu.NextMonth",
1778578888,0,36===this.rb.LabelOrDateFilterType,sb.a.instance.ga(117),"36")),jb.buttons.push(this.Pd("PivotTableContextMenu.ThisMonth",1778578888,0,37===this.rb.LabelOrDateFilterType,sb.a.instance.ga(118),"37")),jb.buttons.push(this.Pd("PivotTableContextMenu.LastMonth",1778578888,0,38===this.rb.LabelOrDateFilterType,sb.a.instance.ga(119),"38")));return jb};E.prototype.XNh=function(){var jb=this.Va.Bc();this.rb&&(jb.buttons.push(this.Pd("PivotTableContextMenu.NextQuarter",1778578888,0,39===this.rb.LabelOrDateFilterType,
sb.a.instance.ga(120),"39")),jb.buttons.push(this.Pd("PivotTableContextMenu.ThisQuarter",1778578888,0,40===this.rb.LabelOrDateFilterType,sb.a.instance.ga(121),"40")),jb.buttons.push(this.Pd("PivotTableContextMenu.LastQuarter",1778578888,0,41===this.rb.LabelOrDateFilterType,sb.a.instance.ga(122),"41")));return jb};E.prototype.ZNh=function(){var jb=this.Va.Bc();this.rb&&(jb.buttons.push(this.Pd("PivotTableContextMenu.NextYear",1778578888,0,42===this.rb.LabelOrDateFilterType,sb.a.instance.ga(123),"42")),
jb.buttons.push(this.Pd("PivotTableContextMenu.ThisYear",1778578888,0,43===this.rb.LabelOrDateFilterType,sb.a.instance.ga(124),"43")),jb.buttons.push(this.Pd("PivotTableContextMenu.LastYear",1778578888,0,44===this.rb.LabelOrDateFilterType,sb.a.instance.ga(125),"44")));return jb};E.prototype.$Nh=function(){var jb=this.Va.Bc();if(this.rb){jb.buttons.push(this.Pd("PivotTableContextMenu.YearToDate",1778578888,0,45===this.rb.LabelOrDateFilterType,sb.a.instance.ga(126),"45"));var Eb=this.eja("PivotTableContextMenu.AllDatesInThePeriod",
1778578888,0,tb.i(this.rb.LabelOrDateFilterType),sb.a.instance.ga(127));this.HEh(Eb.menu);jb.buttons.push(Eb)}return jb};E.prototype.SLh=function(){var jb=this.Va.Bc();this.rb&&jb.buttons.push(this.Pd("PivotTableContextMenu.CustomFilter",786260386,0,this.Bxj(this.rb.LabelOrDateFilterType),sb.a.instance.ga(108),"26"));return jb};E.prototype.DUh=function(){var jb=this.Va.Bc();this.rb&&(jb.buttons.push(this.Pd("PivotTableContextMenu.Quarter1",1778578888,0,46===this.rb.LabelOrDateFilterType,sb.a.instance.ga(128),
"46")),jb.buttons.push(this.Pd("PivotTableContextMenu.Quarter2",1778578888,0,47===this.rb.LabelOrDateFilterType,sb.a.instance.ga(129),"47")),jb.buttons.push(this.Pd("PivotTableContextMenu.Quarter3",1778578888,0,48===this.rb.LabelOrDateFilterType,sb.a.instance.ga(130),"48")),jb.buttons.push(this.Pd("PivotTableContextMenu.Quarter4",1778578888,0,49===this.rb.LabelOrDateFilterType,sb.a.instance.ga(131),"49")));return jb};E.prototype.QRh=function(){var jb=this.Va.Bc();this.rb&&(jb.buttons.push(this.Pd("PivotTableContextMenu.January",
1778578888,0,50===this.rb.LabelOrDateFilterType,sb.a.instance.ga(132),"50")),jb.buttons.push(this.Pd("PivotTableContextMenu.February",1778578888,0,51===this.rb.LabelOrDateFilterType,sb.a.instance.ga(133),"51")),jb.buttons.push(this.Pd("PivotTableContextMenu.March",1778578888,0,52===this.rb.LabelOrDateFilterType,sb.a.instance.ga(134),"52")),jb.buttons.push(this.Pd("PivotTableContextMenu.April",1778578888,0,53===this.rb.LabelOrDateFilterType,sb.a.instance.ga(135),"53")),jb.buttons.push(this.Pd("PivotTableContextMenu.May",
1778578888,0,54===this.rb.LabelOrDateFilterType,sb.a.instance.ga(136),"54")),jb.buttons.push(this.Pd("PivotTableContextMenu.June",1778578888,0,55===this.rb.LabelOrDateFilterType,sb.a.instance.ga(137),"55")),jb.buttons.push(this.Pd("PivotTableContextMenu.July",1778578888,0,56===this.rb.LabelOrDateFilterType,sb.a.instance.ga(138),"56")),jb.buttons.push(this.Pd("PivotTableContextMenu.August",1778578888,0,57===this.rb.LabelOrDateFilterType,sb.a.instance.ga(139),"57")),jb.buttons.push(this.Pd("PivotTableContextMenu.September",
1778578888,0,58===this.rb.LabelOrDateFilterType,sb.a.instance.ga(140),"58")),jb.buttons.push(this.Pd("PivotTableContextMenu.October",1778578888,0,59===this.rb.LabelOrDateFilterType,sb.a.instance.ga(141),"59")),jb.buttons.push(this.Pd("PivotTableContextMenu.November",1778578888,0,60===this.rb.LabelOrDateFilterType,sb.a.instance.ga(142),"60")),jb.buttons.push(this.Pd("PivotTableContextMenu.December",1778578888,0,61===this.rb.LabelOrDateFilterType,sb.a.instance.ga(143),"61")));return jb};E.prototype.BFh=
function(jb){var Eb=this.Va.Bc();if(this.R1f()){var nc=this.rc.NK[4===this.Ee.CellType?this.rc.D4c-1:this.Ee.CurrentFieldIndex-1];if(nc&&this.M$a){var $c=this.Va.Tv("ContextMenu.PivotTableLayout",null,sb.a.instance.ga(650),-1777747317);var od=this.Va.Bc(),de=String.format(sb.a.instance.lb(165),this.M$a),ae=String.format(sb.a.instance.lb(166),this.M$a);od.buttons.push(this.Pd(oc,-1457478532,0,!nc.IsCompactLayout,de));od.buttons.push(this.Pd(Ke,-1390365353,0,nc.IsCompactLayout,ae));$c.menu.pc.push(od);
$c&&Eb.buttons.push($c)}}if(1===this.Ee.CellArea||2===this.Ee.CellArea)this.rb.Caption&&(nc="",od=this.OQd(),$c=String.format(sb.a.instance.lb(159),this.pdd(od)),od&&(nc=String.format(sb.a.instance.lb(159),this.rb.Caption)),1===this.Ee.CellArea?(nc=this.eja("ContextMenu.PivotTableSubtotal",1801458190,0,this.rb.ShowSubtotal,$c),$c=this.Va.Bc(),$c.buttons.push(this.Va.nb(259)),$c.buttons.push(this.Pd("ContextMenu.PivotTableSubtotalOnTop",671485366,642,this.rb.ShowSubtotal&&this.rb.ShowSubtotalAtTop)),
$c.buttons.push(this.Pd("ContextMenu.PivotTableSubtotalOnBottom",772221736,643,this.rb.ShowSubtotal&&!this.rb.ShowSubtotalAtTop)),nc.menu.pc.push($c),nc&&0<$c.buttons.length&&Eb.buttons.push(nc)):(od=od?this.bH(ne,this.ava($c)):ne,Eb.buttons.push(this.Pd(od,1801458190,0,this.rb.ShowSubtotal,$c,null,nc)))),Eb.buttons.push(this.Pd("ContextMenu.RepeatItemLabels",-556893687,645,this.rb.RepeatItemLabels));1===this.Ee.CellArea&&Eb.buttons.push(this.Pd("ContextMenu.PivotBlankLineAfterEachItem",1600778266,
644,this.rb.ShowBlankLineAfterEachItem));jb.pc.push(Eb)};E.prototype.qGh=function(jb){var Eb=this.Va.Bc();Eb.buttons.push(this.Va.nb(247));jb.pc.push(Eb)};E.prototype.MFh=function(jb){if(this.$.isEditMode&&this.grid){var Eb=this.grid.ha.sa.activeRange;if(Eb.top===Eb.bottom&&Eb.left===Eb.right&&0!==this.Ee.MoveItemsMenuState){Eb=this.eja("PivotTableContextMenu.Move",-1777747317,0,!1,sb.a.instance.ga(73));var nc=this.Va.Bc();this.x$b(nc,"PivotTableContextMenu.MoveToBeginning",2059542618,String.format(sb.a.instance.lb(162),
this.Ee.MoveItemName),0===(this.Ee.MoveItemsMenuState&1));this.x$b(nc,"PivotTableContextMenu.MoveUp",713270357,String.format(sb.a.instance.lb(163),this.Ee.MoveItemName),0===(this.Ee.MoveItemsMenuState&2));this.x$b(nc,"PivotTableContextMenu.MoveDown",-1842411134,String.format(sb.a.instance.lb(160),this.Ee.MoveItemName),0===(this.Ee.MoveItemsMenuState&4));this.x$b(nc,"PivotTableContextMenu.MoveToEnd",2054968064,String.format(sb.a.instance.lb(161),this.Ee.MoveItemName),0===(this.Ee.MoveItemsMenuState&
8));Eb.menu.pc.push(nc);jb.buttons.push(Eb)}}};E.prototype.gGh=function(jb){var Eb="",nc="",$c=!1;3===this.Ee.CellType?Eb=sb.a.instance.ga(647):8===this.Ee.CellType?this.rc&&(Eb=String.format(sb.a.instance.lb(164),this.rc.oFe)):this.rb&&(($c=this.OQd())&&(nc=String.format(sb.a.instance.lb(164),this.rb.Caption)),Eb=String.format(sb.a.instance.lb(164),this.pdd($c)));Eb&&($c=$c?this.bH(Md,this.ava(Eb)):Md,Eb=this.Pd($c,-1951357930,0,!1,Eb,null,nc,8,ic.a.a9c),jb.buttons.push(Eb))};E.prototype.PEh=function(jb){var Eb=
this.Va.Bc();Eb.buttons.push(this.Va.nb(43));this.rb&&this.Ee&&this.$.isEditMode&&(0===this.Ee.CellType||4===this.Ee.CellType)&&Eb.buttons.push(this.Va.nb(136));jb.pc.push(Eb)};E.prototype.fGh=function(jb){var Eb=this.Va.Bc();Eb.buttons.push(this.Va.nb(100));jb.pc.push(Eb)};E.prototype.wGh=function(jb){var Eb=2===this.rb.MeasureType&&!this.rb.IsNumeric,nc=this.Va.Tv("ContextMenu.SummarizeValuesBy",null,sb.a.instance.ga(648),-249874296),$c=this.Va.Bc();$c.buttons.push(this.Pd("ContextMenu.SummarizeValuesBySum",
-1255320719,1083,0===this.rb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,Eb));$c.buttons.push(this.Pd("ContextMenu.SummarizeValuesByCount",1746132849,1084,1===this.rb.DataFieldAggregationType));$c.buttons.push(this.Pd("ContextMenu.SummarizeValuesByAverage",-771066011,1085,2===this.rb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,Eb));$c.buttons.push(this.Pd("ContextMenu.SummarizeValuesByMax",835007294,1086,3===this.rb.DataFieldAggregationType,void 0,void 0,void 0,void 0,
void 0,Eb));$c.buttons.push(this.Pd("ContextMenu.SummarizeValuesByMin",929115636,1087,4===this.rb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,Eb));$c.buttons.push(this.Pd("ContextMenu.SummarizeValuesByProduct",1935475057,1088,5===this.rb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,this.c1f(!0)||Eb));2!==this.rb.MeasureType&&($c.buttons.push(this.Pd("ContextMenu.SummarizeValuesByCountNumbers",1475494885,1089,6===this.rb.DataFieldAggregationType)),$c.buttons.push(this.Pd("ContextMenu.SummarizeValuesByStdDeviation",
588680636,1090,7===this.rb.DataFieldAggregationType)),$c.buttons.push(this.Pd("ContextMenu.SummarizeValuesByStdDeviationPercent",-910892852,1091,8===this.rb.DataFieldAggregationType)),$c.buttons.push(this.Pd("ContextMenu.SummarizeValuesByVariant",1668427539,1092,9===this.rb.DataFieldAggregationType)),$c.buttons.push(this.Pd("ContextMenu.SummarizeValuesByVariantPercent",-1751371357,1093,10===this.rb.DataFieldAggregationType)));this.rc&&this.rc.Hod()&&$c.buttons.push(this.Pd("ContextMenu.SummarizeValuesByDistinctCountPPM",
376946683,1094,11===this.rb.DataFieldAggregationType));nc.menu.pc.push($c);jb.buttons.push(nc)};E.prototype.rGh=function(jb){var Eb=this.Va.Tv("ContextMenu.ShowValuesAs",null,sb.a.instance.ga(649),-1128612833),nc=this.Va.Bc();nc.buttons.push(this.Pd("ContextMenu.ShowValuesAsNoCalculation",-841863025,1100,0===this.rb.DataFieldFormatType));nc.buttons.push(this.Pd("ContextMenu.ShowValuesAsPercentOfGrandTotal",-178796371,1107,7===this.rb.DataFieldFormatType));nc.buttons.push(this.Pd("ContextMenu.ShowValuesAsPercentOfColumnTotal",
786592977,1106,6===this.rb.DataFieldFormatType));nc.buttons.push(this.Pd("ContextMenu.ShowValuesAsPercentOfRowTotal",767774849,1105,5===this.rb.DataFieldFormatType));nc.buttons.push(this.Pd("ContextMenu.ShowValuesAsPercentOfParentRowTotal",282586693,1110,9===this.rb.DataFieldFormatType));nc.buttons.push(this.Pd("ContextMenu.ShowValuesAsParentColumnTotal",-1067664355,1111,10===this.rb.DataFieldFormatType));if(this.rc&&this.rc.NK&&0<this.rc.NK.length||this.rc.x$&&0<this.rc.x$.length){for(var $c=this.eja("ContextMenu.ShowValuesAsPercentOfParentTotal",
-1128612833,1112,11===this.rb.DataFieldFormatType),od=this.Va.Bc(),de=this.vGh(),ae=0;ae<de.length;ae++){var ze=de[ae];od.buttons.push(this.Pd("ContextMenu.ShowValuesAsPercentOfParentTotal."+ze.Caption,-2031744961,1112,11===this.rb.DataFieldFormatType&&this.rb.BaseFieldIndex===ze.Index,ze.Caption,"ContextMenu.ShowValuesAsPercentOfParentTotal."+ze.Index))}$c.menu.pc.push(od);nc.buttons.push($c)}Eb.menu.pc.push(nc);jb.buttons.push(Eb)};E.prototype.showPivotTableContextMenu=function(){this.snd=!0;this.expandCollapse=
this.eZ=this.refresh=!1;var jb=this.$,Eb=Ya.g(jb),nc=pe.a(jb).dKa();if(nc){var $c=se.a(jb);if(null===$c||void 0===$c?0:$c.gQd)this.snd=Vd.f(jb.ng);$c=jb.ic;this.eZ=nc.supportsBIExplore&&!!Fd.a(jb)&&$c.x2(32768);$c.allowInteractivity&&(jb=Eb.Ub(null),(null===jb||void 0===jb?0:jb.cell)&&(jb.cell.hZc||jb.cell.O1f)&&(this.expandCollapse=!0),$c.allowManualDataRefresh&&(this.refresh=!0))}jb=null;nc=1;this.h0a&&1!==this.h0a.mb?(jb=new Sys.UI.Point(this.h0a.clientPoint.x,this.h0a.clientPoint.y),nc=this.h0a.mb):
(Eb=Wb.e(Eb,this.$))&&(jb=new Sys.UI.Point(Eb.x+(this.$.isChromeRtl?0:Eb.width),Eb.y+Eb.height));Db.a.Cb=nc;this.eic=3===nc;this.np(jb,!0,nc);this.yba=!0;this.BTd()};E.prototype.b6h=function(){var jb=new $a.a(1114549926,0,this.$.Jc,19,null);this.$.Ka.Kb(jb)};E.prototype.ETh=function(){var jb=this;if(this.rc&&this.rc.Io){var Eb=this.rc.Io.CurrentCol;if(this.rc.Io.CurrentRow===this.activeCell.FirstRow&&Eb===this.activeCell.FirstColumn){this.eKb();this.showPivotTableContextMenu();return}}Eb=new db.a(228,
0,function(nc,$c,od){return Yb.k(jb.$.oa.xa,jb.activeCell,Aa.b(nc,jb.OLi),Aa.a($c,jb.NLi),od,null)},16);this.$.userOperationManager.Sb(Eb,null)};E.prototype.uki=function(){if(wb.a.ud(this.$)){var jb=this.$.da.za(441);if(jb)return jb.Kr}else if(jb=this.$.da.za(346))return jb.Kr;return!1};E.prototype.bH=function(jb,Eb){return jb+"."+Eb};E.prototype.performPivotTableOperation=function(jb,Eb){var nc=this,$c=Ec.a.Ta.Jb;if(!this.rc||!this.rb&&this.Ee&&3!==this.Ee.CellType)this.kj();else{var od=this.rc.isOlap;
pe.a(this.$).xx(od,function(de){de&&nc.$.Sb(jb,function(ae,ze,Xd){var te=nc.QZd,af=nc.activeCell,cf=nc.rb?nc.rb.Caption:null,Pa=nc.M$a;ae=Aa.b(ae,nc.zPi);ze=Aa.a(ze,nc.yPi);var Sb=nc.$.oa.xa.Pb();Sb=te.Na(41,void 0===Sb?null:Sb);Sb.activeCell=af;Sb.operationType=Eb;Sb.fieldCaption=cf;Sb.prevFieldCaption=Pa;return wc.g(te,"ExecutePivotTableOperation",Sb,ae,ze,Xd,null,0)},$c,0,4,229)})}};E.prototype.applyValueFieldSettingsToPivotTable=function(jb,Eb){var nc=this;Eb=void 0===Eb?!1:Eb;var $c=Ec.a.Ta.Jb;
this.rc&&this.rb?(Eb&&2===this.rb.MeasureType&&W.ULS.sendTraceTag(537167002,0,50,"change aggregation type for an implicit measure from right click context menu."),Eb=this.rc.isOlap,pe.a(this.$).xx(Eb,function(od){od&&nc.$.Sb(jb,function(de,ae,ze){var Xd=nc.QZd,te=nc.activeCell,af=nc.Wz;de=Aa.b(de,nc.pGi);ae=Aa.a(ae,nc.oGi);var cf=nc.$.oa.xa.Pb();cf=Xd.Na(41,void 0===cf?null:cf);cf.activeCell=te;cf.pivotValueFieldSettingsApplyData=af;return wc.g(Xd,"ApplyValueFieldSettingsToPivotTable",cf,de,ae,ze,
null,0)},$c,0,4,231)})):this.kj()};E.prototype.Pd=function(jb,Eb,nc,$c,od,de,ae,ze,Xd,te){od=void 0===od?null:od;de=void 0===de?null:de;ae=void 0===ae?null:ae;ze=void 0===ze?8:ze;Xd=void 0===Xd?null:Xd;te=void 0===te?!1:te;$c&&(jb+=".Checked");te&&(jb+=".Disabled");this.Va.fmd(jb)&&this.Va.GHd(jb);nc=od||sb.a.instance.ga(nc);jb=this.Va.rHa(jb,nc,Eb,null,"None",de,te,null);jb.Evc(null);ae&&jb.$R(ae);$c?jb.bS("Image16by16",3,ic.a.eaa):Xd?jb.bS("Image16by16",ze,Xd):jb.g2b();return jb};E.prototype.eja=
function(jb,Eb,nc,$c,od){nc=(void 0===od?null:od)||sb.a.instance.ga(nc);this.Va.fmd(jb)?this.Va.GHd(jb):this.Va.GHd(jb+".Checked");$c&&(jb+=".Checked");this.Wvj&&(nc=this.shh.parseFromString(nc,"text/html").body.innerText);jb=this.Va.O2c(jb,null,nc,Eb,3,ic.a.eaa);jb.L8e=$c;!$c&&Ab.EwaSettings.isChangeGateEnabled("OfficeVSO:4877664_HidePivotTableContextMenuFlyoutCheckmark")&&jb.g2b();return jb};E.prototype.Q9h=function(){this.Wz=Object(va.a)(new Q,{PivotValueFieldSummarizeValueByApplyData:Object(va.a)(new F,
{Aggregation:-1}),PivotValueFieldShowValueAsApplyData:Object(va.a)(new J,{SelectedDataFormat:-1,SelectedBaseField:-1,SelectedBaseItem:-1}),PivotValueFieldTitle:null})};E.prototype.tRa=function(jb,Eb){this.Wz.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=jb;this.Wz.PivotValueFieldShowValueAsApplyData.SelectedBaseField=Eb;this.Wz.PivotValueFieldShowValueAsApplyData.SelectedBaseItem=-1};E.prototype.vGh=function(){var jb=[];if(this.rc&&this.rc.x$&&0<this.rc.x$.length)for(var Eb=ak(this.rc.x$),
nc=Eb.next();!nc.done;nc=Eb.next())(nc=nc.value)&&jb.push(nc);if(this.rc&&this.rc.NK&&0<this.rc.NK.length)for(Eb=ak(this.rc.NK),nc=Eb.next();!nc.done;nc=Eb.next())(nc=nc.value)&&jb.push(nc);jb.sort(function($c,od){return $c.Index-od.Index});return jb};E.prototype.R1f=function(){if(!this.Ee||!this.rc||!this.rc.NK)return!1;var jb=1===this.Ee.CellArea||4===this.Ee.CellType&&this.Ee.IsRowAxis,Eb=4===this.Ee.CellType?0<this.rc.D4c:0<this.Ee.CurrentFieldIndex;return 1<this.rc.NK.length&&jb&&Eb};E.prototype.PJa=
function(jb){var Eb=[];3===jb?this.$.isEditMode?Array.addRange(Eb,[fd.a.ZFf,fd.a.aGf,fd.a.eYi]):Array.addRange(Eb,[fd.a.copy]):2===jb&&Eb.push(fd.a.zwe);return Eb};E.prototype.kj=function(){var jb=Da.a.Wc(1,0,0,651,0,104573951,"PivotTableContextMenuOperationFailure");jc.a(this.$).kj(jb)};E.prototype.Exj=function(){return this.rb?0!==this.rb.LabelOrDateFilterType||0!==this.rb.ValueFilterType||this.rb.HasManualFilter:!1};E.prototype.Bxj=function(jb){return 62<=jb&&65>=jb};E.prototype.dri=function(){if(this.activeCell&&
this.rb&&this.rc){var jb={};jb.cell=this.activeCell;jb.dataSourceIndex=this.rc.externalSourceIndex;jb.fieldId=this.rb.Index.toString();jb.isOlap=this.rc.isOlap;jb.confirmationRequired=this.rc.confirmationRequiredForDataOps;this.$.Fd(492140419,Db.a.Cb,19,{showPivotFilterDialogCommandData:jb})}};E.prototype.iYg=function(jb){var Eb=this;this.activeCell&&this.rb&&this.rc&&this.$.userOperationManager.Sb(new db.a(153,0,function(nc,$c,od){return wc.B(Eb.$.oa.xa,Eb.activeCell,Eb.rc.externalSourceIndex,Eb.rb.Index.toString(),
jb,nc,$c,od,null,null)}),null)};E.prototype.lKg=function(jb){var Eb=this;!(30>jb||61<jb)&&this.activeCell&&this.rb&&this.rc&&this.$.userOperationManager.Sb(new db.a(152,0,function(nc,$c,od){return wc.e(Eb.$.oa.xa,Eb.activeCell,Eb.rc.externalSourceIndex,Eb.rb.Index.toString(),jb,nc,$c,od,null,null)}),null)};E.prototype.applyPivotSort=function(jb){var Eb=this;if(this.rc&&this.rb&&this.activeCell&&this.Ee){var nc=1===this.Ee.CellArea||2===this.Ee.CellArea;8===this.Ee.CellArea?xc.a(this.$.userOperationManager,
function($c,od,de){return Yb.b(Eb.$.oa.xa,Eb.activeCell,jb,Eb.rb.Caption,$c,od,de,null)},function($c){return new db.a(1015,0,$c,void 0,null)},null):nc&&(nc=1===this.Ee.CellArea?1:2,this.$.ma(698)?fc.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.rc.externalSourceIndex,this.rb.Index.toString(),this.rb.Caption,this.rc.isOlap?"":this.rb.Caption,nc,1===jb):fc.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.rc.externalSourceIndex,this.rb.Index.toString(),
1===jb))}};E.prototype.dS=function(){return!this.rc||!this.rc.isActionable};E.prototype.lwj=function(){return(this.Ee||this.rc)&&4!==this.Ee.CellType&&(0!==this.Ee.CellType||8!==this.Ee.CellArea||this.rc.x$&&this.rc.x$.length||this.rc.NK&&this.rc.NK.length)?!1:!0};E.prototype.mwj=function(){return this.Ee&&this.rc&&(1===this.Ee.CellArea||2===this.Ee.CellArea)&&this.rc.COb&&this.rc.COb.length?!1:!0};E.prototype.x$b=function(jb,Eb,nc,$c,od){jb.buttons.push(this.Pd(Eb,nc,0,!1,$c,null,null,8,null,od))};
Af.Object.defineProperties(E.prototype,{yw:{configurable:!0,enumerable:!0,get:function(){return"PopulatePivotTableContextMenu"}},wB:{configurable:!0,enumerable:!0,get:function(){return Kb.a.fLf}}});Object(ba.a)(E,"PivotTableContextMenu",Hb.a,[]);G.prototype.compare=function(jb,Eb){return(jb||"").localeCompare(Eb||"",void 0,{numeric:!0,sensitivity:"accent"})};Object(ba.a)(G,"DigitsAsNumberComparer",null,[561]);var md=b(1289),dd=b(160),Kd=b(357),ke=b(275),kd=b(24),Nd=b(187),ge=Kb.a.f2g,Me=Hb.a;Rk(C,
Me);C.prototype.executeCommand=function(jb,Eb,nc){jb=Eb.command;switch(jb){case 639960842:this.applyTableFieldList(nc);this.AK.pda();break;case -1085236154:nc=String.format("TableFieldListContextMenu:TableFieldListContextMenuClose, ColWithEntities, {0}",this.Nxd);W.ULS.sendTraceTag(537166999,0,50,nc);this.AK.pda();break;case 1833782813:this.AK.showCallout();break;default:return ob.a(jb)}return Cb.Task.Ua(!0)};C.prototype.applyTableFieldList=function(jb){var Eb=jb.MenuItemId.toString();Ab.EwaSettings.isChangeGateEnabled("OfficeVSO:5239502_UpdatePulloutFieldNameContainingSplChars")&&
(Eb=Eb.replace("'","''"),Eb=Eb.replace("[","'["),Eb=Eb.replace("]","']"));var nc=Object(Fb.a)(String,jb.SourceControlId),$c={};$c.PulloutField=Eb;$c.PulloutCardPath=jb.SourceCardKeyPath;$c.PulloutCardSourceRow=jb.SourceCardRow;$c.PulloutCardSourceColumn=jb.SourceCardColumn;if(this.AK.YM){W.ULS.sendTraceTag(38887748,0,50,"Table Pullout operation started");$c.ParameterType=2;jb=jb.ColumnIndex;if(void 0===jb||null===jb){if(void 0===nc||null===nc){W.ULS.shipAssertTag(537166998,0,!1,"TableFieldListContextMenu: ApplyTableFieldList, must specifiy ColumnIndex or SourceControlId");
return}jb=0<=this.AK.iJf?this.AK.iJf:parseInt(nc.substring(20+Eb.length+1,nc.length),10);if(isNaN(jb)){$c=String.format("TableFieldListContextMenu:ApplyTableFieldListMalformatHTMLAttribute, Attribute, {0}",nc);W.ULS.shipAssertTag(537166997,0,!1,$c);return}}$c.PulloutRichColumnSourceIndex=jb;if(this.rEa.LHg){this.AIg(Eb,$c);return}}else W.ULS.sendTraceTag(38887749,0,50,"Grid Pullout operation started"),$c.ParameterType=4,nc=this.AK.selectedRange.right,wb.a.tyb()&&this.rEa.Imd&&($c.ParameterType=8,
jb=this.AK.vla.top,jb=kd.Range.MP(nc)+jb,Eb==md.f?(Eb="=DAYS("+jb+", TODAY())",Nd.a("DateFormulaPulledOut_DaysFromToday")):Eb==md.i?(Eb="=IF(TODAY() < "+jb+", NETWORKDAYS(TODAY(), "+jb+"), NETWORKDAYS("+jb+", TODAY()))",Nd.a("DateFormulaPulledOut_WeekdaysFromToday")):Eb==md.j?(Eb="=IF(TODAY() < "+jb+", DATEDIF(TODAY(), "+jb+', "Y"), DATEDIF('+jb+', TODAY(), "Y"))',Nd.a("DateFormulaPulledOut_YearsFromToday")):Eb==md.e?(Eb="=TEXT("+jb+', "dddd")',Nd.a("DateFormulaPulledOut_DayOfWeek")):Eb==md.h?(Eb=
"=TEXT("+jb+', "mmmm")',Nd.a("DateFormulaPulledOut_MonthOfYear")):Eb==md.g?(Eb="EOMONTH("+jb+", 0)",Eb="=DATE(YEAR("+Eb+"), MONTH("+Eb+"), DAY("+Eb+"))",Nd.a("DateFormulaPulledOut_EndOfMonth")):Eb==md.c?(Eb="EDATE("+jb+", 1)",Eb="=DATE(YEAR("+Eb+"), MONTH("+Eb+"), DAY("+Eb+"))",Nd.a("DateFormulaPulledOut_AddOneMonth")):Eb==md.d?(Eb="="+jb+" + 7",Nd.a("DateFormulaPulledOut_AddOneWeek")):Eb==md.b&&(Eb="="+jb+" + 1",Nd.a("DateFormulaPulledOut_AddOneDay"))),void 0!==$c.PulloutCardSourceColumn&&null!==
$c.PulloutCardSourceColumn&&(nc=$c.PulloutCardSourceColumn+1),$c.PulloutRichColumnSourceIndex=nc;this.QNd(Eb,$c)};C.prototype.QNd=function(jb,Eb,nc){nc=void 0===nc?0:nc;var $c=String.format("TableFieldListContextMenu:ApplyTableFieldList, ColWithEntities, {0}, SelectedColumnIndex, {1}",this.Nxd,Eb.PulloutRichColumnSourceIndex);W.ULS.sendTraceTag(537166996,0,50,$c);String.format("TableFieldListContextMenu:ApplyTableFieldList, richValueParameterType, {0}, PulloutRichColumnSourceIndex, {1}",Eb.ParameterType,
Eb.PulloutRichColumnSourceIndex);jb=Object(va.a)(new ke.a,{Text:jb});this.grid.setCell(jb,this.AK.vla,0,127,Eb,nc);this.grid.focus();this.Y4b=null;this.AK.pda();this.AK.agj()};C.prototype.Ac=function(jb,Eb,nc){if(jb=this.$.isEditMode&&Ab.EwaSettings.ma(136)&&!!this.AK)switch(Eb.command){case -1085236154:break;case 639960842:jb=!!nc;break;case 1833782813:jb=this.AK.hwa&&this.AK.hBb;break;default:jb=!1}return jb};C.prototype.y0=function(jb,Eb,nc){this.$.isEditMode&&(this.Y4b=this.HFh(Object(Fb.a)(636,
nc)),Me.prototype.y0.call(this,jb,Eb,null,null,!1))};C.prototype.QY=function(){return this.Y4b};C.prototype.N2c=function(jb){if(!this.AK||!jb||!jb.Hk)return W.ULS.shipAssertTag(537166994,0,!!this.AK,"TableFieldListContextMenu:CreateContextMenuItemList PulloutManager null"),W.ULS.shipAssertTag(537166993,0,!!jb,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager null"),jb&&W.ULS.shipAssertTag(537166992,0,!!jb.Hk,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager.FieldInfoListContextList null"),
null;var Eb=new pc.a;jb=ak(jb.Hk);for(var nc=jb.next();!nc.done;nc=jb.next()){var $c=nc.value;nc=new pc.a;nc.add($c.ColumnName);nc.add($c.ColumnIndex.toString());var od=new pc.a,de=null;wb.a.tyb()&&this.rEa.Imd?od=lc.toList(lc.select(lc.asEnumerable($c.FieldInfoDataList),function(ae){return ae.Name})):(de=Ab.EwaSettings.isChangeGateEnabled("OfficeVSO:5860557_CompareDigitsAsNumberRichDataProperties")?new G:new Ac.a,od=lc.OBc(lc.concat(od,lc.select(lc.asEnumerable($c.FieldInfoDataList),function(ae){return ae.Name})),
function(ae){return ae},de));$c=new pc.a;$c.add(lc.toArray(lc.concat(nc,od)));Eb=lc.toList(lc.concat(Eb,$c))}return lc.toArray(Eb)};C.prototype.HFh=function(jb){var Eb=this.N2c(jb);if(!Eb||!Eb.length)return this.Y4b=null;jb=this.Va;var nc=jb.mq(this.menuId),$c=jb.Bc(),od=1<Eb.length,de=wb.a.tyb()&&this.rEa.Imd;this.Nxd=Eb.length;Eb=ak(Eb);for(var ae=Eb.next();!ae.done;ae=Eb.next()){var ze=ae.value;de?$c.title="Calculate Date Information":od||($c.title=ze[0]);ae=jb.Bc();for(var Xd=2,te=ze.length;Xd<
te;++Xd)!de||ze[Xd]!=md.f&&ze[Xd]!=md.g||(nc.pc.push($c),$c=jb.Bc()),(od?ae.buttons:$c.buttons).push(jb.rHa("ApplyTableFieldList."+ze[Xd]+"."+ze[1],ze[Xd],639960842,null,"None",ze[Xd],!1,void 0,!0));od&&(ze=jb.Tv("ApplyTableFieldList."+ze[0],this.menuId,ze[0],798637440),ze.menu.pc.push(ae),$c.buttons.push(ze))}nc.pc.push($c);return nc};C.prototype.AIg=function(jb,Eb){var nc=this,$c=Da.a.Wc(12,1,0,897,0,2007340793,"RichValuePulloutIntoNonEmptyRange");if(Ab.EwaSettings.qz()){var od=new Kd.a(this.$,
$c);od.qP(function(){2===od.returnValue&&nc.QNd(jb,Eb,8)})}else{var de=new dd.ErrorDialog(this.$,$c);de.qP(function(){2===de.returnValue&&nc.QNd(jb,Eb,8)});de.hf()}};Af.Object.defineProperties(C.prototype,{yw:{configurable:!0,enumerable:!0,get:function(){return"PopulateTableFieldListContextMenu"}},wB:{configurable:!0,enumerable:!0,get:function(){return Kb.a.hLf}},AK:{configurable:!0,enumerable:!0,get:function(){this.rEa||(this.rEa=this.$.da.za(261));return this.rEa}}});Object(ba.a)(C,"PulloutFieldListContextMenu",
Hb.a,[]);var Ze=Kb.a.jLf,lf=Hb.a;Rk(x,lf);x.prototype.Ac=function(jb,Eb,nc){return-1687037502===Eb.command&&!!nc&&this.grid.isEditing};x.prototype.executeCommand=function(jb,Eb,nc){this.showRichTextFloatie(nc);return Cb.Task.Ua(!0)};x.prototype.PJa=function(){return[fd.a.FVg]};x.prototype.showRichTextFloatie=function(jb){var Eb=Object(Fb.a)(ed.a,jb.eventArgs);Eb&&(jb=this.PJa(Eb.mb),Eb=new Sys.UI.Point(Eb.Ca.clientX,Eb.Ca.clientY),this.showFloatie(jb,new Sys.UI.Bounds(Eb.x,Eb.y,0,0),2))};Af.Object.defineProperties(x.prototype,
{yw:{configurable:!0,enumerable:!0,get:function(){return"PopulateRichTextContextMenu"}},wB:{configurable:!0,enumerable:!0,get:function(){return Kb.a.jLf}}});Object(ba.a)(x,"RichTextContextMenu",Hb.a,[]);var he=b(101),Se=b(638),ve=Kb.a.e2g,Xa=Hb.a;Rk(y,Xa);y.prototype.executeCommand=function(jb,Eb,nc){if(Bd.a(this.$))return Cb.Task.Ua(!0);this.$.isEditMode&&(jb=nc[Kb.a.H0f],jb=jb.x&&jb.y?new Sys.UI.Point(jb.x+(this.$.isChromeRtl?10:-10),jb.y):qe.DOMElementExtensions.getLocation(nc[Kb.a.I0f]),this.np(jb,
!1));return Cb.Task.Ua(!0)};y.prototype.Ac=function(jb,Eb,nc){return-1075099431===Eb.command&&!!nc};y.prototype.QY=function(){var jb=this.Va.mq(this.menuId),Eb=this.$.isEditMode;this.jTj();this.wFh(jb,Eb);this.lFh(jb);this.pGh(jb);return jb};y.prototype.HYb=function(jb,Eb,nc,$c){jb.push(this.Va.nb(Eb?nc:$c))};y.prototype.wFh=function(jb,Eb){var nc=this.Va,$c=nc.Bc();$c.buttons.push(nc.nb(54));this.HYb($c.buttons,this.Thc,127,56);$c.buttons.push(nc.nb(55));Eb&&this.HYb($c.buttons,this.Thc,126,125);
$c.buttons.push(nc.nb(158));this.$.ea.PKb&&(Ab.EwaSettings.isChangeGateEnabled("OfficeVSO:6540166_CheckIsSdxAllowedForProtectionPane")?Ia.AFrameworkApplication.Kpd(Se.a):this.$.ya.ExcelSheetProtectionSettingsEnabled)&&(Eb=Object(Fb.a)(he.a,this.$.pa))&&Ye.p(Eb)&&this.$.isEditMode&&($c.buttons.push(nc.nb(277)),Eb.isLockPausedInSession?$c.buttons.push(nc.nb(279)):Eb.ij&&$c.buttons.push(nc.nb(278)));Eb=nc.Tv("ContextMenu.TabColor",null,sb.a.instance.ga(521),1841703919);nc=nc.K2c(467002767,1549407384,
544,-221093529,this.wB);Eb.menu.pc.push(nc);$c.buttons.push(Eb);jb.pc.push($c)};y.prototype.lFh=function(jb){var Eb=this.Va.Bc();this.HYb(Eb.buttons,this.Thc,114,112);this.HYb(Eb.buttons,!this.pgc,115,113);jb.pc.push(Eb)};y.prototype.pGh=function(jb){if(Ab.EwaSettings.ma(482)&&!Ye.e(this.$.va.pa)){var Eb=this.Va,nc=Eb.Bc();nc.buttons.push(Eb.nb(263));jb.pc.push(nc)}};y.prototype.jTj=function(){var jb=this.$.v2c();var Eb=jb.w2c;jb=jb.UBe;this.Thc=1===Eb;this.pgc=0<jb};Af.Object.defineProperties(y.prototype,
{yw:{configurable:!0,enumerable:!0,get:function(){return"PopulateSheetOpsContextMenu"}},wB:{configurable:!0,enumerable:!0,get:function(){return Kb.a.kLf}}});Object(ba.a)(y,"SheetOpsContextMenu",Hb.a,[]);var h=b(566),hb=Hb.a;Rk(B,hb);B.prototype.Lc=function(jb,Eb){var nc=!0;switch(Eb){case -231711729:nc=!1;break;case -1909381757:nc=this.Tbc();nc=!!nc&&nc.shi;break;case 1312363469:nc=!0}return!nc||hb.prototype.Lc.call(this,jb,Eb)};B.prototype.executeCommand=function(jb,Eb,nc){if(!this.$.isEditMode)return P.TaskExtensions.Qaa();
jb=Eb.command;Eb=this.Tbc();var $c=null;switch(jb){case 2108047455:Eb&&Eb.rye();break;case -231711729:W.ULS.shipAssertTag(537166990,0,!1,"Shouldn't be hitting Slicer Refresh - NYI");break;case -1909381757:Eb&&Eb.p2b();break;case 1312363469:this.showSlicerContextMenu(nc);break;default:$c=ob.a(jb)}return $c||P.TaskExtensions.Qaa()};B.prototype.Ac=function(jb,Eb,nc){jb=!1;switch(Eb.command){case -231711729:case 2108047455:case -1909381757:jb=!0;break;case 1312363469:jb=!!nc}return jb};B.prototype.QY=
function(){var jb=this.Va.mq(this.menuId),Eb=this.Va.Bc();Eb.buttons.push(this.Va.nb(252));Eb.buttons.push(this.Va.nb(253));Eb.buttons.push(this.Va.nb(254));jb.pc.push(Eb);Eb=this.Va.Bc();this.Gmi()?Eb.buttons.push(this.Va.nb(266)):Eb.buttons.push(this.Va.nb(267));jb.pc.push(Eb);return jb};B.prototype.Gmi=function(){if(wb.a.ud(this.$)){var jb=this.$.da.za(439);if(jb)return jb.Kr}else if(jb=this.$.da.za(371))return jb.Kr;return!1};B.prototype.showSlicerContextMenu=function(jb){var Eb=Object(Fb.a)(ed.a,
jb.eventArgs);jb=this.qac(Object(Fb.a)(ed.a,jb.eventArgs));Eb=Eb.mb;Db.a.Cb=Eb;this.np(jb,!1,Eb)};B.prototype.nVe=function(jb){var Eb=this.Va.Bc(),nc=this.Va.Bc();nc.buttons.push(this.Va.nb(255));nc.buttons.push(this.Va.nb(256));var $c=this.Va.O2c("ContextMenu.SlicerSort",null,sb.a.instance.ga(2149),-814639094,0,ic.a.lOe);$c.menu.pc.push(nc);Eb.buttons.push($c);jb.pc.push(Eb)};B.prototype.Vxj=function(jb){return Ab.EwaSettings.isChangeGateEnabled("OfficeVSO:5103035_SlicerCornerResizePointContextMenuUseOnlyClientPoint")&&
jb.zb.className===ic.a.K8c||Ab.EwaSettings.isChangeGateEnabled("OfficeVSO:5185773_SlicerShortcutContextMenuSkipFramePoint")&&1===jb.mb};B.prototype.qac=function(jb){var Eb=Ya.g(this.$).ha.Oa.Yb,nc=jb&&1!==jb.mb&&jb.clientPoint?jb.clientPoint:Sys.UI.DomElement.getLocation(Eb.domElement);if(this.Vxj(jb)){var $c=this.Tbc();$c&&(jb.zb.className===ic.a.K8c&&(nc=Bc.HelperMethods.Hub(jb.Ca)),1===jb.mb&&(nc=Lb.a(this.$).xja(qe.DOMElementExtensions.getLocation($c.frame))))}else if(jb=this.Tbc())jb=this.UOh(jb.frame),
($c=Bc.HelperMethods.FC(this.$.uf,this.$.domElement,Ya.g(this.$).rtl,!1))?(jb.x=Lb.a(this.$).ii(jb.x-$c.x)+$c.x,jb.y=Lb.a(this.$).ii(jb.y-$c.y)+$c.y):W.ULS.sendTraceTag(537166989,0,15,"Cannot get constant pane size."),nc.y+=jb.y,nc.x+=jb.x;jb=this.$.domElement;$c=Ya.g(this.$).rtl;Eb=Bc.HelperMethods.FC(Eb.dg.domElement,jb,$c);nc.y=Math.max(nc.y,Eb.y);nc.x=Math.max(nc.x,Eb.x);return nc};B.prototype.Tbc=function(){var jb=Ya.g(this.$).ha.Oa.Yb;W.ULS.shipAssertTag(537166988,0,!!jb);return h.a(this.$).kH(jb.floatingObject.id)};
B.prototype.UOh=function(jb){var Eb=new Sys.UI.Point(jb.offsetParent.offsetLeft,jb.offsetParent.offsetTop),nc=Ya.g(this.$);if(!nc)return Eb;var $c=Ya.g(this.$).rtl;Eb=Bc.HelperMethods.FC(jb,this.$.Wq.ownerDocument.body,$c);nc.LBe(Eb);Eb.x=$c?this.$.Wq.clientWidth-Eb.x-jb.clientWidth:Eb.x;jb=nc.view.Job;nc=$c?-nc.XR.ica(jb.x):jb.x;Eb.x-=nc;Eb.y-=jb.y;return Eb};Af.Object.defineProperties(B.prototype,{yw:{configurable:!0,enumerable:!0,get:function(){return"PopulateSlicerContextMenu"}},wB:{configurable:!0,
enumerable:!0,get:function(){return Kb.a.lLf}}});Object(ba.a)(B,"SlicerContextMenu",Hb.a,[]);Object(ba.a)(A,"TimeSlicerRibbonButtonParameter",null,[]);var Tb=Hb.a;Rk(v,Tb);v.prototype.executeCommand=function(jb,Eb,nc){jb=Eb.command;switch(jb){case 2000085697:jb=nc.DOMElement;this.vsa=nc.ChangeLevelCallback;this.YJa=nc.GetLevelLabelCallback;this.E0a=nc.CurrentLevel;var $c=nc.DomEvent;Ta.g($c);var od=nc.location;nc=nc.levelLabelText;this.tJe=qe.DOMElementExtensions.nz(document.activeElement,"iframe")&&
nc?nc.parentNode:null;nc=Sys.UI.DomElement.getBounds(nc);nc.x=od.x;nc.y=od.y;this.y0($c,jb,nc,Eb,!0);break;case -649826274:this.vsa(0);break;case 149600865:this.vsa(1);break;case -2012435159:this.vsa(2);break;case -1979934975:this.vsa(3);break;case 1634477200:qe.DOMElementExtensions.setFocus(this.tJe);break;default:return ob.a(jb)}return Cb.Task.Ua(!0)};v.prototype.Ac=function(jb,Eb,nc){jb=!1;switch(Eb.command){case 2000085697:jb=!!nc;break;case -649826274:case 149600865:case -2012435159:case -1979934975:case 1634477200:jb=
!0}return jb};v.prototype.y0=function(jb,Eb,nc){jb=Sys.UI.DomElement.getBounds(Eb);nc.x=Lb.a(this.$).ii(nc.x);nc.y=Lb.a(this.$).ii(nc.y);jb.x=Lb.a(this.$).ii(jb.x);jb.y=Lb.a(this.$).ii(jb.y);jb=new Sys.UI.Point(jb.x+nc.x,jb.y+nc.y);this.qTa(jb,Eb);this.showContextMenu(new Sys.UI.Bounds(jb.x,jb.y-nc.height,nc.width,nc.height))};v.prototype.QY=function(){for(var jb=this.Va,Eb=jb.mq(this.menuId),nc=jb.Bc(),$c=0;3>=$c;$c++){var od=this.YJa($c),de=v.nJh($c);de=jb.d4g(de.c2g,de.pr,this.E0a===$c,v.vxe);
de.label=od;de.$R(od);this.E0a===$c?de.bS("Image16by16",8,v.vxe):de.g2b();nc.buttons.push(de)}Eb.pc.push(nc);return Eb};v.nJh=function(jb){var Eb=null;switch(jb){case 0:Eb=new A(87,"ContextMenu.TimeSlicerLevelYear",-649826274);break;case 1:Eb=new A(88,"ContextMenu.TimeSlicerLevelQuater",149600865);break;case 2:Eb=new A(89,"ContextMenu.TimeSlicerLevelMonth",-2012435159);break;case 3:Eb=new A(90,"ContextMenu.TimeSlicerLevelDay",-1979934975)}return Eb};Af.Object.defineProperties(v.prototype,{yw:{configurable:!0,
enumerable:!0,get:function(){return"PopulateTimeSlicerLevelMenu"}},wB:{configurable:!0,enumerable:!0,get:function(){return Kb.a.oLf}}});v.hJj=Kb.a.g2g;v.PIb="TimeSlicerLevelMenuRootName";v.vxe=ic.a.eua;Object(ba.a)(v,"TimeSlicerLevelMenu",Hb.a,[]);var yc=b(329),vc=b(3),yd=sa.a;Rk(r,yd);r.prototype.zd=function(){var jb=this,Eb=this.$,nc=Mc.a.BHa(mc.b(),this.la,"Task","IRootUser"),$c=ya.a(Eb),od=null;od=function(ze,Xd){$c.WPf(od);nc.setResult(Xd.D3b)};$c.bne(od);$c.Q_e();var de=nb.GetServiceTaskFactory.create(Eb.da,
102,Eb.la,this.hb),ae=nb.GetServiceTaskFactory.Ra(Eb.da,342,338,this.hb);P.TaskExtensions.Ba(P.TaskExtensions.Wd([nc.task,de,ae],this.la),function(){var ze=de.result,Xd=nc.task.result,te=ae.result;jb.jd([new S(Eb,Xd,ze,te),new Y(Eb,Xd,ze,te),new ka(Eb,Xd,ze,te),new ca(Eb,Xd,ze,te),new U(Eb,Xd,ze,te),new qa(Eb,Xd,ze,te),new za.GridContextMenu(Eb,Xd,ze,te),new I(Eb,Xd,ze,te),new y(Eb,Xd,ze,te),new v(Eb,Xd,ze,te),new C(Eb,Xd,ze,te),new fa(Eb,Xd,ze,te),new E(Eb,Xd,ze,te),new B(Eb,Xd,ze,te),new x(Eb,Xd,
ze,te)])},Eb.la,3)};r.initData=function(){var jb=yc.a.i2;jb(2000085697,20479,0,0);jb(-227942804,vc.a.wc|24576,0,0);jb(1634477200,vc.a.wc|131072,0,0);jb(-649826274,4095,0,0);jb(149600865,4095,0,0);jb(-2012435159,4095,0,0);jb(-1979934975,4095,0,0);jb(1247109494,vc.a.wc|24576,0,0);jb(-2064931494,vc.a.wc|131072,0,0);jb(-1396319072,vc.a.Ha,128,0);jb(-425234874,vc.a.Ha,128,0);jb(-1253126584,vc.a.Ha,0,0);jb(274207288,vc.a.wc|24576,0,0);jb(-1497523576,vc.a.wc|131072,0,0);jb(-498523270,vc.a.wc|24576,64,0);
jb(1640762262,vc.a.wc|131072,64,0);jb(-2017893763,vc.a.wc|24576,0,0);jb(1350204367,vc.a.wc|131072,0,0);jb(-889576107,vc.a.Pv,128,0);jb(-1170196828,vc.a.Pv,128,0);jb(389774337,vc.a.Pv,128,0);jb(1529312473,vc.a.Pv,128,0);jb(2033235475,vc.a.Pv,128,0);jb(-96230454,vc.a.Pv,128,0);jb(74086617,vc.a.Pv,128,0);jb(563292088,vc.a.Pv,128,0);jb(-1092351914,vc.a.Pv,128,0);jb(-2141589616,vc.a.Pv|16384,128,0);jb(745182485,vc.a.Pv,0,0);jb(359279088,vc.a.Pv,128,0);jb(-67292059,vc.a.Pv,128,0);jb(926905850,vc.a.Pv,128,
0);jb(547535945,vc.a.Pv,128,0);jb(1374696078,vc.a.wc|24576,0,0);jb(495005930,vc.a.wc|212992,0,0);jb(-1045020714,vc.a.wc|24576,0,0);jb(-170383950,vc.a.wc|212992,0,0);jb(324156914,vc.a.Ha,0,0);jb(-1085236154,vc.a.Du,0,0);jb(-751848458,vc.a.fl|16384,0,0);jb(216058793,vc.a.Du,0,0);jb(474690375,vc.a.fl|16384,0,0);jb(-1920954846,vc.a.wc|24576,0,0);jb(723126814,vc.a.wc|131072,0,0);jb(2108047455,128,128,0);jb(-231711729,128,128,0);jb(-1909381757,128,128,0);jb(-814639094,128,128,0);jb(1701016594,vc.a.wc|3072,
128,0);jb(-1475408662,vc.a.wc|24576,0,0);jb(1114549926,vc.a.wc|131072,32,0)};r.ka=function(jb){sa.a.Qd(10,new r(jb))};Object(ba.a)(r,"ContextMenuCommandHandlerFactory",sa.a,[]);var Dd=b(232),qd=b(1601),xe=b(93),Ge=b(266);z.prototype.dispose=function(){};z.prototype.T$=function(){this.Dqb.r3()};z.prototype.wC=function(){this.Dqb.wC()};z.prototype.eRd=function(jb,Eb,nc){Wb.h(this.$,Wb.b);this.Dqb.showContextMenu(Object(va.a)(new qd.a,{x:Eb.x,y:Eb.y}),nc,jb);xe.EventHandlerManager.instance.Pad()};z.prototype.sxc=
function(jb,Eb,nc){Wb.h(this.$,Wb.b);this.Dqb.showFloatie(Object(va.a)(new qd.a,{x:Eb.x,y:Eb.y}),jb,nc);Ge.a(function(){xe.EventHandlerManager.instance.Pad()},this.$.la)};z.prototype.dRd=function(jb,Eb,nc,$c){Wb.h(this.$,Wb.b);this.Dqb.dRd(Object(va.a)(new qd.a,{x:Eb.x,y:Eb.y}),jb,nc,$c)};Object(ba.a)(z,"ReactContextMenuController",null,[720,10]);var Xe=Dd.a;Rk(n,Xe);n.prototype.dispose=function(){this.y9e&&this.$&&this.$.ea.Ln(this.Ekd);Xe.prototype.dispose.call(this)};n.prototype.create=function(){this.$.ea.fh?
(W.ULS.sendTraceTag(537167065,0,50,"ContextMenuControllerFactory.InitReactUISurfacesAndRegisterControllerIfNeeded: GFI = {0}",this.$.ea.fh),this.Ekd(null,null)):(this.y9e=!0,this.$.ea.wl(this.Ekd))};n.ka=function(jb){jb.da.Ga(338,new n(jb))};Object(ba.a)(n,"ContextMenuControllerFactory",Dd.a,[]);var Bb=b(161);Object(ba.a)(w,"RibbonCommandParams",null,[]);Object(ba.a)(f,"HeaderSnappedAutoFilterMenuCacheEntry",null,[]);m.prototype.zJh=function(jb){return(jb=this.rdc[jb.toString()])?jb.menuModel:null};
m.prototype.PSg=function(jb,Eb){this.rdc[Eb.toString()]=Object(va.a)(new f,{menuModel:jb,CEe:Bc.HelperMethods.Qb()})};m.prototype.f7b=function(jb){this.rdc[jb.toString()]=null};m.prototype.VYh=function(jb){return(jb=this.rdc[jb.toString()])?jb.CEe:-1};Object(ba.a)(m,"FilterMenuCache",null,[]);var zc=b(13),Mb=b(195),cc=b(233);Object(ba.a)(l,"AutoFilterEventRegistrationArgs",null,[]);k.prototype.dispose=function(){window.cancelAnimationFrame(this.iBb);this.gridView&&this.gridView.vsc(this.fEb);this.gridView=
null};k.prototype.Y8h=function(){if(this.wQd=Bc.HelperMethods.w6a)this.tZa=[];this.$Bg();this.gridView.dZb(this.fEb)};k.prototype.$Bg=function(){for(var jb=ak(this.gridView.hn),Eb=jb.next();!Eb.done;Eb=jb.next()){Eb=Eb.value.NBa;for(var nc in Eb){var $c=Eb[nc];this.JJf($c.domElement,$c.hashCode)}}};k.prototype.JJf=function(jb,Eb){if(Ya.g(this.$).Ea.im.n1a(Eb))if(jb){jb=jb.querySelectorAll('[id^="'+Kb.a.z$c+'"]');for(var nc=0;nc<jb.length;nc++){var $c=jb[nc],od=$c.getAttribute(Kb.a.Kzh),de=$c.getAttribute(Kb.a.Dzh);
W.ULS.shipAssertTag(537167053,0,!!od&&!!de,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Row and Column attributes should exist in AF input element. AutoFilterId: {0}, BlockHash: {1}",$c.id,Eb);od=kd.Range.Tc(parseInt(od,10),parseInt(de,10));$c=Object(va.a)(new l,{cell:od,ose:$c,Kd:Eb});this.wQd?(this.tZa.push($c),this.iBb||(this.NLe=window.performance.now(),this.iBb=window.requestAnimationFrame(this.zNf))):this.kle($c)}}else W.ULS.sendTraceTag(537167054,0,50,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block DOM element is null. BlockHash: {0}",
Eb);else W.ULS.sendTraceTag(537167055,0,50,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block model does not exist yet. Handlers will be added when block is rendered. BlockHash: {0}",Eb)};k.prototype.kle=function(jb){var Eb=this.gridView.Ea.$Ja(jb.cell,jb.Kd);Eb?this.ZBg(jb.ose,Eb):W.ULS.sendTraceTag(537167050,1,10,"FilterMenuManager.AddPointerHandlersToAutoFilterInCell: GetModelCellFromRange returned null. BlockHash: {0}, AutoFilter Cell: {1}",jb.Kd,jb.cell)};k.prototype.ZBg=
function(jb,Eb){Eb.hasAutoFilter?this.aAg(jb,Eb.wtb):Eb.q4?this.XBg(jb,Eb.wtb,Eb.Uod):W.ULS.sendTraceTag(537167049,1,50,"FilterMenuManager.AddPointerEventHandlersToAutoFilter: Cell must have either AutoFilter or PivotFilter if reached here!");Bb.a.instance.qa(zc.a.sf,jb,this.onPointerDown);Mb.a.instance.qa(zc.a.Txa,jb,this.onPointerDown)};k.prototype.aAg=function(jb,Eb){cc.a.instance.qa(zc.a.click,jb,function(nc){Eb&&fc.a.hrc(nc.Ca.rawEvent,966232027,Eb,null);return!0})};k.prototype.XBg=function(jb,
Eb,nc){var $c=Va.a.Vh(Eb);cc.a.instance.qa(zc.a.click,jb,function(od){nc?fc.a.spf(document.getElementById($c.EwaElementId),$c.Cell,$c.DataSourceIndex,$c.FieldId,$c.IsOlap,$c.RequiresConfirmation,od.Ca.rawEvent,$c.OptionalPivotMenuAnchor):fc.a.spfm(od.Ca.rawEvent,$c.RequiresConfirmation,$c.Cell,$c.DataSourceIndex,$c.PivotName,$c.OptionalPivotMenuAnchor);return!1})};Object(ba.a)(k,"FilterMenuPointerEventsManager",null,[10]);e.prototype.dispose=function(){Ab.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&
Ab.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||this.cSe.dispose();this.$=null};e.prototype.GPh=function(jb){var Eb=Ya.g(this.$).Ea.a$(jb,this.$.activeItemName);return Eb&&Eb.blockPresentInViewportTimeStamp>this.r8a.VYh(jb.left)?Eb.Nr(jb).autoFilterMenu:this.r8a.zJh(jb.left)};e.prototype.HMi=function(jb,Eb,nc){this.r8a&&this.r8a.PSg(jb.menuModel[Eb],nc)};e.prototype.IMi=function(jb){this.r8a&&this.r8a.f7b(jb)};Object(ba.a)(e,"FilterMenuManager",null,[719,10]);var Uc=b(211),
Rb=b(174);d.prototype.Icd=function(jb){return pa.a.zc(this.Rxc,jb)};d.prototype.dispose=function(){this.Ad?W.ULS.sendTraceTag(537167062,1,50,"ContextMenuManager.Dispose: Dispose has been called more than once"):(this.Ad=!0,this.$&&(this.$.ol(d.Yc),this.$.da.xU(8),this.ha&&this.ha.nsc(this.Jl),this.$.Ka.UHb(this.dvf),Ab.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ka&&this.$.Ka.Cza(this.oR),Ab.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||
this.$.ea.e0(this.X5)),this.$=this.ha=null,this.n9b.dispose(),this.Rxc=this.B5d=null)};d.prototype.showContextMenu=function(jb,Eb,nc){Eb=void 0===Eb?null:Eb;nc=void 0===nc?null:nc;this.Axj(jb)&&(Wb.h(this.$,Wb.i),jb=this.o5g(jb,Eb,nc),this.$.Ka.Kb(jb.Ed,jb.dictionary))};d.prototype.r3=function(){this.contextMenuController?this.contextMenuController.T$():W.ULS.sendTraceTag(537167061,1,10,"ContextMenuManager.DismissContextualUI: Context menu controller is null.")};d.prototype.Axj=function(jb){return jc.a(this.$).Pp()?
(W.ULS.sendTraceTag(537167060,1,50,"ContextMenuManager.OnContextMenu: Ignoring ContextMenu event because it is not allowed in partial interactivity mode"),jc.a(this.$).pW(Rb.a.grid,Uc.a.showContextMenu),!1):!this.$.Ka.fxh&&(!jb||jb.zb!==Ya.g(this.$).domElement&&!bd.a.equals(jb.zb.tagName,"INPUT",!0))};d.prototype.o5g=function(jb,Eb,nc){Eb=void 0===Eb?null:Eb;var $c={};nc=($c.eventArgs=jb,$c.creationParams=void 0===nc?null:nc,$c);jb=jb?jb.mb:-1;$c=this.ha.Oa.Yb;var od=1441131127;$c?(Eb=$c.floatingObject,
W.ULS.shipAssertTag(537167059,0,!!Eb,"floatingObj shouldn't be null."),d.fqd(Eb)?od=1312363469:d.isPivotChart(Eb)?(nc[Y.p_c]=Eb?Eb.Oc:null,od=-149612405):od=-1372040782):d.Sef(Eb)?(nc[Y.p_c]=Eb,od=-149612405):!Wb.g(this.$)&&Wb.f(Ya.g(this.$))&&(od=671488277);Eb=new $a.a(od,jb,this.$.Jc,30,null);return Object(va.a)(new w,{Ed:Eb,dictionary:nc})};d.ka=function(jb){jb.Tk(d.Yc)};d.isPivotChart=function(jb){return!!jb&&0===jb.type&&d.Sef(jb.Oc)};d.fqd=function(jb){return!!jb&&2===jb.type};d.Sef=function(jb){return!!jb&&
!!(jb.Attributes&4)};Af.Object.defineProperties(d.prototype,{n9b:{configurable:!0,enumerable:!0,get:function(){return this.B5d}}});d.h2g="autoFilter chart fieldList fieldListPivotFilter fieldWell floatingObject grid pivotFilter sheetOps timeSlicerLevel tableFieldList autoFilterRichFieldList slicer richText".split(" ");d.K0h="GridContextMenu";d.Yc=function(jb){(jb=Object(Fb.a)(6,jb))&&nb.GetServiceTaskFactory.create(jb.da,9,jb.la,0)};Object(ba.a)(d,"ContextMenuManager",null,[701,10]);var qc=Dd.a;Rk(c,
qc);c.prototype.create=function(){var jb=this,Eb=this.$,nc=Eb.ic;if(nc.allowSelection||nc.allowEdits||nc.allowFiltering||nc.allowSorting||nc.allowPivotSpecificOperations){var $c=nb.GetServiceTaskFactory.create(Eb.da,10,Eb.la,this.hb),od=nb.GetServiceTaskFactory.Ra(Eb.da,342,338,this.hb);P.TaskExtensions.Ba(P.TaskExtensions.Wd([$c,od],this.la),function(){jb.pb(Ub.a(Eb)||new d(Eb,$c.result,od.result))},this.$.la,3)}else W.ULS.sendTraceTag(537167058,0,15,"ContextMenuManagerFactory.Create: no client permissions to allow creating ConetxtMenuManager. Returning null."),
Eb.da.xU(8),this.pb(null)};c.ka=function(jb){jb.da.Ga(9,new c(jb))};Object(ba.a)(c,"ContextMenuManagerFactory",Dd.a,[]);var Oc=b(11);b.d(D,"a",function(){return a})},1344:function(u,D,b){function a(){W.a.Fa(function(Bb){Na.ka(Bb);ta.ka(Bb);c.ka(Bb)})}function c(Bb){var zc=Xe.call(this)||this;zc.$=Bb;zc.Eb();return zc}function d(Bb,zc,Mb,cc,Uc,Rb,qc){var Oc=this;this.$=Bb;this.functionInfoManager=zc;this.calcManager=Mb;this.pluginScheduler=cc;this.formulaAssistanceUIControl=Uc;this.formulaAssistanceTelemetryManager=
Rb;this.Jg=qc;this.GRa=!0;this.GLa=this.isCellContentOnlyEqualDuringEdit=!1;this.Rka=null;this.XMa=-1;this.fW=0;this.rba=ma.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");this.mzb=ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NotifyActiveCellOnEditStarted",!1);this.Fh=function(jb,Eb){Oc.gridView.isEditing||Oc.gridView.xi||Oc.YNa(null===Eb||void 0===Eb?void 0:Eb.cell)};this.Gh=function(jb,Eb){Oc.YNa(null===Eb||void 0===Eb?void 0:Eb.Via)};this.onFunctionInfoLoaded=
function(){Oc.functionInfoManager.Xab(Oc.onFunctionInfoLoaded);Oc.ZSj();Oc.nda()};this.otf=function(){Oc.GRa=!1};this.wtf=function(jb,Eb){var nc=Oc.Ya;jb=nc.text;nc=nc.textBox.caretPosition;0<Oc.fW&&Oc.formulaAssistanceTelemetryManager.tY.commitWhileRequestPending++;Oc.formulaAssistanceTelemetryManager.oO(["argumentAssistanceComputation","argumentAssistanceOverall"]);Eb.shouldRequestAutocompleteOnCommit?Oc.GWf(jb,nc):Oc.VJd(jb,nc)};this.Df=function(){Oc.l2&&(Oc.isCellContentOnlyEqualDuringEdit&&(Oc.formulaAssistanceTelemetryManager.xM.isCellContentOnlyEqualDuringEditCounter++,
Oc.isCellContentOnlyEqualDuringEdit=!1),Oc.GLa&&(Oc.formulaAssistanceTelemetryManager.xM.isCellContentFormulaCounter++,Oc.GLa=!1));Oc.GRa=!0;ma.EwaSettings.isChangeGateEnabled("OfficeVSO:6103891_dismissControlOnEditEnded")&&Oc.s6b()};this.Y5=function(jb,Eb){Oc.zLd(Eb.newValue)};this.Ai=function(){Oc.ccg()};this.ccg=function(){Oc.pluginScheduler.notifier().setDefinedNamesInfo(Oc.P5b.hGe)};this.Idd=function(jb,Eb){jb=Oc.pluginScheduler.syncRequester().formulaHighlighting({content:jb,caretPosition:null===
Eb||void 0===Eb?void 0:Eb.index,selectionLength:null===Eb||void 0===Eb?void 0:Eb.length});if(isNullOrUndefined(jb)||isNullOrUndefined(jb.formulaHighlights))Ma.ULS.sendTraceTag(521211933,0,10,"FormulaAssistanceManager.getFormulaHighlights: formulaHighlightingResult is null or undefined, formulaHighlights array is null:{0}",!isNullOrUndefined(jb));else return jb};this.functionInfoManager=zc;this.formulaAssistanceUIControl=Uc;this.pluginScheduler=cc;this.gridView=bb.g(this.$);this.nef=ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest");
this.I4=ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);this.xxd=ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");this.l2=ma.EwaSettings.isChangeGateEnabled("OfficeVSO:6352308_addTelemetryAtFormulaAssistance");this.KXc=ma.EwaSettings.isChangeGateEnabled("OfficeVSO:6488306_BlockFormulasuggestionInPivotTable");this.whi=ma.EwaSettings.isChangeGateEnabled("OfficeVSO:6646054_FixNoPreviewBugEnabled");this.nef&&(this.P5b=new Y(Bb),
this.gridView.Ea.mx(this.Ai),this.ccg());this.Tpa=new m(this.$,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);this.G8=new l(this.$,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);this.Shi=wc.a.pba(Bb);this.Xwa=wc.a.Xwa(Bb);this.T4=wc.a.T4(Bb);this.Shi&&(this.sDh=new e(this.$));Bb.da.Ga(464,this);this.calcManager=Mb;wc.a.rV()&&this.Zkd();this.l2&&this.gridView.$b.vm(this.Df);this.I4&&(this.l2||this.gridView.$b.vm(this.Df),this.Tpa.qEg(this.otf));this.Cmd=
ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertToSheetGridCell",!1)}function e(Bb){this.$=Bb}function k(Bb,zc){var Mb=this,cc,Uc;this.Jg=Bb;this.$=zc;this.kya=function(){Mb.e9b.resolve(Mb.Jg.Hk);Mb.yag()};this.Vwf=function(){Mb.e9b.reject(null);Mb.yag()};this.Df=function(){Mb.Jg.vbb();Mb.Grd=null};null===(Uc=null===(cc=bb.g(this.$))||void 0===cc?void 0:cc.$b)||void 0===Uc?void 0:Uc.vm(this.Df);this.WBj=ma.EwaSettings.isChangeGateEnabled("OfficeVSO:6476169_skipGetFieldInfoListContextIfContextLoaded")}
function l(Bb,zc,Mb){var cc=qd.call(this,l.xJa())||this;cc.$=Bb;cc.formulaAssistanceUIControl=zc;cc.formulaAssistanceTelemetryManager=Mb;cc.Ya=null;cc.fr=null;cc.hIa=!1;cc.iIa=!1;cc.gIa=!1;cc.eIa=!1;cc.fIa=!1;cc.It=null;cc.VW=0;cc.Jq=null;cc.Hv=!1;cc.vfa=!1;cc.JAa=!1;cc.cSa=!1;cc.bSa=!1;cc.BNb=Dd.Dismissed;cc.onRestoreFocus=function(){};cc.dismiss=function(){cc.Hv=!1;cc.ctd();cc.AH&&cc.Ya.isEditing&&cc.Fma();cc.Jq=null;cc.formulaAssistanceUIControl&&(cc.formulaAssistanceUIControl.dismiss(cc.domElement),
cc.fr.canReceiveFocus=!1,cc.BNb=Dd.Dismissed)};cc.ehd=function(){cc.raiseEvent("FAFocusOnSmartSuggestionsCard",null)};cc.tca=function(Uc,Rb){0==Rb.Fq&&(170==Rb.Ff.operation.operationName&&cc.formulaAssistanceTelemetryManager.ljc++,cc.$.userOperationManager.wo(cc.tca))};cc.uOa=function(Uc,Rb){0==Rb.Fq&&(12==Rb.Ff.operation.operationName&&cc.$.userOperationManager.Cr(cc.tca),cc.$.userOperationManager.wo(cc.uOa))};cc.eJi=function(){cc.dismiss();bb.g(cc.$).Ki.textBox.focus()};cc.VQa=function(){var Uc=
{};cc.VDf?Uc[yb.a.SU]="SmartSuggestionsCard":Uc[yb.a.SU]="FunctionAndSmartSuggestionsCard";cc.$.Fd(802602464,0,8,Uc)};cc.Df=function(){cc.Ryb&&cc.tIg()};cc.Wyd=function(Uc,Rb){cc.Yeb(Rb);cc.iIa=!0};cc.Rc=function(){cc.visible=!1};cc.Vyd=function(Uc){cc.fIa=!0;cc.lqb(Uc)};cc.wh=function(){cc.dismiss()};cc.$s=function(){void 0!==cc.Jq&&null!==cc.Jq&&cc.Jq()};cc.fr=new X(cc.$,cc.formulaAssistanceUIControl,1,fe.a.Zad,cc.ehd);bb.g(cc.$).view.Gs(cc.$s);bb.g(cc.$).ha.yG(cc.Rc);cc.$.va.Kf(cc.wh);cc.Ryb=ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5523443_FormulaSuggestionsCardUserInteractionTelemetry");
cc.x9=ma.EwaSettings.isChangeGateEnabled("OfficeVSO:6378161_addKeptSmartSuggestionsMetric");cc.Ryb&&bb.g(cc.$).$b.vm(cc.Df);ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&cc.$.domElement.appendChild(cc.domElement);cc.hji=ma.EwaSettings.isChangeGateEnabled("OfficeVSO:6312266_RedesignListBoxEvents");return cc}function m(Bb,zc,Mb){var cc=yd.call(this,m.xJa())||this;cc.$=Bb;cc.formulaAssistanceUIControl=zc;cc.formulaAssistanceTelemetryManager=Mb;cc.y2=0;cc.fr=
null;cc.Jq=null;cc.Qka=null;cc.Hv=!1;cc.RQ=!1;cc.Rc=function(){cc.visible=!1};cc.onCardModeChange=function(Uc){cc.NNb(Uc);1===Uc?cc.formulaAssistanceTelemetryManager.T9.argumentAssistanceCollapseCounter++:cc.formulaAssistanceTelemetryManager.T9.argumentAssistanceExpandCounter++};cc.VQa=function(Uc){var Rb={};Rb[yb.a.SU]="ArgumentAssistanceCard";var qc={};qc.FunctionName=Uc.functionName;Rb[yb.a.f$c]=qc;cc.$.Fd(802602464,0,8,Rb)};cc.$s=function(){void 0!==cc.Jq&&null!==cc.Jq&&cc.Jq()};cc.onDismissClick=
function(){cc.formulaAssistanceTelemetryManager.T9.argumentAssistanceDismissCounter++;cc.dismiss();cc.raiseEvent("DC");cc.RQ&&cc.QG.clear();0===cc.y2&&cc.NNb(1)};cc.Df=function(){cc.RQ&&cc.QG.clear()};cc.I4=ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);cc.cOd();cc.fr=new X(cc.$,cc.formulaAssistanceUIControl,0,fe.a.Wad);bb.g(cc.$).view.Gs(cc.$s);bb.g(cc.$).ha.yG(cc.Rc);cc.RQ=ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",
!1)&&ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",!1);cc.RQ&&(cc.QG=new F(cc.formulaAssistanceUIControl,cc.formulaAssistanceTelemetryManager),bb.g(cc.$).$b.vm(cc.Df));ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&cc.$.domElement.appendChild(cc.domElement);return cc}function f(Bb,zc,Mb,cc,Uc,Rb,qc,Oc,jb){var Eb=vc.call(this,Bb)||this;Eb.functionInfoManager=zc;Eb.calcManager=cc;Eb.instantaneousSupportInformationManager=
Uc;Eb.formulaAssistanceUIControl=qc;Eb.formulaAssistanceTelemetryManager=Oc;Eb.pluginScheduler=jb;Eb.vdc=!1;Eb.fr=null;Eb.iGa=null;Eb.qg=null;Eb.EV=null;Eb.ard=null;Eb.o5=null;Eb.T2a=0;Eb.r$b=0;Eb.v3=0;Eb.vIe=0;Eb.lsb=0;Eb.Pdb=0;Eb.a5b=0;Eb.Xwc=!1;Eb.Iia=null;Eb.lpc=null;Eb.columnName="";Eb.q5c=!1;Eb.Sve=!1;Eb.nJa=[];Eb.ZP=null;Eb.aSa=[];Eb.Jq=null;Eb.wbd=null;Eb.k8=null;Eb.vfa=!1;Eb.JAa=!1;Eb.cSa=!1;Eb.bSa=!1;Eb.isCellContentOnlyEqualDuringEdit=!1;Eb.GLa=!1;Eb.Rka=null;Eb.XMa=0;Eb.f1d=null;Eb.zCb=
0;Eb.Wld=!1;Eb.onRestoreFocus=function(){};Eb.rfb=void 0;Eb.rba=ma.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");Eb.Vdf=ma.EwaSettings.isChangeGateEnabled("OfficeVSO:6592409_startArgumentAssistanceTimerBeforeAutocompleteCalculation");Eb.mzb=ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NotifyActiveCellOnEditStarted",!1);Eb.ehd=function(){Eb.Dk&&Eb.raiseEvent(f.Bad,null)};Eb.YRe=function(){Eb.Iia=!1;Eb.EV=Eb.Ya.text;Eb.dh.aJa(Eb.It,Eb.EV,!0,Eb.columnName,
void 0,!1);1===Eb.dh.pq.length&&1===Eb.dh.kW.length?(Eb.set_visible(!1),Eb.Sve||Eb.fkd()):Eb.show()};Eb.nMi=function(nc){if(Xb.a(nc))-315732528!==nc.Errors[0].MessageId&&Ma.ULS.sendTraceTag(537162013,0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call failed with Unexpected error : {0}",ve.a.Dc(nc.Errors));else if((nc=nc.Result)&&nc.length){Eb.qg.sO||(Eb.qg.sO={},Eb.qg.sO.HeadersList=[]);Eb.qg.sO.IsFullTableHeaders=!0;for(var $c=0;$c<nc.length;++$c)Eb.qg.sO.HeadersList[$c]=
{},Eb.qg.sO.HeadersList[$c].Index=$c,Eb.qg.sO.HeadersList[$c].Name=nc[$c];Eb.FGf(!0);Eb.EV=Eb.j2e();Eb.dh.aJa(Eb.It,Eb.EV,!0,void 0,void 0,!0);Eb.show()}else Ma.ULS.sendTraceTag(537162012,0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call returned no results")};Eb.mMi=function(nc){nc=lc.a.Of(nc.data);Ma.ULS.sendTraceTag(537162011,0,10,"FormulaAssistanceControl.OnGetTableColHeadersFailure - Webservice call failed with Errors: {0}",ve.a.Dc(nc))};Eb.Rsf=function(nc,$c){Eb.gridView.isEditing||
Eb.gridView.xi||Eb.YNa(null===$c||void 0===$c?void 0:$c.cell)};Eb.Gh=function(nc,$c){Eb.YNa(null===$c||void 0===$c?void 0:$c.Via)};Eb.Y5=function(nc,$c){Eb.zLd($c.newValue)};Eb.Rc=function(){(ma.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")||Eb.Dk)&&Eb.set_visible(!1)};Eb.Nwf=function(){Eb.iGa=null;Eb.k8=null};Eb.wh=function(){Eb.Dk&&Eb.i1a()};Eb.onFunctionInfoLoaded=function(){Eb.Ynb()};Eb.kya=function(){Eb.Wja?(Eb.k8=null,Eb.iGa=null,Eb.Ynb()):
Eb.Jg.Hk&&Eb.zre()};Eb.qca=function(){Eb.ZP&&ya(Eb.$,Eb.ZP.HelpId,Eb.ZP.IsDynamicUdf);return!0};Eb.tca=function(nc,$c){0==$c.Fq&&(170==$c.Ff.operation.operationName&&Eb.formulaAssistanceTelemetryManager.ljc++,Eb.$.userOperationManager.wo(Eb.tca))};Eb.uOa=function(nc,$c){0==$c.Fq&&(12==$c.Ff.operation.operationName&&Eb.$.userOperationManager.Cr(Eb.tca),Eb.$.userOperationManager.wo(Eb.uOa))};Eb.i1a=function(){Eb.Dk&&Eb.ctd();Eb.AH&&Eb.Ya.isEditing&&Eb.Fma();Eb.Jq=null;Eb.formulaAssistanceUIControl&&
(Eb.formulaAssistanceUIControl.dismiss(Eb.b0b),Eb.fr.canReceiveFocus=!1);Eb.Wld=!1};Eb.FBf=function(){Eb.AH&&Eb.Fma();Eb.t3f();1===Eb.qWf.type&&ma.EwaSettings.tb()&&!Eb.Ya.text.includes("\n")&&Eb.WDd(Eb.qWf)};Eb.onDismiss=function(){Eb.isListVisible=!1;Eb.gridView.Ki.textBox.focus()};Eb.VQa=function(){var nc={};Eb.dh.Rhc?nc[yb.a.SU]="SmartSuggestionsCard":nc[yb.a.SU]="FunctionAndSmartSuggestionsCard";Eb.$.Fd(802602464,0,8,nc)};Eb.Wyd=function(nc,$c){Eb.dh.hdg($c);Eb.Dk&&(Eb.iIa=!0)};Eb.Vyd=function(nc){Eb.Dk&&
(Eb.fIa=!0);Eb.AH?(Eb.Wze(),Eb.x9&&Eb.PUf(),Eb.gridView.Ki.endEdit(!0,"FormulaAssistanceControl.OnCompletionItemClicked",0)):nc.textEdit?Eb.lqb(nc.textEdit):Eb.Ny(!0)};Eb.Pq=bb.g(Bb);Eb.domElement.className=Ie.a.ULe;Eb.Jg=Rb.S2c(Bb,Mb);Eb.P5b=new Y(Bb);Eb.Zwg=Mb;f.Bjd||(f.Bjd=f.xJa());Eb.domElement.innerHTML=f.Bjd;Eb.Wxd=RegExp("\\d+");hb.d(Eb.style,Eb.$.isChromeRtl);Eb.Wia=new T(Eb.$,Eb.domElement,Eb.functionInfoManager,Eb.formulaAssistanceUIControl,Eb.formulaAssistanceTelemetryManager,Eb.pluginScheduler);
zc=$get(va.tbd,Eb.domElement);Mb=$get(va.pbd,Eb.domElement);cc=$get(va.vbd,Eb.domElement);Eb.Aog=new y(Eb.$,zc,cc,Mb,Eb);Eb.Jg.aZb(Eb.kya);Eb.functionInfoManager.qYa(Eb.onFunctionInfoLoaded);Eb.functionInfoManager.MEg(Eb.Nwf);Eb.b0b=Eb.domElement;Eb.Dk&&(Eb.$.va.Kf(Eb.wh),Eb.dh.WUc(Eb.FBf),ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&(Eb.b0b=document.createElement("div")));Eb.tSa(!0);Eb.L6f(!0);Eb.$.domElement.appendChild(Eb.b0b);Eb.cQc=0;(Mb=he.a(Bb))&&
Eb.nJa.push(new U(Bb,Mb,Eb,Eb.formulaAssistanceTelemetryManager));Eb.nJa.push(new U(Bb,Eb.Pq.Wb,Eb,Eb.formulaAssistanceTelemetryManager));Eb.Ztb=Eb.nJa[0];Eb.xpb=Eb.nJa[Eb.nJa.length-1];Bb.da.Ga(221,Eb);Eb.instantaneousSupportInformationManager||Eb.$.da.Za(268,function(nc){Eb.instantaneousSupportInformationManager=nc});Eb.pRe=ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1);ma.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)&&(void 0===
Eb.formulaAssistanceTelemetryManager.Eda.anyPluginInitialized?Ma.ULS.sendTraceTag(523511372,0,15,"FormulaAssistanceControl - tried to initiailize mockSetActiveCellExperimentStage before pluginInitialized data is set."):Eb.formulaAssistanceTelemetryManager.Eda.anyPluginInitialized||(Eb.zCb=ma.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)));Eb.IAa=wc.a.T4(Eb.$);Eb.Yxc=wc.a.Xwa(Eb.$);Eb.xxd=ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");
Eb.l2=ma.EwaSettings.isChangeGateEnabled("OfficeVSO:6352308_addTelemetryAtFormulaAssistance");Eb.KXc=ma.EwaSettings.isChangeGateEnabled("OfficeVSO:6488306_BlockFormulasuggestionInPivotTable");wc.a.rV()&&Eb.Zkd();wc.a.TM(Eb.$)&&zc.classList.add("ewa-fb-refactor");Eb.Dk?Eb.gridView.ha.yG(Eb.Rc):Eb.gridView.ha.sP(Eb.Rc);Eb.fr=new X(Eb.$,Eb.formulaAssistanceUIControl,1,fe.a.Zad,Eb.ehd);Eb.Cmd=ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertToSheetGridCell",!1);Eb.x9=ma.EwaSettings.isChangeGateEnabled("OfficeVSO:6378161_addKeptSmartSuggestionsMetric");
Eb.ocf=ma.EwaSettings.isChangeGateEnabled("OfficeVSO:6279033_logAutocompletionStatistics");Eb.gii=ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceGridView",!1);Eb.Fcf=ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixKeydownLayoutTrashingBottleneck",!1)&&ma.EwaSettings.isChangeGateEnabled("OfficeVSO:6347847_FormulaAssistanceLayoutFix");return Eb}function w(){}function n(){this.callbacks=this.completionItems=null;this.activeItemIndex=0}function z(){this.onRestoreFocus=
this.onDismiss=this.onFeedback=this.onCompletionItemCommitted=this.onCompletionItemSelected=null}function r(){this.q9=this._name=null}function v(){this._name=null}function A(){this._name=null}function B(){this.q9=this._name=null}function y(Bb,zc,Mb,cc,Uc){Bb=lf.call(this,Bb,zc)||this;Bb.bra=null;Bb.Ruc=0;Bb.SLb=0;Bb.a3b=null;Bb.HUe=Mb;Bb.fub=cc;Bb.formulaAssistanceControl=Uc;Bb.pq=[];Bb.kW=[];Bb.Dk=wc.a.J4();Bb.pef=Bb.Dk&&ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5931218_FaAvoidDomOperations");
return Bb}function x(){this.textEdit=this.label=null;this.kind=0;this.shouldRequestAutocompleteOnCommit=this.data=this.isPrefixed=this.detail=this.type=null}function C(Bb,zc){this.$=Bb;this.items=zc;this.T4=wc.a.T4(this.$)}function G(Bb,zc){this.g0i=Bb;this.Yqf=zc}function E(){}function I(Bb){this.index=Bb}function U(Bb,zc,Mb,cc){Bb=le.call(this,Bb,zc)||this;Bb.formulaAssistanceControl=Mb;Bb.formulaAssistanceTelemetryManager=cc;Bb.UDf=!1;Bb.KRa=null;Bb.lkd=0;Bb.BFc=null;Bb.PHa=null;Bb.$P=0;Bb.job=
zc.textBox;Bb.Dk=wc.a.J4();Bb.o$i=ma.EwaSettings.tb();Bb.l2=ma.EwaSettings.isChangeGateEnabled("OfficeVSO:6352308_addTelemetryAtFormulaAssistance");return Bb}function M(){this.Iha=this.Esa=this.Fsa=!1;this.hEf=40;this.Sye=41;this.H_a=this.LBd=this.MBd=this.tFb=0;this.hvf=!0;this.nAd=!1;this.XSe=this.pMd=-1}function T(Bb,zc,Mb,cc,Uc,Rb){var qc=bd.call(this,T.xJa(wc.a.J4()))||this;qc.$=Bb;qc.Bj=zc;qc.functionInfoManager=Mb;qc.formulaAssistanceUIControl=cc;qc.formulaAssistanceTelemetryManager=Uc;qc.pluginScheduler=
Rb;qc.v1a=null;qc.y2=0;qc.fr=null;qc.sWc=!1;qc.Jq=null;qc.Qka=null;qc.GRa=!0;qc.RQ=!1;qc.rba=ma.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");qc.Vdf=ma.EwaSettings.isChangeGateEnabled("OfficeVSO:6592409_startArgumentAssistanceTimerBeforeAutocompleteCalculation");qc.onCardModeChange=function(Oc){qc.NNb(Oc);1===Oc?qc.formulaAssistanceTelemetryManager.T9.argumentAssistanceCollapseCounter++:qc.formulaAssistanceTelemetryManager.T9.argumentAssistanceExpandCounter++};
qc.VQa=function(Oc){var jb={};jb[yb.a.SU]="ArgumentAssistanceCard";var Eb={};Eb.FunctionName=Oc.functionName;jb[yb.a.f$c]=Eb;qc.$.Fd(802602464,0,8,jb)};qc.onDismissClick=function(){qc.formulaAssistanceTelemetryManager.T9.argumentAssistanceDismissCounter++;qc.GRa=!1;qc.$rb();qc.RQ&&qc.QG.clear();0===qc.y2&&qc.NNb(1)};qc.Df=function(){qc.GRa=!0;qc.RQ&&qc.QG.clear()};qc.CKi=function(Oc){Oc.button===Sys.UI.MouseButton.leftButton&&Oc.target&&(Aa.g(Oc),qc.v1a&&qc.v1a.iSa(Oc))};qc.$s=function(){void 0!==
qc.Jq&&null!==qc.Jq&&qc.Jq()};qc.Dk=wc.a.J4();qc.I4=qc.Dk&&ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);qc.Dk?(qc.cOd(),qc.fr=new X(qc.$,qc.formulaAssistanceUIControl,0,fe.a.Wad),qc.I4&&bb.g(qc.$).$b.vm(qc.Df),qc.RQ=ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",!1)&&ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",!1)&&!!qc.formulaAssistanceUIControl,qc.RQ&&(qc.QG=new F(qc.formulaAssistanceUIControl,
qc.formulaAssistanceTelemetryManager)),ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&qc.$.domElement.appendChild(qc.domElement)):(qc.v1a=new H(qc.domElement,qc.$.mE,void 0,wc.a.TM(qc.$)),qc.yc.ka("mousedown",qc.CKi),Bb=$get(va.tbd,qc.Bj),qc.Bj.insertBefore(qc.domElement,Bb));bb.g(qc.$).view.Gs(qc.$s);return qc}function F(Bb,zc){this.mJa=Bb;this.formulaAssistanceTelemetryManager=zc;this.an=!1;Bb={};this.usageCount=(Bb[Ec.Drag]=0,Bb[Ec.Move]=0,Bb);this.TCc=
this.mJa.getWindowEdgeBuffer()+1;this.Wpf=new J(this);this.JIe=new K(this)}function K(Bb){this.QG=Bb;this.an=!1}function J(Bb){var zc=this;this.QG=Bb;this.HZ=this.kQd=this.an=!1;this.onKeyDown=function(Mb){return!zc.HZ&&Mb.keyCode===Wb.a.Eoa&&Mb.altKey&&Mb.ctrlKey?(zc.O7b(),Mb.stopPropagation(),Mb.preventDefault(),!0):!1};this.KMa=function(Mb){if(!zc.HZ)return!1;if(Mb.eventName===ue.a.Lb){var cc=Mb.Ca.ctrlKey?1:Mb.Ca.shiftKey?50:10;switch(Mb.Ca.keyCode){case Wb.a.GTa:zc.L5(0,-cc);break;case Wb.a.Coa:zc.L5(0,
cc);break;case Wb.a.Doa:zc.L5(-cc,0);break;case Wb.a.hfb:zc.L5(cc,0);break;case Wb.a.lL:case Wb.a.Rh:zc.kQd=!0;break;default:return!1}}Mb.eventName===ue.a.Gd&&zc.kQd&&zc.R3(!0);Mb.Ca.preventDefault();return!0};this.RFb=function(Mb){if(!zc.HZ)return!1;Mb.Ca.preventDefault();zc.R3();return!0};this.onBlur=function(){if(!zc.HZ)return!1;zc.R3();return!0};this.kr=fc.KeyInputManager.instance;this.pointerInputManager=Vc.a.instance}function O(){this.callbacks=this.functionRenderingInfo=null;this.cardMode=
0}function N(){this.onDismissClick=this.onFeedback=this.onHelpLink=this.onCardModeChange=null}function H(Bb,zc,Mb,cc){cc=void 0===cc?!1:cc;zc=Q.call(this,Bb,zc,!1,void 0===Mb?null:Mb)||this;zc.rRa(cc);zc.Yi=Kc.a.equals("rtl",Bb.dir,!0);return zc}function Q(Bb,zc,Mb,cc){var Uc=tb.call(this,Bb,void 0===cc?null:cc)||this;Uc.z3=null;Uc.GTd=!1;Uc.nMb=!1;Uc.t1a=null;Uc.x7=null;Uc.offsetParent=null;Uc.uFi=null;Uc.cJc=!1;Uc.Erg=null;Uc.gzd=function(Rb){return Uc.b6(Rb)};Uc.fzd=function(Rb){return Uc.pN(Rb)};
Uc.Ivf=function(Rb){var qc=dc.HelperMethods.En(Rb);qc.button===Sys.UI.MouseButton.leftButton&&2===Rb.mb&&(Uc.nnd(qc.target)||Uc.iSa(qc));return!1};Uc.C4d=zc;Mb&&(Uc.GTd=!0,Vc.a.instance.qa(ue.a.pointerDown,Uc.NIe,Uc.Ivf));Uc.dfa=!1;return Uc}function ca(Bb,zc){var Mb=id.call(this)||this;Mb.Fog=[];Mb.xbd={};Mb.ybd={};Mb.WS=null;Mb.H8=[];Mb.uJa={};Mb.bxf=function(cc,Uc){Ma.ULS.sendTraceTag(537161987,0,50,"FunctionInfoManager.OnGetFunctionListPartialSucceeded");Mb.Owf(cc,!!Uc&&1!==Uc.FilterType,!0)};
Mb.axf=function(){Ma.ULS.sendTraceTag(537161986,0,50,"FunctionInfoManager.OnGetFunctionListPartialFailed -  reset varaible to ensure we will re-issue the webservice call");Mb.WS=null};Mb.Lwf=function(cc){Ma.ULS.sendTraceTag(537161985,0,50,"FunctionInfoManager.OnFullFunctionListLoaded - full list was loaded");Mb.OGd(cc.dja,!0,!1)};Mb.$wf=function(cc){Ma.ULS.sendTraceTag(537161984,0,50,"FunctionInfoManager.OnGetFunctionListFullSucceeded");Mb.Owf(cc,!0,!1)};Mb.EKc=!1;Mb.CKc=!1;Mb.jb=Bb;Mb.pluginScheduler=
zc;Mb.$.da.Ga(19,Mb);return Mb}function X(Bb,zc,Mb,cc,Uc){this.jka=this.kZc=!1;this.$=Bb;this.formulaAssistanceUIControl=zc;this.hUe=Mb;this.slj=cc;this.F4e=void 0===Uc?null:Uc;this.jka=ma.EwaSettings.isChangeGateEnabled("OfficeVSO:6592066_FixAutoCompleteCardFocusBug")}function Z(Bb,zc,Mb){var cc=Re.call(this)||this;cc.ubd=Bb;cc.DMd=zc;cc.lWi=Mb;return cc}function ea(Bb){var zc=Pd.call(this)||this;zc.DMd=Bb;return zc}function ka(Bb,zc){var Mb=Le.call(this)||this;Mb.functionName=Bb;Mb.ubd=zc;return Mb}
function Y(Bb){this.iGe={};this.$=Bb}function qa(){this.sheetName=this.namedRange=this.tooltip=this.name=null;this.type=0}function fa(Bb){this.$S=0;this.b8d=!1;this.CVa=this.z9d=null;this.jrg=void 0===Bb?!1:Bb;this.textEdit=null}function ha(Bb){var zc=this;this.nrb=this.sha=this.calcManager=this.Ya=null;this.m9a=function(){zc.S4a(!1,!1)};this.$=Bb;this.Ytb=new wa(Bb);this.f$b=new S(Bb);this.g$b=new ia(this);bb.g(Bb).Wb.vm(this.m9a);this.$.da.Ga(317,this)}function ia(Bb){this.H7=0;this.Xad=Bb}function wa(Bb){this.nqa=
this.vSa=this.U1a=this.QP=this.C$=this.Ya=null;this.fid=!1;this.Ec=Bb}function Qa(){}function S(Bb){var zc=this;this.bzi=30;this.calcManager=null;this.Ad=!1;this.HOa=this.HFb=this.u$a=null;this.iy=function(){zc.uha.MZ()};this.$=Bb;this.uha=new xa;this.$Rf=-1;this.$.ea.YD(this.iy)}function da(Bb,zc,Mb,cc,Uc,Rb,qc){qc=Bb.Na(1,void 0===qc?null:qc);qc.getPartialCalcResultsParameters=zc;return Gc.g(Bb,"GetPartialCalcResults",qc,Mb,cc,Uc,Rb,4)}function xa(){this.oQa={}}function ta(Bb){var zc=ub.call(this)||
this;zc.$=Bb;zc.Eb();return zc}function ab(Bb,zc){var Mb=this;this.tJa=this.yua=this.Xia=null;this.vAf=function(cc,Uc){Mb.A5i(Uc.functionName,Uc.ubd)};this.xAf=function(cc,Uc){Mb.z5i(Uc.ubd,Uc.DMd,Uc.lWi)};this.wAf=function(cc,Uc){cc=[];Uc=ak(Uc.DMd);for(var Rb=Uc.next();!Rb.done;Rb=Uc.next())Rb=Rb.value,(!Mb.iwa||void 0!==Rb&&null!==Rb)&&(Rb=Rb.trim())&&cc.push(Rb);if(!Mb.iwa||cc.length){Uc="";for(Rb=0;Rb<cc.length;Rb++){var qc=Mb.tYc(cc[Rb]),Oc=ab.nDd(Rb,cc.length);Uc+=qc+Oc;Oc&&(Uc+=Mb.ariaLiveNotifier.wxa)}Mb.ariaLiveNotifier.readText(Uc)}};
this.yAf=function(cc,Uc){Mb.ariaLiveNotifier.C5i(Uc.OF,Uc.description,Uc.selectedIndex.toString(),Uc.length.toString())};this.rAf=function(cc,Uc){Mb.ariaLiveNotifier.tLf(Uc.description,Uc.length)};this.Gwf=function(){Mb.ariaLiveNotifier.rab(gb.a.instance.ga(881),yb.a.eZa)};this.zwf=function(){Mb.ariaLiveNotifier.readText(gb.a.instance.ga(882))};this.Cwf=function(){Mb.ariaLiveNotifier.readText(gb.a.instance.ga(883))};this.$=zc;this.ariaLiveNotifier=Bb;this.$.da.Ga(219,this);this.iwa=wc.a.J4()}function Na(Bb){return Mc.call(this,
Bb)||this}function Ka(Bb,zc,Mb){var cc=this;this.$=Bb;this.Va=zc;this.functionInfoManager=Mb;this.iEh="FinancialFns LogicalFns TextFns DateTimeFns LookupReferenceFns MathTrigFns StatisticalFns EngineeringFns CubeFns InformationFns".split(" ");this.menuId=null;this.onFunctionInfoLoaded=function(){cc.menuId&&Array.contains(cc.iEh,cc.menuId)&&cc.frame.Qw(cc.menuId)};this.WZ=wc.a.WZ(this.$);this.ywa=wc.a.ywa(this.$);this.bli=wc.a.Aod();this.WZ&&(this.formulaAssistanceManager=this.$.da.za(464));this.yY=
{};this.frame=this.$.frame;this.functionInfoManager.qYa(this.onFunctionInfoLoaded);this.formulaAssistanceTelemetryManager=Bb.da.za(491)}function la(Bb){return Bb.Params.split("!")[0].split(",").map(function(zc){return{name:zc,description:"Mock description for param "+zc+". How Mmuch wood would a wood chuck chuck if a wood chuck would chuck wood",type:"text"}})}function Ea(Bb,zc){var Mb=rc.call(this,Bb)||this;Mb.p$b=zc;Mb.cEh=function(cc,Uc){var Rb;1===cc&&(Mb.hide(),cc={},Uc=(cc[Ub.a.Nc]=Mb.p$b.NameUI,
cc.functionArgs=null!==(Rb=Uc.functionArgs)&&void 0!==Rb?Rb:[],cc.ibdk=!0,cc),Rb=new qb.a(-433697611,0,Mb.$.Jc,8,null),Mb.$.Ka.Kb(Rb,Uc))};Mb.dIh=function(cc){return{name:"argument_"+cc,description:"mock argument description. she sells sea shells at the sea shore shop",type:"number"}};Mb.Al=gb.a.instance.ga(1027);Mb.sg();return Mb}function ra(Bb,zc){var Mb=ec.call(this,Bb,gb.a.instance.ga(1026),void 0,void 0,void 0,ma.EwaSettings.ma(397))||this;Mb.sJa=null;Mb.cja=null;Mb.rJa=null;Mb.iub=null;Mb.EUe=
null;Mb.bja=null;Mb.FUe=null;Mb.IUe=null;Mb.Gkf=null;Mb.gub=null;Mb.Bid=!1;Mb.z1b=null;Mb.O5=null;Mb.Swb=null;Mb.onFunctionInfoLoaded=function(){if(!Mb.rJa.count){for(var cc=Mb.functionInfoManager.obd,Uc=0,Rb=cc.length;Uc<Rb;++Uc)Mb.rJa.QL(cc[Uc],cc[Uc],!1).className=Da.a.Qnh;Mb.rJa.selectedIndex=0;$a.a.oc([Mb.z1b,Mb.O5,Mb.Swb]);Mb.z1b=Mb.ke.Td(Mb.sJa);Mb.O5=Mb.ke.Td(Mb.cja);Mb.Swb=Mb.ke.Td(Mb.gub);Mb.z1b.ka("change",Mb.Mwf);Mb.O5.ka("change",Mb.DKi);Mb.O5.ka("dblclick",Mb.EKi);Mb.Swb.ka("click",
Mb.qca);Mb.Swb.ka("keyup",Mb.JMi);Pb.DOMElementExtensions.setVisible(Mb.cja,!0);Pb.DOMElementExtensions.setVisible(Mb.EUe,!1);Mb.$.E4c&&Pb.DOMElementExtensions.setVisible(Mb.Gkf,!0)}Mb.Mwf(null);Mb.getButton(0).get_element().disabled=!1;Mb.sJa.disabled=!1;Mb.jRa();Mb.Bid=!0};Mb.qca=function(){Mb.L$&&ya(Mb.$,Mb.L$.HelpId,Mb.L$.IsDynamicUdf)};Mb.JMi=function(cc){13!==cc.keyCode&&32!==cc.keyCode||Mb.qca(cc)};Mb.Mwf=function(){var cc=Mb.functionInfoManager.Rac(Mb.rJa.he.value);Mb.Cua(cc);Mb.cja.scrollTop=
0;Mb.iYf()};Mb.DKi=function(){Mb.iYf()};Mb.EKi=function(cc){Mb.L$&&(Aa.g(cc),Mb.close(0))};Mb.Uc=function(cc,Uc){Ab.b(Uc)&&Mb.Mt()};Mb.functionInfoManager=Bb.da.za(19);Mb.formulaAssistanceControl=Bb.da.za(221);Mb.Yad=wc.a.WZ(Mb.$);Mb.Yad&&(Mb.formulaAssistanceManager=Bb.da.za(464));Mb.CE=zc;Mb.QZc=zc.textBox.caretPosition;return Mb}function na(Bb){var zc=zb.call(this,Bb)||this;zc.BUe=function(Mb,cc){1===Mb&&(zc.hide(),Mb={},cc=(Mb[Ub.a.Nc]=cc.functionName,Mb.ibdk=!0,Mb),Mb=wc.a.ywa(zc.$)?1117706454:
-433697611,Mb=new qb.a(Mb,0,zc.$.Jc,8,null),zc.$.Ka.Kb(Mb,cc))};zc.onFunctionInfoLoaded=function(){zc.functionInfoManager.Xab(zc.onFunctionInfoLoaded);zc.z9e()};zc.D5h=function(Mb){sa(zc.$,Mb,!1)};zc.uef=function(Mb){return!zc.functionInfoManager.jgc(Mb)};zc.Al=gb.a.instance.ga(1026);zc.functionInfoManager=Bb.da.za(19);zc.sg();return zc}function ba(Bb){var zc=Va.a.A_,Mb=Bb.da.za(368);Mb&&!bb.g(Bb).sj&&(zc=Mb.zoom);return zc}function sa(Bb,zc,Mb){if(Mb){if(zc&&(!zc||zc.startsWith("http://")||zc.startsWith("https://"))){if(Bb.ma(157)&&
(Bb=Bb.da.za(269))&&Bb.rBa(zc))return;dc.HelperMethods.Ze(zc,"_blank",db.a)}}else dc.HelperMethods.YV(Bb.eG,"XLWAEndUser_"+zc,Bb.sS)}function ya(Bb,zc,Mb){if(Bb){var cc=Bb.da.za(491);cc?cc.T9.argumentAssistanceLearnMoreCounter++:Ma.ULS.sendTraceTag(523551513,0,50,"FormulaAssistanceExtensions: logHelpLinkClick getService returned a null formulaAssistanceManager");Mb?sa(Bb,zc,Mb):(Mb=new qb.a(-859308420,Ub.a.Cb,Bb.Jc,0,null),cc={},zc=(cc[Ub.a.Nc]=yb.a.JQ,cc[Ub.a.Vf]="HelpID="+zc,cc),Bb.Ka.Kb(Mb,zc))}}
function va(){}var W=b(11),La=b(0),Ia=b(905),mb=b(51),fb=b(37),Ma=b(15),Hb=b(18),Kb=b(408),Ub=b(76);va.y9c="!";va.rEf="[";va.qEf="]";va.openParen="(";va.closeParen=")";va.igg=" /.(*\\".split("");va.q7b="...";va.sFb="param_help_link";va.hCd="param_help_udf";va.tbd="function_list_box";va.nEh="function_param_box";va.vbd="function_reader_description";va.pbd="function_description_box";va.GUe="function_param_table";va.kWi="param_row_";va.iCd="param_set";va.ZEf="param_row_0";va.$Ef="param_row_1";va.oEh=
"<div id='{0}' class='{1}'></div>";va.mEh="<div id='{0}' class='{1} {2} {3}'>\r\n\t<table id='{4}'>\r\n\t\t{5}\r\n\t\t{6}\r\n\t</table>\r\n</div> ";va.aFf="<tr>\r\n\t<td id='{0}'>\r\n\t\t<span id='{0}_{1}' class='{2}'></span>\r\n\t\t<a href = '#' id='{0}_{3}' class='{4}'></a>\r\n\t\t<span id ='{0}_{5}'></span>\r\n\t</td>\r\n</tr>";va.jEh="<div id='{0}' class='{1} {2} {3}'></div>";va.gEh="<div id='{0}' class='{1} {2} {3} {4}'></div>";va.Bjf="[@";va.G3g=1;va.F3g=3;va.Lch=500;va.Xof=50;Object(La.a)(va,
"FormulaAssistanceConstants",null,[]);var gb=b(14),Db=b(390),Va=b(8),yb=b(5),qb=b(92),dc=b(10),bb=b(21),db=b(371),wc=b(36),nb;(function(Bb){Bb.CategoryList="categoryList";Bb.FunctionsMap="functionsMap";Bb.FunctionIdsToDisplay="functionIdsToDisplay";Bb.RefreshListCallback="refreshListCallback";Bb.HelpCallback="helpCallback";Bb.InitialCategory="initialCategory";Bb.AllCategoryName="allFunctionsCategoryName"})(nb||(nb={}));Object(La.b)("PropsKeys",nb);var zb=Db.a;Rk(na,zb);na.prototype.sg=function(){this.functionInfoManager.L1a({Filter:null,
FilterType:2,IncludeOneOfEachGroupUI:!0},!0);this.Rb=1;this.functionInfoManager.XZ?this.z9e():this.functionInfoManager.qYa(this.onFunctionInfoLoaded)};na.prototype.z9e=function(){var Bb;this.ZZb=this.functionInfoManager.q$b.filter(this.uef);var zc=null!==(Bb=na.tif)&&void 0!==Bb?Bb:na.X_g;Bb=this.functionInfoManager.obd;var Mb=this.functionInfoManager.Rac(zc).map(function(Uc){return Uc.FunctionIndex}),cc={};this.Dx=(cc[na.Yv]=this.nc,cc[nb.CategoryList]=Bb,cc[nb.FunctionsMap]=this.w6g(),cc[nb.FunctionIdsToDisplay]=
Mb,cc[nb.RefreshListCallback]=this.eNi.bind(this),cc[nb.HelpCallback]=this.D5h,cc[nb.InitialCategory]=zc,cc[nb.AllCategoryName]=na.AllCategoryName,cc);this.initializeAndShow(this.Al,this.BUe,this.Dx)};na.prototype.w6g=function(){var Bb={};this.ZZb.forEach(function(zc){Bb[zc.FunctionIndex]=zc});return Bb};na.prototype.YQj=function(Bb){Bb=Bb.map(function(zc){return zc.FunctionIndex});this.Dx[nb.FunctionIdsToDisplay]=Bb;this.nTa(this.Al,this.$3a(this.BUe),this.Dx)};na.prototype.eNi=function(Bb,zc){zc?
zc=this.Izh(zc):(zc=this.functionInfoManager.Rac(Bb).filter(this.uef),na.tif=Bb);this.YQj(zc)};na.prototype.Izh=function(Bb){Bb=void 0===Bb?"":Bb;Bb=Bb.toLocaleLowerCase();var zc=this.ZZb.filter(function(Mb){return Mb.NameUI.toLocaleLowerCase().startsWith(Bb)});3<=Bb.length&&(zc.push.apply(zc,yk(this.ZZb.filter(function(Mb){return Mb.NameUI.toLocaleLowerCase().includes(Bb)&&!zc.includes(Mb)}))),zc.push.apply(zc,yk(this.ZZb.filter(function(Mb){return Mb.Help.toLocaleLowerCase().includes(Bb)&&!zc.includes(Mb)}))));
return zc};Af.Object.defineProperties(na.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"FunctionDialog"}}});na.AllCategoryName=gb.a.instance.ga(1025);na.X_g=gb.a.instance.ga(1024);na.tif=void 0;Object(La.a)(na,"FunctionDialog",Db.a,[]);var ma=b(1),P=b(95),oa=b(58),Ja=b(63),$a=b(90),Ta=b(25),pa=b(218),Da=b(71),rb=b(118),Ab=b(235),ob=b(53),sb=b(937),Pb=b(12),Aa=b(69),Ya=Da.a.Pnh,kb=Da.a.uMe,lb=Da.a.vMe,ac=Da.a.v8c,Dc=Da.a.Rnh,Zb=Da.a.Vnh,mc=Da.a.qMe,Lb=Da.a.yMe,Sa=Da.a.Tnh,Cb=Da.a.rMe,
ec=pa.a;Rk(ra,ec);ra.prototype.initialize=function(){this.Gb.classList.add(Da.a.Nnh);this.Gb.innerHTML=ra.KG();this.Be||(this.El(),this.o2());ec.prototype.initialize.call(this);var Bb=Pb.DOMElementExtensions.Cj(this.Gb,Cb);this.rtl&&(Bb.align="right",this.gub.style.marginLeft="5px");this.Be&&(Bb.style.padding="1px");this.functionInfoManager.L1a({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0)};ra.prototype.dispose=function(){this.functionInfoManager&&(this.functionInfoManager.Xab(this.onFunctionInfoLoaded),
this.functionInfoManager.$.ea.xk(this.Uc));$a.a.oc([this.z1b,this.O5,this.Swb,this.rJa,this.iub]);ec.prototype.dispose.call(this)};ra.prototype.El=function(){this.sJa=Pb.DOMElementExtensions.Cj(this.Gb,Ya);this.cja=Pb.DOMElementExtensions.Cj(this.Gb,kb);this.sJa.setAttribute(yb.a.Hd,yb.a.D_b);this.rJa=new sb.a(this.sJa,!0);this.iub=new sb.a(this.cja,!0);this.EUe=Pb.DOMElementExtensions.Cj(this.Gb,Zb);this.gub=Pb.DOMElementExtensions.Cj(this.Gb,Dc);this.IUe=Pb.DOMElementExtensions.Cj(this.Gb,Lb);this.Gkf=
Pb.DOMElementExtensions.Cj(this.Gb,Sa);this.FUe=$get(ra.qbd,this.Gb);this.bja=Pb.DOMElementExtensions.Cj(this.Gb,mc);this.Be&&(this.bja.style.paddingLeft="1px");this.functionInfoManager.qYa(this.onFunctionInfoLoaded);this.functionInfoManager.$.ea.Wj(this.Uc)};ra.prototype.KQ=function(Bb){var zc=this;this.$.da.Za(40,function(){zc.rJa.KQ(Bb)})};ra.prototype.pn=function(){this.Yad?this.formulaAssistanceManager.s6b():this.formulaAssistanceControl.set_visible(!1);ec.prototype.pn.call(this);this.Bid||(this.getButton(0).get_element().disabled=
!0)};ra.prototype.setFocus=function(){!this.sJa.disabled&&this.Bid&&Pb.DOMElementExtensions.setFocus(this.sJa)};ra.prototype.commit=function(){return!0};ra.prototype.kqb=function(){var Bb=this,zc=this.L$.NameDataStrings;if(ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements")){var Mb=new qb.a(-433697611,0,this.$.Jc,8,null),cc={};cc=(cc[Ub.a.Nc]=zc,cc);this.$.Ka.Kb(Mb,cc)}else{zc+=va.openParen;Mb=bb.g(this.$);Mb.view.visibleArea.contains(Mb.gg(null))||Mb.hr(Mb.ha.sa.activeCell,
3,P.a.hEh);var Uc=this.CE.textBox;if(this.CE.isEditing&&this.CE.text){cc=this.CE.text;var Rb=this.QZc?cc.substring(0,this.QZc):"=";this.CE.text=Rb+zc+cc.substring(this.QZc+(Uc.jv?Uc.jv.length:0),cc.length);Uc.caretPosition=Rb.length+zc.length}else fb.TaskExtensions.Ba(Mb.startEdit(!0,1),function(){Bb.CE.text="="+zc;var qc=zc.length+1;Uc.cRa(qc);Uc.caretPosition=qc},this.la,11,Ja.a.current);Mb.sj&&(Mb=Mb.Wb,Mb.text=Uc.text,Mb.setCaretPosition(Uc.caretPosition));(Mb=this.CE.rY.get(Kb.a.S2a))&&Mb.dU(!1)}};
ra.prototype.psa=function(){this.Yad?this.formulaAssistanceManager.nda():this.formulaAssistanceControl.Ynb()};ra.prototype.Cua=function(Bb){this.iub.clear();for(var zc=ra.qbd+" "+ra.zUe,Mb=0,cc=Bb.length;Mb<cc;++Mb){var Uc=this.iub.QL(Bb[Mb].NameUI,Bb[Mb].FunctionIndex.toString(),!1);Ta.a.Vu&&Uc.classList.add(ac);Uc.setAttribute(yb.a.bE,ra.AUe);Uc.setAttribute(yb.a.AG,zc)}this.iub.selectedIndex=0};ra.prototype.iYf=function(){if(this.L$){this.gub.parentNode.className=Da.a.rMe+(this.functionInfoManager.jgc(this.L$)?
"-udf":"");var Bb=this.L$.NameDataStrings;this.IUe.innerText=Bb;this.gub.innerText=Bb;this.bja.innerText=this.L$.Help;Bb=this.L$.Params.split(va.y9c);this.FUe.innerText=va.openParen+(1<Bb.length?va.q7b:Bb[0])+va.closeParen}};ra.KG=function(){return String.format("<div class='"+Da.a.Onh+"'>\r\n\t<label for='{6}'>{0}</label>\r\n\t<select id='{6}' class='{9}' disabled='true'></select>\r\n</div>\r\n<div class='"+rb.a.Cn+"'>{1}</div>\r\n<div class='"+Da.a.pMe+"'>\r\n\t<select id='{16}' class='{17} "+Hb.a.Lp+
" "+Hb.a.No+"' size='{8}'></select>\r\n\t<div class='{11}' >{2}</div>\r\n</div>\r\n<div class='"+Da.a.Snh+"'>\r\n\t<div style='direction:ltr' class='{15}'>\r\n\t\t<span class='{14} "+Hb.a.Lp+"'>\r\n\t\t\t<span class='"+Hb.a.RA+" "+Da.a.Unh+"'>\r\n\t\t\t\t<img title='{3}' class='"+Hb.a.tth+"' src='{4}'/>\r\n\t\t\t</span>\r\n\t\t</span>\r\n\t\t<span id='{19}' class='{13}'></span>\r\n\t\t<a tabindex='0' title='{5}' class='{10}'></a>\r\n\t\t<span id='{7}'></span>\r\n\t</div>\r\n\t<div id='{18}' class='{12}'></div>\r\n</div>",
gb.a.instance.ga(1029),gb.a.instance.ga(1030),gb.a.instance.ga(739),gb.a.instance.lb(3),ob.a.Te(13),gb.a.instance.ga(1031),ra.fEh,ra.qbd,7,Ya,Dc,Zb,mc,Lb,Sa,Cb,ra.kEh,kb+(Ta.a.Vu?" "+lb:""),ra.zUe,ra.AUe)};Af.Object.defineProperties(ra.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"FunctionDeprecatedDialog"}},L$:{configurable:!0,enumerable:!0,get:function(){if(!this.cja||!this.cja.firstChild)return null;var Bb=Number.parseInvariant(this.cja.children[this.cja.selectedIndex].value);
return this.functionInfoManager.aPh(Bb)}}});ra.qbd="function_dialog_param_string";ra.zUe="function_dialog_function_description";ra.AUe="function_dialog_function_name";ra.kEh="function_list";ra.fEh="function_category";Object(La.a)(ra,"FunctionDeprecatedDialog",pa.a,[]);var wb=b(325),rc=Db.a;Rk(Ea,rc);Ea.prototype.sg=function(){this.Rb=1;var Bb={};this.Dx=(Bb[wb.a.Yv]=this.nc,Bb.functionInfo=this.p$b,Bb.initialArgs=this.eIh(this.p$b),Bb.evaluateCallback=this.dTg,Bb.generateArgByIndex=this.dIh,Bb.helpCallback=
this.YV,Bb.isModal=!1,Bb);this.initializeAndShow(this.Al,this.cEh,this.Dx)};Ea.prototype.YV=function(){sa(this.$,this.p$b.HelpId,!1)};Ea.prototype.dTg=function(){return"42"};Ea.prototype.eIh=function(Bb){return la(Bb)};Af.Object.defineProperties(Ea.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"FunctionArgumentsDialog"}}});Object(La.a)(Ea,"FunctionArgumentsDialog",Db.a,[]);Ka.prototype.Lc=function(Bb,zc){if(!ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements"))return!1;
switch(zc){case 753860909:case -2060563418:case 1117706454:case 917756490:case -1756230110:case -1702465186:case -977299160:case 2135922458:case -1960662393:case -1999560076:case 493672674:case -1031255406:case 548833656:case 641360851:case -433697611:return Bb=bb.g(this.$).Ki,Bb.j5a||!Bb.isEditing||0>=Bb.text.length?!1:!0;default:return!1}};Ka.prototype.executeCommand=function(Bb,zc,Mb){var cc=this,Uc,Rb;Bb=zc.command;var qc=bb.g(this.$),Oc=qc.Ki;switch(Bb){case 753860909:case -2060563418:null===
(Uc=this.formulaAssistanceManager)||void 0===Uc?void 0:Uc.s6b();qc.inRangePicker&&Oc.gE(!1);this.bli?new na(this.$):(new ra(this.$,Oc)).hf();this.formulaAssistanceTelemetryManager.R2a.dialogShownCounter++;break;case 1117706454:null===(Rb=this.formulaAssistanceManager)||void 0===Rb?void 0:Rb.s6b();qc.inRangePicker&&Oc.gE(!1);Uc=this.functionInfoManager.bPh(Mb[Ub.a.Nc]);new Ea(this.$,Uc);Mb.ibdk?this.formulaAssistanceTelemetryManager.R2a.argsDialogOpenedByDialogCounter++:this.formulaAssistanceTelemetryManager.R2a.argsDialogOpenedByRibbonCounter++;
break;case -433697611:Mb.ibdk&&(this.ywa?this.formulaAssistanceTelemetryManager.R2a.argsDialogCommitedCounter++:this.formulaAssistanceTelemetryManager.R2a.dialogCommitedCounter++);var jb=Mb[Ub.a.Nc]+va.openParen;this.ywa&&(jb+=Mb.functionArgs.join(this.$.listSeparator)+va.closeParen);Mb.UILocation&&this.$.Fd(-1075437823,-1,0,null);qc.view.visibleArea.contains(qc.gg(null))||qc.hr(qc.ha.sa.activeCell,3,P.a.gDh);var Eb=Oc.textBox;Mb=Oc.textBox.caretPosition;Oc.isEditing&&Oc.text?(Uc=Oc.text,Rb=Mb?Uc.substring(0,
Mb):"=",Oc.text=Rb+jb+Uc.substring(Mb+(Eb.jv?Eb.jv.length:0),Uc.length),Eb.caretPosition=Rb.length+jb.length):fb.TaskExtensions.Ba(qc.startEdit(!0,1),function(){Oc.text="="+jb;if(cc.ywa)qc.endEdit(!0,"FormulaAssistanceCommandHandler.ExecuteCommand");else{var nc=jb.length+1;Eb.cRa(nc);Eb.caretPosition=nc}},this.$.la,11,Ja.a.current);qc.sj&&(Mb=qc.Wb,Mb.text=Eb.text,Mb.setCaretPosition(Eb.caretPosition));this.WZ?this.formulaAssistanceManager.nda():(Mb=Oc.rY.get(Kb.a.S2a),null===Mb||void 0===Mb?void 0:
Mb.dU(!1))}return oa.Task.Ua(!0)};Ka.prototype.Ac=function(Bb,zc){switch(zc.command){case 753860909:case -2060563418:case -433697611:return!0;case 1117706454:return this.ywa;default:return!1}};Ka.prototype.fFh=function(Bb,zc){zc=this.Va.mq(zc);var Mb=this.Va.Bc(),cc=this.functionInfoManager.Rac(Bb);if(!cc)return Ma.ULS.sendTraceTag(537162067,0,15,"FormulaAssistanceCommandHandler.GenerateFunctionMenu: functionList is null"),zc.eE();for(var Uc=this.ywa?1117706454:-433697611,Rb=0;Rb<cc.length;++Rb){var qc=
cc[Rb].NameUI,Oc=this.Va.RP(280,"Formulas."+Bb+"MenuItem_"+cc[Rb].FunctionIndex.toString(),Uc,null,1,"None",0,0,qc,!1,0);Oc.label=qc;var jb=cc[Rb].Params.split(va.y9c);Oc.$R(qc+" "+(va.openParen+(1<jb.length?va.q7b:jb[0])+va.closeParen)+"\n"+cc[Rb].Help);Mb.buttons.push(Oc)}Bb=this.Va.Bc();cc=this.Va.RP(280,"Formulas.MoreFunctionsMenuItem",-2060563418,Hb.a.EPe,3,"Image16by16",1028,0,"Formulas.MoreFunctionsMenuItem",!1,0);Bb.buttons.push(cc);zc.pc.push(Mb);zc.pc.push(Bb);return zc.eE()};Ka.prototype.Qc=
function(Bb,zc,Mb){Bb=this.$Oh(zc);if(-1===Bb)return!1;this.menuId=Mb.MenuId;if(!this.functionInfoManager.XZ)return this.functionInfoManager.L1a({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0),!1;Bb=this.functionInfoManager.obd[Bb];this.yY[Bb]=this.yY[Bb]||this.fFh(Bb,Mb.MenuId);Mb.MenuItems=this.yY[Bb];return!0};Ka.prototype.$Oh=function(Bb){switch(Bb){case "PopulateFinancialFnsMenu":return 2;case "PopulateLogicalFnsMenu":return 9;case "PopulateTextFnsMenu":return 8;case "PopulateDateTimeFnsMenu":return 3;
case "PopulateLookupReferenceFnsMenu":return 6;case "PopulateMathTrigFnsMenu":return 4;case "PopulateStatisticalFnsMenu":return 5;case "PopulateEngineeringFnsMenu":return 11;case "PopulateCubeFnsMenu":return 12;case "PopulateInformationFnsMenu":return 10;default:return-1}};Object(La.a)(Ka,"FormulaAssistanceCommandHandler",null,[403]);var Mc=Ia.a;Rk(Na,Mc);Na.prototype.zd=function(){var Bb=this,zc=mb.GetServiceTaskFactory.create(this.$.da,102,this.la,this.hb),Mb=mb.GetServiceTaskFactory.create(this.$.da,
153,this.la,this.hb);fb.TaskExtensions.Ba(fb.TaskExtensions.Wd([zc,Mb],this.la),function(){Bb.jd([new Ka(Bb.$,zc.result,Mb.result)])},this.la,3)};Na.ka=function(Bb){Ia.a.Qd(92,new Na(Bb))};Object(La.a)(Na,"FormulaAssistanceCommandHandlerFactory",Ia.a,[]);var Pc=b(232),Kc=b(22);ab.prototype.dispose=function(){this.eXd();this.tJa=this.yua=this.Xia=null};ab.prototype.RWc=function(Bb){Bb&&(this.Xia=Bb,this.Xia.Fme(this.vAf),this.Xia.wne(this.xAf),this.iwa&&this.Xia.vne(this.wAf))};ab.prototype.SWc=function(Bb){Bb&&
(this.yua=Bb,this.iwa&&(this.yua.Dme(this.Gwf),this.yua.Bme(this.zwf)),this.yua.Cme(this.Cwf))};ab.prototype.TWc=function(Bb){Bb&&(this.tJa=Bb,this.tJa.WUc(this.yAf),this.tJa.iZb(this.rAf))};ab.prototype.eXd=function(){var Bb,zc,Mb;this.Xia&&(this.Xia.FPf(this.vAf),this.Xia.bQf(this.xAf),this.iwa&&this.Xia.aQf(this.wAf));this.tJa&&(this.tJa.QId(this.yAf),this.tJa.zsc(this.rAf));this.iwa&&(null===(Bb=this.yua)||void 0===Bb?void 0:Bb.EPf(this.Gwf),null===(zc=this.yua)||void 0===zc?void 0:zc.CPf(this.zwf));
null===(Mb=this.yua)||void 0===Mb?void 0:Mb.DPf(this.Cwf)};ab.prototype.A5i=function(Bb,zc){if(zc){var Mb="";this.iwa||(Mb+=gb.a.instance.lb(57)+this.ariaLiveNotifier.wxa);for(var cc=0;cc<zc.length;cc++)Mb+=Bb+this.ariaLiveNotifier.wxa+this.tYc(zc[cc])+ab.nDd(cc,zc.length);this.iwa&&(Mb+=gb.a.instance.ga(880)+this.ariaLiveNotifier.wxa);this.ariaLiveNotifier.readText(Mb)}};ab.prototype.z5i=function(Bb,zc,Mb){if(Bb){var cc="",Uc=0;if(zc){for(var Rb=0;Rb<zc.length;Rb++)if(Mb>=Bb[Rb].split(this.$.listSeparator).length)Uc++;
else{var qc=zc[Rb].trim();if(!qc)return;qc=this.tYc(qc);var Oc=ab.nDd(Rb-Uc,zc.length-Uc);cc+=qc+Oc;Oc&&(cc+=this.ariaLiveNotifier.wxa)}this.ariaLiveNotifier.readText(cc)}}};ab.prototype.tYc=function(Bb){if(!Bb)return"";var zc=Bb.split(this.$.listSeparator);Bb="";zc=ak(zc);for(var Mb=zc.next();!Mb.done;Mb=zc.next()){var cc=Mb.value;ab.dnd(cc)?Bb+=cc:(cc=(Mb=ab.cki(cc))?cc.replace("[","").replace("]",""):cc,Bb+=String.format(Mb?gb.a.instance.lb(59):gb.a.instance.lb(58),cc));Bb+=this.ariaLiveNotifier.wxa}return Bb};
ab.nDd=function(Bb,zc){return Bb>=zc||1===zc?(Ma.ULS.shipAssertTag(537161997,0,Bb<zc,"FormulaAssistanceControl.PositionInList: requested item index >= list length."),""):String.format(gb.a.instance.lb(55),Bb+1,zc)+"\r\n"};ab.dnd=function(Bb){return Kc.a.contains(Bb,va.q7b,!0)};ab.cki=function(Bb){return Bb.trimStart().startsWith(va.rEf)||Bb.trimEnd().endsWith(va.qEf)};Object(La.a)(ab,"FormulaAssistanceReadoutHandler",null,[535,10]);var ub=Pc.a;Rk(ta,ub);ta.prototype.create=function(){var Bb=this,
zc=this.$.da;fb.TaskExtensions.Ba(mb.GetServiceTaskFactory.Ra(zc,211,212,this.hb),function(Mb){Mb=zc.za(219)||new ab(Mb.result,Bb.$);Bb.pb(Mb)},this.la,3)};ta.ka=function(Bb){Bb.da.Ga(220,new ta(Bb))};Object(La.a)(ta,"FormulaAssistanceReadoutHandlerFactory",Pc.a,[]);var Fb=b(738),pc=b(113),eb=b(1185),ic=b(54),Ac=b(45),lc=b(121);xa.prototype.Xfd=function(Bb){return this.oQa&&Bb in this.oQa?this.oQa[Bb]:null};xa.prototype.h6f=function(Bb,zc){this.oQa||(this.oQa={});this.oQa[Bb]=zc};xa.prototype.MZ=
function(){this.oQa=null};Object(La.a)(xa,"FormulaAssistanceContextualPreviewCache",null,[]);var Gc=b(61);S.prototype.dispose=function(){this.Ad||(this.$&&(this.$.ea.lD(this.iy),this.$=null),this.uha=this.HFb=null,this.Ad=!0)};S.prototype.Kcd=function(Bb,zc,Mb,cc){var Uc=this;if(zc&&0>=zc.length)throw Error.argumentNull("GetContextualFormulaPreviewResults - currentFormula is null or empty");if(!Bb)throw Error.argumentNull("GetContextualFormulaPreviewResults - formulaSubExpressionObject is null");
this.calcManager=this.$.da.za(266);if(!this.calcManager)throw Error.invalidOperation("GetContextualFormulaPreviewResults failed - No CalcManager");var Rb="="+zc.substring(Mb.start,Mb.end);ma.EwaSettings.ma(596)&&(Rb=this.calcManager.aYh(bb.g(this.$).ha.sa.activeCell,Bb,Mb));var qc=this.hLh(Rb,Mb);if(ma.EwaSettings.ma(596)){if(qc&&!this.calcManager.isFormulaSubExpressionVolatile(Bb))return Promise.resolve(qc)}else if(qc)return Promise.resolve(qc);return this.jLh(Rb,Mb).then(function(Oc){if(Uc.A_c(cc))throw Error.create("OperationCanceledException");
if(!Oc||Oc.lhj||Oc.Sma.startsWith("##UNSUPPORTED:"))return Uc.jXe(zc,Rb,Mb,cc);Uc.uha.h6f(Rb,Oc.Sma);return Promise.resolve(Oc)})};S.prototype.hLh=function(Bb,zc){return(Bb=this.uha.Xfd(Bb))?new eb.a(Bb,zc.start,zc.end,0):null};S.prototype.jLh=function(Bb,zc){if(!Bb||0>=Bb.length||!zc)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");return this.calcManager.bTg(bb.g(this.$).ha.sa.activeCell,Bb,this.bzi,zc)};S.prototype.jXe=
function(Bb,zc,Mb,cc){var Uc=this;if(!Bb||0>=Bb.length||!zc||0>=zc.length||!Mb)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");if(this.HOa)return this.iLh(Bb,zc,Mb,cc);var Rb={};Rb.PartialFormula=zc;Rb.Formula=Bb;Rb.SourceRange=Ac.v(bb.g(this.$).ha.sa.activeCell,this.$);return this.HOa=new Promise(function(qc,Oc){Uc.HFb=new Fb.a;Uc.$Rf=Uc.$.ea.Ve;Uc.u$a=da(Uc.$.oa.xa,Rb,function(jb){Uc.cUi(zc,Mb,cc,jb,qc,Oc)},function(jb){Uc.HOa=
null;Uc.u$a=null;Oc(jb)},null,null,null);Uc.HFb.token.register(function(){Uc.HUg(Oc)})})};S.prototype.cUi=function(Bb,zc,Mb,cc,Uc,Rb){this.u$a=this.HOa=null;if(this.$Rf!==this.$.ea.Ve)Rb(Error.create("OperationCanceledException"));else if(cc.Result)if(cc=ic.a.Vh(cc.Result),!cc||pc.a.isEmpty(cc))Uc(null);else{for(var qc in cc)this.uha.h6f(qc,cc[qc]);this.A_c(Mb)?Rb(Error.create("OperationCanceledException")):(Bb=this.uha.Xfd(Bb))?(""===Bb&&(Bb=" "),Uc(new eb.a(Bb,zc.start,zc.end,0))):Rb(Error.create("SubexpressionNotFoundException"))}else Uc(null)};
S.prototype.iLh=function(Bb,zc,Mb,cc){var Uc=this;return new Promise(function(Rb,qc){Uc.HOa.then(function(){Uc.LSf(Bb,zc,Mb,cc,Rb,qc)}).catch(function(){Uc.LSf(Bb,zc,Mb,cc,Rb,qc)})})};S.prototype.LSf=function(Bb,zc,Mb,cc,Uc,Rb){if(this.A_c(cc))Rb(Error.create("OperationCanceledException"));else{var qc=this.uha.Xfd(zc);qc?Uc(new eb.a(qc,Mb.start,Mb.end,0)):this.jXe(Bb,zc,Mb,cc).then(function(Oc){Uc(Oc)}).catch(function(Oc){Rb(Oc)})}};S.prototype.HUg=function(Bb){this.u$a&&(lc.a.nu(this.u$a.Ht)?(this.HOa=
this.u$a=null,Bb(Error.create("PendingWebReqeuestCancelled"))):Ma.ULS.sendTraceTag(537162063,0,10,"Failed to cancel the pending web request!"))};S.prototype.MZ=function(){this.IUg();this.uha&&this.uha.MZ()};S.prototype.IUg=function(){this.HFb&&this.HFb.cancel()};S.prototype.A_c=function(Bb){return this.Ad||Bb.$J};Object(La.a)(S,"FormulaAssistanceContextualPreviewCalculator",null,[10]);var ed=b(162),fd=b(224);Qa.Coh="ewa-facp-text-box";Object(La.a)(Qa,"CssClassNames",null,[]);wa.prototype.dispose=
function(){(this.C$||this.QP)&&this.b7e();this.Ya=this.nqa=null};wa.prototype.KQj=function(Bb,zc,Mb,cc){Bb&&zc&&cc&&zc.Sma&&!(1>zc.Sma.length)&&(this.Ya=Bb,this.EOf(),this.U1a=zc,this.vSa=cc,this.ezj(zc,Mb,cc))};wa.prototype.b7e=function(){this.R5h();this.EOf();this.vSa=this.U1a=null};wa.prototype.ezj=function(Bb,zc,Mb){var cc=this;if(Bb.Sma&&!(1>Bb.Sma.length)){var Uc=this.Ec.da.za(266);if(Uc){var Rb=Uc.gRh();Rb&&fb.TaskExtensions.Ba(this.zBb,function(){if(zc)if(ma.EwaSettings.ma(596)&&cc.Ya.isEditing&&
0<Mb.length){cc.cxb(Bb.pJa,Mb[0].start,null);var qc=cc.c2e(Mb[0],Rb),Oc=cc.Ya.text.substring(Mb[0].start,Mb[0].end).trim();Oc=cc.Ya.text.indexOf(Oc);Oc=cc.Ya.text.substring(0,Oc).lastIndexOf("\n");cc.cxb(0>Oc||1>=Mb.length?Mb[0].start:Oc+1,Mb[0].end,qc?String.format(qc,.3):null);for(var jb=1;jb<Mb.length;jb++)qc=cc.c2e(Mb[jb],Rb),Oc=cc.Ya.text.substring(Mb[jb].start,Mb[jb].end).trim(),Oc=cc.Ya.text.indexOf(Oc),Oc=cc.Ya.text.substring(Mb[jb-1].end,Oc).lastIndexOf("\n"),cc.cxb(0>Oc?Mb[jb-1].end:Oc+
1+Mb[jb-1].end,Mb[jb].end,qc?String.format(qc,.3):null);Oc=cc.Ya.text.substring(Mb[Mb.length-1].end,Bb.Aua).indexOf("\n");cc.cxb(0>Oc?Mb[Mb.length-1].end:Oc+1+Mb[Mb.length-1].end,Bb.Aua,null);Ma.ULS.sendTraceTag(537162061,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Colored highlighting and partial evaluation completed")}else cc.cxb(Bb.pJa,Bb.Aua,null),Ma.ULS.sendTraceTag(537162060,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Default highlighting and partial evaluation completed");
cc.C$||(cc.C$=document.createElement(fd.a.div),cc.Ya.textBox.domElement.appendChild(cc.C$));cc.QP||(cc.QP=document.createElement(fd.a.div),cc.QP.className=Qa.Coh,cc.Ec.domElement.appendChild(cc.QP));qc=Bb.Aua;ma.EwaSettings.ma(596)&&cc.Ya.isEditing&&Mb&&0<Mb.length&&Mb[0].start<qc&&Mb[0].start!==Bb.pJa&&!cc.Ya.textBox.jv.length&&(qc=Mb[0].start);jb=Kc.a.contains(cc.Ya.textBox.Ne.id,"FormulaBar",!0)&&Kc.a.contains(cc.Ya.text.substring(Bb.pJa,Bb.Aua),"\n",!0);Oc=cc.Ya.isEditing?cc.Ya.textBox.caretPosition:
0;qc=excelOnline.utils.getBoundingRectForText(cc.Ya.textBox.Ne,jb?Oc:Bb.pJa,jb?Oc:qc,ma.EwaSettings.ma(596));cc.QP.style.left=dc.HelperMethods.hc(qc.left);cc.QP.style.top=dc.HelperMethods.hc(qc.top);cc.QP.style.width=dc.HelperMethods.hc(qc.width);cc.QP.style.height=dc.HelperMethods.hc(qc.height);qc=String.format("FormulaAssistancePreviewToolTip_{0}_{1}",Bb.Aua,Bb.Aua);dialogControls.renderToolTip(cc.C$,qc,Bb.Sma,cc.QP,0,!1,!1,1)},this.Ec.la,3)}}};wa.prototype.c2e=function(Bb,zc){var Mb=this.Ya.text,
cc=Mb.substring(Bb.start,Bb.end);cc=cc.trim();Bb=Mb.indexOf(cc,Bb.start);zc=Mb.indexOf(zc,Bb);cc=Mb.substring(Bb,zc);cc=cc.trim();return this.Ya.colors.getItem(Bb+"-"+(Bb+cc.length))};wa.prototype.R5h=function(){var Bb=this;this.Ya&&this.C$&&this.QP&&fb.TaskExtensions.Ba(this.zBb,function(){Bb.Ya.textBox.domElement.contains(Bb.C$)&&(dialogControls.clearToolTip(Bb.C$),Bb.Ya.textBox.domElement.removeChild(Bb.C$),Bb.C$=null);Bb.Ec.domElement.contains(Bb.QP)&&(Bb.Ec.domElement.removeChild(Bb.QP),Bb.QP=
null)},this.Ec.la,3)};wa.prototype.cxb=function(Bb,zc,Mb){if(this.Ya&&!(Bb>=zc)){var cc={};this.Ya.textBox.formatText(Bb,zc-Bb,(cc.background=Mb||"#E3DDCC",cc));this.fid=!0}};wa.prototype.EOf=function(){if(this.Ya&&this.U1a&&this.fid){var Bb=this.U1a.Aua;ma.EwaSettings.ma(596)&&0<this.vSa.length&&this.vSa[this.vSa.length-1].end>Bb&&(Bb=this.vSa[this.vSa.length-1].end);var zc={};this.Ya.textBox.formatText(this.U1a.pJa,Bb-this.U1a.pJa,(zc.background=!1,zc));this.fid=!1}};Af.Object.defineProperties(wa.prototype,
{zBb:{configurable:!0,enumerable:!0,get:function(){var Bb=this;if(this.nqa)return this.nqa;var zc=new ed.a;this.Ec.eB(function(Mb){fb.TaskExtensions.Ba(Mb.Lsd(),function(){zc.setResult(!0)},Bb.Ec.la,3)});return this.nqa=zc.task}}});Object(La.a)(wa,"FormulaAssistanceContextualPreviewControl",null,[10]);var Bc=b(85),ld=b(47),Bd=b(44);ia.prototype.y2f=function(Bb,zc,Mb){Mb?this.D5g(Bb,zc,Mb):this.o4e(Bb,zc,Mb,!0)};ia.prototype.Pfj=function(){this.H7=0};ia.prototype.D5g=function(Bb,zc,Mb){var cc=this;
this.H7++;var Uc=this.H7;ld.a.instance.create(function(){cc.o4e(Bb,zc,Mb,Uc===cc.H7)},500,Bd.a.hDh,!0,!0)};ia.prototype.o4e=function(Bb,zc,Mb,cc){var Uc=this,Rb=this.Xad.Kcd(Bb,zc);Rb&&Rb.then(function(qc){cc&&Uc.Xad.Vnd(zc)&&Uc.Xad.JQj(Bb,qc,Mb)}).catch(function(qc){qc=Object(Bc.a)(Error,qc);"OperationCanceledException"===qc.message?Ma.ULS.sendTraceTag(537162059,0,50,"GetContextualFormulaPreviewResults - caught exception: {0}",qc):Ma.ULS.sendTraceTag(537162058,0,10,"GetContextualFormulaPreviewResults - caught exception: {0}",
qc)})};Object(La.a)(ia,"FormulaAssistanceContextualPreviewHoverManager",null,[]);var xb=b(206);ha.prototype.dispose=function(){this.xZc();$a.a.oc([this.Ytb,this.f$b]);this.g$b=this.f$b=this.Ytb=null;this.$&&bb.g(this.$).Wb.Nl(this.m9a);this.sha=this.Ya=this.$=null};ha.prototype.fzj=function(Bb,zc){zc&&xb.f(zc.text)&&!(zc.swa||zc.textBox.jv||this.Ya&&this.Ya.textBox.jv)&&(this.Ya=zc,this.calcManager=this.$.da.za(266))&&(Ma.ULS.sendTraceTag(537162056,0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnHover: Highlighting and partial evaluation initiated"),
Bb=dc.HelperMethods.Hub(Bb),Bb=this.calcManager.YXh(bb.g(this.$).ha.sa.activeCell,this.Ya.text,Bb.x,Bb.y),zc=this.calcManager.getSubExpressionSpan(Bb),!zc||zc.end<=zc.start||this.Vnd(zc)||(this.sha=zc,this.g$b.y2f(Bb,zc,!0)))};ha.prototype.gRd=function(Bb){if(Bb&&xb.f(Bb.text))if(Bb.textBox.jv&&Bb.textBox.jv.trim()){if(this.Ya=Bb,this.calcManager=this.$.da.za(266)){Ma.ULS.sendTraceTag(537162054,0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnSelection: Highlighting and partial evaluation initiated");
Bb={};var zc=this.Ya.textBox.jv.trim();Bb.start=this.Ya.text.indexOf(zc,this.Ya.textBox.caretPosition);Bb.end=Bb.start+zc.length;(zc=this.calcManager.getFormulaSubExpressionObject(bb.g(this.$).ha.sa.activeCell,this.Ya.text,this.Ya.textBox.jv))&&!this.Vnd(Bb)&&(this.sha=Bb,this.g$b.y2f(zc,Bb,!1))}}else this.S4a(!1,!0)};ha.prototype.S4a=function(Bb,zc){!this.Ya||zc&&this.Ya.textBox.jv||(this.sha=null,Bb&&(this.xZc(),this.f$b.MZ(),this.g$b.Pfj()),this.Ytb&&this.Ytb.b7e(),this.Ya.swa||(this.Ya.swa=!1,
this.Ya=null))};ha.prototype.Kcd=function(Bb,zc){if(!this.Ya||this.Ya.swa)return null;this.xZc();this.nrb=new Fb.a;return this.f$b.Kcd(Bb,this.Ya.text,zc,this.nrb.token)};ha.prototype.JQj=function(Bb,zc,Mb){this.nrb=null;!Bb||!zc||!zc.Sma||0>=zc.Sma.length?this.S4a(!1,!1):(Bb=this.calcManager.ZXh(bb.g(this.$).ha.sa.activeCell,Bb,this.Ya.text),this.Ytb.KQj(this.Ya,zc,Mb,Bb))};ha.prototype.Vnd=function(Bb){return this.sha?Bb.start===this.sha.start&&Bb.end===this.sha.end&&Bb.pre===this.sha.pre&&Bb.post===
this.sha.post:!1};ha.prototype.xZc=function(){this.nrb&&this.nrb.cancel()};Object(La.a)(ha,"FormulaAssistanceContextualPreviewManager",null,[529,10,530]);var Fd=b(7),Vd=b(4),se=b(233),ue=b(13),Ee=b(202),qe=b(1297),He=b(66),Ie=b(986),ef=b(31),Ye=b(24),pe=b(64),Qd=b(258),fe=b(256),Hc=b(169);fa.prototype.UYf=function(Bb){this.$S=0;this.b8d=Bb.IsCompatibility;this.set_name(Bb.NameDataStrings);this.CVa=Bb.Help};fa.prototype.Opj=function(Bb){this.$S=1;this.set_name(Bb.Name)};fa.prototype.opj=function(Bb){this.$S=
2;this.set_name(Bb.name);this.CVa=Bb.tooltip};fa.prototype.Qqj=function(Bb){this.$S=3;this.set_name(Bb.name);this.CVa=Bb.toolTip};fa.prototype.r_f=function(Bb){this.$S=4;this.set_name(Bb.name)};fa.prototype.htj=function(Bb){this.$S=5;this.set_name(Bb.name);this.CVa=Bb.toolTip};fa.prototype.gtj=function(Bb){this.$S=7;this.set_name(Bb.name)};fa.prototype.Frj=function(){this.$S=6;this.set_name(gb.a.instance.lb(187));this.CVa=gb.a.instance.lb(188)};fa.prototype.set_name=function(Bb){return this.z9d=Bb};
fa.X9g=function(){return Object(Fd.a)(new fa(!0),{})};Af.Object.defineProperties(fa.prototype,{itemType:{configurable:!0,enumerable:!0,get:function(){return this.$S}},Qfi:{configurable:!0,enumerable:!0,get:function(){return this.b8d}},name:{configurable:!0,enumerable:!0,get:function(){return this.label}},label:{configurable:!0,enumerable:!0,get:function(){return this.z9d}},bja:{configurable:!0,enumerable:!0,get:function(){return this.CVa}},Szb:{configurable:!0,enumerable:!0,get:function(){return this.jrg}}});
Object(La.a)(fa,"AutoCompleteItem",null,[564]);Object(La.a)(qa,"DefinedNameInfo",null,[]);var ud=b(189);Y.prototype.eNj=function(Bb){var zc=this.iGe[Bb.toUpperCase()];if(!zc)return{returnValue:!1,sheetName:"",range:null};Bb=zc.sheetName;zc=this.A2g(zc.namedRange);return{returnValue:!0,sheetName:Bb,range:zc}};Y.prototype.P2g=function(Bb){if(null!=Bb&&void 0!=Bb)return{top:Bb.top,left:Bb.left,bottom:Bb.bottom,right:Bb.right,maxRows:Bb.maxRows,maxColumns:Bb.maxColumns,sheetName:void 0}};Y.prototype.A2g=
function(Bb){if(null!=Bb&&void 0!=Bb)return new ud.a(Bb.top,Bb.left,Bb.bottom,Bb.right,Bb.maxRows,Bb.maxColumns)};Y.prototype.I2g=function(Bb){switch(Bb){case 2:return 0;case 3:return 1;default:return-1}};Af.Object.defineProperties(Y.prototype,{hGe:{configurable:!0,enumerable:!0,get:function(){var Bb=[];if(!this.$.vb||!this.$.vb.items)return Bb;for(var zc=0,Mb=ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest")&&wc.a.WZ(this.$),cc=ak(this.$.vb.items),Uc=
cc.next();!Uc.done;Uc=cc.next())if((Uc=Uc.value)&&(3===Uc.type&&Uc.usedRange||Mb&&2===Uc.type)){var Rb=new qa;Rb.tooltip=Uc.sheetName+He.a.exclamation+Uc.usedRange.toString();Rb.name=Uc.name;Rb.namedRange=this.P2g(Uc.usedRange);Rb.sheetName=Uc.sheetName;Rb.type=this.I2g(Uc.type);Bb.push(Rb);this.iGe[Uc.name.toUpperCase()]=Rb;++zc;if(zc===va.Xof){Ma.ULS.sendTraceTag(537162076,0,15,"Maximum number of defined names reached for formula assistance: {0}",va.Xof);break}}return Bb}}});Object(La.a)(Y,"DefinedNameInfoManager",
null,[]);var Gd=b(127),jd=b(279),Sd=b(274),Wd=b(244),Le=Sys.EventArgs;Rk(ka,Le);Object(La.a)(ka,"FormulaAssistanceFunctionChangedEventArgs",Sys.EventArgs,[]);var Pd=Sys.EventArgs;Rk(ea,Pd);Object(La.a)(ea,"FormulaAssistanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);var Re=Sys.EventArgs;Rk(Z,Re);Object(La.a)(Z,"FormulaAssitanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);var Qe=b(273);X.prototype.Uf=function(Bb,zc){Bb=!1;zc||(bb.g(this.$).Ki.textBox.WJ=!0,Bb=this.formulaAssistanceUIControl.focus(this.hUe));
return Bb};X.prototype.$g=function(Bb){var zc=this.jc;return!(void 0===zc||null===zc)&&Pb.DOMElementExtensions.nf(zc,Bb)};X.prototype.hj=function(){this.F4e&&this.F4e();if(this.jka){var Bb=bb.g(this.$).Ki.textBox;this.selection=Bb.selection;Bb.removeSelection()}};X.prototype.Dj=function(){this.jka&&(bb.g(this.$).Ki.textBox.selection=this.selection)};X.prototype.dispose=function(){Qe.a(this.$).Gz(this)};Af.Object.defineProperties(X.prototype,{canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.kZc},
set:function(Bb){this.kZc!==Bb&&(Bb?Qe.a(this.$).Oh(this):Qe.a(this.$).Gz(this),this.kZc=Bb)}},Zd:{configurable:!0,enumerable:!0,get:function(){return this.slj}},jc:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceUIControl.getRootElement(this.hUe)}}});Object(La.a)(X,"FormulaAssistanceFocusManager",null,[422,10]);var jc=b(38),Fa=b(389),Qb=b(177),cb=b(34),Xb=b(296),kc=b(295),Wc=b(1120),id=jc.a;Rk(ca,id);ca.prototype.qYa=function(Bb){this.addHandler("FunctionInfoLoaded",Bb)};
ca.prototype.Xab=function(Bb){this.removeHandler("FunctionInfoLoaded",Bb)};ca.prototype.MEg=function(Bb){this.addHandler("FunctionInfoReset",Bb)};ca.prototype.bbj=function(Bb){this.removeHandler("FunctionInfoReset",Bb)};ca.prototype.dispose=function(){var Bb=this.$.da.za(268);Bb&&Bb.wId(this.Lwf);this.jb=null;id.prototype.dispose.call(this)};ca.prototype.rSf=function(){this.raiseEvent("FunctionInfoReset")};ca.prototype.gKd=function(){this.rSf();this.EKc=!1;this.WS=null;this.CKc=!0};ca.prototype.L1a=
function(Bb,zc){var Mb=this;zc=void 0===zc?!1:zc;if(this.XZ)this.aKf();else{Ma.ULS.sendTraceTag(537161991,0,50,"Retrieving the list of function names for culture '{0}' from the server.",this.$.ya.UICultureTag);var cc=null;(cc=this.$.da.za(268))||Ma.ULS.sendTraceTag(537161990,0,50,"instantaneousSupportInformationManager == null");if((null===cc||void 0===cc?0:cc.dja)&&0<cc.dja.length)ma.EwaSettings.ma(122)?cc.JCh(this.$wf):this.OGd(cc.dja,!0,!1);else{var Uc=this.$.oa.xa.Pb();Bb&&(this.$.ea.dc||zc)&&
!this.Lhi&&(zc?Fa.a(this.$.userOperationManager,function(Rb,qc,Oc){return Gc.p(Mb.$.oa.xa,Bb,kc.b(Rb,Mb.bxf),kc.a(qc,Mb.axf),Oc,Bb,Uc)},function(Rb){return new Qb.a(130,0,Rb,16)},null):Gc.p(this.$.oa.xa,Bb,this.bxf,this.axf,null,Bb,Uc));!this.XZ&&this.$.ea.dc&&(cc?(Ma.ULS.sendTraceTag(537161989,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - Functions not loaded yet, wait for them. IsFullyLoaded={0}, IsSessionActive={1}",this.XZ,this.$.ea.dc),cc.Eme(this.Lwf)):(Ma.ULS.sendTraceTag(537161988,0,
50,"FunctionInfoManager.EnsureFunctionInfoAsync - instantaneousSupportInformationManager is null"),Gc.p(this.$.oa.xa,{FilterType:0},this.$wf,null,null,null,Uc),this.CKc=!1))}}};ca.prototype.aPh=function(Bb){return 0>Bb||Bb>=this.WS.length?null:this.WS[Bb]};ca.prototype.Ldd=function(Bb){return cb.a.zc(this.xbd,Bb.toUpperCase())};ca.prototype.bPh=function(Bb){return cb.a.zc(this.ybd,Bb.toUpperCase())};ca.prototype.Rac=function(Bb){return cb.a.zc(this.uJa,Bb)};ca.prototype.jgc=function(Bb){return!Bb.GroupUI};
ca.prototype.Owf=function(Bb,zc,Mb){var cc=Xb.a(Bb);Ma.ULS.sendTraceTag(537161955,0,50,"FunctionInfoManager.OnFunctionListSuceeded: areNonStatusMessagesPresentInResult={0}",cc);cc?(bb.g(this.$).endEdit(!1,"FunctionInfoManager.OnFunctionListSuceeded"),this.$.ea.kp(Bb.Errors)):(this.OGd(Bb.Result,zc,Mb),wc.a.rV()&&!wc.a.WZ(this.$)&&this.YSj())};ca.prototype.OGd=function(Bb,zc,Mb){Ma.ULS.sendTraceTag(537161954,0,50,"FunctionInfoManager.RefreshFunctionList: functionsInfo count = {0}, isCategorized = {1}, partialResult = {2} IsFullyLoaded = {3}",
Bb.length,zc,Mb,this.XZ);this.XZ||(this.WS=Bb,this.PPg(zc),this.EKc=!Mb,this.aKf())};ca.prototype.aKf=function(){this.raiseEvent("FunctionInfoLoaded")};ca.prototype.YSj=function(){this.pluginScheduler.notifier().setFunctionsInfo(this.q$b)};ca.prototype.PPg=function(Bb){function zc($c,od){return $c.NameUI.localeCompare(od.NameUI)}var Mb=gb.a.instance.ga(1024),cc=[];this.uJa={};this.H8=[];this.uJa[Mb]=cc;var Uc=gb.a.instance.ga(1025),Rb=[];this.H8.push(Mb);this.H8.push(Uc);Mb=0;for(var qc=this.WS.length;Mb<
qc;Mb++){var Oc=this.WS[Mb];Oc.IsCompatibility||Rb.push(Oc);var jb=Oc.NameUI,Eb=Oc.NameDataStrings;this.xbd[Eb.toUpperCase()]||(this.xbd[Eb.toUpperCase()]=Oc);this.ybd[jb.toUpperCase()]||(this.ybd[jb.toUpperCase()]=Oc);if(!this.jgc(Oc)){if(Bb){jb=Oc.GroupUI;var nc=cb.a.zc(this.uJa,jb);nc||(nc=[],this.uJa[jb]=nc,this.H8.push(jb));nc.push(Oc)}Oc.IsCommonlyUsed&&cc.push(Oc);Oc.IsCompatibility||this.Fog.push(Eb)}}this.uJa[Uc]=Rb;Bb&&(ca.TNf(cc,[2,3,0,5,4,9,1,7,8,6]),cc=Array(14),cc[0]=0,cc[1]=1,cc[2]=
7,cc[3]=11,cc[4]=5,cc[5]=2,cc[6]=6,cc[7]=10,cc[8]=9,cc[9]=3,cc[10]=4,cc[11]=13,cc[12]=12,cc[13]=8,ca.TNf(this.H8,cc),cc=[],Array.addRange(cc,this.H8),Array.removeAt(cc,13),this.H8=cc);this.WS=Array.clone(this.WS);this.WS.sort(function($c,od){return $c.NameDataStrings.localeCompare(od.NameDataStrings)});cc=1;for(Uc=this.H8.length;cc<Uc&&Bb;cc++)this.uJa[this.H8[cc]].sort(zc);Bb=0;for(cc=this.WS.length;Bb<cc;Bb++)this.WS[Bb].FunctionIndex=Bb};ca.TNf=function(Bb,zc){for(var Mb=Array.clone(Bb),cc=0;cc<
Mb.length&&cc<zc.length;cc++)Bb[cc]=Mb[zc[cc]]};Af.Object.defineProperties(ca.prototype,{XZ:{configurable:!0,enumerable:!0,get:function(){return this.EKc}},Lhi:{configurable:!0,enumerable:!0,get:function(){return this.CKc}},q$b:{configurable:!0,enumerable:!0,get:function(){var Bb=this.WS,zc=Wc.a(this.$);if(!zc)return Bb;zc=zc.pOh();var Mb=zc.length;if(0>=Mb)return Bb;var cc=[];Array.addRange(cc,Bb);for(Bb=0;Bb<Mb;Bb++){var Uc=zc[Bb],Rb={};Rb.FunctionIndex=cc.length;Rb.HelpId=Rb.GroupUI=null;Rb.Help=
Uc.description;Rb.IsCommonlyUsed=Rb.IsCompatibility=!1;Rb.NameDataStrings=Uc.name;Rb.NameUI=Uc.name;Rb.Params=null;Rb.ParamsHelp=null;cc.push(Rb)}return cc}},obd:{configurable:!0,enumerable:!0,get:function(){return this.H8}},$:{configurable:!0,enumerable:!0,get:function(){return this.jb}}});Object(La.a)(ca,"FunctionInfoManager",jc.a,[513,514,10]);var Vc=b(245),td=b(87),rd=b(48),za=b(917),tb=td.a;Rk(Q,tb);Q.prototype.dispose=function(){this.GTd&&(Vc.a.instance.Aa(ue.a.hh,this.NIe,this.Ivf),this.GTd=
!1);this.nMb&&(this.nMb=!1,Vc.a.instance.Aa(ue.a.Nd,this.domElement.ownerDocument.body,this.gzd),Vc.a.instance.Aa(ue.a.hh,this.domElement.ownerDocument.body,this.fzd));this.z3=this.C4d=null;tb.prototype.dispose.call(this)};Q.prototype.Cke=function(Bb){this.z3?this.z3.push(Bb):this.z3=[Bb]};Q.prototype.nnd=function(Bb){if(this.z3)for(var zc=0,Mb=this.z3.length;zc<Mb;++zc)if(Pb.DOMElementExtensions.nf(this.z3[zc],Bb))return!0;return!1};Q.prototype.iSa=function(Bb){this.c7b||(this.dfa=!0,Kc.a.equals(this.domElement.currentStyle.position,
"absolute",!0)||(this.domElement.style.position="absolute"),this.jlh(),Vc.a.instance.qa(ue.a.Nd,this.domElement.ownerDocument.body,this.gzd),Vc.a.instance.qa(ue.a.hh,this.domElement.ownerDocument.body,this.fzd),this.nMb=!0,this.drag(!0,Bb))};Q.prototype.drag=function(Bb,zc){Aa.g(zc);var Mb=new rd.a(0,0);zc=new Sys.UI.Point(zc.clientX,zc.clientY);var cc=this.domElement.parentNode,Uc=za.a.ls(Mb,cc,zc,this.isRtl());Bb?(Mb=za.a.RE(Mb,cc,this.domElement,this.isRtl()),this.t1a=za.a.sD(Uc,Mb),this.x7=Uc,
this.cJc=!1):!this.M4h&&this.J4h(Uc,this.x7)&&(this.cJc=!0);Mb=za.a.sD(Uc,this.t1a);za.a.qcb(cc,this.domElement,Mb,this.isRtl(),Bb);this.Erg=zc};Q.prototype.cz=function(Bb){this.nMb&&(this.nMb=!1,Vc.a.instance.Aa(ue.a.Nd,this.domElement.ownerDocument.body,this.gzd),Vc.a.instance.Aa(ue.a.hh,this.domElement.ownerDocument.body,this.fzd));Aa.g(Bb);this.dfa=!1;this.x7=this.t1a=null};Q.prototype.b6=function(Bb){var zc=dc.HelperMethods.En(Bb);zc.button===Sys.UI.MouseButton.leftButton&&2===Bb.mb&&this.cz(zc);
return!1};Q.prototype.pN=function(Bb){2===Bb.mb&&this.drag(!1,dc.HelperMethods.En(Bb));return!1};Q.prototype.J4h=function(Bb,zc){return zc.x<Bb.x-2||zc.x>Bb.x+2||zc.y<Bb.y-2||zc.y>Bb.y+2};Q.prototype.jlh=function(){this.offsetParent=this.domElement.offsetParent||this.domElement.ownerDocument.body;this.uFi=Pb.DOMElementExtensions.getLocation(this.offsetParent)};Af.Object.defineProperties(Q.prototype,{c7b:{configurable:!0,enumerable:!0,get:function(){return this.dfa}},NIe:{configurable:!0,enumerable:!0,
get:function(){return this.C4d}},M4h:{configurable:!0,enumerable:!0,get:function(){return this.cJc}}});Object(La.a)(Q,"BaseDraggableBehavior",td.a,[]);Rk(H,Q);H.prototype.setVisible=function(Bb){Pb.DOMElementExtensions.setVisible(this.domElement,Bb);Bb||(this.domElement.style.top="auto",this.domElement.style.left="auto")};H.prototype.isRtl=function(){return this.Yi};H.prototype.rRa=function(Bb){var zc=this.domElement.style;zc.cursor="move";zc.position=Bb?"relative":"absolute"};Object(La.a)(H,"FunctionParamBoxDraggableItem",
Q,[]);Object(La.a)(N,"FormulaArgumentAssistanceCallbacks",null,[]);Object(La.a)(O,"FormulaArgumentAssistanceRenderingInfo",null,[]);var Wb=b(86),fc=b(109),xc=b(158);J.prototype.ka=function(Bb){(this.root=Bb)&&!this.an&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.an=!0)};J.prototype.detach=function(){this.root&&this.an&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.an=!1)};J.prototype.O7b=function(){this.root&&(this.target=this.QG.ACf("move",!0),this.gTd=this.target.getBoundingClientRect(),
this.HZ=!0,this.kQd=!1,this.ev(),this.jlc||this.r3c(),this.target.appendChild(this.jlc))};J.prototype.R3=function(Bb){this.QG.$vf(void 0===Bb?!1:Bb);this.HZ=!1;this.XHd();this.zHd();this.gTd=this.target=void 0};J.prototype.ev=function(){this.kr.capture(this.KMa,null);this.pointerInputManager.jt(ue.a.pointerDown,this.target,this.RFb,!0);this.target.addEventListener("blur",this.onBlur)};J.prototype.zHd=function(){this.kr.releaseCapture();this.pointerInputManager.tt(ue.a.pointerDown,this.target,this.RFb,
!0);this.target.removeEventListener("blur",this.onBlur)};J.prototype.XHd=function(){var Bb;this.target&&(null===(Bb=this.jlc)||void 0===Bb?void 0:Bb.parentNode)===this.target&&this.target.removeChild(this.jlc)};J.prototype.L5=function(Bb,zc){var Mb=this.target.getBoundingClientRect();Bb+=Mb.left-this.gTd.left;zc+=Mb.top-this.gTd.top;this.QG.onMove(Bb,zc)};J.prototype.r3c=function(){this.jlc=xc.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")};Object(La.a)(J,"FormulaAssistanceMoveAdapter",
null,[]);var Yb=b(292);K.prototype.nba=function(){return this.an&&!!this.Kja};K.prototype.lOa=function(Bb){this.Kja.style.cursor="grabbing";this.REj=Bb.clientPoint.x;this.SEj=Bb.clientPoint.y;this.QG.ACf("drag");return!0};K.prototype.Kla=function(Bb){this.QG.onMove(Bb.clientPoint.x-this.REj,Bb.clientPoint.y-this.SEj);return!0};K.prototype.Jla=function(){this.cz()};K.prototype.Ila=function(){this.cz()};K.prototype.ka=function(Bb){if(this.Kja=Bb)this.Kja.style.cursor="grab",Yb.a.instance.c0(this.Kja,
this),this.an=!0};K.prototype.detach=function(){this.an&&this.Kja&&(this.Kja.style.cursor="",Yb.a.instance.P7(this.Kja,this),this.an=!1)};K.prototype.cz=function(){this.Kja.style.cursor="grab";this.QG.$vf()};Object(La.a)(K,"FormulaAssistanceDragAdapter",null,[578]);F.prototype.ka=function(Bb,zc,Mb,cc){this.root=Bb;this.render=Mb;this.dismiss=cc;this.detach();zc&&(this.JIe.ka(zc),this.Wpf.ka(Bb.firstChild),this.an=!0)};F.prototype.detach=function(){this.an&&(this.JIe.detach(),this.Wpf.detach(),this.an=
!1);Pb.DOMElementExtensions.gf(this.placeholder)};F.prototype.clear=function(){this.mJa.setOverrideTarget(void 0);this.detach();this.RJd()};F.prototype.ACf=function(Bb,zc){zc=void 0===zc?!1:zc;this.usageCount[Bb]+=1;this.qyc=this.root.firstChild.getBoundingClientRect();this.placeholder=this.root.cloneNode(!0);Bb=this.placeholder.firstChild;Bb.style.animationDuration="0ms";this.root.parentElement.appendChild(this.placeholder);zc&&(this.iEd=document.activeElement,Bb.tabIndex=0,Bb.focus());this.dismiss();
return Bb};F.prototype.onMove=function(Bb,zc){Bb=Math.min(Math.max(Bb,this.TCc-this.qyc.left),window.innerWidth-this.qyc.right-this.TCc);zc=Math.min(Math.max(zc,this.TCc-this.qyc.top),window.innerHeight-this.qyc.bottom-this.TCc);this.placeholder.firstChild.style.transform="translate("+Bb+"px, "+zc+"px)"};F.prototype.$vf=function(Bb){var zc=this;Bb=void 0===Bb?!0:Bb;var Mb=this.placeholder.firstChild.getBoundingClientRect(),cc=this.mJa.getDirectionalHint({top:Mb.top,left:Mb.left});this.mJa.setOverrideTarget({top:1===
cc?Mb.bottom:Mb.top,left:Mb.left});this.render();window.requestAnimationFrame(function(){Pb.DOMElementExtensions.gf(zc.placeholder);zc.iEd&&(Bb&&zc.iEd.focus(),zc.iEd=void 0)})};F.prototype.RJd=function(){var Bb=this.formulaAssistanceTelemetryManager.T9,zc=this.usageCount[Ec.Drag],Mb=this.usageCount[Ec.Move];0<zc&&(Bb.argumentAssistanceDragCounter+=1,Bb.argumentAssistanceDragTotalCounter+=zc,this.usageCount[Ec.Drag]=0);0<Mb&&(Bb.argumentAssistanceMoveCounter+=1,Bb.argumentAssistanceMoveTotalCounter+=
Mb,this.usageCount[Ec.Move]=0)};Object(La.a)(F,"FormulaAssistanceDragControl",null,[]);var Ec;(function(Bb){Bb.Drag="drag";Bb.Move="move"})(Ec||(Ec={}));Object(La.b)("FormulaAssistanceDragMode",Ec);var bd=Wd.a;Rk(T,bd);T.prototype.Fme=function(Bb){this.addHandler("FAFunctionNameUpdated",Bb)};T.prototype.FPf=function(Bb){this.removeHandler("FAFunctionNameUpdated",Bb)};T.prototype.wne=function(Bb){this.addHandler("FAParameterSelectionChangedOld",Bb)};T.prototype.bQf=function(Bb){this.removeHandler("FAParameterSelectionChangedOld",
Bb)};T.prototype.vne=function(Bb){this.addHandler("FAParameterSelectionChanged",Bb)};T.prototype.aQf=function(Bb){this.removeHandler("FAParameterSelectionChanged",Bb)};T.prototype.set_visible=function(Bb){this.Dk?Bb||this.$rb():Sys.UI.Control.prototype.set_visible.call(this,Bb);return Bb};T.prototype.$rb=function(){this.formulaAssistanceUIControl&&(this.Jq=null,this.RQ&&this.QG.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.Qka=null,this.fr.canReceiveFocus=!1)};T.prototype.show=
function(Bb){this.Dk||(this.formulaAssistanceTelemetryManager.oO(["argumentAssistanceRender"]),this.v1a.setVisible(!!Bb),this.formulaAssistanceTelemetryManager.jQ(["argumentAssistanceRender"]),this.sWc&&(this.sWc=!1,this.formulaAssistanceTelemetryManager.B7b("argumentAssistanceOverall")))};T.prototype.VJd=function(){var Bb=this;if(!this.I4||this.GRa){this.I4||this.formulaAssistanceTelemetryManager.oO(["argumentAssistanceOverall"]);this.formulaAssistanceTelemetryManager.oO(["argumentAssistanceComputation"]);
var zc=bb.g(this.$).Ki,Mb={content:zc.text,caretPosition:zc.textBox.caretPosition};(this.rba?this.pluginScheduler.getRequester().argumentAssistance(Mb,0):this.pluginScheduler.requester().argumentAssistance(Mb)).then(function(cc){0===cc.kind?cc.payload?(Bb.formulaAssistanceTelemetryManager.jQ(["argumentAssistanceComputation"]),Bb.Kyj(Bb.FDd(cc.payload),zc.textBox.domElement)):Bb.$rb():Bb.formulaAssistanceTelemetryManager.jQ(["argumentAssistanceComputation"],!1);return null})}};T.prototype.update=function(Bb,
zc,Mb,cc){if(!this.Dk&&Bb){this.formulaAssistanceTelemetryManager.oO(["argumentAssistanceComputation","argumentAssistanceOverall"]);this.sWc=!0;var Uc=this.$.listSeparator;try{var Rb=$get(va.vbd,this.Bj),qc=$get(va.pbd,this.Bj);Rb.innerText="";qc.innerText="";var Oc=$get(va.GUe,this.Bj),jb=Bb.Params.split(va.y9c);Rb=[];qc=0;for(var Eb=Oc.rows.length;qc<Eb;qc++){var nc=Oc.rows[qc];Pb.DOMElementExtensions.setVisible(nc,qc<jb.length);var $c=jb[qc],od=va.kWi+qc+"_",de=Bb.NameDataStrings;$get(od+va.sFb,
nc).innerText=de;$get(od+va.hCd,nc).innerText=de;if($c){var ae=jb[qc].split(Uc),ze=T.dnd(ae[ae.length-1]),Xd=T.gki(Bb);ze&&(Xd&&(2<ae.length?(ae[ae.length-2]+="1",ae[ae.length-3]+="1"):Ma.ULS.sendTraceTag(537162073,0,50,"pair params formula should have at least 2 params. at UpdateParameterAssistance. formula '{0}', {1} params, currentParameterIndex = {3}.",de,ae.length.toString(),zc)),T.VJg(ae,Xd,zc,Bb));$c=ae.join(Uc.toString()+" ");jb[qc]=$c;Mb<ae.length?(Rb[qc]=ae[Mb],Ma.ULS.shipAssertTag(537162072,
0,!!ae[Mb]&&1<=ae[Mb].length,"Emphasized parameter is too short or empty selectedParameterIndex = {0}, currRowParamsArray.Length = {1}, formula name = {3}, current row = {4}",Mb,ae.length,de,qc),ae[Mb]=String.format("{0}{1}{2}","<b>",ae[Mb],"</b>"),$c=ae.join(Uc.toString()+" ")):Ma.ULS.shipAssertTag(537162071,0,!1,"the current param index is larger than the param list count. selectedParameterIndex = "+Mb+"currRowParamsArray.Length = "+ae.length+", current row = "+qc);cc&&Ma.ULS.sendTraceTag(558474578,
0,50,"formula '{0}', {1} params, isElipsis = {2}, isPairsParamsFormula = {3}, currentParameterIndex = {4}",de,ae.length,ze,Xd,zc)}$get(od+va.iCd,nc).innerHTML="("+($c||"")+")"}cc?this.raiseEvent("FAFunctionNameUpdated",new ka(Bb.NameDataStrings,jb)):this.raiseEvent("FAParameterSelectionChangedOld",new Z(jb,Rb,Mb));Oc.className=Ie.a.kph+(this.functionInfoManager.jgc(Bb)?"-udf":"")}catch(te){throw Ma.ULS.shipAssertTag(558474577,0,!1,"UpdateParameterAssistance Exception. formula '{0}', {1} params. \nException: {4}",
Bb.NameDataStrings,zc,te),te;}this.formulaAssistanceTelemetryManager.jQ(["argumentAssistanceComputation"])}};T.prototype.dispose=function(){this.Dk||(this.yc.tC(),$a.a.Ia(this.yc),bb.g(this.$).view.Iq(this.$s),$a.a.Ia(this.v1a),this.v1a=null);this.Dk&&$a.a.Ia(this.fr);this.I4&&bb.g(this.$).$b.Nl(this.Df);this.functionInfoManager=this.$=null;bd.prototype.dispose.call(this)};T.prototype.FDd=function(Bb){var zc=new O;zc.functionRenderingInfo=Bb;zc.cardMode=this.y2;this.oHd(zc);return zc};T.prototype.oHd=
function(Bb){Bb.callbacks=new N;Bb.callbacks.onHelpLink=this.Vdd(Bb.functionRenderingInfo);Bb.callbacks.onCardModeChange=this.onCardModeChange;Bb.callbacks.onFeedback=this.VQa;this.I4&&(Bb.callbacks.onDismissClick=this.onDismissClick)};T.prototype.Kyj=function(Bb,zc){var Mb=this;if(this.formulaAssistanceUIControl){this.formulaAssistanceTelemetryManager.oO(["argumentAssistanceRender"]);var cc={};cc.zoomLevel=ba(this.$);this.formulaAssistanceUIControl.updateContext(cc);this.Jq=function(){Mb.formulaAssistanceUIControl.renderArgumentAssistanceCard(Mb.domElement,
zc,Bb)};this.Jq();this.JCd(Bb);this.RQ&&this.QG.ka(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.Jq,function(){return Mb.formulaAssistanceUIControl.dismiss(Mb.domElement)});this.fr.canReceiveFocus=!0;this.formulaAssistanceTelemetryManager.jQ(["argumentAssistanceRender"]);this.formulaAssistanceTelemetryManager.B7b("argumentAssistanceOverall")}};T.prototype.Vdd=function(Bb){var zc=this;return function(){ya(zc.$,Bb.helpID,Bb.isUDF)}};
T.prototype.cOd=function(){var Bb=Gd.a.get(yb.a.B_b);this.y2=Bb?parseInt(Bb,10):T.f5c;this.formulaAssistanceTelemetryManager.AXf(this.y2)};T.prototype.JCd=function(Bb){var zc=Bb.functionRenderingInfo.functionName;this.Qka&&Kc.a.equals(this.Qka,zc,!0)?(zc=jd.a.map(Bb.functionRenderingInfo.signatures,function(Mb){var cc="";0<=Mb.signatureParams.activeParam&&Mb.signatureParams.activeParam<Mb.signatureParams.params.length&&(cc=Mb.signatureParams.params[Mb.signatureParams.activeParam]);return cc}),this.raiseEvent("FAParameterSelectionChanged",
new ea(zc))):(this.Qka=zc,Bb=jd.a.map(Bb.functionRenderingInfo.signatures,function(Mb){return Mb.signatureParams.params.join(", ")}),this.raiseEvent("FAFunctionNameUpdated",new ka(zc,Bb)))};T.prototype.NNb=function(Bb){this.y2=Bb;try{Gd.a.mv(yb.a.B_b,Bb.toString(),Sd.AFrame.jea)}catch(zc){Ma.ULS.sendTraceTag(537162070,0,15,"Failed setting ArgumentAssistanceCardCollapseState cookie with error message: {0}",zc.message)}};T.dnd=function(Bb){return Kc.a.contains(Bb,va.q7b,!0)};T.gki=function(Bb){return!!Bb&&
Kc.a.H1a(Bb.NameDataStrings,"IFS")};T.VJg=function(Bb,zc,Mb,cc){try{if(!Bb||2>Bb.length)Ma.ULS.shipAssertTag(537162069,0,!1,"Requested not on elipsis function, formula '{0}', {1} params, isPairsParamsFormula = {2}, currentParameterIndex = {3}.",cc.NameDataStrings,Bb?Bb.length.toString():"currRowParamsArray == null",zc,Mb);else{for(var Uc=Bb.pop().toString(),Rb=Bb.length-1;Rb<Mb;Rb++){var qc=Bb[Rb].trim();if(zc){var Oc=Bb[Rb-1].trim();Bb.push(T.XFh(Oc,qc))}else{var jb=T.$8e(qc);Bb.push(T.gVe(jb))}}Bb.push(Uc)}}catch(Eb){throw Ma.ULS.shipAssertTag(537162068,
0,!1,"AppendNewOptionalParameters Exception. formula '{0}', {1} params, isPairsParamsFormula = {2}, currentParameterIndex = {3}. \nException: {4}",cc.NameDataStrings,Bb?Bb.length.toString():"currRowParamsArray == null",zc,Mb,Eb),Eb;}};T.XFh=function(Bb,zc){Bb=T.$8e(Bb);var Mb=T.$_e(Bb);zc=T.$_e(zc);return T.gVe(Bb,!0,!!Mb&&!!zc&&Mb!==zc)};T.$8e=function(Bb){var zc=Bb.match(T.Wxd);Bb=Kc.a.trimEnd(Kc.a.trimStart(Bb,va.rEf),va.qEf);if(zc&&zc.length){zc=zc[zc.length-1];var Mb=Number.parseLocale(zc)+1;
Bb=Bb.replace(zc,Mb.toString())}else Bb=String.format("{0}{1}",Bb,1);return Bb};T.gVe=function(Bb,zc,Mb){var cc="[{0}]";(void 0===zc?0:zc)&&(cc=(void 0===Mb?0:Mb)?"[{0}":"{0}]");return String.format(cc,Bb)};T.$_e=function(Bb){return(Bb=Bb.match(T.Wxd))&&Bb.length?Bb[0]:null};T.xJa=function(Bb){if(Bb)return document.createElement("div");Bb=String.format(va.aFf,va.ZEf,va.hCd,Ie.a.OMe,va.sFb,Ie.a.NMe,va.iCd);var zc=String.format(va.aFf,va.$Ef,va.hCd,Ie.a.OMe,va.sFb,Ie.a.NMe,va.iCd);Bb=String.format(va.mEh,
va.nEh,Ie.a.JNe,Ie.a.hmh,Hb.a.Lp,va.GUe,Bb,zc);zc=document.createElement("div");zc.innerHTML=Bb;return zc.firstChild};T.Wxd=RegExp("\\d+");T.f5c=0;Object(La.a)(T,"FormulaArgumentAssistanceControlDeprecated",Wd.a,[563]);Object(La.a)(M,"ParseContext",null,[]);var Ic=b(440),Md=b(1119),ne=b(336),le=Md.a;Rk(U,le);U.prototype.Kh=function(Bb,zc){this.formulaAssistanceControl.Ya=this.Ya;-1470715894!==zc&&-1231471547!==zc||!this.cHe()||(this.vV=!1);return le.prototype.Kh.call(this,Bb,zc)};U.prototype.wyd=
function(){var Bb=this.j5a;if(Bb||this.HQd)if(this.formulaAssistanceControl.Ya=this.Ya,this.formulaAssistanceTelemetryManager.pob.formulaAssistanceRequestAttemptedCounter++,this.cHe())if(!Bb&&this.HQd)this.formulaAssistanceControl.zre();else if(ma.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")&&this.i8h){if(Bb=this.$.Fb.sc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),this.formulaAssistanceControl.Bre(),Bb.stop(),this.job.text.endsWith("[")&&
"["!==this.job.text.charAt(this.job.text.length-2)){var zc=""===this.PHa?this.formulaAssistanceControl.tableManager.qg:Object(Bc.a)(ne.a,this.$.vb.getItemByName(this.PHa));Ma.ULS.sendTraceTag(575776010,0,50,"FormulaAutoCompleteListAutoCompleteBehavior.OnAutoCompleteTimerTick: AutoComplete List Box for Table Column Headers is shown after user types =[ inside a table with id {0} in {1} ms with cell edit regression time of {2} ms and popup visibility - {3}",zc.Ei,Bb.qc,this.lkd,this.vV)}}else this.formulaAssistanceControl.Ynb(),
this.UDf&&(this.UDf=this.vV=!1);else this.formulaAssistanceTelemetryManager.pob.formulaAssistanceRequestOptimizedCounter++;else this.vV=!1};U.prototype.Gh=function(){this.o$i||(this.KRa=null,this.HQd&&this.formulaAssistanceControl.qZ())};U.prototype.Df=function(){this.vV=!1;this.formulaAssistanceControl.set_visible(!1);this.formulaAssistanceControl.stc();this.Dk&&this.Gui()};U.prototype.aFd=function(Bb,zc){return this.formulaAssistanceControl.Kh(Bb,zc)};U.prototype.Gui=function(){this.formulaAssistanceControl.JAa&&
(this.formulaAssistanceTelemetryManager.xM.smartSuggestionShownCounter++,this.formulaAssistanceControl.JAa=!1);this.formulaAssistanceControl.cSa&&(this.formulaAssistanceTelemetryManager.xM.smartSuggestionSelectedCounter++,this.formulaAssistanceControl.cSa=!1);this.formulaAssistanceControl.bSa&&(this.formulaAssistanceTelemetryManager.xM.smartSuggestionCommittedCounter++,this.formulaAssistanceControl.bSa=!1);this.l2&&(this.formulaAssistanceControl.isCellContentOnlyEqualDuringEdit&&(this.formulaAssistanceTelemetryManager.xM.isCellContentOnlyEqualDuringEditCounter++,
this.formulaAssistanceControl.isCellContentOnlyEqualDuringEdit=!1),this.formulaAssistanceControl.GLa&&(this.formulaAssistanceTelemetryManager.xM.isCellContentFormulaCounter++,this.formulaAssistanceControl.GLa=!1))};U.prototype.aVg=function(Bb,zc){for(var Mb=0,cc;-1!==Mb;)if(Mb=Bb.indexOf("[",Mb+1),-1!==Mb&&Mb<zc&&(cc=Bb.indexOf("]",Mb+1),-1===cc||cc>=zc))return Mb;return-1};U.prototype.cHe=function(){var Bb=this.Ya.text,zc=this.Ya.textBox.caretPosition,Mb=this.formulaAssistanceControl.Rka,cc=this.formulaAssistanceControl.XMa;
if(this.vV&&Kc.a.equals(Bb,Mb,!0)&&zc===cc)return!1;this.formulaAssistanceControl.Rka=Bb;this.formulaAssistanceControl.XMa=zc;return!0};Af.Object.defineProperties(U.prototype,{vyb:{configurable:!0,enumerable:!0,get:function(){return Object(Ic.a)(ra,this.$.ob.Xg)}},vV:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceControl.isListVisible},set:function(Bb){this.formulaAssistanceControl.isListVisible=Bb}},j5a:{configurable:!0,enumerable:!0,get:function(){return this.Ya.j5a}},
i8h:{configurable:!0,enumerable:!0,get:function(){var Bb=this.job.text,zc=!1;if(0>=Bb.length)return zc;var Mb=this.$.Fb.sc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),cc=bb.g(this.$).ha.sa.activeCell.clone(),Uc=Bb.charCodeAt(0);this.PHa="";this.$P=this.aVg(Bb,this.job.caretPosition);Uc=61===Uc&&-1!==this.$P;if(!ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing"))Uc&&(zc=!0);else if(Uc){if(ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){Uc=
0;for(var Rb=this.$P-1;1<=Rb&&!(this.$P-Rb>U.Tof);Rb--)if(Array.contains(U.xte,Bb.charAt(Rb))){Uc=Rb;break}Uc=Bb.substring(Uc+1,this.$P);Bb=""!==Uc?this.$.vb.getItemByName(Uc):null;Rb=this.$P;for(var qc=this.$P+1;qc<=this.Ya.textBox.caretPosition;qc++)if("["===this.Ya.text.charAt(qc))Rb=qc;else break;this.$P=Rb}else{Uc=Bb.lastIndexOf("[");Rb=0;for(qc=Uc-1;1<=qc&&!(Uc-qc>U.Tof);qc--)if(Array.contains(U.xte,Bb.charAt(qc))){Rb=qc;break}Uc=Bb.substring(Rb+1,Uc);Bb=""!==Uc?this.$.vb.getItemByName(Uc):
null}Bb&&2===Bb.type?(zc=!0,this.PHa=Uc):bb.g(this.$).Ab.dk(cc)&&(zc=!0,this.PHa="")}Mb.stop();this.lkd=Mb.qc;Ma.ULS.sendTraceTag(575776011,0,50,"FormulaAutoCompleteListAutoCompleteBehavior.InTableHeaderMode: Regression time in cell edit due to column header mode parsing is {0} milliseconds",this.lkd);return zc}},key:{configurable:!0,enumerable:!0,get:function(){return Kb.a.S2a}},calcManager:{configurable:!0,enumerable:!0,get:function(){this.BFc||(this.BFc=this.$.da.za(266,!1));return this.BFc}},
HQd:{configurable:!0,enumerable:!0,get:function(){if(null!=this.KRa)return this.KRa;if(!ma.EwaSettings.ma(136))return this.KRa=!1;var Bb=bb.g(this.$).ha.sa.activeCell.clone();if(1!==Bb.Aof||!Bb.left||bb.g(this.$).ha.sa.Igc())return!1;var zc=this.formulaAssistanceControl.tableManager.Xm(Bb);if(zc)return this.KRa=!1;--Bb.left;--Bb.right;if(!Bb.isValidRange)return!1;zc=this.formulaAssistanceControl.tableManager.Xm(Bb);return this.KRa=!!zc&&Bb.top===zc.top&&this.formulaAssistanceControl.tableManager.D3g(zc,
bb.g(this.$))}}});U.xte=" !%&'()*+,-/:;<=>@[]^{|}~".split("");U.Tof=255;Object(La.a)(U,"FormulaAutoCompleteListAutoCompleteBehavior",Md.a,[]);var Ke=b(30),oc;(function(Bb){Bb[Bb.function=0]="function";Bb[Bb.field=1]="field";Bb[Bb.definedName=2]="definedName";Bb[Bb.letVariable=3]="letVariable";Bb[Bb.tableColHeaderName=4]="tableColHeaderName";Bb[Bb.tableSpecialStructRef=5]="tableSpecialStructRef";Bb[Bb.pendingData=6]="pendingData";Bb[Bb.tableNamedObject=7]="tableNamedObject"})(oc||(oc={}));Object(La.b)("ItemType",
oc);var Qc=b(1299),md=b(1298);I.prototype.execute=function(Bb){Bb.push(this.index)};Object(La.a)(I,"AppendIndexOperation",null,[579]);E.prototype.execute=function(){};Object(La.a)(E,"NopIndexOperation",null,[579]);G.prototype.execute=function(Bb){for(var zc=0;zc<Bb.length;zc++)Bb[zc]===this.g0i&&(Bb[zc]=this.Yqf)};Object(La.a)(G,"ReplaceIndexOperation",null,[579]);var dd=b(77);C.prototype.ADe=function(Bb,zc){var Mb=new I(zc);if(!this.T4)return Mb;Bb=this.Voi(Bb,zc);return null!=Bb?this.items[Bb].Szb?
new G(Bb,zc):new E:Mb};C.prototype.Voi=function(Bb,zc){var Mb=this,cc=this.items[zc];Ma.ULS.shipAssertTag(537162075,0,!!cc,"Internal error: invalid item index");Bb=dd.where(dd.asEnumerable(Bb),function(Uc){return Mb.items[Uc].name===cc.name});return dd.Ct(Bb)?dd.first(Bb):null};Object(La.a)(C,"FilterItemOperationFactory",null,[]);var Kd=b(117),ke=b(1050);Object(La.a)(x,"CompletionItem",null,[]);var kd=b(70),Nd="<tr>\r\n\t{0}\r\n\t<td id='name_cell{4}' class='{1}'>{2}</td>\r\n\t<td id='description_cell{4}' class='"+
Hb.a.Lp+"'>{3}</td>\r\n\t<td id='item_type_cell' class='"+Hb.a.Lp+"'>{5}</td>\r\n</tr>",ge="<tr>\r\n\t{0}\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='description_cell{1}' class='"+Hb.a.Lp+"'></td>\r\n\t<td id='item_type_cell' class='"+Hb.a.Lp+"'>{2}</td>\r\n</tr>",Me="<td>\r\n\t<div class='"+Hb.a.RA+"'>\r\n\t\t<img class='{0}' src='{1}' alt='{2}'/>\r\n\t</div>\r\n</td>",Ze="<tr>\r\n\t<td><b>{0}</b></td>\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='description_cell{1}' class='"+
Hb.a.Lp+"'>{5}</td>\r\n\t<td id='item_type_cell' class='"+Hb.a.Lp+"'>{2}</td>\r\n</tr>",lf=Qc.a;Rk(y,lf);y.prototype.WUc=function(Bb){this.addHandler("FLBSelectedRowChanged",Bb)};y.prototype.QId=function(Bb){this.removeHandler("FLBSelectedRowChanged",Bb)};y.prototype.iZb=function(Bb){this.addHandler("ACLBUpdated",Bb)};y.prototype.zsc=function(Bb){this.removeHandler("ACLBUpdated",Bb)};y.prototype.dispose=function(){lf.prototype.dispose.call(this);this.bra=this.HUe=this.fub=null};y.prototype.$yc=function(Bb,
zc,Mb,cc){cc=void 0===cc?0:cc;this.pef||this.B7(!1);var Uc="";Mb&&(Uc+=String.format("<table aria-live='off' id='{0}'><tr><td class='{1}'>{2}</td></tr></table>","list_column_header",Ie.a.SZg,Mb));Uc+=String.format("<table class='{0}' aria-live='off'><tbody>",this.Uba);for(var Rb=new Ee.a,qc=0,Oc=this.kW.length;qc<Oc;qc++)Uc+=this.k2e(Bb[this.kW[qc]],qc+1,zc,cc),this.Dk&&Rb.add(this.dXe(Bb[this.kW[qc]]));qc=this.kW.length;Oc=0;for(var jb=this.pq.length;Oc<jb;Oc++)Array.contains(this.kW,this.pq[Oc])||
(qc++,Uc+=this.k2e(Bb[this.pq[Oc]],qc,zc,cc),this.Dk&&Rb.add(this.dXe(Bb[this.pq[Oc]])));this.Qf.innerHTML=Uc+"</tbody></table>";this.Gn=Pb.DOMElementExtensions.Cj(this.domElement,this.Uba);this.Dk&&(this.a3b=Rb.toArray());this.pef?(this.isListVisible=!0,this.hGa.set_visible(!0)):(this.B7(!0),this.SHg(!!Mb))};y.prototype.aJa=function(Bb,zc,Mb,cc,Uc,Rb){cc=void 0===cc?"":cc;Uc=void 0===Uc?0:Uc;Rb=void 0===Rb?!1:Rb;if(Bb){var qc=[],Oc=[];this.SLb=0;var jb=new C(this.$,Bb);if(zc){var Eb=!!zc&&0<Uc,nc=
Eb&&91===zc.charCodeAt(Uc+1)?Uc+2:Uc+1;Rb=Eb?zc.length===nc:!1;Eb&&zc.length===Uc&&ma.EwaSettings.ma(136)&&(Rb=!0);var $c=null;!Rb&&Eb&&zc.length>Uc+1&&($c=zc.substring(nc,zc.length));if(zc)for(Eb=0,nc=Bb.length;Eb<nc;Eb++){var od=Bb[Eb].name;if(!Bb[Eb].Qfi){var de=jb.ADe(qc,Eb);Bb[Eb].Szb&&this.SLb++;if(!$c&&!Rb||0===Bb[Eb].itemType)Oc=this.bSe(zc,od,Mb,de,qc,Oc),qc=Oc.h9e,Oc=Oc.hHf;$c&&1===Bb[Eb].itemType&&(Oc=this.bSe($c,od,!0,de,qc,Oc),qc=Oc.h9e,Oc=Oc.hHf);Rb&&1===Bb[Eb].itemType&&de.execute(qc)}}}else for(Mb=
0;Mb<Bb.length;++Mb)if(Bb[Mb].Szb||Rb)$c=jb.ADe(qc,Mb),$c.execute(qc),$c.execute(Oc),Bb[Mb].Szb&&this.SLb++;this.kW=Oc;this.pq=qc;this.$yc(Bb,zc,cc,Uc)}};y.prototype.ZRj=function(Bb){if(Bb&&!(1<Bb.length)){var zc=[],Mb=[];zc.push(0);Mb.push(0);this.kW=zc;this.pq=Mb;this.$yc(Bb,"","",0)}};y.prototype.Qxa=function(){this.Pk&&lf.prototype.Qxa.call(this)};y.prototype.F3i=function(Bb,zc){this.raiseEvent("ACLBUpdated",new md.a(Bb,void 0,void 0,zc))};y.prototype.hdg=function(Bb){var zc=this.Gn.rows[Bb];
return(!this.Pk||this.Pk!==zc)&&Bb<this.Gn.rows.length?(this.Pk=zc,!0):!1};y.eXe=function(Bb){switch(Bb){case 0:return 3;case 2:return 100;case 1:case 6:return 103;case 3:return 102;case 4:return 101;case 5:return 107;case 7:return 106;default:return 3}};y.prototype.onItemClick=function(Bb){Aa.g(Bb.Ca);0===this.o0||2===this.o0||3===this.o0||4===this.o0||5===this.o0||7===this.o0?(this.raiseEvent(ke.a.k4a),this.Qxa()):1===this.o0?this.hGa.Ny(!1):(this.hGa.Ny(!1),Bb=bb.g(this.$),Bb.Ao(!1),Bb.focus());
return!0};y.prototype.SHg=function(Bb){this.Ira();if(Bb){var zc=this.Gn.offsetWidth+(this.pq.length>this.MH?Kd.a.gv:0);Bb=$get("list_column_header");Bb.offsetWidth>zc&&Pb.DOMElementExtensions.vr(this.Qf,Bb.offsetWidth);zc=this.Qf.getElementsByClassName(this.m_);for(var Mb=0;Mb<zc.length;Mb++)zc[Mb].style.width=dc.HelperMethods.hc(Bb.offsetWidth)}};y.prototype.k2e=function(Bb,zc,Mb,cc){if(1===Bb.itemType){var Uc=Ke.a.Ag(Bb.name),Rb=Ke.a.Ag(cc?Mb.substring(cc+1,Mb.length):Mb),qc=0;Uc.substring(0,Rb.length).toLowerCase()!==
Rb.toLowerCase()&&(qc=y.zEj(Uc,va.igg,Rb));Mb="";Mb=0<=qc?Mb+(Uc.substring(0,qc)+"<b>"+Uc.substring(qc,qc+Rb.length)+"</b>"+Uc.substring(qc+Rb.length,Uc.length)):Mb+Uc;cc=cc?String.format(Me,Hb.a.jOe,Ke.a.DZ(ob.a.Te(0)),gb.a.instance.ga(715)):"";return String.format(ge,cc,zc,oc[Bb.itemType],this.m_,Mb)}if(5===Bb.itemType)return String.format(Ze,"",zc,oc[Bb.itemType],this.m_,Ke.a.Ag(Bb.name),Ke.a.Ag(Bb.bja));if(4===Bb.itemType)return String.format(Ze,"(...)",zc,oc[Bb.itemType],this.m_,Ke.a.Ag(Bb.name));
if(6===Bb.itemType)return cc=cc?String.format(Me,Hb.a.jOe,Ke.a.DZ(ob.a.Te(0)),gb.a.instance.ga(715)):"",String.format(Nd,cc,this.m_,Ke.a.Ag(Bb.name),Ke.a.Ag(Bb.bja),zc,oc[Bb.itemType]);cc=String.format(Me,2===Bb.itemType||3===Bb.itemType?Hb.a.Bsh:Hb.a.zsh,Ke.a.DZ(ob.a.Te(0)),gb.a.instance.ga(712));return String.format(Nd,cc,this.m_,Ke.a.Ag(Bb.name),Ke.a.Ag(Bb.bja),zc,oc[Bb.itemType])};y.prototype.dXe=function(Bb){var zc=new x;zc.label=Bb.label;zc.textEdit=Bb.textEdit;zc.kind=y.eXe(Bb.itemType);zc.type=
Bb.Szb?1:0;if(ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5607789_FunctionShortDescriptions")&&3===zc.kind){var Mb=this.formulaAssistanceControl.cPh(Bb.label);zc.detail=Mb?Mb:Bb.bja}else zc.detail=Bb.bja;return zc};y.prototype.bSe=function(Bb,zc,Mb,cc,Uc,Rb){Kc.a.equals(zc,"Pretend this is the line.",!1)&&0<Uc.length||Kc.a.cL(zc,Bb)?(cc.execute(Uc),cc.execute(Rb)):Mb&&Bb.length>=va.G3g&&y.odh(zc,va.igg,Bb)?cc.execute(Uc):!Mb&&Bb.length>=va.F3g&&Kc.a.contains(zc,Bb,!0)&&cc.execute(Uc);return{h9e:Uc,
hHf:Rb}};y.odh=function(Bb,zc,Mb){zc=ak(zc);for(var cc=zc.next();!cc.done;cc=zc.next())if(cc=Bb.split(cc.value),!(2>cc.length)){cc=ak(cc);for(var Uc=cc.next();!Uc.done;Uc=cc.next())if(Kc.a.cL(Uc.value,Mb))return!0}return!1};y.zEj=function(Bb,zc,Mb){zc=ak(zc);for(var cc=zc.next();!cc.done;cc=zc.next())if(cc=Bb.toLowerCase().indexOf((cc.value+Mb).toLowerCase()),0<cc)return cc+1;return-1};Af.Object.defineProperties(y.prototype,{Rhc:{configurable:!0,enumerable:!0,get:function(){return 0<this.SLb&&this.SLb===
this.pq.length}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return Object(kd.a)(y.prototype,this,"isListVisible")},set:function(Bb){Object(kd.b)(y.prototype,this,"isListVisible",Bb);Bb||(this.Ruc=0,this.he=null);0===this.Ruc?Pb.DOMElementExtensions.setVisible(this.fub,Bb&&!this.Dk):Pb.DOMElementExtensions.setVisible(this.fub,!1)}},Pk:{configurable:!0,enumerable:!0,get:function(){return this.bra},set:function(Bb){this.iBa(this.Pk);if(Bb){this.HUe.innerText="";this.bra=Bb;var zc=this.iBa(this.Pk),
Mb=Bb.rowIndex+1,cc=$get("description_cell"+Mb,Bb);this.fub.innerText=cc.innerText;var Uc=$get("item_type_cell",Bb);this.he=zc=zc.innerText;this.Ruc="field"===Uc.innerText?1:"definedName"===Uc.innerText?2:"letVariable"===Uc.innerText?3:"tableColHeaderName"===Uc.innerText?4:"tableSpecialStructRef"===Uc.innerText?5:"pendingData"===Uc.innerText?6:"tableNamedObject"===Uc.innerText?7:0;this.raiseEvent("FLBSelectedRowChanged",new md.a(this.pq.length,Mb,zc,cc.innerText));this.Duc(Bb)}}},QSa:{configurable:!0,
enumerable:!0,get:function(){return this.fub}},hGa:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceControl}},o0:{configurable:!0,enumerable:!0,get:function(){return this.Ruc}}});Object(La.a)(y,"FormulaAutoCompleteListBox",Qc.a,[562]);Af.Object.defineProperties(B.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},toolTip:{configurable:!0,enumerable:!0,get:function(){return this.q9}}});Object(La.a)(B,"LETVariableInfo",null,[]);Af.Object.defineProperties(A.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return this._name}}});Object(La.a)(A,"TableColHeaderNameInfo",null,[]);Af.Object.defineProperties(v.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}}});Object(La.a)(v,"TableNamedObjectInfo",null,[]);Af.Object.defineProperties(r.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},toolTip:{configurable:!0,enumerable:!0,get:function(){return this.q9}}});Object(La.a)(r,"TableSpecialStructRefInfo",
null,[]);var he=b(114),Se=b(179),ve=b(29),Xa=b(101),h=b(1116),hb=b(261),Tb=b(50),yc=b(187);Object(La.a)(z,"FormulaAutoCompleteCallbacks",null,[]);Object(La.a)(n,"FormulaAutoCompleteRenderingInfo",null,[]);Object(La.a)(w,"RunExperimentRequest",null,[]);var vc=qe.a;Rk(f,vc);f.prototype.Dme=function(Bb){this.addHandler(f.ebd,Bb)};f.prototype.EPf=function(Bb){this.removeHandler(f.ebd,Bb)};f.prototype.Bme=function(Bb){this.addHandler(f.Bad,Bb)};f.prototype.CPf=function(Bb){this.removeHandler(f.Bad,Bb)};
f.prototype.Cme=function(Bb){this.addHandler("FormulaAutoCompleteShown",Bb)};f.prototype.DPf=function(Bb){this.removeHandler("FormulaAutoCompleteShown",Bb)};f.prototype.get_visible=function(){return this.Fcf?void 0!==this.rfb?this.rfb:this.rfb=vc.prototype.get_visible.call(this):vc.prototype.get_visible.call(this)};f.prototype.set_visible=function(Bb){if(this.Fcf&&this.rfb===Bb)return this.Dk&&!Bb&&this.i1a(),Bb;this.Wia.set_visible(Bb);this.Dk&&!Bb&&this.i1a();Sys.UI.Control.prototype.set_visible.call(this,
Bb);return this.rfb=Bb};f.prototype.iUg=function(Bb,zc){this.isListVisible&&(Bb+=va.openParen,zc++,this.mCd(Bb,zc));var Mb=0<zc&&Bb.charAt(zc-1)===va.openParen,cc=zc===Bb.length||Bb.charAt(zc)===va.closeParen;if(!Mb||!cc)return Ma.ULS.sendTraceTag(537162053,0,50,"FormulaAssistanceControl.CanInsertFormulaArguments Caret position: {0} is invalid. Is cell empty: {1}. Function exists in cell: {2}",zc,!Bb.length,!!this.ZP),!1;Mb=Bb.substring(0,zc).lastIndexOf(this.$.listSeparator);cc=Bb.substring(0,zc-
1).lastIndexOf(va.openParen);Bb=Bb.substring(-1===Mb&&-1===cc?1:Math.max(Mb,cc)+1,zc-1).trim();return this.functionInfoManager.Ldd(Bb)?!0:(Ma.ULS.sendTraceTag(537162052,0,50,"FormulaAssistanceControl.CanInsertFormulaArguments No valid function name before caret. Function exists in cell: {0}",!!this.ZP),!1)};f.prototype.Gbi=function(Bb,zc){var Mb=this.iUg(Bb,zc);if(!Mb||!this.ZP)return Ma.ULS.shipAssertTag(537162051,0,!Mb||Mb&&!!this.ZP,"FormulaAssistanceControl.InsertFormulaArgumentsFromCaretPosition currentFunctionInfo is null"),
{returnValue:null,Uqf:0,YSe:0};Mb=this.ZP.Params;Mb=Mb.replace(RegExp("[\\[\\]]","g"),"");var cc=Bb.charAt(zc-1)===va.openParen,Uc=cc?"":"(",Rb=zc===Bb.length?")":"";var qc=this.$.listSeparator;qc=Mb.includes(qc)?Mb.indexOf(qc):Mb.length;return{returnValue:Bb.substring(0,zc)+Uc+Mb+Rb+Bb.substring(zc,Bb.length),Uqf:cc?zc:zc+1,YSe:qc}};f.prototype.$s=function(Bb,zc){this.Dk&&void 0!==this.Jq&&null!==this.Jq&&this.Jq();this.Dk||vc.prototype.$s.call(this,Bb,zc)};f.prototype.dispose=function(){if(this.$){this.tSa(!1);
var Bb=this.gridView;this.x9&&(this.$.userOperationManager.wo(this.tca),this.$.userOperationManager.wo(this.uOa));Bb&&(Bb.ha&&(this.Dk?Bb.ha.EF(this.Rc):Bb.ha.zW(this.Rc),wc.a.rV()&&4!==this.zCb&&(this.mzb?Bb.$b.wk(this.Gh):Bb.ha.Gma(this.Rsf))),Bb.view.Iq(this.$mc));this.Dk&&this.$.va&&this.$.va.wg(this.wh)}this.functionInfoManager&&(this.functionInfoManager.Xab(this.onFunctionInfoLoaded),this.functionInfoManager.bbj(this.Nwf));this.Jg&&this.Jg.rsc(this.kya);this.Dk&&this.dh&&this.dh.QId(this.FBf);
wc.a.lfc&&this.Ya&&this.Ya.LHb(this.Y5);this.L6f(!1);$a.a.Ia(this.dh);$a.a.Ia(this.N_b);$a.a.Ia(this.Wia);$a.a.Ia(this.fr);this.Ya=this.functionInfoManager=this.Jg=null;$a.a.oc(this.nJa);this.qg=this.k8=this.Wia=this.nJa=null;vc.prototype.dispose.call(this)};f.prototype.Cwa=function(){return!this.It};f.prototype.Rii=function(){return!this.iGa};f.prototype.Kh=function(Bb,zc){if(!this.Cwa()){if(this.Dk&&this.AH){if(125627505===zc||267796030===zc)return this.Dk&&this.bBc(zc),this.Wze(),this.x9&&this.PUf(),
!1;if(1872288872===zc)return this.Fma(),this.isListVisible=!1,!0;if(this.dh.Rhc&&(-798660877===zc||137938150===zc))return!1}if(1!==this.dh.o0||125627505!==zc&&267796030!==zc)if(6===this.dh.o0){var Mb=Bb.keyCode;13!==Mb&&9!==Mb||this.Ny(!1)}else{if(4===this.dh.o0||5===this.dh.o0)return vc.prototype.Kh.call(this,Bb,zc,!0);1===this.dh.kW.length&&(Mb=Bb.keyCode,this.Sve=8===Mb||127===Mb||46===Mb?!0:!1)}else{if(this.Ny(!1)&&!this.Wja)return this.gridView.ha.Kh(Bb,zc);if(125627505===zc&&this.Wja)return!0}}return vc.prototype.Kh.call(this,
Bb,zc)};f.prototype.stc=function(){this.Jg.vbb();this.k8=null;null==this.Iia||this.Iia||this.Mjc("NoFieldChosen",1,2,1);this.Iia=null;this.u3=0;this.o5=this.ard=this.lpc=null};f.prototype.Ynb=function(){var Bb=this;this.Vdf&&this.formulaAssistanceTelemetryManager.oO(["argumentAssistanceOverall"]);var zc=!!this.Ya&&!pe.f(this.$.pa),Mb=null;this.l2&&zc&&(Mb=this.Ya.text,Mb.startsWith("=")&&(this.GLa=!0,1===Mb.length&&(this.isCellContentOnlyEqualDuringEdit=!0)));if((this.IAa||this.Yxc)&&zc){this.l2||
(Mb=this.Ya.text);var cc={content:Mb,caretPosition:null};(this.rba?this.pluginScheduler.getRequester().functionSuggestion(cc,0):this.pluginScheduler.requester().functionSuggestion(cc)).then(function(Uc){0===Uc.kind&&(Ma.ULS.shipAssertTag(537162050,0,!!Uc&&!!Uc.payload.items,"FormulaAssistanceControl.AssistFormula - x10Scheduler returned `null` suggestion"),Uc=dd.toArray(dd.select(dd.asEnumerable(Uc.payload.items),function(Rb){return f.x2g(Rb)})),Bb.Yxc&&"="===Mb&&0<Uc.length&&Bb.Pq.Pta.iOd("="+Uc[0].textEdit.newText),
Bb.IAa&&(Bb.aSa=Uc,Vd.AFrameworkApplication.Bg||(Bb.KXc&&Bb.Ab.c5(Bb.gridView.ha.sa.activeCell)?Bb.formulaAssistanceTelemetryManager.xM.smartSuggestionWouldSuggestInsidePivotCounter++:Bb.Are(zc,!0))));return null})}this.IAa&&zc||this.Are(zc,!1)};f.prototype.j2e=function(){if(ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){var Bb=this.gridView.sj?this.Ztb.$P:this.xpb.$P;"@"===this.Ya.text.charAt(Bb+1)&&this.Ya.textBox.caretPosition>Bb+1?this.Pdb=Bb+
2:this.Pdb=Bb+1}else{Bb=this.Ya.text.lastIndexOf(va.Bjf);var zc=this.Ya.text.lastIndexOf("[");this.Pdb=Bb+1>=zc?Bb+2:zc+1}return this.Ya.text.substring(this.Pdb,this.Ya.textBox.caretPosition)};f.prototype.Bre=function(){this.E3f()&&(this.n$g(),this.It&&(this.Iia=!1,this.EV=this.j2e(),this.dh.aJa(this.It,this.EV,!0,void 0,void 0,!0),this.show(),ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5516893_fixInTableHeaderModeAccordingToCaretPoisiton")&&this.Wia.$rb()))};f.prototype.zre=function(){this.E3f()&&
(this.N_b&&this.N_b.cancel(),this.Jg.U5a?(this.Cwa()&&this.nCe(!0),this.get_visible()?this.YRe():this.f1d=Se.AsyncMethodContext.Ps(this.YRe,va.Lch,Bd.a.iDh,this.N_b)):this.qZ())};f.prototype.E3f=function(){return this.Ya?0<this.$.ob.uR||!this.Ya.text||!this.Ya.isEditing?(this.set_visible(!1),!1):pe.f(this.$.pa)?!1:!0:!1};f.prototype.lqb=function(Bb){this.Ya&&this.isListVisible&&(this.lld(this.Ya.text,Bb),this.Ya.textBox.caretPosition=Bb.range.start.character+Bb.newText.length,this.set_visible(!1))};
f.prototype.Ny=function(){var Bb;if(!this.Ya||!this.isListVisible)return!1;var zc=this.dh.o0;this.ocf&&this.formulaAssistanceTelemetryManager.X8e(y.eXe(zc));var Mb="",cc=0,Uc=this.gridView,Rb=this.Ya.text,qc=0,Oc=this.dh.he,jb=!1;if(0===zc||2===zc||3===zc||7===zc)Mb+=Rb.substr(0,this.T2a)+this.dh.he,0!==zc||this.dh.he.endsWith(")")||(Mb+="("),cc=Mb.toString().length,Mb+=Rb.substr(this.r$b),2===zc&&(qc=4,Oc="DefinedName",jb=!0,this.set_visible(!1));else if(1===zc)if(this.Iia=!0,this.Wja){Mb+=Rb.substr(0,
this.u3+2);!Mb.toString().endsWith(He.a.BU)&&ma.EwaSettings.ma(136)&&(Mb+=He.a.BU);qc=this.dh.he;qc=qc.replace("'","''");qc=qc.replace("[","'[");qc=qc.replace("]","']");if(this.q5c||this.Lyh(qc))qc=He.a.Dri+qc+He.a.gij,jb=!0;Mb+=qc;cc=Mb.length;qc=3;yc.a("PulloutFieldAccepted")}else return this.Ya.text=this.dh.he,this.set_visible(!1),Uc.Ao(!1),Uc.focus(),this.Mjc("FieldName",1,1,1),yc.a("TableHeaderAutoCompleteSuggestionAccepted"),!0;else if(5===zc)Ma.ULS.sendTraceTag(537162048,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableSpecialStructRef listbox item"),
Mb+=Rb.substr(0,this.Pdb),Kc.a.equals(this.dh.he,"@ - "+this.instantaneousSupportInformationManager.xe.ThisRowStructRefString,!1)?Mb+="@":(Mb+=this.dh.he,jb=!0,this.set_visible(!1)),cc=Mb.length;else if(4===zc){Ma.ULS.sendTraceTag(575776009,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableColHeaderName listbox item}");Mb+=Rb.substr(0,this.Pdb);jb="";cc=!1;for(var Eb=[39,91,93,64,35],nc=0;nc<this.dh.he.length;nc++){var $c=this.dh.he.charCodeAt(nc);Array.contains(Eb,$c)&&(jb+="'");jb+=
this.dh.he.charAt(nc).toString();cc||Kc.a.isNumeral($c)||Kc.a.Idf($c)||(cc=!0)}Eb=this.gridView.sj?this.Ztb.$P:this.xpb.$P;Rb=ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?"@"===Rb.charAt(Eb+1)&&cc:Rb.lastIndexOf(va.Bjf)+1>=Rb.lastIndexOf("[")&&cc;Mb+=Rb?"["+jb+"]":jb;jb=!0;this.set_visible(!1);cc=Mb.toString().length}else if(6===zc)Mb+=Rb.substr(0,this.lsb);else return Ma.ULS.sendTraceTag(537162019,0,10,"Autocomplete item type was not set on AutoComplete ListBox"),
!1;this.Ya.text=Mb;this.Ya.textBox.caretPosition=cc;this.Ya.Ywa()&&(null===(Bb=Uc.Gr)||void 0===Bb?0:Bb.zua)&&Uc.Gr.KJb(this.Ya.text,this.Ya.textBox.caretPosition,this.Ya.textBox.caretPosition,this.Ya.textBox.jv.length);Uc.sj&&(Bb=Uc.Wb,Bb.text=this.Ya.text,Bb.setCaretPosition(this.Ya.textBox.caretPosition));Oc=(null==this.Iia?0:this.Iia)?"FieldName":Oc;this.dh.Pk.sectionRowIndex>=this.dh.kW.length?this.Mjc(Oc,4,qc,0):this.Mjc(Oc,1,qc,0);jb||(5===zc||4===zc?this.Bre():this.Ynb());return!0};f.prototype.qZ=
function(Bb,zc){Bb=void 0===Bb?null:Bb;zc=void 0===zc?null:zc;Bb?(this.Jg.vbb(),this.Jg.qZ(Bb,!1,!1,zc)):(Bb=this.gridView,Bb.ha.sa.tg&&(Bb=Ac.v(Bb.ha.sa.Vc,this.$),this.Jg.qZ(Bb,!0,!0,zc)))};f.prototype.Fma=function(){this.vfa=!1;this.Ya.EHe()};f.prototype.cPh=function(Bb){Bb=this.calcManager.getWorksheetFuncId(Bb);return this.KUe?this.KUe.descriptionsMap.get(Bb):null};f.prototype.nCe=function(Bb){if(this.Rii()){if(this.Jg.U5a&&this.Jg.Hk&&(!this.Jg.Hk.length||!this.Jg.Hk[0].FieldInfoDataList))return;
this.$Pj(Bb)}Bb=dd.asEnumerable(this.iGa);Bb=dd.concat(Bb,this.ZQh(this.Ya.text));ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5501880_NamedObjectAutoCompleteDropdown")&&this.Dk&&(Bb=dd.concat(Bb,this.fSh()));dd.OBc(Bb,function(zc){return zc.name},new h.a);this.IAa&&(Bb=dd.concat(dd.asEnumerable(this.aSa),Bb),ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&(0<this.aSa.length&&(this.JAa=!0),this.aSa=[]));this.k8=dd.toArray(Bb)};f.prototype.n$g=function(){var Bb=
this.Ya.text;if(ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing")){var zc=this.gridView.sj?this.Ztb.PHa:this.xpb.PHa,Mb=!0;if(ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5962126_tableColHeadersListJSCrashFix")){if(""!==zc&&(this.qg=Object(Bc.a)(ne.a,this.$.vb.getItemByName(zc))),this.qg||(this.qg=this.tableManager.qg,Mb=!1),!this.qg){Ma.ULS.sendTraceTag(527234895,0,50,"FormulaAssistanceControl.createTableColHeaderAutoCompleteList - current table object is null. Total number of named objects in workbook: %d. Is target table name empty? %d",
this.$.vb.count,""===zc);return}}else this.qg=Object(Bc.a)(ne.a,this.$.vb.getItemByName(zc)),this.qg||(this.qg=this.tableManager.qg,Mb=!1);this.qg.sO&&this.qg.sO.IsFullTableHeaders?this.FGf(Mb):Hc.d(this.qg)?(Ma.ULS.sendTraceTag(537162017,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Getting column headers for table with xluid - %s",this.qg.Ei),Qd.p(this.$.oa.xa,this.qg.Ei,this.nMi,this.mMi,null,null)):Ma.ULS.sendTraceTag(537162018,0,15,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Table with xluid %s has header rows turned off.",
this.qg.Ei)}else if(this.calcManager&&this.tableManager.qg)if(zc=this.calcManager.e4a(this.tableManager.qg))if(this.calcManager.HIg(this.tableManager.qg,zc)){Bb=dd.empty();if(91===this.Ya.text.charCodeAt(this.Ya.text.length-1)){var cc=this.w0a("@ - "+this.instantaneousSupportInformationManager.xe.ThisRowStructRefString);Bb=dd.concat(Bb,(Mb=new Ee.a,Mb.add(cc),Mb))}Bb=dd.concat(Bb,dd.select(dd.asEnumerable(zc.toArray()),function(Uc){var Rb=new fa,qc=new A;qc._name=Uc.toString();Rb.r_f(qc);return Rb}));
this.k8=dd.toArray(Bb)}else Bb.endsWith("[")&&"["!==Bb.charAt(Bb.length-2)&&Ma.ULS.sendTraceTag(572381130,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns partial table header data with {0} columns for a table with id {1} of size {2}",zc.count,this.tableManager.qg.Ei,this.tableManager.qg.usedRange.right-this.tableManager.qg.usedRange.left+1);else Bb.endsWith("[")&&"["!==Bb.charAt(Bb.length-2)&&Ma.ULS.sendTraceTag(573149408,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns null inside a table during table column header autocomplete list creation")};
f.prototype.Lyh=function(Bb){if(!Bb)return!1;var zc=Bb.charCodeAt(0);if(46===zc||48<=zc&&57>=zc||63===zc)return!0;for(var Mb=0;Mb<Bb.length;Mb++,zc=Bb.charCodeAt(Mb))if(!((ma.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?Kc.a.isLetter(zc):Kc.a.jod(zc))||92===zc||95===zc||63===zc||48<=zc&&57>=zc))return!0;return!1};f.prototype.mCd=function(Bb,zc){var Mb=!1,cc=!1,Uc=!1,Rb=0,qc=0;this.T2a=0;this.r$b=zc;this.a5b=1;for(var Oc=zc-1;0<=Oc;--Oc)switch(Bb.charCodeAt(Oc)){case 39:cc=
!cc;break;case 34:Mb=!Mb;break;case 91:++Rb;Uc=Rb>qc;break;case 93:++qc}Uc=Object(Fd.a)(new M,{Esa:!Mb,Fsa:!cc,Iha:!Uc,tFb:1});Rb=this.GWi(Bb,zc,Uc);zc=this.HWi(Bb,zc,Uc.Esa,Uc.Fsa,Uc.Iha);this.a5b=Rb+zc;if(this.cQc=Rb-1)this.Xwc=!1;this.Azh(Bb,Mb,cc,Uc.LBd,Uc.MBd)};f.prototype.Zkd=function(){4!==this.zCb&&(this.mzb?this.gridView.$b.Bk(this.Gh):this.gridView.ha.Fga(this.Rsf));var Bb=wc.a.ayb()?this.Pq.Ub(null):void 0;this.YNa(Bb);wc.a.lfc&&this.gridView.Ki.nYa(this.Y5);f.BLd(this.pluginScheduler);
this.IAa&&this.FWg()};f.prototype.Xxh=function(){return this.IAa||this.pRe};f.prototype.IWi=function(){var Bb=this.o5;if(!this.Wwj||!Bb)return this.u3=0,this.iGa=this.k8=null,!1;Bb=Bb.endsWith(He.a.BU);var zc;if(zc=ma.EwaSettings.ma(136)){zc=this.vNj(this.o5.substring(0,this.v3));var Mb=zc.sheetRange;zc=zc.returnValue}return zc&&(zc=this.o5.substring(0,this.u3),Bb&&zc!==this.ard)?(this.ard=zc,this.u3=this.o5.length-(Bb?1:0),this.qZ(Mb,this.o5),this.Iia=!1,Ma.ULS.sendTraceTag(537162015,0,50,"Begin dot notation autocomplete"),
!0):!1};f.prototype.ZQh=function(Bb){var zc=new Ee.a;this.calcManager&&ma.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")&&Ma.ULS.shipAssertTag(537162014,0,!!this.calcManager.Tsa(Ye.Range.Tc(1,1)),"FormulaAssistanceControl.GetLetVariables() - ConvertToSheetGridCell() is null");if(this.calcManager&&this.pRe&&(Bb=this.calcManager.extractLetVariables(Bb,this.Ya.textBox.caretPosition))){Bb=ak(Bb);for(var Mb=Bb.next();!Mb.done;Mb=Bb.next()){var cc=Mb.value;Mb=new B;Mb._name=
cc;Mb.q9=gb.a.instance.ga(2187);cc=new fa;cc.Qqj(Mb);zc.add(cc)}}return zc};f.prototype.fSh=function(){for(var Bb=new Ee.a,zc=this.$.vb.items,Mb=0,cc=zc.length;Mb<cc;Mb++){var Uc=zc[Mb];if(pe.n(Uc)){var Rb=new v;Rb._name=Uc.name;Uc=new fa;Uc.gtj(Rb);Bb.add(Uc)}}return Bb};f.prototype.w0a=function(Bb){var zc=new fa,Mb=new r;Mb._name=Bb;zc.htj(Mb);return zc};f.prototype.FGf=function(Bb){var zc=new Ee.a,Mb=this.Ya.text.charCodeAt(this.Ya.text.length-1),cc=this.Ya.textBox.caretPosition-1;if(ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?
91===this.Ya.text.charCodeAt(cc):91===Mb){var Uc=this.w0a("@ - "+this.instantaneousSupportInformationManager.xe.ThisRowStructRefString);zc.add(Uc)}Uc=ak(this.qg.sO.HeadersList);for(var Rb=Uc.next();!Rb.done;Rb=Uc.next()){Rb=Rb.value;var qc=new fa,Oc=new A;Oc._name=Rb.Name;qc.r_f(Oc);zc.add(qc)}Uc=this.gridView.sj?this.Ztb.$P:this.xpb.$P;Rb=this.Ya.text.charCodeAt(Uc+1);(ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?!Bb||cc!==Uc&&35!==Rb:!Bb||91!==
Mb&&35!==Mb)||(Bb=this.w0a("#"+this.instantaneousSupportInformationManager.xe.AllStructRefString),zc.add(Bb),Bb=this.w0a("#"+this.instantaneousSupportInformationManager.xe.DataStructRefString),zc.add(Bb),Bb=this.w0a("#"+this.instantaneousSupportInformationManager.xe.HeadersStructRefString),zc.add(Bb),Bb=this.w0a("#"+this.instantaneousSupportInformationManager.xe.TotalsStructRefString),zc.add(Bb));zc&&(this.k8=zc.toArray())};f.prototype.$Pj=function(Bb){var zc=dd.empty();!Bb&&this.functionInfoManager.XZ&&
(zc=dd.concat(zc,dd.select(dd.asEnumerable(this.functionInfoManager.q$b),function(Mb){var cc=new fa;cc.UYf(Mb);return cc})),Bb=this.P5b.hGe,0<Bb.length&&(zc=dd.OBc(dd.concat(zc,dd.select(dd.asEnumerable(Bb),function(Mb){var cc=new fa;cc.opj(Mb);return cc})),function(Mb){return Mb.name},new h.a)));if(this.Jg.U5a&&this.Jg.Hk){if(!this.Jg.Hk.length||!this.Jg.Hk[0].FieldInfoDataList)return;zc=dd.OBc(dd.concat(zc,dd.select(dd.asEnumerable(this.Jg.Hk[0].FieldInfoDataList),function(Mb){var cc=new fa;cc.Opj(Mb);
return cc})),function(Mb){return Mb.name},new h.a);this.columnName=this.Jg.Hk[0].ColumnName}this.iGa=dd.toArray(zc)};f.prototype.YNa=function(Bb){var zc;if(1!==this.zCb){var Mb=this.gridView.ha.sa.activeCell;if(Mb){var cc=this.calcManager.Tsa(Mb,!this.Cmd);if(cc){var Uc=this.$.va,Rb=cc.sheet.index;0>=Uc.count||0>Rb||Rb>=Uc.count||(Rb=Uc=null,this.xxd&&void 0!==this.calcManager&&null!==this.calcManager&&(Bb=null!==(zc=null===Bb||void 0===Bb?void 0:Bb.cell)&&void 0!==zc?zc:this.gridView.Ea.Mr(Mb))&&
(zc=this.calcManager.vbc(Bb.Xk),void 0!==zc&&null!==zc&&(Uc=zc.FormatString,Rb=zc.Builtin)),2!==this.zCb&&this.pluginScheduler.notifier().setActiveCell({colIndex:cc.range.col,rowIndex:cc.range.row,sheetIndex:this.$.va.getItem(cc.sheet.index).sheetId,docName:cc.sheet.document.name,docPath:cc.sheet.document.path,formatString:Uc,builtIn:Rb}))}}}};f.prototype.PUf=function(){this.formulaAssistanceTelemetryManager.k_={sk:this.gridView.ha.sa.activeCell,ypb:this.gridView.Wb.text,nqb:!0};this.formulaAssistanceTelemetryManager.eBb=
this.$.ea.Ve;this.formulaAssistanceTelemetryManager.jjc=this.$.va.pa.sheetId;this.$.userOperationManager.Cr(this.uOa)};f.prototype.FWg=function(){this.gridView.sj?this.Ztb.dU(!1):this.xpb.dU(!1)};f.prototype.qhf=function(Bb){var zc=ma.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?Kc.a.isLetter(Bb):Kc.a.jod(Bb);return 48<=Bb&&57>=Bb||46===Bb||95===Bb||zc};f.prototype.show=function(){if(this.It){var Bb=this.dh.hdg(0);this.Dk?0<this.dh.pq.length?
Bb||this.t3f():this.i1a():((Bb=0<this.dh.pq.length)&&this.formulaAssistanceTelemetryManager.oO(["autoCompleteRender"]),!this.isListVisible&&this.columnName&&Bb&&this.dh.F3i(this.dh.pq.length,this.columnName),this.isListVisible=Bb,this.Wia.show(this.ZP),this.xBa(!0),this.dh.Qxa(),Bb&&this.formulaAssistanceTelemetryManager.jQ(["autoCompleteRender"]))}};f.prototype.HWi=function(Bb,zc,Mb,cc,Uc){for(Mb=Object(Fd.a)(new M,{hEf:41,Sye:40,Esa:Mb,Fsa:cc,Iha:Uc});zc<Bb.length&&!this.eFf(Bb,zc,Mb);++zc);return Mb.tFb};
f.prototype.GWi=function(Bb,zc,Mb){for(--zc;0<=zc&&!this.eFf(Bb,zc,Mb);--zc);return Mb.tFb};f.prototype.eFf=function(Bb,zc,Mb){var cc=Bb.charCodeAt(zc);0>=this.v3&&(this.v3=Bb.substring(0,zc).lastIndexOf(He.a.BU));46===cc&&(zc<this.v3?this.v3=zc:zc>this.lsb&&(this.u3=this.lsb=zc));if(!this.qhf(cc)&&!f.ooi(cc)&&(!this.Wja||zc<=this.v3||!f.I7h(cc,Mb))){Mb.hvf&&(Mb.hvf=!1,this.T2a=zc+1);if(Mb.nAd){Mb.MBd=zc+1;if(this.functionInfoManager.Ldd(Bb.substring(Mb.MBd,Mb.LBd)))return!0;Mb.nAd=!1}switch(cc){case 39:Mb.Fsa=
!Mb.Fsa;break;case 34:Mb.Esa=!Mb.Esa;break;case 91:Mb.Iha=!1;break;case 93:Mb.Iha=!0}cc===this.$.listSeparator.toString().charCodeAt(0)&&Mb.Fsa&&Mb.Esa&&!Mb.H_a&&(!this.Wja||Mb.Iha)&&(zc<Mb.pMd||-1===Mb.pMd)&&(Mb.tFb+=1,this.a5b++);cc===Mb.Sye&&Mb.Esa&&Mb.Fsa&&(!this.Wja||Mb.Iha)?Mb.H_a+=1:cc===Mb.hEf&&Mb.Esa&&Mb.Fsa&&(!this.Wja||Mb.Iha)?0<Mb.H_a?--Mb.H_a:(Mb.pMd=Mb.XSe,Mb.XSe=zc,0<zc&&this.qhf(Bb.charCodeAt(zc-1))&&(Mb.nAd=!0,Mb.LBd=zc)):this.Wja&&46===cc&&zc>this.v3&&(zc<this.v3?this.v3=zc:zc>this.lsb&&
(this.u3=this.lsb=zc))}return!1};f.prototype.Azh=function(Bb,zc,Mb,cc,Uc){this.r$b>this.T2a&&0<=this.T2a?zc||Mb||(this.EV=Bb.substring(this.T2a,this.r$b)):this.EV=null;cc!==Uc?(Bb=Bb.substring(Uc,cc),this.ZP&&Kc.a.equals(this.ZP.NameDataStrings,Bb,!0)||(this.Xwc=!0),this.ZP=this.functionInfoManager.Ldd(Bb)):(this.Xwc=!1,this.ZP=null)};f.prototype.L6f=function(Bb){var zc=$get(va.ZEf+"_"+va.sFb,this.domElement),Mb=$get(va.$Ef+"_"+va.sFb,this.domElement);Bb&&!this.vdc?(zc&&se.a.instance.qa(ue.a.click,
zc,this.qca),Mb&&se.a.instance.qa(ue.a.click,Mb,this.qca),this.vdc=!0):this.vdc&&(zc&&se.a.instance.Aa(ue.a.click,zc,this.qca),Mb&&se.a.instance.Aa(ue.a.click,Mb,this.qca),this.vdc=!1)};f.prototype.vNj=function(Bb){var zc=this;var Mb=null;var cc;if(function(){var Oc=Ac.Z(Bb,zc.$.ea.va);Rb=Oc.sheetName;cc=Oc.range;return Oc}().returnValue&&cc){if(!Rb){var Uc=Object(Bc.a)(Xa.a,this.$.pa);if(!Uc)return{returnValue:!1,sheetRange:Mb};var Rb=Uc.name}Mb=Ac.v(cc,this.$);Mb.SheetName=Rb;this.q5c=!1;return{returnValue:!0,
sheetRange:Mb}}var qc=null;return function(){var Oc=zc.P5b.eNj(Bb);Rb=Oc.sheetName;qc=Oc.range;return Oc}().returnValue?(Mb=Ac.v(qc,this.$),Mb.SheetName=Rb,this.q5c=!0,{returnValue:!0,sheetRange:Mb}):{returnValue:!1,sheetRange:Mb}};f.prototype.zLd=function(Bb){Bb={content:Bb,isCellContentOnlyEqualDuringEdit:this.isCellContentOnlyEqualDuringEdit};this.rba?this.pluginScheduler.getRequester().runAuthoringExperiment(Bb,0):this.pluginScheduler.requester().runAuthoringExperiment(Bb)};f.prototype.fkd=function(){if(1===
this.dh.kW.length&&this.It.length){var Bb=this.It[this.dh.kW[0]];if(1===Bb.itemType){var zc=Bb.name;Bb=this.Ya.text;zc=zc.substring(Bb.length,zc.length);zc.length&&(this.Ya.text=Bb+zc,this.Ya.textBox.selectRange(Bb.length,this.Ya.text.length))}}else Ma.ULS.shipAssertTag(537162007,0,!1,"InCellAutoComplete should only be called when there is 1 item (number of items: {0})",this.dh.kW.length)};f.prototype.Mjc=function(Bb,zc,Mb,cc){var Uc={};Uc.a=Bb;Uc.b=zc;Uc.c=Mb;Uc.d=cc;Tb.b().De(38,Uc,!0)};f.prototype.Are=
function(Bb,zc){if(!this.functionInfoManager.XZ){if(Bb)if(this.mCd(this.Ya.text,this.Ya.textBox.caretPosition),this.IAa||this.EV){var Mb={};Mb.Filter=this.EV?this.EV.charAt(0).toString():"";Mb.FilterType=1;Mb.IncludeOneOfEachGroupUI=!1;this.functionInfoManager.L1a(Mb)}else ma.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")&&this.get_visible()&&this.set_visible(!1);if(!zc)return}0<this.$.ob.uR||this.Ya&&!this.Ya.isEditing?this.set_visible(!1):Bb&&(this.mCd(this.Ya.text,
this.Ya.textBox.caretPosition),this.Wia.update(this.ZP,this.a5b,this.cQc,this.Xwc),this.o5=this.Ya.text.substring(1,this.Ya.textBox.caretPosition),this.v3=this.o5.indexOf(He.a.BU),this.u3=this.o5.lastIndexOf(He.a.BU),this.IWi()?(Bb=new fa,Bb.Frj(),this.iGa=this.k8=Bb=[Bb],this.dh.ZRj(Bb),this.show()):((this.Xxh()||this.Cwa())&&this.nCe(!1),0<this.u3?this.dh.aJa(this.It,this.o5,!1,void 0,this.o5.lastIndexOf(He.a.BU),!1):this.dh.aJa(this.It,this.EV,!1,void 0,this.u3,!1),this.show(),this.Dk&&(this.dh.pq.length||
this.gridView.Ki.CK?this.Wia.$rb():(this.Wia.VJd(),this.Dk&&this.i1a()))))};f.prototype.t3f=function(){var Bb=this;if(0<this.dh.pq.length){this.formulaAssistanceTelemetryManager.oO(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){var zc={};zc.zoomLevel=ba(this.$);this.formulaAssistanceUIControl.updateContext(zc);this.Jq=function(){Bb.formulaAssistanceUIControl.renderAutoCompleteMenu(Bb.b0b,Bb.gridView.Ki.textBox.domElement,Bb.Hdd())};this.Jq();this.Dk&&this.dh.Rhc&&this.raiseEvent(f.ebd,
null);this.Wld||this.dh.Rhc||this.raiseEvent("FormulaAutoCompleteShown");this.Wld=this.fr.canReceiveFocus=!0;this.ocf&&this.formulaAssistanceTelemetryManager.Y8e(this.dh.a3b)}this.formulaAssistanceTelemetryManager.jQ(["autoCompleteRender"]);!ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&void 0!==this.aSa&&null!==this.aSa&&0<this.aSa.length&&(this.JAa=!0)}};f.prototype.ctd=function(){this.hIa&&(this.formulaAssistanceTelemetryManager.tY.selectByArrowKeyCounter++,
this.hIa=!1);this.iIa&&(this.formulaAssistanceTelemetryManager.tY.selectByMouseHoverCounter++,this.iIa=!1);this.gIa&&(this.formulaAssistanceTelemetryManager.tY.commitByTabKeyCounter++,this.gIa=!1);this.eIa&&(this.formulaAssistanceTelemetryManager.tY.commitByEnterKeyCounter++,this.eIa=!1);this.fIa&&(this.formulaAssistanceTelemetryManager.tY.commitByMouseClickCounter++,this.fIa=!1)};f.prototype.Hdd=function(){var Bb=new n;Bb.completionItems=this.dh.a3b;Bb.activeItemIndex=this.dh.Pk?this.dh.Pk.rowIndex:
-1;this.mHd(Bb);return Bb};f.prototype.mHd=function(Bb){Bb.callbacks=new z;Bb.callbacks.onCompletionItemSelected=this.Wyd;Bb.callbacks.onCompletionItemCommitted=this.Vyd;Bb.callbacks.onFeedback=this.VQa;Bb.callbacks.onDismiss=this.onDismiss;Bb.callbacks.onRestoreFocus=ma.EwaSettings.isChangeGateEnabled("OfficeVSO:6178649_FixFormulaBarFocusBug")?this.onRestoreFocus:void 0};f.prototype.WDd=function(Bb){this.vfa=!0;var zc=Bb.textEdit.newText;this.Ya.kdb(zc.substring(this.Ya.text.length-Bb.textEdit.range.start.character,
zc.length))};f.prototype.Wze=function(){this.Ny(!0);this.vfa=this.isListVisible=!1;this.bSa=this.cSa=!0};f.prototype.lld=function(Bb,zc){this.Ya.text=Bb.substring(0,zc.range.start.character)+zc.newText+Bb.substring(zc.range.end.character,Bb.length);this.gridView.sj&&(this.gridView.Wb.text=this.Ya.text)};f.BLd=function(Bb){ma.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUse")?Bb.getRequester().runExperiment(new w,0):Bb.requester().runExperiment(new w)};f.x2g=function(Bb){var zc=
fa.X9g(),Mb={IsCompatibility:!1};Mb.NameDataStrings=Bb.label;Mb.Help=Bb.detail;zc.UYf(Mb);zc.textEdit=Bb.textEdit;return zc};f.xJa=function(){var Bb=String.format(va.oEh,va.vbd,ef.a.RMe),zc=String.format(va.jEh,va.tbd,Ie.a.C8c,Hb.a.No,Hb.a.Lp),Mb=String.format(va.gEh,va.pbd,Ie.a.C8c,Hb.a.No,Ie.a.JNe,Hb.a.Lp);return String.format("{0}\r\n{1}\r\n{2}",Bb,zc,Mb)};f.ooi=function(Bb){return 36===Bb||58===Bb||33===Bb||39===Bb||32===Bb};f.I7h=function(Bb,zc){return 32===Bb||91===Bb||!zc.Iha};Af.Object.defineProperties(f.prototype,
{Jt:{configurable:!0,enumerable:!0,get:function(){return this.dh}},It:{configurable:!0,enumerable:!0,get:function(){return this.k8}},CJb:{configurable:!0,enumerable:!0,get:function(){return this.dh.he}},DUe:{configurable:!0,enumerable:!0,get:function(){return this.dh}},gUe:{configurable:!0,enumerable:!0,get:function(){return this.Wia}},dh:{configurable:!0,enumerable:!0,get:function(){return this.Aog}},A0a:{configurable:!0,enumerable:!0,get:function(){return this.IAa?this.Ya?this.Ya.text:null:this.EV}},
isListVisible:{configurable:!0,enumerable:!0,get:function(){return this.Jt.isListVisible},set:function(Bb){this.Dk&&!Bb&&this.i1a();this.Jt.isListVisible=Bb}},tableManager:{configurable:!0,enumerable:!0,get:function(){return this.Zwg}},Wja:{configurable:!0,enumerable:!0,get:function(){return 0<this.u3}},AH:{configurable:!0,enumerable:!0,get:function(){return this.vfa}},gridView:{configurable:!0,enumerable:!0,get:function(){return this.gii?this.Pq:bb.g(this.$)}},Ab:{configurable:!0,enumerable:!0,get:function(){return this.gridView.Ab}},
N_b:{configurable:!0,enumerable:!0,get:function(){return this.f1d}},u3:{configurable:!0,enumerable:!0,get:function(){return this.vIe},set:function(Bb){this.vIe=Bb;Bb||(this.v3=0)}},Wwj:{configurable:!0,enumerable:!0,get:function(){if(null==this.lpc){var Bb=this.$.ic;this.lpc=!!Bb&&!Bb.inEmbedView}return this.lpc}},qWf:{configurable:!0,enumerable:!0,get:function(){return this.dh.a3b[this.dh.Pk.rowIndex]}},KUe:{configurable:!0,enumerable:!0,get:function(){!this.wbd&&this.pluginScheduler&&(this.wbd=
this.pluginScheduler.getFunctionsShortDescriptions());return this.wbd}}});f.ebd="FACardOpened";f.Bad="FAFocusOnSmartSuggestionsCard";f.Bjd=null;Object(La.a)(f,"FormulaAssistanceControl",qe.a,[525,526,10,527,528]);var yd=Wd.a;Rk(m,yd);m.prototype.Fme=function(Bb){this.addHandler("FAFunctionNameUpdated",Bb)};m.prototype.FPf=function(Bb){this.removeHandler("FAFunctionNameUpdated",Bb)};m.prototype.wne=function(Bb){this.addHandler("FAParameterSelectionChangedOld",Bb)};m.prototype.bQf=function(Bb){this.removeHandler("FAParameterSelectionChangedOld",
Bb)};m.prototype.vne=function(Bb){this.addHandler("FAParameterSelectionChanged",Bb)};m.prototype.aQf=function(Bb){this.removeHandler("FAParameterSelectionChanged",Bb)};m.prototype.qEg=function(Bb){this.addHandler("DC",Bb)};m.prototype.Laj=function(Bb){this.removeHandler("DC",Bb)};m.prototype.dismiss=function(){this.Hv=!1;this.formulaAssistanceUIControl&&(this.Jq=null,this.RQ&&this.QG.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.Qka=null,this.fr.canReceiveFocus=!1)};m.prototype.show=
function(Bb,zc){var Mb=this;this.Hv=!0;var cc=this.FDd(Bb);this.formulaAssistanceUIControl&&(this.formulaAssistanceTelemetryManager.oO(["argumentAssistanceRender"]),Bb={},Bb.zoomLevel=ba(this.$),this.formulaAssistanceUIControl.updateContext(Bb),ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5470368_FormulaAssistanceScroll")?(this.Jq=function(){Mb.formulaAssistanceUIControl.renderArgumentAssistanceCard(Mb.domElement,zc,cc)},this.Jq()):this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,
zc,cc),this.JCd(cc),this.RQ&&this.QG.ka(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.Jq,function(){return Mb.formulaAssistanceUIControl.dismiss(Mb.domElement)}),this.fr.canReceiveFocus=!0,this.formulaAssistanceTelemetryManager.jQ(["argumentAssistanceRender"]),this.formulaAssistanceTelemetryManager.B7b("argumentAssistanceOverall"))};m.prototype.dispose=function(){if(this.$){var Bb=bb.g(this.$);Bb&&(Bb.ha&&Bb.ha.EF(this.Rc),Bb.view.Iq(this.$s),
this.RQ&&Bb.$b.Nl(this.Df))}$a.a.Ia(this.fr);this.$=null};m.prototype.FDd=function(Bb){var zc=new O;zc.functionRenderingInfo=Bb;zc.cardMode=this.y2;this.oHd(zc);return zc};m.prototype.oHd=function(Bb){Bb.callbacks=new N;Bb.callbacks.onHelpLink=this.Vdd(Bb.functionRenderingInfo);Bb.callbacks.onCardModeChange=this.onCardModeChange;Bb.callbacks.onFeedback=this.VQa;this.I4&&(Bb.callbacks.onDismissClick=this.onDismissClick)};m.prototype.Vdd=function(Bb){var zc=this;return function(){ya(zc.$,Bb.helpID,
Bb.isUDF)}};m.prototype.cOd=function(){var Bb=Gd.a.get(yb.a.B_b);this.y2=Bb?parseInt(Bb,10):m.f5c;this.formulaAssistanceTelemetryManager.AXf(this.y2)};m.prototype.JCd=function(Bb){var zc=Bb.functionRenderingInfo.functionName;this.Qka&&Kc.a.equals(this.Qka,zc,!0)?(zc=jd.a.map(Bb.functionRenderingInfo.signatures,function(Mb){var cc="";0<=Mb.signatureParams.activeParam&&Mb.signatureParams.activeParam<Mb.signatureParams.params.length&&(cc=Mb.signatureParams.params[Mb.signatureParams.activeParam]);return cc}),
this.raiseEvent("FAParameterSelectionChanged",new ea(zc))):(this.Qka=zc,Bb=jd.a.map(Bb.functionRenderingInfo.signatures,function(Mb){return Mb.signatureParams.params.join(", ")}),this.raiseEvent("FAFunctionNameUpdated",new ka(zc,Bb)))};m.prototype.NNb=function(Bb){this.y2=Bb;try{Gd.a.mv(yb.a.B_b,Bb.toString(),Sd.AFrame.jea)}catch(zc){Ma.ULS.sendTraceTag(537162074,0,15,"Failed setting ArgumentAssistanceCardCollapseState cookie with error message: {0}",zc.message)}};m.xJa=function(){return document.createElement("div")};
Af.Object.defineProperties(m.prototype,{visible:{configurable:!0,enumerable:!0,get:function(){return this.Hv},set:function(Bb){Bb||this.dismiss();this.Hv=Bb}}});m.f5c=0;Object(La.a)(m,"FormulaArgumentAssistanceControl",Wd.a,[567]);var Dd;(function(Bb){Bb[Bb.Dismissed=0]="Dismissed";Bb[Bb.Smart=1]="Smart";Bb[Bb.Simple=2]="Simple";Bb[Bb.Mixed=3]="Mixed"})(Dd||(Dd={}));Object(La.b)("UIState",Dd);var qd=Wd.a;Rk(l,qd);l.prototype.Dme=function(Bb){this.addHandler("FACardOpened",Bb)};l.prototype.EPf=function(Bb){this.removeHandler("FACardOpened",
Bb)};l.prototype.Bme=function(Bb){this.addHandler("FAFocusOnSmartSuggestionsCard",Bb)};l.prototype.CPf=function(Bb){this.removeHandler("FAFocusOnSmartSuggestionsCard",Bb)};l.prototype.Cme=function(Bb){this.addHandler("FormulaAutoCompleteShown",Bb)};l.prototype.DPf=function(Bb){this.removeHandler("FormulaAutoCompleteShown",Bb)};l.prototype.WUc=function(Bb){this.addHandler("SelectedRowChanged",Bb)};l.prototype.QId=function(Bb){this.removeHandler("SelectedRowChanged",Bb)};l.prototype.iZb=function(Bb){this.addHandler("ListBoxUpdated",
Bb)};l.prototype.zsc=function(Bb){this.removeHandler("ListBoxUpdated",Bb)};l.prototype.dispose=function(){if(this.$){var Bb=bb.g(this.$);this.x9&&(this.$.userOperationManager.wo(this.tca),this.$.userOperationManager.wo(this.uOa));Bb&&(Bb.ha&&Bb.ha.EF(this.Rc),Bb.$b&&this.Ryb&&Bb.$b.Nl(this.Df),Bb.view.Iq(this.$s));this.$.va&&this.$.va.wg(this.wh)}$a.a.Ia(this.fr);this.$=null};l.prototype.dEg=function(Bb){this.addHandler("CVIC",Bb)};l.prototype.xaj=function(Bb){this.removeHandler("CVIC",Bb)};l.prototype.Kh=
function(Bb,zc){if(!this.visible)return!1;this.bBc(zc);var Mb;return(Mb=this.d3h(zc)).adc?Mb.result:this.Bwj(zc)};l.prototype.iwb=function(Bb){if(!this.visible)return!1;var zc=!1;switch(Bb){case 1872288872:this.AH&&this.Fma();this.visible=!1;zc=!0;break;case -798660877:this.Yeb(this.Pvb(this.VW+1));zc=!0;break;case 137938150:this.Yeb(this.Pvb(this.VW-1));zc=!0;break;case 2091832999:this.Yeb(this.Pvb(this.VW+8));zc=!0;break;case 742457698:this.Yeb(this.Pvb(this.VW-8));zc=!0;break;case 125627505:case 267796030:this.lqb(this.It.items[this.VW]),
zc=!0}return zc};l.prototype.show=function(Bb){this.Ya=bb.g(this.$).Ki;this.Hv=!0;this.VW=0;this.It=Bb;0<this.It.items.length&&(this.render(),this.Yeb(this.Pvb(this.VW)),1===this.It.items[0].type&&this.Ryb&&(this.JAa=!0));this.formulaAssistanceTelemetryManager.Y8e(Bb.items)};l.prototype.Fma=function(){this.vfa=!1;this.Ya.EHe()};l.prototype.Bwj=function(Bb){return[1872288872,-798660877,137938150,2091832999,742457698,125627505,267796030].includes(Bb)};l.prototype.d3h=function(Bb){return this.AH?125627505===
Bb||267796030===Bb?(this.lqb(this.It.items[this.VW]),{adc:!0,result:!1}):!this.VDf||-798660877!==Bb&&137938150!==Bb?{adc:!1}:{adc:!0,result:!1}:{adc:!1}};l.prototype.render=function(){var Bb=this;this.formulaAssistanceTelemetryManager.oO(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){var zc={};zc.zoomLevel=ba(this.$);this.formulaAssistanceUIControl.updateContext(zc);this.Jq=function(){Bb.formulaAssistanceUIControl.renderAutoCompleteMenu(Bb.domElement,Bb.Ya.textBox.domElement,Bb.Hdd())};
this.Jq();this.u3i();this.fr.canReceiveFocus=!0;this.formulaAssistanceTelemetryManager.jQ(["autoCompleteRender"]);this.formulaAssistanceTelemetryManager.B7b("autoCompleteOverall")}};l.prototype.u3i=function(){var Bb=this.BNb;this.BNb=this.AZh(this.It.items);Bb!==Dd.Dismissed&&Bb!==Dd.Smart||this.BNb!==Dd.Simple&&this.BNb!==Dd.Mixed||this.raiseEvent("FormulaAutoCompleteShown")};l.prototype.X3i=function(){var Bb;if(this.hji&&0!==this.It.items.length){var zc=0<=this.VW?this.VW:0,Mb=this.It.items[zc];
Mb={OF:Mb.label,description:null!==(Bb=Mb.detail)&&void 0!==Bb?Bb:"",selectedIndex:zc+1,length:this.It.items.length};this.raiseEvent("SelectedRowChanged",Mb)}};l.prototype.lqb=function(Bb){if(this.Ya&&this.visible){var zc=Bb.textEdit;this.lld(this.Ya.text,zc);this.Ya.textBox.caretPosition=zc.range.start.character+zc.newText.length;this.AH&&(this.vfa=!1,this.Ryb&&(this.bSa=this.cSa=!0),this.x9&&this.Vqj(),this.Ya.endEdit(!0,"FormulaAutoCompleteControl.CommitAutoCompletion",0));this.visible=!1;this.raiseEvent("CVIC",
{shouldRequestAutocompleteOnCommit:Bb.shouldRequestAutocompleteOnCommit});this.formulaAssistanceTelemetryManager.X8e(Bb.kind)}};l.prototype.Vqj=function(){var Bb=bb.g(this.$);this.formulaAssistanceTelemetryManager.k_={sk:Bb.ha.sa.activeCell,ypb:Bb.Wb.text,nqb:!0};this.formulaAssistanceTelemetryManager.jjc=this.$.va.pa.sheetId;this.formulaAssistanceTelemetryManager.eBb=this.$.ea.Ve;this.$.userOperationManager.Cr(this.uOa)};l.prototype.tIg=function(){this.JAa&&(this.formulaAssistanceTelemetryManager.xM.smartSuggestionShownCounter++,
this.JAa=!1);this.cSa&&(this.formulaAssistanceTelemetryManager.xM.smartSuggestionSelectedCounter++,this.cSa=!1);this.bSa&&(this.formulaAssistanceTelemetryManager.xM.smartSuggestionCommittedCounter++,this.bSa=!1)};l.prototype.Hdd=function(){var Bb=new n;Bb.completionItems=this.It.items;Bb.activeItemIndex=this.VW;this.mHd(Bb);return Bb};l.prototype.mHd=function(Bb){Bb.callbacks=new z;Bb.callbacks.onCompletionItemSelected=this.Wyd;Bb.callbacks.onCompletionItemCommitted=this.Vyd;Bb.callbacks.onFeedback=
this.VQa;Bb.callbacks.onDismiss=this.eJi;Bb.callbacks.onRestoreFocus=ma.EwaSettings.isChangeGateEnabled("OfficeVSO:6178649_FixFormulaBarFocusBug")?this.onRestoreFocus:void 0};l.prototype.WDd=function(Bb){this.vfa=!0;var zc=Bb.textEdit.newText;this.Ya.kdb(zc.substring(this.Ya.text.length-Bb.textEdit.range.start.character,zc.length))};l.prototype.Yeb=function(Bb){var zc=this.VW;this.VW=Bb;var Mb=this.It.items[Bb];this.AH&&this.Fma();zc!==Bb&&this.render();1===Mb.type&&ma.EwaSettings.tb()&&!bb.g(this.$).Ki.text.includes("\n")&&
this.WDd(Mb);this.X3i()};l.prototype.Pvb=function(Bb){return 0>Bb?0:Math.min(Bb,this.It.items.length-1)};l.prototype.lld=function(Bb,zc){this.Ya.text=Bb.substring(0,zc.range.start.character)+zc.newText+Bb.substring(zc.range.end.character,Bb.length);bb.g(this.$).sj&&(bb.g(this.$).Wb.text=this.Ya.text)};l.prototype.ctd=function(){this.hIa&&(this.formulaAssistanceTelemetryManager.tY.selectByArrowKeyCounter++,this.hIa=!1);this.iIa&&(this.formulaAssistanceTelemetryManager.tY.selectByMouseHoverCounter++,
this.iIa=!1);this.gIa&&(this.formulaAssistanceTelemetryManager.tY.commitByTabKeyCounter++,this.gIa=!1);this.eIa&&(this.formulaAssistanceTelemetryManager.tY.commitByEnterKeyCounter++,this.eIa=!1);this.fIa&&(this.formulaAssistanceTelemetryManager.tY.commitByMouseClickCounter++,this.fIa=!1)};l.prototype.bBc=function(Bb){switch(Bb){case -798660877:case 137938150:case 2091832999:case 742457698:this.hIa=!0;break;case 125627505:this.gIa=!0;break;case 267796030:this.eIa=!0}};l.xJa=function(){return document.createElement("div")};
l.prototype.AZh=function(Bb){return Bb.reduce(function(zc,Mb){return zc|=0===Mb.type?Dd.Simple:Dd.Smart},Dd.Dismissed)};Af.Object.defineProperties(l.prototype,{visible:{configurable:!0,enumerable:!0,get:function(){return this.Hv},set:function(Bb){Bb||this.dismiss();this.Hv=Bb}},AH:{configurable:!0,enumerable:!0,get:function(){return this.vfa}},VDf:{configurable:!0,enumerable:!0,get:function(){return 1===this.It.items.length&&1===this.It.items[0].type}}});Object(La.a)(l,"FormulaAutoCompleteControl",
Wd.a,[566,10,527]);var xe=b(978);k.prototype.getRichValueFieldListContext=function(Bb,zc,Mb,cc){var Uc={j$:Bb,wIe:zc},Rb;if(Rb=Object(xe.b)(this.Grd))Rb=this.Grd,Rb=!(Uc.j$.FirstRow===Rb.j$.FirstRow&&Uc.j$.FirstColumn===Rb.j$.FirstColumn&&Uc.j$.LastRow===Rb.j$.LastRow&&Uc.j$.LastColumn===Rb.j$.LastColumn&&Uc.j$.SheetName===Rb.j$.SheetName&&Uc.wIe===Rb.wIe);Rb&&this.Jg.vbb();this.Grd=Uc;this.WBj&&this.Jg.U5a||this.Jg.qZ(Bb,Mb,cc,zc);this.e9b=new xe.a;this.Jg.U5a?this.e9b.resolve(this.Jg.Hk):this.U7i();
return this.e9b.promise};k.prototype.dispose=function(){var Bb,zc;null===(zc=null===(Bb=bb.g(this.$))||void 0===Bb?void 0:Bb.$b)||void 0===zc?void 0:zc.Nl(this.Df)};k.prototype.U7i=function(){this.Jg.aZb(this.kya);this.Jg.OEg(this.Vwf)};k.prototype.yag=function(){this.Jg.rsc(this.kya);this.Jg.dbj(this.Vwf)};Object(La.a)(k,"ServerDataProvider",null,[565]);e.prototype.j2h=function(Bb,zc,Mb){return isNullOrUndefined(this.coloredReferencesManager)?!1:this.coloredReferencesManager.SWd(Bb,zc,Mb)};Af.Object.defineProperties(e.prototype,
{coloredReferencesManager:{configurable:!0,enumerable:!0,get:function(){this.LUa||(this.LUa=this.$.da.za(281));return this.LUa}}});Object(La.a)(e,"FormulaHighlightsControl",null,[]);var Ge=b(1188);d.prototype.dispose=function(){if(this.$){var Bb=this.gridView;Bb&&(Bb.ha&&wc.a.rV()&&(this.mzb?Bb.$b.wk(this.Gh):Bb.ha.Gma(this.Fh)),this.nef&&Bb.Ea&&Bb.Ea.fv(this.Ai))}this.l2&&this.gridView.$b.Nl(this.Df);this.I4&&(this.l2||this.gridView.$b.Nl(this.Df),this.Tpa.Laj(this.otf));this.G8.xaj(this.wtf);this.functionInfoManager&&
this.functionInfoManager.Xab(this.onFunctionInfoLoaded);wc.a.lfc&&this.Ya&&this.Ya.LHb(this.Y5);$a.a.Ia(this.Tpa);$a.a.Ia(this.G8);this.G8=this.Tpa=this.functionInfoManager=this.$=null};d.prototype.zfj=function(){this.XMa=-1;this.Rka=null};d.prototype.s6b=function(){this.G8.visible=!1;this.Tpa.visible=!1};d.prototype.Kh=function(){this.nda();return!1};d.prototype.nda=function(){if(!this.Ya.CK)if(this.formulaAssistanceTelemetryManager.pob.formulaAssistanceRequestAttemptedCounter++,this.mxj()){this.functionInfoManager.XZ||
(this.functionInfoManager.qYa(this.onFunctionInfoLoaded),this.functionInfoManager.L1a({}));var Bb=this.Ya,zc=Bb.text;Bb=Bb.textBox.caretPosition;this.l2&&zc.startsWith("=")&&(this.GLa=!0,1===zc.length&&(this.isCellContentOnlyEqualDuringEdit=!0));!this.I4||this.GRa?(this.formulaAssistanceTelemetryManager.oO(["argumentAssistanceComputation","autoCompleteComputation","argumentAssistanceOverall","autoCompleteOverall"]),this.GWf(zc,Bb)):(this.formulaAssistanceTelemetryManager.oO(["autoCompleteComputation",
"autoCompleteOverall"]),this.ifj(zc,Bb));ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutoCompleteWrapperPluginRequest",!1)&&this.hfj(zc,Bb)}else this.formulaAssistanceTelemetryManager.pob.formulaAssistanceRequestOptimizedCounter++};d.prototype.GWf=function(Bb,zc){var Mb=this;Bb=this.pluginScheduler.batchRequester().functionSuggestionAndArgumentAssistance({functionSuggestion:{content:Bb,caretPosition:zc},argumentAssistance:{content:Bb,caretPosition:zc}});this.fW+=1;Bb.then(function(cc){--Mb.fW;
0===cc.kind&&(Mb.g4e(cc.payload.argumentAssistance),Mb.K4e(cc.payload.functionSuggestion));return null})};d.prototype.ifj=function(Bb,zc){var Mb=this;Bb={content:Bb,caretPosition:zc};Bb=this.rba?this.pluginScheduler.getRequester().functionSuggestion(Bb,0):this.pluginScheduler.requester().functionSuggestion(Bb);this.fW+=1;Bb.then(function(cc){--Mb.fW;0===cc.kind&&Mb.K4e(cc.payload);return null})};d.prototype.hfj=function(Bb,zc){var Mb=this;Bb={content:Bb,caretPosition:zc,enableAutocompleteWrapperPlugin:this.Xwa&&
!this.T4&&"="===Bb};this.rba&&(Bb=this.pluginScheduler.getRequester().runPerCharacterExperiment(Bb,0),this.fW+=1,Bb.then(function(cc){--Mb.fW;if(0===cc.kind){cc=ak(cc.payload.results);for(var Uc=cc.next();!Uc.done;Uc=cc.next())Uc=Uc.value,0===Uc.kind&&(Uc=Uc.value.items,0<Uc.length&&Mb.gridView.Pta.iOd("="+Uc[0].textEdit.newText))}return null}))};d.prototype.VJd=function(Bb,zc){var Mb=this;Bb={content:Bb,caretPosition:zc};Bb=this.rba?this.pluginScheduler.getRequester().argumentAssistance(Bb,0):this.pluginScheduler.requester().argumentAssistance(Bb);
this.fW+=1;Bb.then(function(cc){--Mb.fW;0===cc.kind&&Mb.g4e(cc.payload)})};d.prototype.mxj=function(){var Bb=this.Ya,zc=Bb.text;Bb=Bb.textBox.caretPosition;if(this.G8.visible&&Kc.a.equals(zc,this.Rka,!0)&&(!this.whi||!xb.e(zc))&&Bb===this.XMa)return!1;this.Rka=zc;this.XMa=Bb;return!0};d.prototype.BLd=function(){this.rba?this.pluginScheduler.getRequester().runExperiment(new w,0):this.pluginScheduler.requester().runExperiment(new w)};d.prototype.g4e=function(Bb){Bb&&this.Ya.isEditing?(this.formulaAssistanceTelemetryManager.jQ(["argumentAssistanceComputation"]),
this.Tpa.show(Bb,this.Ya.textBox.domElement)):this.Tpa.dismiss()};d.prototype.K4e=function(Bb){var zc;Bb&&0<Bb.items.length&&this.Ya.isEditing&&(!ma.EwaSettings.isChangeGateEnabled("OfficeVSO:6487912_SmartSuggestionFix")||this.Ya.text===this.Rka)?this.KXc&&this.Ab.c5(this.gridView.ha.sa.activeCell)?(this.formulaAssistanceTelemetryManager.xM.smartSuggestionWouldSuggestInsidePivotCounter++,this.G8.dismiss()):(this.formulaAssistanceTelemetryManager.jQ(["autoCompleteComputation"]),this.G8.show(Bb)):this.G8.dismiss();
this.Xwa&&"="===this.Rka&&0<(null===(zc=null===Bb||void 0===Bb?void 0:Bb.items)||void 0===zc?void 0:zc.length)&&1===Bb.items[0].type&&this.gridView.Pta.iOd("="+Bb.items[0].textEdit.newText)};d.prototype.zLd=function(Bb){Bb={content:Bb,isCellContentOnlyEqualDuringEdit:this.isCellContentOnlyEqualDuringEdit};this.rba?this.pluginScheduler.getRequester().runAuthoringExperiment(Bb,0):this.pluginScheduler.requester().runAuthoringExperiment(Bb)};d.prototype.YNa=function(Bb){var zc,Mb=this.gridView.ha.sa.activeCell;
if(Mb){var cc=this.calcManager.Tsa(Mb,!this.Cmd);if(cc){var Uc=this.$.va,Rb=cc.sheet.index;0>=Uc.count||0>Rb||Rb>=Uc.count||(Rb=Uc=null,this.xxd&&void 0!==this.calcManager&&null!==this.calcManager&&(Bb=null!==(zc=null===Bb||void 0===Bb?void 0:Bb.cell)&&void 0!==zc?zc:this.gridView.Ea.Mr(Mb))&&(zc=this.calcManager.vbc(Bb.Xk),void 0!==zc&&null!==zc&&(Uc=zc.FormatString,Rb=zc.Builtin)),this.pluginScheduler.notifier().setActiveCell({colIndex:cc.range.col,rowIndex:cc.range.row,sheetIndex:this.$.va.getItem(cc.sheet.index).sheetId,
docName:cc.sheet.document.name,docPath:cc.sheet.document.path,formatString:Uc,builtIn:Rb}))}else Ma.ULS.sendTraceTag(537162002,0,50,"FormulaAssistanceManager.NotifyActiveCellChanged ISheetGridCell location is null")}};d.prototype.ZSj=function(){this.pluginScheduler.notifier().setFunctionsInfo(this.functionInfoManager.q$b)};d.prototype.Zkd=function(){this.mzb?this.gridView.$b.Bk(this.Gh):this.gridView.ha.Fga(this.Fh);var Bb=wc.a.ayb()?this.gridView.Ub(null):void 0;this.YNa(Bb);wc.a.lfc&&this.Ya.nYa(this.Y5);
this.BLd();this.G8.dEg(this.wtf);this.pluginScheduler.setServerDataProvider(new k(this.Jg,this.$));this.nda()};d.prototype.SWd=function(Bb,zc,Mb){Mb=Object(xe.b)(zc)?this.Idd(zc,Object(xe.b)(Mb)?Mb:Ge.a):this.Idd(Bb.text,Bb.textBox.selection);return this.sDh.j2h(Bb,zc,Mb)};Af.Object.defineProperties(d.prototype,{Yia:{configurable:!0,enumerable:!0,get:function(){return this.G8}},fUe:{configurable:!0,enumerable:!0,get:function(){return this.Tpa}},Ya:{configurable:!0,enumerable:!0,get:function(){return this.gridView.Ki}},
Ab:{configurable:!0,enumerable:!0,get:function(){return this.gridView.Ab}}});Object(La.a)(d,"FormulaAssistanceManager",null,[524,10]);b(259);var Xe=Pc.a;Rk(c,Xe);c.prototype.create=function(){var Bb=this,zc=wc.a.rV(),Mb=ma.EwaSettings.ma(374),cc=ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1),Uc=wc.a.WZ(this.$),Rb=this.$.da,qc=mb.GetServiceTaskFactory.create(Rb,134,this.la,this.hb),Oc=mb.GetServiceTaskFactory.Ra(this.$.da,12,477,this.hb);var jb=wc.a.J4()?mb.GetServiceTaskFactory.create(this.$.da,
449,this.$.la,1):oa.Task.Ua(null);var Eb=wc.a.rV()?mb.GetServiceTaskFactory.create(this.$.da,414,this.$.la,1):oa.Task.Ua(null);if(cc||zc){var nc=mb.GetServiceTaskFactory.Ra(Rb,266,265,this.hb),$c=mb.GetServiceTaskFactory.Ra(Rb,219,220,this.hb),od=mb.GetServiceTaskFactory.Ra(Rb,491,492,this.hb);fb.TaskExtensions.Ba(fb.TaskExtensions.Wd([nc,Eb,jb,$c,od],this.la),function(){var ze=Rb.za(19)||new ca(Bb.$,Eb.result),Xd=$c.result;if(Uc){var te=Rb.za(464);te||(te=new d(Bb.$,ze,nc.result,Eb.result,jb.result,
od.result,Oc.result.S2c(Bb.$,qc.result)),Xd.RWc(te.fUe),Xd.SWc(te.Yia),ma.EwaSettings.isChangeGateEnabled("OfficeVSO:6312266_RedesignListBoxEvents")&&Xd.TWc(te.Yia))}else te=Rb.za(221),te||(te=new f(Bb.$,ze,qc.result,nc.result,null,Oc.result,jb.result,od.result,Eb.result),Xd.RWc(te.gUe),Xd.TWc(te.DUe),Xd.SWc(te)),Mb&&(Rb.za(317)||new ha(Bb.$));Bb.pb(ze)},this.la,3)}else{var de=mb.GetServiceTaskFactory.Ra(Rb,219,220,this.hb),ae=mb.GetServiceTaskFactory.Ra(Rb,491,492,this.hb);fb.TaskExtensions.Ba(fb.TaskExtensions.Wd([de,
jb,Eb],this.la),function(){var ze=Rb.za(19)||new ca(Bb.$,Eb.result),Xd=de.result,te=Rb.za(221);te||(te=new f(Bb.$,ze,qc.result,null,null,Oc.result,jb.result,ae.result,Eb.result),Xd.RWc(te.gUe),Xd.TWc(te.DUe),Xd.SWc(te));Mb&&(Rb.za(317)||new ha(Bb.$));Bb.pb(ze)},this.la,3)}};c.ka=function(Bb){Bb.da.Ga(153,new c(Bb))};Object(La.a)(c,"FunctionInfoManagerFactory",Pc.a,[]);b.d(D,"a",function(){return a})},1356:function(u,D,b){function a(){x.a.Fa(c.ka)}function c(W){return va.call(this,W)||this}function d(){}
function e(W,La,Ia,mb){var fb=sa.call(this,W)||this;fb.OCb=null;fb.Vkc=null;fb.Lec=null;fb.a3=null;fb.lka=!1;fb.disposed=!1;fb.IMa=!1;fb.Ph=null;fb.$yd=function(Ma){G.ULS.sendTraceTag(537163269,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback");if(fb.disposed)G.ULS.sendTraceTag(537163268,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback: Callback not handled since dialog was already disposed");else{if(F.a(Ma)){G.ULS.sendTraceTag(537163267,0,15,
"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - request has expected errors: {0}.",Ma?ta.a.Dc(Ma.Errors):null);if(Ma.Errors&&1===Ma.Errors.length){var Hb=Ma.Errors[0].MessageId,Kb=fb.Tcd(Hb);if(Kb){fb.jyj(Hb)?fb.ztj(Kb):fb.qr(Kb);fb.Xka("OkInvalidByServer",Ma.Errors[0].MessageIdName);return}}G.ULS.sendTraceTag(537163266,0,15,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: {0}",ta.a.Dc(Ma.Errors))}fb.Xka("OkValid",
"None");fb.hide()}};fb.F4c=function(Ma){fb.BW(Ma);2!==Ma&&(fb.Ph=fb.$.Fb.sc("UserAction","DataValidationEditTimeToDialogTryClose"));1===Ma?fb.G9a():2===Ma?fb.iya():fb.Gla()};fb.rca=function(){fb.yQj();fb.IMa?fb.lye():fb.O_c();return fb.lka=!1};fb.selectedRanges=La;fb.HRb=Ia;fb.command=mb;3===mb&&(fb.lka=!0);fb.Rb=2;fb.Av=!1;fb.Wf=r.Wf;return fb}function k(W,La){this.options=this.cellRange=null;this.cellRange=W;this.options=La}function l(W,La){var Ia=ra.call(this,W)||this;Ia.H9=null;Ia.gha=null;Ia.QTa=
null;Ia.J9=null;Ia.I9=null;Ia.fnc=function(){Ia.H9.checked?(Ia.gha.disabled=!1,Ia.QTa.disabled=!1,Ia.J9.disabled=!1,Ia.I9.disabled=!1):(Ia.gha.disabled=!0,Ia.QTa.disabled=!0,Ia.J9.disabled=!0,Ia.I9.disabled=!0);return!1};Ia.get_visible=Ia.Gja;Ia.set_visible=Ia.tna;Ia.vk=La;Ia.Zja();return Ia}function m(W,La){var Ia=Ea.call(this,W)||this;Ia.eba=null;Ia.j$e=null;Ia.gba=null;Ia.fba=null;Ia.gnc=function(){Ia.eba.checked?(Ia.gba.disabled=!1,Ia.fba.disabled=!1):(Ia.gba.disabled=!0,Ia.fba.disabled=!0);return!1};
Ia.get_visible=Ia.Gja;Ia.set_visible=Ia.tna;Ia.vk=La;Ia.Zja();return Ia}function f(){}function w(W,La,Ia,mb){var fb=Ka.call(this,W)||this;fb.Etb=null;fb.rMd=null;fb.lka=!1;fb.disposed=!1;fb.IMa=!1;fb.Ph=null;fb.mVj=function(Ma,Hb){fb.zac(Ma);var Kb=fb.YYd();Ma=Kb.errorString;var Ub=Kb.oq;if(Kb.returnValue)return fb.sLa(121,fb.bMh(fb.$,Hb),0,fb.Y4,!1),"";fb.Xka("OkInvalidByClient",Ub);return Ma};fb.F4c=function(Ma){fb.BW(Ma);fb.Ph=fb.$.Fb.sc("UserAction","DataValidationEditTimeToDialogTryClose");0===
Ma&&fb.Gla()};fb.selectedRanges=La;fb.HRb=Ia;fb.command=mb;3===mb&&(fb.lka=!0);fb.Rb=2;fb.Av=!1;return fb}function n(W,La,Ia,mb,fb,Ma,Hb,Kb){Kb=W.Na(9,void 0===Kb?null:Kb);Kb.selectedRanges=La;Kb.ruleOptions=Ia;return xa.g(W,"CreateOrEditDataValidation",Kb,mb,fb,Ma,Hb,0)}function z(W,La,Ia){var mb=da.call(this,La)||this;mb.Tva=null;mb.lec=null;mb.HT=null;mb.uK=null;mb.Gya=null;mb.Hya=null;mb.i5a=null;mb.lNa=null;mb.$9a=null;mb.NOa=null;mb.Joc=null;mb.GBd=null;mb.jBh=[[12,12,12,12,12,12,12,12],[0,
0,2,2,0,1,0,1],[0,0,2,2,0,1,0,1],[3,3,3,3,3,3,3,3],[5,5,7,7,5,6,5,6],[8,8,10,10,8,9,8,9],[0,0,11,11,0,1,0,1],[4,4,4,4,4,4,4,4]];mb.ilj=[[12,12],[1,1],[1,1],[12,12],[6,6],[9,9],[1,1],[12,12]];mb.enc=function(fb){var Ma=!1;(null===fb||void 0===fb?0:fb.Ca)&&(fb.Ca.keyCode===qa.a.Eoa||fb.Ca.keyCode===qa.a.Rh)&&(Ma=mb.rca(fb),mb.HT.blur(),mb.uK.blur());return Ma};mb.rca=function(){var fb=mb.HT.selectedIndex,Ma=mb.uK.selectedIndex;mb.Joc.innerText=mb.Wub(fb,Ma);mb.GBd.innerText=mb.Dfd(fb,Ma);switch(fb){case 0:return mb.uK.disabled=
!0,Qa.DOMElementExtensions.setVisible(mb.$9a,!1),Qa.DOMElementExtensions.setVisible(mb.NOa,!1),Qa.DOMElementExtensions.setVisible(mb.i5a,!1),Qa.DOMElementExtensions.setVisible(mb.lNa,!1),mb.Tva.disabled=!0,!1;case 3:return mb.uK.disabled=!0,Qa.DOMElementExtensions.setVisible(mb.$9a,!0),Qa.DOMElementExtensions.setVisible(mb.NOa,!1),Qa.DOMElementExtensions.setVisible(mb.i5a,!0),Qa.DOMElementExtensions.setVisible(mb.lNa,!0),mb.Tva.disabled=!1;case 7:return mb.uK.disabled=!0,Qa.DOMElementExtensions.setVisible(mb.$9a,
!0),Qa.DOMElementExtensions.setVisible(mb.NOa,!1),Qa.DOMElementExtensions.setVisible(mb.i5a,!1),Qa.DOMElementExtensions.setVisible(mb.lNa,!1),mb.Tva.disabled=!1;default:mb.Tva.disabled=!1,Qa.DOMElementExtensions.setVisible(mb.$9a,!0),Qa.DOMElementExtensions.setVisible(mb.lNa,!1)}switch(Ma){case 0:case 1:Qa.DOMElementExtensions.setVisible(mb.NOa,!0);break;default:Qa.DOMElementExtensions.setVisible(mb.NOa,!1)}mb.uK.disabled=!1;mb.Joc.disabled=!1;Qa.DOMElementExtensions.setVisible(mb.i5a,!1);Qa.DOMElementExtensions.setVisible(mb.lNa,
!1);return!1};mb.get_visible=mb.Gja;mb.set_visible=mb.tna;mb.bR=new ia.a;mb.bR.add(S.a.instance.ga(1652));mb.bR.add(S.a.instance.ga(1653));mb.bR.add(S.a.instance.ga(1656));mb.bR.add(S.a.instance.ga(1654));mb.bR.add(S.a.instance.ga(1655));mb.bR.add(S.a.instance.ga(1657));mb.bR.add(S.a.instance.ga(1658));mb.bR.add(S.a.instance.ga(1659));mb.bR.add(S.a.instance.ga(1660));mb.bR.add(S.a.instance.ga(1661));mb.bR.add(S.a.instance.ga(1662));mb.bR.add(S.a.instance.ga(1663));mb.bR.add("");mb.$=W;mb.vk=Ia;mb.Zja();
return mb}function r(){}function v(W,La){var Ia=this;this.IB=this.P0a=this.selectedRanges=null;this.aJe=!1;this.Ph=null;this.UKi=function(mb){G.ULS.sendTraceTag(537163284,0,50,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback");!mb||F.a(mb)?G.ULS.sendTraceTag(537163283,0,10,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback, failed to get expected results."):(Ia.P0a=mb.Result,Ia.S_i())};this.mxh=function(mb){Ia.BW("DataValidationEdit.ExpandExisitngDialog",
mb);Ia.IB.c=v.fia(mb);1===mb?Ia.sHa(new A(Ia.P0a)):2===mb?Ia.sHa(new A):Ia.gmf()};this.SVi=function(mb){Ia.BW("DataValidationEdit.OverrideExisitngDialog",mb);Ia.IB.c=v.fia(mb);1===mb?Ia.sHa(new A):Ia.gmf()};this.$=W;this.G4c=La}function A(W){this.U4=(W=void 0===W?null:W)?W.IsIgnoreBlank:!0;this.V4=W?W.IsInCellDropDown:!0;this.CN=W?W.LowerBoundary:"";this.DN=W?W.UpperBoundary:"";this.xB=W?W.ConditionType:0;this.ruleType=W?W.RuleType:0;this.QZ=W?W.IsAlertBlocking:!0;this.DT=W?W.AlertTitle:"";this.BT=
W?W.AlertMessage:"";this.nV=W?W.InputMessage:"";this.$E=W?W.InputTitle:"";this.i5=W?W.IsShowErrorAlert:!0;this.j5=W?W.IsShowInputMessage:!0}function B(W){switch(W){case 0:W="AnyValue";break;case 1:W="WholeNumber";break;case 2:W="Decimal";break;case 3:W="List";break;case 4:W="Date";break;case 5:W="Time";break;case 6:W="TextLength";break;case 7:W="Custom";break;default:W="Unknown"}return W}function y(W){switch(W){case 0:W="Between";break;case 1:W="NotBetween";break;case 2:W="Equal";break;case 3:W="NotEqual";
break;case 4:W="GreaterThan";break;case 5:W="LessThan";break;case 6:W="GreaterThanOrEqual";break;case 7:W="LessThanOrEqual";break;default:W="Unknown"}return W}var x=b(11);u=b(0);var C=b(905),G=b(15),E=b(133),I=b(45),U=b(389),M=b(177),T=b(258);A.prototype.isEqual=function(W){return W?this.U4===W.U4&&this.V4===W.V4&&this.CN===W.CN&&this.DN===W.DN&&this.xB===W.xB&&this.ruleType===W.ruleType&&this.QZ===W.QZ&&this.DT===W.DT&&this.BT===W.BT&&this.nV===W.nV&&this.$E===W.$E&&this.i5===W.i5&&this.j5===W.j5:
(G.ULS.shipAssertTag(537163233,0,!1,"DataValidationEditDialogState.IsEqual: State should not be Null"),!1)};Object(u.a)(A,"DataValidationEditDialogState",null,[]);var F=b(296),K=b(186),J=b(295),O=b(21),N=b(134),H=b(50),Q=b(58);v.prototype.Lc=function(){return!1};v.prototype.executeCommand=function(W,La){-1728432249!==La.command&&K.a(La.command);this.selectedRanges=I.r(O.g(this.$).ha.sa.selectedRanges,this.$);O.g(this.$).RRa(!0);this.getDataValidationInitialState();this.Ph=this.$.Fb.sc("UserAction",
"DataValidationEditTimeToDialogOpen");this.aJe?G.ULS.sendTraceTag(537163285,0,50,"Open data validation edit dialog - NOT first time in session"):(G.ULS.sendTraceTag(23667778,0,50,"Open data validation edit dialog - FIRST time in session"),this.aJe=!0);return Q.Task.Ua(!0)};v.prototype.Ac=function(W,La){return-1728432249===La.command};v.prototype.Qc=function(){return!1};v.prototype.getDataValidationInitialState=function(){var W=this,La=this.$.oa.xa.Pb();U.a(this.$.userOperationManager,function(Ia,
mb,fb){return T.f(W.$.oa.xa,W.selectedRanges,J.b(Ia,W.UKi),J.a(mb),fb,La)},function(Ia){return new M.a(120,0,Ia,16)},null)};v.prototype.S_i=function(){var W=this.IB={};switch(this.P0a.Command){case 0:var La="CreateNew";break;case 1:La="CreateNewFromRule";break;case 2:La="ExpandExisitng";break;case 3:La="OverrideExisitng";break;default:La="Unknown"}W.a=La;this.Ph&&(this.Ph.stop(),this.IB.r=this.Ph.id);switch(this.P0a.Command){case 0:this.IB.b=!1;this.IB.c="None";this.sHa(new A);break;case 1:this.IB.b=
!1;this.IB.c="None";this.sHa(new A(this.P0a));break;case 2:this.IB.b=!0;this.G4c.m4g(this.$,this.mxh);break;case 3:this.IB.b=!0;this.G4c.o4g(this.$,this.SVi);break;default:G.ULS.sendTraceTag(537163282,0,10,"DataValidationEditCommandHandler.PrepareUserDialog, unexpected command type.")}};v.prototype.sHa=function(W){this.G4c.sHa(this.$,this.selectedRanges,W,this.P0a.Command);this.zwi(W)};v.prototype.zwi=function(W){v.Xrb(W,this.IB);this.IB.d=!0;H.b().De(48,this.IB,!0)};v.prototype.gmf=function(){this.IB.d=
!1;H.b().De(48,this.IB,!0)};v.prototype.BW=function(W,La){var Ia={};W=(Ia.ButtonType=v.fia(La),Ia.DialogName=W,Ia.Location="dialog",Ia.NumberOfSelectedRanges=O.g(this.$).ha.sa.sK,Ia);N.b(this.$).Cd(E.a.d6b,W)};v.Xrb=function(W,La){La.e=B(W.ruleType);La.f=y(W.xB);La.g=!!W.CN;La.h=!!W.DN;La.i=W.U4;La.j=W.V4;La.k=W.j5;La.l=!!W.$E;La.m=!!W.nV;La.n=W.i5;La.o=W.QZ;La.p=!!W.DT;La.q=!!W.BT};v.fia=function(W){switch(W){case 1:return"Yes";case 2:return"No";case 0:return"Cancel";default:return G.ULS.shipAssertTag(537163281,
0,!1,"DataValidationEditCommandHandler.DialogButtonToString: Unknown DialogButton"),"Unknown"}};Object(u.a)(v,"DataValidationEditCommandHandler",null,[403]);var ca=b(135),X=b(1011),Z;(function(W){W[W.between=0]="between";W[W.notBetween=1]="notBetween";W[W.equal=2]="equal";W[W.notEqual=3]="notEqual";W[W.greaterThan=4]="greaterThan";W[W.lessThan=5]="lessThan";W[W.greaterThanOrEqual=6]="greaterThanOrEqual";W[W.lessThanOrEqual=7]="lessThanOrEqual"})(Z||(Z={}));Object(u.b)("DataValidationRuleConditionType",
Z);var ea;(function(W){W[W.anyValue=0]="anyValue";W[W.wholeNumber=1]="wholeNumber";W[W.decimal=2]="decimal";W[W.list=3]="list";W[W.date=4]="date";W[W.time=5]="time";W[W.textLength=6]="textLength";W[W.custom=7]="custom"})(ea||(ea={}));Object(u.b)("DataValidationRuleType",ea);var ka=b(150),Y=b(180);Af.Object.defineProperties(r,{Wf:{configurable:!0,enumerable:!0,get:function(){return ka.a.Po(r.rk,"")}},Aeh:{configurable:!0,enumerable:!0,get:function(){return ka.a.Po(r.Eeh,Y.a.ga(1650),Y.a.ga(1665),Y.a.ga(1666),
Y.a.ga(1667),Y.a.ga(1668),Y.a.ga(1669),Y.a.ga(1670),Y.a.ga(1671),Y.a.ga(1672),Y.a.ga(1651),Y.a.ga(1675),Y.a.ga(1676),Y.a.ga(1677),Y.a.ga(1678),Y.a.ga(1679),Y.a.ga(1680),Y.a.ga(1681),Y.a.ga(1682),Y.a.ga(1652),Y.a.ga(1653),Y.a.ga(1673),Y.a.ga(1674),Y.a.ga(1664),"255")}},Heh:{configurable:!0,enumerable:!0,get:function(){return ka.a.Po(r.Feh,Y.a.ga(1687),Y.a.ga(1691),Y.a.ga(1692),"255","32")}},Leh:{configurable:!0,enumerable:!0,get:function(){return ka.a.Po(r.Geh,Y.a.ga(1686),Y.a.ga(1689),Y.a.ga(1688),
Y.a.ga(1690),Y.a.ga(1691),Y.a.ga(1692),"255","32")}}});r.q8f=255;r.rk="<div class='WACDialogRow' id='dataValidationTabsId'> </div> <div class='DataValidationEditErrorMessage WACDialogRowNoBreak' id='ErrorContainer'> <label id='validationErrorMessageId' class='WACDialogLabel' role='alert' >{0}</label> </div>";r.Eeh="<div class='DataValidationEditTabContent' id='ConditionDivID'> <div class='DataValidationRow' id='allowConditionRow'> <label id='allowConditionSelectionLabelId' class='DataValidationEditElementLabel' for='allowConditionSelectionId'>{0}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='allowConditionSelectionId'> <option value='0'>{1}</option> <option value='1'>{2}</option> <option value='2'>{3}</option> <option value='3'>{4}</option> <option value='4'>{5}</option> <option value='5'>{6}</option> <option value='6'>{7}</option> <option value='7'>{8}</option> </select> </div> <div class='DataValidationRow' id='operatorSelectionDivId'> <label id='operatorSelectionLabelId' class='DataValidationEditElementLabel' for='operatorSelectionId'>{9}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='operatorSelectionId'> <option value='0'>{10}</option> <option value='1'>{11}</option> <option value='2'>{12}</option> <option value='3'>{13}</option> <option value='4'>{14}</option> <option value='5'>{15}</option> <option value='6'>{16}</option> <option value='7'>{17}</option> </select> </div> <div class='DataValidationRow' id='operatorInputDivId1'> <label id='operatorInputLableId1' class='DataValidationEditElementLabel' for='operatorInputId1'>{18}</label> <input type='text' id='operatorInputId1' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='operatorInputDivId2'> <label id='operatorInputLableId2' class='DataValidationEditElementLabel' for='operatorInputId2'>{19}</label> <input type='text' id='operatorInputId2' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationNonBorderRow' id='listDescriptionDivId'> <div id='listDescriptionDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='listDescriptionSubDivID'> <label id='listDescriptionLabelId' class='DataValidationEditLabel' for='listDescriptionSubDivID'>{20}</label> </div> </div> <div class='DataValidationNonBorderRow' id='ignoreBlankCheckboxDivID'> <div id='ignoreBlankCheckboxDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='ignoreBlankCheckboxSubDivID'> <input type='checkbox' id='ignoreBlankCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{21}'></input> <label id='\"\"' class='WACDialogLabel' for='ignoreBlankCheckBoxId' >{21}</label> </div> </div> <div class='DataValidationNonBorderRow' id='inCellDropdownDivId'> <div id='inCellDropdownDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='inCellDropdownSubDivId'> <input type='checkbox' id='inCellDropdownCheckboxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{22}'></input> <label id='\"\"' class='WACDialogLabel' for='inCellDropdownCheckboxId' >{22}</label> </div> </div> </div>";
r.Feh="<div class='DataValidationEditTabContent' id='inputDivID'> <div class='DataValidationNonBorderRow' id='inputMessageCheckBoxDivID'> <label id='showInputCheckBoxLabelId' class='DataValidationEditElementLabel' for='showInputCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='inputMessageCheckBoxSubDivID'> <input type='checkbox' id='showInputCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='inputTitleDivID'> <label id='inputTitleLabelId' class='DataValidationEditElementLabel' for='textForInputTitleId'>{1}</label> <input type='text' id='textForInputTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={4} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='inputMessageDivID'> <label id='inputMessageLabelId' class='DataValidationEditElementLabel' for='textForInputMessageId'>{2}</label> <textarea id='textForInputMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={3} autocomplete=\"off\"></textarea> </div> </div>";
r.Geh="<div class='DataValidationEditTabContent' id='alertDivID'> <div class='DataValidationNonBorderRow' id='showAlertCheckBoxDivID'> <label id='showAlertCheckBoxLabelId' class='DataValidationEditElementLabel' for='showAlertCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='showAlertCheckBoxSubDivID'> <input type='checkbox' id='showAlertCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='blockWarnRadioDivID'> <label id='blockWarnRadioLabelId' class='DataValidationEditElementLabel' for='blockWarnRadioSubDivID'>{1}</label> <div class='DataValidationEditRadio DataValidationEditNoBorderElement' id='blockWarnRadioSubDivID'> <input type='radio' id='blockingId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{2}' title='{2}'></input> <label id='blockingId' class='WACDialogLabel' for='blockingId' >{2}</label> <input type='radio' id='warningId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{3}' title='{3}'></input> <label id='blockingId' class='WACDialogLabel' for='warningId' >{3}</label> </div> </div> <div class='DataValidationRow' id='alertTitleDivID'> <label id='alertTitleLabelId' class='DataValidationEditElementLabel' for='textForAlertTitleId'>{4}</label> <input type='text' id='textForAlertTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={7} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='alertMessageDivID'> <label id='alertMessageLabelId' class='DataValidationEditElementLabel' for='textForAlertMessageId'>{5}</label> <textarea id='textForAlertMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={6} autocomplete=\"off\"></textarea> </div> </div>";
Object(u.a)(r,"DataValidationEditDialogHtml",null,[]);var qa=b(86),fa=b(617),ha=b(13),ia=b(202),wa=b(244),Qa=b(12),S=b(14),da=wa.a;Rk(z,da);z.prototype.mAa=function(W){this.HT.selectedIndex=W.ruleType;this.uK.selectedIndex=W.xB;this.lec.checked=W.V4;this.Tva.checked=W.U4;this.Gya.value=W.CN;this.Hya.value=W.DN;this.rca(null)};z.prototype.cpb=function(W){W.U4=this.Tva.checked;W.V4=this.lec.checked;W.xB=this.uK.selectedIndex;W.ruleType=this.HT.selectedIndex;W.CN=this.Gya.value;W.DN=this.Hya.value};
z.prototype.dispose=function(){this.Uj();this.vk=this.GBd=this.Joc=this.NOa=this.$9a=this.lNa=this.i5a=this.lec=this.Hya=this.Gya=this.uK=this.HT=this.Tva=null;da.prototype.dispose.call(this)};z.prototype.render=function(W){W.appendChild(this.domElement)};z.prototype.Gja=function(){return this.isVisible};z.prototype.tna=function(W){return this.isVisible=W};z.prototype.setFocus=function(){};z.prototype.Wub=function(W,La){return this.M_e(W,La,this.jBh)};z.prototype.Dfd=function(W,La){return 0!==La&&
1!==La?"":this.M_e(W,La,this.ilj)};z.prototype.Zja=function(){this.domElement.innerHTML=r.Aeh;this.Tva=Qa.DOMElementExtensions.getElementById(this.domElement,"ignoreBlankCheckBoxId");this.HT=Qa.DOMElementExtensions.getElementById(this.domElement,"allowConditionSelectionId");this.uK=Qa.DOMElementExtensions.getElementById(this.domElement,"operatorSelectionId");this.Gya=Qa.DOMElementExtensions.getElementById(this.domElement,"operatorInputId1");this.Hya=Qa.DOMElementExtensions.getElementById(this.domElement,
"operatorInputId2");this.Joc=Qa.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId1");this.GBd=Qa.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId2");this.i5a=Qa.DOMElementExtensions.getElementById(this.domElement,"inCellDropdownDivId");this.lNa=Qa.DOMElementExtensions.getElementById(this.domElement,"listDescriptionDivId");this.$9a=Qa.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId1");this.NOa=Qa.DOMElementExtensions.getElementById(this.domElement,
"operatorInputDivId2");this.lec=Qa.DOMElementExtensions.getElementById(this.domElement,"inCellDropdownCheckboxId");this.Ti()};z.prototype.M_e=function(W,La,Ia){return Ia.length<W||Ia[W].length<La?(G.ULS.sendTraceTag(537163280,0,10,"DataValidationEditDialog.GetOperatorLabel: wrong parameters conditionOption={0} operatorOption={1}, cannot get label.",W,La),""):this.bR.na(Ia[W][La])};z.prototype.Ti=function(){fa.a.instance.qa(ha.a.Lb,this.HT,this.enc);fa.a.instance.qa(ha.a.Lb,this.uK,this.enc);fa.a.instance.qa(ha.a.change,
this.HT,this.rca);fa.a.instance.qa(ha.a.change,this.uK,this.rca);fa.a.instance.qa(ha.a.change,this.uK,this.vk);fa.a.instance.qa(ha.a.change,this.HT,this.vk);fa.a.instance.qa(ha.a.change,this.Gya,this.vk);fa.a.instance.qa(ha.a.Lb,this.Gya,this.vk);fa.a.instance.qa(ha.a.change,this.Hya,this.vk);fa.a.instance.qa(ha.a.Lb,this.Hya,this.vk)};z.prototype.Uj=function(){fa.a.instance.Aa(ha.a.Lb,this.HT,this.enc);fa.a.instance.Aa(ha.a.Lb,this.uK,this.enc);fa.a.instance.Aa(ha.a.change,this.HT,this.rca);fa.a.instance.Aa(ha.a.change,
this.uK,this.rca);fa.a.instance.Aa(ha.a.change,this.uK,this.vk);fa.a.instance.Aa(ha.a.change,this.HT,this.vk);fa.a.instance.Aa(ha.a.change,this.Gya,this.vk);fa.a.instance.Aa(ha.a.Lb,this.Gya,this.vk);fa.a.instance.Aa(ha.a.change,this.Hya,this.vk);fa.a.instance.Aa(ha.a.Lb,this.Hya,this.vk)};z.hja=function(){var W;return W=new ia.a,W.add("operatorInputId1"),W.add("operatorInputId2"),W};Af.Object.defineProperties(z.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return S.a.instance.ga(1683)}},
E0g:{configurable:!0,enumerable:!0,get:function(){return this.HT.selectedIndex}}});Object(u.a)(z,"DataValidationEditConditionsControl",wa.a,[673,10,681]);var xa=b(61),ta=b(29),ab=b(22),Na=b(206),Ka=X.a;Rk(w,Ka);w.prototype.QRd=function(){var W={};W=(W.RuleType=this.od.ruleType,W.RuleOperatorType=this.od.xB,W.OperatorInput1=this.od.CN,W.OperatorInput2=this.od.DN,W.IsIgnoreBlank=this.od.U4,W.IsInCellDropDown=this.od.V4,W.IsAlertBlocking=this.od.QZ,W.AlertTitle=this.od.DT,W.AlertMessage=this.od.BT,W.InputTitle=
this.od.$E,W.InputMessage=this.od.nV,W.IsShowErrorAlert=this.od.i5,W.IsShowInputMessage=this.od.j5,W);this.mc(2,S.a.instance.ga(1649));var La={};W=(La[w.Yv]=this.nc,La.validateDialogValues=this.mVj,La.RangePickerController=O.g(this.$).ig.Jbc(),La.isModal=!1,La.bodyProps=W,La);this.initializeAndShow(S.a.instance.ga(1648),this.F4c,W);G.ULS.sendTraceTag(537163278,0,50,"DataValidationEditDialog dialog opened.")};w.prototype.dispose=function(){this.disposed||(Ka.prototype.dispose.call(this),this.disposed=
!0)};w.prototype.hja=function(){return z.hja()};w.prototype.bMh=function(W,La){var Ia=this;return function(mb,fb,Ma){var Hb=W.oa.xa.Pb();return n(Ia.$.oa.xa,Ia.selectedRanges,Ia.TQg(),Ia.q_a(mb,Ia.$yd(La)),J.a(fb),Ma,Hb)}};w.prototype.$yd=function(W){var La=this;return function(Ia){G.ULS.sendTraceTag(537163277,0,50,"DataValidationEditDialog.OnDataValidationEditSuccessCallback");var mb;F.a(Ia)?(G.ULS.sendTraceTag(537163276,0,15,"DataValidationEditDialog.OnDataValidationEditSuccessCallback - request has expected errors: {0}.",
Ia?ta.a.Dc(Ia.Errors):null),Ia.Errors&&1===Ia.Errors.length&&((mb=La.Tcd(Ia.Errors[0].MessageId))?La.Xka("OkInvalidByServer",Ia.Errors[0].MessageIdName):(La.Xka("OkValid","None"),La.hide()),W(mb)),G.ULS.sendTraceTag(537163275,0,15,"DataValidationEditDialog.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: {0}",ta.a.Dc(Ia.Errors))):La.hide()}};w.prototype.TQg=function(){var W={};W.Command=this.command;W.RuleType=this.od.ruleType;W.ConditionType=this.od.xB;W.IsIgnoreBlank=this.od.U4;
W.IsInCellDropDown=this.od.V4;W.LowerBoundary=this.od.CN;W.UpperBoundary=this.od.DN;W.IsAlertBlocking=this.od.QZ;W.IsShowErrorAlert=this.od.i5;W.IsShowInputMessage=this.od.j5;W.AlertTitle=this.od.DT;W.AlertMessage=this.od.BT;W.InputTitle=this.od.$E;W.InputMessage=this.od.nV;W.ShouldIgnoreFormulaError=this.IMa;return W};w.prototype.Tcd=function(W){switch(W){case 1173235830:return S.a.instance.ga(1698);case 43935303:return S.a.instance.ga(1699);case -1323438439:return S.a.instance.ga(1701);case 2112020473:return S.a.instance.ga(1695);
case -219503282:return S.a.instance.ga(1696);case 1689335445:return S.a.instance.ga(1697);case 2146493810:return S.a.instance.ga(1700);case -2104909922:return String.format(S.a.instance.lb(105),this.Etb,this.rMd);case -869372599:return String.format(S.a.instance.lb(104),this.Etb);case -1181828368:return S.a.instance.ga(1703);case -758480861:return S.a.instance.ga(1704);case -13729088:return S.a.instance.ga(1705);case -846654055:return S.a.instance.ga(1706);case 751854001:return S.a.instance.ga(1707);
case -453846397:return S.a.instance.ga(1708);case 1102013489:return S.a.instance.ga(1709);case 835813260:return S.a.instance.ga(1710);case 1577787509:return S.a.instance.ga(1711);case 2083564019:return S.a.instance.ga(1702);default:G.ULS.sendTraceTag(537163274,0,15,"DataValidationEditDialog.GetDataValidationServerErrorString - unexpected error: {0}.",W.toString())}return null};w.prototype.Gla=function(){this.Xka("Cancel","None")};w.prototype.BW=function(W){G.ULS.sendTraceTag(537163273,0,50,"DataValidationEditDialog {0} was clicked.",
1===W?"Ok":"Cancel");var La={};W=(La.ButtonType=w.fia(W),La.DialogName=this.nc,La.Location="dialog",La.NumberOfSelectedRanges=O.g(this.$).ha.sa.sK,La);N.b(this.$).Cd(E.a.d6b,W)};w.prototype.Xka=function(W,La){var Ia={};w.Xrb(this.od,Ia);Ia.o=W;Ia.p=La;Ia.n=this.lka;this.Ph&&(this.Ph.stop(),Ia.q=this.Ph.id);H.b().De(49,Ia,!0)};w.prototype.zac=function(W){this.od.ruleType=W.RuleType;this.od.xB=W.RuleOperatorType;this.od.CN=W.OperatorInput1;this.od.DN=W.OperatorInput2;this.od.QZ=W.IsAlertBlocking;this.od.i5=
W.IsShowErrorAlert;this.od.DT=W.AlertTitle;this.od.BT=W.AlertMessage;this.od.j5=W.IsShowInputMessage;this.od.$E=W.InputTitle;this.od.nV=W.InputMessage;this.od.U4=W.IsIgnoreBlank;this.od.V4=W.IsInCellDropDown;this.Etb=W.firstOperatorLabel;this.rMd=W.secondOperatorLabel};w.prototype.zOb=function(W,La,Ia){var mb;var fb=mb=null;if(!W)return Ia?(mb=String.format(S.a.instance.lb(105),this.Etb,this.rMd),fb="DataValidationEditNoMinMaxError"):(mb=String.format(S.a.instance.lb(104),this.Etb),fb="DataValidationEditNoValueError"),
{returnValue:!1,errorString:mb,oq:fb};if(W.length>r.q8f)return mb=S.a.instance.ga(1702),{returnValue:!1,errorString:mb,oq:fb};if(Na.d(W))return{returnValue:!0,errorString:mb,oq:fb};if(1===La||2===La||6===La){if(!ab.a.a5(W))return mb=S.a.instance.ga(1695),{returnValue:!1,errorString:mb,oq:fb};if(1===La&&!ab.a.isInteger(W))return mb=S.a.instance.ga(1696),{returnValue:!1,errorString:mb,oq:fb};if(6===La){if(!ab.a.isInteger(W))return mb=S.a.instance.ga(1696),{returnValue:!1,errorString:mb,oq:fb};if(0>
parseInt(W,10))return mb=S.a.instance.ga(1697),{returnValue:!1,errorString:mb,oq:fb}}}return{returnValue:!0,errorString:mb,oq:fb}};w.prototype.YYd=function(){var W=this,La;var Ia=La=null;var mb=this.od.CN,fb=this.od.DN,Ma=ea[this.od.ruleType],Hb=Z[this.od.xB];if(0===Ma)return{returnValue:!0,errorString:La,oq:Ia};var Kb=(0===Hb||1===Hb)&&3!==Ma&&7!==Ma;return!function(){var Ub=W.zOb(mb,Ma,Kb);La=Ub.errorString;Ia=Ub.oq;return Ub}().returnValue||Kb&&!function(){var Ub=W.zOb(fb,Ma,Kb);La=Ub.errorString;
Ia=Ub.oq;return Ub}().returnValue?{returnValue:!1,errorString:La,oq:Ia}:Kb&&(1===Ma||2===Ma||6===Ma)&&!Na.d(mb)&&!Na.d(fb)&&parseFloat(mb)>parseFloat(fb)?(La=S.a.instance.ga(1700),Ia="DataValidationEditMaximumLessMinimumError",{returnValue:!1,errorString:La,oq:Ia}):{returnValue:!0,errorString:La,oq:Ia}};w.fia=function(W){switch(W){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return G.ULS.shipAssertTag(537163272,0,!1,"DataValidationEditDialog.DialogButtonToString: Unknown DialogButton"),
"Unknown"}};w.Xrb=function(W,La){La.a=B(W.ruleType);La.b=y(W.xB);La.c=!!W.CN;La.d=!!W.DN;La.e=W.U4;La.f=W.V4;La.g=W.j5;La.h=!!W.$E;La.i=!!W.nV;La.j=W.i5;La.k=W.QZ;La.l=!!W.DT;La.m=!!W.BT};Af.Object.defineProperties(w.prototype,{od:{configurable:!0,enumerable:!0,get:function(){return this.HRb}},nc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationEditDialog"}},E1b:{configurable:!0,enumerable:!0,get:function(){return 3===this.od.ruleType}}});Object(u.a)(w,"DataValidationEditDialog",
X.a,[]);var la=b(90);X=b(325);f.nbh="DataValidationDialogPanel";f.mbh="DataValidationButtonPanel";f.lbh="DataValidationButtonClearAll";Object(u.a)(f,"CssClassNames",null,[]);var Ea=wa.a;Rk(m,Ea);m.prototype.render=function(W){W.appendChild(this.domElement)};m.prototype.Gja=function(){return this.isVisible};m.prototype.tna=function(W){return this.isVisible=W};m.prototype.setFocus=function(){};m.prototype.dispose=function(){this.Uj();this.vk=this.gba=this.fba=this.j$e=this.eba=null;Ea.prototype.dispose.call(this)};
m.prototype.Zja=function(){this.domElement.innerHTML=r.Heh;this.eba=Qa.DOMElementExtensions.getElementById(this.domElement,"showInputCheckBoxId");this.j$e=Qa.DOMElementExtensions.getElementById(this.domElement,"inputMessageDivID");this.gba=Qa.DOMElementExtensions.getElementById(this.domElement,"textForInputTitleId");this.fba=Qa.DOMElementExtensions.getElementById(this.domElement,"textForInputMessageId");this.eba.checked=!0;this.Ti();this.gnc(null)};m.prototype.mAa=function(W){this.gba.value=void 0===
W.$E||null===W.$E?"":W.$E;this.fba.value=void 0===W.nV||null===W.nV?"":W.nV;this.eba.checked=W.j5;this.gnc(null)};m.prototype.cpb=function(W){W.$E=this.gba.value;W.nV=this.fba.value;W.j5=this.eba.checked};m.prototype.Ti=function(){fa.a.instance.qa(ha.a.change,this.eba,this.gnc);fa.a.instance.qa(ha.a.change,this.eba,this.vk);fa.a.instance.qa(ha.a.change,this.gba,this.vk);fa.a.instance.qa(ha.a.Lb,this.gba,this.vk);fa.a.instance.qa(ha.a.change,this.fba,this.vk);fa.a.instance.qa(ha.a.Lb,this.fba,this.vk)};
m.prototype.Uj=function(){fa.a.instance.Aa(ha.a.change,this.eba,this.gnc);fa.a.instance.Aa(ha.a.change,this.eba,this.vk);fa.a.instance.Aa(ha.a.change,this.gba,this.vk);fa.a.instance.Aa(ha.a.Lb,this.gba,this.vk);fa.a.instance.Aa(ha.a.change,this.fba,this.vk);fa.a.instance.Aa(ha.a.Lb,this.fba,this.vk)};Af.Object.defineProperties(m.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return S.a.instance.ga(1685)}}});Object(u.a)(m,"DataValidationEditInputControl",wa.a,[673,10,680]);var ra=wa.a;
Rk(l,ra);l.prototype.render=function(W){W.appendChild(this.domElement)};l.prototype.Gja=function(){return this.isVisible};l.prototype.tna=function(W){return this.isVisible=W};l.prototype.setFocus=function(){};l.prototype.dispose=function(){this.Uj();this.vk=this.J9=this.I9=this.QTa=this.gha=this.H9=null;ra.prototype.dispose.call(this)};l.prototype.Zja=function(){this.domElement.innerHTML=r.Leh;this.H9=Qa.DOMElementExtensions.getElementById(this.domElement,"showAlertCheckBoxId");this.gha=Qa.DOMElementExtensions.getElementById(this.domElement,
"blockingId");this.QTa=Qa.DOMElementExtensions.getElementById(this.domElement,"warningId");this.J9=Qa.DOMElementExtensions.getElementById(this.domElement,"textForAlertTitleId");this.I9=Qa.DOMElementExtensions.getElementById(this.domElement,"textForAlertMessageId");this.H9.checked=!0;this.gha.checked=!0;this.Ti();this.fnc(null)};l.prototype.mAa=function(W){this.gha.checked=W.QZ;this.QTa.checked=!W.QZ;this.J9.value=void 0===W.DT||null===W.DT?"":W.DT;this.I9.value=void 0===W.BT||null===W.BT?"":W.BT;
this.H9.checked=W.i5;this.fnc(null)};l.prototype.cpb=function(W){W.DT=this.J9.value;W.BT=this.I9.value;W.QZ=this.gha.checked;W.i5=this.H9.checked};l.prototype.Ti=function(){fa.a.instance.qa(ha.a.change,this.H9,this.fnc);fa.a.instance.qa(ha.a.change,this.H9,this.vk);fa.a.instance.qa(ha.a.change,this.gha,this.vk);fa.a.instance.qa(ha.a.change,this.QTa,this.vk);fa.a.instance.qa(ha.a.change,this.J9,this.vk);fa.a.instance.qa(ha.a.Lb,this.J9,this.vk);fa.a.instance.qa(ha.a.change,this.I9,this.vk);fa.a.instance.qa(ha.a.Lb,
this.I9,this.vk)};l.prototype.Uj=function(){fa.a.instance.Aa(ha.a.change,this.H9,this.fnc);fa.a.instance.Aa(ha.a.change,this.H9,this.vk);fa.a.instance.qa(ha.a.change,this.gha,this.vk);fa.a.instance.qa(ha.a.change,this.QTa,this.vk);fa.a.instance.Aa(ha.a.change,this.J9,this.vk);fa.a.instance.Aa(ha.a.Lb,this.J9,this.vk);fa.a.instance.Aa(ha.a.change,this.I9,this.vk);fa.a.instance.Aa(ha.a.Lb,this.I9,this.vk)};Af.Object.defineProperties(l.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return S.a.instance.ga(1684)}}});
Object(u.a)(l,"DataValidationEditMessagesControl",wa.a,[673,10,679]);Object(u.a)(k,"MacroRecorderRangeDataValidationChangedPayload",null,[409]);var na=b(1442),ba=b(70),sa=X.a;Rk(e,sa);e.prototype.QRd=function(){var W={};W=(W.key=this.od,W);this.initializeAndShow(S.a.instance.ga(1648),this.F4c,W);G.ULS.sendTraceTag(537163271,0,50,"DataValidationEditDialogDeprecated dialog opened.")};e.prototype.dispose=function(){this.disposed||(this.Lec=this.Vkc=this.a3=null,la.a.Ia(this.OCb),this.OCb=null,N.b(this.$)&&
N.b(this.$).oTd("DataValidationDialogCorellation"),sa.prototype.dispose.call(this),this.disposed=!0)};e.prototype.kv=function(W){sa.prototype.kv.call(this,W);this.mc(2,S.a.instance.ga(1649));W=this.YU(2);var La=this.YU(1),Ia=this.YU(0),mb=La.parentNode;mb.appendChild(W);mb.appendChild(La);mb.appendChild(Ia);W.parentNode.classList.add(f.mbh);W.classList.add(f.lbh);W=document.getElementById("dataValidationTabsId");La=new z(this.$,document.createElement("div"),this.rca);Ia=new m(document.createElement("div"),
this.rca);mb=new l(document.createElement("div"),this.rca);this.Wai(La,Ia,mb);var fb;this.OCb=new na.a(W,(fb=new ia.a,fb.add(La),fb.add(Ia),fb.add(mb),fb));this.OCb.sQf();this.NU=document.getElementById("validationErrorMessageId");this.mAa();N.b(this.$)&&N.b(this.$).YSd("DataValidationDialogCorellation")};e.prototype.lO=function(){sa.prototype.lO.call(this);document.getElementById(this.di("WACDialogPanel")).classList.add(f.nbh)};e.prototype.hja=function(){return z.hja()};e.prototype.gdd=function(){return"validationErrorMessageId"};
e.prototype.Wai=function(W,La,Ia){this.a3=W;this.Lec=La;this.Vkc=Ia};e.prototype.nmj=function(){function W(){return new k(La.selectedRanges,Ia)}var La=this,Ia={};Ia.IsClearAll=this.lka;Ia.Command=this.command;Ia.RuleType=this.od.ruleType;Ia.ConditionType=this.od.xB;Ia.IsIgnoreBlank=this.od.U4;Ia.IsInCellDropDown=this.od.V4;Ia.LowerBoundary=this.od.CN;Ia.UpperBoundary=this.od.DN;Ia.IsAlertBlocking=this.od.QZ;Ia.IsShowErrorAlert=this.od.i5;Ia.IsShowInputMessage=this.od.j5;Ia.AlertTitle=this.od.DT;Ia.AlertMessage=
this.od.BT;Ia.InputTitle=this.od.$E;Ia.InputMessage=this.od.nV;Ia.ShouldIgnoreFormulaError=this.IMa;var mb=this.$.oa.xa.Pb();U.a(this.$.userOperationManager,function(fb,Ma,Hb){return n(La.$.oa.xa,La.selectedRanges,Ia,J.b(fb,La.$yd),J.a(Ma),Hb,mb)},function(fb){return new M.a(121,0,fb,void 0,W)},null)};e.prototype.jyj=function(W){return 1577787509===W};e.prototype.ztj=function(W){this.NU.innerText=W;this.lI(this.YU(0));this.IMa=!0};e.prototype.lye=function(){this.IMa=!1;this.NU.innerText=""};e.prototype.Tcd=
function(W){switch(W){case 1173235830:return S.a.instance.ga(1698);case 43935303:return S.a.instance.ga(1699);case -1323438439:return S.a.instance.ga(1701);case 2112020473:return S.a.instance.ga(1695);case -219503282:return S.a.instance.ga(1696);case 1689335445:return S.a.instance.ga(1697);case 2146493810:return S.a.instance.ga(1700);case -2104909922:return String.format(S.a.instance.lb(105),this.a3.Wub(this.od.ruleType,this.od.xB),this.a3.Dfd(this.od.ruleType,this.od.xB));case -869372599:return String.format(S.a.instance.lb(104),
this.a3.Wub(this.od.ruleType,this.od.xB));case -1181828368:return S.a.instance.ga(1703);case -758480861:return S.a.instance.ga(1704);case -13729088:return S.a.instance.ga(1705);case -846654055:return S.a.instance.ga(1706);case 751854001:return S.a.instance.ga(1707);case -453846397:return S.a.instance.ga(1708);case 1102013489:return S.a.instance.ga(1709);case 835813260:return S.a.instance.ga(1710);case 1577787509:return S.a.instance.ga(1711);case 2083564019:return S.a.instance.ga(1702);default:G.ULS.sendTraceTag(537163265,
0,15,"DataValidationEditDialogDeprecated.GetDataValidationServerErrorString - unexpected error: {0}.",W.toString())}return null};e.prototype.G9a=function(){G.ULS.sendTraceTag(537163264,0,50,"DataValidationEditDialogDeprecated 'Ok' was clicked.");this.zac();var W=this.YYd();var La=W.errorString;var Ia=W.oq;if(!W.returnValue)return this.qr(La),this.Xka("OkInvalidByClient",Ia),!1;this.nmj();return!0};e.prototype.Gla=function(){this.zac();this.Xka("Cancel","None");this.hide()};e.prototype.iya=function(){G.ULS.sendTraceTag(537163235,
0,50,"DataValidationEditDialogDeprecated 'ClearAll' was clicked.");this.IMa?this.lye():this.O_c();this.Hfj();this.lka=!0};e.prototype.BW=function(W){var La={};W=(La.ButtonType=e.fia(W),La.DialogName=this.nc,La.Location="dialog",La.NumberOfSelectedRanges=O.g(this.$).ha.sa.sK,La);N.b(this.$).Cd(E.a.d6b,W)};e.prototype.Hfj=function(){this.HRb=new A;this.mAa()};e.prototype.mAa=function(){this.Vkc.mAa(this.od);this.Lec.mAa(this.od);this.a3.mAa(this.od)};e.prototype.zac=function(){this.a3.cpb(this.od);
this.Vkc.cpb(this.od);this.Lec.cpb(this.od)};e.prototype.Xka=function(W,La){var Ia={};e.Xrb(this.od,Ia);Ia.o=W;Ia.p=La;Ia.n=this.lka;this.Ph&&(this.Ph.stop(),Ia.q=this.Ph.id);H.b().De(49,Ia,!0)};e.prototype.zOb=function(W,La){var Ia;var mb=Ia=null;if(!W)return La?(Ia=String.format(S.a.instance.lb(105),this.a3.Wub(this.od.ruleType,this.od.xB),this.a3.Dfd(this.od.ruleType,this.od.xB)),mb="DataValidationEditNoMinMaxError"):(Ia=String.format(S.a.instance.lb(104),this.a3.Wub(this.od.ruleType,this.od.xB)),
mb="DataValidationEditNoValueError"),{returnValue:!1,errorString:Ia,oq:mb};if(W.length>r.q8f)return Ia=S.a.instance.ga(1702),{returnValue:!1,errorString:Ia,oq:mb};if(Na.d(W))return{returnValue:!0,errorString:Ia,oq:mb};if(1===this.od.ruleType||2===this.od.ruleType||6===this.od.ruleType){if(!ab.a.a5(W))return Ia=S.a.instance.ga(1695),{returnValue:!1,errorString:Ia,oq:mb};if(1===this.od.ruleType&&!ab.a.isInteger(W))return Ia=S.a.instance.ga(1696),{returnValue:!1,errorString:Ia,oq:mb};if(6===this.od.ruleType){if(!ab.a.isInteger(W))return Ia=
S.a.instance.ga(1696),{returnValue:!1,errorString:Ia,oq:mb};if(0>parseInt(W,10))return Ia=S.a.instance.ga(1697),{returnValue:!1,errorString:Ia,oq:mb}}}return{returnValue:!0,errorString:Ia,oq:mb}};e.prototype.YYd=function(){var W=this,La;var Ia=La=null;if(this.lka||0===this.od.ruleType)return{returnValue:!0,errorString:La,oq:Ia};var mb=(0===this.od.xB||1===this.od.xB)&&3!==this.od.ruleType&&7!==this.od.ruleType;return!function(){var fb=W.zOb(W.od.CN,mb);La=fb.errorString;Ia=fb.oq;return fb}().returnValue||
mb&&!function(){var fb=W.zOb(W.od.DN,mb);La=fb.errorString;Ia=fb.oq;return fb}().returnValue?{returnValue:!1,errorString:La,oq:Ia}:mb&&(1===this.od.ruleType||2===this.od.ruleType||6===this.od.ruleType)&&!Na.d(this.od.CN)&&!Na.d(this.od.DN)&&parseFloat(this.od.CN)>parseFloat(this.od.DN)?(La=S.a.instance.ga(1700),Ia="DataValidationEditMaximumLessMinimumError",{returnValue:!1,errorString:La,oq:Ia}):{returnValue:!0,errorString:La,oq:Ia}};e.fia=function(W){switch(W){case 0:return"Cancel";case 1:return"Ok";
case 2:return"ClearAll";default:return G.ULS.shipAssertTag(537163234,0,!1,"DataValidationEditDialogDeprecated.DialogButtonToString: Unknown DialogButton"),"Unknown"}};e.Xrb=function(W,La){La.a=B(W.ruleType);La.b=y(W.xB);La.c=!!W.CN;La.d=!!W.DN;La.e=W.U4;La.f=W.V4;La.g=W.j5;La.h=!!W.$E;La.i=!!W.nV;La.j=W.i5;La.k=W.QZ;La.l=!!W.DT;La.m=!!W.BT};Af.Object.defineProperties(e.prototype,{od:{configurable:!0,enumerable:!0,get:function(){return this.HRb}},nc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationEditDialog"}},
onCommitDialogHandler:{configurable:!0,enumerable:!0,get:function(){var W=this;return function(){W.BW(1);W.G9a()}},set:function(W){Object(ba.b)(e.prototype,this,"onCommitDialogHandler",W)}},canBePreempted:{configurable:!0,enumerable:!0,get:function(){return!1}},E1b:{configurable:!0,enumerable:!0,get:function(){return 3===this.a3.E0g}}});Object(u.a)(e,"DataValidationEditDialogDeprecated",X.a,[]);var ya=b(1);d.prototype.sHa=function(W,La,Ia,mb){ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationReactDialog",
!1)?(new w(W,La,Ia,mb)).QRd():(new e(W,La,Ia,mb)).QRd()};d.prototype.m4g=function(W,La){var Ia=new ca.StandardDialog;Ia.Rb=3;Ia.DAa(W.ob.fja,S.a.instance.ga(1693),La)};d.prototype.o4g=function(W,La){var Ia=new ca.StandardDialog;Ia.Rb=1;Ia.dX(W.ob.fja,S.a.instance.ga(1694),La)};Object(u.a)(d,"DataValidationEditDialogFactory",null,[648]);var va=C.a;Rk(c,va);c.prototype.zd=function(){this.jd([new v(this.$,new d)])};c.ka=function(W){C.a.Qd(245,new c(W))};Object(u.a)(c,"DataValidationEditCommandHandlerFactory",
C.a,[]);b.d(D,"a",function(){return a})},1361:function(u,D,b){function a(){F.a.Fa(c.ka)}function c(P){var oa=ma.call(this)||this;oa.$=P;oa.Eb();return oa}function d(P){var oa=this;this.px=this.calcManager=this.lz=this.YRa=null;this.wKi=function(Ja,$a){if(Ja&&!fb.a(Ja)&&$a){var Ta=!!Ja&&!!Ja.RequestTelemetryData;Ub.g(oa.$).ui.fla($a.toString(),Ja.StateId,Ta?Ja.RequestTelemetryData.EcsOperationDuration:0,Ta?Ja.RequestTelemetryData.EcsRequestDuration:0,Ta?Ja.RequestTelemetryData.WfeRequestDuration:0)}};
this.$=P;this.$.da.Za(268,function(Ja){oa.lz=Ja});this.RCh=new l(Ub.g(this.$).Ea,this.$);this.E2=new f(this.$,Ub.g(this.$),this);this.$.da.Za(266,function(Ja){oa.calcManager=Ja});this.tb=xa.EwaSettings.tb();this.Cm=xa.EwaSettings.Cm();this.bAb=xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNumberFormatterInWebWorker",!1);this.Xqd=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6169583_checkTextAlignmentColorAndApplyNumberFormat2");this.AMa=xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",
!1);this.Qoi=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6280164_fixRTEregressionInMovingNFToWebWorker")}function e(P,oa){this.success=P;this.gz=oa}function k(){this.Peg=this.OWj=!1;this.source=0;this.awa=this.phc=!1}function l(P,oa){this.px=null;this.Ea=P;this.m2a=oa}function m(P,oa,Ja){this.success=P;this.Vlc=void 0===oa?null:oa;this.reason=void 0===Ja?"":Ja}function f(P,oa,Ja){var $a=this;this.Tca=[];this.calcManager=this.Syc=this.lastSetCellInstantaneousOperation=null;this.$=P;this.grid=oa;
this.Gg=Ja;this.Oca=f.XFe;this.$.da.Za(268,function(Ta){$a.Syc=Ta});this.$.da.Za(266,function(Ta){$a.calcManager=Ta});this.bAb=xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNumberFormatterInWebWorker",!1);this.Xqd=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6169583_checkTextAlignmentColorAndApplyNumberFormat2");this.Poi=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6280164_fixRTEregressionInMovingNFToWebWorker")}function w(P,oa,Ja,$a){this.rangeDelta=P;this.stateId=oa;this.isFinished=
Ja;this.priorityGroup=$a}function n(P,oa,Ja,$a,Ta,pa,Da,rb,Ab,ob,sb,Pb,Aa,Ya,kb,lb,ac,Dc,Zb,mc,Lb,Sa,Cb,ec,wb){this.numberOfDependentRecalcedCellsInBatch=this.numberOfEditedRecalcedCellsInBatch=this.newProcessingTimeLimit=this.originalProcessingTimeLimit=this.totalExecutionTime=this.numberOfSkippedCellsDueToMissingLocaleInfo=this.numberOfUnsupportedRichCellTypes=this.numberOfUnsupportedBlankCellTypes=this.numberOfUnsupportedErrorCellTypes=this.numberOfCellsWithNoFormattedCell=this.numberOfCellsSkippedDueToTimeout=
this.numberOfCellsUpdatedAlreadyByServer=this.numberOfUpdatedCells=this.numberOfNonUpdatedCells=this.totalNumberOfCellsInBatch=0;this.isNewTask=!1;this.lastSetCellInstantaneousOperation=null;this.taskId=0;this.numberOfHashFormattedValues=this.numberOfMeasureTextWidthCalls=this.newNumberFormatterFinalizeFailures=this.totalNumberFormatterTime=this.numberOfRecalcedCellsWithoutFormattedValue=this.numberOfRecalcedCellsWithFormattedValue=this.isNewNumberFormatter=null;this.totalNumberOfCellsInBatch=void 0===
P?0:P;this.numberOfNonUpdatedCells=void 0===oa?0:oa;this.numberOfUpdatedCells=void 0===Ja?0:Ja;this.numberOfCellsUpdatedAlreadyByServer=void 0===$a?0:$a;this.numberOfCellsSkippedDueToTimeout=void 0===Ta?0:Ta;this.numberOfCellsWithNoFormattedCell=void 0===pa?0:pa;this.numberOfUnsupportedErrorCellTypes=void 0===Da?0:Da;this.numberOfUnsupportedBlankCellTypes=void 0===rb?0:rb;this.numberOfUnsupportedRichCellTypes=void 0===Ab?0:Ab;this.numberOfSkippedCellsDueToMissingLocaleInfo=void 0===ob?0:ob;this.totalExecutionTime=
void 0===sb?0:sb;this.originalProcessingTimeLimit=void 0===Pb?0:Pb;this.newProcessingTimeLimit=void 0===Aa?0:Aa;this.numberOfEditedRecalcedCellsInBatch=void 0===Ya?0:Ya;this.numberOfDependentRecalcedCellsInBatch=void 0===kb?0:kb;this.isNewTask=void 0===lb?!1:lb;this.lastSetCellInstantaneousOperation=void 0===ac?"":ac;this.taskId=void 0===Dc?0:Dc;this.isNewNumberFormatter=void 0===Zb?null:Zb;this.numberOfRecalcedCellsWithFormattedValue=void 0===mc?null:mc;this.numberOfRecalcedCellsWithoutFormattedValue=
void 0===Lb?null:Lb;this.totalNumberFormatterTime=void 0===Sa?null:Sa;this.newNumberFormatterFinalizeFailures=void 0===Cb?null:Cb;this.numberOfMeasureTextWidthCalls=void 0===ec?null:ec;this.numberOfHashFormattedValues=void 0===wb?null:wb}function z(){}function r(P,oa,Ja,$a,Ta){this.dM=void 0===P?0:P;this.cellValue=void 0===oa?"":oa;this.ifmt=void 0===Ja?0:Ja;this.priorityGroup=void 0===$a?"":$a;this.gz=void 0===Ta?"":Ta}function v(P){P=A(P);if(0===P)return 1;if(1===P)return 2;O.ULS.sendTraceTag(537162182,
0,10,"CalcInterfaceAdapter.GetInstantaneousUpdatedCellType: unknown updated cell type!");return 0}function A(P){if(P.priorityGroup===I.editCell)return 0;if(P.priorityGroup===I.dependentCell)return 1;O.ULS.sendTraceTag(537162183,0,10,"CalcInterfaceAdapter.GetRecalcPriorityGroup: unknown priority group!");return 2}function B(P,oa){var Ja=A(oa),$a=!(void 0===oa.rangeDelta.data.format||null===oa.rangeDelta.data.format);O.ULS.shipAssertTag(537162187,0,0===Ja||!$a,"CalcInterfaceAdapter.GetRecalcInferredFormat: Format inference expected for Edited cell only {0}",
oa.priorityGroup);P=Math.max(P.cell.Xk,0);$a&&($a=excelOnlineCalc.calc.getCellFormatKind(oa.rangeDelta.data.format.format),"number"===$a?P=oa.rangeDelta.data.format.format:"string"===$a?O.ULS.sendTraceTag(537162186,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind string"):"Unavailable"===$a?O.ULS.sendTraceTag(537162185,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind unavailable"):O.ULS.shipAssertTag(537162184,0,!1,"CalcInterfaceAdapter.GetRecalcInferredFormat: unknown format kind!"));
return P}function y(P){var oa=P.value;switch(P.type){case 2:return void 0===oa||null===oa?"":oa;case 1:return P=parseFloat(oa),isNaN(P)?null:P;case 3:return P=parseFloat(oa),isNaN(P)?null:1===P;case 4:return P=parseFloat(oa),isNaN(P)?null:excelOnlineCalc.calc.errorValue(P);default:return excelOnlineCalc.calc.blankValue}}function x(P){P=excelOnlineCalc.calc.getCellValueKind(P.rangeDelta.data.value);var oa=0;switch(P){case "number":oa=1;break;case "string":oa=2;break;case "boolean":oa=3;break;case "Error":oa=
4;break;case "Blank":oa=0;break;default:O.ULS.shipAssertTag(537162191,0,!1,"CalcInterfaceAdapter.GetCellValueType: Unexpected unsupported type {0}",P)}return oa}function C(P,oa){P=excelOnlineCalc.calc.getCellValueKind(P.rangeDelta.data.value);switch(P){case "number":case "string":case "boolean":return!0;case "Blank":if(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5477761_Calc_BlankCellValueTypeSupported"))return!0;oa.numberOfUnsupportedBlankCellTypes++;return!1;case "Error":if(xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcErrorValueTypeSupported",
!1))return!0;oa.numberOfUnsupportedErrorCellTypes++;return!1;case "Rich":return oa.numberOfUnsupportedRichCellTypes++,!1;default:return O.ULS.shipAssertTag(537162192,0,!1,"CalcInterfaceAdapter.IsCellValueTypeSupported: Unexpected unsupported type {0}",P),!1}}function G(P){if(P=P.color){if("String"===Object.getType(P).getName())return la.a.Qo(P);if("Number"===Object.getType(P).getName())return null}else return null;O.ULS.sendTraceTag(537162193,0,10,"CalcInterfaceAdapter.GetFontColorFromFormattedValue: unknown color type!");
return null}function E(P){switch(P.alignment){case "Center":return 2;case "Left":return 1;case "Right":return 3;default:return O.ULS.sendTraceTag(537162194,0,10,"CalcInterfaceAdapter.GetHorizontalAlignmentFromFormattedValue: unknown horizontal alignment!"),0}}function I(){}function U(P,oa,Ja,$a,Ta,pa,Da,rb,Ab,ob,sb,Pb,Aa){Pb=void 0===Pb?null:Pb;Aa=void 0===Aa?null:Aa;rb=ab.call(this,11,0,rb,sb)||this;rb.QCh=P;rb.Uad=oa;rb.format=$a;rb.activeCell=Ja;rb.Gqe=Ta;rb.eGf=pa;rb.$Ff=Da;rb.ZEa=Ab;rb.clientCorrelationId=
ob;rb.Flb=Pb;rb.Yhb=Aa;return rb}function M(){}function T(P,oa,Ja,$a,Ta,pa){if(0===$a)return Object(va.a)(nb.UnsupportedZeroResize);if(0>$a||0===Ja.length)return Object(va.a)(nb.InvalidInput);if(P.Z4h())return Object(va.a)(nb.UnsupportedSkeletonInView);var Da=P.Pe;if(!Da)return Object(va.a)(nb.NullSPD);var rb=Da.aZe(Ja);if(rb&&0<rb.length)return Object(va.a)(rb.length.toString()+" "+nb.UnsupportedHiddenInRange);a:{rb=ak(Ja);for(var Ab=rb.next();!Ab.done;Ab=rb.next())Ab=Ab.value,Ta?Ab.right=Ea.a.Eh:
Ab.bottom=Ea.a.vh;rb=P.H$("EditGridAction.IsMergeCellAcrossBlocksExistInRanges",Ja);try{for(rb.$$rst();rb.$$mn();)if(rb.zn.qDj){var ob=!0;break a}}finally{rb&&rb.dispose()}ob=!1}if(ob)return Object(va.a)(nb.UnsupportedMergeCell);if(xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase2",!1)&&!Ta&&"undefined"!==typeof gridRenderer)for(ob=ak(Ja),rb=ob.next();!rb.done;rb=ob.next())gridRenderer.CanvasRendererGlobals.resetColWidthCacheByCol(rb.value.left);P=P.Ea;ob=wc.a.create().toString();
Da.edg(Ja,$a,Ta);pa=P.hQj(Ta,pa);oa.R6i(Ja,Ta);P.a3i(pa,ob,Ta?"row":"column");return Object(va.d)($a)}var F=b(11);u=b(0);var K=b(232),J=b(7),O=b(15),N=b(90),H=b(279),Q=b(202),ca=b(83),X=b(440),Z=b(85),ea=b(985),ka=b(189),Y=b(282),qa=b(24),fa=b(1083),ha=b(45);M.wEh="GalleryGeneral";M.yEh="GalleryNumber";M.uEh="GalleryCurrency";M.sEh="GalleryAccounting";M.BEh="GalleryShortDate";M.xEh="GalleryLongDate";M.DEh="GalleryTime";M.zEh="GalleryPercentage";M.vEh="GalleryFraction";M.AEh="GalleryScientific";M.CEh=
"GalleryText";M.fSg="ButtonComma";M.buttonPercentage="ButtonPercentage";M.keyboardNumber="KeyboardNumber";M.keyboardCurrency="KeyboardCurrency";M.keyboardDate="KeyboardDate";M.keyboardTime="KeyboardTime";M.keyboardPercentage="KeyboardPercentage";Object(u.a)(M,"RibbonFormatKind",null,[]);var ia=b(61),wa=b(309),Qa=b(716),S=b(715),da=b(714),xa=b(1),ta=b(70),ab=wa.a;Rk(U,ab);U.prototype.C2=function(P){return ab.prototype.C2.call(this,P)||this.QCh.C2(this.Uad,this.activeCell,this.format,this.Gqe,this.eGf,
this.$Ff,this.WZb,this.ZEa,this.clientCorrelationId,this.Flb,this.Yhb)};U.prototype.dj=function(){var P=[];if(this.Gcc)for(var oa=ak(this.Gcc),Ja=oa.next();!Ja.done;Ja=oa.next())P.push(da.a(Ja.value));else P.push(new S.a(this.format,this.Uad,this.activeCell));return function(){return new Qa.a(P)}};U.prototype.eeb=function(){var P={OperationType:0};P.FormatCellsMultiRange=this.Uad;P.ActiveCell=this.activeCell;P.Format=this.format;P.ApplyFormatOnPivotTableValueField=this.Gqe;P.PivotTableXluid=this.eGf;
P.PivotTableFieldCaption=this.$Ff;return P};Af.Object.defineProperties(U.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return xa.EwaSettings.Zb()?Object(ta.a)(U.prototype,this,"operationWorkingState"):0}},ot:{configurable:!0,enumerable:!0,get:function(){return this.Flb}},laa:{configurable:!0,enumerable:!0,get:function(){return this.Yhb}},eCc:{configurable:!0,enumerable:!0,get:function(){return this.ZEa}}});Object(u.a)(U,"FormatCellsBatchOperation",wa.a,[]);var Na=
b(36),Ka=b(216);I.editCell="Edited";I.dependentCell="Dependents";Object(u.a)(I,"RecalcPriorityGroupType",null,[]);var la=b(203),Ea=b(8);Object(u.a)(r,"RecalcAccuracyObject",null,[]);z.string="String";z.blank="Blank";z.general="General";z.zBh="Flexible";Object(u.a)(z,"FormattedUnitKind",null,[]);Object(u.a)(n,"RecalcResultProcessingStatistics",null,[]);Object(u.a)(w,"RecalcedCellInfo",null,[]);var ra=b(110),na=b(10),ba=b(22),sa=b(58),ya=b(63),va=b(445);f.prototype.dispose=function(){this.calcManager=
this.Syc=this.Gg=this.grid=this.$=null};f.prototype.PIf=function(P){var oa;if(P&&P.rangeDeltas){for(var Ja=this.Tca.length,$a=0;$a<P.rangeDeltas.length;$a++)(null===(oa=P.rangeDeltas[$a])||void 0===oa?0:oa.data)&&void 0!==P.rangeDeltas[$a].data.value&&null!==P.rangeDeltas[$a].data.value&&void 0!==P.rangeDeltas[$a].range&&null!==P.rangeDeltas[$a].range&&this.Tca.push(new w(P.rangeDeltas[$a],P.stateId,P.isFinished,P.priorityGroup));O.ULS.sendTraceTag(574993422,0,50,"CalcResultProcessor.ProcessResults stateId={0}, priorityGroup={1}, recalcFinished={2}, cellsFromCalc={3}, initialCellsToRender={4}, recalcedCells={5}, lastSetCellInstantaneousOperation={6}",
P.stateId,P.priorityGroup,P.isFinished,P.rangeDeltas.length,Ja,this.Tca.length,this.lastSetCellInstantaneousOperation);!Ja&&this.Tca.length&&this.BAf(!1,0)}};f.prototype.C$c=function(P,oa,Ja,$a,Ta,pa,Da){if(!oa)return Object(va.a)("Null");var rb=excelOnlineCalc.numfmt.renderCallback($a,function(ob){return gridRenderer.CanvasRendererGlobals.measureTextWidth(ob,Ta,!0,xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1))},Da),Ab=P.renderValue(oa,rb);if(!excelOnlineCalc.util.isSuccess(Ab))return Object(va.a)("Finalize");
$a=null;if(Da=excelOnlineCalc.numfmt.isHashesValue(Ab.value)){if(Ab=P.renderHashesValue(Ab.value,rb),!excelOnlineCalc.util.isSuccess(Ab))return Object(va.a)("Hashes")}else $a=f.bDh(oa,Ab.value);rb=Ab.value;P=excelOnlineCalc.numfmt.renderedValueToString(rb);oa=E(rb);rb=G(rb);return Object(va.d)({text:P,valueType:Ja,fontColor:rb,Xk:pa,S8a:$a,horizontalAlignment:oa,isHashesValue:Da})};f.prototype.BAf=function(P,oa){var Ja=this;this.$&&this.grid&&this.calcManager&&this.Syc&&this.calcManager.pF?(P&&(this.Oca=
this.Syc.C$e),this.t1i(this.grid,this.calcManager.pF,P,oa),!this.Oca&&this.Tca.length?sa.Task.delay(0).eo(function($a){Ja.BAf(!0,$a.id);return!0},0,null,ya.a.current):sa.Task.Ua(!0)):(O.ULS.sendTraceTag(537162181,0,50,"CalcResultProcessor.OnRecalcResultsTask: one of the objects required for processing is null. Aborting..."),sa.Task.Ua(!1))};f.prototype.t1i=function(P,oa,Ja,$a){var Ta=na.HelperMethods.Qb();for(Ja=new n(this.Tca.length,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,
void 0,this.Oca,void 0,void 0,void 0,Ja,void 0,$a,!0,0,0,0,0,0,0);0<this.Tca.length;){$a=na.HelperMethods.Qb()-Ta;if(!this.Oca||$a>this.Oca){Ja.numberOfCellsSkippedDueToTimeout=this.Tca.length;break}$a=Array.dequeue(this.Tca);if(C($a,Ja)){var pa=qa.Range.Tc($a.rangeDelta.range.row+1,$a.rangeDelta.range.column+1);(pa=P.Ub(pa))?f.$Tg($a.stateId,pa.cell)?(f.Qlc(P,pa,$a,Ja),this.xKg(oa,pa,$a,Ja)):Ja.numberOfCellsUpdatedAlreadyByServer++:Ja.numberOfCellsWithNoFormattedCell++}}$a=Math.round(na.HelperMethods.Qb()-
Ta);this.GTj($a);this.oGj(Ja,$a);this.Pej(Ja)};f.prototype.xKg=function(P,oa,Ja,$a){var Ta,pa,Da,rb,Ab=B(oa,Ja),ob=Ja.rangeDelta.data.formatted,sb=x(Ja),Pb=A(Ja);P=this.C$c(P,ob,sb,oa.cell.YAa,oa.cell.I$,Ab,!1);Ab=oa.cell.R_d;if(Object(va.c)(P))if(this.bAb&&this.Xqd){if(0===Pb||oa.text!==P.value.text)this.Poi&&0===Pb&&this.uQd(Ab,P.value)&&(oa.cell.formattedText=Ab),this.Gg.YYa(oa,P.value),Ja=v(Ja),this.Gg.p7c(oa,this.lastSetCellInstantaneousOperation,2,Ja,!0,!0),0===Pb&&xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6487996_CalcNotifiesRecalcComplete")&&
(this.calcManager?this.calcManager.Crf(oa.range):O.ULS.sendTraceTag(521171802,0,15,"CalcResultsProcessor.applyRecalcResultOnCell: Unable to call notifyEditedCellRecalcComplete as calcManager member is null.")),$a.numberOfUpdatedCells++}else oa.text!==P.value.text&&(this.Gg.YYa(oa,P.value),Ja=v(Ja),this.Gg.p7c(oa,this.lastSetCellInstantaneousOperation,2,Ja,!0,!0),$a.numberOfUpdatedCells++);else switch(P.reason){case "Null":$a.numberOfRecalcedCellsWithoutFormattedValue=(null!==(Ta=$a.numberOfRecalcedCellsWithoutFormattedValue)&&
void 0!==Ta?Ta:0)+1;break;case "Hashes":$a.numberOfHashFormattedValues=(null!==(pa=$a.numberOfHashFormattedValues)&&void 0!==pa?pa:0)+1;break;case "Finalize":$a.newNumberFormatterFinalizeFailures=(null!==(Da=$a.newNumberFormatterFinalizeFailures)&&void 0!==Da?Da:0)+1}Object(va.b)(P)&&"Null"!==P.reason&&($a.numberOfRecalcedCellsWithFormattedValue=(null!==(rb=$a.numberOfRecalcedCellsWithFormattedValue)&&void 0!==rb?rb:0)+1);$a=0===Pb?oa.cell.userInput:oa.formulaBarText;rb=Object(va.c)(P)?P.value.text:
"";Ja=Object(va.b)(P)?P.reason:"";O.ULS.sendTraceTag(537162180,0,50,"CalcResultProcessor.ApplyRecalcResultOnCell: ({0}, {1}) 2nd pass formatting, success: {2}, reason: {3}, priority: {4}, ifmt: {5}, input: '{6}', prediction: '{7}',",oa.range.top,oa.range.left,P.success,Ja,Pb,oa.cell.Xk,$a?ba.a.XL($a):"null",rb?ba.a.XL(rb):"null")};f.prototype.GTj=function(P){this.Oca=Math.max(this.Oca-Math.max(P,1),0)};f.prototype.oGj=function(P,oa){P.numberOfNonUpdatedCells=this.Tca.length;P.totalExecutionTime=oa;
P.newProcessingTimeLimit=this.Oca;P.lastSetCellInstantaneousOperation=this.lastSetCellInstantaneousOperation};f.prototype.Pej=function(P){P=Sys.Serialization.JavaScriptSerializer.serialize(P);O.ULS.sendTraceTag(574993417,0,50,"CalcResultProcessor.ReportRecalcProcessingStatistics:{0}",P)};f.bDh=function(P,oa){P=P.units;var Ja=oa.units;if(P.length!==Ja.length)return O.ULS.sendTraceTag(537162179,0,15,"CalcResultProcessor.FormattedValueToNumberFormatInformation: can't convert to NumberFormatInformation: units and finalized units don't have the same length!"),
null;oa=[];for(var $a=-1,Ta=0;Ta<P.length;Ta++)switch(P[Ta].kind){case z.blank:oa.push.apply(oa,yk(ra.h(" ",Ja[Ta].str.length)));break;case z.string:oa.push(P[Ta].str);break;case z.zBh:oa.push("");$a=Ta;break;case z.general:oa.push(Ja[Ta].str);break;default:O.ULS.sendTraceTag(537162178,0,15,"CalcResultProcessor.ProcessFormattedValue: unknown FormattedUnitKind!")}if(0>=$a||""===Ja[$a].str)return null;Ja={};Ja.Start=oa.slice(0,$a).join("");Ja.Separator=P[$a].str;Ja.End=oa.slice($a+1,oa.length).join("");
return Ja};f.QJh=function(P){return P&&P&&P.Vt?P.Vt.oJ:Ea.a.Fe};f.$Tg=function(P,oa){if(!oa)return!1;oa=f.QJh(oa);return oa===Ea.a.Fe||oa===P};f.Qlc=function(P,oa,Ja,$a){var Ta=Ja.rangeDelta.data.value.toString(),pa=x(Ja),Da=B(oa,Ja);Ta=new r(pa,Ta,Da,Ja.priorityGroup);oa.cell.Qlc(Ta,P.Ea.w5);1===A(Ja)?$a.numberOfDependentRecalcedCellsInBatch++:$a.numberOfEditedRecalcedCellsInBatch++};f.prototype.uQd=function(P,oa){return null==P?!1:!!P.TextRuns&&!!P.Fonts&&P.Text===oa.text&&2===oa.valueType};f.XFe=
20;Object(u.a)(f,"CalcResultProcessor",null,[700,10]);Object(u.a)(m,"GetRibbonNumberFormatResult",null,[]);var W=b(1117);l.prototype.ocb=function(P,oa,Ja,$a,Ta,pa){P&&(P.u0(oa,Ja,void 0===Ta?!1:Ta,void 0===pa?!1:pa),P.verticalAlignment=$a)};l.prototype.aKb=function(P,oa,Ja){this.px||(this.px=new W.a(this.Ea,this.m2a));this.px.aKb(P,oa,Ja)};Object(u.a)(l,"FormatCellsActionModelAccessor",null,[699]);var La=b(217),Ia=b(28),mb=b(29),fb=b(296),Ma=b(261),Hb=b(295),Kb=b(74);Object(u.a)(k,"FormatCellInstantaneousResult",
null,[]);Object(u.a)(e,"FormatStringResult",null,[]);var Ub=b(21),gb=b(206),Db=b(1292),Va=b(42),yb=b(568),qb=b(50),dc=b(205),bb=b(275),db=b(77),wc=b(178),nb;(function(P){P.InvalidInput="invalid input";P.UnsupportedZeroResize="resizing to 0 - ignore";P.UnsupportedSkeletonInView="skeleton in view - ignore";P.NullSPD="ActiveSheetProcessedData is null";P.UnsupportedHiddenInRange="hiddens in resizeRanges";P.UnsupportedMergeCell="There's a merge cell across blocks in resizeRanges"})(nb||(nb={}));Object(u.b)("InstantaneousRowColumnResizeFailureReason",
nb);var zb=b(328);d.prototype.dispose=function(){N.a.oc([this.YRa,this.E2]);this.$=this.E2=this.YRa=null};d.prototype.EAa=function(P,oa,Ja,$a,Ta,pa,Da,rb,Ab){return this.$zj(P,oa,Ja,void 0===Ta?!1:Ta,void 0===rb?0:rb,void 0===pa?"":pa,void 0===Ab?null:Ab)};d.prototype.p7c=function(P,oa,Ja,$a,Ta,pa){P.cell.Vt.mM|=$a;d.r0g(Ub.g(this.$),P,Ja,Ta);this.E2.lastSetCellInstantaneousOperation=oa;pa&&Ub.g(this.$).ui.B0(oa,Kb.BasicTelemetryCalculator.NQ)};d.prototype.Mda=function(P,oa,Ja,$a,Ta,pa){$a=void 0===
$a?!1:$a;Ta=void 0===Ta?null:Ta;var Da=void 0===Da?null:Da;pa=(void 0===pa?null:pa)||P.ha.sa.selectedRanges;if(!(-1690267012===oa&&1<pa.length)){-1690267012===oa&&O.ULS.shipAssertTag(537162176,0,1===pa.length,"FormatCellsAction.ShowInstantaneousFormatting: targetRanges.Length = {0}",pa.length);var rb=P.H$("FormatCellsAction.ShowInstantaneousFormatting",pa);try{rb.$$rst();for(var Ab=!1;rb.$$mn();){var ob=void 0,sb=rb.$$cu().dF?P.yJb(rb.$$cu().range):(ob=new Q.a,ob.add(rb.$$cu()),ob);ob={};for(var Pb=
ak(sb),Aa=Pb.next();!Aa.done;ob={Cfb:ob.Cfb},Aa=Pb.next()){var Ya=Aa.value;if(Ub.g(this.$).mz&&Ya&&Da&&-1690267012===oa&&(ob.Cfb=Ya.range,ob.Cfb&&Da.contains(ob.Cfb)&&H.a.all(pa,function(kb){return function(lb){return!ha.c(lb,kb.Cfb)}}(ob))))continue;if(!Ya||rb.gb.contains(Ya.range))if(this.V2f(oa,Ya,Ja,$a,Ta,rb.$$cu().dF),Ab||(P.Ea.qV(),Ab=!0),Ta)break}}}finally{rb&&rb.dispose()}}};d.prototype.YYa=function(P,oa,Ja){if(Ja=void 0===Ja?null:Ja)Ja.awa=!0;Ja=!oa.text;var $a=ba.a.Aef(oa.text),Ta,pa=P.dF?
Ub.g(this.$).yJb(P.range):(Ta=new Q.a,Ta.add(P),Ta);Ta=ak(pa);for(pa=Ta.next();!pa.done;pa=Ta.next())this.vKg(this.$,pa.value,oa.text,oa.horizontalAlignment,oa.fontColor,oa.Xk,P.cell.Xk,Ja,$a,oa.valueType,oa.S8a);P.cell.SBc()};d.prototype.oXi=function(P,oa,Ja,$a,Ta){Ta=void 0===Ta?null:Ta;try{var pa=ha.D(oa),Da=ha.D(Ja);if(P.Ab.k6a(pa)||P.Ab.k6a(Da))return 8;if(-185374993!==$a&&this.Kmi(P,pa,Da))return 9;if(-185374993!==$a&&(P.Ab.e5(Da)||P.Ab.xzb(pa)))return 10;if(1804571062!==$a&&P.Ab.c5(Da))return 11;
if(this.nhh(Da))return 12;if(this.Bni(pa,Da))return 13;var rb=this.$.Fb.sc("UserAction","PasteInstantaneous");rb.start();yb.a(rb);Ta&&qb.b().wA(rb.id,Ta.id,"actions","actions");!pa.isSingle&&Da.isSingle&&(Da=d.expandRange(pa,Da),P.ha.updateSelection(Da,Da,0));switch($a){case 237279923:case 808159687:if(!this.FXi(pa,Da))return 14;this.l2c(P,pa,Da,!0,!1);break;case 1804571062:this.l2c(P,pa,Da,!0,!1);break;case -185374993:this.l2c(P,pa,Da,!1,!0);break;default:return 2}O.ULS.sendTraceTag(537162146,0,
50,"FormatCellsAction.PasteInstantaneous: Complete processing.");return 1}catch(Ab){return O.ULS.sendTraceTag(537162145,0,10,"FormatCellsAction.PasteInstantaneous: failed with the following error: {0}",JSON.stringify(Ab)),15}};d.prototype.lYg=function(P,oa){P=ak(P);for(var Ja=P.next();!Ja.done;Ja=P.next())this.Y_c(Ja.value,!0,oa)};d.prototype.Y_c=function(P,oa,Ja){Ja=void 0===Ja?"":Ja;if(P){var $a=Ub.g(this.$);if(oa){if(oa=$a.pk("FormatCellsAction.ClearRangeInstantaneous",P),P=P.isSingle?null:P,oa.$$mn()&&
void 0!==oa.$$cu()&&null!==oa.$$cu())for($a=Object(J.a)(new bb.a,{Text:""}),this.EAa(oa.$$cu(),$a,!1,void 0,Na.a.ugc(this.$),Ja,void 0,void 0,P);oa.$$mn();)void 0!==oa.$$cu()&&null!==oa.$$cu()&&this.EAa(oa.$$cu(),$a,!1,void 0,!1,Ja)}else this.Mda($a,-1228228458,{},void 0,void 0,[P])}else O.ULS.shipAssertTag(537162144,0,!1,"FormatCellsAction.ClearRangeInstantaneous: targetRange shouldn't be null")};d.prototype.R6i=function(P,oa){if(!oa){oa=na.HelperMethods.Qb();var Ja=Ub.g(this.$),$a=Ja.H$("FormatCellsAction.ReformatCells",
P);try{$a.$$rst();for(var Ta=!1;$a.$$mn();){var pa=$a.$$cu().cell;if(0===pa.dM||2===pa.dM)this.updateSpillInformation(pa,P),Ta||(Ja.Ea.qV(),Ta=!0)}}finally{$a&&$a.dispose()}O.ULS.sendTraceTag(537162143,0,50,"FormatCellsAction.ReformatCellsAfterGeometryChange: reformatting cells total time: {0}.",na.HelperMethods.Qb()-oa)}};d.prototype.fdc=function(P,oa){if(this.tb){if(P.formulaBarText)return!ba.a.equals(oa.Text,P.formulaBarText,!1);var Ja=P.cell.formattedText;Ja=Ma.a(Ja,P.cell.getCellFont());return!gridRenderer.CanvasRendererGlobals.compareFormattedTexts(Ja,
oa).isEqual}return!ba.a.equals(oa.Text,P.text,!1)};d.prototype.XCh=function(P){if(void 0===P||null===P)return new e(!1,"1234.56");P=this.G2a({value:"1234.56",type:1},P,244,"12px sans-serif");return Object(va.b)(P)?new e(!1,"1234.56"):new e(!0,P.value.text)};d.prototype.aAj=function(P,oa,Ja,$a){return T(P,this,oa,Ja,$a,!0)};d.prototype.U2f=function(P,oa,Ja){if(!this.fdc(oa,Ja))return Object(va.d)("Skip unchanged cell content");oa=oa.cell;Ja=this.dUe(Ja.Text,oa.Xk,oa.YAa,oa.I$,!0);if(Object(va.b)(Ja))P=
Ja;else{Ja=Ja.value;var $a=Ja.text;var Ta=Ja.valueType;$a=oa.hasRichValueIcon?"Unsupported rich value icon":oa.zea?xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EstimateWrapTextEditResize",!1)&&2==Ta&&'normal 11pt "calibri"'===oa.I$&&oa.SAe($a)>=oa.offsetWidth*Math.floor(oa.offsetHeight/Ea.a.Orb)?"Unsupported wrapped text with long input":"Unsupported wrapped text":oa.uhf||null!=oa.lS&&0!==oa.lS?"Unsupported rotated text":!0;!0!==$a?P=Object(va.a)($a):(oa.isCellWidthFixed?$a="Skip fixed width cell":
($a=Ja.valueType,$a=0===$a?"Skip empty cell value":2===$a?"Skip string cell value":oa.SM&&!oa.Emi?"Skip merged cell":oa.Jxc?"Skip shrunk to fit":Ja.isHashesValue?"Skip hashes cell value":!0),!0!==$a?P=Object(va.d)($a):(Ja=oa.SAe(Ja.text),Ja>oa.offsetWidth?(oa=[oa.getRange().clone()],P=T(P,this,oa,Ja,!1,!1),P=Object(va.b)(P)?P:Object(va.d)(Ja)):P=Object(va.d)("Column is wide enough")))}return P};d.prototype.bUe=function(P,oa,Ja,$a,Ta){var pa={};pa.value=P;pa.type=Ja;oa=this.G2a(pa,oa,$a,Ta);return Object(va.b)(oa)?
new e(!1,P):new e(!0,oa.value.text)};d.prototype.updateSpillInformation=function(P,oa){var Ja=P.getRange(),$a=!1;oa=ak(oa);for(var Ta=oa.next();!Ta.done;Ta=oa.next())if(Ja.left===Ta.value.left){$a=!0;break}P.xQj($a)};d.prototype.$zj=function(P,oa,Ja,$a,Ta,pa,Da){var rb=void 0;pa=void 0===pa?"":pa;rb=void 0===rb?1:rb;Da=void 0===Da?null:Da;this.bAb&&this.Qoi&&(P.cell.R_d=oa);var Ab=new k;Ab.source=0;Ab.awa=!1;P.cell.Ooc=P.cell.Xk;var ob=oa.Text,sb=!ob,Pb=ba.a.Aef(ob);ba.a.wq(ob)&&(O.ULS.shipAssertTag(537162142,
0,!((void 0===ob||null===ob)&&void 0!==oa.TextRuns&&null!==oa.TextRuns),"FormatCellsAction.ShowInstantaneousDataEntryOnCellInternal: Text is null but TextRuns isn't"),oa=Object(J.a)(new bb.a,{Text:""}),ob="");P.cell.userInput=ob;if(!this.fdc(P,oa))return this.GVg(P,Ta,sb,Pb,Ab);Ja?this.zVg(P,ob,this.$.workbookContext.DefaultHyperlinkStyle,Ab):this.tVg(P,oa,ob,sb,Pb,$a,Ab,Da);this.p7c(P,pa,Ta,rb,Ab.phc,Ab.awa);return Ab};d.prototype.GVg=function(P,oa,Ja,$a,Ta){Ta.Peg=!0;Ta.phc=!0;Ta.awa=!1;0===oa&&
Ub.g(this.$).Ea.qV();0===P.cell.Jya&&(Ja?P.cell.u0(0,!1):$a&&P.cell.u0(1,!1));this.JWd(P.range,"FormatCellsAction.cellUnchangedDataEntryCSE");return Ta};d.prototype.zVg=function(P,oa,Ja,$a){$a.awa=!0;P.insertHyperlink(oa,Ka.a.jad(oa),Ja);this.JWd(P.range,"FormatCellsAction.cellDataEntryCSE")};d.prototype.tVg=function(P,oa,Ja,$a,Ta,pa,Da,rb){rb=void 0===rb?null:rb;Da.awa=!1;var Ab=P.cell;this.lz||(this.lz=this.$.da.za(268));this.lMj(this.lz,Ab.Xk);$a||Ta?this.vVg(P,$a,Ta,Da):($a=this.dUe(Ja,Ab.Xk,
Ab.YAa,Ab.I$,!1),Object(va.c)($a)?(this.uQd(oa.TextRuns,oa.Fonts)&&this.xVg(P,oa,$a.value),this.YYa(P,$a.value,Da),this.JWd(P.range,"FormatCellsAction.cellDataEntryCSE")):this.bAb&&this.Xqd?this.DVg(P,oa.Text,Da):this.EVg(P,oa.Text),oa=Object(va.c)($a)?$a.value.text:"",Ta=Object(va.b)($a)?$a.reason:"",O.ULS.sendTraceTag(559724065,0,50,"FormatCellsAction.CellDataEntryCSE: ({0}, {1}) 1st pass formatting, success: {2}, reason: {3}, ifmt: {4}, input: '{5}', prediction: '{6}',",P.range.top,P.range.left,
$a.success,Ta,Ab.Xk,ba.a.SYa(Ab.userInput),ba.a.SYa(oa)));Ab.formulaBarText=Ja;pa&&this.MLj(this.lz,P,Ja,rb);Da.phc=!0};d.prototype.vVg=function(P,oa,Ja,$a){$a.awa=!0;P.text="";P.formulaBarText="";P.cell.userInput="";this.A1b(P,null,null,oa,Ja)};d.prototype.xVg=function(P,oa,Ja){oa.Text===Ja.text&&2===Ja.valueType&&(P.cell.formattedText=oa)};d.prototype.DVg=function(P,oa,Ja){Ja&&(Ja.awa=!0);P.text=oa;P.formulaBarText=oa;this.A1b(P,1)};d.prototype.EVg=function(P,oa){P.text=oa;P.formulaBarText=oa;this.A1b(P,
1)};d.prototype.A1b=function(P,oa,Ja,$a,Ta,pa){Ja=void 0===Ja?null:Ja;$a=void 0===$a?!1:$a;Ta=void 0===Ta?!1:Ta;pa=void 0===pa?!1:pa;var Da=P.horizontalAlignment;Ja=null!=Ja?Ja:P.verticalAlignment;0===P.cell.Jya&&(null!=oa||$a||Ta||pa)&&($a?Da=0:Ta||pa?Da=1:null!=oa&&(Da=oa),this.xua.ocb(P,Da,!1,Ja,!0))};d.prototype.JWd=function(P,oa){var Ja=this;if(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6487996_CalcNotifiesRecalcComplete")){var $a=Ub.g(this.$),Ta=function(){Ja.calcManager?Ja.calcManager.Crf(P):
O.ULS.sendTraceTag(521172961,0,50,"FormatCellsAction.cellUnchangedDataEntryCSE: Unable to call notifyEditedCellRecalcComplete as calcManager member is null. caller: "+oa+", cell "+P);$a.Wb.Nl(Ta)};$a.Wb.vm(Ta)}};d.prototype.lMj=function(P,oa){(null===P||void 0===P?0:P.$xa)&&oa>=d.gBh&&oa>P.$xa.length-1&&(O.ULS.sendTraceTag(537162141,0,50,"FormatCellsAction.TriggerSupportInformationRefresh: The cell has a missing format, ifmt:{0}. Triggering refresh...",oa),P.UTe())};d.prototype.MLj=function(P,oa,
Ja,$a){$a=void 0===$a?null:$a;if(void 0!==P&&null!==P)if(this.lz.pld)O.ULS.sendTraceTag(537162140,0,50,"FormatCellsAction.TriggerCalc: in manual mode - not recalcing");else{var Ta=this.$.da.za(266);Ta&&(this.E2.Oca=f.XFe,P&&(this.E2.Oca=P.C$e),Ta.oTg(oa,Ja,Object(ca.a)(this.E2,this.E2.PIf,"processResults"),$a))}};d.prototype.G2a=function(P,oa,Ja,$a){var Ta=this.$.da.za(266);if(!Ta)return Object(va.a)("calcManager is null");if(!Ta.pF)return Object(va.a)("calcManager.NumberFormatter is null");if(!this.lz)return Object(va.a)("instantaneousManager is null");
if("number"===typeof oa||"string"===typeof oa){var pa=Ta.tbc(oa);if(!Object(va.c)(pa))return pa;var Da=pa.value}else Da=oa;pa=Ta.pF;var rb=y(P);if(void 0===rb||null===rb)return Object(va.a)("cellValue is null");Ta=excelOnlineCalc.calc.cellValueToReadOper(Ta.config.mathpack,rb);if(void 0===Ta||null===Ta)return Object(va.a)("readOper is null");Ta=pa.applyFormat(Da,Ta,xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6328006_applyFormatDisplaysZeroes"));return excelOnlineCalc.util.isSuccess(Ta)?this.E2.C$c(pa,
Ta.value,P.type,Ja,$a,"number"===typeof oa?oa:-1,!1):Object(va.a)("NumberFormatter.ApplyFormat: "+JSON.stringify(Ta.reason.kind))};d.prototype.dUe=function(P,oa,Ja,$a,Ta){var pa=this.$.da.za(266);if(void 0===pa||null===pa)return Object(va.a)("calcManager is null");if(void 0===pa.pF||null===pa.pF)return Object(va.a)("calcManager.NumberFormatter is null");if(void 0===this.lz||null===this.lz)return Object(va.a)("instantaneousManager is null");if(this.bAb&&!Ta)return Object(va.a)("No main thread number formatter");
var Da=pa.tbc(oa);if(!Object(va.c)(Da))return Da;var rb=Da.value;Da=pa.pF;P=Da.parseEdit(P,rb);if(!excelOnlineCalc.util.isSuccess(P))return Object(va.a)("ParseEdit failure: reason="+P.reason.kind+", features="+P.reason.features);if(P.value.kind===fa.a.formula)return Object(va.a)("Main thread - skipping formula edit");pa=excelOnlineCalc.numfmt.applyValueEdit(Da,pa.localeInfo,rb,P.value);if(!excelOnlineCalc.util.isSuccess(pa))return Object(va.a)("NumberFormatter.FormatValueEdit: "+JSON.stringify(pa.reason.kind));
P=P.value;O.ULS.shipAssertTag(537162190,0,P.kind!==fa.a.formula,"CalcInterfaceAdapter.GetCellValueTypeFromParsedEdit: given parsed edit must be a value edit!");P=excelOnlineCalc.numfmt.getValueEditOperKind(P);rb=0;switch(P){case 0:case 128:rb=0;break;case 1:rb=1;break;case 2:rb=2;break;case 4:rb=3;break;case 8:rb=4;break;case 16:case 32:case 64:case 256:O.ULS.sendTraceTag(537162189,0,15,"CalcInterfaceAdapter.OperKindToCellValueType: can't convert given OperKind {0} to a CellValueType",P);break;default:O.ULS.shipAssertTag(537162188,
0,!1,"CalcInterfaceAdapter.OperKindToCellValueType: Unexpected oper kind {0}",P)}return this.E2.C$c(Da,pa.value,rb,Ja,$a,"number"===typeof oa?oa:-1,Ta)};d.prototype.Kmi=function(P,oa,Ja){if(oa.width<Ja.width)for(var $a=P.pk("FormatCellsAction.IsSourceRangeLargerAndWithBorders",new qa.Range(oa.top,oa.left,oa.bottom,oa.left,!0,!0));$a.$$mn();){var Ta=$a.$$cu();if(Ta&&Ta.GKa())return O.ULS.sendTraceTag(537162139,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0}if(oa.height<
Ja.height)for(P=P.pk("FormatCellsAction.IsSourceRangeLargerAndWithBorders2",new qa.Range(oa.top,oa.left,oa.top,oa.right,!0,!0));P.$$mn();)if((oa=P.$$cu())&&oa.JKa())return O.ULS.sendTraceTag(537162138,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0;return!1};d.prototype.l2c=function(P,oa,Ja,$a,Ta){for(var pa=oa.oS().FirstRow,Da=oa.oS().LastRow,rb=Ja.oS().LastRow,Ab=pa,ob=Ja.oS().FirstRow;ob<=rb;ob++,Ab++){Ab>Da&&(Ab=pa);var sb=oa.oS();sb.FirstRow=sb.LastRow=Ab;
var Pb=Ja.oS();Pb.FirstRow=Pb.LastRow=ob;this.o3g(P,ka.a.vQ(sb),ka.a.vQ(Pb),$a,Ta)}};d.prototype.FXi=function(P,oa){var Ja=this.$.da.za(266);return void 0!==Ja&&null!==Ja?(Ja.iTg(P,oa.topLeft,Object(ca.a)(this.E2,this.E2.PIf,"processResults")),!0):!1};d.prototype.Bni=function(P,oa){var Ja=P.right-P.left+1;P=P.bottom-P.top+1;var $a=oa.right-oa.left+1;oa=oa.bottom-oa.top+1;if($a>Ja&&oa>P){if(!($a%Ja&&oa%P))return!0}else if($a===Ja&&oa>P){if(!(oa%P))return!0}else if($a>Ja&&oa===P&&!($a%Ja))return!0;
return!1};d.prototype.nhh=function(P){if(xa.EwaSettings.ma(103)){P=Ub.g(this.$).Y0(P).gridView.getRangeInformation(P);P=ak(P);for(var oa=P.next();!oa.done;oa=P.next())if(oa=oa.value,Object(X.a)(Y.DynamicArrayRange,oa)&&!Object(Z.a)(Y.DynamicArrayRange,oa).Ilc)return!0}return!1};d.prototype.JBe=function(P,oa,Ja,$a,Ta,pa){oa=ak(oa);for(var Da=oa.next();!Da.done;Da=oa.next())Da=Da.value,Ja&&(this.s3g(Da,Ta),Da.setCell(!0)),$a&&(pa=this.Y2h(Ta,Da)),pa||(P.Ea.qV(),pa=!0);return pa};d.prototype.POh=function(P,
oa,Ja){oa=new qa.Range(oa,Ja,oa,Ja,!0,!0);return P.Ub(oa)};d.prototype.o3g=function(P,oa,Ja,$a,Ta){if(Ja){this.YRa&&Ja.equals(this.YRa.range)||(N.a.Ia(this.YRa),this.YRa=P.pk("FormatCellsAction.CopyBetweenRows",Ja));Ja=this.YRa;Ja.$$rst();var pa=!1;if(xa.EwaSettings.getBooleanFeatureGate(zb.a.FEe,!1)){var Da=oa.oS().FirstColumn+1,rb=oa.oS().LastColumn+1;oa=oa.oS().FirstRow+1;for(var Ab=Da;Ja.$$mn();){Ab>rb&&(Ab=Da);var ob=this.POh(P,oa,Ab);Ab+=1;var sb=void 0,Pb=Ja.$$cu().dF?P.yJb(Ja.$$cu().range):
(sb=new Q.a,sb.add(Ja.$$cu()),sb);ob&&(pa=this.JBe(P,Pb,$a,Ta,ob,pa));db.lastOrDefault(Pb)}}else for(Da=P.pk("FormatCellsAction.CopyBetweenRows2",oa);Ja.$$mn();)Da.$$mn()||(Da.$$rst(),Da.$$mn()),rb=Da.$$cu(),oa=void 0,Ab=Ja.$$cu().dF?P.yJb(Ja.$$cu().range):(oa=new Q.a,oa.add(Ja.$$cu()),oa),rb&&(pa=this.JBe(P,Ab,$a,Ta,rb,pa)),db.lastOrDefault(Ab)}else O.ULS.sendTraceTag(537162137,0,50,"FormatCellsAction.CopyBetweenRows: targetRange is null")};d.prototype.n3f=function(){var P=mb.a.Wc(1,0,0,651,0,104573951,
"PivotTableContextMenuOperationFailure");Va.a(this.$).kj(P)};d.prototype.qyi=function(P,oa){var Ja={ValidMembers:32},$a=oa.NumberFormat;switch(P){case 1890566896:if(1001===$a||1002===$a||1003===$a){Ja.NumberFormat=14;Ja.NumberFormatOptions={};switch($a){case 1001:Ja.NumberFormatOptions.TimeType=2;break;case 1002:Ja.NumberFormatOptions.DateType=7;break;case 1003:Ja.NumberFormatOptions.DecimalPlaces=0}Ja.NumberFormatOptions.NumberFormatCategory=this.jKg($a)}else Ja.NumberFormat=$a;break;case 1886928607:Ja.NumberFormat=
13;break;case -992833457:Ja.NumberFormat=11;break;case 218524921:Ja.NumberFormat=12;break;case 996232352:Ja.NumberFormat=14;Ja.NumberFormatOptions=Object(J.a)(new ea.a,{DecimalPlaces:0});Ja.NumberFormatOptions.NumberFormatCategory=6;break;default:return oa}return Ja};d.prototype.formatCells=function(P,oa,Ja,$a,Ta,pa,Da){$a=void 0===$a?null:$a;Ta=void 0===Ta?null:Ta;pa=void 0===pa?null:pa;Da=void 0===Da?null:Da;var rb=this.$.Fb.sc("UserAction","FormatCellsInstantaneous, command = "+qb.b().fi(P)),Ab=
this.$.Fb.Lg("UserAction","FormatCellsInstantaneousFrame");Ab.start();yb.a(Ab);var ob=qb.b().fi(P),sb=this.$,Pb=Ub.g(sb),Aa=Pb.ha.sa,Ya=Ta||Aa.selectedRanges,kb=ra.g(Ya,function(mc){return mc.aM});ob=String.format("{0}, cellCount={1}",ob,kb);Ub.g(this.$).ui.w7(1,rb.id,ob);Ya=ha.r(Ya,this.$);Aa=Aa.activeCell;ob=-168056295===Ja.command;var lb=kb=null;if(ob){lb=Pb.Ab.To(Aa);if(!lb){this.n3f();return}kb=lb.Eca.substring(1,lb.Eca.length-1);lb=lb.uac();if(!lb){this.n3f();return}lb=lb.Caption}Pb.ig.IG(!1,
!0);var ac=ha.o(Aa,sb),Dc=sb.oa.xa.Pb({r_:!0,JZ:1}),Zb=this.qyi(Ja.command,oa);ob||this.Mda(Pb,P,oa,!1,$a,Ta);rb.stop();Ub.g(this.$).ui.B0(rb.id,Kb.BasicTelemetryCalculator.NQ);Ja.$bi=Ia.a.Ta.Jb;$a=this.$.Fb.sc("UserAction","FormatCellsUserAction");this.Fui(P,Ja.taskId,oa,Ya,Aa,$a.id);qb.b().wA(rb.id,$a.id,"actions","actions");qb.b().wA(Ab.id,$a.id,"actions","actions");xa.EwaSettings.Zb()?sb.userOperationManager.Sb(new U(this,Ya,ac,Zb,ob,kb,lb,Dc,$a,rb.id,64,pa,Da),Ja):sb.userOperationManager.Sb(new U(this,
Ya,ac,Zb,ob,kb,lb,Dc,$a,rb.id,0,pa,Da),Ja)};d.prototype.C2=function(P,oa,Ja,$a,Ta,pa,Da,rb,Ab,ob,sb){var Pb=this,Aa=this.$;return function(Ya,kb,lb){Aa.ry();Ya=[Ya,Pb.wKi];kb=[kb];ob&&Ya.push(ob);sb&&kb.push(sb);return ia.l(Aa.oa.xa,P,oa,Ja,$a,Ta,pa,!1,Hb.b.apply(Hb,yk(Ya)),Hb.a.apply(Hb,yk(kb)),lb,Ab,Da,rb)}};d.prototype.V2f=function(P,oa,Ja,$a,Ta,pa,Da){Da=void 0===Da?null:Da;if(oa&&Ja){var rb=Ja.Font,Ab=Ja.HorizontalAlignment,ob=Ja.VerticalAlignment;Ja.ValidMembers&2||(Ab=oa.horizontalAlignment);
Ja.ValidMembers&1||(ob=oa.verticalAlignment);var sb=0!==Ab;d.lei(P)&&0===Ab&&(Ab=this.dZe(oa));var Pb=!1;switch(P){case -394785302:this.xua.ocb(oa,Ab,sb,0);break;case 1041132226:this.xua.ocb(oa,Ab,sb,1);break;case -571165336:this.xua.ocb(oa,Ab,sb,2);break;case -1150205178:case -1142465846:case -286432209:this.xua.ocb(oa,Ab,sb,ob,!1,!1);break;case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:this.AMa&&this.Ioj(oa,Ja,sb);break;case 1650812936:this.setFillColor(oa,
Ja,pa);break;case -287251124:oa.bold=rb.Bold;break;case -1690267012:Ub.g(this.$).ha.sa.tg&&(rb=xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1)?Da?Da:Ub.g(this.$).ha.sa.Vc:Ub.g(this.$).ha.sa.Vc,this.xua.aKb(oa,Ja,rb));break;case 1970784898:Ja=la.a.Qo(oa.color,oa.backgroundColor);if(La.a.compare(Ja,La.a.red)&&(ba.a.a5(oa.text)||ba.a.S5e(oa.text)))break;rb=La.a.YG(rb.FontColor);oa.color=dc.e(la.a.$F(rb));break;case -1925065947:oa.italic=rb.Italic;
break;case -1293291468:Ja=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");this.Cm?(oa.tKb(rb.FontName,Ja,"ShowInstantaneousFormattingOnCell"),oa.SYf(rb.FontScheme)):oa.tKb(rb.FontName,Ja,"ShowInstantaneousFormattingOnCell");break;case 862890474:case 963349338:oa.fontSize=rb.FontSize;this.$.jf();break;case -1077965542:oa.fontSize=rb.FontSize;break;case 1764140053:oa.underline=rb.Underline;break;case -1685033574:oa.doubleUnderline=rb.DoubleUnderline;break;case -1590502662:oa.fontStrikethrough=
rb.Strikethrough;break;case -848953656:case 2045211913:Pb=oa.Npb();break;case 2105621672:rb=Object(Z.a)(Db.a,Ta);if(!rb)break;Ja=La.a.XDh(rb.color);oa.color=dc.e(la.a.$F(Ja));this.Mqe(oa,rb.Zlc);break;case -1409276245:this.Mqe(oa,Ja.NumberFormatOptions.CustomFormatString);break;case 1890566896:this.uKg(oa,Ja);break;case -1228228458:oa.Npb();oa.clearFormat();this.gWc(oa,0);Pb=!0;break;case -730106152:oa.clearFormat();this.gWc(oa,0);break;case 932244020:this.Hoj(oa,Ja,pa);break;case -1942512156:case -1920201820:this.Fqj(oa,
Ja)}$a||(Pb?oa.uHb(!0):oa.setCell(!0))}else O.ULS.shipAssertTag(537162135,0,!oa,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellToFormat"),O.ULS.shipAssertTag(537162134,0,!Ja,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellFormat")};d.prototype.s3g=function(P,oa){P&&oa?(P.Wpb(oa),P.o0c(oa),this.gWc(P,oa.cell.Xk)):O.ULS.sendTraceTag(537162133,0,10,"FormatCellsAction.CopyFormattingBetweenCells:cellToFormat & sourceCell should not be null")};d.prototype.gWc=function(P,oa){if(0>
oa)this.Wba({caller:"ApplyNumberFormatIndexOnCell",cell:P,kind:"failure",reason:"ApplyNumberFormatIndexOnCell: negative format index was supplied"});else{var Ja=this.G2a(P.Sw,oa,P.cell.YAa,P.cell.I$);Object(va.b)(Ja)?this.Wba({caller:"ApplyNumberFormatIndexOnCell",cell:P,kind:"failure",reason:Ja.reason}):(this.YYa(P,Ja.value),this.Wba({caller:"ApplyNumberFormatIndexOnCell",cell:P,kind:"success",gz:Ja.value,format:oa}))}};d.prototype.Mqe=function(P,oa){if(void 0===oa||null===oa)this.Wba({caller:"ApplyNumberFormatStringOnCell",
cell:P,kind:"failure",reason:"ApplyNumberFormatStringOnCell: no format string was supplied"});else{var Ja=this.G2a(P.Sw,oa,P.cell.YAa,P.cell.I$);Object(va.b)(Ja)?this.Wba({caller:"ApplyNumberFormatStringOnCell",cell:P,kind:"failure",reason:Ja.reason}):(this.YYa(P,Ja.value),this.Wba({caller:"ApplyNumberFormatStringOnCell",cell:P,kind:"success",gz:Ja.value,format:oa}))}};d.prototype.uKg=function(P,oa){if(oa=void 0===oa?null:oa)if(oa=this.UVh(P,oa),oa.success){var Ja=this.G2a(P.Sw,oa.Vlc,P.cell.YAa,
P.cell.I$);Object(va.b)(Ja)?this.Wba({caller:"ApplyNumberFormatCategoryOnCell",cell:P,kind:"failure",reason:Ja.reason,format:oa.Vlc}):(this.YYa(P,Ja.value),this.Wba({caller:"ApplyNumberFormatCategoryOnCell",cell:P,kind:"success",gz:Ja.value,format:oa.Vlc}))}else this.Wba({caller:"ApplyNumberFormatCategoryOnCell",cell:P,kind:"failure",reason:oa.reason,format:oa.Vlc});else this.Wba({caller:"ApplyNumberFormatCategoryOnCell",cell:P,kind:"failure",reason:"ApplyNumberFormatCategoryOnCell: no format was supplied"})};
d.prototype.jKg=function(P){switch(P){case 1004:return 1;case 5:return-1;case 1002:return 4;case 6:case 1001:return 5;case 7:case 1003:return 6;case 8:return 7;case 9:return 8;case 10:return 9}return 10<P?-1:P};d.prototype.UVh=function(P,oa){if(!this.lz||!this.localeInfo||!oa)return P=this.lz?this.localeInfo?"cellFormat is null":"localeInfo is null":"instantaneousManager is null",new m(!1,void 0,"GetRibbonNumberFormat: "+P);oa=oa.NumberFormat;switch(oa){case 0:P=M.wEh;break;case 1:P=M.yEh;break;case 2:P=
M.uEh;break;case 3:P=M.sEh;break;case 4:P=M.BEh;break;case 5:P=M.xEh;break;case 6:P=M.DEh;break;case 7:P=M.zEh;break;case 8:P=M.vEh;break;case 9:P=M.AEh;break;case 10:P=M.CEh;break;case 11:case 12:return this.lz.UTe(),this.hMh(P,oa);case 13:P=M.fSg;break;case 1006:P=M.buttonPercentage;break;case 1004:P=M.keyboardNumber;break;case 1005:P=M.keyboardCurrency;break;case 1002:P=M.keyboardDate;break;case 1001:P=M.keyboardTime;break;case 1003:P=M.keyboardPercentage;break;case 14:return P="GetRibbonNumberFormat: should not be called with NumberFormatDialog!",
O.ULS.shipAssertTag(537162132,0,!1,P),new m(!1,void 0,P);default:return P="GetRibbonNumberFormat: unknown NumberFormatType!",O.ULS.shipAssertTag(537162131,0,!1,P),new m(!1,void 0,P)}return P?(P=excelOnlineCalc.numfmt.getRibbonFormat(this.localeInfo,P))?new m(!0,P):new m(!1,void 0,"GetRibbonNumberFormat: ExcelOnlineCalcService.NumberFormatter.GetRibbonNumberFormat unable to get ribbon format..."):new m(!1,void 0,"GetRibbonNumberFormat: unsupported ribbonFormatKind...")};d.prototype.hMh=function(P,
oa){if(!this.calcManager||!this.pF)return oa=this.calcManager?"numberFormatter is null":"calcManager is null",new m(!1,void 0,"GetDecimalChangeNumberFormat: "+oa);P=this.calcManager.tbc(P.cell.Xk);if(!Object(va.c)(P))return new m(!1,void 0,"getDecimalChangeNumberFormat: "+P.reason);oa=this.pF.changeFormatDecimals(P.value,11===oa?1:-1);return excelOnlineCalc.util.isSuccess(oa)?void 0===oa.value||null===oa.value?new m(!1,void 0,"GetDecimalChangeNumberFormat: successUndefined result"):new m(!0,oa.value):
new m(!1,void 0,"GetDecimalChangeNumberFormat: NumberFormatter.ChangeFormatDecimals failure")};d.prototype.Wba=function(P){var oa=P.caller,Ja=P.cell,$a=P.format;$a=null==$a?"null":"number"===typeof $a?$a:"string"===typeof $a?ba.a.SYa($a):ba.a.SYa($a.formatString);var Ta=ba.a.SYa(Ja.Sw.value)||"null",pa="success"===P.kind?ba.a.SYa(P.gz.text):"null";O.ULS.sendTraceTag(537162130,0,50,"FormatCellsAction.LogNumberFormatEdit: {0}",{caller:oa,"range.top":Ja.range.top,"range.left":Ja.range.left,result:P.kind,
reason:"success"===P.kind?"":P.reason,value:Ta,valueType:Ja.Sw.type,ifmt:$a,prediction:pa})};d.prototype.vKg=function(P,oa,Ja,$a,Ta,pa,Da,rb,Ab,ob,sb){rb=void 0===rb?!1:rb;Ab=void 0===Ab?!1:Ab;var Pb=oa.cell;Pb.dM=void 0===ob?0:ob;ob=oa.text;ob!==Ja&&(Pb.text=Ja);Pb.S8a=void 0===sb?null:sb;gb.f(ob)?oa.formulaBarText=ob:oa.formulaBarText="";P=Ub.g(P).Ab.kff(oa.range);this.A1b(oa,$a,null,rb,Ab,P);Ta&&(oa.color=dc.e(la.a.$F(Ta)));oa.cell.Xk=pa;oa.cell.Ooc=Da;oa.cell.NSd=pa};d.prototype.Fui=function(P,
oa,Ja,$a,Ta,pa){var Da={};Da.a=this.$.ya.UserSessionId;Da.b=oa;Da.c=$a.Ranges.length;Da.d=this.p7g($a.Ranges);Da.e=Ta.toString();Da.f=P;Da.h=pa;1890566896===P?Da.g=Ja.NumberFormat.toString():2105621672===P&&(Da.g=Ja.NumberFormatOptions.NumberFormatCategory.toString());qb.b().De(3,Da,!0)};d.prototype.p7g=function(P){for(var oa=0,Ja=0,$a=0,Ta=0;Ta<P.length;Ta++){var pa=ha.B(P[Ta]).aM;oa+=pa;pa>$a&&($a=pa,Ja=Ta)}P=ha.B(P[Ja]).toString();return"TotalCellCount:"+oa+"; Max range:"+P+"; MaxRangeSize:"+$a+
";"};d.prototype.Hoj=function(P,oa,Ja){64===(oa.ValidMembers&64)&&this.setFillColor(P,oa,Ja);16===(oa.ValidMembers&16)&&d.jqj(P,oa);128===(oa.ValidMembers&128)&&this.xua.aKb(P,oa,P.range);if(2===(oa.ValidMembers&2)||1===(oa.ValidMembers&1)){Ja=oa.VerticalAlignment;oa=oa.HorizontalAlignment;var $a=0!==oa;xa.EwaSettings.isChangeGateEnabled("OfficeVSO:3603507_calculateHorizontalAlignmentOnToggle")&&!$a&&this.dZe(P);this.xua.ocb(P,oa,$a,Ja)}};d.prototype.setFillColor=function(P,oa,Ja){(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:3634588_NoFillColorOnConditionalFormattingCell")?
P.Waa:P.Waa&&P.rwb&&!P.uwb&&!P.zwb)||(oa=-1===oa.FillColor?Ja?la.a.$F(La.a.white):null:la.a.$F(La.a.YG(oa.FillColor)),P.backgroundColor=oa?dc.e(oa):null)};d.prototype.Fqj=function(P,oa){0!==P.horizontalAlignment&&2!==P.horizontalAlignment||P.u0(1,!1);0<=P.indentation+oa.IndentationIncrease&&(P.indentation+=oa.IndentationIncrease)};d.prototype.Ioj=function(P,oa,Ja){var $a=P.lS,Ta=oa.TextOrientation;Ta!==Ea.a.verticalText&&(0>Ta||180<Ta)&&O.ULS.shipAssertTag(523090050,0,!1,"FormatCellsAction.setCellTextOrientation: invalid value for text orientation in server {0}",
Ta);$a===Ta||$a===Ea.a.Xtc&&Ta===Ea.a.Ytc||$a===Ea.a.Ztc&&Ta===Ea.a.$tc?oa.TextOrientation=0:(P.lS=oa.TextOrientation,Ja||P.u0(0<=P.lS?1:3,!1))};d.prototype.dZe=function(P){P=this.G2a(P.Sw,P.cell.Xk,P.cell.YAa,P.cell.I$);return Object(va.b)(P)?0:null!=P.value.horizontalAlignment?P.value.horizontalAlignment:0};d.prototype.Qrj=function(P,oa,Ja){this.px||(this.px=new W.a(Ub.g(this.$).Ea,this.$));this.px.aKb(P,oa,Ja)};d.prototype.Y2h=function(P,oa){var Ja=new bb.a;if(P.cell.formulaBarText&&P.cell.formulaBarText.startsWith("'"))Ja.Text=
P.cell.formulaBarText;else{var $a=P.cellValue;$a&&4!==P.cell.dM||($a=P.text);Ja.Text=$a}this.EAa(oa,Ja,!1,void 0,Na.a.ugc(this.$));return!0};d.prototype.uQd=function(P,oa){return this.tb&&!!P&&!!oa};d.r0g=function(P,oa,Ja,$a){$a&&oa.setCell(!0);0===Ja&&P.Ea.qV()};d.expandRange=function(P,oa){oa=oa.clone();oa.height<P.height&&(oa.bottom=oa.top+P.height-1);oa.width<P.width&&(oa.right=oa.left+P.width-1);return oa};d.lei=function(P){switch(P){case -1142465846:case -1150205178:case -286432209:case -571165336:case 1041132226:case -394785302:return!0;
default:return!1}};d.jqj=function(P,oa){oa=oa.Font;var Ja=0!==(oa.ValidMembers&16),$a=0!==(oa.ValidMembers&16),Ta=0!==(oa.ValidMembers&16);P.bold=0!==(oa.ValidMembers&4);P.italic=0!==(oa.ValidMembers&8);Ja&&(P.underline=Ja);$a&&(P.doubleUnderline=$a);Ta&&(P.fontStrikethrough=Ta);Ja=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");P.tKb(oa.FontName,Ja,"SetFont");P.fontSize=oa.FontSize;Ja=la.a.Qo(P.color,P.backgroundColor);La.a.compare(Ja,La.a.red)&&(ba.a.a5(P.text)||
ba.a.S5e(P.text))||(oa=La.a.YG(oa.FontColor),P.color=dc.e(la.a.$F(oa)))};Af.Object.defineProperties(d.prototype,{xua:{configurable:!0,enumerable:!0,get:function(){return this.RCh}},pF:{configurable:!0,enumerable:!0,get:function(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.pF}},localeInfo:{configurable:!0,enumerable:!0,get:function(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.localeInfo}}});d.gBh=36;Object(u.a)(d,"FormatCellsAction",
null,[591,10]);var ma=K.a;Rk(c,ma);c.prototype.create=function(){this.pb(new d(this.$))};c.ka=function(P){P.da.Ga(18,new c(P))};Object(u.a)(c,"FormatCellsActionFactory",K.a,[]);b.d(D,"a",function(){return a})},1369:function(u,D,b){function a(){B.a.Fa(c.ka)}function c(P){var oa=ma.call(this)||this;oa.$=P;x.EwaSettings.isChangeGateEnabled("OfficeVSO:6198510_AddServiceCreatedEvent")&&oa.Eb();return oa}function d(){}function e(P,oa,Ja,$a,Ta){Ja=void 0===Ja?null:Ja;$a=void 0===$a?null:$a;Ta=void 0===Ta?
0:Ta;P=l.call(this,P,oa)||this;P.qNa=null;P.kec=Ja||nb.a.current.Uo(104);P.Ekf=Ta;P.n4c=$a;P.sBg();return P}function k(P,oa,Ja,$a){P=l.call(this,P,oa)||this;P.ABb=null;P.mng=Ja;P.L5h=$a;P.tBg();return P}function l(P,oa){P=db.call(this,P)||this;P.BBb=null;P.F8h=Math.max(1,oa);return P}function m(P,oa,Ja,$a,Ta,pa,Da,rb){rb=void 0===rb?"":rb;var Ab=dc.call(this)||this;Ab.Xva=null;Ab.Z7e=!1;Ab.glc=null;Ab.flc=null;Ab.buttons={};Ab.JLe={};Ab.$=P;Ab.svgIconProvider=oa;Ab.DHi=Ja;Ab.akd=$a;Ab.$jd=Ta;Ab.altText=
pa;Ab.SFb=Da;Ab.buttonText=rb;return Ab}function f(P,oa,Ja,$a,Ta,pa,Da,rb){function Ab(sb){Kb.g(sb)}var ob=Va.call(this,document.createElement("div"))||this;ob.Pif=null;ob.URd=!1;ob.VRa=null;ob.JMb=null;ob.vN=function(){ob.raiseEvent("OnObjectButtonMouseOver")};ob.uN=function(){ob.raiseEvent("OnObjectButtonMouseOut")};ob.FBj=function(){ob.qje()};ob.$c=function(sb){ob.raiseEvent(ob.SFb,sb);ob.QFb();return!0};ob.lJi=function(sb){100<K.a(F.a.Ta,ob.Pif)&&ob.yhd(new Sys.UI.Point(Math.round(sb.clientX),
Math.round(sb.clientY)))};ob.qN=function(sb){Kb.g(sb.Ca,!1);return!1};ob.YY=ob.ke.uHa();ob.set_visible(!1);ob.Shc=Ta;ob.SFb=pa;ob.Klc=P;ob.o2b=oa;ob.Shc&&(ob.VRa=U.a.instance.create(ob.FBj,3E4,"OnObjectButton.ShyTimerFired",!1,!1));P&&ob.domElement.classList.add(P);ob.SZa=document.createElement("div");ob.domElement.appendChild(ob.SZa);Ja&&ob.SZa.classList.add(Ja);$a&&(ob.SZa.innerHTML=$a);Da&&(ob.JMb=document.createElement("div"),ob.domElement.appendChild(ob.JMb),ob.JMb.classList.add(rb),ob.JMb.innerText=
Da,ob.domElement.style.padding="3px",fb.a.instance.qa(Q.a.pointerDown,ob.domElement,ob.qN));ob.JZa=new Hb.a(ob.domElement,7);Ma.a.instance.qa(Q.a.click,ob.domElement,ob.$c);x.EwaSettings.isChangeGateEnabled("OfficeVSO:4996434_AvoidSelectionFromClickInOOUIPadding")&&fb.a.instance.qa(Q.a.pointerDown,ob.domElement,ob.qN);ob.yc.ka("mouseup",Ab);ob.yc.ka("click",Ab);ob.yc.ka("dblclick",Ab);return ob}function w(){}function n(P,oa,Ja,$a){var Ta=z.call(this,P,oa)||this;Ta.A1a=null;Ta.lwf=function(){Ta.rsc(Ta.lwf);
if(Ta.Hk&&Ta.Hk.length&&Ta.contextMenuManager){var pa=Ta.contextMenuManager.Icd("autoFilterRichFieldList"),Da=window.document.getElementById(Ta.A1a);pa.y0(null,Da,Ta,null,!0)}};Ta.Qkg=Ja;Ta.contextMenuManager=$a;return Ta}function z(P,oa){var Ja=sa.call(this)||this;Ja.dP=null;Ja.Vub=null;Ja.ndd=null;Ja.FIb=null;Ja.MTb=!1;Ja.z3d=null;Ja.tFd=!1;Ja.bLi=function($a,Ta,pa){C.ULS.sendTraceTag(25264350,0,10,"Call to GetRichValueFieldListContextList failed in: "+pa);Ja.FIb&&Ja.FIb.stop();Ja.dP=null;Ja.raiseEvent(wa.k)};
Ja.cLi=function($a){Ea.a($a)||(Ja.FIb&&Ja.FIb.stop(),Ja.MTb=!1,Ja.dP=$a.Result,Ja.dP&&0<Ja.dP.length&&C.ULS.sendTraceTag(25264351,0,50,"Retrieved {0} rich value field list context for autocomplete",Ja.dP.length),Ja.TVa=!0,Ja.Kqc())};Ja.TVa=!1;Ja.jb=P;Ja.vSb=-1;Ja.tableManager=oa;Ja.tFd=x.EwaSettings.isChangeGateEnabled("OfficeVSO:6395797_raiseFieldInfoLoadedEventOnEmptyResults")&&ba.a.WZ(P);return Ja}function r(P){var oa=ha.call(this)||this;oa.firstElement=null;oa.mw=null;oa.VLa=!1;oa.ps=null;oa.Fvj=
O.a.xf||O.a.iB;oa.myf=function(Ja){var $a=Ja.Ca.keyCode;return $a===N.a.Rh?oa.FJi():$a===N.a.Vz&&Ja.Ca.shiftKey?oa.ixh(oa.firstElement):!1};oa.JDf=function(Ja){if(!oa.VLa||Ja.Ca.keyCode!==N.a.lL)return!1;r.s7e();fa.Task.delay(1).eo(function(){oa.mw.focus();return!0},0,oa.la);return!0};oa.jUi=function(){document.activeElement&&document.activeElement.id===oa.mw.id||(r.s7e(),fa.Task.delay(1).eo(function(){oa.mw.focus();return!0},0,oa.la))};oa.rwf=function(){oa.T9f(oa.mw)};oa.lyf=function(Ja){Ja.stopPropagation();
Ja.preventDefault();oa.VLa&&(oa.VLa=!1)};oa.$=P;(P=oa.$.ea.ic)&&C.ULS.sendTraceTag(39350791,0,50,"EmbedViewFocusControl: PermissionSet = {0}; InWebPart = '{1}', InEmbedView = '{2}'",P.Lsa,P.inWebPart?"Classic":"Non Classic",P.inEmbedView?"True (+Modern)":"False (not Modern)");P&&(P.inWebPart||P.inEmbedView)?C.ULS.sendTraceTag(537153856,0,15,"EwaControl.EmbedViewFocusControl: disable focus grabbing by embedded workbooks and disable some related keyboard navigation. InWebPart = '{0}', InEmbedView = '{1}'",
P.inWebPart?"Classic":"Non Classic",P.inEmbedView?"True (+Modern)":"False (not Modern)"):(oa.i6g(),oa.g7g(),H.KeyInputManager.instance.qa(Q.a.Lb,oa.$.domElement,oa.JDf));oa.$.da.Ga(238,oa);return oa}function v(P,oa,Ja,$a,Ta){Ta=void 0===Ta?null:Ta;var pa=J.call(this)||this;pa.rnb=null;pa.GOa=null;pa.DYc=0;pa.Goc=null;pa.RQi=function(){var Da=pa.GOa.YXe();C.ULS.sendTraceTag(537153861,0,50,"ActionAggregator<{0}>.OnRunningLong: Operation running for more than {1}ms",pa.bla,Da);pa.Goc=U.a.instance.create(pa.o6,
Math.max(pa.zue-Da,0),M.a.eje)};pa.o6=function(){C.ULS.sendTraceTag(537153860,0,50,"ActionAggregator<{0}>.OnTimeout: Operation running for more than {1}ms, timing out. Has pending actions: {2}",pa.bla,pa.GOa.YXe(),pa.x5a);pa.DYc++;pa.DYc>pa.yue&&C.ULS.sendTraceTag(537153859,0,50,"ActionAggregator<{0}>.OnTimeout: passed the allowed bypassed count",pa.bla);pa.GOa.rx.cancel();pa.NSe()};pa.j9a=function(){pa.x5a&&C.ULS.sendTraceTag(537153858,0,50,"ActionAggregator<{0}>.OnDocumentUnhidden: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",
pa.bla,pa.vLa,pa.x5a);pa.wld()};pa.gzg=P;pa.hzg=oa;pa.documentVisibilityObserver=Ja;pa.bla=$a;pa.vO=Ta;Ja&&pa.documentVisibilityObserver.ZYb(pa.j9a);pa.CYc=!!Ja&&x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperation",!1);pa.yue=x.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLimit",3);oa=x.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationThresholdInMs",5E3);pa.zue=P.Tbd(oa);P=
x.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLogThresholdInMs",1E3);pa.rSg=Math.max(pa.zue-oa,0)+P;return pa}function A(){this.startTime=F.a.Ta.Jb;this.rx=new T.a}var B=b(11);u=b(0);var y=b(232),x=b(1),C=b(15),G=b(214),E=b(79),I=b(37),U=b(47),M=b(44),T=b(738),F=b(28),K=b(119);A.prototype.YXe=function(){return K.a(F.a.Ta,this.startTime)};Object(u.a)(A,"OngoingAction",null,[]);var J=E.a;Rk(v,J);v.prototype.KFf=function(P){C.ULS.sendTraceTag(537153864,0,50,
"ActionAggregator<{0}>.PerformThrottledAction: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",this.bla,this.vLa,this.x5a);this.rnb=this.hzg.BVc(P,this.rnb);this.wld()};v.prototype.dispose=function(){this.documentVisibilityObserver&&this.documentVisibilityObserver.OHb(this.j9a);this.dwe();J.prototype.dispose.call(this)};v.prototype.GZf=function(P){this.CYc?(this.GOa=P?new A:null,P?this.startTimer():this.dwe()):this.GOa=P?{}:null};v.prototype.NSe=function(P){P=void 0===P?null:P;
this.CYc&&P&&P.$J?C.ULS.sendTraceTag(537153863,0,50,"ActionAggregator<{0}>.FinishedCallback: timedout, skipping",this.bla):(C.ULS.sendTraceTag(537153862,0,50,"ActionAggregator<{0}>.FinishedCallback: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",this.bla,this.vLa,this.x5a),this.GZf(!1),this.wld())};v.prototype.wld=function(){var P=this;if(!this.mLb()){var oa=this.rnb;this.rnb=null;this.GZf(!0);C.ULS.sendTraceTag(537153857,0,50,"ActionAggregator<{0}>.InternalPerformAction: Calling PerformAction.",
this.bla);var Ja=this.CYc?this.GOa.rx.token:G.a.none;I.TaskExtensions.Ba(this.gzg.HCd(oa),function(){P.NSe(Ja)},Ja,0,this.vO)}};v.prototype.mLb=function(){return!this.x5a||this.vLa?!0:this.documentVisibilityObserver&&this.documentVisibilityObserver.Qi?(C.ULS.sendTraceTag(593376846,0,50,"ActionAggregator<{0}>.ShouldThrottle: Not Calling PerformAction as document is hidden.",this.bla),!0):!1};v.prototype.dwe=function(){this.Goc&&this.Goc.cancel()};v.prototype.startTimer=function(){this.DYc<=this.yue&&
(this.Goc=U.a.instance.create(this.RQi,this.rSg,M.a.eje))};Af.Object.defineProperties(v.prototype,{vLa:{configurable:!0,enumerable:!0,get:function(){return!!this.GOa}},x5a:{configurable:!0,enumerable:!0,get:function(){return!!this.rnb}}});Object(u.a)(v,"ActionAggregator",E.a,[968,10]);var O=b(25),N=b(86),H=b(109),Q=b(13),ca=b(43),X=b(38),Z=b(18),ea=b(5),ka=b(130),Y=b(14),qa=b(21),fa=b(58),ha=X.a;Rk(r,ha);r.prototype.nFg=function(P){this.addHandler("KBIS",P)};r.prototype.vbj=function(P){this.removeHandler("KBIS",
P)};r.prototype.dispose=function(){this.firstElement&&ca.a.removeHandler(this.firstElement,Q.a.focus,this.rwf);this.ps&&this.ps.detach("focus");this.mw&&(ca.a.removeHandler(this.mw,Q.a.focus,this.lyf),ca.a.removeHandler(this.mw,Q.a.blur,r.onBlur),H.KeyInputManager.instance.Aa(Q.a.Lb,this.mw,this.myf));H.KeyInputManager.instance.Aa(Q.a.Lb,this.$.domElement,this.JDf);this.ps=this.mw=this.firstElement=this.$=null;ha.prototype.dispose.call(this)};r.prototype.i6g=function(){this.Fvj?(this.firstElement=
document.documentElement,this.ps=ka.a.instance.LG(document.parentWindow),this.ps.ka("focus",this.jUi)):(this.firstElement=r.SCe(),document.body.insertBefore(this.firstElement,document.body.childNodes[0]),ca.a.addHandler(this.firstElement,Q.a.focus,this.rwf))};r.prototype.g7g=function(){this.mw=r.SCe();this.mw.id=ea.a.XJe;this.mw.setAttribute(ea.a.Gt,Y.a.instance.ga(861));document.body.appendChild(this.mw);ca.a.addHandler(this.mw,Q.a.focus,this.lyf);ca.a.addHandler(this.mw,Q.a.blur,r.onBlur);H.KeyInputManager.instance.qa(Q.a.Lb,
this.mw,this.myf)};r.prototype.ixh=function(P){this.T9f(P);return!1};r.prototype.FJi=function(){this.VLa=!0;qa.g(this.$).focus();qa.g(this.$).ha.E4e();this.raiseEvent("KBIS");return!0};r.prototype.T9f=function(P){this.VLa?this.VLa=!1:(this.VLa=!0,P&&P.focus())};r.SCe=function(){var P=document.createElement("div");P.tabIndex=0;return P};r.s7e=function(){document.body.classList.add(Z.a.AMe)};r.onBlur=function(){document.body.classList.remove(Z.a.AMe)};Object(u.a)(r,"EmbedViewFocusControl",X.a,[967,
10]);var ia=b(4),wa=b(1289),Qa=b(60),S=b(570),da=b(24),xa=b(45),ta=b(389),ab=b(177),Na=b(258),Ka=b(121),la=b(29),Ea=b(296),ra=b(295),na=b(61),ba=b(36),sa=X.a;Rk(z,sa);z.prototype.aZb=function(P){this.addHandler(wa.a,P)};z.prototype.rsc=function(P){this.removeHandler(wa.a,P)};z.prototype.OEg=function(P){this.addHandler(wa.k,P)};z.prototype.dbj=function(P){this.removeHandler(wa.k,P)};z.prototype.dispose=function(){this.jb=null;this.vbb();sa.prototype.dispose.call(this)};z.prototype.VYi=function(){var P=
Array(9);var oa={};oa.Name=wa.e;P[0]=oa;oa={};oa.Name=wa.h;P[1]=oa;oa={};oa.Name=wa.f;P[2]=oa;oa={};oa.Name=wa.i;P[3]=oa;oa={};oa.Name=wa.j;P[4]=oa;oa={};oa.Name=wa.g;P[5]=oa;oa={};oa.Name=wa.c;P[6]=oa;oa={};oa.Name=wa.d;P[7]=oa;oa={};oa.Name=wa.b;P[8]=oa;oa={ColumnName:"",ColumnIndex:-1};oa.FieldInfoDataList=P;P=[];P[0]=oa;this.ONd(P)};z.prototype.qZ=function(P,oa,Ja,$a){$a=void 0===$a?null:$a;if(P){this.uZc();this.p1b();var Ta=null,pa=!1,Da;if(Da=!$a)Da=this.XMj(P,oa,Ja),pa=Da.n$a,Ta=Da.Hk,Da=Da.returnValue;
if(Da)if(this.tFd||this.ONd(Ta),this.MTb=!0,this.dP=Ta,this.tFd){if(!pa){this.TVa=!0;this.Kqc();return}}else if(this.dP&&0<this.dP.length&&(this.TVa=!0,this.Kqc()),!pa)return;this.Ccg(P,$a,oa,Ja,!1)}};z.prototype.Ccg=function(P,oa,Ja,$a,Ta){if(this.$.ea.dc){this.$.Fb&&(this.FIb=this.$.Fb.sc("WebServiceCall","GetRichValueFieldInfoListContext"));this.Vub=null;var pa=this.$.oa.xa.Pb(),Da=this.$.oa.xa,rb=this.cLi,Ab=this.bLi,ob=Da.Na(1,null);ob.selectedRange=P;ob.richValueKeyPath=oa;ob.singleColumn=Ja;
ob.searchForRange=$a;ob.calculateMajorityDataType=Ta;this.Vub=na.g(Da,"GetRichValueFieldListContextList",ob,rb,Ab,null,pa,4)}else this.dP=null};z.prototype.vbb=function(){this.dP=null;this.TVa=!1;this.uZc();this.p1b();this.Vub=null;this.vSb=-1};z.prototype.uZc=function(){z.upb(this.Vub)};z.prototype.p1b=function(){z.upb(this.ndd)};z.prototype.Kqc=function(){this.raiseEvent(wa.a)};z.prototype.Xm=function(P){P=xa.D(P);--P.left;--P.right;return this.tableManager.Xm(P)};z.prototype.MJa=function(P){var oa=
this;P.FirstColumn=P.FirstColumn;P.LastColumn=P.LastColumn;P.FirstRow=P.FirstRow;P.LastRow=P.LastRow;this.p1b();this.ndd=null;return ta.a(this.$.userOperationManager,function(Ja,$a,Ta){return Na.h(oa.$.oa.xa,P,ra.b(Ja,function(pa){oa.mLi(pa)}),ra.a($a,$a,function(pa){oa.lLi(pa)}),Ta,null)},function(Ja){return new ab.a(264,0,Ja,80)},null)};z.prototype.lLi=function(P){P=Ka.a.Of(P.data);C.ULS.sendTraceTag(525336847,0,10,"FieldInfoManager.OnGetFullTableRangeFailure - Webservice call failed with Errors: {0}",
la.a.Dc(P))};z.prototype.mLi=function(P){if(Ea.a(P))-315732528!==P.Errors[0].MessageId&&C.ULS.sendTraceTag(525336846,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call failed with Unexpected error : {0}",la.a.Dc(P.Errors));else if(P&&P.Result){P=P.Result;var oa=P.HasHeaderRow;oa=new S.AutofilterRange(P.TableRange.FirstRow+(oa?1:0)+1,P.TableRange.FirstColumn+1,P.TableRange.LastRow+1,P.TableRange.LastColumn+1,null,null,null,0,oa);this.vSb=P.TableRange.FirstColumn;(P=this.RIf(!1,!0,
oa))||C.ULS.sendTraceTag(525336844,0,50,"FieldInfoManager.OnGetFullTableRangeSuccess - fieldInfoListContextList is null");this.ONd(P)}else C.ULS.sendTraceTag(525336845,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call returned no result")};z.prototype.XMj=function(P,oa,Ja){var $a=null;var Ta=!1;if(P.SheetName!==this.$.ea.pa.sheetName)return{returnValue:!1,n$a:Ta,MJa:!1,Hk:$a};this.vSb=-1;if(Ja){var pa=this.Xm(P);if(!pa||!pa.Yaa)return{returnValue:!1,n$a:Ta,MJa:!1,Hk:$a};var Da=qa.g(this.$).Ab.Y0e(pa);
this.z3d=pa;if(x.EwaSettings.isChangeGateEnabled("OfficeVSO:5167298_ObtainFullRangeOfTableForPopulatingInsertDataDropdownCorrectly")&&Da&&0<Da.count)return--P.FirstColumn,--P.LastColumn,this.ndd=this.MJa(P),{returnValue:!0,n$a:Ta,MJa:!0,Hk:$a};pa.top+=1;pa.right=xa.D(P).right-1}else pa=new S.AutofilterRange(P.FirstRow+1,P.FirstColumn+1,P.LastRow+1,P.LastColumn+1,null,null,null,0,!1);if(pa.top>pa.bottom||pa.left>pa.right)return{returnValue:!0,n$a:Ta,MJa:!1,Hk:$a};P=qa.g(this.$);var rb=P.eb.width,Ab=
P.eb.height;Da=P.view.visibleArea;rb=new Qa.a(Da.x-rb,Da.y-Ab,Da.width+rb,Da.height+Ab);Ab=P.gg(pa);if(!Da||!Ab||!P.uhc(pa))return{returnValue:!1,n$a:Ta,MJa:!1,Hk:$a};rb.contains(Ab)||(Ta=!0);$a=this.RIf(oa,Ja,pa);return{returnValue:!0,n$a:Ta,MJa:!1,Hk:$a}};z.prototype.ONd=function(P){P&&C.ULS.sendTraceTag(25264348,0,50,"Retrieved {0} rich value field contexts from block cache",P.length);this.MTb=!0;(this.dP=P)&&0<this.dP.length&&(this.TVa=!0,this.Kqc())};z.prototype.RIf=function(P,oa,Ja){var $a=
null;var Ta=Ja.clone();if(oa){oa=Ja.right;for(var pa=0;oa>=Ja.left;--oa){Ta.left=oa;Ta.right=oa;var Da=this.lYe(Ta,!0,Ja.left);if(Da){$a||($a=[]);$a[pa]=Da;if(P)break;++pa}}}else if(P=this.lYe(Ta,!1))$a=[],$a[0]=P;return $a};z.prototype.lYe=function(P,oa,Ja){Ja=void 0===Ja?0:Ja;var $a=null;if(x.EwaSettings.isChangeGateEnabled("OfficeVSO:5723259_StoreRichValueFieldsInDictionary")){var Ta=qa.g(this.$).Ab.XVh(P);if(Ta&&0<Ta.count){var pa=Array(Ta.count),Da=0;Ta=ak(Ta.values);for($a=Ta.next();!$a.done;$a=
Ta.next()){var rb={};rb.Name=$a.value;pa[Da]=rb;++Da}Da="";Ta=-1;0<P.top&&oa&&(P=new da.Range(P.top-1,P.left,P.top-1,P.left,!1,!1),null!=qa.g(this.$).Ub(P)&&null!=qa.g(this.$).Ub(P).originalText&&(Da=qa.g(this.$).Ub(P).originalText),Ta=P.left-Ja);$a={};$a.ColumnName=Da;$a.ColumnIndex=Ta;$a.FieldInfoDataList=pa}}else if((Ta=qa.g(this.$).Ab.Y0e(P))&&0<Ta.count){pa=Array(Ta.count);Da=0;Ta=ak(Ta);for($a=Ta.next();!$a.done;$a=Ta.next())rb={},rb.Name=$a.value,pa[Da]=rb,++Da;Da="";Ta=-1;0<P.top&&oa&&(P=
new da.Range(P.top-1,P.left,P.top-1,P.left,!1,!1),Da=qa.g(this.$).Ub(P).originalText,Ta=P.left-Ja);$a={};$a.ColumnName=Da;$a.ColumnIndex=Ta;$a.FieldInfoDataList=pa}return $a};z.upb=function(P){P&&ia.AFrameworkApplication.qd.nu(P.Ht)};Af.Object.defineProperties(z.prototype,{U5a:{configurable:!0,enumerable:!0,get:function(){return this.TVa}},fti:{configurable:!0,enumerable:!0,get:function(){return this.MTb}},yUe:{configurable:!0,enumerable:!0,get:function(){return this.vSb}},k4c:{configurable:!0,enumerable:!0,
get:function(){return this.z3d}},$:{configurable:!0,enumerable:!0,get:function(){return this.jb}},Hk:{configurable:!0,enumerable:!0,get:function(){return this.dP}},RNh:{configurable:!0,enumerable:!0,get:function(){return!!this.Vub}}});Object(u.a)(z,"FieldInfoManager",X.a,[636,10]);Rk(n,z);n.prototype.aOh=function(P,oa){this.A1a=oa;C.ULS.sendTraceTag(537153825,0,100,"FilterInfoManager.GetFilterFieldInfoListContextAsync - Retrieving the list of field list context for row, col, row, col ({0}, {1}, {2}, {3})",
P.FirstRow,P.FirstColumn,P.LastRow,P.LastColumn);this.Ccg(P,null,!0,!1,!0)};Af.Object.defineProperties(n.prototype,{DG:{configurable:!0,enumerable:!0,get:function(){return this.Qkg}}});Object(u.a)(n,"FilterInfoManager",z,[689,636,10]);var ya=b(1050),va=b(1300),W=b(30),La=b(90),Ia=b(8);w.erh="ewa-sharedUi-launchButton";w.hrh="ewa-sharedUi-launchButtonWithText";w.frh="ewa-sharedUi-launchButtonClick";w.irh="ewa-sharedUi-launchButtonWithTextClick";w.grh="ewa-sharedUi-launchButtonText";Object(u.a)(w,"CssClassNames",
null,[]);var mb=b(64);b(565);var fb=b(245),Ma=b(233);X=b(244);var Hb=b(298),Kb=b(69),Ub=b(10),gb=b(261),Db=b(33),Va=X.a;Rk(f,Va);f.prototype.q2=function(P){this.addHandler(this.SFb,P)};f.prototype.fda=function(P){this.get_events().removeHandler(this.SFb,P)};f.prototype.EFg=function(P){this.addHandler("OnObjectButtonMouseOver",P)};f.prototype.Mbj=function(P){this.get_events().removeHandler("OnObjectButtonMouseOver",P)};f.prototype.DFg=function(P){this.addHandler("OnObjectButtonMouseOut",P)};f.prototype.Lbj=
function(P){this.get_events().removeHandler("OnObjectButtonMouseOut",P)};f.prototype.Kbg=function(P){P&&(this.SZa.innerHTML=P)};f.prototype.mQj=function(P,oa,Ja){this.SZa.innerHTML="";P?P.hba(oa,16,16,this.SZa,16,16,void 0,Ja):C.ULS.sendTraceTag(537153824,0,10,"OnObjectButton.UpdateButtonSvgImage: Called without svgIconProvider")};f.prototype.nQj=function(P,oa){P&&(this.JMb.innerText=P);this.domElement.title=oa};f.prototype.dispose=function(){this.get_isInitialized()&&(this.hide(),this.yc.tC(),La.a.oc([this.YY,
this.JZa]),Ma.a.instance.Aa(Q.a.click,this.domElement,this.$c),fb.a.instance.Aa(Q.a.pointerDown,this.domElement,this.qN),this.VRa&&this.VRa.dispose(),Va.prototype.dispose.call(this))};f.prototype.tbb=function(){this.o2b&&this.domElement.classList.remove(this.o2b);this.Klc&&this.domElement.classList.add(this.Klc)};f.prototype.QFb=function(){this.Klc&&this.domElement.classList.remove(this.Klc);this.o2b&&this.domElement.classList.add(this.o2b);this.O1a()};f.prototype.O1a=function(){this.Shc&&(this.VRa.cancel(),
this.T5f(),this.setOpacity(1));this.set_visible(!0)};f.prototype.np=function(P,oa,Ja,$a,Ta){Ta=void 0===Ta?!1:Ta;P=Db.a($a).ii(P);oa=Db.a($a).ii(oa);Db.a($a).Xvc(this.domElement);this.domElement.style.top=Ub.HelperMethods.hc(oa);this.domElement.style.left=this.domElement.style.right="";oa=P;Ta&&(oa=P-this.domElement.offsetWidth);gb.c(this.domElement.style,Ja,Ub.HelperMethods.hc(oa));this.set_visible(!0);this.setOpacity(1);this.Shc&&(this.URd=!1,this.xEj(),this.VRa.Kq())};f.prototype.hide=function(){this.tbb();
this.set_visible(!1);this.Shc&&(this.T5f(),this.VRa.cancel())};f.prototype.v7b=function(){this.yc.ka("mouseover",this.vN,!0);this.yc.ka("mouseout",this.uN,!0)};f.prototype.xEj=function(){this.YY.an("mousemove")||this.YY.ka("mousemove",this.lJi)};f.prototype.T5f=function(){this.YY.an("mousemove")&&this.YY.detach("mousemove")};f.prototype.yhd=function(P){if(this.domElement.parentNode){var oa=Sys.UI.DomElement.getBounds(this.domElement),Ja=new Sys.UI.Point(Math.round(oa.x+oa.width),Math.round(oa.y+oa.height));
oa=Math.abs(Ja.x-P.x);P=Math.abs(Ja.y-P.y);P=oa>P?oa:P;this.URd?this.setOpacity(f.vTg(P)):100>=P&&this.qje()}};f.prototype.qje=function(){this.URd=!0;this.VRa.cancel()};f.prototype.setOpacity=function(P){O.a.setOpacity(this.domElement,P);this.Pif=F.a.Ta.Jb};f.vTg=function(P){return 100>=P?1:250<=P?0:.01*(100-(P-100)/150*100)};Object(u.a)(f,"OnObjectButton",X.a,[970,201,10]);var yb=b(1003),qb=w.grh,dc=E.a;Rk(m,dc);m.prototype.dispose=function(){this.hgh();this.$=null;dc.prototype.dispose.call(this)};
m.prototype.getButton=function(P,oa){return this.Kua(P,void 0===oa?!0:oa)};m.prototype.Kua=function(P,oa){var Ja=P.toString();Ja in this.buttons||this.i7g(P,void 0===oa?!0:oa);return this.buttons[Ja]};m.prototype.np=function(P,oa,Ja,$a,Ta,pa){Ta=void 0===Ta?!0:Ta;pa=void 0===pa?!1:pa;this.hide();if(this.$.ea.isNamedObjectViewMode&&mb.i(this.$.pa)){var Da=qa.g(this.$).XR.domElement,rb=P+this.buttonWidth-Da.scrollWidth;Da=oa+this.buttonWidth-Da.scrollHeight;P=0<rb?P-rb:P;oa=0<Da?oa-Da:oa}this.Kua($a,
Ta).np(P,oa,Ja,this.$,pa)};m.prototype.hide=function(){var P=this.buttons,oa;for(oa in P)P[oa].hide()};m.prototype.v7b=function(P,oa){!this.Z7e&&(oa=this.buttons[oa.toString()])&&(this.glc=function(Ja,$a){P($a,!0)},oa.EFg(this.glc),this.flc=function(Ja,$a){P($a,!1)},oa.DFg(this.flc),this.Z7e=!0,oa.v7b())};m.prototype.i7g=function(P,oa){function Ja(pa,Da){$a.DHi(Da,P)}var $a=this;this.Xva=String.format(this.akd===Z.a.k8b?'<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>':
'<img class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1"/>',W.a.Ag(this.akd),W.a.Ag(this.$jd),"{0}");var Ta=String.format(this.Xva,W.a.Ag(this.altText));oa=new f(""===this.buttonText?w.erh:w.hrh,""===this.buttonText?w.frh:w.irh,Z.a.RA,Ta,oa,this.SFb,this.buttonText,qb);oa.q2(Ja);this.buttons[P.toString()]=oa;this.JLe[P.toString()]=Ja;Ta=qa.g(this.$).Ef(P);Ta.domElement.insertBefore(oa.domElement,Ta.domElement.firstChild)};m.prototype.hgh=function(){for(var P=ak(yb.a(this.buttons)),oa=P.next();!oa.done;oa=
P.next()){oa=oa.value;var Ja=this.buttons[oa];Ja.fda(this.JLe[oa]);La.a.Ia(Ja);delete this.buttons[oa];this.glc&&Ja.Mbj(this.glc);this.flc&&Ja.Lbj(this.flc)}};m.prototype.domElement=function(P){return this.Kua(P).domElement};m.prototype.O1a=function(P){this.Kua(P).O1a()};m.prototype.iOb=function(P,oa,Ja){Ja=void 0===Ja?!0:Ja;this.Xva=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',W.a.Ag(this.akd),W.a.Ag(this.$jd),"{0}");P=String.format(this.Xva,
W.a.Ag(P));this.Kua(oa,Ja).Kbg(P)};m.prototype.uTa=function(P,oa,Ja){this.Kua(Ja,!1).nQj(P,oa)};m.prototype.zcg=function(){var P=void 0===P?!1:P;this.Xva=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',"{0}",W.a.Ag(this.$jd),"{1}");var oa=String.format(this.Xva,void 0,W.a.Ag(void 0));this.Kua(void 0,P).Kbg(oa)};m.prototype.Acg=function(P,oa,Ja){this.Kua(Ja,!1).mQj(this.svgIconProvider,P,oa)};Af.Object.defineProperties(m.prototype,{jz:{configurable:!0,
enumerable:!0,get:function(){return Db.a(this.$).PFa(Ia.a.gPi)}},P1b:{configurable:!0,enumerable:!0,get:function(){return Ia.a.fPi}},buttonWidth:{configurable:!0,enumerable:!0,get:function(){return Db.a(this.$).PFa(Ia.a.hPi)}}});Object(u.a)(m,"OnObjectLaunchButton",E.a,[963,10]);var bb=b(83);E=b(87);var db=E.a;Rk(l,db);l.prototype.dispose=function(){La.a.Ia(this.BBb);this.BBb=null;db.prototype.dispose.call(this)};l.prototype.jSa=function(){La.a.Ia(this.BBb);this.BBb=U.a.instance.create(Object(bb.a)(this,
this.display,"display"),this.F8h,M.a.jti)};l.prototype.Cdb=function(){La.a.Ia(this.BBb);this.hide()};Object(u.a)(l,"LoadingIndicatorBehavior",E.a,[969,10]);Rk(k,l);k.prototype.dispose=function(){this.ABb=null;l.prototype.dispose.call(this)};k.prototype.display=function(){this.mng(this.ABb)};k.prototype.hide=function(){this.L5h(this.ABb)};k.prototype.tBg=function(){this.ABb=document.createElement("div");this.domElement.appendChild(this.ABb)};Object(u.a)(k,"ShimmerLoadingIndicatorBehavior",l,[]);var wc=
b(71),nb=b(53),zb=b(12);Rk(e,l);e.prototype.dispose=function(){this.qNa=null;l.prototype.dispose.call(this)};e.prototype.display=function(){zb.DOMElementExtensions.setVisible(this.qNa,!0)};e.prototype.hide=function(){zb.DOMElementExtensions.setVisible(this.qNa,!1)};e.prototype.sBg=function(){this.qNa=document.createElement("div");this.qNa.classList.add(wc.a.Eph);var P=document.createElement("div");P.classList.add(wc.a.Fph);this.n4c&&""!=this.n4c&&P.classList.add(this.n4c);var oa=0===this.Ekf?"":Y.a.instance.ga(this.Ekf),
Ja=String.format('<div class="'+wc.a.Gph+'">{0}</div>',oa);this.kec?(oa=String.format('<img src="{0}" alt="{1}" title="{1}"/>',this.kec,oa),P.innerHTML=oa+Ja):P.innerHTML=Ja;this.qNa.appendChild(P);this.domElement.appendChild(this.qNa)};Object(u.a)(e,"SpinnerLoadingIndicatorBehavior",l,[]);d.prototype.p3c=function(P,oa,Ja){return new ya.a(P,oa,Ja)};d.prototype.s4b=function(P,oa,Ja,$a,Ta,pa,Da,rb,Ab,ob){return new va.a(P,oa,Ja,$a,Ta,pa,Da,rb,Ab,ob)};d.prototype.lrb=function(P,oa,Ja,$a,Ta){return new e(P,
oa,Ja,$a,void 0===Ta?0:Ta)};d.prototype.Ted=function(P){return P.da.za(238)||new r(P)};d.prototype.w4b=function(P,oa,Ja,$a,Ta,pa,Da,rb){return new m(P,oa,Ja,$a,Ta,pa,Da,void 0===rb?"":rb)};d.prototype.S2c=function(P,oa){return new z(P,oa)};d.prototype.d6g=function(P,oa,Ja,$a){return new n(P,oa,Ja,$a)};d.prototype.y2c=function(P,oa,Ja,$a){return new v(P,oa,Ja,$a)};Object(u.a)(d,"SharedUIControlsFactory",null,[943]);var ma=y.a;Rk(c,ma);c.prototype.create=function(){x.EwaSettings.xl()?this.pb(this.$.da.za(12)||
new d):this.pb(new d)};c.ka=function(P){P.da.Ga(477,new c(P))};Object(u.a)(c,"SharedUIControlsFactoryServiceFactory",y.a,[]);b.d(D,"a",function(){return a})},1372:function(u,D,b){function a(){r.a.Fa(c.ka);r.a.Fa(z.ka)}function c(pa){return Ta.call(this,pa)||this}function d(pa,Da,rb,Ab,ob,sb,Pb){var Aa=this;this.$=pa;this.gridView=Da;this.Gg=rb;this.vB=Ab;this.borderFormatManager=ob;this.moreColorsHelper=sb;this.fontDropdownHelper=Pb;this.HA=null;this.ZZa=1461300262;this.gx=this.WZa=this.u8a=this.e$b=
null;this.kNi=function(Ya,kb){if(!na.a(Ya)&&kb){var lb=!!Ya&&!!Ya.RequestTelemetryData;Ub.g(Aa.$).ui.fla(kb,Ya.StateId,lb?Ya.RequestTelemetryData.EcsOperationDuration:0,lb?Ya.RequestTelemetryData.EcsRequestDuration:0,lb?Ya.RequestTelemetryData.WfeRequestDuration:0)}};this.Rpb=function(){if(Aa.gridView.Y5a){var Ya=Aa.$.da.za(254,!0);Ya&&Ya.$bj(Aa.Rpb);Aa.gridView.Y5a=!1;Aa.gridView.ig.zo(ea.a.m4);Aa.gridView.ha.yW(Aa.Vad);Ub.g(Aa.$).$.jf()}};this.Vad=function(){var Ya=Aa.e$b;Aa.e$b=Y.d(Aa.$.va.pa);
if(Ya===Aa.e$b)if(Aa.gridView.ha.yW(Aa.Vad),(Ya=Aa.$.da.za(254,!0))&&Ya.jZc(36,Ub.g(Aa.$).ha.sa.selectedRanges)){Ya=new la.a(1804571062,2,2,0,null);var kb={};Aa.$.Ka.Kb(Ya,(kb[ea.a.skipClipboardAccess]=!0,kb[ea.a.N_c]=!0,kb[ea.a.isFormatPainter]=!0,kb)).continueWith(function(){Aa.Rpb()})}else Aa.gridView.ig.IG(!1)};this.tb=y.EwaSettings.tb();this.Skc=new e(this.$,rb);this.NC=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);this.Cm=y.EwaSettings.Cm();this.cn=Ja.a.cn()}function e(pa,
Da){this.$=pa;this.Gg=Da;this.px=new Kb.a(Ub.g(this.$).Ea,this.$);this.gff=y.EwaSettings.isChangeGateEnabled("OfficeVSO:5412627_MergeCellRangeBorderScenariosTelemetry");this.pyb=y.EwaSettings.isChangeGateEnabled("OfficeVSO:5607672_MergeCellCseForOutOfViewPortCells");this.qod=y.EwaSettings.isChangeGateEnabled("OfficeVSO:5658006_MergeCellCSEBugFixesforCellStylesAndRTL");this.Ggc=y.EwaSettings.isChangeGateEnabled("OfficeVSO:5954689_MergeCellCSEUnmergewithMergeCommand");this.ddf=y.EwaSettings.isChangeGateEnabled("OfficeVSO:6013788_MergeCellHighGetRangeNumbersTelemetry");
this.fgi=y.EwaSettings.isChangeGateEnabled("OfficeVSO:6100978_MergeCellCSEIsCsePossibleForWrapTextWrongValueForUnmergeCommandFix");this.hhf=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1);this.thc=y.EwaSettings.isChangeGateEnabled("OfficeVSO:6147046_MergeCellCSERangeBorderScenarioFix");this.fzb=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellMultipleBlocksScenarioCse",!1);this.Hgc=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellBorderScenarioCse",
!1);this.tji=y.EwaSettings.isChangeGateEnabled("OfficeVSO:6327711_MergeCellMultiBlockUnmergeBitFix");this.mgi=y.EwaSettings.isChangeGateEnabled("OfficeVSO:6350260_MergeCellCSEDataLossScenarioUnmergeConditionFix");this.abf=y.EwaSettings.isChangeGateEnabled("OfficeVSO:6209366_MergeCellCSECellFormatAssertFix");this.adf=y.EwaSettings.isChangeGateEnabled("OfficeVSO:6402649_HiddenCellsAvoidCseFixEnabled");this.Jji=y.EwaSettings.isChangeGateEnabled("OfficeVSO:6476102_MergeCellCSEMultiBlockMergeFlagsFix")}
function k(){this.scenario=0;this.tQ=null}function l(){this.uQa=this.oGa=this.eNa=this.SSa=0}function m(pa,Da,rb,Ab){this.targetSheetRange=this.sourceSheetRange=null;this.fillRangeDirection=this.fillRangeType=0;this.sourceSheetRange=pa;this.targetSheetRange=Da;this.fillRangeType=rb;this.fillRangeDirection=Ab}function f(pa,Da,rb){var Ab=fb.call(this,pa)||this;Ab.Al=null;Ab.K5c=0;Ab.Ebi=function(ob,sb){if(0===ob)E.ULS.sendTraceTag(574993491,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: User pressed Cancel");
else{ob={};var Pb="",Aa=1035996630;switch(sb.selectedKey){case 0:Pb=1896159024===Ab.pr?"InsertCellsShiftRight":"DeleteCellsShiftLeft";break;case 1:Pb=1896159024===Ab.pr?"InsertCellsShiftDown":"DeleteCellsShiftUp";break;case 2:1896159024===Ab.pr?(Pb="InsertRows",Aa=-1113896058):(Pb="DeleteRows",Aa=1554436520);break;case 3:1896159024===Ab.pr?(Pb="InsertColumns",Aa=1415868706):(Pb="DeleteColumns",Aa=674605324)}E.ULS.sendTraceTag(574993490,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: Handle RibbonCommand.InsertOrDeleteCells, MenuItemId:{0}",
Pb);sb=new la.a(Aa,1,2,8,null);ob[qa.a.Nc]=Pb;Ab.$.Ka.Kb(sb,ob)}};Ab.pr=Da;Ab.selectedRanges=rb;pa=Object(La.a)(Ia.a,Ab.$.va.pa);Ab.isRtl=pa.displayRtl;return Ab}function w(pa,Da,rb,Ab,ob){this.PTe=0;this.yog=pa;this.zog=Da;this.Kwg=rb;this.BWb=Ab;this.PTe=void 0===ob?0:ob}function n(pa){this.insertDeleteMultiRangeParameters=null;this.insertDeleteMultiRangeParameters=pa}function z(pa){var Da=C.call(this)||this;Da.$=pa;Da.Eb();return Da}var r=b(11);u=b(0);var v=b(232),A=b(51),B=b(37),y=b(1),x=b(1018),
C=v.a;Rk(z,C);z.prototype.create=function(){var pa=this,Da=A.GetServiceTaskFactory.create(this.$.da,18,this.la,this.hb),rb=A.GetServiceTaskFactory.create(this.$.da,102,this.la,this.hb);B.TaskExtensions.Ba(B.TaskExtensions.Wd([Da,rb],this.la),function(){pa.pb(pa.$.da.za(296)||pa.$.da.Ga(296,new x.BorderFormatManager(pa.$,Da.result,rb.result)))},this.la,3)};z.ka=function(pa){y.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")&&pa.da.Ga(468,new z(pa))};Object(u.a)(z,
"BorderFormatManagerFactory",v.a,[]);var G=b(905),E=b(15),I=b(279),U=b(178),M=b(1033),T=b(25),F=b(39),K=b(30),J=b(96),O=b(274),N=b(370),H=b(367),Q=b(99),ca=b(202),X=b(8),Z;(function(pa){pa[pa.insert=1]="insert";pa[pa.delete=2]="delete";pa[pa.rows=4]="rows";pa[pa.columns=8]="columns";pa[pa.cellsShiftHorizontal=16]="cellsShiftHorizontal";pa[pa.cellsShiftVertical=32]="cellsShiftVertical";pa[pa.insertRows=5]="insertRows";pa[pa.insertColumns=9]="insertColumns";pa[pa.insertCellsShiftRight=17]="insertCellsShiftRight";
pa[pa.insertCellsShiftDown=33]="insertCellsShiftDown";pa[pa.deleteRows=6]="deleteRows";pa[pa.deleteColumns=10]="deleteColumns";pa[pa.deleteCellsShiftLeft=18]="deleteCellsShiftLeft";pa[pa.deleteCellsShiftUp=34]="deleteCellsShiftUp"})(Z||(Z={}));Object(u.b)("InsertDeleteCellFlags",Z);var ea=b(5),ka=b(447),Y=b(64),qa=b(76);Object(u.a)(n,"MacroRecorderRangeInsertedOrDeletedPayload",null,[409]);var fa=b(1287),ha=b(45),ia=b(564),wa=b(389),Qa=b(177),S=b(61),da=b(258),xa=b(151),ta=b(492),ab=b(114),Na=b(53),
Ka=b(203),la=b(92),Ea=b(34),ra=b(29),na=b(296),ba=b(269),sa=b(10),ya=b(186),va=b(22),W=b(295);w.ZQg=function(pa,Da){return new w(pa,Da,null,null,null)};w.uYc=function(pa,Da){return new w(pa,null,Da,null,null)};w.$Qg=function(pa,Da){return new w(pa,null,null,Da,null)};w.YQg=function(pa,Da,rb){return new w(pa,null,Da,null,rb)};Af.Object.defineProperties(w.prototype,{Via:{configurable:!0,enumerable:!0,get:function(){return this.yog}},formattedText:{configurable:!0,enumerable:!0,get:function(){return this.zog}},
style:{configurable:!0,enumerable:!0,get:function(){return this.Kwg}},size:{configurable:!0,enumerable:!0,get:function(){return this.BWb}},xaa:{configurable:!0,enumerable:!0,get:function(){return this.PTe}}});Object(u.a)(w,"CachedPreviewCellGroup",null,[]);var La=b(85);v=b(390);var Ia=b(101),mb=b(14),fb=v.a;Rk(f,fb);f.prototype.sg=function(){1896159024===this.pr?(this.Al=mb.a.instance.ga(23),this.K5c=0):(this.Al=mb.a.instance.ga(22),this.K5c=1);var pa=this.selectedRanges[0].b_&&!this.selectedRanges[0].l5?
0:1;this.Rb=1;var Da={};pa=(Da[f.Yv]=this.nc,Da.dialogToDisplay=this.K5c,Da.defaultSelectedKey=pa,Da.isRtl=this.isRtl,Da);this.initializeAndShow(this.Al,this.Ebi,pa)};Af.Object.defineProperties(f.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"InsertDeleteCellsDialog"}}});Object(u.a)(f,"InsertDeleteCellsDialog",v.a,[]);Object(u.a)(m,"MacroRecorderRangeFilledPayload",null,[409]);var Ma=b(7),Hb=b(24);Object(u.a)(l,"RangeBorders",null,[]);Object(u.a)(k,"ScenarioInfo",null,[]);var Kb=
b(1117),Ub=b(21),gb=b(275),Db=b(217),Va=b(77);e.prototype.dispose=function(){this.$=null};e.prototype.lgi=function(pa,Da){return!(void 0===Da||null===Da)&&!!(Da.scenario&16384)&&!this.ngi(pa,Da)&&this.Uaf(Da,pa)};e.prototype.XZe=function(){var pa=F.a.oe(),Da=Ub.g(this.$),rb=Da.ha.sa.selectedRanges,Ab=0,ob=0,sb=rb.length,Pb=new k;if(1<sb)return Pb.scenario=4,Pb;if(this.adf&&Da.Pe.Nef(rb[0]))return Pb.scenario=262144,Pb;this.qod&&Ub.g(this.$).rtl&&(Ab|=65536);if(!Da.YQ(rb[0]))if(this.pyb)Ab|=32;else return Pb.scenario=
32,Pb;if(Da=Da.Ea.TJa(rb[0],this.$.activeItemName))for(Pb.OXc=Da,Da=ak(Da),sb=Da.next();!sb.done;sb=Da.next())if(ob+=1,1<ob){this.pyb?(Ab|=256,Pb.scenario=Ab):Pb.scenario=256;if(!this.fzb)return Pb;break}ob=Ub.g(this.$).Ea.Fua(rb[0]);if(!ob)return Pb.scenario=32768,Pb;Da=ob.length;rb=rb[0];sb=rb.bottom-rb.top+1;for(var Aa=rb.right-rb.left+1,Ya=new l,kb=0;kb<Da;kb++)if(this.gff&&this.LUh(ob[kb],rb,Ya),Ab=Ab|(void 0!==ob[kb].text&&null!==ob[kb].text&&""!==ob[kb].text?1:0)|(ob[kb].SM?2:0)|(ob[kb].Bva?
8:0)|(ob[kb].swb?16:0)|(ob[kb].pH?64:0)|(ob[kb].Waa?128:0),void 0!==ob[kb].text&&null!==ob[kb].text&&""!==ob[kb].text||ob[kb].Bva)if(void 0===Pb.tQ||null===Pb.tQ)Pb.tQ=Ub.g(this.$).Ub(ob[kb].getRange());else{if(ob[kb].getRange().top<Pb.tQ.range.top||ob[kb].getRange().top==Pb.tQ.range.top&&ob[kb].getRange().left<Pb.tQ.range.left)Pb.tQ=Ub.g(this.$).Ub(ob[kb].getRange());Ab|=16384}this.gff&&(Ya.SSa===Aa&&(Ab|=512),Ya.oGa===Aa&&(Ab|=2048),Ya.eNa===sb&&(Ab|=4096),Ya.uQa===sb&&(Ab|=1024),0<Ya.SSa&&Ya.SSa<
Aa||0<Ya.oGa&&Ya.oGa<Aa||0<Ya.eNa&&Ya.eNa<sb||0<Ya.uQa&&Ya.uQa<sb)&&(Ab|=8192);!y.EwaSettings.isChangeGateEnabled("OfficeVSO:6217608_Add_Entire_Row_Column_Selection_flag")||rb.right!==rb.maxColumns&&rb.bottom!==rb.maxRows||(Ab|=131072);pa=F.a.oe()-pa;E.ULS.sendTraceTag(537159424,0,50,"Execution time of GetMergeCellScenario is : {0}",pa);Pb.scenario=Ab;return Pb};e.prototype.npf=function(pa,Da){var rb=pa.command;if(void 0===Da||null===Da)Da=this.XZe();if(!this.Uaf(Da,rb))return!1;pa=Ub.g(this.$).ha.sa.selectedRanges;
var Ab=Ub.g(this.$).Ea.Fua(pa[0]);if(!Ab)return!1;if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:5993850_HandleSingleCellMergeScenario")&&1===Ab.length&&!Ab[0].SM)return-167499203===rb?(Ab[0].u0(2,!0),!0):!1;Ab=Ub.g(this.$).ha.sa.Xs;var ob=this.$.pa.sheetName,sb=!0;switch(rb){case -167499203:2===(Da.scenario&2)&&this.Ggc?this.Nag(Da.scenario,pa,rb):sb=this.Uzi(Da,pa);break;case 1097660126:(Da=this.opf(Da,pa))&&0!=Da.length||(sb=!1);break;case 155820588:this.Nag(Da.scenario,pa,rb);break;default:return!1}Ub.g(this.$).fV(pa,
Ab,ob,null,pa[0],null,null,0,"MergeCellCommandAction");return this.fzb?sb:!0};e.prototype.Uaf=function(pa,Da){var rb=this.Yei(pa,Da);if(!this.ddf)return rb;var Ab=Ub.g(this.$).ha.sa.selectedRanges[0].dB(!1);E.ULS.sendTraceTag(526149324,0,50,"Merge Cell Command: {0}; Scenario Number: {1}; IsCSEPossible result: {2}; Range: {3}",Da.toString(),pa.scenario,rb,Ab);return rb};e.prototype.Yei=function(pa,Da){if(-255094134===Da)return!1;var rb=pa.scenario;if(this.adf&&262144===rb||this.qod&&65536===(rb&65536))return!1;
if(this.ghf(Da,pa))return this.Pni(Da,pa);this.pyb&&32===(rb&32)&&(rb&=-33);if(256==(rb&256))if(this.Iji(pa))rb&=-257;else return!1;return 32768===rb||4===rb||128===(rb&128)||!this.pyb&&32===rb?!1:-167499203!=Da&&1097660126!==Da||!this.cmd(pa)?void 0!==pa.tQ&&null!==pa.tQ&&pa.tQ.zea?!1:0===rb?!0:16384===(rb&16384)?y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1):1!==(rb&1)&&8!==(rb&8)||!y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellContentScenarioCse",
!1)?!1:!0:this.Hgc};e.prototype.$gi=function(pa){return 131072===(pa.scenario&131072)?!0:!1};e.prototype.Iji=function(pa){if(!this.fzb)return!1;var Da="Multi block",rb=!0;this.cmd(pa)&&(Da+=" with border",rb=!1);this.$gi(pa)&&(rb=!1,Da+=" with entire row or column selected",16384===(pa.scenario&16384)&&(Da+=" and a data loss scenario"));rb||E.ULS.sendTraceTag(523511383,0,50,"CSE for {0}, is not enabled",Da);return rb};e.prototype.cmd=function(pa){return 16===(pa.scenario&16)||this.Xhd(pa.scenario)||
this.wid(pa.scenario)||this.hid(pa.scenario)||this.zid(pa.scenario)||8192===(pa.scenario&8192)?!0:!1};e.prototype.ngi=function(pa,Da){return this.mgi?this.ghf(pa,Da):155820588===pa};e.prototype.ghf=function(pa,Da){return 155820588===pa||(-167499203===pa||1097660126===pa)&&2===(Da.scenario&2)&&this.Ggc?!0:!1};e.prototype.Oni=function(pa){return this.zid(pa.scenario)||this.hid(pa.scenario)||this.Xhd(pa.scenario)||this.wid(pa.scenario)?!0:!1};e.prototype.Pni=function(pa,Da){if(1097660126===pa&&2===(Da.scenario&
2)||this.fgi&&void 0!==Da.tQ&&null!==Da.tQ&&Da.tQ.zea)return!1;this.pyb&&32===(Da.scenario&32)&&(Da.scenario&=-33);return 32768===Da.scenario||4===Da.scenario||256===(Da.scenario&256)&&this.tji||128===(Da.scenario&128)?!1:2===(Da.scenario&2)?this.Oni(Da)?y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1):y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithoutBorderScenariosCse",!1):!1};e.prototype.LUh=function(pa,Da,
rb){var Ab=pa.getRange();if(Ab.top===Da.top)if(pa.JKa)rb.SSa+=Ab.right-Ab.left+1;else{var ob=this.px.xQ(Ab,0);if(ob){var sb=ak(ob);for(ob=sb.next();!ob.done;ob=sb.next())ob=ob.value,ob.EKa&&(rb.SSa+=ob.getRange().right-ob.getRange().left+1)}}if(Ab.left===Da.left)if(pa.GKa)rb.eNa+=Ab.bottom-Ab.top+1;else if(ob=this.px.xQ(Ab,2))for(sb=ak(ob),ob=sb.next();!ob.done;ob=sb.next())ob=ob.value,ob.HKa&&(rb.eNa+=ob.getRange().bottom-ob.getRange().top+1);if(Ab.bottom===Da.bottom)if(pa.EKa)rb.oGa+=Ab.right-Ab.left+
1;else if(ob=this.px.xQ(Ab,1))for(sb=ak(ob),ob=sb.next();!ob.done;ob=sb.next())ob=ob.value,ob.JKa&&(rb.oGa+=ob.getRange().right-ob.getRange().left+1);if(Ab.right===Da.right)if(pa.HKa)rb.uQa+=Ab.bottom-Ab.top+1;else if(pa=this.px.xQ(Ab,3))for(pa=ak(pa),ob=pa.next();!ob.done;ob=pa.next())Da=ob.value,Da.GKa&&(rb.uQa+=Da.getRange().bottom-Da.getRange().top+1)};e.prototype.S9i=function(pa,Da){Da=ak(Da.OXc);for(var rb=Da.next();!rb.done;rb=Da.next()){rb=pa.Ae(rb.value.kf);rb=Ub.g(this.$).Ea.Fua(rb);for(var Ab=
rb.length,ob=1;ob<Ab;ob++){var sb=Ub.g(this.$).Ub(rb[ob].getRange());this.Hgc?sb.cell.deleteCellFromModel():(sb.Npb(),sb.clearFormat(),sb.cell.T9i());sb.uHb(!0)}}};e.prototype.ETj=function(pa,Da){pa.backgroundColor=Da.backgroundColor;pa.color=Da.color};e.prototype.Jhg=function(pa,Da){return{SpansBlocks:!0,OriginRow:pa,OriginColumn:Da,IsOrigin:!1,Columns:0,Rows:0,Width:0,Height:0,OriginDeltaX:0,OriginDeltaY:0}};e.prototype.fAg=function(pa,Da,rb,Ab,ob){rb=pa.Ae(rb.kf);if(!rb)return E.ULS.sendTraceTag(523547158,
0,15,"blockRange(intersection of block's range and the selected range) can't be null as the blocks we are checking are returned as the intersecting blocks"),null;var sb=new Hb.Range(pa.top,pa.left,rb.top,rb.left,!1,!1);if(rb.top==pa.top)var Pb=0;else sb.bottom=rb.top-1,Pb=Da.mfd(sb);rb.left==pa.left?sb=0:(sb.right=rb.left-1,sb=Da.nfd(sb));Da=this.Jhg(pa.top-1,pa.left-1);Da.OriginDeltaY=Pb;Da.OriginDeltaX=sb;Da.Rows=rb.bottom-rb.top;Da.Columns=rb.right-rb.left;Da.Height=ob;Da.Width=Ab;rb.top==pa.top&&
rb.left==pa.left&&(Da.IsOrigin=!0);pa=Ub.g(this.$).Ub(rb.topLeft);pa.cell.uZf(Da);return pa};e.prototype.pOd=function(pa,Da){var rb=[],Ab=Ub.g(this.$).Pe;if(!Ab)return rb;var ob=Ab.mfd(pa),sb=Ab.nfd(pa);if(Da.OXc){Da=ak(Da.OXc);for(var Pb=Da.next();!Pb.done;Pb=Da.next())if(Pb=this.fAg(pa,Ab,Pb.value,sb,ob))rb.push(Pb);else{rb=[];break}}return rb};e.prototype.NVh=function(pa,Da,rb,Ab){var ob=rb.bottom-rb.top,sb=rb.right-rb.left,Pb=[],Aa=Ab.scenario;if(256===(Aa&256)){if(Pb=this.pOd(rb,Ab),!Pb||0==
Pb.length)return Pb}else Da.cell.pOd(ob,sb),Pb.push(Da);ob=this.N2(this.L4(Da),!0,0,Aa,"merge");if(void 0!==pa&&null!==pa){sb=ak(Pb);for(var Ya=sb.next();!Ya.done;Ya=sb.next()){Ya=Ya.value;var kb=pa.cell.formattedText,lb=Object(Ma.a)(new gb.a,{TextRuns:kb.TextRuns,Fonts:kb.Fonts});lb.Text=void 0!==pa.cell.originalText&&null!==pa.cell.originalText?pa.cell.originalText:void 0!==pa.cell.userInput&&null!==pa.cell.userInput?pa.cell.userInput:kb.Text;ob=this.N2(this.L4(Ya),ob,1,Aa,"merge");this.Gg.EAa(Ya,
lb,!1,null,!0,"MergeCells",void 0,2);ob=this.N2(this.L4(Ya),ob,2,Aa,"merge");this.qod?Ya.Wpb(pa):this.ETj(Ya,pa);ob=this.N2(this.L4(Ya),ob,3,Aa,"merge");Ya.cell.q3g(pa.cell);ob=this.N2(this.L4(Ya),ob,4,Aa,"merge");Ya.cell.SBc(!1);ob=this.N2(this.L4(Ya),ob,6,Aa,"merge")}}this.S9i(rb,Ab);this.N2(this.L4(Da),ob,5,Aa,"merge");return Pb};e.prototype.hid=function(pa){return 4096===(pa&4096)};e.prototype.zid=function(pa){return 512===(pa&512)};e.prototype.Xhd=function(pa){return 2048===(pa&2048)};e.prototype.wid=
function(pa){return 1024===(pa&1024)};e.prototype.W$b=function(pa,Da){for(var rb=null,Ab=0;Ab<pa.length;Ab++)if(pa[Ab].BorderPosition===Da){rb=pa[Ab];break}return rb};e.prototype.UQh=function(pa,Da){this.thc?(Da=this.W$b(Da.cell.zM().Borders,2))&&pa.push(Da):(Da=Da.cell.zM().Borders,1<Da.length&&(Da=[Da[1]]),pa=[].concat(yk(Da),yk(pa)));return pa};e.prototype.eZh=function(pa,Da){this.thc?(Da=this.W$b(Da.cell.zM().Borders,0))&&pa.push(Da):(Da=Da.cell.zM().Borders,1<Da.length&&(Da=[Da[0]]),pa=[].concat(yk(Da),
yk(pa)));return pa};e.prototype.YIh=function(pa,Da){Da=this.px.xQ(Da.cell.getRange(),1);if(!Da||0===Da.length)return pa;if(this.thc){if(Da=Da[0].zM().Borders,Da=this.W$b(Da,0))Da.BorderPosition=1,pa.push(Da)}else{var rb=[];0<Da.length&&(rb=Da[0].zM().Borders);rb[0].BorderPosition=1;pa=[].concat(yk(rb),yk(pa))}return pa};e.prototype.YVh=function(pa,Da){Da=this.px.xQ(Da.cell.getRange(),3);if(!Da||0===Da.length)return pa;if(this.thc){if(Da=Da[0].zM().Borders,Da=this.W$b(Da,2))Da.BorderPosition=3,pa.push(Da)}else{var rb=
[];0<Da.length&&(rb=Da[0].zM().Borders);rb[0].BorderPosition=3;pa=[].concat(yk(rb),yk(pa))}return pa};e.prototype.MUh=function(pa,Da,rb){this.hid(pa.scenario)&&(Da=this.UQh(Da,rb));this.zid(pa.scenario)&&(Da=this.eZh(Da,rb));this.Xhd(pa.scenario)&&(Da=this.YIh(Da,rb));this.wid(pa.scenario)&&(Da=this.YVh(Da,rb));return Da};e.prototype.pZ=function(pa){if(0===pa.length)return null;var Da=[0,0,0,0],rb=[1,1,1,1],Ab=0;pa.forEach(function(sb){var Pb=sb.BorderPosition;rb[Pb]=sb.BorderLineStyle;var Aa=new Db.a(sb.Color.Red,
sb.Color.Green,sb.Color.Blue);Da[Pb]=Aa.nS();Ab|=sa.HelperMethods.h3a(sb.BorderPosition)});pa={};pa.LineStyle=rb;pa.Color=Da;var ob={};ob.BorderFormat=pa;ob.Border=Ab;return ob};e.prototype.e0d=function(pa,Da,rb){rb=void 0===rb?null:rb;var Ab=[];Ab=null!==rb?[].concat(yk(rb)):this.MUh(Da,Ab,pa);if(Da=this.pZ(Ab))pa.cell.Nab(pa.cell.getRange()),this.px.tHb(pa.cell.getRange()),this.Gg.Mda(Ub.g(this.$),-1690267012,Da,!1,null,[pa.cell.getRange()])};e.prototype.Nki=function(pa){return 512===(pa.scenario&
512)||4096===(pa.scenario&4096)||1024===(pa.scenario&1024)||2048===(pa.scenario&2048)?!0:!1};e.prototype.fZh=function(pa){pa=this.px.xQ(pa.cell.getRange(),1);return pa&&0!==pa.length?pa[0].JKa?(pa=pa[0].zM().Borders[0],pa.BorderPosition=1,pa):null:null};e.prototype.gZh=function(pa){pa=this.px.xQ(pa.cell.getRange(),3);return pa&&0!==pa.length?pa[0].GKa?(pa=pa[0].zM().Borders[0],pa.BorderPosition=3,pa):null:null};e.prototype.I2h=function(pa,Da,rb,Ab,ob){Da.cell.Kcg();if(this.Nki(pa))this.e0d(Da,pa);
else{var sb=8192===(pa.scenario&8192),Pb=Da.cell.getRange();sb&&this.abf?(Da.cell.Nab(),this.px.tHb(Pb)):ob?(ob=[],null!==rb&&ob.push(rb),null!==Ab&&ob.push(Ab),0<ob.length?this.e0d(Da,pa,ob):(Da.cell.Nab(),this.px.tHb(Pb))):sb&&!this.abf&&(Da.cell.Nab(),this.px.tHb(Pb))}};e.prototype.rQh=function(pa,Da){return null===pa||void 0===pa?!0:pa.cell.getRange().top===Da.topLeft.top&&pa.cell.getRange().left===Da.topLeft.left&&pa.cell.getRange().bottom===Da.topLeft.bottom&&pa.cell.getRange().right===Da.topLeft.right?
!0:!1};e.prototype.Uzi=function(pa,Da){Da=this.opf(pa,Da);if(this.fzb&&(!Da||0==Da.length))return!1;for(var rb=0;rb<Da.length;rb++)Da[rb].u0(2,!0),this.N2(this.L4(Da[rb]),!0,8,pa.scenario,"merge");return!0};e.prototype.cSj=function(pa){var Da=Ub.g(this.$).Ea.TJa(pa,this.$.activeItemName);if(Da&&Va.Ct(Da)){Da=ak(Da);for(var rb=Da.next();!rb.done;rb=Da.next())rb.value.UXd(pa,!0)}};e.prototype.opf=function(pa,Da){var rb=pa.tQ,Ab=Ub.g(this.$).Ub(Da[0]),ob=null,sb=null;this.Hgc&&(ob=this.fZh(Ab),sb=this.gZh(Ab));
var Pb=this.NVh(rb,Ab,Da[0],pa);if(this.fzb&&(!Pb||0==Pb.length))return Pb;this.Jji?this.cSj(Da[0]):Ub.g(this.$).Ea.a$(Da[0],this.$.activeItemName).UXd(Da[0],!0);this.N2(this.L4(Ab),!0,9,pa.scenario,"merge");if(this.Hgc&&this.cmd(pa))for(Da=this.rQh(rb,Da[0]),rb=ak(Pb),Ab=rb.next();!Ab.done;Ab=rb.next())this.I2h(pa,Ab.value,ob,sb,Da);return Pb};e.prototype.hKg=function(pa,Da,rb){var Ab=this;if(!(1>pa.Borders.length)){var ob=this.pZ(pa.Borders);rb.forEach(function(sb){sb=Ub.g(Ab.$).Ub(sb.getRange());
Ab.Gg.V2f(-1690267012,sb,ob,!1,null,!1,Da)})}};e.prototype.KOj=function(pa,Da,rb){for(var Ab=pa.length,ob=0;ob<Ab;ob++){pa[ob].cell.SBc();var sb=pa[ob].cell.getRange(),Pb=Ub.g(this.$).Ea.Fua(sb),Aa=Pb.length;if(-167499203===Da&&this.Ggc){var Ya=0;2===pa[ob].cell.jGd||1===pa[ob].cell.dM?Ya=3:2===pa[ob].cell.dM&&(Ya=1);pa[ob].u0(Ya,!1)}for(Ya=1;Ya<Aa;Ya++)Pb[Ya].attachCellToModel(),Pb[Ya].Wpb(pa[ob]),-167499203===Da&&this.Ggc&&Pb[Ya].u0(null,!1);this.hhf&&rb&&this.hKg(rb[ob],sb,Pb)}};e.prototype.HVe=
function(pa,Da){for(var rb=null,Ab=0;Ab<pa.length;Ab++)if(pa[Ab].BorderPosition===Da){rb=pa[Ab];break}return rb};e.prototype.XIh=function(pa,Da){var rb=pa.cell.zM();pa.EKa()&&pa.cell.RPa(1);pa.HKa()&&pa.cell.RPa(3);if((pa=this.px.xQ(Da,0))&&pa[0].EKa){var Ab=pa[0].zM().Borders;Ab=this.HVe(Ab,1);Ab.BorderPosition=0;rb.Borders.push(Ab);pa.forEach(function(ob){ob.RPa(1)})}(Da=this.px.xQ(Da,2))&&Da[0].HKa&&(pa=Da[0].zM().Borders,pa=this.HVe(pa,3),pa.BorderPosition=2,rb.Borders.push(pa),Da.forEach(function(ob){ob.RPa(3)}));
return rb};e.prototype.Nag=function(pa,Da,rb){var Ab=Ub.g(this.$).Ea.$ua(Da[0],this.$.activeItemName),ob=Ub.g(this.$).Ea.a$(Da[0],this.$.activeItemName),sb=[];if(void 0!==Ab&&null!==Ab&&(Da=Ub.g(this.$).Zua(Da[0],Ab),void 0!==Da&&null!==Da)){Da=Da.$$ge();for(Ab=[];Da.$$mn();){var Pb=Da.$$cu();if(Pb.dF){sb.push(Pb);this.N2(this.L4(Pb),!0,10,pa,"unmerge");Pb.cell.aYg();var Aa=Pb.cell.getRange();this.N2(this.L4(Pb),!1,11,pa,"unmerge");ob.UXd(Aa,!1);this.hhf&&(Pb=this.XIh(Pb,Aa),Ab.push(Pb))}}0<sb.length&&
(ob.lf.resetCellLookup(),this.KOj(sb,rb,Ab))}};e.prototype.N2=function(pa,Da,rb,Ab,ob){if(!this.ddf)return!1;pa!==Da&&E.ULS.sendTraceTag(526149323,0,50,"Merge Information for resultant cell is unexpectedly changed at step: {0}; Scenario: {1}; Command: {2}; Expected: {3}; Actual: {4}",rb,Ab,ob,Da?"populated":"empty",pa?"populated":"empty");return pa};e.prototype.L4=function(pa){return!!pa.cell.cell.Merge};Object(u.a)(e,"MergeCellCommandAction",null,[]);var yb=b(74),qb=b(95),dc=b(206),bb=b(42),db=b(494),
wc=b(397),nb=b(50),zb=b(67),ma=b(906),P=b(58),oa=b(1294),Ja=b(36),$a=b(355);d.prototype.Iii=function(pa){return 1896159024===pa||-1554384558===pa||-1113896058===pa||1554436520===pa||1415868706===pa||674605324===pa||1035996630===pa};d.prototype.Lc=function(pa,Da){return 2054778433===Da&&pa&1?!ta.a(this.$).whc:600686207===Da?!1:this.Iii(Da)&&I.a.any(this.gridView.ha.sa.selectedRanges,function(rb){return rb.Ue||rb.isRow})&&!this.Zff&&!this.Uff?!0:this.Qhc(pa,Da)};d.prototype.executeCommand=function(pa,
Da,rb){return this.Kb(Da,rb)};d.prototype.Ac=function(pa,Da,rb){if(pa=1===pa)switch(Da.command){case 1457172838:case 2036397036:case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:case 1886928607:case -992833457:case 218524921:case 996232352:case -167499203:case -255094134:case -693675336:case 322710748:case 1097660126:case 155820588:case 1896159024:case -1554384558:case 504848446:case 1504715724:case 1872288872:case 41465729:case -1451655532:case 1972143101:case -475861485:case -978843926:case 2098035706:case -2142700828:case 1405660955:case 1983983164:case 478842689:case -798660877:case -653661711:case 862890474:case 963349338:case 1012765228:case 1597684571:case -1832800737:case -1920201820:case -1942512156:case -600086683:case -208772570:case -987339782:case 748067091:case -381232414:case 1696566924:case 894341014:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:case -1770246794:break;
case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:pa=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",!1);break;case -1077965542:case 909774670:case -1904244080:case -1293291468:case 324978188:case -1428968098:case 1970784898:case -803000997:case -128950598:case 1688184685:case 87208751:case -446735083:case 1650812936:case 673562736:case -1690267012:case -236759591:case -1803452024:case -2118943501:case 1890566896:case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:case 886009118:case 165054436:case 1981714220:case -556441918:case 942362098:case 622604322:case 1405456548:case 284490184:case 1256700402:case -1756763834:case -1418159950:pa=
!!rb;break;case 862825906:case 1532790410:case 46555851:case -1522760979:pa=!0;break;default:pa=!1}return pa};d.prototype.Qc=function(pa,Da,rb){switch(Da){case "PopulateFontColor":rb.MenuItems=this.vB.hac(1970784898,-803000997,null,null,-128950598,2036397036,1688184685,862825906,rb.MenuId);break;case "PopulateFillColor":rb.MenuItems=this.vB.hac(1650812936,null,87208751,2063445891,673562736,1457172838,-446735083,1532790410,rb.MenuId);break;case "PopulateBorderColor":rb.MenuItems=this.vB.hac(-236759591,
-1803452024,void 0,void 0,void 0,void 0,void 0,46555851,rb.MenuId);break;case "PopulateBorderStyle":this.borderFormatManager.b3h(rb);break;case "PopulateFontDropdown":case "PopulateFontRTFDropdown":if(this.cn&&(this.fontDropdownHelper.erj(rb.MenuId),!this.fontDropdownHelper.Fhi()))return!1;rb.MenuItems=this.fontDropdownHelper.aVe(-1293291468,324978188,-1428968098,rb.MenuId);break;default:return!1}return!0};d.prototype.Qhc=function(pa,Da){var rb=Ub.g(this.$).ha.sa.selectedRanges;return!(new xa.a(this.$.va)).Bm(pa,
Da,rb,this.gridView)};d.prototype.Kb=function(pa,Da){var rb=this,Ab=this.gridView,ob=pa.command,sb=B.TaskExtensions.jk(),Pb=!0;switch(ob){case -1077965542:Pb=this.I4e(Da,pa,!1);break;case 909774670:this.dpb(ob);Pb=this.I4e(Da,pa,!0);break;case -1293291468:Pb=this.G4e(Da,pa,!1);break;case 324978188:y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&E.ULS.sendTraceTag(574650248,0,50,"GridCommandHandler.HandleRibbonCommand: Handle font name preview");this.dpb(ob);Pb=
this.G4e(Da,pa,!0);break;case 862890474:case 963349338:Pb=this.w2h(pa);break;case -1832800737:Pb=this.Pcc(ob,Da,!1,pa);break;case 1970784898:Pb=this.Pcc(ob,Da,!1,pa);break;case -803000997:Pb=this.Pcc(ob,Da,!1,pa);break;case -128950598:case 1688184685:this.dpb(ob);Pb=this.Pcc(ob,Da,!0,pa);break;case 1597684571:Pb=this.hwb(ob,Da,!1,pa);break;case 87208751:Da.Color="-1";Da.IntColor=!0;Pb=this.hwb(ob,Da,!1,pa);break;case -446735083:this.dpb(ob);Da.Color="-1";Da.IntColor=!0;Pb=this.hwb(ob,Da,!0,pa);break;
case 1650812936:Pb=this.hwb(ob,Da,!1,pa);break;case 673562736:this.dpb(ob);Pb=this.hwb(ob,Da,!0,pa);break;case -1904244080:case -1428968098:case 1457172838:case 2036397036:y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(pa=nb.b().fi(ob),E.ULS.sendTraceTag(537159510,0,50,"GridCommandHandler.HandleRibbonCommand: Handle {0}",pa));this.YSf(ob);break;case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:Pb=this.g2h(ob,pa);break;case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:Pb=
this.o1h(ob,pa);break;case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:Pb=this.X2h(ob,pa);break;case -1803452024:case -236759591:Pb=this.ghd(ob,Da,pa);break;case -2118943501:Pb=this.borderFormatManager.z1h(Da,pa);break;case 1012765228:Pb=this.borderFormatManager.q3h(Da,pa);break;case 1256700402:Pb=this.borderFormatManager.lhd(pa);break;case -1756763834:Pb=this.borderFormatManager.mhd(pa);break;case -1418159950:Pb=this.borderFormatManager.u4e(pa);break;
case -1920201820:case -1942512156:Pb=this.x2h(ob,pa);break;case -1690267012:case -600086683:case 165054436:case 1981714220:case -556441918:Pb=this.borderFormatManager.h4e(Da,pa);this.Bzh(Da);break;case 1890566896:case 1886928607:case -992833457:case 218524921:case 996232352:Pb=this.T2h(ob,Da,pa);break;case -693675336:case 322710748:break;case 1696566924:Pb=this.h2h(pa);break;case -167499203:case -255094134:case 1097660126:case 155820588:sb=this.handleMergeCellsCommand(this.gridView,pa);break;case 1896159024:case -1554384558:Da=
this.gridView.ha.sa.selectedRanges;if(this.Hxj(pa,Da))E.ULS.sendTraceTag(574993492,0,50,"GridCommandHandler.HandleRibbonCommand: showing InsertDeleteCellsDialog"),(new f(this.$,ob,Da)).sg(),Pb=!0;else if(I.a.any(Da,function(Ya){return rb.gridView.Ab.kMa(Ya)})){Ab="";sb=1461300262;var Aa=-1554384558===ob&&this.gridView.Ab.Oki(Da[0]);Da=Da[0].height>Da[0].width&&!Aa;switch(ob){case 1896159024:Ab=Da?"InsertColumnsTable":"InsertRowsTable";sb=Da?622604322:942362098;break;case -1554384558:Ab=Da?"DeleteColumnsTable":
"DeleteRowsTable",sb=Da?284490184:1405456548}Da=Ea.a.Wp(d.ild,Ab,1);new la.a(sb,1,2,6,null);sb=this.insertOrDeleteCells(Da,pa,!0)}else sb=this.insertOrDeleteCells(1896159024===ob?1:2,pa,!1);break;case 942362098:case 622604322:case 1405456548:case 284490184:sb=this.insertOrDeleteCells(Ea.a.Wp(d.ild,Da[qa.a.Nc],1),pa,!0);break;case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:sb=this.insertOrDeleteCells(Ea.a.Wp(d.ild,Da[qa.a.Nc],1),pa,!1);break;case 504848446:sb=Ab.startEdit(!1,
1,Da[ea.a.event],void 0,void 0,!0);break;case 1504715724:if(Ub.g(this.$).mz&&this.borderFormatManager.CU.jB)break;sb=Ab.startEdit(!0,0,Da[ea.a.event],void 0,void 0,!0);break;case 1872288872:this.Rpb();break;case 41465729:sb=this.fill(Ab.ha.sa.Vc,null,0,1,pa);break;case -1451655532:case 1972143101:sb=this.fillDownAbsoluteValueAndStartEdit(Ab,Da[ea.a.event],-1451655532===ob);break;case -475861485:sb=this.fill(Ab.ha.sa.Vc,null,Ab.rtl?1:2,1,pa);break;case -978843926:sb=this.fill(Ab.ha.sa.Vc,null,3,1,
pa);break;case 2098035706:sb=this.fill(Ab.ha.sa.Vc,null,Ab.rtl?2:1,1,pa);break;case -2142700828:sb=this.fill(Ab.ha.sourceRange,Ab.ha.sa.Vc,d.oYe(Ab.ha.sa.Vc,Ab.ha.sourceRange),2,pa);break;case 1405660955:sb=this.fill(Ab.ha.sourceRange,Ab.ha.sa.Vc,d.oYe(Ab.ha.sa.Vc,Ab.ha.sourceRange),4,pa);break;case 1983983164:sb=this.fill(Ab.ha.sa.Vc,null,0,0,pa);break;case 478842689:(pa=this.$.da.za(376))?(pa.q3i(),Pb=!0):E.ULS.sendTraceTag(537159509,0,15,"gridHighlightBehaviorEventManager is null for TouchAutoFill");
break;case -798660877:case -653661711:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:Pb=Ab.ha.Kb(null,ob);break;case -208772570:this.O2h();Pb=!0;break;case -987339782:this.H1h();Pb=!0;break;case -1770246794:Ab.ha.I1h();Pb=!0;break;case 748067091:case -381232414:this.L1h(ob);Pb=!0;break;case -1522760979:this.gridView.toggleFormulaView();Pb=!0;break;case 886009118:sb=this.u2h();break;case 894341014:this.z2h();Pb=!0;break;case 862825906:sb=this.X4e(1970784898,pa);break;
case 1532790410:sb=this.X4e(1650812936,pa);break;case 46555851:sb=this.K2h(pa);break;default:Pb=!1}Pb||(sb=ya.a(ob));return sb};d.prototype.Bzh=function(pa){pa&&pa.MenuItemId&&["OutsideBorders","AllBorders","ThickOutsideBorders"].includes(pa.MenuItemId)&&y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&this.FOg(new $a.a(this.gridView.ha.sa.activeRange,Y.d(this.$.va.pa)))};d.prototype.FOg=function(pa){B.TaskExtensions.Ba(A.GetServiceTaskFactory.Ra(this.$.da,
426,427,1),function(Da){Da.result.jWd(pa,"BorderActions")},this.$.la,3)};d.prototype.Hxj=function(pa,Da){var rb=this,Ab=I.a.all(Da,function(Pb){return!rb.gridView.Ab.kMa(Pb)}),ob=1<Da.length&&!!this.gridView.Ab.bgd(Da),sb=I.a.all(Da,function(Pb){return!rb.gridView.Ab.c5(Pb)});Da=!I.a.any(Da,function(Pb){return Pb.isRow||Pb.Ue});return 1===pa.method&&6===pa.Me&&(Ab||ob)&&sb&&Da};d.prototype.fillDownAbsoluteValueAndStartEdit=function(pa,Da,rb){var Ab=this,ob=pa.ha.sa.activeCell,sb=ha.E(ob,this.gridView.As);
return pa.startEdit(!0,0,Da).eo(function(){var Pb=pa.Ub(sb),Aa=pa.Ub(ob);if(!Pb||!Aa)return E.ULS.shipAssertTag(537159507,0,!1,"GridCommandHandler.FillDownAbsoluteValueAndStartEdit Cannot get cells for active cell: {0} and above cell: {1}",ob.toString(),sb.toString()),P.Task.Ua(!1);Ab.gridView.Wb.text=rb?Pb.Q0:Pb.text;Ab.gridView.Wb.textBox.setCaretPositionToEnd();return P.Task.Ua(!0)})};d.prototype.insertOrDeleteCells=function(pa,Da,rb){function Ab(){return new n(kb)}var ob=this,sb=U.a.create().toString(),
Pb=Enum.toString(Z,pa);this.gridView.ui.w7(17,sb,Pb);Pb=this.gridView.ha.sa.selectedRanges;var Aa=this.Zff,Ya=this.Uff;if(!this.$.kq(null,!1,void 0,Da.Me)&&!Ya&&!Aa&&5!==pa&&9!==pa)return P.Task.Ua(!0);2===pa?pa=Ya?10:Aa?6:Pb[0].height>Pb[0].width?18:34:1===pa?pa=Ya?9:Aa?5:Pb[0].height>Pb[0].width?17:33:18===pa&&Aa?pa=34:34===pa&&Ya&&(pa=18);Pb=this.aIg(Pb,pa);if((10===pa||6===pa)&&!this.$.kq(Pb,!0,1,Da.Me))return P.Task.Ua(!0);var kb={};kb.InsertDeleteRangeItems=Array(Pb.length);kb.SheetName=this.$.pa.sheetName;
kb.IsTableCommand=rb;for(rb=0;rb<Pb.length;rb++){Aa=Pb[rb];var lb={},ac=Ya=void 0;pa&4?(lb.FirstRow=Aa.top-1,lb.LastRow=X.a.$x,lb.FirstColumn=0,lb.LastColumn=X.a.Xu,Ya=Aa.bottom-Aa.top+1,ac=0,6===pa&&(Aa.Ue||(lb.FirstRow=Aa.bottom),Ya=-Ya)):pa&8?(lb.FirstRow=0,lb.LastRow=X.a.$x,lb.FirstColumn=Aa.left-1,lb.LastColumn=X.a.Xu,Ya=0,ac=Aa.right-Aa.left+1,10===pa&&(Aa.isRow||(lb.FirstColumn=Aa.right),ac=-ac)):pa&16?(lb.FirstRow=Aa.top-1,lb.LastRow=Aa.bottom-1,lb.FirstColumn=Aa.left-1,lb.LastColumn=X.a.Xu,
Ya=0,ac=Aa.right-Aa.left+1,18===pa&&(lb.FirstColumn=Aa.right,ac=-ac)):(lb.FirstRow=Aa.top-1,lb.LastRow=X.a.$x,lb.FirstColumn=Aa.left-1,lb.LastColumn=Aa.right-1,Ya=Aa.bottom-Aa.top+1,ac=0,34===pa&&(lb.FirstRow=Aa.bottom,Ya=-Ya));lb={InsertDeleteRange:lb};lb.DeltaRow=Ya;lb.DeltaColumn=ac;lb.AdjustedSelectedRange=ha.j(Aa);kb.InsertDeleteRangeItems[rb]=lb}this.gridView.ig.IG(!1);var Dc=y.EwaSettings.isChangeGateEnabled("OfficeVSO:4932761_InsertDeleteCellsDecoupled");kb.IsDecoupleRecalc=Dc;var Zb=this.$.oa.xa.Pb();
return wa.a(this.$.userOperationManager,function(mc,Lb,Sa){Dc&&!y.EwaSettings.isChangeGateEnabled("OfficeVSO:5316173_RecoverableFromOOM")||ob.$.ry();var Cb=ob.$.oa.xa;mc=W.b(mc,ob.kNi);var ec=Cb.Na(41,void 0===Zb?null:Zb);ec.insertDeleteMultiRangeParameters=kb;return S.g(Cb,"InsertDeleteCells",ec,mc,Lb,Sa,sb,0)},function(mc){return new Qa.a(237,0,mc,void 0,Ab)},Da)};d.prototype.aIg=function(pa,Da){return Da&32?this.IYa(pa,function(rb){return rb.bottom},function(rb){return rb.top},function(rb,Ab){rb.bottom=
Ab},!1,!0):Da&16?this.gridView.rtl?this.IYa(pa,function(rb){return rb.left},function(rb){return rb.right},function(rb,Ab){rb.left=Ab},!1,!1):this.IYa(pa,function(rb){return rb.right},function(rb){return rb.left},function(rb,Ab){rb.right=Ab},!1,!1):Da&4?this.IYa(pa,function(rb){return rb.bottom},function(rb){return rb.top},function(rb,Ab){rb.bottom=Ab},!0,!0):Da&8?this.gridView.rtl?this.IYa(pa,function(rb){return rb.left},function(rb){return rb.right},function(rb,Ab){rb.left=Ab},!0,!1):this.IYa(pa,
function(rb){return rb.right},function(rb){return rb.left},function(rb,Ab){rb.right=Ab},!0,!1):pa};d.prototype.IYa=function(pa,Da,rb,Ab,ob,sb){pa=ha.d(pa);pa.sort(function(Ya,kb){return Da(kb)-Da(Ya)});if(ob){ob=[];sb=y.EwaSettings.isChangeGateEnabled("OfficeVSO:5181014_DeletingLastTwoRowsColsFix")?sb?X.a.vh+1:X.a.Eh+1:sb?X.a.$x:X.a.Xu;for(var Pb=0;Pb<pa.length;Pb++){var Aa=pa[Pb];rb(Aa)<sb&&(Ab(Aa,Math.min(Da(Aa),sb-1)),ob.push(Aa),sb=rb(Aa))}pa=ob}return pa};d.prototype.fill=function(pa,Da,rb,Ab,
ob){function sb(){return new m(Ya,kb,Ab,rb)}var Pb=this,Aa=this.$;if(!Aa.kq([Da],!0))return P.Task.Ua(!0);var Ya=ha.v(pa,Aa),kb=Da?ha.v(Da,Aa):Ya,lb=this.$.oa.xa.Pb();return wa.a(this.$.userOperationManager,function(ac,Dc,Zb){Pb.$.ry();var mc=Pb.$.oa.xa,Lb=mc.Na(9,lb);Lb.sourceRange=Ya;Lb.targetRange=kb;Lb.fillDirection=rb;Lb.fillType=Ab;return S.g(mc,"FillRange",Lb,ac,Dc,Zb,null,0)},function(ac){return new Qa.a(155,0,ac,void 0,sb)},ob)};d.prototype.T2h=function(pa,Da,rb){var Ab={ValidMembers:32};
switch(pa){case 1890566896:pa=parseInt(Da[qa.a.Nc].toString(),10);if(14===pa)return rb=new la.a(2105621672,rb.method,rb.mode,rb.Me,rb.tabName),Da[qa.a.Nc]=null,this.$.Ka.Kb(rb,Da),E.ULS.sendTraceTag(537159506,0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered NumberFormatDialog command, with menu item 14."),!0;Ab.NumberFormat=pa;break;case 1886928607:Ab.NumberFormat=13;break;case -992833457:Ab.NumberFormat=11;break;case 218524921:Ab.NumberFormat=12;break;case 996232352:Ab.NumberFormat=
1006;break;default:return E.ULS.shipAssertTag(537159505,0,!1,"Unexpected number formatting command "+nb.b().fi(rb.command)),!1}E.ULS.sendTraceTag(537159504,0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered {0} command, with menu item {1}.",nb.b().fi(rb.command),Da[qa.a.Nc]);this.Gg.formatCells(1890566896,Ab,rb);this.$.jf();return!0};d.prototype.w2h=function(pa){var Da=this.gridView.Ub(this.gridView.ha.sa.activeCell);if(this.tb&&this.gridView.isEditing){Da=this.gridView.Ki.D3a(Da?dc.a(Da).Font:
null);if(!Da)return E.ULS.shipAssertTag(537159503,0,!1,"GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: fontType for range {0} is null while editing",this.gridView.ha.sa.activeCell.toString()),!1;var rb=Da.FontSize}else if(Da)rb=Da.fontSize;else return!1;Da=pa.command;var Ab=0;if(862890474===Da)for(;Ab<d.kJa.length-1&&d.kJa[Ab]<=rb;)Ab++;else if(963349338===Da)for(Ab=d.kJa.length-1;0<Ab&&d.kJa[Ab]>=rb;)Ab--;E.ULS.sendTraceTag(537159501,0,50,"GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: change font from size {0} to size {1}",
rb,d.kJa[Ab]);if(rb===d.kJa[Ab])return!0;rb=d.yvc(2);rb.Font.FontSize=d.kJa[Ab];this.tb&&this.gridView.isEditing?(this.Gnb(pa,!1,rb),this.$.jf()):this.Gg.formatCells(Da,rb,pa);return!0};d.prototype.I4e=function(pa,Da,rb){pa=pa[pa[M.a.IsFreeForm]?M.a.Value:qa.a.Vf].toString();if(!d.KZi.test(pa))return E.ULS.sendTraceTag(537159499,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command is not a number."),y.EwaSettings.isChangeGateEnabled("OfficeVSO:5115068_FontSizeCommandHandledForInvalidParameter")?
!0:!1;pa=parseFloat(pa);if(8>pa||72<pa)return E.ULS.sendTraceTag(537159497,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command is not within expected limits ({0} - {1}).",8,72),y.EwaSettings.isChangeGateEnabled("OfficeVSO:5115068_FontSizeCommandHandledForInvalidParameter")?!0:!1;var Ab=Math.round(2*pa)/2,ob=d.yvc(2);ob.Font.FontSize=Ab;this.tb&&this.gridView.isEditing?(this.Gnb(Da,rb,ob,!0),Ab===pa||rb||this.$.jf()):rb?this.Gg.Mda(this.gridView,-1077965542,ob,rb):(this.Gg.formatCells(-1077965542,
ob,Da),this.A_a());return!0};d.prototype.G4e=function(pa,Da,rb){var Ab=pa[qa.a.Vf];if(this.cn){var ob=this.fontDropdownHelper.Tyc?this.fontDropdownHelper.Tyc[Ab]:null;ob||(E.ULS.sendTraceTag(523903201,1,15,"GridCommandHandler.HandleFontFamilyCommand: font in supportedFontFamiliesNew is not found for {0}",Ab),ob=sa.HelperMethods.iS[Ab])}else ob=sa.HelperMethods.iS[Ab];var sb=0;this.Cm&&(pa=pa.MenuItemId,pa===oa.b?(Ab==this.themesManager.hL.Kpf&&(ob=Ab),sb=2):pa===oa.a&&(Ab==this.themesManager.hL.cof&&
(ob=Ab),sb=1));if(!ob)return!0;Ab=d.yvc(1);Ab.Font.FontName=ob;this.Cm&&(Ab.Font.FontScheme=sb);this.tb&&this.gridView.isEditing?(this.Gnb(Da,rb,Ab),this.$.jf()):rb?this.Gg.Mda(this.gridView,-1293291468,Ab,rb):(this.Gg.formatCells(-1293291468,Ab,Da),this.A_a());return!0};d.prototype.Pcc=function(pa,Da,rb,Ab){var ob=-803000997===pa||1688184685===pa?"black":Da.Color;this.moreColorsHelper&&(-1832800737===pa?ob=va.a.compare(ob,"WindowText",!0)?this.moreColorsHelper.WGb:"black":rb||(this.moreColorsHelper.WGb=
ob,this.moreColorsHelper.Uca(Da,ob,Ab)));pa=d.yvc(32);pa.Font.FontColor=Ka.a.ZG(ob,Ea.a.xg(Da,"IntColor"));this.tb&&this.gridView.isEditing?this.Gnb(Ab,rb,pa,17===Ab.Me):rb?this.Gg.Mda(this.gridView,1970784898,pa,rb):(this.NC&&(rb=this.getThemeColor(Da),Da=rb.themeColor,rb.returnValue&&(pa.Font.ThemeFontColor=Da,pa.Font.ColorTypeOption=1)),this.Gg.formatCells(1970784898,pa,Ab),this.A_a());return!0};d.prototype.L1h=function(pa){var Da=(new Date).format(748067091===pa?this.$.ya.ShortDateFormat:this.$.ya.ShortTimeFormat),
rb=this.gridView.sj?ab.a(this.gridView.$):this.gridView.Wb;pa=rb.textBox;if(this.gridView.isEditing)rb.insertText(Da);else{var Ab=y.EwaSettings.isChangeGateEnabled("OfficeVSO:6336696_ChangeEditingModeAfterInsertDateOrTime")?0:1;this.gridView.startEdit(!0,Ab);rb.text=Da;Da=Da.length;pa.cRa(Da);pa.caretPosition=Da}};d.prototype.O2h=function(){this.gridView.YQ(this.gridView.ha.sa.activeCell)||this.gridView.Vuc||this.gridView.gMa()||this.gridView.hr(this.gridView.ha.sa.activeCell,3,qb.a.S3e)};d.prototype.H1h=
function(){if(!(this.gridView.Vuc||this.gridView.gMa()||this.gridView.isEditing&&T.a.isMac)){var pa=this.gridView.ha.sa.Y3;this.gridView.hg(ha.v(pa,this.$),pa,null,null,60,qb.a.S3e)}};d.prototype.h2h=function(pa){var Da=this;this.e$b=Y.d(this.$.va.pa);var rb=this.$.da.za(254,!0);if(this.gridView.Y5a)return this.gridView.ig.IG(!1),!!rb;if(!rb)return E.ULS.sendTraceTag(537159494,0,50,"GridCommandHandler.HandleFormatPainter : copyPasteInfrastructure is null"),!1;this.gridView.ha.mY(this.Vad);var Ab=
String.format(ea.a.kta,Na.a.current.Uo(106));this.gridView.ig.zo(Ab);pa=new la.a(-911352779,pa.method,pa.mode,pa.Me,pa.tabName);Ab={};this.$.Ka.Kb(pa,(Ab[ea.a.silentClipboardAccessFailures]=!0,Ab[ea.a.isFormatPainter]=!0,Ab)).continueWith(function(ob){(6>ob.status||6===ob.status&&!ob.result)&&Da.Rpb()});this.gridView.Y5a=!0;rb.$Fg(this.Rpb);return!0};d.prototype.hwb=function(pa,Da,rb,Ab){var ob=87208751===pa?"-1":Da.Color;this.moreColorsHelper&&(1597684571===pa?ob=this.moreColorsHelper.xab:rb||(this.moreColorsHelper.xab=
ob===d.notSet?d.dWd:ob,this.moreColorsHelper.Uca(Da,ob,Ab)));pa={ValidMembers:64};pa.FillColor=Ka.a.ZG(ob,Ea.a.xg(Da,"IntColor"));rb?this.Gg.Mda(this.gridView,1650812936,pa,!0):(this.NC&&(rb=this.getThemeColor(Da),Da=rb.themeColor,rb.returnValue&&(pa.ThemeFillColor=Da,pa.ColorTypeOption=1)),this.Gg.formatCells(1650812936,pa,Ab),this.A_a());return!0};d.prototype.z2h=function(){E.ULS.sendTraceTag(537159493,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Started handling the command");var pa=
this.$.da.za(221);if(pa){var Da=this.gridView.Ki;if(Da){var rb=pa.Gbi(Da.text,Da.textBox.caretPosition);var Ab=rb.Uqf;var ob=rb.YSe;(rb=rb.returnValue)?(pa.isListVisible=!1,Da.text=rb,Da.textBox.selectRange(Ab,Ab+ob),E.ULS.sendTraceTag(587534607,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell InsertFormulaArguments executed successfully")):E.ULS.sendTraceTag(537159490,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Can't insert formula arguments with current text and caret position.")}else E.ULS.shipAssertTag(537159491,
0,!1,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No editor object")}else E.ULS.sendTraceTag(537159492,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No formulaAssistanceControl object")};d.prototype.g2h=function(pa,Da){var rb=0,Ab=this.gridView,ob=dc.a(Ab.Ub(null));this.tb&&Ab.isEditing&&(ob.Font=Ab.Ki.D3a(ob.Font));var sb=ob.Font;sb||(sb={ValidMembers:0});switch(pa){case -287251124:rb|=4;ba.e(sb,4)?sb.Bold=!sb.Bold:sb.Bold=!0;break;case -1925065947:rb|=8;ba.e(sb,8)?sb.Italic=
!sb.Italic:sb.Italic=!0;break;case 1764140053:rb|=16;ba.e(sb,16)?sb.Underline=!sb.Underline:sb.Underline=!0;break;case -1685033574:rb|=64;ba.e(sb,64)?sb.DoubleUnderline=!sb.DoubleUnderline:sb.DoubleUnderline=!0;break;case -1590502662:rb|=128,ba.e(sb,128)?sb.Strikethrough=!sb.Strikethrough:sb.Strikethrough=!0}if(!rb)return!1;sb.ValidMembers=rb;ob.Font=sb;ob.ValidMembers=16;this.tb&&this.gridView.isEditing?this.Gnb(Da,!1,ob):(y.EwaSettings.ma(660)||Ab.ig.IG(!1),this.Gg.formatCells(pa,ob,Da));this.$.jf();
return!0};d.prototype.o1h=function(pa,Da){var rb=0,Ab=this.gridView,ob=dc.a(Ab.Ub(null));-571165336===pa||1041132226===pa||-394785302===pa?(rb|=1,ob.VerticalAlignment=Ea.a.Wp(d.OYa,pa.toString(),2)):d.sii(pa)?(rb|=2,this.r2h(ob,pa)):-1116189897===pa&&(rb|=8,ob.Wrap=ob.ValidMembers&8?!ob.Wrap:!0);if(!rb)return!1;ob.ValidMembers=rb;y.EwaSettings.ma(660)||Ab.ig.IG(!1);this.Gg.formatCells(pa,ob,Da);this.$.jf();return!0};d.prototype.r2h=function(pa,Da){!y.EwaSettings.isChangeGateEnabled("OfficeVSO:5049785_DisableTextAlignmentCommandFlipInRTL")&&
this.$.isChromeRtl&&-1142465846!==Da&&(Da=-1150205178===Da?-286432209:-1150205178);Da=Ea.a.Wp(d.OYa,Da.toString(),0);pa.HorizontalAlignment=Da===pa.HorizontalAlignment?0:Da};d.prototype.LIf=function(pa,Da,rb,Ab){var ob=this,sb=!1;y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1)&&(sb=this.Skc.npf(Da,rb))&&Ub.g(this.$).ui.B0(this.u8a,yb.BasicTelemetryCalculator.NQ);return this.Ksb(pa,Da,!1,sb,function(Pb){ob.tOi(Pb,rb,Da,sb,Ab)})};d.prototype.handleMergeCellsCommand=
function(pa,Da){var rb=this;this.u8a=U.a.create().toString();var Ab=null;Ab=this.Skc.XZe();var ob=ka.a(Da.command),sb=this.Skc.lgi(Da.command,Ab),Pb=y.EwaSettings.isChangeGateEnabled("OfficeVSO:5855030_MergeCellLogTelemetryForDataLossScenario"),Aa=0;Pb&&sb?Aa=F.a.oe():Ub.g(this.$).ui.w7(4,this.u8a,ob+", Scenario = "+Ab.scenario.toString());ob=pa.ha.sa.selectedRanges;E.ULS.sendTraceTag(537159459,0,50,"GridCommandHandler.HandleMergeCellsCommand: Merge Command: {0}, Number of ranges: {1}, Ranges: {2}",
nb.b().fi(Da.command),ob.length,ha.i(ob,",",this.$,!1));ob=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1);pa.ig.IG(!1,ob);if(10===Ea.a.Wp(d.ppf,Da.command.toString(),10))return P.Task.Ua(!1);var Ya=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1);if(ob&&Ya)return sb?(Pb?this.iRd(Ab,Da,!0,!0,Aa):this.iRd(Ab,Da,!0),P.Task.Ua(!0)):this.LIf(pa,Da,Ab,!1);var kb=!1;ob&&(kb=this.Skc.npf(Da,Ab))&&Ub.g(this.$).ui.B0(this.u8a,
yb.BasicTelemetryCalculator.NQ);return this.Ksb(pa,Da,!1,kb,function(lb){rb.uOi(lb,Da,kb)})};d.prototype.Ksb=function(pa,Da,rb,Ab,ob){function sb(Dc,Zb,mc){Ya.$.ry();Dc=ob?W.b(Dc,ob):Dc;Dc=W.b(Dc,Pb);return S.d(Ya.$.oa.xa,lb,ac,rb,Dc,Zb,mc,null,kb)}function Pb(Dc){var Zb=!!Dc&&!!Dc.RequestTelemetryData;Ub.g(Ya.$).ui.fla(Ya.u8a,Dc.StateId,Zb?Dc.RequestTelemetryData.EcsOperationDuration:0,Zb?Dc.RequestTelemetryData.EcsRequestDuration:0,Zb?Dc.RequestTelemetryData.WfeRequestDuration:0)}function Aa(){return new fa.a(lb,
ac)}var Ya=this;ob=void 0===ob?null:ob;var kb=this.$.oa.xa.Pb(),lb=Ea.a.Wp(d.ppf,Da.command.toString(),10),ac=ha.r(pa.ha.sa.selectedRanges,pa.$);return Ab?y.EwaSettings.Zb()?wa.a(this.$.userOperationManager,sb,function(Dc){return new Qa.a(156,0,Dc,64,Aa)},Da):wa.a(this.$.userOperationManager,sb,function(Dc){return new ia.a(156,0,Dc,void 0,Aa)},Da):wa.a(this.$.userOperationManager,sb,function(Dc){return new Qa.a(156,0,Dc,void 0,Aa)},Da)};d.prototype.iRd=function(pa,Da,rb,Ab,ob){var sb=this;Ab=void 0===
Ab?!1:Ab;ob=void 0===ob?0:ob;E.ULS.sendTraceTag(537159457,0,50,"Merge cells with multiple values. isCalledBeforeCSE :- {0}",rb);var Pb=Ub.g(this.$).rtl,Aa=y.EwaSettings.isChangeGateEnabled("OfficeVSO:5855030_MergeCellLogTelemetryForDataLossScenario");Pb=ra.a.Wc(3,2,0,Pb?638:637,0,514846606,"MergeCellsLoseData");B.TaskExtensions.Ba(bb.a(this.$).kj(Pb),function(Ya){Ya=Ya.result;if(Ab){var kb=F.a.oe()-ob;E.ULS.sendTraceTag(528779355,0,50,"Time taken to show Dialog in Data Loss Scenario is : {0}, and the user action is : {1}",
kb,Ya)}0===Ya?(E.ULS.sendTraceTag(537159456,0,50,"MergeCellsLoseData Dialog: Ok pressed"),rb?(Ab&&Aa&&(Ya=ka.a(Da.command),Ub.g(sb.$).ui.w7(4,sb.u8a,Ya+", Scenario = "+pa.scenario.toString())),sb.LIf(Ub.g(sb.$),Da,pa,!0)):sb.Ksb(sb.gridView,Da,!0,!1)):1===Ya&&E.ULS.sendTraceTag(537159455,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},this.$.la,11)};d.prototype.gui=function(pa,Da,rb,Ab){Da!==pa&&E.ULS.sendTraceTag(537159454,0,15,"MergeCellsLoseData flag as per client and server does not match. MergeCellsLoseData flag as per client is :- {0} and as per server is {1}. The scenario is:- {2}, The CSE is done:- {3}",
Da,pa,rb,Ab)};d.prototype.uOi=function(pa,Da,rb){var Ab=this;na.b(pa,514846606)&&(E.ULS.sendTraceTag(537159453,0,50,"Merge cells with multiple values"),zb.a(this.$).fd.hJ(514846606),pa=Ub.g(this.$).rtl,pa=ra.a.Wc(3,2,0,pa?638:637,0,514846606,"MergeCellsLoseData"),B.TaskExtensions.Ba(bb.a(this.$).kj(pa),function(ob){ob=ob.result;0===ob?(E.ULS.sendTraceTag(537159452,0,50,"MergeCellsLoseData Dialog: Ok pressed"),Ab.Ksb(Ab.gridView,Da,!0,rb)):1===ob&&E.ULS.sendTraceTag(537159451,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},
this.$.la,11))};d.prototype.tOi=function(pa,Da,rb,Ab,ob){var sb=this,Pb=!1;na.b(pa,514846606)&&(Pb=!0,zb.a(this.$).fd.hJ(514846606),Ab&&ob?window.setTimeout(function(){sb.Ksb(sb.gridView,rb,!0,!0)},0):this.iRd(Da,rb,!1));this.gui(Pb,ob,Da.scenario,Ab)};d.prototype.dpb=function(pa){var Da=y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");if(Da&&this.ZZa!==pa&&1461300262!==this.ZZa){this.YSf(this.ZZa);var rb=nb.b().fi(pa),Ab=nb.b().fi(this.ZZa);E.ULS.sendTraceTag(537159450,
0,50,"GridCommandHandler.CacheFontStyles: Style cached during {0} was restored before caching the style for {1} command.",Ab,rb)}Da&&(this.ZZa=pa);if(this.tb&&this.gridView.isEditing)this.WZa||(this.WZa=this.gridView.Ki.formattedText);else if(!this.HA){this.HA=[];Da=this.gridView.H$("GridCommandHandler.CacheFontStyles",this.gridView.ha.sa.selectedRanges);try{for(Da.$$rst();Da.$$mn();){var ob=Da.$$cu(),sb=ob.cell.hasRichText;if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var Pb=
nb.b().fi(pa);E.ULS.sendTraceTag(537159449,0,100,"GridCommandHandler.CacheFontStyles: Add CachedPreviewCellGroup following {0} command. isRichText({1}). Cache size is {2}",Pb,sb,this.HA.length)}if(sb)this.HA.push(w.ZQg(ob,ob.cell.formattedText));else switch(pa){case 673562736:case -446735083:this.HA.push(w.uYc(ob,ob.backgroundColor));y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!ob.backgroundColor&&E.ULS.sendTraceTag(537159448,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null BackgroundColor. isNull({0})",
!ob.backgroundColor);break;case -128950598:case 1688184685:this.HA.push(w.uYc(ob,ob.color));y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!ob.color&&E.ULS.sendTraceTag(537159447,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null Color. isNull({0})",!ob.color);break;case 909774670:this.HA.push(w.$Qg(ob,ob.fontSize));if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var Aa=ma.c(ob.fontSize)?"null or undefined":
ob.fontSize.toString();E.ULS.sendTraceTag(537159446,0,100,"GridCommandHandler.CacheFontStyles: cached font size is {0}",Aa)}break;case 324978188:this.Cm?this.HA.push(w.YQg(ob,ob.fontName,ob.xaa)):this.HA.push(w.uYc(ob,ob.fontName)),y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(ob.fontName?E.ULS.sendTraceTag(537159444,0,50,"GridCommandHandler.CacheFontStyles: cached FontName is ({0}) of length({1}).",gridRenderer.CanvasRendererGlobals.getFontNameForLogging(ob.fontName),
ob.fontName.length):E.ULS.sendTraceTag(537159445,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null FontName. isNull({0})",!ob.fontName))}}}finally{Da&&Da.dispose()}}};d.prototype.ZBj=function(){return this.tb&&this.gridView.isEditing?!this.WZa:!this.HA};d.prototype.cfi=function(pa){return!!this.HA&&this.HA.length>pa&&!!this.HA[pa].formattedText};d.prototype.T$b=function(pa){return this.HA[pa].style};d.prototype.CJh=function(pa){return this.HA[pa].size};d.prototype.BJh=function(pa){return this.HA[pa].xaa};
d.prototype.YSf=function(pa){if(this.ZBj())y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&E.ULS.sendTraceTag(537159443,0,100,"GridCommandHandler.RestoreCachedStyles: Nothing to restore following {0} command.",pa);else{if(this.tb&&this.gridView.isEditing)y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(pa=nb.b().fi(pa),E.ULS.sendTraceTag(537159442,0,50,"GridCommandHandler.RestoreCachedStyles: Restore style following {0} command. Formatted text is enabledand IsEditing is true.",
pa)),this.WZa&&(this.gridView.Wb.formattedText=this.WZa);else for(var Da=this.HA.length,rb=0;rb<Da;rb++){var Ab,ob=this.HA[rb].Via.cell.getRange();if(Ab=this.gridView.Ub(ob)){ob=void 0;var sb=Ab.dF?this.gridView.yJb(Ab.range):(ob=new ca.a,ob.add(Ab),ob);ob=ak(sb);for(sb=ob.next();!sb.done;sb=ob.next()){sb=sb.value;if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var Pb=nb.b().fi(pa);E.ULS.sendTraceTag(537159440,0,100,"GridCommandHandler.RestoreCachedStyles: Restore style following {0} command. formattedCell.Cell.HasRichText({1}). Cached item {2}. isMerge({3}). Cache size is {4}",
Pb,sb.cell.hasRichText,rb,Ab.dF,Da)}if(sb.cell.hasRichText&&1457172838!==pa)this.cfi(rb)&&(sb.cell.formattedText=this.HA[rb].formattedText,y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!sb.cell.formattedText&&E.ULS.sendTraceTag(537159439,0,100,"GridCommandHandler.RestoreCachedStyles: Setting FormattedText to null."));else switch(pa){case 1457172838:sb.backgroundColor=this.T$b(rb);y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
!sb.backgroundColor&&E.ULS.sendTraceTag(537159438,0,100,"GridCommandHandler.RestoreCachedStyles: Setting BackgroundColor to be empty or null. isNull({0}).",!sb.backgroundColor);break;case 2036397036:sb.color=this.T$b(rb);y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!sb.color&&E.ULS.sendTraceTag(537159437,0,100,"GridCommandHandler.RestoreCachedStyles: Setting Color to be empty or null. isNull({0}).",!sb.color);break;case -1904244080:sb.fontSize=this.CJh(rb);
y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(sb=ma.c(sb.fontSize)?"null or undefined":sb.fontSize.toString(),E.ULS.sendTraceTag(537159436,0,100,"GridCommandHandler.RestoreCachedStyles: Setting font size to {0}",sb));break;case -1428968098:Pb=y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation"),this.Cm?(sb.tKb(this.T$b(rb),Pb,"RestoreCachedStyles"),sb.SYf(this.BJh(rb))):sb.tKb(this.T$b(rb),Pb,"RestoreCachedStyles")}}}else E.ULS.sendTraceTag(537159441,
0,50,"GridCommandHandler.RestoreCachedStyles: Cell is not supposed to be null. Cell range: {0}",ob.dB(!1))}y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(this.ZZa=1461300262);this.A_a()}};d.prototype.A_a=function(){this.tb&&this.gridView.isEditing?this.WZa=null:this.HA=null;y.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&E.ULS.sendTraceTag(537159435,0,50,"GridCommandHandler.ClearCachedStyles: Cache cleared.")};d.prototype.x2h=
function(pa,Da){var rb={IndentationIncrease:0};if(-1942512156===pa)rb.IndentationIncrease=1;else if(-1920201820===pa)rb.IndentationIncrease=-1;else return!0;rb.ValidMembers=256;this.Gg.formatCells(pa,rb,Da);return!0};d.prototype.X2h=function(pa,Da){var rb=pa;!Ub.g(this.$).rtl||-1649235364!==pa&&524773427!==pa||(rb=-1649235364===pa?524773427:-1649235364);switch(rb){case -1649235364:rb=X.a.rotateTextUp45;break;case 524773427:rb=X.a.Ytc;break;case 1886217042:rb=X.a.rotateTextUp90;break;case 928057943:rb=
X.a.$tc;break;case -1526602249:rb=X.a.verticalText;break;default:return!1}var Ab={ValidMembers:512};Ab.TextOrientation=rb;this.Gg.formatCells(pa,Ab,Da);return!0};d.prototype.u2h=function(){var pa=this,Da=Ub.g(this.$),rb=ha.r(Da.ha.sa.selectedRanges,this.$),Ab=ha.o(Da.ha.sa.activeCell,this.$);E.ULS.sendTraceTag(42566215,0,50,"GridCommandHandler: HandleIgnoreErrorCommand Invoked.");return wa.a(this.$.userOperationManager,function(ob,sb,Pb){return da.q(pa.$.oa.xa,Ab,rb,ob,sb,Pb,null)},function(ob){return new Qa.a(201,
0,ob)},null)};d.prototype.X4e=function(pa,Da){var rb=null,Ab=Ub.g(this.$).ha.sa.selectedRanges;Ab=this.gridView.H$("MoreColors",Ab,1,!0);try{for(Ab.$$rst();Ab.$$mn();){var ob=Ab.$$cu().cell;if(ob){var sb=d.black;if(1970784898===pa)sb=ob.color;else if(1650812936===pa){var Pb=ob.backgroundColor;sb=va.a.compare(Pb,d.dWd,!0)&&va.a.compare(Pb,d.empty,!0)?ob.backgroundColor:d.white}if(!rb)rb=sb;else if(rb!==sb){rb=d.black;break}}}}finally{Ab&&Ab.dispose()}this.tb&&this.gridView.isEditing&&1970784898===
pa&&this.gridView.Ki.textBox.ite();return this.moreColorsHelper.pxa(pa,Da,rb)};d.prototype.K2h=function(pa){var Da=K.a.V3a(this.borderFormatManager.h3);return this.moreColorsHelper.pxa(-236759591,pa,Da)};d.prototype.Gnb=function(pa,Da,rb,Ab){var ob=this;Ab=void 0===Ab?!1:Ab;Da?this.gridView.Ki.MHf(rb.Font):(this.owi(pa),Ab?window.requestAnimationFrame(function(){J.FocusManager.instance().Jj(O.AFrame.U$);ob.gridView.Ki.cUe(rb.Font)}):(J.FocusManager.instance().Jj(O.AFrame.U$),this.gridView.Ki.cUe(rb.Font)),
this.A_a())};d.prototype.owi=function(pa){var Da=ka.a(pa.command);pa=N.a[pa.Me]+"_"+H.a[pa.method];var rb=this.gridView.$b.Ewe.toString(),Ab=new Map;Ab.set("Command",Da);Ab.set("Source",pa);Ab.set("Ribbon","React");Ab.set("CellTextRuns",rb);Q.Health.instance.recordKpiUsage(wc.a.TCh,0,db.a.zTf,Ab)};d.prototype.ghd=function(pa,Da,rb){pa=this.borderFormatManager.ghd(pa,Da,rb);this.moreColorsHelper&&this.moreColorsHelper.Uca(Da,this.borderFormatManager.h3,rb);return pa};d.prototype.getThemeColor=function(pa){var Da=
{};var rb=!1;if((pa.SqmControlId||"").includes("ThemeColorPicker")){if(!this.themesManager)return E.ULS.sendTraceTag(537159433,0,10,"GridCommandHandler.GetThemeColor: Themes Manager is null"),{returnValue:!1,themeColor:Da};rb=this.themesManager.getThemeColor(pa.Color);pa=rb.themeIndex;var Ab=rb.cBa;if(rb=rb.returnValue)Da.ThemeColorIndex=pa,Da.ThemeColorRow=Ab}return{returnValue:rb,themeColor:Da}};d.sii=function(pa){return-1150205178===pa||-1142465846===pa||-286432209===pa};d.yvc=function(pa){var Da=
{},rb={};Da.ValidMembers=16;Da.Font=rb;rb.ValidMembers=pa;return Da};d.oYe=function(pa,Da){var rb=pa.top<Da.top?3:pa.bottom>Da.bottom?0:-1;return rb=pa.left<Da.left?1:pa.right>Da.right?2:rb};Af.Object.defineProperties(d.prototype,{Zff:{configurable:!0,enumerable:!0,get:function(){return I.a.all(this.gridView.ha.sa.selectedRanges,function(pa){return pa.isRow})}},Uff:{configurable:!0,enumerable:!0,get:function(){return I.a.all(this.gridView.ha.sa.selectedRanges,function(pa){return pa.Ue})}},themesManager:{configurable:!0,
enumerable:!0,get:function(){this.gx||(this.gx=this.$.da.za(422));return this.gx}}});Af.Object.defineProperties(d,{KZi:{configurable:!0,enumerable:!0,get:function(){return d.Wce||(d.Wce=RegExp("^[0-9]+[.]?[0-9]*$"))}},ild:{configurable:!0,enumerable:!0,get:function(){var pa={};return d.B7d||(d.B7d=(pa.InsertRows=5,pa.InsertColumns=9,pa.InsertCellsShiftRight=17,pa.InsertCellsShiftDown=33,pa.DeleteRows=6,pa.DeleteColumns=10,pa.DeleteCellsShiftLeft=18,pa.DeleteCellsShiftUp=34,pa.DeleteRowsTable=6,pa.DeleteColumnsTable=
10,pa.InsertRowsTable=5,pa.InsertColumnsTable=9,pa))}},OYa:{configurable:!0,enumerable:!0,get:function(){var pa={};return d.kgb||(d.kgb=(pa["-394785302"]=0,pa["-571165336"]=2,pa["1041132226"]=1,pa["-1150205178"]=1,pa["-1142465846"]=2,pa["-286432209"]=3,pa))}},ppf:{configurable:!0,enumerable:!0,get:function(){var pa={};return d.oae||(d.oae=(pa["-167499203"]=2,pa["-255094134"]=5,pa["1097660126"]=6,pa["155820588"]=7,pa))}}});d.dWd="transparent";d.notSet="-1";d.black="#000000";d.empty="";d.white="#FFFFFF";
d.B7d=null;d.kgb=null;d.oae=null;d.Wce=null;d.kJa=[8,9,10,11,12,14,16,18,20,24,26,28,36,48,72];Object(u.a)(d,"GridCommandHandler",null,[403]);var Ta=G.a;Rk(c,Ta);c.prototype.zd=function(){var pa=this,Da=A.GetServiceTaskFactory.create(this.$.da,111,this.la,this.hb),rb=A.GetServiceTaskFactory.create(this.$.da,18,this.la,this.hb),Ab=A.GetServiceTaskFactory.create(this.$.da,397,this.la,this.hb),ob=A.GetServiceTaskFactory.Ra(this.$.da,502,503,this.hb);if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")){var sb=
A.GetServiceTaskFactory.Ra(this.$.da,296,468,this.hb);B.TaskExtensions.Ba(B.TaskExtensions.Wd([Da,rb,Ab,sb,ob],this.la),function(){pa.jd([new d(pa.$,Ub.g(pa.$),rb.result,Da.result,sb.result,Ab.result,ob.result)])},this.la,3)}else{var Pb=A.GetServiceTaskFactory.create(this.$.da,102,this.la,this.hb);B.TaskExtensions.Ba(B.TaskExtensions.Wd([Da,rb,Pb,Ab,ob],this.la),function(){pa.jd([new d(pa.$,Ub.g(pa.$),rb.result,Da.result,new x.BorderFormatManager(pa.$,rb.result,Pb.result),Ab.result,ob.result)])},
this.la,3)}};c.ka=function(pa){G.a.Qd(80,new c(pa))};Object(u.a)(c,"GridCommandHandlerFactory",G.a,[]);b.d(D,"a",function(){return a})},1383:function(u,D,b){function a(){Type.registerNamespace("Common.App.GestureManager");c.main()}function c(){this.fb=null;this.Xw=!1}function d(H,Q){var ca=J.call(this)||this;ca.Zpa=v.a.MGh;ca.vOc=!!window.PointerEvent;ca.Bhe=window.hasOwnProperty("ontouchstart");ca.dkb=null;ca.DVa=null;ca.I8=!1;ca.bT=new A.a;ca.xkb=new A.a;ca.Log=new n.a;ca.upa=null;ca.Xlb=!1;ca.x2d=
!1;ca.bee=!1;ca.rMc=!1;ca.MFc=!1;ca.r2d=!1;ca.QIc=!1;ca.GUa=!1;ca.Fjb=-1;ca.eRc=null;ca.session=null;ca.handlers=null;ca.element=null;ca.curRecognizer=null;ca.Ld=M.EventHandlerManager.instance;ca.vOc?(w.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),ca.dkb=Object(z.a)(ca,ca.Onc,"onPointerEvent"),ca.DVa=G.a.OGh):ca.Bhe?(w.ULS.sendTraceTag(593893140,310,50,"Using touch events"),ca.dkb=Object(z.a)(ca,ca.Cya,"onTouchEvent"),ca.DVa=G.a.touchEvents):(w.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),
ca.dkb=Object(z.a)(ca,ca.ync,"onMouseEvent"),ca.DVa=G.a.NGh);ca.qh=Q;ca.cfa=H;y.AFrameworkApplication.fa&&(ca.Xlb=y.AFrameworkApplication.fa.ra("UsePointerCaptureIsEnabled"),ca.x2d=y.AFrameworkApplication.fa.ra("ClearCacheOnPrimaryPointerIsEnabled"),ca.bee=y.AFrameworkApplication.fa.ra("ResetHandledBeforeInputHandlerIsEnabled"),ca.rMc=y.AFrameworkApplication.fa.ra("LogCoalescedEventsIsEnabled"),ca.MFc=y.AFrameworkApplication.fa.ra("CheckExistenceOfGetCoalescedEventsIsEnabled"),ca.r2d=y.AFrameworkApplication.fa.ra("CheckIfHammerExistsAfterDownloadIsEnabled"),
ca.QIc=y.AFrameworkApplication.fa.ra("HammerJsPerformanceTimersIsEnabled"),ca.GUa=ca.Xlb&&y.AFrameworkApplication.fa.ra("CancelDragFromGestureInputManagerIsEnabled")&&y.AFrameworkApplication.fa.ra("UseGestureInputManagerPointerCacheIsEnabled"));return ca}function e(){}function k(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=
this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}function l(H,Q,ca,X,Z,ea,ka,Y,qa){H=U.call(this,H,ca,X,ea)||this;H.Qgb=Q;H.bga=ka;H.CX=Y;H.zZj=qa;H.Kog=Z;return H}function m(){this.cHc=null}function f(){this.Wca=this.uVe=null}u=b(0);var w=b(15),n=b(202),z=b(83),r=b(85),v=b(410),A=b(100),B=b(43);Object(u.a)(f,"GestureAdapterInfo",null,[]);var y=b(4),x=b(393),C=b(236);m.prototype.Bsi=function(){if(!this.cHc){var H=
"hammer.min.js";y.AFrameworkApplication.fa.co("IsServerFlavorDebug")&&(H=y.AFrameworkApplication.fa.ra("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");H=y.AFrameworkApplication.QK(String.format("{0}",H),5);H=C.a.create(H,null,null);x.a.ria(H);this.cHc=H.O7a}return this.cHc};Af.Object.defineProperties(m,{instance:{configurable:!0,enumerable:!0,get:function(){m.Ma||(m.Ma=new m);return m.Ma}}});m.Ma=null;Object(u.a)(m,"HammerJsDependencyLoader",null,[696]);var G=b(13),E;(function(H){H[H.none=-1]=
"none";H[H.pinch=0]="pinch";H[H.pan=1]="pan";H[H.swipe=2]="swipe"})(E||(E={}));Object(u.b)("GestureEvent",E);var I=b(75),U=I.a;Rk(l,U);l.create=function(H,Q,ca,X,Z,ea){if(ca.rawEvent)if(ea){var ka=ca.rawEvent;ka=new Sys.UI.Point(ka.clientX,ka.clientY)}else ka=I.a.Iub(ca);else ka=new Sys.UI.Point(ca.clientX,ca.clientY);return new l(H,ka,Q,ca,X,Z,ca.shiftKey,ca.ctrlKey,ea)};Af.Object.defineProperties(l.prototype,{shiftKey:{configurable:!0,enumerable:!0,get:function(){return this.bga}},ctrlKey:{configurable:!0,
enumerable:!0,get:function(){return this.CX}},clientPoint:{configurable:!0,enumerable:!0,get:function(){return this.Qgb}},Eua:{configurable:!0,enumerable:!0,get:function(){return this.Kog}}});Object(u.a)(l,"GestureEventArgs",I.a,[]);Object(u.a)(k,"GestureManagerData",null,[]);e.Zig=2;e.$ig=4;e.ajg=8;e.bjg=8;Object(u.a)(e,"HammerConstants",null,[]);var M=b(93),T=b(212),F=b(30),K=b(77),J=B.a;Rk(d,J);d.prototype.iPh=function(){return this.vOc?0:this.Bhe?1:2};d.prototype.Ym=function(H){J.prototype.Ym.call(this,
H);this.Ld.$ja(this.DVa,H,0,this.dkb)};d.prototype.$l=function(H){J.prototype.$l.call(this,H);this.Ld.ZHa(H,this.DVa)};d.prototype.a8i=function(H,Q,ca){var X=this;ca=void 0===ca?null:ca;var Z=void 0===Z?null:Z;y.AFrameworkApplication.Mgc()?m.instance.Bsi().continueWith(function(ea){X.HEj();if(ea.Yf||ea.Ch)w.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",ea.status);else{w.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",ea.status);if(X.r2d){ea=window.Hammer;
if("undefined"===typeof ea){w.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");X.Byc();return}if("undefined"===typeof ea.inputHandler){w.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");X.Byc();return}}if(!H)throw X.Byc(),Error.argumentNull("source element can not be null");ea=T.a.dva(H,X.Zpa);if(void 0===ea||null===ea)ea=new A.a,T.a.xcb(H,X.Zpa,ea),X.b8i(H);var ka=null;if(!ea.kb(E[0])){ka=Object;var Y=ka.assign,qa=new f,fa=E[0],ha=Z;ha=void 0===ha?null:ha;if(void 0===
X||null===X)throw w.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");var ia=null;switch(fa){case G.a.pinch:ia=new Hammer.Pinch(ha);break;case G.a.pan:ia=new Hammer.Pan(ha)}ia&&(ia.manager=X);ka=Y.call(ka,qa,{Wca:ia,uVe:Q});ea.add(E[0],ka)}if(void 0!==ca&&null!==ca)for(Y=0;Y<ca.length;Y++)ea.kb(E[ca[Y]])&&(qa=ea.na(E[ca[Y]]),ka.Wca.recognizeWith(qa.Wca))}X.Byc()}):w.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")};
d.prototype.HEj=function(){this.QIc&&(this.qh?this.eRc=this.qh.sc("Task","RegisterGestureAdapterAfterLoad"):w.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))};d.prototype.Byc=function(){this.QIc&&(this.eRc?this.eRc.stop():w.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))};d.prototype.b8i=function(H){this.Log.add(H);this.Ld.$ja(this.DVa,H,0,this.dkb)};d.prototype.recognize=function(H){for(var Q=Array(H.pointers.length),ca=0;ca<H.pointers.length;ca++)Q[ca]=
H.pointers[ca].target;ca=null;for(this.upa=this.uRh(Q);void 0!==this.upa&&null!==this.upa&&(ca=T.a.dva(this.upa,this.Zpa),void 0===ca||null===ca);this.upa=this.upa.parentNode);if(void 0!==ca&&null!==ca){this.curRecognizer&&this.curRecognizer.state===e.bjg&&(this.curRecognizer=null);Q=ak(ca.keys);for(var X=Q.next();!X.done;X=Q.next()){X=ca.na(X.value);void 0!==X&&null!==X&&void 0!==X.Wca&&null!==X.Wca&&(void 0===this.curRecognizer||null===this.curRecognizer||X.Wca===this.curRecognizer||X.Wca.canRecognizeWith(this.curRecognizer))&&
X.Wca.recognize(H);var Z=X.Wca.state;this.curRecognizer||e.Zig!==Z&&e.$ig!==Z&&e.ajg!==Z||(this.curRecognizer=X.Wca)}}};d.prototype.emit=function(H,Q){if("hammer.input"!==H){this.I8=!1;Q=l.create(H,this.upa,Q.srcEvent,Q,3,this.vOc);var ca=T.a.dva(this.upa,this.Zpa);if(this.rki(H))var X=0;else if(this.iki(H))X=1;else if(this.fni(H))X=2;else{w.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}ca=ca.zc(E[X]).value;void 0!==ca&&null!==ca&&((ca=ca.uVe,ca.aii())?
H.endsWith("start")?this.I8=ca.JKi(Q):H.endsWith("end")?(ca.HKi(Q),this.I8=!0):H.endsWith("cancel")?(ca.GKi(Q),this.I8=!0):H.endsWith("move")&&(this.I8=ca.IKi(Q)):w.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",H))}};d.prototype.get=function(H){return Object(r.a)(Hammer.Recognizer,H)};d.prototype.uRh=function(H){if(1>H.length)return null;if(1===H.length)return H[0];for(var Q=H[0],ca=!0,X=1;X<H.length;X++){if(!H[X])return null;if(Q!==H[X]){ca=!1;break}}if(ca)return Q;
Q=this.OVe(H[0]);ca=0;H=ak(H);for(X=H.next();!X.done;X=H.next()){X=this.OVe(X.value);if(Q.na(Q.count-1)!==X.na(X.count-1))return null;for(var Z=Q.count-2,ea=X.count-2;Z>=ca&&0<=ea;Z--,ea--)if(Q.na(Z)!==X.na(ea)){ca=Z+1;break}}return Q.na(ca)};d.prototype.OVe=function(H){for(var Q=new n.a;void 0!==H&&null!==H;H=H.parentNode)Q.add(H);return Q};d.prototype.qZe=function(H){switch(H){case G.a.sf:case G.a.kha:return 1;case G.a.mg:case G.a.lha:return 2;case G.a.qe:case G.a.rGa:return 4;case G.a.iAc:case G.a.cYc:return 8}return 0};
d.prototype.Cya=function(H,Q,ca){H=this.qZe(H);Q=this.gQh(ca);Hammer.inputHandler(this,H,Q);this.I8&&ca.preventDefault();return this.I8};d.prototype.E5e=function(){return 1<this.bT.count};d.prototype.r1b=function(){w.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.Xlb)for(var H=ak(this.bT),Q=H.next();!Q.done;Q=H.next())this.HOf(Q.value.key);else this.bT=new A.a;this.session=null};d.prototype.KBg=function(H,Q,ca){w.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",
H);if(!this.xkb.kb(H)){try{Q.setPointerCapture(H)}catch(X){w.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",X)}this.xkb.add(H,Q)}this.bT.ia(H,ca);this.GUa&&1<this.bT.count&&this.cfa&&!this.cfa.rpb&&(this.cfa.rpb=!0)};d.prototype.HOf=function(H){w.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",H);if(this.xkb.kb(H)){try{this.xkb.na(H).releasePointerCapture(H)}catch(Q){w.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",Q)}this.xkb.remove(H)}else w.ULS.sendTraceTag(594055955,
310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",H);this.bT.remove(H);this.GUa&&1>=this.bT.count&&this.cfa&&this.cfa.rpb&&(this.cfa.rpb=!1)};d.prototype.Onc=function(H,Q,ca){var X=ca.rawEvent.pointerType.toString(),Z=ca.rawEvent.pointerId.toString();if("touch"!==X)return!1;H=this.qZe(H);if(1!==H&&!this.bT.kb(Z))return!1;this.x2d&&1===H&&ca.rawEvent.isPrimary&&this.bT.count&&(w.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.r1b());this.Xlb?this.KBg(Z,Q,ca):
this.bT.ia(Z,ca);this.rMc&&2===H&&(!this.MFc||this.MFc&&"function"===typeof ca.rawEvent.getCoalescedEvents)&&(Q=ca.rawEvent.getCoalescedEvents())&&this.E5e()&&(this.Fjb=Math.max(this.Fjb,Q.length));this.bee&&(this.I8=!1);X=this.fQh(this.bT,ca,X);Hammer.inputHandler(this,H,X);if(4===H||8===H)this.Xlb?this.HOf(Z):this.bT.remove(Z),this.bT.count||(this.session=null,this.rMc&&-1!==this.Fjb&&(w.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.Fjb),this.Fjb=-1));this.I8&&ca.preventDefault();
return this.I8};d.prototype.ync=function(){return!1};d.prototype.gQh=function(H){var Q=new k,ca=H.rawEvent,X=ca.touches;ca=ca.changedTouches;Q.pointers=Array.clone(X);Q.pointers=Array.clone(0<X.length?X:ca);Q.changedPointers=Array.clone(ca);Q.srcEvent=H;Q.pointerType="touch";return Q};d.prototype.fQh=function(H,Q,ca){var X=new k;X.pointers=K.toArray(H.values);X.changedPointers=[Q];X.pointerType=ca;X.srcEvent=Q;return X};d.prototype.rki=function(H){return F.a.startsWith(H,G.a.pinch)};d.prototype.iki=
function(H){return F.a.startsWith(H,G.a.pan)};d.prototype.fni=function(H){return F.a.startsWith(H,G.a.swipe)};Object(u.a)(d,"GestureInputManager",B.a,[601,602]);var O=b(292),N=b(257);c.prototype.Sh=function(H){H.register(d,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").tc().Cc(function(){return new d(O.a.instance,y.AFrameworkApplication.ta.tD)});this.fb=H};c.prototype.init=function(){this.Xw||(this.fb.resolve("Common.App.GestureManager.GestureInputManager"),this.Xw=
!0)};c.prototype.dispose=function(){};c.main=function(){N.a.instance.Ui(new c)};Af.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.GestureInputManager"}}});Object(u.a)(c,"GestureInputManagerPackage",null,[3,4]);b.d(D,"a",function(){return a})},1394:function(u,D,b){function a(){w.a.Fa(function(fb){fb.da.Ga(150,new c(fb))})}function c(fb){var Ma=mb.call(this)||this;Ma.$=fb;Ma.Eb();return Ma}function d(fb){var Ma=Ia.call(this,document.createElement("div"))||
this;Ma.dR=!1;Ma.GQ=!1;Ma.Q0b=!1;Ma.Dh=null;Ma.Nh=null;Ma.qgi=Ka.EwaSettings.isChangeGateEnabled("OfficeVSO:6172290_DataValidationConditionalHideAll");Ma.rgi=Ka.EwaSettings.isChangeGateEnabled("OfficeVSO:6172279_DataValidationConstButtonWidth");Ma.lod=!1;Ma.epd=!1;Ma.gmd=!1;Ma.z5b=[];Ma.Fh=function(){Ma.B2f(!1)};Ma.tOa=function(Kb,Ub){Ma.show(Ma.XQ,!Ma.isListVisible,!0,z.a.Zo||3===Ub.mb||3===I.a.Cb);Ma.azd(null,null)};Ma.azd=function(){Ma.gridView.setFocus()};Ma.gLa=function(){Ma.Ya.textBox.WJ=!0};
Ma.$s=function(){Ma.Pcg()};Ma.onContentReady=function(){Ma.B2f(Ma.isListVisible)};Ma.Fc=function(){Ma.Px()};Ma.yya=function(){Ma.dRa()};Ma.Qvf=function(){Ma.Pcg()};Ma.$=fb;Ma.gridView=O.g(Ma.$);Ma.GI=Ma.gridView.Wb;var Hb="<div id='dv_reader_description' class='"+y.a.RMe+"' role='alert' aria-live='polite'></div>\r\n<div id='dv_list_button' class='"+f.doh+" "+C.a.Lp+"'></div>\r\n<div id='dv_list_box' class='"+f.knh+" "+C.a.No+" "+C.a.Lp+"'></div>\r\n<div id='dv_prompt_box' class='"+f.boh+" "+C.a.Lp+
"'></div>";Ma.domElement.className=f.coh;Ma.domElement.innerHTML=Hb;ra.d(Ma.style,Ma.isGridRtl);Ma.Qf=$get("dv_list_box",Ma.domElement);Ma.R_=$get("dv_prompt_box",Ma.domElement);Ma.jsa=$get("dv_list_button",Ma.domElement);Ma.tBb=$get("dv_reader_description",Ma.domElement);(Hb=Ea.a(fb))&&Ma.z5b.push(new k(fb,Hb,Ma));Ma.z5b.push(new k(fb,Ma.gridView.Wb,Ma));Ma.gridView.ha.kJ(Ma.Fh);Ma.gridView.Ft(Ma.onContentReady);Ma.gridView.$b.uEg(Ma.Qvf);Ma.$.Ck(Ma.Fc);Hb=Ma.gridView.Bj;Hb.insertBefore(Ma.domElement,
Hb.firstChild);Ma.onContentReady(null,null);fb.da.Ga(14,Ma);return Ma}function e(fb,Ma,Hb){fb=la.call(this,fb,Ma,new Na.a(f.listItem,f.rBb,f.uBb,f.vBb))||this;fb.klb=null;fb.he=null;fb.xda=null;fb.JV=null;fb.THa=null;fb.mNa=0;fb.iFb=[];fb.bRj=Ka.EwaSettings.isChangeGateEnabled("OfficeVSO:6172276_UpdateDvListHeightUsingItemHeight");fb.tBb=Hb;return fb}function k(fb,Ma,Hb){fb=S.call(this,fb,Ma)||this;fb.dataValidationControl=Hb;return fb}function l(fb,Ma,Hb){var Kb=wa.call(this,fb)||this;Kb.Dx=null;
Kb.MU=null;Kb.Cff=!1;Kb.errorMessage=null;Kb.R6e=null;Kb.wm=null;Kb.Uda=null;Kb.rFe=function(Ub){var gb=Kb.$,Db=Kb.Cff;Kb.hide();var Va=O.g(gb);Va.isEditing&&Va.Wb.endEdit(!1,"DataValidationErrorDialog.DataValidationErrorDialogHandler",0);1===Ub&&Db&&K.TaskExtensions.Ba(Va.startEdit(!1,1),function(){var qb=Va.Wb.textBox;qb.text&&qb.selectRange(0,qb.text.length)},Kb.la,11,H.a.current);if(1===Ub&&!Db){if(Db=Va.Ub(null)){Va.Ea.qV();var yb=Object(U.a)(new N.a,{Text:Db.cell.userInput});Va.setCell(yb,Db.range,
0,63,null)}gb.Fd(-798660877,I.a.Cb,8,null)}2===Ub&&K.TaskExtensions.Ba(Va.startEdit(!1,0),function(){var qb=Va.Wb.textBox;qb.text&&qb.selectRange(0,qb.text.length)},Kb.la,11,H.a.current)};Kb.p9a=function(){fa.HelperMethods.YV(Kb.$.eG,Kb.error.HelpTopicId,Kb.$.sS)};Kb.zMi=function(){Kb.axb();Kb.$.Fd(802602464,2,8,Kb.MU)};Kb.VKi=function(){M.ULS.sendTraceTag(537163288,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationFailureCallback, failed to get expected results.")};Kb.WKi=function(Ub){!Ub||
qa.a(Ub)?M.ULS.sendTraceTag(537163287,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationSuccessCallback, failed to get expected results."):(Ub=Kb.fWh(Ub.Result),Kb.Dx.errorInformation=Ub,Kb.nTa(Kb.EIa,Kb.$3a(Kb.rFe),Kb.Dx))};Kb.pzd=function(){Kb.show(Kb.IRb)};Kb.yLe=Hb;Kb.sqmManager=ia.a(Kb.$);Kb.error=l.zQ(Ma,fb,Hb);Kb.ob.Hp=Kb;fb=fb.da.za(14);Kb.Fu=fb.q3a(Kb.yLe);Kb.EIa=Kb.Fu&&Kb.Fu.EIa?Kb.Fu.EIa:J.a.instance.ga(1712);Kb.rpj();Kb.initializeAndShow(Kb.EIa,Kb.rFe,Kb.Dx);return Kb}
function m(fb,Ma,Hb){var Kb=Q.call(this,fb,m.zQ(Ma,fb,Hb))||this;Kb.Rc=function(){Kb.setFocus()};O.g(Kb.$).ha.yG(Kb.Rc);(fb=fb.da.za(14).q3a(Hb))&&fb.options&1&&M.ULS.sendTraceTag(537163291,0,50,"DataValidationErrorDeprecatedDialog.DataValidationErrorDeprecatedDialogs, Data validation Error opened on a list rule.");return Kb}function f(){}var w=b(11);u=b(0);var n=b(232),z=b(25),r=b(90),v=b(30),A=b(440),B=b(244);f.coh="ewa-dv";f.doh="ewa-dv-buttonarea";f.knh="ewa-dlb";f.uBb="list-table";f.listItem=
"list-item";f.rBb="list-item-selected";f.vBb="list-table-touch";f.boh="ewa-dpb";f.lih="dv-prompt-title";f.kih="dv-prompt-message";Object(u.a)(f,"CssClassNames",null,[]);var y=b(31),x=b(618),C=b(18),G=b(48),E=b(461),I=b(76),U=b(7),M=b(15),T=b(160),F=b(1029),K=b(37),J=b(14),O=b(21),N=b(275),H=b(63),Q=T.ErrorDialog;Rk(m,Q);m.prototype.dispose=function(){O.g(this.$).ha.EF(this.Rc);Q.prototype.dispose.call(this)};m.prototype.setFocus=function(){switch(this.error.Severity){case 0:var fb=4;break;case 1:fb=
3;break;case 2:fb=0;break;default:fb=this.closeAction}(fb=this.getButton(fb))?fb.get_element().focus():Q.prototype.setFocus.call(this)};m.prototype.kqb=function(){var fb=O.g(this.$);fb.isEditing&&fb.Wb.endEdit(!1,"DataValidationErrorDeprecatedDialog.CommitAfterClosing",0);4===this.returnValue&&this.USd(1);if(2===this.returnValue||0===this.returnValue){var Ma=fb.Ub(null);if(Ma){fb.Ea.qV();var Hb=Object(U.a)(new N.a,{Text:Ma.originalText});fb.setCell(Hb,Ma.range,0,63,null)}this.$.Fd(-798660877,I.a.Cb,
8,null)}Q.prototype.kqb.call(this)};m.prototype.psa=function(){var fb=O.g(this.$);fb.isEditing&&fb.Wb.endEdit(!1,"DataValidationErrorDeprecatedDialog.CancelAfterClosing",0);3===this.returnValue&&this.USd(0);Q.prototype.psa.call(this)};m.prototype.USd=function(fb){var Ma=O.g(this.$);K.TaskExtensions.Ba(Ma.startEdit(!1,fb),function(){var Hb=Ma.Wb.textBox;Hb.text&&Hb.selectRange(0,Hb.text.length)},this.la,11,H.a.current)};m.zQ=function(fb,Ma,Hb){Hb=Ma.da.za(14).q3a(Hb);fb.MessageId=-1083021405;fb.MessageIdName=
"DataValidationError";fb.MessageIdHash=v.a.Nv(fb.MessageIdName);fb.Severity=Hb?Hb.c8c:1;Ma=(null===Hb||void 0===Hb?0:Hb.EIa)?v.a.Ag(Hb.EIa):null;Hb=(null===Hb||void 0===Hb?0:Hb.error)?v.a.Ag(Hb.error):String.format("<p>{0}</p><p>{1}</p>",J.a.instance.ga(893),J.a.instance.ga(894));switch(fb.Severity){case 0:fb.Appearance=18;break;case 1:fb.Appearance=12;Hb+=String.format("<p>{0}</p>",J.a.instance.ga(895));break;default:fb.Appearance=3}fb.Caption=Ma;fb.Description=Hb;fb.HelpDescription=J.a.instance.ga(1300);
fb.HelpTopicId=F.a.qFe;return fb};Object(u.a)(m,"DataValidationErrorDeprecatedDialog",T.ErrorDialog,[]);T=b(390);var ca=b(5),X=b(45),Z=b(258),ea=b(197),ka=b(53),Y=b(29),qa=b(296),fa=b(10),ha=b(295),ia=b(165),wa=T.a;Rk(l,wa);l.prototype.dispose=function(){this===this.ob.Hp&&(this.ob.Hp=null);r.a.Ia(this.wm);this.wm=null;wa.prototype.dispose.call(this)};l.prototype.rpj=function(){this.Fu&&this.Fu.error?this.errorMessage=this.Fu.error:this.Fu&&this.Fu.options&1?(M.ULS.sendTraceTag(537163289,0,50,"DataValidationErrorDialog.SetDialogProps, Data validation Error opened on a list rule."),
this.errorMessage=J.a.instance.ga(1714),this.R6e=ka.a.current.Uo(118)):(this.errorMessage=J.a.instance.ga(1713),this.cMh(this.yLe));var fb=this.Fu?this.Fu.c8c:1,Ma={};this.Dx=(Ma[l.Yv]=this.nc,Ma.errorDescription=this.errorMessage,Ma.helpImageUri=this.R6e,Ma);switch(fb){case 0:this.Rb=1;this.mc(1,"Retry");this.Dx.dialogIcon=2;this.Cff=!0;break;case 1:this.Rb=4;this.Dx.dialogIcon=1;this.Dx.additionalInformation=J.a.instance.ga(895);break;default:this.Rb=1,this.Dx.dialogIcon=3}fb={};this.Dx.helpLink=
(fb.type="AppLinkProps",fb[l.Yv]=this.error.HelpTopicId,fb.text=J.a.instance.ga(1300),fb.handler=this.p9a,fb);fb=Y.a.mWc([this.error]);Ma={};this.MU=(Ma[ca.a.b9b]=!0,Ma[ca.a.j$c]=fb,Ma[ca.a.k$c]=ia.a(this.$).Rsb(this.error.MessageIdHash),Ma[ca.a.SU]=this.nc,Ma.DismissHandler=this.pzd,Ma);fb={};this.Dx.giveFeedbackLink=(fb.type="AppLinkProps",fb[l.Yv]=ca.a.Pgd,fb.text=J.a.instance.ga(1750),fb.handler=this.zMi,fb)};l.prototype.cMh=function(fb){var Ma=this.$.oa.xa.Pb();Z.f(this.$.oa.xa,X.q(fb,this.$),
ha.b(this.WKi),ha.a(this.VKi),null,Ma)};l.prototype.fWh=function(fb){switch(fb.RuleType){case 1:switch(fb.ConditionType){case 0:var Ma=J.a.instance.lb(108);return String.format(Ma,fb.LowerBoundary,fb.UpperBoundary);case 1:return Ma=J.a.instance.lb(109),String.format(Ma,fb.LowerBoundary,fb.UpperBoundary);case 2:return Ma=J.a.instance.lb(110),String.format(Ma,fb.LowerBoundary);case 3:return Ma=J.a.instance.lb(111),String.format(Ma,fb.LowerBoundary);case 4:return Ma=J.a.instance.lb(112),String.format(Ma,
fb.LowerBoundary);case 5:return Ma=J.a.instance.lb(113),String.format(Ma,fb.UpperBoundary);case 6:return Ma=J.a.instance.lb(114),String.format(Ma,fb.LowerBoundary);case 7:return Ma=J.a.instance.lb(115),String.format(Ma,fb.UpperBoundary);default:return"we couldn't get the details"}case 2:switch(fb.ConditionType){case 0:return Ma=J.a.instance.lb(116),String.format(Ma,fb.LowerBoundary,fb.UpperBoundary);case 1:return Ma=J.a.instance.lb(117),String.format(Ma,fb.LowerBoundary,fb.UpperBoundary);case 2:return Ma=
J.a.instance.lb(118),String.format(Ma,fb.LowerBoundary);case 3:return Ma=J.a.instance.lb(119),String.format(Ma,fb.LowerBoundary);case 4:return Ma=J.a.instance.lb(120),String.format(Ma,fb.LowerBoundary);case 5:return Ma=J.a.instance.lb(121),String.format(Ma,fb.UpperBoundary);case 6:return Ma=J.a.instance.lb(122),String.format(Ma,fb.LowerBoundary);case 7:return Ma=J.a.instance.lb(123),String.format(Ma,fb.UpperBoundary);default:return"we couldn't get the details"}case 4:switch(fb.ConditionType){case 0:return Ma=
J.a.instance.lb(124),String.format(Ma,fb.LowerBoundary,fb.UpperBoundary);case 1:return Ma=J.a.instance.lb(125),String.format(Ma,fb.LowerBoundary,fb.UpperBoundary);case 2:return Ma=J.a.instance.lb(126),String.format(Ma,fb.LowerBoundary);case 3:return Ma=J.a.instance.lb(127),String.format(Ma,fb.LowerBoundary);case 4:return Ma=J.a.instance.lb(128),String.format(Ma,fb.LowerBoundary);case 5:return Ma=J.a.instance.lb(129),String.format(Ma,fb.UpperBoundary);case 6:return Ma=J.a.instance.lb(130),String.format(Ma,
fb.LowerBoundary);case 7:return Ma=J.a.instance.lb(131),String.format(Ma,fb.UpperBoundary);default:return"we couldn't get the details"}case 5:switch(fb.ConditionType){case 0:return Ma=J.a.instance.lb(132),String.format(Ma,fb.LowerBoundary,fb.UpperBoundary);case 1:return Ma=J.a.instance.lb(133),String.format(Ma,fb.LowerBoundary,fb.UpperBoundary);case 2:return Ma=J.a.instance.lb(134),String.format(Ma,fb.LowerBoundary);case 3:return Ma=J.a.instance.lb(135),String.format(Ma,fb.LowerBoundary);case 4:return Ma=
J.a.instance.lb(136),String.format(Ma,fb.LowerBoundary);case 5:return Ma=J.a.instance.lb(137),String.format(Ma,fb.UpperBoundary);case 6:return Ma=J.a.instance.lb(138),String.format(Ma,fb.LowerBoundary);case 7:return Ma=J.a.instance.lb(139),String.format(Ma,fb.UpperBoundary);default:return"we couldn't get the details"}case 6:switch(fb.ConditionType){case 0:return Ma=J.a.instance.lb(140),String.format(Ma,fb.LowerBoundary,fb.UpperBoundary);case 1:return Ma=J.a.instance.lb(141),String.format(Ma,fb.LowerBoundary,
fb.UpperBoundary);case 2:return Ma=J.a.instance.lb(142),String.format(Ma,fb.LowerBoundary);case 3:return Ma=J.a.instance.lb(143),String.format(Ma,fb.LowerBoundary);case 4:return Ma=J.a.instance.lb(144),String.format(Ma,fb.LowerBoundary);case 5:return Ma=J.a.instance.lb(145),String.format(Ma,fb.UpperBoundary);case 6:return Ma=J.a.instance.lb(146),String.format(Ma,fb.LowerBoundary);case 7:return Ma=J.a.instance.lb(147),String.format(Ma,fb.UpperBoundary);default:return"we couldn't get the details"}case 3:return Ma=
J.a.instance.lb(106),String.format(Ma,fb.LowerBoundary);case 7:return Ma=J.a.instance.lb(107),String.format(Ma,fb.LowerBoundary);default:return"we couldn't get the details"}};l.prototype.USd=function(fb){var Ma=O.g(this.$);K.TaskExtensions.Ba(Ma.startEdit(!1,fb),function(){var Hb=Ma.Wb.textBox;Hb.text&&Hb.selectRange(0,Hb.text.length)},this.la,11,H.a.current)};l.zQ=function(fb,Ma,Hb){Ma=Ma.da.za(14).q3a(Hb);fb.MessageId=-1083021405;fb.MessageIdName="DataValidationError";fb.MessageIdHash=v.a.Nv(fb.MessageIdName);
fb.Severity=Ma?Ma.c8c:1;fb.HelpDescription=J.a.instance.ga(1300);fb.HelpTopicId=F.a.qFe;return fb};Af.Object.defineProperties(l.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationErrorDialog"}},la:{configurable:!0,enumerable:!0,get:function(){this.wm=this.wm||new ea.a;return this.wm.token}}});Object(u.a)(l,"DataValidationErrorDialog",T.a,[452,453,10,398]);T=b(1119);var Qa=b(408),S=T.a;Rk(k,S);k.prototype.dispose=function(){this.dataValidationControl=null;S.prototype.dispose.call(this)};
k.prototype.Kh=function(fb,Ma){this.dataValidationControl.Ya=this.Ya;var Hb=fb.keyCode;return 1461300262!==Ma||16!==Hb&&17!==Hb&&18!==Hb?S.prototype.Kh.call(this,fb,Ma):!1};k.prototype.wyd=function(){this.vV&&(this.dataValidationControl.Ya=this.Ya,this.dataValidationControl.show(this.dataValidationControl.XQ,!0,!0,z.a.Zo||3===I.a.Cb))};k.prototype.Df=function(){};k.prototype.Gh=function(){this.dataValidationControl.show(this.dataValidationControl.XQ,!0,!0,z.a.Zo||3===I.a.Cb)};k.prototype.aFd=function(fb,
Ma){return this.dataValidationControl.Kh(Ma)};Af.Object.defineProperties(k.prototype,{vyb:{configurable:!0,enumerable:!0,get:function(){return Object(A.a)(l,this.$.ob.Xg)}},vV:{configurable:!0,enumerable:!0,get:function(){return this.dataValidationControl.isListVisible},set:function(fb){this.dataValidationControl.isListVisible=fb}},j5a:{configurable:!0,enumerable:!0,get:function(){return!1}},key:{configurable:!0,enumerable:!0,get:function(){return Qa.a.H4c}}});Object(u.a)(k,"DataValidationListAutoCompleteBehavior",
T.a,[]);var da=b(279);T=b(1050);var xa=b(12),ta=b(117),ab=b(22),Na=b(1118),Ka=b(1),la=T.a;Rk(e,la);e.prototype.dispose=function(){la.prototype.dispose.call(this);this.tBb=this.klb=null};e.prototype.lea=function(fb,Ma,Hb,Kb){if(fb&&(!fb||fb.length)){this.B7(!1);this.THa=fb;this.JV=[];for(var Ub=0;Ub<fb.length;Ub++)this.JV[Ub]=fb[Ub]?fb[Ub].Name:null;Ub=String.format("<table class='{0}' aria-live='polite'><tbody>",this.Uba);var gb="",Db="";fb=0;var Va=O.g(this.$).Ub(null);Kb=this.isEditing?Kb?Kb.text:
this.editText:Va?Va.originalText:null;Va=!Kb;var yb=0;Array.clear(this.iFb);var qb=[],dc=[],bb=[],db=Kb?Kb.split(" "):[""];Kb=Kb.trim();for(var wc={},nb=0;nb<this.JV.length;wc={uDc:wc.uDc},nb++){var zb=this.JV[nb],ma=void 0;wc.uDc=zb.split(" ");ma=da.a.all(db,function(Ja){return function($a){return da.a.any(Ja.uDc,function(Ta){return ab.a.cL(Ta,$a)})}}(wc));var P=!zb,oa=Array.contains(bb,zb);P||oa||this.isEditing&&!ma||(ma=zb?v.a.Ag(v.a.z7b(zb)):"",ma=String.format("<tr>\r\n\t<td class='{0}'>{1}</td>\r\n</tr>",
this.m_,ma),bb.push(zb),this.isEditing&&ab.a.cL(zb,Kb)?(gb+=ma,qb.push(nb)):(Db+=ma,dc.push(nb)),!Va&&ab.a.equals(Kb,zb,!0)&&(fb=this.isEditing?qb.length-1:yb,Va=!0),yb++)}this.mNa=yb;Array.addRange(this.iFb,qb);Array.addRange(this.iFb,dc);this.Qf.innerHTML=Ub+(gb+Db+"</tbody></table>");Ub=this.Gn=xa.DOMElementExtensions.Cj(this.domElement,this.Uba);this.Omb(Ub,Ma);this.B7(!0);this.Ira(Ma,Hb);this.Pk=0<this.mNa?Ub.rows[fb]:null}};e.prototype.dRa=function(fb){var Ma=!1;this.isEditing&&fb&&(Ma=!this.mNa,
fb.endEdit(Ma,"DataValidationListBox.SetCellContent",0));if(!Ma&&(fb=O.g(this.$),Ma=fb.Ub(null))){var Hb=null;this.xda&&-1!==this.xda.SheetId&&-1!==this.xda.Row&&-1!==this.xda.Column&&(Hb={},Hb.SheetName=this.xda.SheetId.toString(),Hb.FirstRow=this.xda.Row,Hb.FirstColumn=this.xda.Column,Hb={ParameterType:6,SourceRange:Hb});var Kb=Object(U.a)(new N.a,{Text:this.he});fb.setCell(Kb,Ma.range,0,63,Hb)}return!0};e.prototype.Ira=function(fb,Ma){var Hb=fb?this.kCb:this.MH;fb=fb?this.Ajc:this.Bjc;0>=this.mNa?
this.Qf.style.height=fa.HelperMethods.hc(fb):(this.Qf.style.height="auto",this.mNa>Hb?(xa.DOMElementExtensions.xI(this.Qf,this.bRj?Math.floor(fb*Hb):Math.floor(this.Qf.offsetHeight*Hb/this.mNa)),this.Qf.style.overflowY="auto"):(this.Qf.style.height="auto",this.Qf.style.overflowY="hidden"));xa.DOMElementExtensions.vr(this.Qf,Ma);xa.DOMElementExtensions.vr(this.Gn,Ma-(this.mNa>Hb?ta.a.gv:0))};Af.Object.defineProperties(e.prototype,{Pk:{configurable:!0,enumerable:!0,get:function(){return this.klb},set:function(fb){this.iBa(this.klb);
if(fb){this.klb=fb;this.tBb.innerText="";this.iBa(this.klb);var Ma=this.iFb[fb.rowIndex];this.he=this.JV[Ma];this.THa&&(this.xda=this.THa[Ma],M.ULS.shipAssertTag(537163286,0,!this.iFb.length||!!this.xda,"DataValidationListBox.SelectedRow: Did not find corresponding DataValidationListItem"));this.tBb.innerText=this.he;this.Duc(fb)}else this.xda=this.he=null}},isEditing:{configurable:!0,enumerable:!0,get:function(){return O.g(this.$).isEditing}},editText:{configurable:!0,enumerable:!0,get:function(){return O.g(this.$).Wb.text}}});
Object(u.a)(e,"DataValidationListBox",T.a,[]);var Ea=b(114),ra=b(261),na=b(250),ba=b(1300),sa="<p class='"+f.lih+"'>\r\n\t<span class='dv-prompt-titletext'>{0}</span>\r\n</p>",ya="<p class='"+f.kih+"'>\r\n\t<span class='dv-prompt-messagetext'>{0}</span>\r\n</p>",va=C.a.zMe,W=C.a.zMe,La=C.a.MYg,Ia=B.a;Rk(d,Ia);d.prototype.dispose=function(){this.$&&(this.kMb(!1),this.gridView.ha.UN(this.Fh),this.gridView.Fw(this.onContentReady),this.gridView.$b.Oaj(this.Qvf),this.$.Ol(this.Fc));this.CDe(!1);this.DDe(!1);
r.a.oc(this.z5b);this.z5b=this.jsa=this.Qf=this.R_=this.GI=this.gridView=this.$=null;Ia.prototype.dispose.call(this)};d.prototype.n6c=function(fb){return!!this.q3a(fb)};d.prototype.Tqb=function(fb,Ma){return Ka.EwaSettings.isChangeGateEnabled("OfficeVSO:5879568_ReactDataValidationErrorDialog")?new l(this.$,fb,Ma):new m(this.$,fb,Ma)};d.prototype.q3a=function(fb){fb=this.gridView.getRangeInformation(fb);for(var Ma=0;Ma<fb.length;Ma++){var Hb=fb[Ma];if(Object(A.a)(E.DataValidationRange,Hb))return Hb}return null};
d.prototype.fIh=function(){if(!this.C4a)return"";var fb=this.l6e?String.format("{0} {1}",this.Fu.bJf,this.Fu.prompt):"",Ma=this.Awb?J.a.instance.ga(841):"";return String.format(J.a.instance.lb(17),fb,Ma)};d.prototype.Kh=function(fb){var Ma=!1;if(this.isListVisible||(-569786022===fb||541421805===fb)&&this.Awb||1872288872===fb&&this.XQ)switch(fb){case -569786022:case 541421805:this.show(this.XQ,!this.isListVisible,!0,z.a.Zo||3===I.a.Cb);Ma=!0;break;case 1872288872:this.isListVisible?(this.show(this.XQ,
!1,!0,!1),Ma=!0):this.XQ?(this.show(!1,!1,!0,!1),Ma=!0):this.Ya&&(this.Ya.endEdit(!1,"DataValidationControl.HandleKeyDown",0),Ma=!0);break;case -798660877:this.Nh.pB(1);Ma=!0;break;case 137938150:this.Nh.pB(-1);Ma=!0;break;case 2091832999:this.Nh.pB(this.Nh.MH-1);Ma=!0;break;case 742457698:this.Nh.pB(-(this.Nh.MH-1));Ma=!0;break;case 125627505:case 267796030:Ma=this.dRa()}return Ma};d.prototype.show=function(fb,Ma,Hb,Kb){this.Px();if(this.$zb&&this.C4a){var Ub=this.cOa;if(Ub){if(fb||Ma||Hb)this.isVisible=
!0;ra.d(this.style,this.isGridRtl);Hb&&this.Awb&&(this.DDe(!0),this.Gcg(Ub,!1));Ma&&this.Awb&&this.PRa(Kb,Ub);fb&&this.l6e&&this.RAj(Ub);this.Lni||(this.isVisible=!1)}}};d.prototype.eva=function(fb,Ma){if(!Ma||!Ma.cell.tk)return null;var Hb=this.gridView.$b.textBox.domElement;var Kb=0<xa.DOMElementExtensions.getHeight(Hb)&&0<xa.DOMElementExtensions.getWidth(Hb)&&0<=Hb.offsetTop&&0<=Hb.offsetLeft;if(Kb)Hb=xa.DOMElementExtensions.eva(Hb,fb.Bj);else{Hb=fb.getCellBounds(Ma.cell);var Ub=xa.DOMElementExtensions.getBoundingClientRect(fb.Bj);
Hb=new Sys.UI.Bounds(Hb.x-Ub.x,Hb.y-Ub.y,Hb.width,Hb.height)}if(Hb)if(Kb)2<Hb.height&&2<Hb.height&&(Hb.x+=1,Hb.y+=1,Hb.height-=2,Hb.width-=2);else if(Kb=O.g(this.$).OJ(Ma.cell))Kb=Kb.width+1,Ub=ab.a.equals(na.a.p3a(Ma.cell,fb.rtl),"right",!0),fb.rtl&&Ub&&(Hb.x=Hb.x+Hb.width-Kb),Ma.Fka&&fb.rtl===Ub&&(Hb.width=Kb);else return null;return Hb};d.prototype.B2f=function(fb){var Ma=this.C4a;this.kMb(Ma);Ma?this.show(!0,fb,!0,!1):this.Px()};d.prototype.dRa=function(){var fb=!1;this.isListVisible&&(fb=this.Nh.dRa(this.Ya),
this.show(this.XQ,!1,!0,!1));return fb};d.prototype.Px=function(){this.qgi?(this.isListVisible&&(this.isListVisible=!1),this.FLa&&(this.FLa=!1),this.XQ&&(this.XQ=!1),this.isVisible&&(this.isVisible=!1)):this.isListVisible=this.FLa=this.XQ=this.isVisible=!1;this.lod=this.gmd=this.epd=!1};d.prototype.PRa=function(fb,Ma){this.Awb&&!this.Fu.THa?this.FLa&&this.Dh.disable():(this.CDe(!0),this.Nh.lea(this.Fu.THa,fb,this.fRh(Ma),this.Ya),this.xBa(Ma,!1))};d.prototype.RAj=function(fb){this.Fu.prompt&&(this.XQ=
!0,this.QSj(this.Fu.bJf,this.Fu.prompt),this.Zcg(fb,!1))};d.prototype.Gcg=function(fb,Ma){var Hb=fb.y;this.jsa.style.top=fa.HelperMethods.hc(Hb);fb=this.isGridRtl?fb.x-this.jsa.offsetWidth+1:fb.x+fb.width+1;this.jsa.style.left=fa.HelperMethods.hc(fb);Ma?this.FLa=this.gridView.qic(new G.a(fb,Hb))&&this.gmd:this.gmd=!0};d.prototype.xBa=function(fb,Ma){var Hb=fb.y+fb.height;fb=this.isGridRtl?fb.x+fb.width-this.Qf.offsetWidth:fb.x;this.Qf.style.top=fa.HelperMethods.hc(Hb);this.Qf.style.left=fa.HelperMethods.hc(fb);
Ma?this.isListVisible=this.gridView.qic(new G.a(fb,Hb))&&this.lod:this.lod=!0};d.prototype.Zcg=function(fb,Ma){var Hb=fb.y+fb.height+5,Kb=this.activeCell;Kb=Kb?Kb.width/2:32;fb=this.isGridRtl?fb.x-this.R_.offsetWidth+Kb:fb.x+fb.width-Kb;this.R_.style.top=fa.HelperMethods.hc(Hb);this.R_.style.left=fa.HelperMethods.hc(fb);Ma?this.XQ=this.gridView.qic(new G.a(fb,Hb))&&this.epd:this.epd=!0};d.prototype.QSj=function(fb,Ma){if(Ma){var Hb="";fb&&(Hb+=String.format(sa,v.a.Ag(fb)));Hb+=String.format(ya,v.a.Ag(Ma));
this.R_.innerHTML=Hb;fb=xa.DOMElementExtensions.Cj(this.R_,"dv-prompt-titletext");if(Ma=xa.DOMElementExtensions.Cj(this.R_,"dv-prompt-messagetext"))for(fb=fb?parseInt(String(Math.max(fb.offsetWidth,Ma.offsetWidth)),10):Ma.offsetWidth,fb+=6,xa.DOMElementExtensions.vr(this.R_,fb),Ma=0,Hb=this.R_.children.length;Ma<Hb;Ma++)xa.DOMElementExtensions.vr(this.R_.children[Ma],fb)}};d.prototype.fRh=function(fb){return this.rgi?fb.width+17-2+1:fb.width+this.jsa.clientWidth-2+1};d.prototype.DDe=function(fb){this.$&&
!this.$zb||!fb?(this.K6f(!1),r.a.Ia(this.Dh),this.Dh=null):(this.Dh||(this.Dh=new ba.a(this.jsa,va,x.a.$ha,1,W,J.a.instance.ga(892),La,J.a.instance.ga(891),"",-1),this.K6f(!0)),this.FLa=!0,this.Fu.THa?this.Dh.isEnabled||this.Dh.enable():this.Dh.disable())};d.prototype.CDe=function(fb){this.$&&!this.$zb||!fb?(this.tSa(!1),r.a.Ia(this.Nh),this.Nh=null):(this.Nh||(this.Nh=new e(this.$,this.Qf,this.tBb),this.tSa(!0)),this.isListVisible=!0)};d.prototype.tSa=function(fb){this.Nh&&(fb&&!this.dR?(this.Nh.C9(this.azd),
this.Nh.eZb(this.gLa),this.Nh.hnb(this.yya),this.dR=!0):!fb&&this.dR&&(this.Nh.gda(this.azd),this.Nh.wsc(this.gLa),this.Nh.$Hb(this.yya),this.dR=!1))};d.prototype.kMb=function(fb){fb&&!this.GQ?(this.gridView.view.Gs(this.$s),this.GQ=!0):!fb&&this.GQ&&(this.gridView.view.Iq(this.$s),this.GQ=!1)};d.prototype.K6f=function(fb){this.Dh&&(fb&&!this.Q0b?(this.Dh.xUc(this.tOa),this.Dh.JUc(this.tOa),this.Dh.Umb(this.gLa),this.Q0b=!0):!fb&&this.Q0b&&(this.Dh.oId(this.tOa),this.Dh.CId(this.tOa),this.Dh.KHb(this.gLa),
this.Q0b=!1))};d.prototype.Pcg=function(){if(this.C4a){var fb=this.cOa;fb&&(this.Gcg(fb,!0),this.xBa(fb,!0),this.Zcg(fb,!0))}};Af.Object.defineProperties(d.prototype,{$zb:{configurable:!0,enumerable:!0,get:function(){return!!(this.$.Bd&16)}},Lni:{configurable:!0,enumerable:!0,get:function(){return this.isListVisible||this.XQ||this.FLa}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return xa.DOMElementExtensions.isVisible(this.Qf)},set:function(fb){xa.DOMElementExtensions.setVisible(this.Qf,
fb)}},XQ:{configurable:!0,enumerable:!0,get:function(){return xa.DOMElementExtensions.isVisible(this.R_)},set:function(fb){xa.DOMElementExtensions.setVisible(this.R_,fb)}},FLa:{configurable:!0,enumerable:!0,get:function(){return xa.DOMElementExtensions.isVisible(this.jsa)&&!!this.Dh&&xa.DOMElementExtensions.isVisible(this.Dh.domElement)},set:function(fb){xa.DOMElementExtensions.setVisible(this.jsa,fb);this.Dh&&xa.DOMElementExtensions.setVisible(this.Dh.domElement,fb)}},Ya:{configurable:!0,enumerable:!0,
get:function(){return this.GI},set:function(fb){this.GI=fb}},C4a:{configurable:!0,enumerable:!0,get:function(){return!!this.activeCell&&this.n6c(this.activeCell.range)}},activeCell:{configurable:!0,enumerable:!0,get:function(){return this.gridView.Ub(null)}},l6e:{configurable:!0,enumerable:!0,get:function(){return this.C4a&&!!this.Fu&&!!(this.Fu.options&2)&&!!this.Fu.prompt}},Awb:{configurable:!0,enumerable:!0,get:function(){return this.C4a&&!!this.Fu&&!!(this.Fu.options&1)}},isGridRtl:{configurable:!0,
enumerable:!0,get:function(){return this.gridView.rtl}},Fu:{configurable:!0,enumerable:!0,get:function(){return this.q3a(this.activeCell.range)}},cOa:{configurable:!0,enumerable:!0,get:function(){var fb=this.activeCell;return fb?this.eva(this.gridView,fb):null}}});Object(u.a)(d,"DataValidationControl",B.a,[755,10]);var mb=n.a;Rk(c,mb);c.prototype.create=function(){this.pb(this.$.da.za(14)||new d(this.$))};Object(u.a)(c,"DataValidationControlFactory",n.a,[]);b.d(D,"a",function(){return a})},1395:function(u,
D,b){function a(){w.a.Fa(function(M){c.ka(M)})}function c(M){var T=U.call(this)||this;T.$=M;T.Eb();return T}function d(M,T,F){var K=this;this.$=M;this.RAd=function(J,O){return Object(z.a)(K,void 0,void 0,function H(){var Q,ca=this;return Km(H,function(X){Q={text:J.text,start:O.index,length:O.length};ca.OIf(Q,ca.requester.request.bind(ca.requester),J,0===Q.length);X.Rf=0})})};this.hOa=function(){K.hide()};this.reset=function(){K.handler.clearCache();K.hide()};this.iy=function(){K.handler.clearCache()};
this.gridView=Object(v.g)(this.$);this.control=new m(this.$,F);this.requester=new e(T);this.handler=new k(this.$,{RAd:this.RAd,hOa:this.hOa});this.Ti()}function e(M){this.pluginScheduler=M}function k(M,T){this.cache=void 0;var F=this;F.$=M;F.callbacks=T;F.Pmc=function(K,J){var O=F.gridView.Ki;if(!(0<(O.isEditing?O.textBox.selection:{index:0,length:0}).length))switch(J.state){case 0:F.Kzd(K,J.event);break;case 1:F.PMi(K);break;default:return A.ULS.shipAssertTag(521446489,0,!1,"FormulaAssistanceValuePreviewHandler.onHoverChange unxpected HoverState"),
J}};F.Omc=function(K,J){var O;F.clearCache();J=null!==(O=J.selection)&&void 0!==O?O:K.textBox.selection;if(0<J.length)F.onSelectionChange(K,J);else F.GBf(K)};F.gridView=Object(v.g)(F.$);F.editBox=F.gridView.$b;F.formulaBar=Object(G.a)(F.$);F.Ti();return F}function l(M){this.cache=M}function m(M,T){this.$=M;this.mJa=T;this.M9h();this.editBox=Object(v.g)(this.$).Wb}function f(M,T,F){if(M===T)return F;if(T.textContent!==T.parentElement.textContent)for(;null!==T.previousSibling;)T=T.previousSibling,F+=
T.textContent.length,"div"===T.nodeName.toLowerCase()&&(F+=1);return f(M,T.parentElement,F)}var w=b(11);u=b(0);var n=b(232),z=b(276),r=b(978),v=b(21),A=b(15),B=b(10),y=b(22),x=b(228),C=b(33);m.prototype.dispose=function(){this.hide()};m.prototype.show=function(M,T,F){M=Object.assign(Object.assign({},T),{CE:M,TZd:F});this.Xcb(M)&&(this.hide(),this.K$=M,this.xy(),F&&this.C6h())};m.prototype.hide=function(){if(this.K$){var M=this.K$.TZd;this.Hfh();M&&this.q$i();this.K$=void 0}};m.prototype.Xcb=function(M){var T;
(T=!this.K$)||(T=this.K$,T=!(T.CE===M.CE&&T.kind===M.kind&&T.text===M.text&&T.start===M.start&&T.length===M.length&&T.TZd===M.TZd));return T};m.prototype.C6h=function(){var M=this.K$;M.CE.textBox.formatText(M.start,M.length,{background:"rgba(202,234,216,0.6)"})};m.prototype.q$i=function(){var M=this.K$,T=M.CE,F=M.start;M=M.length;var K=T.text;K.length<F+M?A.ULS.shipAssertTag(521019917,0,!1,"FormulaAssistanceValuePreviewControl.removeHighlight - unexpected editor state, "+K.length+":"+F+":"+M):T.textBox.formatText(F,
M,{background:!1})};m.prototype.xy=function(){var M=this.K$,T=M.text;switch(M.kind){case 1:case 2:M={isLoaded:!0,value:T};break;case 3:M={isLoaded:!1,value:null};break;default:return}this.KTj();this.mJa.renderValuePreview(this.ks,this.bAc,M)};m.prototype.Hfh=function(){this.mJa.dismiss(this.ks)};m.prototype.M9h=function(){this.ks=document.createElement("div");this.bAc=document.createElement("div");this.bAc.style.position="absolute";this.$.domElement.appendChild(this.bAc)};m.prototype.KTj=function(){var M=
this.K$,T=M.CE,F=M.start;M=M.length;var K=y.a.contains(T.text.substring(F,F+M),"\n",!0);T=excelOnline.utils.getBoundingRectForText(T.textBox.Ne,F,K?F:F+M,!1);F=new x.a(this.bAc.style);F.FB.left=this.Oxc(T.left);F.FB.top=this.Oxc(T.top);F.FB.width=this.Oxc(T.width);F.FB.height=this.Oxc(T.height);F.w2()};m.prototype.Oxc=function(M){var T=this.K$.CE;T=Object(r.b)(this.zoomManager)&&T===this.editBox;return B.HelperMethods.hc(T?this.zoomManager.ii(M):M)};Af.Object.defineProperties(m.prototype,{zoomManager:{configurable:!0,
enumerable:!0,get:function(){this.Rie||(this.Rie=Object(C.a)(this.$));return this.Rie}}});Object(u.a)(m,"FormulaAssistanceValuePreviewControl",null,[10]);var G=b(114);l.prototype.clearCache=function(){this.cache=void 0};Object(u.a)(l,"Cacheable",null,[]);Rk(k,l);k.prototype.dispose=function(){this.Uj()};k.prototype.Ti=function(){this.editBox.EUc(this.Pmc);this.formulaBar.EUc(this.Pmc);this.editBox.ome(this.Omc);this.formulaBar.ome(this.Omc)};k.prototype.Uj=function(){this.editBox.yId(this.Pmc);this.formulaBar.yId(this.Pmc);
this.editBox.tPf(this.Omc);this.formulaBar.tPf(this.Omc)};k.prototype.Kzd=function(M,T){var F=new Sys.UI.Point(T.clientX,T.clientY);T=M.textBox.Ne;var K=void 0,J=F.x,O=F.y;K=void 0===K?document:K;F=-1;var N=null;void 0!==K.caretPositionFromPoint?(K=K.caretPositionFromPoint(J,O),null!==K&&(F=K.offset,N=K.offsetNode)):void 0!==K.caretRangeFromPoint&&(K=K.caretRangeFromPoint(J,O),null!==K&&(F=K.startOffset,N=K.startContainer));null===N||-1===F?(A.ULS.sendTraceTag(521446491,0,15,"getEditorCaretPositionFromPoint - failed to get relevant range"),
T=-1):T.contains(N)?T=f(T,N,F):(A.ULS.sendTraceTag(521446490,0,15,"getEditorCaretPositionFromPoint - relavant node not inside root"),T=-1);if(-1!==T)this.onSelectionChange(M,{index:T,length:0})};k.prototype.PMi=function(M){this.GBf(M)};k.prototype.onSelectionChange=function(M,T){this.Dwj(T)&&(this.cache=T,this.callbacks.RAd(M,T))};k.prototype.GBf=function(M){this.clearCache();this.callbacks.hOa(M)};k.prototype.Dwj=function(M){var T;(T=!this.cache)||(T=this.cache,T=!(T.index===M.index&&T.length===
M.length));return T};Object(u.a)(k,"FormulaAssistanceValuePreviewHandler",l,[10]);e.prototype.request=function(M){return Object(z.a)(this,void 0,void 0,function F(){var K=this,J,O,N;return Km(F,function(H){if(1==H.Rf)return H.Rn(K.pluginScheduler.getRequester().valuePreview(M,0),2);J=H.KB;O=J.kind;N=J.payload;if(0!==O)return H.return(null);if(Object(r.c)(N))return H.return({kind:0});switch(N.kind){case 0:return H.return({kind:0});case 1:case 2:return H.return(Object.assign({},N));case 3:return H.return({kind:0})}H.Rf=
0})})};Object(u.a)(e,"FormulaAssistanceValuePreviewRequester",null,[]);d.prototype.dispose=function(){this.Uj();this.handler.dispose();this.control.dispose()};d.prototype.Ti=function(){this.gridView.Wb.vm(this.reset);this.gridView.ha.Fga(this.reset);this.$.ea.YD(this.iy)};d.prototype.Uj=function(){this.gridView.Wb.Nl(this.reset);this.gridView.ha.Gma(this.reset);this.$.ea.lD(this.iy)};d.prototype.OIf=function(M,T,F,K){Object(z.a)(this,void 0,void 0,function O(){var N,H=this,Q;return Km(O,function(ca){if(1==
ca.Rf)return N=Object.assign(Object.assign({},M),{CE:F,pQd:K}),H.trb=N,ca.Rn(T(M),2);Q=ca.KB;if(Object(r.c)(Q)||!H.tli(N))return ca.return();H.B3h(Q);ca.Rf=0})})};d.prototype.B3h=function(M){Object(z.a)(this,void 0,void 0,function F(){var K=this,J,O,N,H,Q,ca;return Km(F,function(X){J=K.trb;O=J.text;N=J.CE;H=J.pQd;switch(M.kind){case 0:K.hide();break;case 1:case 2:K.show(N,M,H);break;case 3:if(!K.Mni(M))break;K.show(N,M,H);Q={text:O,start:M.start,length:M.length};K.OIf(Q,M.next,N,H);break;default:return ca=
M,X.return(ca)}X.Rf=0})})};d.prototype.show=function(M,T,F){this.control.show(M,T,F);this.trb=void 0;this.urb=T};d.prototype.hide=function(){this.control.hide();this.urb=this.trb=void 0};d.prototype.tli=function(M){var T;if(T=this.trb)T=this.trb,T=T.text===M.text&&T.start===M.start&&T.length===M.length&&T.CE===M.CE&&T.pQd===M.pQd;return T};d.prototype.Mni=function(M){return!this.urb||this.urb.start!==M.start||this.urb.length!==M.length||3===this.urb.kind};Object(u.a)(d,"FormulaAssistanceValuePreview",
null,[509,10]);var E=b(51),I=b(37),U=n.a;Rk(c,U);c.ka=function(M){M.da.Ga(497,new c(M))};c.prototype.create=function(){var M=this,T=this.$.da.za(496);T&&this.pb(T);var F=E.GetServiceTaskFactory.Ra(this.$.da,413,414,this.hb),K=E.GetServiceTaskFactory.Ra(this.$.da,448,449,this.hb),J=E.GetServiceTaskFactory.Ra(this.$.da,19,153,this.hb);I.TaskExtensions.Ba(I.TaskExtensions.Wd([F,K,J],this.la),function(){T=M.$.da.za(496);T||(T=new d(M.$,F.result,K.result),M.$.da.Ga(496,T));M.pb(T)},this.la,3)};Object(u.a)(c,
"FormulaAssistanceValuePreviewFactory",n.a,[]);b.d(D,"a",function(){return a})},1403:function(u,D,b){function a(){k.a.Fa(function(N){c.ka(N)})}function c(N){var H=O.call(this)||this;H.$=N;H.Eb();return H}function d(N){var H=this;this.$=N;this.k_=null;this.eBb=-1;this.jjc=null;this.ljc=0;this.T9=Object.assign({},z);this.xM=Object.assign({},r);this.tY=Object.assign({},w);this.pob=Object.assign({},n);this.Eda=Object.assign({},B);this.qob={};this.R2a=Object.assign(Object.assign({},v),{isReactDialog:F.a.Aod()});
this.Df=function(Q,ca){null!=H.k_&&(1==Math.abs(H.eBb-H.$.ea.Ve)&&(Q=H.$.va.pa.sheetId,ca.nqb&&ca.sk.equals(H.k_.sk)&&H.jjc===Q&&H.k_.ypb!==ca.ypb&&H.ljc++),1<=Math.abs(H.eBb-H.$.ea.Ve)&&(H.k_=null,H.eBb=-1,H.jjc=null))};this.Fc=function(){H.Lsj();H.x9&&H.Vsj();H.$.sendBeaconTraceTag(88392384,50,!1,"{0}",H.getJsonForLogging())};this.x9=G.EwaSettings.isChangeGateEnabled("OfficeVSO:6378161_addKeptSmartSuggestionsMetric");this.v$a=new M.a;N.Ck(this.Fc);this.x9&&U.g(this.$).Ki.vm(this.Df)}function e(N){var H=
this;this.Dpf=N;this.L_=Object.assign({},A);this.g7b=[];this.Kkc=-1;(this.Cpf=G.EwaSettings.isChangeGateEnabled("OfficeVSO:5999949_formulaTelemetryMetriThresholds"))&&N&&(this.L_.countAboveThresholds={},N.forEach(function(Q){return H.L_.countAboveThresholds[Q]=0}))}var k=b(11);u=b(0);var l=b(232),m=b(202),f={average:0,max:0,median:0,P75:0,P95:0},w={selectByArrowKeyCounter:0,selectByMouseHoverCounter:0,commitByTabKeyCounter:0,commitByEnterKeyCounter:0,commitByMouseClickCounter:0,commitWhileRequestPending:0},
n={formulaAssistanceRequestAttemptedCounter:0,formulaAssistanceRequestOptimizedCounter:0},z={argumentAssistanceCardInitialMode:void 0,argumentAssistanceCollapseCounter:0,argumentAssistanceExpandCounter:0,argumentAssistanceLearnMoreCounter:0,argumentAssistanceDismissCounter:0,argumentAssistanceDragCounter:0,argumentAssistanceDragTotalCounter:0,argumentAssistanceMoveCounter:0,argumentAssistanceMoveTotalCounter:0},r={smartSuggestionShownCounter:0,smartSuggestionSelectedCounter:0,smartSuggestionCommittedCounter:0,
smartSuggestionKeptCounter:0,isCellContentOnlyEqualDuringEditCounter:0,isCellContentFormulaCounter:0,smartSuggestionWouldSuggestInsidePivotCounter:0},v={dialogCommitedCounter:0,dialogShownCounter:0,argsDialogOpenedByRibbonCounter:0,argsDialogOpenedByDialogCounter:0,argsDialogCommitedCounter:0},A={count:0,countAboveThresholds:void 0,failedCount:0,firstAction:0,includingFirstAction:Object.assign({},f),excludingFirstAction:Object.assign({},f)},B={argumentAssistanceFlight:void 0,autoCompleteUIFlight:void 0,
smartFormulaBarAutoCompleteFlight:void 0,smartFormulaBarAutoCompletePluginFlight:void 0,anyPluginInitialized:void 0,formulaAssistanceRedesignFlight:void 0,NewInsertFunctionDialogFlight:void 0},y=b(54),x=b(110),C=b(28),G=b(1);e.prototype.kSa=function(){this.Kkc=C.a.Ta.Xd.m};e.prototype.qia=function(N){-1!==this.Kkc&&(N?(this.Mmb(C.a.Ta.Xd.m-this.Kkc),this.Kkc=-1):this.L_.failedCount++)};e.prototype.Qzh=function(){this.L_.excludingFirstAction=e.iSe(this.g7b);this.g7b.push(this.L_.firstAction);this.L_.includingFirstAction=
e.iSe(this.g7b)};e.prototype.Mmb=function(N){var H=this;this.L_.count?1E3>this.L_.count&&this.g7b.push(N):this.L_.firstAction=N;this.Cpf&&this.Dpf&&this.Dpf.forEach(function(Q){N>Q&&H.L_.countAboveThresholds[Q]++});this.L_.count++};e.iSe=function(N){var H=Object.assign({},f);0<N.length&&(x.i(N),H.median=N[Math.floor(.5*N.length)],H.P75=N[Math.floor(.75*N.length)],H.P95=N[Math.floor(.95*N.length)],H.max=N[N.length-1],H.average=x.g(N,function(Q){return Q})/N.length);return H};Object(u.a)(e,"PerformanceMeasurement",
null,[]);var E=b(22),I=b(41),U=b(21),M=b(100),T;(function(N){N[N.function=3]="function";N[N.namedRange=100]="namedRange";N[N.tableHeader=101]="tableHeader";N[N.letVariable=102]="letVariable";N[N.richEntity=103]="richEntity";N[N.lambda=104]="lambda";N[N.customFunction=105]="customFunction";N[N.table=106]="table";N[N.tableSpecialStructRef=107]="tableSpecialStructRef";N[N.richEntityEmptyCellRef=108]="richEntityEmptyCellRef"})(T||(T={}));Object(u.b)("CompletionItemKind",T);var F=b(36),K={},J=(K.argumentAssistanceOverall=
[50,80,100,130,150,170,200],K.autoCompleteOverall=[50,80,100,130,150,170,200],K);d.prototype.dispose=function(){this.$&&this.x9&&U.g(this.$).Ki.Nl(this.Df)};d.prototype.oO=function(N){var H=this;N.forEach(function(Q){H.v$a.kb(Q)||H.v$a.ia(Q,new e(J[Q]));H.v$a.na(Q).kSa()})};d.prototype.jQ=function(N,H){var Q=this;H=void 0===H?!0:H;N.forEach(function(ca){Q.v$a.kb(ca)&&Q.v$a.na(ca).qia(H)})};d.prototype.AXf=function(N){var H="Undefined";switch(N){case 1:H="Collapsed";break;case 0:H="Expanded";break;
case 2:H="Hidden"}this.T9.argumentAssistanceCardInitialMode=H};d.prototype.B7b=function(N){var H=this;window.requestAnimationFrame(function(){H.jQ([N])})};d.prototype.Y8e=function(N){var H=this;N.forEach(function(Q){Q=T[Q.kind];H.Ueg(Q);H.qob[Q].shownCounter++})};d.prototype.X8e=function(N){N=T[N];this.Ueg(N);this.qob[N].committedCounter++};d.prototype.getJsonForLogging=function(){return"{"+this.gU("SessionDetails",this.Eda)+","+this.gU("ArgumentAssistanceUsage",this.T9)+","+this.gU("FormulaSuggestionsUsage",
this.xM)+","+this.gU("FunctionDialogUsage",this.R2a)+","+this.gU("AutocompleteCardInteraction",this.tY)+","+this.gU("AutocompleteRenderOptimization",this.pob)+","+this.gU("AutocompleteUsageByKind",this.qob)+","+this.KWh()+"}"};d.prototype.Vsj=function(){this.xM.smartSuggestionKeptCounter=this.xM.smartSuggestionCommittedCounter-this.ljc};d.prototype.Lsj=function(){this.Eda.argumentAssistanceFlight=this.A3a("Microsoft.Office.ExcelOnline.","ArgumentAssistancePlugin");this.Eda.autoCompleteUIFlight=this.A3a("Microsoft.Office.Excel.",
"AutoCompleteNewUI");this.Eda.smartFormulaBarAutoCompleteFlight=this.A3a("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteFeatureIsEnabled");this.Eda.smartFormulaBarAutoCompletePluginFlight=this.A3a("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteIsEnabled");this.Eda.formulaAssistanceRedesignFlight=this.A3a("Microsoft.Office.Excel.","FormulaAssistanceRedesign");this.Eda.NewInsertFunctionDialogFlight=this.A3a("Microsoft.Office.Excel.","NewInsertFunctionDialog")};d.prototype.KWh=function(){for(var N=
new m.a,H=ak(this.v$a),Q=H.next();!Q.done;Q=H.next())Q=Q.value,Q.value.Qzh(),N.add(String.format('"{0}":{1}',Q.key,y.a.xc(Q.value.L_)));return String.format('"PerfMeasurements": {{{0}}}',N.toArray().join(","))};d.prototype.A3a=function(N,H){return E.a.contains(this.$.ya.FlightHolder.FlightId,H,!0)?G.EwaSettings.getBooleanFeatureGate(N+H,!1)?"T":"C":"None"};d.prototype.gU=function(N,H){return String.format('"{0}":{1}',N.toString(),I.c(H))};d.prototype.Ueg=function(N){this.qob[N]||(this.qob[N]={shownCounter:0,
committedCounter:0})};Object(u.a)(d,"FormulaAssistanceTelemetryManager",null,[512]);var O=l.a;Rk(c,O);c.ka=function(N){N.da.Ga(492,new c(N))};c.prototype.create=function(){var N;this.pb(null!==(N=this.$.da.za(491))&&void 0!==N?N:this.$.da.Ga(491,new d(this.$)))};Object(u.a)(c,"FormulaAssistanceTelemetryManagerFactory",l.a,[]);b.d(D,"a",function(){return a})},1421:function(u,D,b){function a(gb,Db,Va,yb){var qb=Ub.call(this,gb,"PopulateGridContextMenu",1247109494,-2064931494,a.S0h,!0,!1,a.PIb,Db,Va,
!0,yb)||this;qb.CAa=!1;qb.Jva=!1;qb.eZ=!1;qb.refresh=!1;qb.expandCollapse=!1;qb.eic=!1;qb.qDe=!0;qb.grid=ha.g(gb);qb.Mkc=!0;qb.Dfc=qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GridContextMenuFilterByValue",!1);if(qb.Dfc){var dc=Qa.GetServiceTaskFactory.Ra(qb.$.da,309,310,3),bb=Qa.GetServiceTaskFactory.create(qb.$.da,18,qb.la,3);ea.TaskExtensions.Ba(ea.TaskExtensions.Wd([dc,bb],qb.la),function(){qb.$.da.Za(268,function(db){qb.n4a=new c(gb,dc.result,bb.result,db)})},qb.la,3)}return qb}
function c(gb,Db,Va,yb){this.eWc=this.feb=this.heb=0;this.$=gb;this.gridView=ha.g(this.$);this.namedSheetViewPublic=Db;this.Gg=Va;this.instantaneousSupportInformationManager=yb;this.jMa=Ia.a.Xld()}function d(gb){this.ranges=null;this.ranges=gb}function e(gb,Db,Va,yb,qb,dc,bb,db){this.$=Db;this.Va=Va;this.pl=yb;this.selectedRanges=qb;this.grid=dc;this.vy=db;this.iba=bb;this.Mra=w.a.all(qb,function(wc){return wc.isRow});this.Qga=w.a.all(qb,function(wc){return wc.Ue});this.fDb=w.a.all(qb,function(wc){return!wc.isRow&&
!wc.Ue});Db=dc.Ab.bgd(qb);this.t4b=!!Db;this.WQf=!!Db&&Db.hasActiveFilter;this.menuSection=Va.Bc();gb.pc.push(this.menuSection);this.dka=this.Mra||this.Qga?this.menuSection:Va.Bc();this.uta=this.Mra||this.Qga?this.menuSection:Va.Bc()}b.r(D);u=b(0);var k=b(15),l=b(292),m=b(93),f=b(39),w=b(279),n=b(611),z=b(4),r=b(85),v=b(440),A=b(927),B=b(8),y=b(31),x=b(18),C=b(60),G=b(5),E=b(1E3),I=b(1253),U=b(1049),M=b(14),T=b(36);e.prototype.Bbd=function(){this.sFh();this.WEh();var gb=this.vy.J6a(this.selectedRanges,
this.grid);this.menuSection.buttons.push(this.Va.nb(gb?149:148))};e.prototype.xFh=function(){var gb=0;this.t4b?this.iba.Bm(942362098)?gb=this.vy.Bm(this.pl,942362098,this.selectedRanges,this.grid)?161:169:this.WQf&&(gb=this.vy.Bm(this.pl,-1113896058,this.selectedRanges,this.grid)?177:181):this.iba.Bm(-1113896058)&&(gb=this.Mra?this.vy.Bm(this.pl,-1113896058,this.selectedRanges,this.grid)?49:116:this.vy.Bm(this.pl,-1113896058,this.selectedRanges,this.grid)?177:181);0!==gb&&this.dka.buttons.push(this.Va.nb(gb))};
e.prototype.tFh=function(){var gb=0;this.t4b?this.iba.Bm(622604322)&&(gb=this.grid.rtl?this.vy.Bm(this.pl,622604322,this.selectedRanges,this.grid)?191:192:this.vy.Bm(this.pl,622604322,this.selectedRanges,this.grid)?162:170):this.iba.Bm(1415868706)&&(gb=T.a.jzb()&&this.grid.rtl?this.Qga?this.vy.Bm(this.pl,1415868706,this.selectedRanges,this.grid)?288:289:this.vy.Bm(this.pl,1415868706,this.selectedRanges,this.grid)?290:291:this.Qga?this.vy.Bm(this.pl,1415868706,this.selectedRanges,this.grid)?50:117:
this.vy.Bm(this.pl,1415868706,this.selectedRanges,this.grid)?178:182);0!==gb&&this.dka.buttons.push(this.Va.nb(gb))};e.prototype.rFh=function(){this.iba.Bm(1035996630)&&(this.vy.Bm(this.pl,1035996630,this.selectedRanges,this.grid)?(this.dka.buttons.push(this.Va.nb(this.grid.rtl?187:165)),this.dka.buttons.push(this.Va.nb(166))):(this.dka.buttons.push(this.Va.nb(this.grid.rtl?188:173)),this.dka.buttons.push(this.Va.nb(174))))};e.prototype.sFh=function(){var gb=b(1421).GridContextMenu,Db=null;this.fDb&&
(Db=this.Va.Tv("ContextMenu.InsertCells",null,M.a.instance.ga(350),1896159024),Db.menu.pc.push(this.dka));gb.uFh(this.dka,this.Va,this.$);this.xFh();this.tFh();this.rFh();Db&&0<this.dka.buttons.length&&this.menuSection.buttons.push(Db)};e.prototype.YEh=function(){var gb=0;this.t4b?this.iba.Bm(1405456548)?gb=this.vy.Bm(this.pl,1405456548,this.selectedRanges,this.grid)?163:171:this.WQf&&(gb=this.vy.Bm(this.pl,1554436520,this.selectedRanges,this.grid)?179:183):this.iba.Bm(1554436520)&&(gb=this.Mra?this.vy.Bm(this.pl,
1554436520,this.selectedRanges,this.grid)?51:118:this.vy.Bm(this.pl,1554436520,this.selectedRanges,this.grid)?179:183);0!==gb&&this.uta.buttons.push(this.Va.nb(gb))};e.prototype.XEh=function(){var gb=0;this.t4b?this.iba.Bm(284490184)&&(gb=this.vy.Bm(this.pl,284490184,this.selectedRanges,this.grid)?164:172):this.iba.Bm(674605324)&&(gb=this.Qga?this.vy.Bm(this.pl,674605324,this.selectedRanges,this.grid)?52:119:this.vy.Bm(this.pl,674605324,this.selectedRanges,this.grid)?180:184);0!==gb&&this.uta.buttons.push(this.Va.nb(gb))};
e.prototype.VEh=function(){this.iba.Bm(1035996630)&&(this.vy.Bm(this.pl,1035996630,this.selectedRanges,this.grid)?(this.uta.buttons.push(this.Va.nb(this.grid.rtl?189:167)),this.uta.buttons.push(this.Va.nb(168))):(this.uta.buttons.push(this.Va.nb(this.grid.rtl?190:175)),this.uta.buttons.push(this.Va.nb(176))))};e.prototype.WEh=function(){var gb=null;this.fDb&&(gb=this.Va.Tv("ContextMenu.DeleteCells",null,M.a.instance.ga(413),-1554384558),gb.menu.pc.push(this.uta));this.YEh();this.XEh();this.VEh();
gb&&0<this.uta.buttons.length&&this.menuSection.buttons.push(gb)};Object(u.a)(e,"CellsContextMenuGenerator",null,[]);Object(u.a)(d,"MacroRecorderRangeHyperlinkRemovedPayload",null,[409]);var F=b(589),K=b(24),J=b(103),O=b(76),N=b(78),H=b(45),Q=b(177),ca=b(61),X=b(701),Z=b(151),ea=b(37),ka=b(492),Y=b(620),qa=b(1),fa=b(186),ha=b(21),ia=b(391),wa=b(33),Qa=b(51),S=b(249),da=b(22),xa=b(30),ta=b(1279),ab=b(1115),Na=b(133),Ka=b(564),la=b(389),Ea=b(258),ra=b(169),na=b(160),ba=b(357),sa=b(92),ya=b(29),va=b(296),
W=b(295),La=b(134),Ia=b(983),mb=b(984),fb=b(112),Ma=b(41),Hb=b(58),Kb;(function(gb){gb[gb.none=0]="none";gb[gb.once=1]="once";gb[gb.twice=2]="twice"})(Kb||(Kb={}));Object(u.b)("ToggleState",Kb);c.prototype.Ggh=function(){var gb=this.XU(),Db={};gb=(Db.CommandValueId=Ma.c(gb),Db);Db=new sa.a(-2058042992,2,this.$.Jc,19,null);k.ULS.sendTraceTag(527500302,0,50,"GridContextMenuFilter::DoClearFilter GridContextMenu ClearFilter command executed");return this.$.Ka.Kb(Db,gb)};c.prototype.Wgh=function(){var gb=
new sa.a(644342024,2,this.$.Jc,19,null);k.ULS.sendTraceTag(527500301,0,50,"GridContextMenuFilter::DoReapplyFilter GridContextMenu ReapplyFilter command executed");return this.$.Ka.Kb(gb)};c.prototype.Lgh=function(){var gb=this.gridView.ha.sa.activeCell,Db=this.$.da.za(66).qg,Va=this.$.da.za(66).wub(gb);return Db||Va?this.Ngh(Db,Va,gb):this.Mgh(gb)};c.prototype.Ngh=function(gb,Db,Va){if(this.qWg(gb,Db,Va))return k.ULS.sendTraceTag(527500300,0,50,"GridContextMenuFilter::DoFilterByValue Header/Total error dialog raised for FilterByValue in Table"),
Hb.Task.Ua(!1);if(null!=gb&&gb.hasAutoFilter||null!=Db&&Db.UZa.every(function(yb){return 0!=yb.length}))return this.heb=Kb.none,this.cWc();this.heb=Kb.once;return this.P6b(Kb.once)};c.prototype.Mgh=function(gb){var Db=H.v(this.gridView.ha.sa.Vc,this.$);Db=this.gridView.$.va.getItemByName(Db.SheetName);var Va=H.D(Db.x0);if(this.pWg(Va,gb))return k.ULS.sendTraceTag(527500299,0,50,"GridContextMenuFilter::DoFilterByValue Header/EmptyRange error dialog raised for FilterByValue in Sheet"),Hb.Task.Ua(!1);
if(Db.hasAutoFilter){if(Va&&Va.contains(this.gridView.ha.sa.activeCell))return this.heb=Kb.none,this.cWc();this.heb=Kb.twice;return this.P6b(Kb.twice)}this.heb=Kb.once;return this.P6b(Kb.once)};c.prototype.P6b=function(gb){function Db(db){va.a(db)?k.ULS.sendTraceTag(527500297,0,50,"GridContextMenuFilter::ToggleFilter service call failed with errors : {}",ya.a.Dc(db.Errors)):(k.ULS.sendTraceTag(527500298,0,50,"GridContextMenuFilter::ToggleFilter service call succeeded"),gb===Kb.twice?yb.P6b(Kb.once):
yb.cWc())}function Va(){return new ta.a(qb)}var yb=this,qb=H.v(this.gridView.ha.sa.Vc,this.$);if(!qb)return Hb.Task.Ua(!1);this.feb||(this.feb=Date.now());var dc=new sa.a(368460465,2,this.$.Jc,19,null),bb=this.$.oa.xa.Pb();return qa.EwaSettings.Zb()?la.a(this.$.userOperationManager,function(db,wc,nb){return Ea.A(yb.$.oa.xa,qb,W.b(db,Db),wc,nb,null,bb)},function(db){return new Q.a(516,0,db,64,Va)},dc):la.a(this.$.userOperationManager,function(db,wc,nb){return Ea.A(yb.$.oa.xa,qb,W.b(db,Db),wc,nb,null,
bb)},function(db){return new Ka.a(516,0,db,void 0,Va)},dc)};c.prototype.qWg=function(gb,Db,Va){return null!=gb&&ra.d(gb)&&Va.top===gb.usedRange.top||null!=Db&&Db.Yaa&&Va.top===Db.top?(this.Lqc(this.$,225),!0):null!=gb&&ra.g(gb)&&Va.top===gb.usedRange.bottom?(this.Lqc(this.$,226),!0):!1};c.prototype.pWg=function(gb,Db){if(gb&&gb.contains(Db)&&Db.top===gb.top||!gb&&this.qVg(Db.top,Db.left))return this.Lqc(this.$,227),!0;gb=new K.Range(Db.top,Db.left,Db.top+1,Db.left+1,!1,!1);return this.gridView.Ab.Owa(gb)?
(this.Lqc(this.$,228),!0):!1};c.prototype.Lqc=function(gb,Db){Db=ya.a.Wc(1,1,754,Db,0,147079615,"ContextMenuFilterByCellValueError");qa.EwaSettings.qz()?new ba.a(gb,Db):(gb=new na.ErrorDialog(gb,Db),gb.initialize(),gb.hf())};c.prototype.cWc=function(){function gb(db){var wc={};wc=(wc.ToggleFilterOperationCount=Db.heb,wc.ApplyFilterTime=Db.eWc?Date.now()-Db.eWc:-1,wc.ToggleAndApplyFilterTime=Db.feb?Date.now()-Db.feb:-1,wc.FilterByValueType=yb.AutoFilterType,wc);k.ULS.sendTraceTag(527500295,0,50,"GridContextMenuFilter::ApplyFilterByValue Perf Telemetry : {0}",
JSON.stringify(wc));Db.feb&&(Db.feb=0);Ia.a.Zwc(db)&&(wc=Ia.a.O$b(db),Db.jMa?Ia.a.cQa(mb.a.filterByCellValue,wc.MessageIdName,fb.a.$ra,!0,Ia.a.isSessionEndingError(wc.MessageId)):k.ULS.sendTraceTag(527500294,0,10,"GridContextMenuFilter::ApplyFilterByValue failed with FilterException -{0}",wc.MessageIdName));va.a(db)?k.ULS.sendTraceTag(527500292,0,50,"GridContextMenuFilter::ApplyFilterByValue service call failed with errors : {}",ya.a.Dc(db.Errors)):(k.ULS.sendTraceTag(527500293,0,50,"GridContextMenuFilter::ApplyFilterByValue service call succeeded"),
La.b(Db.$).Cd(Na.a.Qwf,Db.dm(),void 0,!0),db={},db.FirstRow=Db.bOh(),db.FirstColumn=yb.Column,-1!==db.FirstRow&&(db=H.C(db),Db.jL(db)))}var Db=this;this.eWc=Date.now();var Va=this.i_h();if(!Va)return k.ULS.sendTraceTag(527500296,0,50,"GridContextMenuFilter::ApplyFilterByValue . CellValue returned is null"),Hb.Task.Ua(!1);var yb=this.XU(),qb={FirstRow:0};qb.FirstColumn=yb.Column;qb.SheetName=yb.SheetName;La.b(this.$).Cd(Na.a.mtf,this.dm(),void 0,!0);var dc=this.F2c(yb,qb),bb=new Q.a(208,0,function(db,
wc,nb){return ca.a(Db.$.oa.xa,dc,Va,W.b(db,gb),wc,nb,null,null)},6,function(){return new ab.a(Va,dc)});this.namedSheetViewPublic?this.namedSheetViewPublic.FAa().continueWith(function(db){db.result&&Db.$.userOperationManager.Sb(bb,null)}):this.$.userOperationManager.Sb(bb,null);return Hb.Task.Ua(!0)};c.prototype.jL=function(gb){T.a.Bba(this.$)&&ea.TaskExtensions.Ba(Qa.GetServiceTaskFactory.Ra(this.$.da,430,431,1),function(Db){Db.result.iea(gb);k.ULS.sendTraceTag(527500291,306,50,"GridContextMenuFilter:TriggerPivotTableHandRaise Trigger hand raise from context menu filterByValue.")},
this.$.la,3)};c.prototype.dm=function(){var gb={};return gb.Location="contextMenu",gb};c.prototype.XU=function(){var gb=0,Db=this.gridView.ha.sa.activeCell;var Va=this.$.da.za(66).qg;var yb=this.$.da.za(66).wub(Db);if(Va){var qb="Table";gb=Va.objectId}else yb?(qb="Table",gb=yb.id):qb="Sheet";Va=Db.left;Db={};Db.AutoFilterType=qb;Db.Column=Va;Db.Id=gb;qb={};this.$.Oj(qb);qb.FirstRow=0;qb.FirstColumn=Db.Column;gb=this.$.ea.isNamedObjectViewMode;Db.NamedObjectView=gb;Db.SheetName=gb?qb.NamedObjectName:
qb.SheetName;Db.ItemListOptions=null;return Db};c.prototype.qVg=function(gb,Db){gb=K.Range.Tc(gb,Db);return this.gridView.Ea.a$(gb,this.$.pa.name)&&(gb=this.gridView.Ea.$Ja(gb))&&gb.autoFilterMenu?!0:!1};c.prototype.i_h=function(){var gb=null,Db=this.gridView.Ub(this.gridView.ha.sa.activeCell);if(!Db)return null;var Va=Db.cell.NSd;var yb=this.instantaneousSupportInformationManager.fTa(Va,!1).category;if(1===Db.Sw.type)if(3===yb){if(!Db.cell.S8a)return k.ULS.sendTraceTag(527500290,0,15,"GridContextMenuFilter::GetValueForFilter() for category : {0}. NumFmt is null. ",
yb),null;gb=(Db.cell.S8a.Start+Db.cell.S8a.End).trim()}else if(!yb&&(da.a.f0a(Db.Sw.value,"E")||da.a.f0a(Db.originalText,"E"))){gb=this.Gg.bUe(Db.Sw.value,Va,1,Number.POSITIVE_INFINITY,Db.cell.I$);if(!gb.success)return k.ULS.sendTraceTag(527500289,0,50,"GridContextMenuFilter::GetValueForFilter() for category : {0}. Failed to acquire formatted value",yb),null;gb=gb.gz}gb||(gb=Db.originalText);return xa.a.E_c(gb)?["[Blanks]"]:["i"+gb.trim()]};c.prototype.bOh=function(){var gb=this.gridView.ha.sa.activeCell,
Db=this.$.da.za(66).qg,Va=this.$.da.za(66).wub(gb);if(Db)return Db.usedRange.top;if(null!=Va)return Va.top;Db=this.$.va.getItemByName(this.$.pa.sheetName);return(Db=H.D(Db.x0))&&Db.contains(gb)?Db.top:-1};c.prototype.F2c=function(gb,Db){var Va={};Va.Location=Db;Va.FieldId=gb.Id.toString();Va.DataSourceIndex=-1;Va.FilterType=gb.AutoFilterType;Va.AnchorType=0;Va.ChartId=null;Va.AnchorValue1=-1;Va.AnchorValue2=-1;Va.Property=gb.RichProperty;return Va};Object(u.a)(c,"GridContextMenuFilter",null,[]);b.d(D,
"GridContextMenu",function(){return a});var Ub=A.a;Rk(a,Ub);a.prototype.dispose=function(){Ub.prototype.dispose.call(this);this.grid=null};a.prototype.Lc=function(gb,Db){gb=!this.Apd(gb,Db);if(!gb)switch(Db){case -1977666927:gb=null==this.n4a||this.dwj();break;case 1549396389:gb=null==this.n4a||!this.hfi();break;case 2045563128:case 1803952894:gb=null==this.n4a||!this.$.isEditMode&&!this.ifi()}return gb};a.prototype.Apd=function(gb,Db){var Va=this.grid.ha.sa.selectedRanges;return(new Z.a(this.$.va)).Bm(gb,
Db,Va,this.grid)};a.prototype.executeCommand=function(gb,Db,Va){var yb=Db.command;gb=null;switch(yb){case -1396319072:if(Db=this.grid.Ub(null))l.a.instance.sZc(!0),m.EventHandlerManager.instance.Pad(),a.EUi(Db);break;case -1253126584:this.removeHyperlinksFromRange(this.grid.ha.sa.selectedRanges,Db);break;case 324156914:gb=this.grid.startEdit(!1,1);break;case 1441131127:this.showGridContextMenu(Va);break;case -1977666927:gb=this.n4a.Ggh();break;case 1549396389:gb=this.n4a.Wgh();break;case 1803952894:gb=
this.n4a.Lgh();break;default:gb=fa.a(yb)}return gb||ea.TaskExtensions.Qaa()};a.prototype.Ac=function(gb,Db,Va){gb=!1;switch(Db.command){case -1396319072:case -1253126584:case 324156914:case -1977666927:case 1549396389:case 1803952894:gb=!0;break;case 1441131127:gb=!!Va}return gb};a.prototype.QY=function(gb){gb=void 0===gb?!1:gb;var Db=!1,Va=!1,yb=0;qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(yb=f.a.oe());var qb=this.Va.mq(this.menuId),dc=this.grid.ha.sa,
bb=dc.tg,db=bb&&dc.Vc.Ue,wc=bb&&dc.Vc.isRow;dc=dc.selectedRanges;var nb=w.a.all(dc,function(oa){return oa.Ue}),zb=w.a.all(dc,function(oa){return oa.isRow}),ma=H.O(dc),P=H.P(dc);this.Tef(db,wc)?(Db=!0,this.aGh(qb)):this.$.isEditMode?ia.a(this.$)?this.bGh(qb,db,wc):(this.ZEh(qb,!(wc||db||!this.eic)),this.vFh(qb,dc,gb),this.kFh(qb,nb,zb,ma,P),this.nVe(qb,bb,db,wc),this.tGh(qb),this.TUe(qb,db,wc),this.RFh(qb,bb,db,wc,dc),this.bFh(qb),this.$Eh(qb,dc),this.CFh(qb),this.oGh(qb,bb),qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImmersiveReader",
!1)&&this.pFh(qb)):(Va=!0,ia.a(this.$)?this.iVe(qb):this.JGh(qb,bb,db,wc,dc));qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(gb=f.a.oe()-yb,k.ULS.sendTraceTag(537167046,0,50,"GridContextMenu::CreateMenuModel, ExecutionTimeTotal: {0}, isPivotMenu: {1}, isViewMenu: {2}, firstTimeEntry: {3}",gb,Db,Va,this.qDe));this.qDe=!1;return qb};a.prototype.PJa=function(gb){var Db=[];if(ia.a(this.$))return Db;if(3===gb){gb=this.grid.ha.sa;var Va=gb.tg,yb=Va&&gb.Vc.Ue,
qb=Va&&gb.Vc.isRow,dc=!1,bb=!1,db=!1;this.$.isMobileMode&&(bb=gb.selectedRanges,dc=H.O(bb),bb=H.P(bb));if(Va){var wc=ha.e(this.grid);wc&&wc.range.contains(gb.Vc)&&this.sV(wc)&&(db=!0)}this.$.isEditMode?this.Tef(yb,qb)?Array.addRange(Db,[U.a.ZFf,U.a.aGf]):yb||qb?(Db.push(U.a.clipboard),qb?Db.push(U.a.uij):yb&&Db.push(U.a.TZg)):(Array.addRange(Db,[U.a.edit,U.a.clipboard]),db?Db.push(U.a.hyperlink):Db.push(U.a.color),Va&&Db.push(U.a.KMg)):(Db.push(U.a.copy),db&&Db.push(U.a.openHyperlink),!qb||this.$.isMobileMode&&
bb?!yb||this.$.isMobileMode&&dc||Db.push(U.a.dWj):Db.push(U.a.eWj));Db.push(U.a.J0h)}else 2===gb&&Db.push(U.a.zwe);return Db};a.prototype.Tef=function(gb,Db){return(this.CAa||this.Jva||this.eZ||this.refresh||this.expandCollapse)&&!(gb||Db)};a.prototype.showGridContextMenu=function(gb){this.expandCollapse=this.refresh=this.eZ=this.Jva=this.CAa=!1;var Db=this.$,Va=ka.a(Db).dKa(),yb=this.grid.ha.sa,qb=yb.tg,dc=qb&&yb.Vc.Ue;yb=qb&&yb.Vc.isRow;if(Va&&!dc&&!yb){dc=Y.a(Db);if(null===dc||void 0===dc?0:dc.gQd)this.CAa=
dc=J.f(Db.ng),this.Jva=!dc;dc=Db.ic;this.eZ=Va.supportsBIExplore&&!!E.a(Db)&&dc.x2(32768);dc.allowInteractivity&&(Db=this.grid.Ub(null),(null===Db||void 0===Db?0:Db.cell)&&(Db.cell.hZc||Db.cell.O1f)&&(this.expandCollapse=!0),dc.allowManualDataRefresh&&(this.refresh=!0))}Db=null;Va=1;dc=Object(r.a)(n.a,gb.eventArgs);gb=Object(r.a)(I.a,gb.creationParams);yb=this.fLh();gb?(Db=gb.clientPoint,Va=gb.inputMethod):dc&&1!==dc.mb?(Db=new Sys.UI.Point(dc.clientPoint.x,dc.clientPoint.y),Va=dc.mb):yb&&(Db=new Sys.UI.Point(yb.x+
(this.$.isChromeRtl?0:yb.width),yb.y+yb.height));O.a.Cb=Va;this.eic=3===Va;gb=y.a.htb;this.np(Db,!dc||dc.Ca.target.className!==gb,Va)};a.prototype.removeHyperlinksFromRange=function(gb,Db){var Va=this;if(!qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.kq(gb,!0)){var yb=H.r(gb,this.$),qb=this.$.oa.xa.Pb();this.$.userOperationManager.Sb(new Q.a(125,0,function(dc,bb,db){Va.$.ry();return ca.b(Va.$.oa.xa,yb,"","",!0,!1,127,dc,bb,db,null,
qb)},void 0,function(){return new d(yb)}),Db);this.grid.ig.IG(!1)}};a.prototype.fLh=function(){var gb=this.grid.Ub(null);if((null===gb||void 0===gb?0:gb.cell.tk)&&this.Xdf(gb))return this.grid.getCellBounds(gb.cell);gb=this.grid.ha.sa.activeCell;return(gb=this.y9b(new K.Range(gb.top,gb.left,B.a.vh,gb.left,!1,!1),2,!0)||this.y9b(new K.Range(1,gb.left,gb.top,gb.left,!1,!1),2,!1)||this.y9b(new K.Range(gb.top,gb.right,gb.top,B.a.Eh,!1,!1),1,!0)||this.y9b(new K.Range(gb.top,1,gb.top,gb.right,!1,!1),1,
!1)||null)&&gb.tk?this.grid.getCellBounds(gb):Sys.UI.DomElement.getBounds(this.grid.N4a.jc)};a.prototype.Xdf=function(gb){var Db=this.grid.rtl,Va=this.$.isChromeRtl;gb=gb.cell;var yb=ha.g(this.$).OJ(gb);return yb?(yb=yb.topLeft,Db=yb.x+=Db===Va?gb.offsetWidth:0,Va=yb.y+=gb.offsetHeight,this.grid.view.visibleArea.contains(new C.a(Db,Va,0,0))):!1};a.prototype.y9b=function(gb,Db,Va){gb=this.grid.pk("GridContextMenu.FindFirstCellInViewportArea",gb,Db,Va);try{for(gb.$$rst();gb.$$mn();){var yb=gb.$$cu();
if(yb&&this.Xdf(yb))return yb.cell}}finally{gb&&gb.dispose()}return null};a.prototype.aGh=function(gb){var Db=this.Va,Va=Db.Bc();this.refresh&&Va.buttons.push(Db.nb(100));this.eZ&&Va.buttons.push(Db.nb(99));this.CAa?Va.buttons.push(Db.nb(59)):this.Jva&&Va.buttons.push(Db.nb(58));if(this.expandCollapse){var yb=Db.Tv("ContextMenu.PivotExpandCollapse",null,M.a.instance.ga(1144),589118293);var qb=Db.Bc();qb.buttons.push(Db.nb(243));qb.buttons.push(Db.nb(244));qb.buttons.push(Db.nb(245));qb.buttons.push(Db.nb(246));
yb.menu.pc.push(qb);yb&&0<qb.buttons.length&&Va.buttons.push(yb)}gb.pc.push(Va)};a.prototype.nVe=function(gb,Db,Va,yb){if(Db&&!Va&&!yb){Db=this.Va.Bc();this.Dfc&&!this.$.VM&&this.Gbd(Db);this.Nbd(Db);this.xGh(Db);if(qa.EwaSettings.ma(481)&&ha.g(this.$).ha.sa.ZJ()&&ha.g(this.$).ha.sa.k5)switch(qa.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:Db.buttons.push(this.Va.nb(237));break;case 2:Db.buttons.push(this.Va.nb(238));break;
default:Db.buttons.push(this.Va.nb(236))}gb.pc.push(Db)}};a.prototype.Nbd=function(gb){if(!qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6172529_FixAllowSort")||this.$.ic.allowSorting)if(!qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5230917_HideSortForProtectedSheetInMobiles")||!this.$.isMobileMode||(new Z.a(this.$.va)).Vd(2048)){var Db=this.Va.Bc();Db.buttons.push(this.Va.nb(223));Db.buttons.push(this.Va.nb(224));qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PutSelectedItemOnTop",
!1)&&(Db.buttons.push(this.Va.nb(292)),Db.buttons.push(this.Va.nb(293)),Db.buttons.push(this.Va.nb(294)));this.$.isMobileMode||Db.buttons.push(this.Va.nb(225));var Va=this.Va.Tv("ContextMenu.sort",null,M.a.instance.ga(229),-864298118);Va.menu.pc.push(Db);gb.buttons.push(Va)}};a.prototype.Gbd=function(gb){var Db=this.Va.Tv("ContextMenu.filter",null,M.a.instance.ga(1940),2045563128),Va=this.Va.Bc(),yb=this.DPh(),qb=this.Va.nb(234);qb.label=yb;Va.buttons.push(qb);Va.buttons.push(this.Va.nb(235));yb=
this.Va.Bc();yb.buttons.push(this.Va.nb(233));Db.menu.pc.push(Va);Db.menu.pc.push(yb);gb.buttons.push(Db)};a.prototype.xGh=function(gb){if(ha.g(this.$).ha.sa.ZJ()){var Db=this.Va.Bc();Db.buttons.push(this.Va.nb(232));qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableMissingContextMenuOptions",!1)&&(Db.buttons.push(this.Va.nb(285)),Db.buttons.push(this.Va.nb(286)));var Va=this.Va.Tv("ContextMenu.table",null,M.a.instance.ga(1939),-697806646);Va.menu.pc.push(Db);gb.buttons.push(Va)}};
a.prototype.dVe=function(gb,Db,Va,yb,qb){if(Db){var dc=H.K(qb),bb=ha.e(this.grid);if(bb&&!Va&&!yb){Va=new Z.a(this.$.va);if(bb.range.contains(dc)&&this.sV(bb)){(Db=!bb.$La&&!Va.ij)&&this.$.isEditMode&&gb.buttons.push(this.Va.nb(45));bb.Xaa&&gb.buttons.push(this.Va.nb(53));Db&&this.$.isEditMode&&gb.buttons.push(this.Va.nb(47));return}!bb.$La&&this.$.isEditMode&&(bb=Va.Vd(128),gb.buttons.push(this.Va.nb(bb?46:121)))}}this.x4i(qb)&&gb.buttons.push(this.Va.nb(48));(bb=this.$.va.pa)&&bb.Md&&(bb=bb.Md.Wx||
bb.Md.dK,!Db||this.$.VM||!qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.ea.isNamedObjectViewMode||this.$.isMobileMode||bb||(Db=H.K(qb),this.w4i(Db)?gb.buttons.push(this.Va.nb(276)):Db.Ue||Db.isRow||gb.buttons.push(this.Va.nb(275))))};a.prototype.x4i=function(gb){gb=ak(gb);for(var Db=gb.next();!Db.done;Db=gb.next()){Db=this.grid.getRangeInformation(Db.value);for(var Va=0;Va<Db.length;Va++)if(Object(v.a)(F.HyperlinkRange,Db[Va])){var yb=this.grid.Ub(Db[Va]);
if(yb&&this.sV(yb)&&!yb.$La)return!0}}return!1};a.prototype.w4i=function(gb){if(ha.g(this.$).ha.sa.ZJ()){var Db=ha.g(this.$).Ab.dk(gb);if(Db&&Db.usedRange.equals(gb))return!0}return!1};a.prototype.TUe=function(gb,Db,Va){var yb,qb;if(1===ha.g(this.$).ha.Qe&&!Db&&!Va){Db=ia.a(this.$);Va=this.Va;var dc=Va.Bc(),bb=this.$.da.za(65);(null===(yb=null===bb||void 0===bb?void 0:bb.Em)||void 0===yb?0:yb.WE)&&!Db&&dc.buttons.push(Va.nb(227));bb&&bb.isCommentOperationEnabled(3)&&dc.buttons.push(Va.nb(221));(null===
(qb=null===bb||void 0===bb?void 0:bb.Em)||void 0===qb?0:qb.lid)&&!Db&&dc.buttons.push(Va.nb(228));(null===bb||void 0===bb?0:bb.hasCommentAtActiveCell)?bb.jC.isResolved||dc.buttons.push(Va.nb(159)):bb&&bb.hasCommentAtActiveCell||(bb&&bb.Em&&bb.Em.WE?Db||(dc.buttons.push(Va.nb(229)),dc.buttons.push(Va.nb(230))):(dc.buttons.push(Va.nb(160)),Db||dc.buttons.push(Va.nb(226))));gb.pc.push(dc)}};a.prototype.tGh=function(gb){if(qa.EwaSettings.ma(135)){var Db=this.Va,Va=Db.Bc();Va.buttons.push(Db.nb(250));
gb.pc.push(Va)}};a.prototype.vFh=function(gb,Db,Va){if(!Va){Va=this.$.Ka.dH();var yb=new Z.a(this.$.va),qb=new X.a(Va,Db,this.grid);(new e(gb,this.$,this.Va,Va,Db,this.grid,qb,yb)).Bbd()}};a.prototype.kFh=function(gb,Db,Va,yb,qb){var dc=(new Z.a(this.$.va)).Vd(8),bb=this.Va,db=bb.Bc();Db&&db.buttons.push(bb.nb(dc?152:153));Va&&db.buttons.push(bb.nb(dc?150:151));Db&&(yb||db.buttons.push(bb.nb(dc?109:155)),db.buttons.push(bb.nb(dc?111:157)));Va&&(qb||db.buttons.push(bb.nb(dc?108:154)),db.buttons.push(bb.nb(dc?
110:156)));gb.pc.push(db)};a.prototype.ZEh=function(gb,Db){var Va=this.Va,yb=Va.Bc();gb.pc.push(yb);Db&&yb.buttons.push(Va.nb(102));yb.buttons.push(Va.nb(42));yb.buttons.push(Va.nb(43));Db=this.YFh(Va);gb.pc.push(Db)};a.prototype.YFh=function(gb){var Db=gb.Bc();Db.title=M.a.instance.ga(1124);Db.K3f=!1;Db.J3f=!1;Db.b9f=!1;var Va=5,yb=T.a.Sqd(this.$);yb&&(Va=6);gb=gb.qC("PasteOptionsGallery",Va,"Size24by24",Db.title);Db.buttons.push(gb);gb.Dt("ContextMenu.Paste",237279923,"QueryAdvancedPasteContextMenuGalleryIcon",
1125,void 0,"Paste_24",1,x.a.Csh);gb.Dt("ContextMenu.PasteValues",-185374993,"QueryAdvancedPasteContextMenuGalleryIcon",1126,void 0,"PasteValues_24",1,x.a.Hsh);gb.Dt("ContextMenu.PasteFormulas",1766348718,"QueryAdvancedPasteContextMenuGalleryIcon",1127,void 0,"PasteFormulas_24",1,x.a.Esh);gb.Dt("ContextMenu.PasteTranspose",-958589048,"QueryAdvancedPasteContextMenuGalleryIcon",1128,void 0,"PasteTranspose_24",1,x.a.Gsh);gb.Dt("ContextMenu.PasteFormatting",1804571062,"QueryAdvancedPasteContextMenuGalleryIcon",
1129,void 0,"PasteFormatting_24",1,x.a.Dsh);yb&&gb.Dt("ContextMenu.PasteLink",42074747,"QueryAdvancedPasteContextMenuGalleryIcon",1130,void 0,"PasteLink_24",1,x.a.Fsh);return Db};a.prototype.JGh=function(gb,Db,Va,yb,qb){var dc,bb=this.Va,db=bb.Bc();db.buttons.push(bb.nb(43));gb.pc.push(db);this.Dfc&&!this.$.VM&&(db=this.Va.Bc(),this.Gbd(db),gb.pc.push(db));qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInReadOnlyEditMode",!1)&&this.$.ea.ic.isMobileMode&&this.$.ea.ic.isReadOnlyEditMode&&
!this.$.ya.IsMeetingLiveSession||(db=this.Va.Bc(),this.Nbd(db),gb.pc.push(db),k.ULS.sendTraceTag(537167045,0,50,"GridContextMenu::GenerateViewMenuSection, Remove the sort options from right contextual menu in mobile, readonlyeditmode and non-meeting scenario"));db=this.$.da.za(65);if(null===(dc=null===db||void 0===db?void 0:db.Em)||void 0===dc?0:dc.WE)dc=this.Va.Bc(),dc.buttons.push(bb.nb(229)),gb.pc.push(dc);dc=this.Va.Bc();this.dVe(dc,Db,Va,yb,qb);gb.pc.push(dc);z.AFrameworkApplication.isMobileMode&&
!N.a(this.$.ya,30)&&(Db=bb.Bc(),Db.buttons.push(bb.nb(272)),gb.pc.push(Db))};a.prototype.RFh=function(gb,Db,Va,yb,qb){var dc=this.Va.Bc();this.SFh(dc);this.dVe(dc,Db,Va,yb,qb);0<dc.buttons.length&&gb.pc.push(dc)};a.prototype.SFh=function(gb){gb.buttons.push(this.Va.nb(135))};a.prototype.pFh=function(gb){var Db=this.Va.Bc();Db.buttons.push(this.Va.nb(185));gb.pc.push(Db)};a.prototype.oGh=function(gb,Db){qa.EwaSettings.ma(482)&&Db&&(Db=this.Va.Bc(),Db.buttons.push(this.Va.nb(262)),gb.pc.push(Db))};
a.prototype.CFh=function(gb){var Db=this.grid.ha.sa.selectedRanges;if(Db&&Db.length){for(var Va=!1,yb=0;yb<Db.length;yb++)if(this.grid.Ab.Vwa(Db[yb])){Va=!0;break}if(Va){Va=!1;if(qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6411410_RemoveConvertToTextForRichValueRange"))for(yb=0;yb<Db.length;yb++){var qb=this.grid.Ab.HTh(Db[yb]);if(null!=qb&&null!=qb[0]){for(var dc=0;dc<qb.length;dc++)if(this.grid.Ab.Vwa(qb[dc])){Va=!0;break}if(Va)break}}dc=this.Va;yb=dc.Bc();qb=dc.Bc();for(var bb=1===Db.length&&
(Db[0].isSingle||this.grid.Ab.R6a(Db[0])),db=!1,wc=!1,nb=!1,zb=!1,ma=0;ma<Db.length&&!(db&&nb&&wc&&zb);ma++)!db&&this.grid.Ab.Tji(Db[ma])&&(db=!0),!nb&&this.grid.Ab.Odf(Db[ma],!1)&&(nb=!0),!wc&&this.grid.Ab.opd(Db[ma])&&(wc=!0),!zb&&this.grid.Ab.kfi(Db[ma])&&(zb=!0);qa.EwaSettings.ma(105)&&bb&&!this.grid.Ab.gfc(Db[0])&&(zb?yb.buttons.push(dc.nb(217)):yb.buttons.push(dc.nb(216)));zb=db;zb=!(new Z.a(this.$.va)).ij&&zb;nb&&!Va&&(qa.EwaSettings.ma(131)&&J.l(this.$.ng)&&(qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",
!1)&&(qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5695344_showRefreshSettingsOnProtectedSheet")?qb.buttons.push(dc.nb(220)):qb.buttons.push(dc.nb(zb?220:271))),wc&&qb.buttons.push(dc.nb(zb?218:269)),bb&&(this.grid.Ab.opd(Db[0])||this.grid.Ab.gfc(Db[0]))&&qb.buttons.push(dc.nb(zb?219:270))),qb.buttons.push(dc.nb(zb?215:268)));0<qb.buttons.length&&(Db=dc.Tv(db?"ContexMenu.LinkedEntitiesFlyOut_EnabledContents":"ContexMenu.LinkedEntitiesFlyOut_DisabledContents",null,M.a.instance.ga(1758),798637440),
Db.menu.pc.push(qb),yb.buttons.push(Db));0<yb.buttons.length&&gb.pc.push(yb)}}};a.prototype.$Eh=function(gb,Db){this.grid.Ab.dcf(Db)&&(Db=this.Va.Bc(),this.grid.ha.sa.Eba()?(Db.buttons.push(this.Va.nb(241)),Db.buttons.push(this.Va.nb(239))):Db.buttons.push(this.Va.nb(240)),gb.pc.push(Db))};a.prototype.sV=function(gb){return gb.cell.hasHyperlink};a.prototype.iVe=function(gb){this.cGh(gb);var Db=this.Va.Bc();this.Nbd(Db);gb.pc.push(Db);this.Dfc&&(Db=this.Va.Bc(),this.Gbd(Db),gb.pc.push(Db))};a.prototype.bGh=
function(gb,Db,Va){this.iVe(gb);this.TUe(gb,Db,Va)};a.prototype.cGh=function(gb){if(this.grid.ha.sa.tg&&!this.grid.eb.Ni){var Db=this.Va,Va=Db.Bc();wa.a(this.$).KQd()?Va.buttons.push(Db.nb(265)):Va.buttons.push(Db.nb(264));gb.pc.push(Va)}};a.EUi=function(gb){var Db=gb.WJa(a.Gjd);Db&&Db.tld&a.Gjd&&gb.invoke(a.Gjd,null)};a.uFh=function(gb,Db,Va){if(qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5552180_DontAssertIfCopyPasteInfraNotReadyOnContextMenuOpen")){if(Va=Va.da.za(254),!Va){k.ULS.sendTraceTag(537167044,
0,50,"GridContextMenu::GenerateInsertCopiedCutCellsConextMenu, CopyPasteInfrastructure is not ready.");return}}else if(Va=Va.da.za(254,!0),!Va)return;Va.bod()&&Va.Qif()&&gb.buttons.push(Db.nb(212));Va.bod()&&Va.Yic()&&gb.buttons.push(Db.nb(213))};a.prototype.dwj=function(){var gb=this.$.da.za(66).qg,Db=this.grid.ha.sa.activeCell;return null!=gb&&!gb.hasActiveFilter||S.c(this.$,Db)||!this.jfi(Db)};a.prototype.jfi=function(gb){var Db=gb.left,Va=this.acc();if(null!=Va&&null!=Va.o9b&&Array.contains(Va.o9b,
Db-1))return!0;Va=this.Sbc();return null!=Va&&H.D(Va).contains(gb)&&null!=Va.FilteredColumns&&Array.contains(Va.FilteredColumns,Db-1)?!0:!1};a.prototype.hfi=function(){var gb=this.$.da.za(66).qg,Db=this.acc();if(null!=gb)return gb.hasAutoFilter&&gb.hasActiveFilter;if(null!=Db)return null!=Db.o9b&&0<Db.o9b.length;gb=this.Sbc();return null!=gb&&null!=gb.FilteredColumns&&0<gb.FilteredColumns.length};a.prototype.ifi=function(){var gb=this.$.da.za(66).qg,Db=this.acc();if(null!=gb&&gb.hasAutoFilter||null!=
Db&&Db.UZa.every(function(Va){return 0!=Va.length}))return!0;gb=H.D(this.Sbc());return null!=gb&&gb.contains(this.grid.ha.sa.activeCell)?!0:!1};a.prototype.acc=function(){var gb=this.$.da.za(66);gb.Xm(this.grid.ha.sa.activeCell);return gb.wub(this.grid.ha.sa.activeCell)};a.prototype.Sbc=function(){return this.$.va.getItemByName(this.$.pa.sheetName).x0};a.prototype.DPh=function(){var gb=this.grid.ha.sa.activeCell,Db=0,Va=!1,yb=this.$.da.za(66),qb=this.acc();yb=yb.qg;null!=yb?(Db=yb.usedRange.top,Va=
!0):null!=qb?(Db=qb.top,Va=!0):(qb=this.Sbc(),null!=qb&&H.D(qb).contains(gb)&&(Db=qb.FirstRow+1,Va=!0));return Va?(gb=gb.left,Db=K.Range.Tc(Db,gb),Db=this.grid.Ub(Db),Va="",null!=Db&&(Va=Db.text),this.VPg(Va,gb)):M.a.instance.ga(222)};a.prototype.VPg=function(gb,Db){null==gb||da.a.uh(gb.trim())?gb=String.format(M.a.instance.lb(157),K.Range.MP(Db)):gb.length>a.W_d?(gb=gb.substring(0,a.W_d),gb=String.format(M.a.instance.lb(155),gb)):gb=String.format(M.a.instance.lb(156),gb);return gb};Af.Object.defineProperties(a.prototype,
{yw:{configurable:!0,enumerable:!0,get:function(){return"PopulateGridContextMenu"}},wB:{configurable:!0,enumerable:!0,get:function(){return G.a.cLf}}});a.PIb="GridContextMenuRootName";a.S0h=G.a.$Ae;a.Gjd=192;a.W_d=26;Object(u.a)(a,"GridContextMenu",A.a,[])},1422:function(u,D,b){function a(Y,qa){var fa=ka.call(this,Y)||this;fa.LCa=null;fa.XZc=[];fa.M3d=null;fa.Nva=!1;fa.Ndc=!1;fa.$p=null;fa.w$d=null;fa.TIe=function(){fa.CY.aJa(fa.items,fa.LCa);fa.raiseEvent("ACLBUpdated",new r.a(fa.items.length));
fa.show()};fa.tableManager=qa;fa.domElement.className=n.a.ULe;fa.domElement.innerHTML=ea;M.DOMElementExtensions.setVisible(fa.domElement,!1);Z.d(fa.style,fa.$.isChromeRtl);fa.Ccf=C.EwaSettings.xl();fa.uwe=$get(k.V6f,fa.domElement);fa.CY=new c(fa.$,fa.uwe,fa);fa.tSa(!0);fa.$.domElement.appendChild(fa.domElement);fa.fob(Y,H.a(Y));fa.fob(Y,E.g(Y).Wb);fa.Ccf||fa.$.da.Ga(1,fa);fa.ofi=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeHandleKeyDownConditionOrder",!1);return fa}function c(Y,
qa,fa){Y=J.call(this,Y,qa)||this;Y.cellAutoCompleteControl=null;Y.bra=null;Y.gyb=C.EwaSettings.xl();Y.gyb&&(Y.cellAutoCompleteControl=fa);Y.pq=[];return Y}function d(Y,qa,fa){var ha=I.call(this,Y,qa)||this;ha.KQb=null;ha.Sic=0;ha.D7a=null;ha.J0=null;ha.Y5=function(ia,wa){if(ia=ha.cellAutoCompleteControl.items)if(1===ia.length&&ha.cellAutoCompleteControl.A0a.length<ia[0].Zra.length&&ha.cellAutoCompleteControl.Nva&&G.a.cL(ia[0].Zra,ha.cellAutoCompleteControl.A0a)&&(wa.newValue=ia[0].Zra),ha.Ya&&C.EwaSettings.ma(136)){var Qa=
-1;1<ia.length?Qa=ha.cellAutoCompleteControl.Xbc(ha.Ya.text,!0):1===ia.length&&(ha.cellAutoCompleteControl.Nva||ha.cellAutoCompleteControl.Ndc)&&(Qa=0);if(0<=Qa&&ia.length>Qa&&ia[Qa].aXc){var S=x.C(ia[Qa].aXc);S&&E.g(ha.$).Ab.Vwa(S)&&(wa.$af=!0,wa.vwe=ia[Qa].aXc)}}};ha.QEb=function(){ha.cellAutoCompleteControl.Nva=!1};ha.Ya.nYa(ha.Y5);ha.gyb=C.EwaSettings.xl();ha.gyb&&(ha.KQb=fa);ha.J0=ha.ke.Td(ha.Ya.textBox.domElement);ha.J0.ka("mousedown",ha.QEb);return ha}function e(Y,qa){this.Pkg=Y;this.Okg=qa}
function k(){}b.r(D);u=b(0);var l=b(15),m=b(90),f=b(1297),w=b(8),n=b(986);k.V6f="suggested_cells_list_box";Object(u.a)(k,"CssElementIds",null,[]);var z=b(5),r=b(1298);Af.Object.defineProperties(e.prototype,{Zra:{configurable:!0,enumerable:!0,get:function(){return this.Pkg}},aXc:{configurable:!0,enumerable:!0,get:function(){return this.Okg}}});Object(u.a)(e,"CellAutoCompleteItem",null,[560]);var v=b(4),A=b(85),B=b(1119),y=b(408),x=b(45),C=b(1),G=b(22),E=b(21),I=B.a;Rk(d,I);d.prototype.dispose=function(){this.Ya.LHb(this.Y5);
I.prototype.dispose.call(this)};d.prototype.dU=function(Y){Y&&!this.cellAutoCompleteControl.isListVisible||I.prototype.dU.call(this,Y)};d.prototype.Kh=function(Y,qa){this.cellAutoCompleteControl.Ya=this.Ya;this.Sic=Y.keyCode;if(this.Ya.isEditing){var fa=this.Ya.text;G.a.equals(this.D7a,fa,!1)||(this.D7a=fa)}else this.D7a=null;if(237279923===qa)return this.cellAutoCompleteControl.isListVisible=!1;C.EwaSettings.ma(136)&&17===this.Sic&&this.cellAutoCompleteControl.Nva&&(this.cellAutoCompleteControl.Ndc=
!0);return I.prototype.Kh.call(this,Y,qa)};d.prototype.wyd=function(){var Y;if(!C.EwaSettings.isChangeGateEnabled("OfficeVSO:5172529_CheckForShuttingDownInAutocompletionTimedCallback")||!v.AFrameworkApplication.Bg)if(this.cellAutoCompleteControl.Ya=this.Ya,this.cellAutoCompleteControl.Nva=!1,this.Ya.isEditing){var qa=!G.a.equals(this.D7a,this.Ya.text,!0),fa=this.Ya.Xmd;fa||!qa&&229!==this.Sic?fa&&(this.cellAutoCompleteControl.isListVisible&&(this.cellAutoCompleteControl.isListVisible=!1),null===(Y=
this.cellAutoCompleteControl.kNa)||void 0===Y?void 0:Y.cancel()):this.cellAutoCompleteControl.zLg(this.Sic)}else this.D7a=null};d.prototype.Gh=function(){};d.prototype.Df=function(){this.vV=!1;this.cellAutoCompleteControl.set_visible(!1);this.D7a=null;this.cellAutoCompleteControl.Nva=!1;this.cellAutoCompleteControl.Ndc=!1;this.cellAutoCompleteControl.kNa&&this.cellAutoCompleteControl.kNa.cancel()};d.prototype.aFd=function(Y,qa){return this.cellAutoCompleteControl.Kh(Y,qa)};Af.Object.defineProperties(d.prototype,
{vyb:{configurable:!0,enumerable:!0,get:function(){return!1}},vV:{configurable:!0,enumerable:!0,get:function(){return this.cellAutoCompleteControl.isListVisible},set:function(Y){this.cellAutoCompleteControl.isListVisible=Y}},j5a:{configurable:!0,enumerable:!0,get:function(){return!1}},key:{configurable:!0,enumerable:!0,get:function(){return y.a.YZc}},cellAutoCompleteControl:{configurable:!0,enumerable:!0,get:function(){if(this.gyb)return this.KQb;var Y=b(1422).CellAutoCompleteControl;return this.KQb||
(this.KQb=Object(A.a)(Y,this.$.da.za(1)))}}});Object(u.a)(d,"CellAutoCompleteListAutoCompleteBehavior",B.a,[]);var U=b(30);B=b(1299);var M=b(12),T=b(10),F=b(117),K=b(70),J=B.a;Rk(c,J);c.prototype.dispose=function(){J.prototype.dispose.call(this);this.bra=null};c.prototype.$yc=function(Y){this.B7(!1);var qa=""+String.format("<table class='{0}' aria-live='polite'><tbody>",this.Uba);for(var fa=0,ha=this.pq.length;fa<ha;fa++){var ia=U.a.Ag(Y[this.pq[fa]].Zra);ia=String.format("<tr><td class='{0}'><span class='{1}' {2}='{3}'>{4}</span></td></tr>",
this.m_,c.ZZc,z.a.Roe,ia,U.a.z7b(ia));qa+=ia}this.Qf.innerHTML=qa+"</tbody></table>";this.Gn=M.DOMElementExtensions.Cj(this.domElement,this.Uba);this.B7(!0);this.Ira()};c.prototype.aJa=function(Y,qa){if(Y&&Y.length){var fa=[];if(qa)for(var ha=0,ia=Y.length;ha<ia;ha++)G.a.cL(Y[ha].Zra,qa)&&fa.push(ha);this.pq=fa;this.$yc(Y)}else this.isListVisible=!1,this.bra=null};c.prototype.Qxa=function(){};c.prototype.cTg=function(Y,qa,fa){var ha=Math.min(Y,Math.max(200,fa));qa&&Y<fa&&(ha+=F.a.gv);M.DOMElementExtensions.vr(this.Qf,
ha);qa&&(ha-=F.a.gv);return ha};c.prototype.Ira=function(){J.prototype.Ira.call(this);var Y=M.DOMElementExtensions.Cj(this.get_element(),this.Uba),qa=this.pq.length>this.MH,fa=E.g(this.$);if(fa=fa.Ub(fa.ha.sa.activeCell))for(Y=this.cTg(Y.offsetWidth,qa,fa.width),qa=this.Qf.getElementsByClassName(c.ZZc),fa=0;fa<qa.length;fa++)qa[fa].style.maxWidth=T.HelperMethods.hc(Y);else l.ULS.sendTraceTag(537167964,0,15,"CellAutoCompleteListBox.AdjustHeightAndWidth: Can't retrive FormattedCell of the Current Active Cell.")};
c.prototype.onItemClick=function(Y){if(Y=J.prototype.onItemClick.call(this,Y)){var qa=E.g(this.$);qa.Ao(!1);qa.focus()}return Y};Af.Object.defineProperties(c.prototype,{Pk:{configurable:!0,enumerable:!0,get:function(){return this.bra},set:function(Y){this.iBa(this.Pk);this.bra=Y;var qa=this.iBa(this.Pk);this.he=Y?qa.innerText:null;this.Duc(Y)}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return Object(K.a)(c.prototype,this,"isListVisible")},set:function(Y){Object(K.b)(c.prototype,
this,"isListVisible",Y);Y||(this.Pk=null)}},QSa:{configurable:!0,enumerable:!0,get:function(){return null}},hGa:{configurable:!0,enumerable:!0,get:function(){return this.gyb?this.cellAutoCompleteControl:this.cellAutoCompleteControl||(this.cellAutoCompleteControl=this.$.da.za(1))}}});c.ZZc=n.a.Wrh;Object(u.a)(c,"CellAutoCompleteListBox",B.a,[]);var O=b(24),N=b(64),H=b(114),Q=b(179),ca=b(44),X=b(34),Z=b(261);B=b(18);b.d(D,"CellAutoCompleteControl",function(){return a});var ea="<div id='"+k.V6f+"' class='"+
n.a.C8c+" "+B.a.No+"' ></div>",ka=f.a;Rk(a,ka);a.prototype.iZb=function(Y){this.addHandler("ACLBUpdated",Y)};a.prototype.zsc=function(Y){this.removeHandler("ACLBUpdated",Y)};a.prototype.s2=function(Y){this.addHandler("ACLBSelectionChanged",Y)};a.prototype.ida=function(Y){this.removeHandler("ACLBSelectionChanged",Y)};a.prototype.iFg=function(Y){this.addHandler("ACLBMatchedItem",Y)};a.prototype.qbj=function(Y){this.removeHandler("ACLBMatchedItem",Y)};a.prototype.j6f=function(Y){for(var qa=0;qa<Y.length;qa++){var fa=
Y.charCodeAt(qa);if(C.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?G.a.isLetter(fa):G.a.jod(fa))return!0}return!1};a.prototype.Cwa=function(){return!this.items};a.prototype.dispose=function(){if(this.$){this.tSa(!1);var Y=E.g(this.$);Y&&Y.view.Iq(this.$mc)}m.a.oc([this.CY,this.kNa]);m.a.oc(this.XZc);this.XZc=this.uwe=this.CY=this.Ya=null;ka.prototype.dispose.call(this)};a.prototype.Kh=function(Y,qa){var fa=!1;if(this.Awj())switch(qa){case -798660877:if(1===
this.items.length&&this.he)break;this.Jt.pB(1);this.raiseEvent("ACLBSelectionChanged",new r.a(this.items.length,this.Xbc(this.he),this.he));fa=this.Ny(!1);break;case 137938150:if(1===this.items.length&&this.he)break;this.Jt.pB(-1);this.raiseEvent("ACLBSelectionChanged",new r.a(this.items.length,this.Xbc(this.he),this.he));fa=this.Ny(!1);break;case 2091832999:this.Jt.pB(this.MH-1);fa=this.Ny(!1);break;case 742457698:this.Jt.pB(-(this.MH-1));fa=this.Ny(!1);break;case 125627505:this.Ya.textBox.caretPosition=
this.Ya.text.length;this.isListVisible=!1;fa=!0;break;case 267796030:this.Ny(!0);break;default:fa=ka.prototype.Kh.call(this,Y,qa)}return fa};a.prototype.show=function(){this.items&&this.items.length&&(this.CY.Pk=this.he?this.Jt.Gn.rows[this.Xbc(this.he)]:null,this.isListVisible=0<this.CY.pq.length,this.xBa(!0),this.CY.Qxa())};a.prototype.zLg=function(Y){var qa=!!this.Ya&&!N.f(this.$.pa);this.Ndc=this.Nva=!1;this.Ya&&!this.Ya.isEditing?this.set_visible(!1):qa&&!this.obh(this.activeCell)&&this.dAj(Y)};
a.prototype.obh=function(Y){return!!this.dataValidationControl&&this.dataValidationControl.n6c(Y)};a.prototype.Ny=function(Y){if(!this.Ya||!this.isListVisible)return!1;var qa=this.LCa;if(this.he){var fa=M.DOMElementExtensions.oZ(M.DOMElementExtensions.Cj(this.CY.Pk,c.ZZc),z.a.Roe,""),ha=fa.substring(qa.length,fa.length);Y?this.Ya.text=fa:this.Ya.insertTextAt(ha,qa.length,this.Ya.text.length)}fa=E.g(this.$);fa.sj&&(fa=fa.Wb,fa.text=this.Ya.text,fa.setCaretPosition(this.Ya.textBox.caretPosition));Y?
this.isListVisible=!1:this.Ya.textBox.selectRange(qa.length,this.Ya.text.length);return!0};a.prototype.Xbc=function(Y,qa){qa=void 0===qa?!1:qa;if(!this.CY.Gn)return-1;for(var fa=this.CY.Gn.children[0],ha=fa.children.length,ia,wa=0;wa<ha;++wa)if(ia=fa.children[wa],G.a.equals(ia.innerText.trim(),Y,qa))return wa;return-1};a.prototype.rAg=function(Y,qa,fa,ha,ia,wa,Qa){var S=fa.originalText.replace(a.prf,String.fromCharCode(32)),da=new O.Range(Y.top-1,Y.left,Y.bottom-1,Y.right,!1,!1),xa=Qa?Qa.Xm(fa.range):
null;(!fa.dF||fa.range.left===Y.left)&&1<S.length&&!ha.kb(S.toUpperCase())&&G.a.cL(S,qa)&&!G.a.equals(S,qa,!0)&&!a.WSe(qa)&&this.j6f(S)&&(!ia&&!xa||!ia&&xa.equals(Qa.Xm(da))||ia&&fa.range.xd(wa)&&fa.range.top!==wa.top)&&(Y=fa.formulaBarText,G.a.equals(Y,fa.text,!1)||!Y)&&(Y={},Y.FirstRow=fa.range.top-1,Y.FirstColumn=fa.range.left-1,fa=new e(S,Y),ha.add(S.toUpperCase(),fa))};a.prototype.dAj=function(Y){this.$p=this.eYh();this.kNa&&this.kNa.cancel();0<this.Ya.text.length&&0!==Y?this.items&&((1<this.items.length||
this.isListVisible)&&this.Whh(),8!==Y&&127!==Y&&46!==Y&&(1===this.items.length?this.fkd(!1):this.CY.Pk&&this.Ny(!1))):this.isListVisible=!1};a.prototype.Whh=function(){this.isListVisible?this.TIe():this.w$d=Q.AsyncMethodContext.Ps(this.TIe,500,ca.a.oVg,this.kNa)};a.prototype.fkd=function(Y){l.ULS.shipAssertTag(537167966,0,!this.Cwa()&&1===this.items.length,"Invalid Items");var qa=this.items[0].Zra,fa=this.Ya.text,ha=qa.substring(fa.length,qa.length);if(Y&&!ha.length)this.Ya.text=qa;else if(!Y&&0<
ha.length)this.Ya.appendText(ha),this.Ya.textBox.selectRange(fa.length,this.Ya.text.length);else return;this.raiseEvent("ACLBMatchedItem",new r.a(this.items.length,0,qa));this.Nva=!0};a.prototype.eYh=function(){this.$p=null;var Y=new X.a(!1),qa=this.activeCell;this.LCa=this.Ya.text.replace(a.prf,String.fromCharCode(32));var fa=this.tableManager.Xm(qa),ha=qa.xd(fa);if(a.WSe(this.LCa)||!this.j6f(this.LCa))return this.items;var ia=new O.Range(1,qa.left,qa.top-1,qa.left,!1,!1),wa=new O.Range(qa.top+1,
qa.left,w.a.vh,qa.left,!1,!1),Qa=E.g(this.$);wa=Qa.pk("CellAutoCompleteControl.GetSuggestedCells",wa);try{var S=Qa.pk("CellAutoCompleteControl.GetSuggestedCells2",ia);try{for(var da=ak([S,wa]),xa=da.next();!xa.done;xa=da.next())for(var ta=xa.value;ta.$$mn();){var ab=ta.$$cu();this.rAg(qa,this.LCa,ab,Y,ha,fa,this.tableManager)}}finally{S&&S.dispose()}}finally{wa&&wa.dispose()}this.$p=Array(Y.values.length);for(qa=0;qa<this.items.length;qa++)this.items[qa]=Y.values[qa];this.items.sort(function(Na,Ka){return Na.Zra.localeCompare(Ka.Zra)});
return this.items};a.prototype.fob=function(Y,qa){Y&&qa&&this.XZc.push(new d(Y,qa,this.Ccf?this:void 0))};a.prototype.Awj=function(){return this.ofi?this.A0a&&!this.Cwa()&&this.isListVisible?this.get_visible():!1:this.A0a&&!this.Cwa()&&this.get_visible()&&this.isListVisible};a.WSe=function(Y){Y=0<Y.length?Y.charCodeAt(0):-1;return 35===Y||61===Y||43===Y||45===Y||64===Y};Af.Object.defineProperties(a.prototype,{Jt:{configurable:!0,enumerable:!0,get:function(){return this.CY}},A0a:{configurable:!0,enumerable:!0,
get:function(){return this.LCa}},he:{configurable:!0,enumerable:!0,get:function(){return this.CY.he}},items:{configurable:!0,enumerable:!0,get:function(){return this.$p}},kNa:{configurable:!0,enumerable:!0,get:function(){return this.w$d}},activeCell:{configurable:!0,enumerable:!0,get:function(){return E.g(this.$).ha.sa.activeCell}},dataValidationControl:{configurable:!0,enumerable:!0,get:function(){return this.M3d||(this.M3d=this.$.da.za(14))}}});Af.Object.defineProperties(a,{prf:{configurable:!0,
enumerable:!0,get:function(){return a.dbe||(a.dbe=new RegExp(String.fromCharCode(160),"g"))}}});a.dbe=null;Object(u.a)(a,"CellAutoCompleteControl",f.a,[532,526,533,10])},1430:function(u,D,b){function a(){Type.registerNamespace("CAUI");c.main()}function c(){}function d(E,I,U,M){var T=this;this.N1d=this.f1=this.Hi=this.DD=this.n8=null;this.zWb=E;this.Vvg=M;this.zWb.DLa&&(this.Hi=new v.a(3,2,5E3,Object(w.a)(this,this.CMg,"authenticationCheckTask"),2),n.AFrameworkApplication.Bi.Eg(this.Hi),this.Cg(I,
U));this.zWb.Tmb(function(){T.utf()});this.zWb.lYa(function(){T.vtf()})}function e(){}u=b(0);var k=b(631),l=b(625),m=b(622),f=b(1208);e.prototype.N8g=function(E,I){if(E&&!(1>E.length)&&I){var U=Object.assign(new m.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.m6g(E,U.ControlList);I.push(U)}};e.prototype.m6g=function(E,I){var U=Object.assign(new k.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new l.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,
ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(I,U);I=Object.assign(new m.a,{Title:"",ControlList:[]});Array.add(U.Menu.MenuSectionList,I);this.t8g(E,I.ControlList)};e.prototype.t8g=function(E,I){for(var U=0;U<E.length;U++){var M=Object.assign(new f.a,{ExternalId:String.format("CoauthorPersona_{0}",U),Command:"336231556",DisplayName:E[U].userName,LabelText:E[U].userName,ImageBackColor:E[U].color,PersonaId:E[U].email,IsAnonymous:E[U].isAnonymous});Array.add(I,M)}};Object(u.a)(e,"PresenceContextMenuSectionBuilder",
null,[377]);var w=b(83),n=b(4),z=b(181),r=b(623),v=b(108),A=b(135),B=b(90),y=b(84),x=b(107),C=b(27);d.prototype.Cg=function(E,I){var U=n.AFrameworkApplication.ub;U.Ie(C.a.authenticationLost,x.a.frame,E,96);U.Ie(C.a.gse,x.a.frame,I,96);U.Mb(C.a.bwe,x.a.frame,z.ActionManager.h6c);U.Mb(C.a.cwe,x.a.frame,z.ActionManager.h6c);U.Mb(C.a.isd,x.a.frame,z.ActionManager.h6c)};d.prototype.utf=function(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);n.AFrameworkApplication.ub.processAction(C.a.authenticationLost,
2)};d.prototype.vtf=function(){this.RHj();n.AFrameworkApplication.ub.processAction(C.a.gse,2)};d.prototype.CMg=function(){this.zWb.authenticationCheck()};d.prototype.RHj=function(){this.DD&&(this.DD.hide(),this.DD.dispose(),this.DD=null);this.n8&&this.businessBar&&(n.AFrameworkApplication.Bg||this.businessBar.removeEntry(this.n8),this.n8.dispose(),this.n8=null)};d.prototype.showDialog=function(E){B.a.Ia(this.DD);this.DD=new A.StandardDialog;this.Vvg||(this.DD.Qu=!1,this.DD.Rb=0);this.DD.mc(1,CommonUIStrings.l_SignIn);
this.DD.dX(CommonUIStrings.l_DefaultDialogTitle,E,Object(w.a)(this,this.Xv,"dialogHandler"))};d.prototype.Xv=function(E){1===E?(r.a.v6(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),n.AFrameworkApplication.ub.processAction(C.a.isd,2)):(this.XQd(),n.AFrameworkApplication.ub.processAction(C.a.cwe,2))};d.prototype.XQd=function(){this.businessBar&&this.mue&&(this.n8=this.mue.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),
this.n8.closeable=!0,this.n8.addButton(CommonUIStrings.l_SignIn,d.ZRg,""),this.n8.t$=Object(w.a)(this,this.bSg,"businessBarEntryCloseHandler"),this.businessBar.VD(this.n8,!1))};d.prototype.bSg=function(){this.sfh();n.AFrameworkApplication.ub.processAction(C.a.bwe,2)};d.prototype.sfh=function(){this.Hi&&(n.AFrameworkApplication.Bi.Ip(this.Hi),this.Hi=null)};d.prototype.dispose=function(){this.Hi=this.DD=this.n8=null};d.ZRg=function(){r.a.v6();n.AFrameworkApplication.ub.processAction(C.a.isd,2)};Af.Object.defineProperties(d.prototype,
{businessBar:{configurable:!0,enumerable:!0,get:function(){return this.f1||(this.f1=y.a.instance.nh("CommonUI.IBusinessBar"))}},mue:{configurable:!0,enumerable:!0,get:function(){return this.N1d||(this.N1d=y.a.instance.nh("CommonUI.IBusinessBarEntryFactory"))}}});Object(u.a)(d,"SignOutResponseUI",null,[10]);var G=b(257);c.prototype.Sh=function(E){E.register(e,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").tc()};c.prototype.init=function(){};
c.prototype.dispose=function(){B.a.Ia(c.R1);c.R1=null};c.main=function(){G.a.instance.Ui(new c)};Af.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.UI"}}});c.R1=null;Object(u.a)(c,"CommonAppUIPackage",null,[3,4]);b.d(D,"a",function(){return a})},1431:function(u,D,b){function a(){B.a.Fa(e.ka);B.a.Fa(c.ka)}function c(y){var x=A.call(this)||this;x.$=y;x.Eb();return x}function d(y,x){var C=this;this.sZa=null;this.sAf=function(G,E){1<E.length&&
(G=v.a.instance.ga(856),C.ariaLiveNotifier.tLf(G,E.length))};this.tAf=function(G,E){r.ULS.shipAssertTag(537167961,0,0<=E.selectedIndex&&0<=E.length&&E.selectedIndex<E.length,"Invalid ListEventArgs: SelectedIndex/Length");r.ULS.shipAssertTag(537167960,0,!!E.OF,"ListEventArgs: SelectedValue should not be null");C.ariaLiveNotifier.B5i(E.OF,E.selectedIndex+1,E.length)};this.uAf=function(G,E){C.ariaLiveNotifier.zPa(E.OF)};this.ariaLiveNotifier=y;w.EwaSettings.xl()||x.Ga(213,this)}function e(y){var x=z.call(this)||
this;x.$=y;x.Eb();return x}u=b(0);var k=b(232),l=b(1422),m=b(51),f=b(37),w=b(1),n=b(962),z=k.a;Rk(e,z);e.prototype.create=function(){var y=this,x=this.$.da,C=m.GetServiceTaskFactory.create(x,134,this.la,this.hb),G=m.GetServiceTaskFactory.Ra(x,213,214,this.hb);f.TaskExtensions.Ba(f.TaskExtensions.Wd([C,G],this.la),function(){if(w.EwaSettings.xl())y.pb(Object(n.a)(y.$.da,1,function(){var I=new l.CellAutoCompleteControl(y.$,C.result);G.result.ka(I);return I}));else{var E=x.za(1);E||(E=new l.CellAutoCompleteControl(y.$,
C.result),G.result.ka(E));y.pb(E)}},this.la,3)};e.ka=function(y){y.da.Ga(151,new e(y))};Object(u.a)(e,"CellAutoCompleteControlFactory",k.a,[]);var r=b(15),v=b(14);d.prototype.dispose=function(){this.eXd();this.sZa=null};d.prototype.ka=function(y){y&&(this.sZa=y,y.iZb(this.sAf),y.s2(this.tAf),y.iFg(this.uAf))};d.prototype.eXd=function(){this.sZa&&(this.sZa.zsc(this.sAf),this.sZa.ida(this.tAf),this.sZa.qbj(this.uAf))};Object(u.a)(d,"CellAutoCompleteReadoutHandler",null,[534,10]);var A=k.a;Rk(c,A);c.prototype.create=
function(){var y=this,x=this.$.da;f.TaskExtensions.Ba(m.GetServiceTaskFactory.Ra(x,211,212,this.hb),function(C){if(w.EwaSettings.xl())y.pb(Object(n.a)(x,213,function(){return new d(C.result,x)}));else{var G=x.za(213)||new d(C.result,x);y.pb(G)}},this.la,3)};c.ka=function(y){y.da.Ga(214,new c(y))};Object(u.a)(c,"CellAutoCompleteReadoutHandlerFactory",k.a,[]);var B=b(11);b.d(D,"a",function(){return a})},1432:function(u,D,b){function a(){k.a.Fa(function(X){X.ma(136)&&c.ka(X)})}function c(X){var Z=ca.call(this)||
this;Z.$=X;Z.Eb();return Z}function d(X,Z,ea,ka,Y){var qa=Q.call(this)||this;qa.HO=null;qa.i0=null;qa.mFa=null;qa.Iuc=null;qa.tNc=null;qa.iXa=null;qa.sde=0;qa.mEc=!1;qa.Kfc=!1;qa.LBb=!1;qa.vg=function(){qa.hwa&&(qa.gridView?1===qa.gridView.ha.Qe?(qa.gridView.ha.sa.activeCell.equals(qa.mFa)||qa.YM||qa.Px(),qa.aob.Kq()):qa.Px():z.ULS.shipAssertTag(537154141,0,!1,"GridView is null during selection"))};qa.Gh=function(){qa.Px()};qa.Yc=function(){qa.bX()};qa.Fc=function(){qa.Px()};qa.$c=function(){qa.showCallout()};
qa.kya=function(){if(qa.Jg.Hk&&qa.Jg.Hk.length)if(qa.zYc)qa.Jg.fti||(qa.mEc=qa.Jg.Hk[0].BlockingDataForExpand),qa.Jg.RNh&&z.ULS.sendTraceTag(537154140,0,50,"User clicked pullout launch button before fieldInfo web service returned"),qa.sde=qa.Jg.k4c&&qa.Jg.yUe<qa.Jg.k4c.left-1?qa.Jg.k4c.left-1-qa.Jg.yUe:-1,qa.showCallout();else if(qa.gridView.ha.sa.tg){var fa=qa.gridView.ha.sa.activeCell;if(fa&&qa.i0){var ha=qa.tableManager.Xm(fa);qa.gLc=!!ha;var ia=qa.gridView.ha.sa.Vc;ha=qa.YM&&qa.i0.xd(ha);var wa=
qa.Zgd&&!qa.YM&&ia.equals(qa.selectedRange);ha||wa?(z.ULS.sendTraceTag(39662912,0,50,"Field TableWidget shown on grid"),qa.f9b=!0,n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&!qa.YM&&qa.tableManager.iva(fa)?z.ULS.shipAssertTag(537154139,0,!1,"PulloutManager:OnFieldInfoListContextLoaded fetch rich fields for a cell on PivotTable range"):(n.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?qa.YM?qa.Mh.BAa(qa.i0,
qa.YM):qa.Mh.BAa(ia,qa.YM):qa.Mh.BAa(qa.i0,qa.YM),qa.stc())):z.ULS.shipAssertTag(537154138,0,!1,"PulloutManager:OnFieldInfoListContextLoaded FAILURE")}}};qa.Ri=function(){qa.o6a()&&qa.Mh.hide();1===qa.gridView.ha.Qe&&qa.bX()};qa.pR=function(){var fa=qa.gridView.ha.Qe;qa.gridView.ha.sa.activeCell&&1===fa&&qa.bX()};qa.$s=function(){if(n.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds"))if(qa.YM){if(qa.i0&&qa.mFa){var fa=qa.tableManager.Xm(qa.mFa);
fa&&1<fa.bottom-fa.top&&(--fa.bottom,qa.gridView.d5(fa)&&qa.aob.Kq())}}else qa.gridView.ha.sa.tg&&qa.gridView.d5(qa.gridView.ha.sa.Vc)&&qa.aob.Kq();else qa.i0&&qa.mFa&&qa.YM&&(fa=qa.tableManager.Xm(qa.mFa))&&1<fa.bottom-fa.top&&(--fa.bottom,qa.gridView.d5(fa)&&qa.aob.Kq())};qa.bX=function(){if(qa.$&&qa.gridView){if(qa.f9b&&qa.YM){var fa=qa.gridView.ha.sa.activeCell;qa.i0=qa.ESe();var ha=!!qa.Iuc&&qa.Iuc.contains(fa);if(qa.i0&&(fa.equals(qa.mFa)||ha)){qa.Mh.BAa(qa.i0,qa.YM);return}}qa.f9b=!1;qa.i0=
qa.ESe();qa.i0&&qa.vla&&qa.gridView&&qa.gridView.Ea.Mr(qa.vla)?(qa.zYc=!1,qa.qZ()):(qa.Jg.uZc(),qa.Jg.p1b());qa.f9b||qa.Mh.hide()}};qa.$=X;qa.tableManager=ea;qa.contextMenuManager=ka;qa.Mh=new e(X,qa.$c,Z,Y);qa.Jg=Z.S2c(X,ea);qa.zYc=!1;qa.f9b=!1;qa.Zgd=n.EwaSettings.ma(136);qa.gLc=!0;qa.rKc=!1;qa.gridView=T.g(qa.$);qa.gridView.Wb.Bk(qa.Gh);qa.gridView.Ft(qa.pR);qa.$.Tk(qa.Yc);qa.$.Ck(qa.Fc);qa.$.xA(qa.Ri);qa.gridView.view.Gs(qa.$s);qa.gridView.ha.sP(qa.vg);qa.aob=E.a.instance.create(qa.bX,250,I.a.X1i);
z.ULS.sendTraceTag(537154143,0,50,"Feature TableWidget enabled");qa.Jg.aZb(qa.kya);N.a.tyb()&&(qa.Kfc=!0);qa.bX();X.da.Ga(261,qa);return qa}function e(X,Z,ea,ka){var Y=O.call(this)||this;Y.isMac=F.a.isMac;Y.$=X;Y.ariaLiveNotifier=ka;Y.Dp=ea.w4b(X,null,Z,K.a.Osh,J.a.Te(9),M.a.instance.ga(1716),"PulloutPointerDown");return Y}var k=b(11);u=b(0);var l=b(241),m=b(232),f=b(51),w=b(37),n=b(1),z=b(15),r=b(90),v=b(4),A=b(79),B=b(8),y=b(24),x=b(64),C=b(45),G=b(151),E=b(47),I=b(44),U=b(12),M=b(14),T=b(21),F=
b(25),K=b(18),J=b(53),O=A.a;Rk(e,O);e.prototype.dispose=function(){this.Dp.dispose();this.$=null;O.prototype.dispose.call(this)};e.prototype.domElement=function(X){return this.Dp.domElement(X)};e.prototype.getButton=function(X){return this.Dp.getButton(X,!1)};e.prototype.iOb=function(X,Z){this.Dp.iOb(X,Z,!1)};e.prototype.BAa=function(X,Z){var ea=T.g(this.$),ka=ea.eb.gj(X);this.Dp.iOb(Z?M.a.instance.ga(1716):M.a.instance.ga(1717),ka);Z=this.isMac?Z?M.a.instance.ga(1720):M.a.instance.ga(1721):Z?M.a.instance.ga(1718):
M.a.instance.ga(1719);var Y=ea.gg(X,ka);X=ea.Ef(ka).jn;if(Y&&0<=Y.x&&0<=Y.y){var qa=Y.bottomRight.x+this.jz;Y=Y.topLeft.y-this.jz-this.buttonWidth;if(Y<X.topLeft.y+this.jz){if(ea.eb.USa){this.hide();return}Y=X.topLeft.y+this.jz}this.np(qa,Y,ea.rtl,ka);this.ariaLiveNotifier.zPa(Z)}else this.hide()};e.prototype.np=function(X,Z,ea,ka){this.Dp.np(X,Z,ea,ka,!1)};e.prototype.hide=function(){this.Dp.hide()};Af.Object.defineProperties(e.prototype,{jz:{configurable:!0,enumerable:!0,get:function(){return this.Dp.jz}},
buttonWidth:{configurable:!0,enumerable:!0,get:function(){return this.Dp.buttonWidth}}});Object(u.a)(e,"PulloutLaunchButton",A.a,[]);var N=b(36),H=b(22),Q=A.a;Rk(d,Q);d.prototype.dispose=function(){this.gridView&&(this.gridView.ha.zW(this.vg),this.gridView.view.Iq(this.$s),this.gridView.Wb&&this.gridView.Wb.wk(this.Gh));if(this.$){var X=this.$;X.ol(this.Yc);X.Ol(this.Fc);X.kD(this.Ri);T.g(X).Fw(this.pR)}this.Jg&&this.Jg.rsc(this.kya);r.a.Ia(this.Mh);this.Jg=this.$=this.gridView=this.aob=this.Mh=null;
Q.prototype.dispose.call(this)};d.prototype.Px=function(){this.Mh.hide()};d.prototype.pda=function(){this.Mh?this.Mh.getButton(this.rea).tbb():z.ULS.sendTraceTag(537154142,0,15,"PulloutManager.ResetButtonAppearance: launchButton is null.")};d.prototype.agj=function(){this.i0=null};d.prototype.DIf=function(){this.Mh&&this.Mh.hide()};d.prototype.f_h=function(){if(!this.Zgd||1!==this.selectedRange.width)return null;for(var X=this.selectedRange.clone();this.gridView.d5(X);){X.left+=1;X.right+=1;if(!this.gridView.Ef(this.gridView.eb.gj(X)).Ug.Ae(X))break;
if(this.gridView.Ea.Mr(X)){var Z=this.gridView.pk("PulloutManager.GetValidatedRangeToFill",X,2);try{if(d.bVj(Z))return X}finally{Z&&Z.dispose()}}}return null};d.prototype.stc=function(){this.Jg.vbb()};d.prototype.showCallout=function(){var X=this;this.hwa&&(this.Jg.U5a?(this.Mh.getButton(this.rea).QFb(),n.EwaSettings.xl()?w.TaskExtensions.Ba(f.GetServiceTaskFactory.Ra(this.$.da,8,9,0),function(Z){X.n2f(Z.result)},this.$.la,3):this.n2f(this.contextMenuManager)):(this.zYc=!0,this.qZ()))};d.prototype.n2f=
function(X){X.Icd("tableFieldList").y0(null,this.Mh.domElement(this.rea),this.Jg,null,!0);this.stc()};d.prototype.ESe=function(){if(!this.hwa||!this.gridView||this.gridView.ha.Oa.Yb||!this.gridView.ha.sa.tg)return null;var X=this.gridView.ha.sa.activeCell,Z=T.g(this.$).eb.gj(X);if(!X)return null;this.mFa=X.clone();var ea=this.tableManager.Xm(X);this.gLc=!!ea;if(this.YM){this.Mh.iOb(M.a.instance.ga(1716),Z);this.HO=d.Ieg(ea);if(!this.HO)return null;Z=this.tableManager.QBe(ea,this.gridView);X=Z.vY;
Z=Z.returnValue||X;this.mEc=X;if(Z)return this.Iuc=new y.Range(ea.top,ea.left,ea.bottom,ea.right,!1,!1),this.tNc=new y.Range(this.HO.top,this.HO.right+1,this.HO.top,this.HO.right+1,!1,!1),this.HO}else if(this.Zgd){this.Mh.iOb(M.a.instance.ga(1717),Z);this.iXa=this.gridView.ha.sa.Vc.clone();ea=T.g(this.$).Ab.Vwa(this.selectedRange);(Z=this.selectedRange.isSingle&&T.g(this.$).Ab.Gbf(this.selectedRange))&&!this.LBb&&n.EwaSettings.isChangeGateEnabled("OfficeVSO:6253558_DatePulloutExperimentTrigger")&&
H.a.equals(v.AFrameworkApplication.uiCulture,"en-us",!0)&&(v.AFrameworkApplication.p_("XLS-DateSuggestion-Treatment;XLS-DateSuggestion-Control"),this.LBb=!0);this.HO=d.Ieg(this.selectedRange);if(!(this.Kfc&&Z||ea)||!this.HO||!this.selectedRange)return null;this.Kfc&&(this.rKc=Z&&!ea);if(n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&this.tableManager.iva(this.selectedRange))return null;this.tNc=this.f_h();if((n.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?
this.gridView.d5(this.selectedRange):this.gridView.d5(this.HO))&&this.vla)return this.Iuc=this.HO,ea=String.format("PulloutManager:FindSelection, NextRange, {0}, RightColumnHeader, {1}, ActiveCell, {2}",this.vla?this.vla.toString():"null",this.HO?this.HO.toString():"null",X?X.toString():"null"),z.ULS.sendTraceTag(537154137,0,50,ea),this.HO}return null};d.prototype.qZ=function(){this.YM?this.Jg.qZ(C.v(this.vla,this.$),!1,!0):this.Kfc&&this.rKc?this.Jg.VYi():n.EwaSettings.ma(136)&&this.Jg.qZ(C.v(this.selectedRange,
this.$),!0,!1)};d.prototype.o6a=function(){return this.$.ea.isNamedObjectViewMode&&x.f(this.$.pa)};d.bVj=function(X){for(;X.$$mn();)if(X.$$cu().text||X.$$cu().dF||X.$$cu().Qi||X.zn.e6e)return!1;return!0};d.Ieg=function(X){return X.right===B.a.Eh?null:new y.Range(X.top,X.right,X.top,X.right,!1,!1)};Af.Object.defineProperties(d.prototype,{jc:{configurable:!0,enumerable:!0,get:function(){return this.Mh.domElement(1)}},vla:{configurable:!0,enumerable:!0,get:function(){return this.tNc}},selectedRange:{configurable:!0,
enumerable:!0,get:function(){return this.iXa}},YM:{configurable:!0,enumerable:!0,get:function(){return this.gLc}},Imd:{configurable:!0,enumerable:!0,get:function(){return this.rKc}},iJf:{configurable:!0,enumerable:!0,get:function(){return this.sde}},hBb:{configurable:!0,enumerable:!0,get:function(){var X=this.Mh.domElement(this.rea);return X?U.DOMElementExtensions.isVisible(X):!1}},hwa:{configurable:!0,enumerable:!0,get:function(){return this.$.isEditMode&&n.EwaSettings.ma(136)?!(new G.a(this.$.va)).ij:
!1}},LHg:{configurable:!0,enumerable:!0,get:function(){return this.mEc}},rea:{configurable:!0,enumerable:!0,get:function(){return this.vla?this.gridView.eb.gj(this.HO):1}}});Object(u.a)(d,"PulloutManager",A.a,[759,10]);var ca=m.a;Rk(c,ca);c.prototype.create=function(){var X=this;k.a.Fa(function(Z){var ea=f.GetServiceTaskFactory.Ra(Z.da,12,477,X.hb),ka=f.GetServiceTaskFactory.Ra(Z.da,66,134,X.hb),Y=f.GetServiceTaskFactory.Ra(Z.da,211,212,X.hb),qa=l.a.Ua(null),fa=!n.EwaSettings.xl();fa&&(qa=f.GetServiceTaskFactory.Ra(Z.da,
8,9,X.hb));w.TaskExtensions.Ba(w.TaskExtensions.Wd([ea,ka,qa,Y],Z.la),function(){fa?X.pb(X.$.da.za(261)||new d(X.$,ea.result,ka.result,qa.result,Y.result)):X.pb(X.$.da.za(261)||new d(X.$,ea.result,ka.result,null,Y.result))},Z.la)})};c.ka=function(X){X.da.Ga(262,new c(X))};Object(u.a)(c,"PulloutManagerFactory",m.a,[]);b.d(D,"a",function(){return a})},1442:function(u,D,b){function a(r,v,A){A=void 0===A?null:A;this.Ilb=this.Qlb=null;this.b1=-1;this.Vj=r;this.hga=(void 0===v?null:v)||new k.a;this.Xwg=
A||new e;this.PEa=new k.a;r=0;v=ak(this.hga);for(A=v.next();!A.done;A=v.next()){A=A.value;this.Kqd(this.b1)||(this.b1=r);var B=r++;this.PEa.add(new c(document.createElement("li"),A.title,this.Z5g(B)))}}function c(r,v,A){this.Vj=r;this.Ap=v;this.UFc=A;this.tfa=document.createElement("a");n.a.Kvc(this.tfa,this.Ap);Sys.UI.DomElement.addCssClass(this.tfa,d.lHj);Sys.UI.DomElement.addCssClass(this.Vj,d.kHj);this.Vj.appendChild(this.tfa);this.tfa.tabIndex=0;this.aBc();m.a.addHandler(this.Vj,"click",this.UFc);
m.a.addHandler(this.Vj,"keyup",Object(l.a)(this,this.O9a,"onTitleKeyUp"))}function d(){}function e(){}u=b(0);var k=b(202);e.prototype.QGj=function(r,v){r.set_visible(!1);v.set_visible(!0)};Object(u.a)(e,"DefaultTabSwitchBehaviour",null,[687]);d.DHj="TabsContainer";d.mHj="TabTitlesContainer";d.kHj="TabTitle";d.lHj="TabTitleText";d.mUd="TabTitleActive";Object(u.a)(d,"MultitabControlStyles",null,[]);var l=b(83),m=b(43),f=b(86),w=b(89),n=b(55);c.prototype.dispose=function(){m.a.removeHandler(this.Vj,
"keyup",Object(l.a)(this,this.O9a,"onTitleKeyUp"));m.a.removeHandler(this.Vj,"click",this.UFc);this.Vj=this.tfa=null};c.prototype.setActive=function(r){r?Sys.UI.DomElement.addCssClass(this.Vj,d.mUd):Sys.UI.DomElement.removeCssClass(this.Vj,d.mUd);this.tfa&&this.tfa.setAttribute(w.a.Xga,r)};c.prototype.O9a=function(r){r.keyCode!==f.a.Rh&&r.keyCode!==f.a.Eoa||this.UFc(r)};c.prototype.aBc=function(){this.Vj.setAttribute(w.a.Hd,w.a.Is);this.tfa.setAttribute(w.a.Gt,this.Ap);this.tfa.setAttribute(w.a.Hd,
w.a.Tnb)};Af.Object.defineProperties(c.prototype,{jc:{configurable:!0,enumerable:!0,get:function(){return this.Vj}},title:{configurable:!0,enumerable:!0,get:function(){return this.Ap}},isActive:{configurable:!0,enumerable:!0,get:function(){return Sys.UI.DomElement.containsCssClass(this.Vj,d.mUd)},set:function(r){this.setActive(r)}}});Object(u.a)(c,"TabTitleControl",null,[10]);var z=b(39);b.d(D,"a",function(){return a});a.prototype.sQf=function(){this.Qlb=document.createElement("ul");this.Qlb.className=
d.mHj;this.Ilb=document.createElement("div");this.Ilb.className=d.DHj;for(var r=0;r<this.bzc;++r){var v=this.hga.na(r),A=this.PEa.na(r);v.set_visible(!1);A.isActive=!1;var B=document.createElement("div");v.render(B);this.Ilb.appendChild(B);this.Qlb.appendChild(A.jc)}this.jc.appendChild(this.Qlb);this.jc.appendChild(this.Ilb);this.Kqd(this.b1)&&(this.PEa.na(this.b1).isActive=!0,this.hga.na(this.b1).set_visible(!0))};a.prototype.dispose=function(){for(var r=0;r<this.bzc;++r)this.hga.na(r).dispose(),
this.PEa.na(r).dispose();this.PEa=this.hga=this.Vj=this.Ilb=this.Qlb=null};a.prototype.setFocus=function(){this.hga.na(this.b1).setFocus()};a.prototype.Kqd=function(r){return 0<=r&&r<this.bzc};a.prototype.o7f=function(r){this.b1!==r&&this.Kqd(r)&&(this.Xwg.QGj(this.hga.na(this.b1),this.hga.na(r)),this.PEa.na(this.b1).isActive=!1,this.PEa.na(r).isActive=!0,this.b1=r,this.setFocus())};a.prototype.Z5g=function(r){var v=this;return function(){v.o7f(r)}};Af.Object.defineProperties(a.prototype,{bzc:{configurable:!0,
enumerable:!0,get:function(){return this.hga.count}},activeTab:{configurable:!0,enumerable:!0,get:function(){return this.b1},set:function(r){this.o7f(r)}},jc:{configurable:!0,enumerable:!0,get:function(){return this.Vj}},visible:{configurable:!0,enumerable:!0,get:function(){return z.a.isVisible(this.Vj)},set:function(r){this.Vj.style.visibility=r?"visible":"hidden"}}});Object(u.a)(a,"MultitabControl",null,[678,10])},1454:function(u,D,b){function a(){e.a.Fa(function(z){c.ka(z)})}function c(z){var r=
n.call(this)||this;r.Ckj="formulaAssistance";r.$=z;r.Eb();return r}function d(){this.isFeedbackAllowed=!1;this.zoomLevel=0}var e=b(11);u=b(0);var k=b(7),l=b(232),m=b(51),f=b(37);Object(u.a)(d,"FormulaAssistanceUIContext",null,[]);var w=b(259),n=l.a;Rk(c,n);c.prototype.create=function(){var z=this,r=this.$.da.za(448);if(r)this.pb(r);else{var v=m.GetServiceTaskFactory.Ra(this.$.da,283,284,this.hb);f.TaskExtensions.Ba(v,function(){f.TaskExtensions.Ba(w.c(v.result.tn.loadScript(z.Ckj)),function(){r=z.$.da.za(448);
if(!r){var A=Object(k.a)(new d,{isFeedbackAllowed:z.$.isFeedbackEnabled});r=z.$.da.Ga(448,formulaAssistance.FormulaAssistanceUIFactoryGlobal.create(A));z.$.kxe(function(){var B={};B.isFeedbackAllowed=z.$.isFeedbackEnabled;r.updateContext(B)})}z.pb(r)},z.$.la,3)},this.$.la,3)}};c.ka=function(z){z.da.Ga(449,new c(z))};Object(u.a)(c,"FormulaAssistanceUIControlFactory",l.a,[]);b.d(D,"a",function(){return a})},1455:function(u,D,b){function a(){e.a.Fa(c.ka)}function c(C){var G=x.call(this)||this;G.$=C;
G.Eb();return G}function d(C,G){var E=this;this.ZMa=1;this.vga=[];this.active=!1;this.uw=function(){var I=E.gridView.qgd();if(!(0>=I||I===E.ZMa||E.gridView.lp)){for(var U=!1,M=[],T=[],F=E.vga.length-1;0<=F;F--){var K=E.vga[F];if(E.pgd(K)>I||K.bottom<I)M.push(K),Array.removeAt(E.vga,F),U=!0}for(F=E.tableManager.rangeList.length-1;0<=F;F--){K=E.tableManager.rangeList[F];var J=E.pgd(K);J<=I&&K.bottom>=I&&!(J<=E.ZMa&&K.bottom>=E.ZMa)&&K.Yaa&&(T.push(K),U=!0)}if(U)for(K=A.EwaSettings.isChangeGateEnabled("OfficeVSO:6336710_ApplyHeaderSnappingOnVerticalFreezePane")?
E.gridView.bpc:[E.gridView.U2],F=ak(K),K=F.next();!K.done;K=F.next())for(J=ak(K.value),K=J.next();!K.done;K=J.next()){var O=ak(K.value);for(K=O.next();!K.done;K=O.next()){for(var N=K.value,H=N.Fn,Q=B.a(N.r4),ca=M.length-1;0<=ca;ca--)K=M[ca],E.Uzc(K,!1,Q,H)&&Array.removeAt(M,ca);for(ca=T.length-1;0<=ca;ca--)K=T[ca],E.Uzc(K,!0,Q,H)&&E.vga.push(K);U&&N.aOd(Q)}}else w.ULS.sendTraceTag(537157657,0,50,"HeaderSnappingFeature:OnVisibleAreaChanged: detected an opportunity for bailing out");E.ZMa=I}};this.Axf=
function(I,U){U.isRow||U.gVc(E.KKa)};this.Bxf=function(I,U){U.isRow||(E.tableManager.rangeList.length||E.deactivate(),U.bJd(E.KKa))};this.KKa=function(I,U){if(E.Vd())E.activate();else if(I=E.active,E.deactivate(),!I){w.ULS.sendTraceTag(537157652,0,50,"HeaderSnappingFeature:HeaderBlockOnUpdatedBlockHtml: detected an opportunity for bailing out");return}(U=U.Wt)&&E.C4f(U.Fn[0],U.Fn[U.Fn.length-1],U.r4,U.Fn)};this.mAf=function(I,U){!E.gridView.lp&&(E.Vd()?E.activate():(I=E.active,E.deactivate(),I||w.ULS.sendTraceTag(537157651,
0,50,"HeaderSnappingFeature:OnRangeListUpdated: detected an opportunity for bailing out")),U=U.Wt)&&(I=B.a(U.r4),E.C4f(U.Fn[0],U.Fn[U.Fn.length-1],I,U.Fn)&&U.aOd(I))};this.pe=function(){E.gridView.eb.p4?E.deactivate():E.activate()};this.tableManager=C;this.gridView=G;this.$=G.$;C.mne(this.mAf);G.SEg(this.Axf);G.TEg(this.Bxf);this.$.va.Kf(this.pe);this.$.vb.Kf(this.pe);this.Lqe(function(I){I.gVc(E.KKa)});this.Vd()&&(this.activate(),this.uw(this,null));this.$.da.Ga(68,this)}var e=b(11);u=b(0);var k=
b(232),l=b(51),m=b(37),f=b(21),w=b(15),n=b(31),z=b(219),r=b(24),v=b(64),A=b(1),B=b(1295),y=b(10);d.prototype.dispose=function(){var C=this;this.deactivate();this.gridView&&(this.tableManager.YPf(this.mAf),this.gridView.fbj(this.Axf),this.gridView.gbj(this.Bxf),this.$.va.wg(this.pe),this.$.vb.wg(this.pe),this.Lqe(function(G){G.bJd(C.KKa)}));this.gridView=this.tableManager=this.vga=null};d.prototype.Uzc=function(C,G,E,I){if(!v.b(this.$.pa)||this.$.ea.isNamedObjectViewMode||this.gridView.eb.USa)return!0;
if(!E.length)return!1;var U=I.length;if(I[U-1]<C.left)return!1;var M=y.HelperMethods.ox(new z.a(I),0,U,C.left,y.HelperMethods.TC);if(0>M)return!1;var T=C.e9f,F=!!C.UZa&&0<C.UZa.length,K=!!C.menuModel&&0<C.menuModel.length,J=M,O=0;for(U=Math.min(T.length+M,U);J<U;J++,O++)if(M=E[J],!A.EwaSettings.isChangeGateEnabled("OfficeVSO:5317457_ToggleHeaderSnapping_JSCrash_Fix")||M){var N=null,H=M.getElementsByClassName(n.a.n9c);H&&(N=H[0]);if(N&&N.innerText){if(H=M.getElementsByClassName(n.a.soe))for(var Q=
H.length-1;0<=Q;Q--)M.removeChild(H[Q]);H=I[J];G?(N.innerText=T[O],M.classList.add(n.a.LPe),F&&C.UZa[O]&&(N=document.createElement("div"),N.innerHTML=C.UZa[O],K&&C.menuModel[O]&&this.BBg(C,O,H),M.appendChild(N.firstChild))):(M.classList.remove(n.a.LPe),N.textContent=r.Range.MP(H),this.Xhh(H))}}C.Lna=G;return!0};d.prototype.BBg=function(C,G,E){this.$.da.Za(8,function(I){I.n9b.HMi(C,G,E)})};d.prototype.Xhh=function(C){this.$.da.Za(8,function(G){G.n9b.IMi(C)})};d.prototype.C4f=function(C,G,E,I){for(var U=
!1,M=this.GZh(C,G),T=this.vga.length-1;0<=T;T--){var F=this.vga[T];G>=F.left&&C<=F.right&&(this.Uzc(F,!1,E,I),Array.removeAt(this.vga,T),U=!0)}C=0;for(G=M.length;C<G;C++)this.Uzc(M[C],!0,E,I)&&(this.vga.push(M[C]),U=!0);return U};d.prototype.activate=function(){this.Vd()&&!this.active&&(this.gridView.view.Gs(this.uw),this.active=!0)};d.prototype.deactivate=function(){this.active&&(this.gridView.view.Iq(this.uw),this.active=!1)};d.prototype.Vd=function(){return v.b(this.$.pa)&&!this.$.ea.isNamedObjectViewMode&&
0>=this.gridView.eb.nL&&0<this.tableManager.rangeList.length};d.prototype.Lqe=function(C){var G=A.EwaSettings.isChangeGateEnabled("OfficeVSO:6336710_ApplyHeaderSnappingOnVerticalFreezePane")?this.gridView.bpc:[this.gridView.U2];G=ak(G);for(var E=G.next();!E.done;E=G.next()){E=ak(E.value);for(var I=E.next();!I.done;I=E.next()){I=ak(I.value);for(var U=I.next();!U.done;U=I.next())C(U.value)}}};d.prototype.GZh=function(C,G){var E=[];if(!this.active)return E;this.ZMa=this.gridView.qgd();for(var I=this.tableManager.rangeList.length-
1;0<=I;I--){var U=this.tableManager.rangeList[I];U.bottom>=this.ZMa&&this.pgd(U)<=this.ZMa&&U.left>=C&&U.right<=G&&U.Yaa&&E.push(U)}return E};d.prototype.pgd=function(C){var G=this.gridView.Ab.dk(C);return G&&this.tableManager.Xcf(C,G.usedRange.topLeft)?C.top+1:C.top};Object(u.a)(d,"HeaderSnappingFeature",null,[10]);var x=k.a;Rk(c,x);c.prototype.create=function(){var C=this,G=l.GetServiceTaskFactory.create(this.$.da,134,this.la,this.hb);m.TaskExtensions.Ba(m.TaskExtensions.Wd([G],this.la),function(){C.pb(C.$.da.za(68)||
new d(G.result,f.g(C.$)))},this.la,11)};c.ka=function(C){C.da.Ga(67,new c(C))};Object(u.a)(c,"HeaderSnappingFactory",k.a,[]);b.d(D,"a",function(){return a})},1480:function(u,D,b){function a(){l.a.Fa(function(G){c.ka(G)})}function c(G){var E=C.call(this)||this;E.y4b=null;E.$=G;E.Eb();return E}function d(G){this.a=G;this.preventDefault=d.uEf.preventDefault;this.stopPropagation=d.uEf.stopPropagation;var E=this.type=G.type.toLowerCase();this.rawEvent=G;this.altKey=G.altKey;"undefined"!==typeof G.button&&
(this.button="undefined"!==typeof G.which?G.button:4===G.button?Sys.UI.MouseButton.middleButton:2===G.button?Sys.UI.MouseButton.rightButton:Sys.UI.MouseButton.leftButton);"keypress"===E?this.charCode=G.charCode||G.keyCode:this.keyCode=G.keyCode&&46===G.keyCode?127:G.keyCode;this.clientX=G.clientX;this.clientY=G.clientY;this.ctrlKey=G.ctrlKey;this.target=G.target?G.target:G.srcElement;this.screenX=G.screenX;this.screenY=G.screenY;this.shiftKey=G.shiftKey}function e(){this._list={}}function k(){this._list=
{}}var l=b(11);u=b(0);var m=b(15),f=b(1084),w=b(25),n=b(214),z=b(232),r=b(223),v=b(1),A=b(50),B=b(58),y=b(259),x=b(36);k.prototype.addHandler=function(G,E){var I;this._list[G]=[].concat(yk(null!==(I=this._list[G])&&void 0!==I?I:[]),[E])};k.prototype.removeHandler=function(G,E){var I=this._list[G];void 0!==I&&(E=I.indexOf(E),0<=E&&(this._list[G]=[].concat(yk(I.slice(0,E)),yk(I.slice(E+1)))))};k.prototype.getHandler=function(G){var E=this._list[G];return E&&0!==E.length?function(I,U){for(var M=ak(E),
T=M.next();!T.done;T=M.next())T=T.value,T(I,U)}:null};k.kIb=function(){Sys.EventHandlerList.prototype.addHandler=k.prototype.addHandler;Sys.EventHandlerList.prototype.getHandler=k.prototype.getHandler;Sys.EventHandlerList.prototype.removeHandler=k.prototype.removeHandler};Object(u.a)(k,"EventHandlerListOptimized",null,[]);e.prototype.addHandler=function(G,E){this.fwa(G);void 0===this._list[G]?this._list[G]=[E]:this._list[G].push(E)};e.prototype.fwa=function(G){void 0!==this.fA&&this.fA.delete(G)};
e.prototype.removeHandler=function(G,E){var I=this._list[G];void 0!==I&&0!==I.length&&(E=I.indexOf(E),0<=E&&(this.fwa(G),I.splice(E,1)))};e.prototype.getHandler=function(G){void 0===this.fA&&(this.fA=new Map);var E=this.fA.get(G);return void 0===E?(E=this.eof(G),this.fA.set(G,E),E):E};e.prototype.eof=function(G){G=this._list[G];if(!G||0===G.length)return null;var E=[].concat(yk(G));return function(I,U){for(var M=0;M<E.length;++M)E[M](I,U)}};e.kIb=function(){Sys.EventHandlerList.prototype.addHandler=
e.prototype.addHandler;Sys.EventHandlerList.prototype.getHandler=e.prototype.getHandler;Sys.EventHandlerList.prototype.removeHandler=e.prototype.removeHandler;Sys.EventHandlerList.prototype.makeHandler=e.prototype.eof;Sys.EventHandlerList.prototype.invalidate=e.prototype.fwa};Object(u.a)(e,"EventHandlerListMemoized",null,[]);d.kIb=function(){Sys.UI.DomEvent=d;d.registerClass("Sys.UI.DomEvent",void 0,void 0)};Af.Object.defineProperties(d.prototype,{offsetX:{configurable:!0,enumerable:!0,get:function(){if(!this.type.startsWith("key")){if(void 0!==
this.rawEvent.offsetX)return this.rawEvent.offsetX;if(this.target&&3!==this.target.nodeType&&"number"===typeof this.clientX){var G=Sys.UI.DomElement.getLocation(this.target);return(Sys.UI.DomElement._getWindow(this.target).pageXOffset||0)+this.clientX-G.x}}}},offsetY:{configurable:!0,enumerable:!0,get:function(){if(!this.type.startsWith("key")){if(void 0!==this.rawEvent.offsetY)return this.rawEvent.offsetY;if(this.target&&3!==this.target.nodeType&&"number"===typeof this.clientY){var G=Sys.UI.DomElement.getLocation(this.target);
return(Sys.UI.DomElement._getWindow(this.target).pageYOffset||0)+this.clientY-G.y}}}}});d.addHandler=Sys.UI.DomEvent.addHandler;d.removeHandler=Sys.UI.DomEvent.addHandler;d._removeHandler=Sys.UI.DomEvent._removeHandler;d._clearHandlers=Sys.UI.DomEvent._clearHandlers;d._disposeHandlers=Sys.UI.DomEvent._disposeHandlers;d.uEf=Sys.UI.DomEvent.prototype;d.registerClass=function(G,E,I){this.prototype.constructor=this;this.__typeName=G;this.__class=!0;E&&(this.__baseType=E,this.__basePrototypePending=!0);
Sys.__upperCaseTypes[G.toUpperCase()]=this;if(I){this.__interfaces=[];for(var U=2,M=arguments.length;U<M;U++)this.__interfaces.push(arguments[U])}return this};Object(u.a)(d,"DomEventLazy",null,[493]);var C=z.a;Rk(c,C);c.prototype.create=function(){var G=this;m.ULS.sendTraceTag(537154643,0,50,"PluginSchedulerFactory.Create: Loading scheduler slice");f.a.then(this.B8g(),function(E){G.pb(E)})};c.prototype.B8g=function(){var G=this;if(this.y4b)return this.y4b;var E=r.a.BHa(A.b(),n.a.none,"LoadResource",
"x10Scheduler loading");if(v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNativeStartsWithEndsWith",!1)){var I=String.prototype;if(void 0===I.hTd||void 0===I.y7c)if(v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RetrieveOriginalStringUsingIFrameHack",!1)){var U=document.createElement("frame");document.body.appendChild(U);var M=U.contentWindow.String.prototype;document.body.removeChild(U);I.hTd=M.startsWith;I.y7c=M.endsWith}else I.hTd=function(T,F){F=void 0===F?0:F;return this.lastIndexOf(T,
F)===F},I.y7c=function(T){return-1!==this.indexOf(T,this.length-T.length)};I.startsWith=I.hTd;I.endsWith=I.y7c}v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseImmutableHandlers",!1)&&k.kIb();v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseMemoizedHandlers",!1)&&e.kIb();v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseLazyDomEvent",!1)&&d.kIb();if(v.EwaSettings.isChangeGateEnabled("OfficeVSO:5789323_disableSchedulerForIE")&&w.a.Vu)return I=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance(),
this.$.da.Ga(413,I),E.setResult(I),this.y4b=E.task;this.$.da.Za(266,function(T){v.EwaSettings.isChangeGateEnabled("OfficeVSO:6600721_doGracefullyFallIfTryToLoadSchedulerWithoutCalc")&&!T.kmd?(m.ULS.sendTraceTag(520901762,0,15,"PluginSchedulerFactory.createPluginSchedulerAsync: Calc is not initialized, pluginScheduler creation canceled"),E.nt()):G.$.da.Za(283,function(F){var K=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance();F=y.b(B.Task.Ua(F.tn));(v.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed")?
Promise.all([excelOnlineCalc.x10.ensureGroupAttached(F,0),x.a.iMg(G.$)?excelOnlineCalc.x10.ensureGroupAttached(F,2):Promise.resolve(0)]).then(function(J){return J.some(function(O){return 0<O})}):excelOnlineCalc.x10.ensureAllPluginsAttached(F)).then(function(J){G.$.da.Ga(413,K);E.setResult(K);v.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)&&G.$.da.Za(491,function(O){O.Eda.anyPluginInitialized=J})})})});return this.y4b=E.task};c.ka=function(G){G.da.Ga(414,new c(G))};Object(u.a)(c,
"PluginSchedulerFactory",z.a,[]);b.d(D,"a",function(){return a})},1642:function(u,D,b){function a(eb){return ub.call(this,eb)||this}function c(eb){this.$=eb}function d(eb){var ic=mc.call(this)||this;ic.$=eb;ic.Eb();return ic}function e(eb,ic){var Ac=this;this.$=eb;this.fontServiceManager=ic;this.menuId=this.BYc=this.iS=this.wua=null;this.Gad=0;this.CAi="+mn-lt";this.Hxi="+mj-lt";this.vKi=function(){Ac.oYf()};this.NPi=function(lc){Ac.Wef=!0;Ac.ZSg=null;Ac.$.eB(function(Gc){Gc.hPa("FontName_New")});
M.ULS.sendTraceTag(520710160,1,15,String.format("PreviewFont Status is {0}",lc))};this.Tei=!!String.fromCodePoint&&!sb.a.yf&&!!window.gridRenderer&&gridRenderer.CanvasRendererGlobals.isFontLoadApiSupported();this.Wef=!1;this.ZSg=null;this.Cm=ka.EwaSettings.Cm();this.gridView=fa.g(this.$);(this.cn=Dc.a.cn())&&this.fontServiceManager&&(this.fontServiceManager.Bnd?this.oYf():this.fontServiceManager.dne(this.vKi))}function k(eb){return Ab.call(this,eb)||this}function l(eb,ic){var Ac=this;this.l$b=this.XEd=
null;this.Iwf=function(){ka.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnfreezeViewportAdjustLocation",!1)||Ac.utc();if(Ac.l$b){var lc=Ta.a($a.a.Ta.Xd,Ac.l$b);M.ULS.sendTraceTag(570949840,5,50,"FreezePanesCommandHandler.OnFreezePanesUpdateCompleted: duration of FreezePane from operation until allBlockUpdated: {0}",lc);Ac.l$b=null}Ac.lEf()};this.$=eb;this.gridView=fa.g(eb);this.lF=ic.lrb(this.$.domElement,500,null,null);this.zKa=this.yKa=-1}function m(eb){this.freezeOptions=null;this.freezeOptions=
eb}function f(){}function w(eb){var ic=dc.call(this)||this;ic.hSb=null;ic.$=eb;ic.Eb();return ic}function n(eb){var ic=qb.call(this)||this;ic.THf=0;ic.TG=null;ic.GZg=function(Ac,lc){if(1===Ac&&ic.TG.FileCollectionErrorStateId){Ac=ic.$.oa.xa;var Gc=ic.TG.MessageId,ed=ic.TG.OriginalEcsServerId,fd=ic.TG.FileCollectionErrorStateId,Bc=Ac.Na(0);Bc.errorMessageId=Gc;Bc.ecsServerId=ed;Bc.fileCollectionErrorStateId=fd;Bc.userComment=lc;Ac.dZc("CollectFile",Bc,null,null,null,null,0)}ic.raiseEvent("fileCollectionComplete",
null,ic)};ic.$=eb;return ic}function z(eb){var ic=yb.call(this,!1,!1,z.pu)||this;ic.yud=!1;ic.Qnf=!0;ic.$mf=0;ic.Rb=1;ic.mc(1,CommonUIStrings.l_Send);ic.mc(0,CommonUIStrings.l_NoThanks);ic.Wf=r.pig;ic.Tmf=eb;ic.ze=z.BSg;return ic}function r(){}function v(eb){return na.call(this,eb)||this}function A(eb,ic,Ac){var lc=ra.call(this)||this;lc.xHi=function(Gc,ed){if(!la.a(Gc)&&ed){var fd=!!Gc&&!!Gc.RequestTelemetryData;fa.g(lc.$).ui.fla(ed.toString(),Gc.StateId,fd?Gc.RequestTelemetryData.EcsOperationDuration:
0,fd?Gc.RequestTelemetryData.EcsRequestDuration:0,fd?Gc.RequestTelemetryData.WfeRequestDuration:0)}};lc.$=eb;lc.tableManager=ic;lc.Gg=Ac;return lc}function B(eb){return S.call(this,eb)||this}function y(eb){var ic=Qa.call(this)||this;ic.ytf=function(Ac){var lc=fa.g(ic.$);if(Ac=Ac.Result){var Gc=J.D(Ac.NewSelection),ed=J.D(Ac.NewActiveCell);if(Gc&&ed)if(!Ac.Committed&&Ac.AutoSumFormula){var fd=lc.Ub(ed);fd&&(lc.ha.updateSelection(Gc,ed,60),Gc=ed=J.D(Ac.MarkedArea),lc.EJ=2,C(lc.$b,fd,Ac.AutoSumFormula,
!!Gc,Ac.FormulaMarkStart,Ac.FormulaMarkEnd),Gc&&ed&&lc.ha.updateSelection(Gc,ed,0),lc.$b.dpd=!1,ca.TaskExtensions.Ba(Q.GetServiceTaskFactory.create(ic.$.da,153,ic.la,0),function(Bc){Bc.result.L1a(null)},ic.la,3))}else lc.ha.updateSelection(Gc,ed,60)}};ic.$=eb;return ic}function x(eb,ic){this.sharedSheetRange=null;this.type=0;this.sharedSheetRange=eb;this.type=ic}function C(eb,ic,Ac,lc,Gc,ed){if(ic){var fd=eb.textBox;eb.isEditing||eb.startEdit(ic,!0);eb.dpd=!0;eb.text=Ac;fd.caretPosition=Gc;Gc<ed&&
(lc&&eb.LAa(),fd.selectRange(0,ed+1),fd.selectRange(Gc,ed))}}function G(eb,ic,Ac,lc,Gc,ed,fd,Bc,ld,Bd){Bd=eb.Na(9,Bd);Bd.selectedRange=ic;Bd.activeCell=Ac;Bd.autoSumType=lc;Bd.topLeftCell=Gc;return F.g(eb,"AutoSum",Bd,ed,fd,Bc,ld,0)}b.r(D);var E=b(1286),I=b(0),U=b(905),M=b(15),T=b(207),F=b(61),K=b(76);x.prototype.a4a=function(){return this.sharedSheetRange};Object(I.a)(x,"MacroRecorderAutoSumPayload",null,[409]);var J=b(45),O=b(564),N=b(389),H=b(177),Q=b(51),ca=b(37),X=b(160),Z=b(357),ea=b(29),ka=
b(1),Y=b(186),qa=b(295),fa=b(21),ha=b(126),ia=b(627),wa=b(58),Qa=T.a;Rk(y,Qa);y.prototype.Lc=function(){return!1};y.prototype.executeCommand=function(eb,ic,Ac){eb=ic.command;switch(eb){case 1220954656:ic=this.bIe(0,ic);break;case -1537138325:ic=this.bIe(parseInt(Ac[K.a.Nc].toString(),10),ic);break;default:ic=Y.a(eb)}return ic};y.prototype.Ac=function(eb,ic){if(eb=1===eb)switch(ic.command){case 1220954656:case -1537138325:break;default:eb=!1}return eb};y.prototype.Qc=function(){return!1};y.prototype.bIe=
function(eb,ic){function Ac(){return new x(fd,eb)}var lc=this,Gc=fa.g(this.$);Gc.ig.IG(!1);if(!fa.g(this.$).ha.sa.tg)return M.ULS.sendTraceTag(537170308,0,50,"AutoSumCommandHandler.DoAutoSum: Unhandled AutoSum of type {0} due to discontinuous selection. Number of selected ranges is {1}",eb,fa.g(this.$).ha.sa.sK),this.Wya(),wa.Task.Ua(!1);var ed=Gc.lH();if(!ed)return null;var fd=J.v(Gc.ha.sa.Vc,this.$),Bc=J.o(Gc.ha.sa.activeCell,this.$),ld=J.o(ed,this.$),Bd=this.$.oa.xa.Pb();return this.$.kq(Gc.ha.sa.selectedRanges,
!0)?ka.EwaSettings.Zb()?N.a(this.$.userOperationManager,function(xb,Fd,Vd){return G(lc.$.oa.xa,fd,Bc,eb,ld,qa.b(xb,lc.ytf),Fd,Vd,eb,Bd)},function(xb){return new H.a(502,0,xb,64,Ac)},ic):N.a(this.$.userOperationManager,function(xb,Fd,Vd){return G(lc.$.oa.xa,fd,Bc,eb,ld,qa.b(xb,lc.ytf),Fd,Vd,eb,Bd)},function(xb){return new O.a(502,0,xb,void 0,Ac)},ic):wa.Task.Ua(!1)};y.prototype.Wya=function(){ia.a(ha.a.discontinuousSelectionBlocking,["OtherICE"],!0,!0,!1,!1,null);var eb=ea.a.Wc(1,1,754,2162,0,371863010,
"DiscontinuousSelectionBlocking");ka.EwaSettings.qz()?new Z.a(this.$,eb):(eb=new X.ErrorDialog(this.$,eb),eb.initialize(),eb.hf())};Object(I.a)(y,"AutoSumCommandHandler",T.a,[403]);var S=U.a;Rk(B,S);B.prototype.zd=function(){this.jd([new y(this.$)])};B.ka=function(eb){U.a.Qd(96,new B(eb))};Object(I.a)(B,"AutoSumCommandHandlerFactory",U.a,[]);var da=b(11),xa=b(178),ta=b(279),ab=b(38),Na=b(338),Ka=b(1287),la=b(296),Ea=b(74),ra=ab.a;Rk(A,ra);A.prototype.UDg=function(eb){this.addHandler("ekcvc",eb)};
A.prototype.paj=function(eb){this.removeHandler("ekcvc",eb)};A.prototype.Lc=function(){return!1};A.prototype.executeCommand=function(eb,ic){eb=ic.command;switch(eb){case -730106152:ic=this.ihd(ic,3);break;case -1228228458:ic=this.ihd(ic,4);break;case -848953656:case 2045211913:if(this.Cki()){ic=wa.Task.Ua(!0);break}ic=this.ihd(ic,1);break;default:ic=Y.a(eb)}return ic};A.prototype.Ac=function(eb,ic){if(eb=1===eb)switch(ic.command){case -730106152:case -1228228458:case -848953656:case 2045211913:break;
default:eb=!1}return eb};A.prototype.Qc=function(){return!1};A.prototype.ihd=function(eb,ic){function Ac(){return new Ka.a(ic,Bd)}function lc(Fd,Vd,se){Gc.$.ry();return F.d(Gc.$.oa.xa,ic,Bd,!1,qa.b(Fd,Gc.xHi),Vd,se,ld,xb)}var Gc=this,ed=fa.g(this.$),fd=ed.ha.sa.selectedRanges,Bc=eb.command,ld=xa.a.create().toString();if(!this.$.kq(fd,!0)&&-730106152!==Bc)return wa.Task.Ua(!0);var Bd=J.r(fd,this.$);this.Zzj(Bc,ed,fd,ld);ka.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&
this.d3i();var xb=this.$.oa.xa.Pb({r_:!0,JZ:1});return ka.EwaSettings.Zb()?N.a(this.$.userOperationManager,lc,function(Fd){return new H.a(508,0,Fd,67,Ac)},eb):N.a(this.$.userOperationManager,lc,function(Fd){return new O.a(508,0,Fd,3,Ac)},eb)};A.prototype.Zzj=function(eb,ic,Ac,lc){var Gc=this;if(-848953656!==eb&&2045211913!==eb&&-730106152!==eb&&-1228228458!==eb)M.ULS.sendTraceTag(537167938,0,10,"ClearCommandHandler.ShowInstantaneousClear: Unexpected command {0}.",eb);else if(!ta.a.any(Ac,function(fd){return 0<
ic.getRangeInformation(fd).length})){var ed=ta.a.any(Ac,function(fd){return Gc.tableManager.pqd(fd)});if(-730106152!==eb&&-1228228458!==eb||!ed)this.XDj(ic,eb,lc,Ac),-730106152!==eb&&-1228228458!==eb||this.Gg.Mda(ic,-730106152,{}),-1228228458!==eb&&2045211913!==eb&&-848953656!==eb||this.Gg.lYg(Ac,lc),ic.ui.B0(lc,Ea.BasicTelemetryCalculator.NQ)}};A.prototype.XDj=function(eb,ic,Ac,lc){var Gc="";switch(ic){case -1228228458:Gc="ClearAll";break;case 2045211913:case -848953656:Gc="ClearContent";break;case -730106152:Gc=
"ClearFormat";break;default:M.ULS.sendTraceTag(537167937,0,15,"ClearCommandHandler.StampTimeWithCompatibleDescription: Unexpected command {0}.",ic)}ic=lc.length;lc=J.b(lc);eb.ui.w7(15,Ac,Gc+(", ranges to clear: "+ic+", cells to clear: "+lc))};A.prototype.d3i=function(){this.raiseEvent("ekcvc",new Na.a)};A.prototype.Cki=function(){if(fa.g(this.$).mz){var eb=this.$.da.za(296);return!!eb&&eb.CU.jB}return!1};Object(I.a)(A,"ClearCommandHandler",ab.a,[403,945]);var na=U.a;Rk(v,na);v.prototype.zd=function(){var eb=
this,ic=Q.GetServiceTaskFactory.create(this.$.da,134,this.la,this.hb),Ac=Q.GetServiceTaskFactory.create(this.$.da,18,this.la,this.hb);ca.TaskExtensions.Ba(ca.TaskExtensions.Wd([ic,Ac],this.la),function(){var lc=new A(eb.$,ic.result,Ac.result);eb.jd([lc]);eb.$.da.Ga(313,lc)},this.la,3)};v.ka=function(eb){U.a.Qd(101,new v(eb))};Object(I.a)(v,"ClearCommandHandlerFactory",U.a,[]);var ba=b(1430),sa=b(1288),ya=b(1343),va=b(1290),W=b(1291),La=b(1356),Ia=b(90),mb=b(232),fb=b(4),Ma=b(107),Hb=b(43),Kb=b(10),
Ub=b(83),gb=b(150);r.pig='<div id="WACDialogRow" class="WACDialogRow">\r\n\t\t\t\t\t<div id="WACDialogIconPanel" class="WACDialogIconPanel"></div>\r\n\t\t\t\t\t<div id="WACDialogTextPanel" class="WACDialogTextPanel" style="padding-right: 30px;">\r\n\t\t\t\t\t\t<div id="WACDialogErrorMessage"></div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorReportMessage"> </div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorTextPrompt" ></div> \r\n\t\t\t\t\t\t<textarea id="WACDialogInput" class="WACDialogInput" rows="5" style="margin-bottom: 10px; margin-top: 9px; overflow: auto;" maxlength="256"></textarea>\r\n\t\t\t\t\t\t<div id = "WACDialogSendFileCheckboxContainer" class="WACDialogRow" >\r\n\t\t\t\t\t\t<input type="checkbox" id="WACDialogSendFileCheckbox">\r\n\t\t\t\t\t\t<span id="WACDialogSendFileCheckboxText">text</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<a id="WACDialogPrivacyText"> </a> \r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>';
Object(I.a)(r,"FileUploadDialogHTML",null,[]);var Db=b(158),Va=b(27),yb=gb.a;Rk(z,yb);z.prototype.kj=function(eb,ic,Ac,lc,Gc){Gc=void 0===Gc?!0:Gc;this.yud=void 0===lc?!1:lc;this.lzj(ic);this.$mf=eb;Gc&&fb.AFrameworkApplication.JF(eb)};z.prototype.lzj=function(eb){if(z.pu)this.TAj(eb);else{var ic={};ic[z.xSg]=eb;ic[z.DSg]=CommonUIStrings.l_SendFileErrorReportMessage;ic[z.ESg]=CommonUIStrings.l_SendFileErrorReportTextCaption;ic[z.MYc]="";ic[z.ASg]=CommonUIStrings.l_UserReportLinkText;ic[z.V0b]=!0;
this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(Ub.a)(this,this.Hri,"legacyDialogHandler"),ic);this.YW(z.JSg)}};z.prototype.TAj=function(eb){var ic={},Ac={},lc={},Gc={},ed={};eb=(ed.id=this.ze,ed.bodyControls=(Gc.reportErrorCheckboxProps=this.yud?(ic.label=CommonUIStrings.l_UserReportLinkText,ic):null,Gc.textAreaProps=this.Qnf?{}:null,Gc.privacyStatementLinkProps=(lc.text=CommonUIStrings.l_PrivacyStatement,lc.handler=(Ac.href=fb.AFrameworkApplication.tma,Ac.target="_blank",Ac),
lc),Gc),ed.errorMessage=eb,ed.errorReportMessage=CommonUIStrings.l_SendFileErrorReportMessage,ed.errorTextPrompt=CommonUIStrings.l_SendFileErrorReportTextCaption,ed);this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(Ub.a)(this,this.RFd,"reactDialogHandler"),eb)};z.prototype.r9a=function(){if(!z.pu){var eb=document.getElementById(z.GSg);eb&&(eb.className=z.FSg,eb.appendChild(Db.createClusteredImage(32,32,z.CSg,null,!0,CommonUIStrings.l_DialogError)));if(eb=document.getElementById(z.HSg))eb.innerText=
CommonUIStrings.l_PrivacyStatement,eb.href=fb.AFrameworkApplication.tma,Hb.a.addHandler(eb,"click",Object(Ub.a)(this,this.QPi,"onPrivacyClickHandler"));this.Qnf||(eb=document.getElementById(z.MYc))&&eb.parentNode&&eb.parentNode.removeChild(eb);this.yud||(eb=document.getElementById(z.zSg))&&eb.parentNode&&eb.parentNode.removeChild(eb)}};z.prototype.lO=function(){z.pu||(yb.prototype.lO.call(this),document.getElementById(this.di("WACDialogPanel")).style.width=String.format("{0}px",400))};z.prototype.Hri=
function(eb,ic){var Ac=ic[z.MYc]||"",lc=!0;void 0!==ic[z.V0b]&&null!==ic[z.V0b]&&(lc=ic[z.V0b]);this.Xv(eb,Ac,lc)};z.prototype.RFd=function(eb,ic){this.Xv(eb,ic.text||"",ic.reportErrorChecked)};z.prototype.Xv=function(eb,ic,Ac){this.Tmf&&(Ac&&M.ULS.sendTraceTag(5768786,306,50,"Error Report sent for errorCode:{0}",this.$mf),this.Tmf(eb,ic,Ac))};z.prototype.QPi=function(eb){fb.AFrameworkApplication.ub.ae(Va.a.eza,2,eb)};Af.Object.defineProperties(z.prototype,{canBePreempted:{configurable:!0,enumerable:!0,
get:function(){return!1}}});Af.Object.defineProperties(z,{pu:{configurable:!0,enumerable:!0,get:function(){return fb.AFrameworkApplication.ta.Pa.Wu&&fb.AFrameworkApplication.ta.Pa.ali}}});z.xSg="WACDialogErrorMessage";z.DSg="WACDialogErrorReportMessage";z.ESg="WACDialogErrorTextPrompt";z.MYc="WACDialogInput";z.HSg="WACDialogPrivacyText";z.GSg="WACDialogIconPanel";z.CSg="CancelRequest_32x32x32";z.FSg="WACDialogIcon";z.JSg="WACDialogTextPanel";z.V0b="WACDialogSendFileCheckbox";z.zSg="WACDialogSendFileCheckboxContainer";
z.ASg="WACDialogSendFileCheckboxText";z.BSg="FileUploadErrorDialog";Object(I.a)(z,"FileUploadErrorDialog",gb.a,[]);var qb=ab.a;Rk(n,qb);n.prototype.eEg=function(eb){this.addHandler("fileCollectionComplete",eb)};n.prototype.yaj=function(eb){this.removeHandler("fileCollectionComplete",eb)};n.prototype.FZg=function(eb,ic,Ac){this.THf=ic;this.TG=eb;this.eEg(Ac);fb.AFrameworkApplication.tma=this.$.workbookContext.FullDocumentInfo.PrivacyUrl;eb=new z(this.GZg);fb.AFrameworkApplication.ub.Mb(Va.a.eza,Ma.a.frame,
n.Q0i);eb.kj(0,"",null,!1,!1)};n.prototype.k$i=function(eb){this.yaj(eb)};n.Q0i=function(eb,ic,Ac,lc,Gc){Hb.a.Kt(Gc);fb.AFrameworkApplication.tma&&Kb.HelperMethods.Ze(fb.AFrameworkApplication.tma,void 0,void 0,"FileCollectionOperation.PrivacyUrl");return 32};Object(I.a)(n,"FileCollectionOperation",ab.a,[946,10]);var dc=mb.a;Rk(w,dc);w.prototype.create=function(){var eb=this;ca.TaskExtensions.Ba(Q.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb),function(){eb.pb(eb.Oyh)},this.la,3)};w.prototype.dispose=
function(){Ia.a.Ia(this.hSb);this.hSb=null;dc.prototype.dispose.call(this)};w.ka=function(eb){eb.da.Ga(125,new w(eb))};Af.Object.defineProperties(w.prototype,{Oyh:{configurable:!0,enumerable:!0,get:function(){return this.hSb||(this.hSb=new n(this.$))}}});Object(I.a)(w,"FileCollectionCommandHandlerFactory",mb.a,[]);var bb=b(1361),db=b(1293),wc=b(1454),nb=b(7),zb=b(741);Object(I.a)(f,"FreezePanesCommandParameters",null,[]);var ma=b(8),P=b(185),oa=b(24),Ja=b(413),$a=b(28),Ta=b(284),pa=b(286),Da=b(117);
m.prototype.getSheetName=function(){return this.freezeOptions.SheetName};Object(I.a)(m,"MacroRecorderSheetPaneFrozenPayload",null,[409]);var rb=b(42);l.prototype.Lc=function(eb,ic){var Ac=!1;switch(ic){case 1844679312:Ac=1!==eb&&!this.gridView.eb.p4}return Ac};l.prototype.executeCommand=function(eb,ic){eb=this.gridView.eb;var Ac=this.gridView.Ggd();fb.AFrameworkApplication.ta.Pa.rz&&this.$.Eka&&(1844679312===ic.command||340334732===ic.command||-806625837===ic.command)&&zb.ShyRibbon.GP(1,2);switch(ic.command){case 1844679312:return this.setFreezePanes(ic,
Ac,eb.Ni);case 340334732:return eb.H9b?wa.Task.Ua(!1):this.oqj(ic,Ac);case -806625837:return eb.USa?wa.Task.Ua(!1):this.pqj(ic,Ac)}return wa.Task.Ua(!1)};l.prototype.Ac=function(eb,ic){eb=!1;switch(ic.command){case 1844679312:case 340334732:case -806625837:case 1745254833:eb=!0}return eb};l.prototype.Qc=function(){return!1};l.prototype.setFreezePanes=function(eb,ic,Ac){if(Ac)return this.avc(eb,!1,0,0,0,0,ic,null);var lc=this.gridView.ha.sa;Ac=lc.activeCell.clone();lc=lc.activeRange;lc.Ue&&(M.ULS.sendTraceTag(537159585,
0,50,"FreezePanesCommandHandler.SetFreezePanes: activeRange is a column. updating firstUnfreezeCell.Top ({0}) and firstUnfreezeCell.Bottom ({1}) to equal topLeftRange.Top ({2})",Ac.top,Ac.bottom,ic.top),Ac.top=Ac.bottom=ic.top);lc.isRow&&(M.ULS.sendTraceTag(537159584,0,50,"FreezePanesCommandHandler.SetFreezePanes: activeRange is a row. updating firstUnfreezeCell.Left ({0}) and firstUnfreezeCell.Right ({1}) to equal topLeftRange.Left ({2})",Ac.left,Ac.right,ic.left),Ac.left=Ac.right=ic.left);Ac.top===
ic.top&&Ac.left===ic.left&&(Ac=oa.Range.Tc(Ac.top+1,Ac.left));lc=Ac.top-1;var Gc=Ac.left-1,ed=lc-(ic.top-1),fd=Gc-(ic.left-1);return this.oVj(Ac,ed,fd)?this.avc(eb,!0,lc,Gc,ed,fd,ic,Ac):(this.$.jf(),this.lEf(),wa.Task.Ua(!0))};l.prototype.oqj=function(eb,ic){return this.avc(eb,!0,0,ic.left,0,1,ic,null)};l.prototype.pqj=function(eb,ic){return this.avc(eb,!0,ic.top,0,1,0,ic,null)};l.prototype.oVj=function(eb,ic,Ac){var lc=this.gridView.gg(eb),Gc=this.gridView.view.visibleArea;return!lc||Gc.topLeft.y>
lc.bottomRight.y||Gc.topLeft.x>lc.bottomRight.x||Gc.bottomRight.y<lc.bottomRight.y||Gc.bottomRight.x<lc.bottomRight.x?(M.ULS.sendTraceTag(537159583,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create freeze pane when active cell not in view, range={0}, rangeViewportArea={1}, visibleArea={2}",eb,lc?lc.toString():"null",Gc.toString()),eb=ea.a.Wc(1,0,26,1471,0,2105967339,"FreezePaneSelectionNotInViewErr"),ka.EwaSettings.qz()?new Z.a(this.$,eb):(eb=new X.ErrorDialog(this.$,
eb),eb.initialize(),eb.hf()),!1):0>=ic&&0>=Ac?(M.ULS.sendTraceTag(537159582,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create empty freeze pane"),eb=fa.g(this.$).rtl?1473:1472,ic=fa.g(this.$).rtl?-2131054257:-1953454131,eb=ea.a.Wc(1,0,26,eb,0,ic,"FreezePaneA1SelectedErr"),ka.EwaSettings.qz()?new Z.a(this.$,eb):(eb=new X.ErrorDialog(this.$,eb),eb.initialize(),eb.hf()),!1):!0};l.prototype.avc=function(eb,ic,Ac,lc,Gc,ed,fd,Bc){function ld(){return new m(xb)}var Bd=this;this.XEd=
rb.a(this.$).B9(5,"SendFreezePanesRequest","SendFreezePanesRequest");this.gridView.pP(this.Iwf);this.lF.jSa();this.gridView.BEj(ic?"":"UnsetFreezePane");this.Gsj(eb,ic,this.gridView.eb);var xb=Object(nb.a)(new f,{SheetName:this.$.pa.name,Freeze:ic,FrozenRows:Gc,FrozenColumns:ed,FirstRow:Ac,FirstColumn:lc});M.ULS.sendTraceTag(573101852,0,50,"FreezePanesCommandHandler.SendFreezePanesRequest: Freeze={0}, FrozenRows={1}, FrozenColumns={2}, FirstRow={3}, FirstColumn={4} ",ic,Gc,ed,Ac,lc);this.l$b=$a.a.Ta.Xd;
return N.a(this.$.userOperationManager,function(Fd,Vd,se){if(ka.EwaSettings.ma(61)){var ue=window.performance;ue.clearMarks();ue.mark("FreezePanes request sent")}ue=Bd.gridView.As;ka.EwaSettings.isChangeGateEnabled("OfficeVSO:6661123_RequestContentOnFreezePaneOperation")&&ue?(ue=Bd.Plh(xb,ue,fd,Bc),Bd.OLj(ue)):Bd.$.ry();ue=Bd.$.oa.xa;var Ee=ue.Na(9,null);Ee.freezeSettings=xb;return F.g(ue,"FreezeOrUnfreezePanes",Ee,Fd,Vd,se,ic,0)},function(Fd){return new H.a(151,0,Fd,void 0,ld)},eb)};l.prototype.Plh=
function(eb,ic,Ac,lc){M.ULS.shipAssertTag(537159580,1,!!ic,"FreezePaneCommandHandler.EstimatePaneViewDataOnPaneRequest: called with null Sheet Processed Data");if(!eb.Freeze)return null;var Gc=pa.a();Gc.State=1;Gc.IsEstimated=!0;var ed=!1,fd=!1,Bc=ic.ZU(oa.Range.Tc(Ac.top,Ac.left)),ld=eb.FrozenRows,Bd=eb.FrozenColumns;1!==eb.FrozenRows||eb.FrozenColumns?eb.FrozenRows||1!==eb.FrozenColumns?(Bd=ic.ZU(oa.Range.Tc(eb.FirstRow+1,eb.FirstColumn+1)),ic=ic.ZU(oa.Range.Tc(Ac.top,Ac.left)),Gc.Width=Bd.qj-Bc.qj,
Gc.Height=Bd.wj-Bc.wj,0<eb.FrozenRows&&(Gc.AbsoluteTop=Bd.wj,fd=!0),0<eb.FrozenColumns&&(Gc.AbsoluteLeft=Bd.qj,ed=!0),ld=Bd.PK-ic.PK,Bd=Bd.tJ-ic.tJ):(Gc.Width=ic.nfd(P.a.Tc(Ac.top,Ac.left)),lc=oa.Range.Tc(Ac.top,Ac.left+1),Gc.AbsoluteLeft=Bc.qj+Gc.Width,ed=!0):(Gc.Height=ic.mfd(P.a.Tc(Ac.top,Ac.left)),lc=oa.Range.Tc(Ac.top+1,Ac.left),Gc.AbsoluteTop=Bc.wj+Gc.Height,fd=!0);fd&&(Gc.FirstFrozenRow=Ac.top,Gc.FirstScrollableRow=lc.top);ed&&(Gc.FirstFrozenColumn=Ac.left,Gc.FirstScrollableColumn=lc.left);
Gc.VisibleRows=ld;Gc.VisibleColumns=Bd;return Gc};l.prototype.OLj=function(eb){var ic=this;wa.Task.delay(this.$.ya.GetRangeContentPrefetchDelayInMs).continueWith(function(){ic.$.pa&&ic.$.ea&&(ic.$.ea.nX(ma.a.Fe,"FreezePaneCommandHandler.TriggerDelayActiveItemPaneChange"),Ja.b(ic.$.pa,eb,-1,void 0,!0))})};l.prototype.Gsj=function(eb,ic,Ac){if(!ka.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnfreezeViewportAdjustLocation",!1))switch(eb.command){case 1844679312:if(ic||-1===this.yKa&&-1===
this.zKa)this.yKa=Ac.kx-Ac.width+this.gridView.scrollLeft,this.zKa=Ac.lx-Ac.height+this.gridView.scrollTop;break;case 340334732:if(ic||-1===this.yKa)this.yKa=Ac.kx-Ac.width+this.gridView.scrollLeft;break;case -806625837:if(ic||-1===this.zKa)this.zKa=Ac.lx-Ac.height+this.gridView.scrollTop}};l.prototype.utc=function(){var eb=this.gridView.eb;0<eb.width?this.gridView.scrollLeft=Da.a.F0b(this.gridView.domElement,fa.g(this.$).rtl,0):-1!==this.yKa&&(this.gridView.scrollLeft=this.yKa,this.yKa=-1);0<eb.height?
this.gridView.scrollTop=0:-1!==this.zKa&&(this.gridView.scrollTop=this.zKa,this.zKa=-1)};l.prototype.lEf=function(){this.lF.Cdb();Ia.a.Ia(this.XEd);this.XEd=null;this.gridView.GK(this.Iwf)};Object(I.a)(l,"FreezePanesCommandHandler",null,[403]);var Ab=U.a;Rk(k,Ab);k.prototype.zd=function(){var eb=this;ca.TaskExtensions.Ba(Q.GetServiceTaskFactory.Ra(this.$.da,12,477,this.hb),function(ic){eb.jd([new l(eb.$,ic.result)])},this.$.la)};k.ka=function(eb){eb.da.Ga(116,new k(eb))};Object(I.a)(k,"FreezePanesCommandHandlerFactory",
U.a,[]);var ob=b(1372),sb=b(25),Pb=b(625),Aa=b(622),Ya=b(30),kb=b(1202),lb=b(1294);b(323);var ac=b(14),Dc=b(36);e.prototype.oYf=function(){this.iS=this.fontServiceManager.Tyc;this.wua=this.fontServiceManager.FCh;this.Gad=2};e.prototype.aVe=function(eb,ic,Ac,lc){lc=void 0===lc?null:lc;var Gc=Object.assign(new Pb.a,{Id:"FontDropdownMenu"});Gc.MenuSectionList=[];if(this.Cm&&this.themesManager){this.themesManager.r$c(lc);if(null==this.themesManager.hL||this.themesManager.uqd)return Gc;lc=Object.assign(new Aa.a,
{ControlsId:"ThemeFontsMenuSectionControl",Title:ac.a.instance.ga(1317),ControlList:this.MYh(eb,ic,Ac)});Gc.MenuSectionList.push(lc)}lc=Object.assign(new Aa.a,{ControlsId:"FontsMenuSectionControl"});if(this.Cm||this.cn)lc.Title=ac.a.instance.ga(1318);lc.ControlList=this.EOh(eb,ic,Ac);Gc.MenuSectionList.push(lc);return Gc};e.prototype.MYh=function(eb,ic,Ac){var lc,Gc=[],ed=this.gridView.ha.Oa.Yb;ed=5===(null===(lc=null===ed||void 0===ed?void 0:ed.floatingObject)||void 0===lc?void 0:lc.type);if(this.themesManager.hL){var fd=
this.themesManager.hL.Kpf;var Bc=this.themesManager.hL.cof}else M.ULS.sendTraceTag(520710165,1,15,"ThemeFonts are Null");null!=Bc?(lc=this.qEe(Bc,1,ed,eb,ic,Ac),Gc.push(lc)):M.ULS.sendTraceTag(520710164,1,15,"Major Theme Font is Null");null!=fd?(eb=this.qEe(fd,2,ed,eb,ic,Ac),Gc.push(eb)):M.ULS.sendTraceTag(520710163,1,15,"Minor Theme Font is Null");return Gc};e.prototype.qEe=function(eb,ic,Ac,lc,Gc,ed){var fd=2===ic?this.CAi:this.Hxi;Ac=Ac?fd:Ya.a.af(eb);fd=Ya.a.af(Kb.HelperMethods.dcc(eb,ic));eb=
Ya.a.af(eb);return Object.assign(new kb.a,{MenuItemId:2===ic?lb.b:lb.a,CommandValueId:Ac,LabelText:fd,LabelCss:String.format("font-size:12pt;font-family:{0};",eb),Styles:e.yvb(eb),AriaLabel:fd,Alt:fd,Command:lc.toString(),CommandPreviewId:Gc.toString(),CommandRevertId:ed.toString()})};e.prototype.EOh=function(eb,ic,Ac){if(this.BYc)return this.BYc.S4c;var lc=this.Tei&&!this.Wef,Gc=!1;this.wua||(this.S9e(),Gc=!0);var ed=this.TCe(eb,ic,Ac,this.wua,lc,Gc);ed.Pwc&&!Gc&&(M.ULS.sendTraceTag(520710162,1,
15,"FontDropdownHelper.getFontButtonsForMenuSection: ddEntries is Null. Fallback to old Font Dictionary."),this.S9e(),ed=this.TCe(eb,ic,Ac,this.wua,lc,ed.Pwc));this.cn&&!ed.Pwc&&(this.BYc=ed);lc&&gridRenderer.CanvasRendererGlobals.loadPreviewFont(this.NPi);return ed.S4c};e.prototype.TCe=function(eb,ic,Ac,lc,Gc,ed){var fd=[],Bc=this.cn&&!ed;var ld=Bc?"msofpNew":"msofp";for(var Bd in lc){var xb=Bd,Fd=lc[Bd],Vd=Ya.a.af(xb),se;if(Bc)if(se=this.iS?this.iS[xb]:null)se=Ya.a.af(se);else return M.ULS.sendTraceTag(520710161,
1,15,"FontDropdownHelper.getFontButtonsForMenuSection: localizedFontName in supportedFontFamiliesNew is not found for {0}",xb),{Pwc:!0,S4c:[]};else se=Ya.a.af(Kb.HelperMethods.iS[xb]);xb=Ya.a.af(xb);Gc||(Fd=0);Vd=Object.assign(new kb.a,{MenuItemId:Vd,CommandValueId:Vd,LabelText:Gc&&0<Fd?Ya.a.af(String.fromCodePoint(Fd)):se,LabelCss:String.format("font-size:12pt;font-family:{0};",Gc&&0<Fd?ld:xb),Styles:e.yvb(Gc&&0<Fd?ld:xb),AriaLabel:se,Alt:se,Command:eb.toString(),CommandPreviewId:ic.toString(),CommandRevertId:Ac.toString()});
fd.push(Vd)}return{Pwc:ed,S4c:fd}};e.prototype.erj=function(eb){this.menuId=eb};e.prototype.Fhi=function(){return 2!==this.Gad&&3!==this.Gad?!1:!0};e.prototype.S9e=function(){var eb={};this.wua=(eb["Angsana New"]=983046,eb["Arial Black"]=983051,eb.Arial=983050,eb.Batang=983061,eb["Book Antiqua"]=983077,eb["Browallia New"]=983082,eb.Calibri=983085,eb.Cambria=983089,eb.Candara=983091,eb.Century=983095,eb["Comic Sans MS"]=983100,eb.Consolas=983101,eb.Constantia=983102,eb.Corbel=983106,eb["Cordia New"]=
983107,eb["Courier New"]=983109,eb.DilleniaUPC=983121,eb.Dotum=983123,eb.FangSong=983138,eb.Garamond=983154,eb.Georgia=983156,eb.Gulim=983182,eb.GungSuh=983186,eb.KaiTi=983222,eb.JasmineUPC=983218,eb["Malgun Gothic"]=983258,eb.Mangal=983262,eb.Meiryo=983264,eb["Microsoft JhengHei"]=983272,eb["Microsoft YaHei"]=983284,eb.MingLiU=983292,eb.MingLiU_HKSCS=983296,eb["MS Gothic"]=983245,eb["MS Mincho"]=983247,eb["MS PGothic"]=983249,eb["MS PMincho"]=983251,eb.PMingliU=983322,eb["PMingLiU-ExtB"]=983324,
eb.SimHei=983382,eb.SimSun=983384,eb["SimSun-ExtB"]=983386,eb["Source Sans Pro"]=983396,eb.Tahoma=983405,eb.THSarabunPSK=983404,eb["Times New Roman"]=983415,eb["Trebuchet MS"]=983419,eb.Verdana=983443,eb["Yu Gothic"]=983464,eb["Yu Mincho"]=983474,eb)};e.yvb=function(eb){var ic={};ic["font-family"]=eb;ic["font-size"]="12pt";return{optionText:ic}};Af.Object.defineProperties(e.prototype,{themesManager:{configurable:!0,enumerable:!0,get:function(){this.gx||(this.gx=this.$.da.za(422));return this.gx}},
Tyc:{configurable:!0,enumerable:!0,get:function(){return this.iS}}});Object(I.a)(e,"FontDropdownHelper",null,[944]);var Zb=b(962),mc=mb.a;Rk(d,mc);d.prototype.create=function(){var eb=this;ka.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FontServiceIntegration",!1)?this.$.da.Za(504,function(ic){eb.pb(Object(Zb.a)(eb.$.da,502,function(){return new e(eb.$,ic)}))}):this.pb(Object(Zb.a)(this.$.da,502,function(){return new e(eb.$,null)}))};d.ka=function(eb){eb.da.Ga(503,new d(eb))};Object(I.a)(d,
"FontDropdownHelperFactory",mb.a,[]);var Lb=b(1455),Sa=b(1296),Cb=b(1431),ec=b(1394),wb=b(1344),rc=b(1369),Mc=b(1480),Pc=b(1432),Kc=b(1403);c.prototype.Lc=function(){return!1};c.prototype.executeCommand=function(eb,ic){eb=!1;ic=ic.command;switch(ic){case 1910465940:eb=!0}return eb?wa.Task.Ua(!0):Y.a(ic)};c.prototype.Ac=function(eb,ic){switch(ic.command){case 1910465940:return!0;default:return!1}};c.prototype.Qc=function(){return!1};Object(I.a)(c,"NameManagerCommandHandler",null,[403]);var ub=U.a;
Rk(a,ub);a.prototype.zd=function(){this.jd([new c(this.$)])};a.ka=function(eb){U.a.Qd(493,new a(eb))};Object(I.a)(a,"NameManagerCommandHandlerFactory",U.a,[]);var Fb=b(1395),pc=b(1383);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.AutoComplete");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ContextMenu");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidation");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidationEdit");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.FormulaAssistance");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory");Type.registerNamespace("_Ewa");Object(E.a)();da.a.Fa(B.ka);da.a.Fa(v.ka);Object(ba.a)();Object(sa.a)();Object(ya.a)();Object(va.a)();Object(W.a)();Object(La.a)();da.a.Fa(w.ka);Object(bb.a)();Object(db.a)();Object(wc.a)();(function(){da.a.Fa(function(eb){k.ka(eb)})})();Object(ob.a)();Object(Lb.a)();Object(Sa.a)();Object(Cb.a)();Object(ec.a)();Object(wb.a)();Object(rc.a)();Object(Mc.a)();Object(Pc.a)();Object(pc.a)();
Object(Kc.a)();Object(Fb.a)();(function(){da.a.Fa(function(eb){a.ka(eb)})})();(function(){da.a.Fa(function(eb){d.ka(eb)})})()},927:function(u,D,b){function a(Q,ca,X,Z,ea,ka,Y,qa,fa,ha,ia,wa){var Qa=H.call(this)||this;Qa.Mkc=!1;Qa.contextMenuController=null;Qa.vIc=null;Qa.HFc=null;Qa.xnd=!1;Qa.V_j=0;Qa.U_j=0;Qa.dsb=null;Qa.Utc=null;Qa.wC=function(){Qa.contextMenuController?Qa.contextMenuController.wC():d.ULS.sendTraceTag(537167068,0,10,"ContextMenuBase.DismissFloatie: the context menu controller is null when attempintg to dismiss floatie on KeyDown.");
Qa.Zag()};Qa.jb=Q;Qa.kpf=ea;Qa.xPc=ha;Qa.e_j=X;Qa.d_j=Z;Qa.GZj=ca;Qa.vGf=ka;Qa.populateOnlyOnce=Y;Qa.F4h=ia;Qa.jNf(wa);return Qa}b.d(D,"a",function(){return a});u=b(0);var c=b(7),d=b(15),e=b(625),k=b(90),l=b(25),m=b(622),f=b(394),w=b(652),n=b(631),z=b(113),r=b(279),v=b(84),A=b(440),B=b(1600);D=b(79);var y=b(18),x=b(5),C=b(1048),G=b(76),E=b(45),I=b(59),U=b(151),M=b(114),T=b(1),F=b(10),K=b(22),J=b(14),O=b(21),N=b(33),H=D.a;Rk(a,H);a.prototype.Lc=function(Q,ca){Q=!0;switch(ca){case 1651433993:case 1675506831:case 966232027:Q=
this.Vd(4096)||this.Vd(2048);break;case 2045563128:Q=this.Vd(4096);break;case 912277356:case 2123758504:case -1793121409:case 1378457149:Q=this.Vd(8192)}return!Q};a.prototype.Qc=function(Q,ca,X){X.IsShadowMenuOpen||C.h(this.$,C.d);Q=!1;ca===this.yw&&(X.IsShadowMenuOpen||C.h(this.$,C.a),ca=Object(c.a)(new e.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]}),this.dDd(ca,X.IsShadowMenuOpen),X.MenuItems=ca,X.IsShadowMenuOpen||C.h(this.$,C.c),Q=!0);Q&&this.Mkc&&F.HelperMethods.G0b&&
!X.IsShadowMenuOpen&&C.j(this.$);return Q};a.prototype.dDd=function(Q,ca){(ca=this.QY(ca))?(this.f8e(ca),Array.addRange(Q.MenuSectionList,ca.eE().MenuSectionList),this.cCg(Q)):d.ULS.sendTraceTag(537167105,0,10,"ContextMenuBase.PopulateContextMenuProps: CreateRibbonMenu() returned null instead of RibbonMenu instance")};a.prototype.QY=function(){d.ULS.sendTraceTag(537167104,0,10,"ContextMenuBase.CreateRibbonMenu: This method should not be called if the menu is not ready for React!");return null};a.prototype.y0=
function(Q,ca,X,Z,ea){Q=Sys.UI.DomElement.getBounds(ca);X=new Sys.UI.Point(Q.x,Q.y+Q.height);this.qTa(X,ca);this.$.isChromeRtl&&(X.x+=Q.width);this.np(X,ea)};a.prototype.np=function(Q,ca,X){X=void 0===X?0:X;ca&&(Q=N.a(this.$).xja(Q));ca=!0;if(this.F4h){var Z;3===X?(Z=this.PJa(3))&&0<Z.length?(ca=!1,this.showFloatie(Z,new Sys.UI.Bounds(Q.x,Q.y,0,0),X)):d.ULS.sendTraceTag(537167075,0,10,"ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the touch floatie groups. Context menu ID: {0}",
this.menuId):2===X&&this.$.isEditMode&&((Z=this.PJa(2))&&0<Z.length?Z[0]!==a.nTe?(ca=!1,this.fRd(Z,new Sys.UI.Bounds(Q.x,Q.y,0,0),X)):d.ULS.sendTraceTag(537167074,0,50,"ContextMenuBase.ShowAt: The context menu does not support floatie. Context menu ID: {0}",this.menuId):d.ULS.sendTraceTag(537167073,0,10,"ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the mouse floatie groups. Context menu ID: {0}",this.menuId))}ca&&this.showContextMenu(new Sys.UI.Bounds(Q.x,
Q.y,0,0),X)};a.prototype.PJa=function(){return null};a.prototype.ifd=function(Q,ca){var X="";3===Q?X="touch":2===Q&&(X="mouse");Q={};return Q.ContextMenuId=this.menuId,Q.IsEditMode=this.$.isEditMode,Q.IsSLR=!!I.a.rg&&I.a.rg.cK,Q.IsReactMLR=!!I.a.rg&&I.a.rg.xV,Q.IsNov=this.$.ea.isNamedObjectViewMode,Q.InputType=X,Q.FloatieGroups=JSON.stringify(void 0===ca?null:ca),Q};a.prototype.showContextMenu=function(Q,ca){ca=void 0===ca?0:ca;var X=this.ifd(ca);d.ULS.sendTraceTag(595359709,0,50,"ContextMenuBase.ShowContextMenu: rendering a context menu with given arguments: {0}",
JSON.stringify(X));this.contextMenuController?this.wB!==x.a.SFd&&this.wB!==x.a.TFd||0===ca?this.contextMenuController.eRd(this.wB,Q,G.a.Cb):this.contextMenuController.eRd(this.wB,Q,ca):d.ULS.sendTraceTag(537167072,0,10,"ContextMenuBase.ShowContextMenu: the context menu controller is null when attempintg to show context menu.")};a.prototype.showFloatie=function(Q,ca,X){var Z=this.ifd(X,Q);d.ULS.sendTraceTag(595359710,0,50,"ContextMenuBase.ShowFloatie: rendering a floatie with given arguments: {0}",
JSON.stringify(Z));this.contextMenuController?(T.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.qNf(),this.contextMenuController.sxc(Q,ca,X)):d.ULS.sendTraceTag(537167071,0,10,"ContextMenuBase.ShowFloatie: the context menu controller is null when attempting to show the floatie with floatieGroups {0}.",JSON.stringify(Q))};a.prototype.fRd=function(Q,ca,X){var Z=this.ifd(X,Q);d.ULS.sendTraceTag(537167070,0,50,"ContextMenuBase.ShowContextMenuWithFloatie: rendering a floatie with given arguments: {0}",
JSON.stringify(Z));this.contextMenuController?(T.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.qNf(),this.contextMenuController.dRd(Q,ca,X,this.wB)):d.ULS.sendTraceTag(587335491,0,10,"ContextMenuBase.ShowContextMenuWithFloatie: the context menu controller is null when attempintg to show floatie with ContextMenu.")};a.prototype.jNf=function(Q){this.contextMenuController=Q};a.prototype.dispose=function(){this.$&&this.$.Ka.Oab(this);this.jb=null;T.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&
this.Zag();this.Utc&&(k.a.Ia(this.Utc),this.Utc=null);H.prototype.dispose.call(this)};a.prototype.bFh=function(Q){var ca=this.$.da.za(204);ca&&(ca=ca.IFh(this.kpf))&&Q.pc.push(ca)};a.prototype.qTa=function(Q,ca){Q&&ca&&this.$.ea.ic.isDivSyndicated&&l.a.yf&&(ca=ca.ownerDocument.documentElement,Q.x-=ca.scrollLeft,Q.y-=ca.scrollTop)};a.prototype.Vd=function(Q){return(new U.a(this.$.va)).Vd(Q)};a.prototype.f8e=function(Q){Q=ak(Q.pc);for(var ca=Q.next();!ca.done;ca=Q.next())if(ca=ca.value,Object(A.a)(632,
ca)){ca.title&&(ca.title=a.rh(ca.title));ca=ak(ca.buttons);for(var X=ca.next();!X.done;X=ca.next())X=X.value,Object(A.a)(652,X)?(X.label=a.rh(X.label),X.$R(a.rh(X.alt))):Object(A.a)(662,X)&&this.f8e(X.menu)}};a.prototype.hpf=function(Q,ca){ca=void 0===ca?!1:ca;var X=[];Q=ak(Q);for(var Z=Q.next();!Z.done;Z=Q.next())X.push(this.lU(Z.value,ca));return X};a.prototype.lU=function(Q){for(var ca=[],X=ak(Q.MenuItems),Z=X.next();!Z.done;Z=X.next())switch(Z=Z.value,Z.Type){case 3:ca.push(this.O4g(Z));break;
case 2:ca.push(this.x$g(Z));break;case 1:ca.push(this.n6g(Z))}return Object(c.a)(new m.a,{ControlList:ca,Title:Q.Title,DisplayMode:"Menu16",MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0})};a.prototype.Ibd=function(Q,ca){ca=[this.dsb,Q.RibbonCommand.toString(),ca?this.VYe(ca):this.VYe(Q.Label),Q.Disabled?Q.Disabled.toString():"False"];var X=Q.CommandData;X=K.a.hashCode(X).toString();ca.push(X,Q.Identifier.toString());ca=ca.join("_");Q.IsChecked&&(ca+="_Checked");
return ca};a.prototype.JFh=function(Q){var ca=[this.dsb,K.a.hashCode(Q.Title).toString()];Q=ak(Q.MenuItems);for(var X=Q.next();!X.done;X=Q.next())ca.push(X.value.RibbonCommand.toString());return ca.join("_")};a.prototype.$Ue=function(Q){var ca=Q.Label;ca=K.a.hashCode(ca).toString();ca=[this.dsb,ca];T.EwaSettings.isChangeGateEnabled("OfficeVSO:5139850_FixPivotFilterMenuDuplicatingIdenticalFields")&&Q.Id&&ca.push(K.a.hashCode(Q.Id).toString());ca=ca.join("_");Q.IsChecked&&(ca+="_Checked");return ca};
a.prototype.O4g=function(Q){var ca=this.y$b(Q,!1);var X=ca.label;var Z=ca.cLa;ca=ca.pr;var ea=this.Ibd(Q,X);return Object(c.a)(new f.a,{Command:Q.Disabled?(-251203935).toString():ca.toString(),ExternalId:ea,Id:ea,Image16by16Class:Z,LabelText:X||Q.Label,MenuItemId:Q.CommandData,CommandValueId:Q.CommandData})};a.prototype.x$g=function(Q){var ca=this.y$b(Q,Q.IsChecked);var X=ca.label;var Z=ca.cLa;ca=ca.pr;var ea=this.Ibd(Q,X);return Object(c.a)(new w.a,{Command:Q.Disabled?(-251203935).toString():ca.toString(),
ExternalId:ea,Id:ea,Image16by16Class:Z,LabelText:X||Q.Label,MenuItemId:Q.CommandData,CommandValueId:Q.CommandData,IsChecked:Q.IsChecked})};a.prototype.n6g=function(Q){var ca=this.jVe(Q);var X=ca.label;ca=ca.cLa;var Z=Object(c.a)(new e.a,{MenuSectionList:[],UpdateDynamically:!0});Array.addRange(Z.MenuSectionList,this.hpf(Q.SubMenu.Sections,!0));var ea=this.$Ue(Q);Q=X||Q.Label;return Object(c.a)(new n.a,{ExternalId:ea,Id:ea,LabelText:Q,PopulateOnlyOnce:!1,Menu:Z,Image16by16Class:ca,ImageIsVisible:!!ca})};
a.prototype.jVe=function(Q){Q=this.y$b(Q,!0);return{label:Q.label,cLa:Q.cLa,pr:Q.pr}};a.prototype.y$b=function(Q,ca){switch(Q.Identifier){case 26:var X=912804500;ca=y.a.rPe;Q=J.a.instance.ga(1926);break;case 3:X=-1902148570;ca=ca?y.a.eaa:null;Q=J.a.instance.ga(1886);break;case 4:X=-1902148570;ca=ca?y.a.eaa:null;Q=J.a.instance.ga(1887);break;case 5:X=-1902148570;ca=ca?y.a.eaa:null;Q=null;break;case 1:X=-1677817820;ca=y.a.q8b;Q=J.a.instance.ga(235);break;case 2:X=-1649376918;ca=Q.IsChecked?y.a.eua:
null;Q=J.a.instance.ga(2092);break;case 23:X=1701016594;ca=Q.IsChecked?y.a.eua:null;Q=J.a.instance.ga(2092);break;case 6:X=-87741481;ca=null;Q=J.a.instance.ga(2093);break;case 7:X=1948650742;ca=y.a.fOe;Q=J.a.instance.ga(1924);break;case 8:X=1933713114;ca=y.a.eOe;Q=J.a.instance.ga(1925);break;case 14:X=504133448;ca=y.a.HIa;Q=J.a.instance.ga(145);break;case 30:X=504133448;ca=y.a.HIa;Q=J.a.instance.ga(149);break;case 32:X=504133448;ca=y.a.HIa;Q=J.a.instance.ga(151);break;case 34:X=504133448;ca=y.a.HIa;
Q=J.a.instance.ga(153);break;case 27:X=1701016594;ca=ca?y.a.s8b:y.a.HIa;Q=J.a.instance.ga(145);break;case 15:X=-798968736;ca=y.a.IIa;Q=J.a.instance.ga(147);break;case 31:X=-798968736;ca=y.a.IIa;Q=J.a.instance.ga(150);break;case 33:X=-798968736;ca=y.a.IIa;Q=J.a.instance.ga(152);break;case 35:X=-798968736;ca=y.a.IIa;Q=J.a.instance.ga(154);break;case 28:X=1701016594;ca=ca?y.a.t8b:y.a.IIa;Q=J.a.instance.ga(147);break;case 21:X=-2058042992;ca=y.a.d2a;Q=null;break;case 29:X=1701016594;ca=y.a.d2a;Q=null;
break;case 9:X=1701016594;Q=ca=null;break;case 11:X=-1494291901;Q=ca=null;break;case 25:X=-1045020714;ca=Q.IsChecked?y.a.eua:null;Q=null;break;case 13:X=1701016594;ca=Q.IsChecked?y.a.eua:null;Q=J.a.instance.ga(156);break;case 16:X=1701016594;ca=y.a.i8b;Q=J.a.instance.ga(1059);break;case 17:X=1701016594;ca=y.a.c2a;Q=null;break;case 18:X=1701016594;ca=y.a.b2a;Q=null;break;case 19:X=1701016594;ca=y.a.j8b;Q=J.a.instance.ga(1064);break;case 20:X=1701016594;ca=y.a.J8c;Q=J.a.instance.ga(1065);break;case 24:X=
1675506831;Q=ca=null;break;case 22:X=Q.RibbonCommand;ca=Q.IsChecked?y.a.eaa:null;Q=null;break;case 36:X=1461300262;ca=null;Q=J.a.instance.ga(155);break;case 38:X=Q.RibbonCommand;ca=y.a.u8b;Q=J.a.instance.ga(1797);break;default:d.ULS.shipAssertTag(537167069,0,!1,"Unable to map menu item: {0}",JSON.stringify(Q)),X=1461300262,Q=ca=null}return{label:Q,cLa:ca,pr:X}};a.prototype.VYe=function(Q){return T.EwaSettings.isChangeGateEnabled("OfficeVSO:6130289_FixLoggingColumnNameInButtonId")?K.a.hashCode(Q+F.HelperMethods.Znj).toString():
Q};a.prototype.cCg=function(Q){if(!this.$.ea.amIAlone){var ca=this.$.da.za(25);if((void 0!==ca&&null!==ca||!T.EwaSettings.isChangeGateEnabled("OfficeVSO:5280339_GuardPresenceView"))&&!z.a.isEmpty(ca.HBa)&&(ca=ca.u_h(),!r.a.uh(ca))){var X=[];v.a.instance.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder").N8g(ca,X);Array.addRange(Q.MenuSectionList,X)}}};a.prototype.qNf=function(){this.xnd||(this.$tb&&this.$tb.gZb(this.wC),this.zpb&&this.zpb.gZb(this.wC),this.xnd=!!this.$tb||!!this.zpb)};a.prototype.Zag=
function(){this.$tb&&this.$tb.ysc(this.wC);this.zpb&&this.zpb.ysc(this.wC);this.xnd=!1};a.Amd=function(Q,ca){ca=E.C(ca);Q=O.g(Q).Ea.$Ja(ca);return!(null===Q||void 0===Q||!Q.tk)};a.Jcd=function(Q,ca,X){ca=E.C(ca);var Z=O.g(Q).Ea.$Ja(ca);ca=O.g(Q).getCellBounds(Z);var ea=Z.NMg;Z=Z.MMg;var ka=ca.x+ea.x;ca=ca.y+ea.y;X&&T.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")&&(O.g(Q).rtl||(ka+=Z),ca-=Z);return new Sys.UI.Point(ka,ca)};a.Nwh=function(Q){try{Object(B.a)(Q.CommandValueId)}catch(ca){}};
a.rh=function(Q){var ca=a.p1a.parseFromString(Q,"text/html");return ca?ca.body.innerText:(d.ULS.sendTraceTag(537167066,0,15,"Not able to decode htmlFormattedText"),Q)};Af.Object.defineProperties(a.prototype,{contextMenuRoot:{configurable:!0,enumerable:!0,get:function(){return this.Utc}},$:{configurable:!0,enumerable:!0,get:function(){return this.jb}},Va:{configurable:!0,enumerable:!0,get:function(){return this.xPc}},menuId:{configurable:!0,enumerable:!0,get:function(){return this.$.yb+this.kpf}},
$tb:{configurable:!0,enumerable:!0,get:function(){this.vIc||(this.vIc=M.a(this.$));return this.vIc}},zpb:{configurable:!0,enumerable:!0,get:function(){this.HFc||(this.HFc=O.g(this.$).Wb);return this.HFc}}});a.p1a=new DOMParser;a.nTe="Unsupported";Object(u.a)(a,"ContextMenuBase",D.a,[403,663,10])},986:function(u,D,b){function a(){}b.d(D,"a",function(){return a});u=b(0);a.ULe="ewa-ac";a.hmh="ewa-ac-param";a.NMe="ewa-function-help-link";a.C8c="ewa-lb";a.HMe="ewa-fb-refactor";a.listItem="list-item";a.rBb=
"list-item-selected";a.vBb="list-table-touch";a.uBb="list-table";a.Wrh="ewa-suggested-cell-name";a.SZg="columnName-header";a.JNe="ewa-tt";a.kph="ewa-function-link-container";a.OMe="ewa-function-udf-name";a.rtl="rtl";Object(u.a)(a,"CssClassNames",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.kpae.js.map/848e947c16e7180b85d7d6ff8559d534/EwaDS.kpae.js.map