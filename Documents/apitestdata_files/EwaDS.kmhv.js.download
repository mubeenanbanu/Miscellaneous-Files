(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1047:function(u,D,b){function a(){}b.d(D,"a",function(){return a});u=b(0);var c=b(15),d=b(4),e=b(39),k=b(25);a.WVe=function(l,m){switch(l){case 3:return a.E_h(m);case 2:return a.pTh(m);case 1:return a.FNh(m)}return""};a.E_h=function(l){switch(l){case 1:return d.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return d.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString()}return""};
a.pTh=function(l){switch(l){case 1:return d.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString();case 2:return d.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString()}return""};a.FNh=function(l){switch(l){case 1:return d.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return d.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString()}return""};a.openInClient=function(l,m,f){if(k.a.sh||k.a.Wo)window.setTimeout(function(){a.BMf(f,
a.mcc())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(a.Dpe(f),l,0,!1)};a.FYg=function(l,m,f,w){m&&w&&w();a.openInClient(l,m,f)};a.mcc=function(){return k.a.sh?1:k.a.Wo?2:k.a.j7a?3:k.a.isMac?4:0};a.A_h=function(l){switch(l){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}};a.B_h=function(l){switch(l){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";
default:return""}};a.BMf=function(l,m){1===m?(c.ULS.sendTraceTag(17151569,306,50,"User Directed to App Store"),l=a.WVe(l,m),8<k.a.$4a?e.a.Ze(l,void 0,void 0,"RedirectToAppStore"):e.a.UU(l)):document.hidden||(a.czb?(l=d.AFrameworkApplication.fa.appSettings.WildFireUrlChinaStoreAndroid.toString())?(c.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),e.a.UU(l)):c.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(c.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),
MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(a.WVe(l,m),null,null)))};a.Dpe=function(l){switch(l){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}};a.icd=function(l){switch(l){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}};a.nod=function(l){return(l=a.wQh(l))&&""!==l?Boolean.parse(l):!1};a.OOd=function(l){a.Mqj(l)};a.wQh=function(l){try{return localStorage.getItem(l)}catch(m){return c.ULS.sendTraceTag(18416668,
306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+m.message),null}};a.Mqj=function(l){try{localStorage.setItem(l,"true")}catch(m){c.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+m.message)}};Af.Object.defineProperties(a,{czb:{configurable:!0,enumerable:!0,get:function(){return"zh-CN"===window.navigator.language}},gxc:{configurable:!0,enumerable:!0,get:function(){return(k.a.j7a||k.a.isMac)&&k.a.Xo}},Txj:{configurable:!0,enumerable:!0,
get:function(){return k.a.sh||k.a.Wo}}});a.zxe="ChromeExtensionBarDismiss";Object(u.a)(a,"WildFireUtilities",null,[])},1257:function(u,D,b){function a(){c.a.vi(".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb.ewa-bb-react{background-color:#f5f5f5}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:bold}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-title,.ewa-bb-entry-message,.ewa-bb-entry-button-holder,.ewa-bb-entry-link{vertical-align:middle}.ewa-root-ltr .ewa-bb-entry-close,.ewa-nov2-ltr .ewa-bb-entry-close{right:2px}.ewa-root-ltr .ewa-bb-content,.ewa-nov2-ltr .ewa-bb-content{margin-right:26px}.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-root-ltr .ewa-bb-entry-link,.ewa-nov2-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-root-rtl .ewa-bb-entry-close,.ewa-nov2-rtl .ewa-bb-entry-close{left:2px}.ewa-root-rtl .ewa-bb-content,.ewa-nov2-rtl .ewa-bb-content{margin-left:26px}.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-root-rtl .ewa-bb-entry-link,.ewa-nov2-rtl .ewa-bb-entry-link{margin-right:8px}")}
b.d(D,"a",function(){return a});var c=b(559)},1258:function(u,D,b){function a(f,w,n,z,r,v,A){A=void 0===A?null:A;var B=m.call(this)||this;B.MI=null;B.La=w;B.yX=z;B.rga=v;B.ib=f;B.us=r;B.Se=n;B.Xhb=B.ib.ra("SaveToHostWithExtraCharsInFileName");B.Ah=A;B.mc(1,CommonUIStrings.l_SaveButtonLabel);return B}b.d(D,"a",function(){return a});u=b(0);var c=b(15),d=b(83);D=b(150);var e=b(4),k=b(43),l=b(30),m=D.a;Rk(a,m);a.prototype.sHe=function(f,w){this.WK(1,!!f&&f!==w);this.MI=document.getElementById(a.SRe);
k.a.addHandler(this.MI,"change",Object(d.a)(this,this.Tmc,"onFileNameChange"));k.a.addHandler(this.MI,"input",Object(d.a)(this,this.Tmc,"onFileNameChange"));this.MI.focus()};a.prototype.i9b=function(f){return this.Xhb?(new RegExp("["+this.S7b('\\/:*?"<>|')+"]")).test(f):(new RegExp("["+this.S7b('\\/:*?"<>|#{}%~&')+"]")).test(f)};a.prototype.S7b=function(f){return f.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")};a.prototype.phd=function(){var f=l.a.qq(e.AFrameworkApplication.am.Qm);this.WK(1,
!!this.MI&&""!==this.MI.value&&this.MI.value!==f)};a.prototype.Tmc=function(){var f=this;this.MI&&window.setTimeout(function(){f.phd()},0)};a.prototype.h9b=function(f,w){if(1!==f)c.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{f=w[a.SRe];w=a.DEf in w?w[a.DEf]:!1;c.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",l.a.orc(f),w);var n=l.a.b4(e.AFrameworkApplication.fileName);(f=f?
f.trim():null)&&""!==f&&""!==n||1===this.ta.state?this.i9b(f)?this.us.create().displayError(1,f,w):this.rga.Ona(f+n,w,this.Ah):this.us.create().displayError(2,f,w)}};a.prototype.dispose=function(){this.MI&&(k.a.removeHandler(this.MI,"change",Object(d.a)(this,this.Tmc,"onFileNameChange")),k.a.removeHandler(this.MI,"input",Object(d.a)(this,this.Tmc,"onFileNameChange")),this.MI=null);m.prototype.dispose.call(this)};Af.Object.defineProperties(a.prototype,{ta:{configurable:!0,enumerable:!0,get:function(){return this.Se}}});
a.SRe="txtFileName";a.DEf="chkOverwrite";Object(u.a)(a,"FileNameDialogBase",D.a,[])},1259:function(u,D,b){function a(z,r,v,A){this.FVb=null;this.lvg=z;this.ib=v;this.Sbe=r;this.y$d=new d.a;this.qh=A}b.d(D,"a",function(){return a});u=b(0);var c=b(15),d=b(162),e=b(83),k=b(4),l=b(739),m=b(1046),f=b(393),w=b(107),n=b(27);a.prototype.$6a=function(){return this.ib.ra("SaveToCloudStorageUIIsEnabled")};a.prototype.wVe=function(){return n.a.saveToCloudStorage};a.prototype.g1b=function(){f.a.bHd(Object(e.a)(this,
this.$Uf,"saveToCloudActionDispatcher"));f.a.A7c([new m.a(n.a.saveToCloudStorage,w.a.frame,0)],this.Sbe.M3a())};a.prototype.Cg=function(){var z=this,r=this.Sbe.M3a();r?(r.D9(function(){z.y$d.setResult(!0)}),this.g1b()):c.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")};a.prototype.pMf=function(){c.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")};a.prototype.$Uf=function(z,r,v,A,B){var y=this;return r.contextId!==
w.a.frame||z!==this.wVe()?2:this.$6a()?1===v?l.SessionStatusManager.instance.wwb||k.AFrameworkApplication.X4?8:32:2===v?(this.pMf(),B&&B.FileDownloadUrl&&c.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.qh&&(this.FVb=this.qh.sc("DialogShown","SaveToOneDriveReponseTime")),this.y$d.task.continueWith(function(){y.FVb&&(y.FVb.stop(),y.FVb=null);y.lvg.start(B)}),32):8:8};Object(u.a)(a,"SaveToCloudStorageActor",null,[715])},1260:function(u,D,b){function a(r,v,
A,B,y){this.D8=this.sm=this.zCa=null;this.hDa=!1;this.Ah=this.qga=null;this.fSc=r;this.Ekb=v;this.us=A;this.Se=B;this.qh=y}b.d(D,"a",function(){return a});u=b(0);var c=b(15),d=b(83),e=b(1261),k=b(4),l=b(41),m=b(39),f=b(247),w=b(392),n=b(170),z=b(977);a.prototype.ILb=function(){this.Se&&1===this.Se.state||(this.sm=this.Ekb(),this.sm.message=CommonUIStrings.l_CommentProgressTooltip,this.sm.Rb=5,this.sm.Qu=!1,this.sm.GAa(CommonUIStrings.l_DefaultDialogTitle,null,null))};a.prototype.lIa=function(){this.sm&&
(this.sm.close(),this.sm=null)};a.prototype.eS=function(){1!==k.AFrameworkApplication.ta.state&&this.us().displayError(e.a.default)};a.prototype.JPa=function(){c.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");m.a.Ze(this.D8,m.a.qX(3),void 0,"UploadToCloudManager.RedirectToFolder")};a.prototype.IPa=function(r){var v=!1,A=!1;k.AFrameworkApplication.fa&&(v=k.AFrameworkApplication.fa.ra("SaveACopyIsEnabledForUiHost"),A=k.AFrameworkApplication.fa.ra("UiHostSupportsDocRebootFeatures"));
c.ULS.sendTraceTag(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",r,v);if(v&&A){c.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var B={};B[w.a.DPa]="1";B[w.a.documentUrl]=r;k.AFrameworkApplication.eV().execute(function(y){y.xj(n.a.Fta,B)})}else m.a.Ze(r,m.a.qX(3),void 0,"UploadToCloudManager.RedirectToEditUrl")};a.prototype.Ona=function(r,v,A,B){A=void 0===A?null:A;B=void 0===B?null:B;c.ULS.sendTraceTag(7143886,
216,50,"Starting to upload file");this.qh&&(this.qga=this.qh.sc("DialogShown","SaveToOneDriveUploadTime"));this.ILb();this.D8=v;this.zCa=this.fSc.create(r,A,B);this.Ah=B;this.mQ()};a.prototype.mQ=function(){c.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.zCa.execute(Object(d.a)(this,this.bRi,"onSaveToCloudUploadFinished"),Object(d.a)(this,this.aRi,"onSaveToCloudUploadFailed"))};a.prototype.bRi=function(r){this.lIa();this.hDa=!1;if(r&&r.data&&r.data.Ud){var v=l.d(r.data.Ud);
var A=v.Pt;if(v.returnValue)if(A.StatusCode!==f.a.TO&&A.StatusCode!==f.a.mrb)c.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.eS();else{c.ULS.sendTraceTag(6590603,216,50,"UploadToCloudManager upload success.");try{A.NewDocumentUrl&&""!==A.NewDocumentUrl?this.IPa(A.NewDocumentUrl):this.JPa()}catch(B){c.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",B.toString())}this.JFb()}else A={},c.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",
(A.ResponseData=z.a.xeb(r.data.Ud),A)),this.eS()}else c.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.eS()};a.prototype.aRi=function(r){5!==r.data.status&&12!==r.data.status||this.hDa?(c.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",r.data.status),this.lIa(),this.eS(),this.JFb()):(c.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.hDa=!0,this.mQ())};a.prototype.JFb=function(){this.qga&&
(this.qga.stop(),this.qga=null)};Object(u.a)(a,"UploadToCloudManager",null,[712])},1261:function(u,D,b){function a(){}b.d(D,"a",function(){return a});u=b(0);a.default=0;Object(u.a)(a,"SaveToCloudErrorCodes",null,[])},1262:function(u,D,b){function a(l,m,f,w,n,z){this.Ah=null;this.hwg=l;this.R1=m;this.Wlb=f;this.ib=w;this.lQb=n;this.us=z}b.d(D,"a",function(){return a});u=b(0);var c=b(15),d=b(83),e=b(1261),k=b(84);a.prototype.start=function(l){this.Ah=l;if("SharePointOnlineConsumer"===this.ib.Wa("FileSource")){var m=
k.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(m){m.start(null,l);return}}this.R1.DLa?(c.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),this.LTg()):(c.ULS.sendTraceTag(6590560,216,50,"User is not signed in. We will show sign in dialog."),this.showSignInDialog())};a.prototype.showSignInDialog=function(){this.hwg.create().dQ()};a.prototype.kj=function(){this.us().displayError(e.a.default)};a.prototype.LTg=function(){try{c.ULS.sendTraceTag(6590561,
216,50,"Initializing OneDrive API");var l={},m=(l.client_id=this.ib.appSettings.UploadToSkyDriveClientId,l.env="INT",l);if(1===this.lQb||2===this.lQb)l={},m=(l.client_id=this.ib.appSettings.UploadToSkyDriveClientId,l);l={};var f=(l.mode="save",l.lightbox="grey",l);WL.init(m);c.ULS.sendTraceTag(6590562,216,50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog(f).then(Object(d.a)(this,this.onSuccess,"onSuccess"),Object(d.a)(this,this.c6,"onFailure"))}catch(w){c.ULS.sendTraceTag(6590563,
216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",w,w.stack),this.kj()}};a.prototype.onSuccess=function(l){c.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");l&&l.data&&l.data.folders&&this.Wlb.Ona(l.data.folders[0].id,l.data.folders[0].urls.viewInBrowser,null,this.Ah)};a.prototype.c6=function(l){if(l&&l.error){if("user_canceled"===l.error.code){c.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}c.ULS.sendTraceTag(6590594,
216,50,"File Dialog returned with error code:{0}, and error message: {1}",l.error.code,l.error.message)}else c.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.kj()};Object(u.a)(a,"SaveToCloudManager",null,[731])},1263:function(u,D,b){function a(l,m){l=k.call(this,l,m)||this;c.ULS.sendTraceTag(537170201,0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");l.title="";l.message=a.Axa;l.Dva=!0;return l}b.d(D,"a",function(){return a});u=b(0);var c=b(15),
d=b(39),e=b(81);b=b(918);var k=b.a;Rk(a,k);a.prototype.Ula=function(l){k.prototype.Ula.call(this,l);d.a.openWindow(4,e.a.fH(a.Anf))};a.prototype.UC=function(l){k.prototype.UC.call(this,l);a.qud&&a.qud(null)};a.initialize=function(l,m,f,w){c.ULS.sendTraceTag(537170200,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");a.Axa=l;a.Bnf=m;a.Anf=f;a.qud=w};Af.Object.defineProperties(a.prototype,{linkText:{configurable:!0,enumerable:!0,get:function(){return a.Bnf}}});a.Axa=null;a.Bnf=null;a.Anf=null;
a.qud=null;Object(u.a)(a,"WacGdprNoticeBusinessBarEntry",b.a,[])},1264:function(u,D,b){function a(){}b.d(D,"a",function(){return a});u=b(0);a.omh="ewa-bb";a.qmh="ewa-bb-entry";a.ymh="ewa-bb-react";a.rmh="ewa-bb-entry-body";a.xmh="ewa-bb-icon";a.tmh="ewa-bb-entry-icon";a.wmh="ewa-bb-entry-title";a.vmh="ewa-bb-entry-message";a.VLe="ewa-bb-entry-button";a.umh="ewa-bb-entry-link";a.smh="ewa-bb-entry-close";a.WLe="ewa-bb-entry-button-holder";a.pmh="ewa-bb-content";Object(u.a)(a,"CssClassNames",null,[])},
1265:function(u,D,b){function a(d,e){d=c.call(this,d,e)||this;d.Pu=!0;d.title=a.Toa;d.message=a.Roa;return d}b.d(D,"a",function(){return a});u=b(0);b=b(918);var c=b.a;Rk(a,c);a.prototype.ro=function(d){c.prototype.ro.call(this,d);(d=a.Soa)&&d(null)};a.initialize=function(d,e,k,l){a.Toa=d;a.Roa=e;a.Qoa=k;a.Soa=l};Af.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.Qoa}}});a.Toa=null;a.Roa=null;a.Qoa=null;a.Soa=null;Object(u.a)(a,"AutomaticSensitivityLabelBusinessBarEntry",
b.a,[])},1266:function(u,D,b){function a(d,e){d=c.call(this,d,e)||this;d.Pu=!0;d.title=a.Toa;d.message=a.Roa;return d}b.d(D,"a",function(){return a});u=b(0);b=b(918);var c=b.a;Rk(a,c);a.prototype.ro=function(d){c.prototype.ro.call(this,d);(d=a.Soa)&&d(null)};a.initialize=function(d,e,k,l){a.Toa=d;a.Roa=e;a.Qoa=k;a.Soa=l};Af.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.Qoa}}});a.Toa=null;a.Roa=null;a.Qoa=null;a.Soa=null;Object(u.a)(a,"RecommendedSensitivityLabelBusinessBarEntry",
b.a,[])},1267:function(u,D,b){function a(d,e){d=c.call(this,d,e)||this;d.Pu=!0;d.title=a.Toa;d.message=a.Roa;return d}b.d(D,"a",function(){return a});u=b(0);b=b(918);var c=b.a;Rk(a,c);a.prototype.ro=function(d){c.prototype.ro.call(this,d);(d=a.Soa)&&d(null)};a.initialize=function(d,e,k,l){a.Toa=d;a.Roa=e;a.Qoa=k;a.Soa=l};Af.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.Qoa}}});a.Toa=null;a.Roa=null;a.Qoa=null;a.Soa=null;Object(u.a)(a,"MandatorySensitivityLabelBusinessBarEntry",
b.a,[])},1268:function(u,D,b){function a(d,e){d=c.call(this,d,e)||this;d.Pu=!0;d.title=a.cCb;d.message=a.Axa;return d}b.d(D,"a",function(){return a});u=b(0);b=b(918);var c=b.a;Rk(a,c);a.prototype.ro=function(d){c.prototype.ro.call(this,d);a.Cxa&&a.Cxa(null)};a.initialize=function(d,e,k,l){a.cCb=d;a.Axa=e;a.a8a=k;a.Cxa=l};Af.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.a8a}}});a.cCb=null;a.Axa=null;a.a8a=null;a.Cxa=null;Object(u.a)(a,"SensitivityLabelMinorVersionLimitReachedBusinessBarEntry",
b.a,[])},1269:function(u,D,b){function a(d,e){d=c.call(this,d,e)||this;a.a8a&&a.Cxa&&(d.Pu=!0);d.title=a.cCb;d.message=a.Axa;return d}b.d(D,"a",function(){return a});u=b(0);b=b(918);var c=b.a;Rk(a,c);a.prototype.ro=function(d){c.prototype.ro.call(this,d);a.Cxa&&a.Cxa(null)};a.initialize=function(d,e,k,l){a.cCb=d;a.Axa=e;a.a8a=k;a.Cxa=l};Af.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.a8a}}});a.cCb=null;a.Axa=null;a.a8a=null;a.Cxa=null;Object(u.a)(a,
"SensitivityApplicationSetLabelErrorBusinessBarEntry",b.a,[])},1270:function(u,D,b){b.d(D,"a",function(){return a});var a;"undefined"==typeof a&&(a={});window.MSOJS=a;a.Xfb=function(){function c(){return f()&&(y()||3<=(v()?x("version/"):0))}function d(){return 0<=window.navigator.userAgent.indexOf("Windows")}function e(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function k(){Va||(Va=!0,yb=l("Windows Phone"))}function l(nb){nb=(new RegExp(nb+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);
var zb=-1;return null!=nb&&2<=nb.length&&(zb=parseFloat(nb[1]),isNaN(zb)&&(zb=-1)),zb}function m(){return"function"==typeof navigator.msLaunchUri&&!e()&&!B()&&!w()}function f(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function w(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function n(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function z(){return n()?8==window.document.documentMode:!1}function r(){return 0<=
window.navigator.userAgent.indexOf(" Firefox/")}function v(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function A(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function B(){var nb=window.navigator.userAgent.toLowerCase();return 0<=nb.indexOf("android")&&0<=nb.indexOf("chrome")}function y(){return 3<=(r()?x("firefox/"):0)}function x(nb){var zb=window.navigator.userAgent.toLowerCase(),ma=zb.indexOf(nb),P,oa;return 0<=ma?(P=ma+nb.length,oa=zb.length,parseInt(zb.substring(P,
oa))):0}function C(nb,zb,ma,P,oa){if(P&&null!=zb)zb();else if(m())navigator.msLaunchUri(nb,zb,ma);else if(!(A()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&f())||w())E(nb,zb,ma);else if(A()&&oa)a:{try{window.open(nb,"_self")}catch(Ja){null!=ma&&ma();break a}null!=zb&&zb()}else G(nb,zb,ma)}function G(nb,zb,ma){var P=document.getElementById("OICLinkTag"),oa;null==P&&(P=document.createElement("a"),P.id="OICLinkTag",P.style.visibility=
"hidden",P.href="",P.target=0==(Ub.Options&dc.SupportsTopTargetNavigation)||Ub.NoBrowserModalDialogs?"_blank":"_top",document.body.appendChild(P),null!=P.addEventListener&&P.addEventListener("click",function(Ja){null!=Ja.stopPropagation&&Ja.stopPropagation()},!1));try{"undefined"==typeof MouseEvent&&(oa=function(Ja){var $a=document.createEvent("MouseEvent");return $a.initMouseEvent(Ja,!1,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),$a},oa.prototype=Event.prototype,window.MouseEvent=oa),P.href=nb,P.dispatchEvent(new MouseEvent("click"))}catch(Ja){null!=
ma&&ma();return}null!=zb&&zb()}function E(nb,zb,ma){var P=document.getElementById("OICFrame");null==P&&(P=document.createElement("iframe"),P.className="ObjectInDialog",P.style.visibility="hidden",P.src="about:blank",document.body.appendChild(P),P.id="OICFrame");try{P.contentWindow.location.href=nb}catch(oa){null!=ma&&ma();return}null!=zb&&zb()}function I(nb){return 0!=(nb.Options&dc.SkipProtocolHandler)||z()}function U(nb){return nb===qb.ReadOnly||nb===qb.ReadWrite}function M(nb,zb,ma,P){var oa,Ja;
try{if(oa=new ActiveXObject(Qa),oa)return Ja=oa.ViewDocument3(window.self,nb,zb,P),Ja?(qa(db.O14ActiveX),bb.None):bb.Failed}catch($a){}if(dc.O14Only===(ma&dc.O14Only))return Ub.DescriptiveUnattemptedEnums?bb.O14AttemptFailure:bb.Unattempted;try{if(oa=new ActiveXObject(S),oa)return Ja=oa.ViewDocument3(window.self,nb,zb,P),Ja?(qa(db.O12ActiveX),bb.None):bb.Failed}catch($a){}if(dc.O12UpOnly===(ma&dc.O12UpOnly))return Ub.DescriptiveUnattemptedEnums?bb.O12UpOnlyFail:bb.Unattempted;try{if(oa=new ActiveXObject(da),
oa)return Ja=U(zb)?oa.ViewDocument2(window.self,nb,P):oa.EditDocument2(window.self,nb,P),Ja?(qa(db.O11ActiveX),bb.None):bb.Failed}catch($a){}return Ub.DescriptiveUnattemptedEnums?bb.ActiveXUnattempted:bb.Unattempted}function T(nb,zb,ma,P,oa){var Ja,$a,Ta;nb==wc.Visio&&ma==qb.ReadWrite&&(ma=qb.WriteOnly);nb=oa;(P=P||e()&&!(k(),8<=yb))||(Ja="",Ja+=U(ma)?na+ba:sa,Ja+=ya,nb+=K(Ja));nb+=K(zb);Ub.NewTelemetryDataIsEnabled&&($a=-1!==nb.indexOf("?")?"&":"?",$a+=Ub.SessionOrigin?"OR="+Ub.SessionOrigin+"&":
"",$a+=Ub.ClickTime?"CT="+Ub.ClickTime+"&":"",$a+=Ub.CorrelationId?"CID="+Ub.CorrelationId:"",$a="?"!=$a?$a:"",$a="&"!=$a.slice(-1)?$a:$a.slice(0,-1),nb+=K($a),Ub.CorrelationIdForWinClient&&(nb+=K(Ub.CorrelationIdForWinClient)));zb=window.location.href;ma=W;P=zb.toLowerCase().indexOf("&"+ma+"=");var pa;ma=-1==P?void 0:(Ta=P+(ma.length+2),pa=zb.indexOf("&",Ta),-1==pa)?zb.substr(Ta):zb.substring(Ta,pa);if(null!=ma&&"undefined"!=typeof ma){Ta="";try{Ta=decodeURIComponent(ma)}catch(Da){}0<Ta.length&&
RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(Ta)&&(nb+=va,nb+=Ta)}return nb}function F(nb,zb,ma,P,oa,Ja){var $a=ea(nb),Ta;return null==$a?(fa(Ub.DescriptiveUnattemptedEnums?bb.ProtocolHandlerIsNull:bb.Unattempted,Ub.Application),!1):(Ta=T(nb,zb,ma,P,$a),C(Ta,J,O,oa,Ja),!0)}function K(nb){if(f()&&A()){var zb="";try{zb=decodeURI(nb)}catch(ma){}if(zb==nb)return encodeURI(nb)}return nb}function J(){qa(db.ProtocolHandler)}function O(){Ub.Options|=dc.SkipProtocolHandler;Y(Ub,fb,Ma)}
function N(){null!=Hb&&Hb(db.RoamingProtocolHandler)}function H(){null!=Kb&&Kb(bb.ControlNeeded)}function Q(){var nb=document.getElementById(la),zb;if(null==nb){if(zb=xa,f()&&3<=(v()?x("version/"):0)&&ca(ta,!0)&&(zb=ta),!ca(zb,!0))if(f()&&ca(Ka,!0))zb=Ka;else return null;nb=document.createElement("object");nb.id=la;nb.type=zb;nb.style.width="0px";nb.style.height="0px";nb.style.setProperty("visibility","hidden","");document.body.appendChild(nb);nb=document.getElementById(la)}return nb}function ca(nb,
zb){var ma=window.navigator.mimeTypes,P;return null==ma?!1:(P=ma[nb],P)?zb&&!P.enabledPlugin?!1:!0:!1}function X(nb){try{if(null!=new ActiveXObject(nb))return!0}catch(zb){}return!1}function Z(nb){switch(nb){case wc.OneNote:return ra;default:return""}}function ea(nb){if(nb!=wc.OneNote&&e()&&!(k(),8<=yb))return"office:";switch(nb){case wc.Excel:return"ms-excel:";case wc.OneNote:return"onenote:";case wc.PowerPoint:return"ms-powerpoint:";case wc.Visio:return"ms-visio:";case wc.Word:return"ms-word:";case wc.Project:return"ms-project:";
case wc.Publisher:return"ms-publisher:";case wc.Infopath:return"ms-infopath:";case wc.Access:return"ms-access:";default:return""}}function ka(nb){switch(nb){case wc.Excel:return"root\\office15\\excel.exe";case wc.PowerPoint:return"root\\office15\\powerpnt.exe";case wc.Visio:return"root\\office15\\visio.exe";case wc.Word:return"root\\office15\\winword.exe";case wc.Project:return"root\\office15\\winproj.exe";case wc.Publisher:return"root\\office15\\mspub.exe";case wc.Infopath:return"root\\office15\\infopath.exe";
case wc.Access:return"root\\office15\\msaccess.exe";default:return null}}function Y(nb,zb,ma){if(Ub=nb,fb=zb,Ma=ma,nb.DocumentUrl){var P=ma=zb=nb.DocumentUrl;try{P=decodeURIComponent(nb.DocumentUrl)}catch(Da){}try{ma=encodeURI(nb.DocumentUrl)}catch(Da){}Ub.NewTelemetryDataIsEnabled||(zb=zb+""+nb.CorrelationIdForWinClient,P+=nb.CorrelationIdForWinClient,ma+=nb.CorrelationIdForWinClient);nb.Mode===qb.ReadWrite&&dc.CheckoutRequired===(nb.Options&dc.CheckoutRequired)&&(nb.Mode=qb.ForceCheckout);dc.HostIsEditOnly===
(nb.Options&dc.HostIsEditOnly)&&(nb.Mode=qb.WriteOnly);if(I(nb)?0:f()&&(nb.Application==wc.OneNote||ca(ab,!1)||ca(Na,!1))||m()||B()||!(c()||y()||"ActiveXObject"in window&&!e()||A())||15<=ha())F(nb.Application,nb.EncodeUrl?ma:zb,nb.Mode,nb.Application==wc.OneNote,nb.SilentExternalHandler,nb.NavigateUsingWindowOpen);else{var oa;if(oa=z())a:{var Ja=nb.EncodeUrl?zb:P,$a=nb.Mode,Ta=Z(nb.Application);try{oa=(new ActiveXObject(wa)).ViewDocument3(window.self,Ja,$a,Ta);break a}catch(Da){}oa=!1}if(oa)qa(db.O15ActiveX);
else{if(c()||y()){var pa=nb.EncodeUrl?zb:P;P=nb.Mode;oa=Z(nb.Application);Ja=Q();if(null==Ja)pa=Ub.DescriptiveUnattemptedEnums?bb.PluginIsNull:bb.Unattempted;else{$a=!1;try{$a=Ja.ViewDocument3(window.self,pa,P,oa)}catch(Da){}if(!$a)try{$a=U(P)?Ja.ViewDocument2(window.self,pa,oa):Ja.EditDocument2(window.self,pa,oa)}catch(Da){}pa=$a?(qa(db.NpapiPlugin),bb.None):bb.Failed}}else{try{pa=new ActiveXObject(Ea),null!=pa&&pa.SaveSSOCreds()}catch(Da){}pa=M(nb.EncodeUrl?zb:P,nb.Mode,nb.Options,Z(nb.Application))}if(pa!=
bb.None){if(P=nb.CouldUseRoamingApps)gb||(gb=!0,Db=l("Windows NT")),P=6.1<=Db&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(n()||y()||A());if(P&&nb.Application!=wc.OneNote){if(!a.Xfb.uYj()){fa(bb.ControlNeeded,Ub.Application);return}if(nb.RoamingAppsLauncher){"undefined"==typeof nb.RoamingAppsLauncher||null==nb.RoamingAppsLauncher?fa(Ub.DescriptiveUnattemptedEnums?bb.RoamingLauncherIsNull:bb.Unattempted,Ub.Application):"undefined"==typeof nb.RoamingBitsUrl||null==nb.RoamingBitsUrl?a.Xfb.MYj(nb.DocumentUrl,
nb.RoamingAppsLauncher,nb.Application,nb.ApplicationParameters,fb,Ma):a.Xfb.yig(nb.DocumentUrl,nb.RoamingAppsLauncher,nb.RoamingApplicationExe,nb.ApplicationParameters,nb.RoamingPlatform,nb.RoamingBitsUrl,fb,Ma);return}if(!nb.ContinueIfLauncherIsNull){fa(bb.LauncherNeeded,Ub.Application);return}}dc.NoProtocolHandlerFallback==(nb.Options&dc.NoProtocolHandlerFallback)||I(nb)||n()||f()&&!(Ub.DescriptiveUnattemptedEnums?pa>=bb.O14Unattempted&&pa<=bb.DocumentUrlIsNull:pa==bb.Unattempted)?fa(pa,Ub.Application):
F(nb.Application,nb.EncodeUrl?ma:zb,nb.Mode,nb.Application==wc.OneNote,nb.SilentExternalHandler,nb.NavigateUsingWindowOpen)}}}}else fa(Ub.DescriptiveUnattemptedEnums?bb.DocumentUrlIsNull:bb.Unattempted,Ub.Application)}function qa(nb){null!=fb&&fb(nb)}function fa(nb,zb){"undefined"==typeof zb&&(zb=null);null!=Ma&&Ma(nb,zb)}function ha(){var nb=0;if(c()||y()||A()){var zb=Q();try{null!=zb&&(nb=zb.GetOfficeVersion())}catch(ma){}}else X(wa)?nb=15:X(Qa)?nb=14:X(S)?nb=12:X(da)&&(nb=11);return nb}function ia(){return f()&&
(ca(xa,!0)||ca(ta,!0))}var wa="SharePoint.OpenDocuments.5",Qa="SharePoint.OpenDocuments.4",S="SharePoint.OpenDocuments.3",da="SharePoint.OpenDocuments.2",xa="application/x-sharepoint",ta="application/x-sharepoint-webkit",ab="application/x-sharepoint-protocolhandler",Na="application/x-sharepoint-webkit-protocolhandler",Ka="application/officelive",la="npSharePointPlugin",Ea="IDBHO.IDBHOCtrl",ra="OneNote.Notebook",na="ofv|",ba="ofc|",sa="ofe|",ya="u|",va="|f|",W="wdlor",La="",Ia="",mb="",fb,Ma,Hb,Kb,
Ub,gb,Db,Va,yb,qb={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},dc={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},bb={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},
db={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},wc={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:qb,OpenDocumentOptions:dc,OpenDocumentFailureType:bb,OpenDocumentControl:db,OfficeApplication:wc,EditDocumentInClient:Y,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=
0;this.Application=wc.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:ha,
IsO14MacPluginInstalled:ia,OfferOfficeInDialog:function(){return d()&&11>=ha()},OfferOfficeNoIntrusive:function(){return d()&&15>ha()},OfferMacOffice:function(){return f()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!ia()},InstallRoamingControl:function(){r()?window.InstallTrigger.install({Office:{URL:Ia}}):E(mb,null,null)},CanUseRoamingControl:function(){var nb,zb,ma;if(m())return!0;if(A())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];
if(r())return nb=document.createElement("RoamingExtensionElement"),document.documentElement.appendChild(nb),zb=document.createEvent("Events"),zb.initEvent("RoamingOfficeInstalled",!0,!1),nb.dispatchEvent(zb),!!nb.getAttribute("installed");if(n())try{return ma=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),ma.HrExists()}catch(P){}return!1},InitUrls:function(nb,zb,ma){La=nb;Ia=ma;mb=zb},LaunchRoamingApps:function(nb,zb,ma,P,oa,Ja){a.Xfb.yig(nb,zb,ka(ma),P,"x86",La,oa,Ja)},LaunchRoamingApps2:function(nb,
zb,ma,P,oa,Ja,$a,Ta){var pa="",Da;if(null!=P&&(pa+=" "+P),null!=nb&&(pa+=' "'+nb+'"'),m()||A())Hb=$a,Kb=Ta,$a='office: "'+(Ja+'" "')+(ma+'" "ROAMING"'),$a+=' "'+zb+'"',$a+=' "'+oa+'"',$a+=" "+pa,C($a,N,H,!1,!1);else if(r())nb=document.createElement("RoamingExtensionElement"),nb.setAttribute("cabUrl",Ja),nb.setAttribute("app",ma),nb.setAttribute("licensingEntitlements",zb),nb.setAttribute("platform",oa),nb.setAttribute("args",pa),document.documentElement.appendChild(nb),zb=document.createEvent("Events"),
zb.initEvent("RoamingOfficeLaunch",!0,!1),nb.dispatchEvent(zb),null!=$a&&$a(db.RoamingFFExtension);else if(n()){if(Da=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=Da)try{Da.HrConfigureSingle(Ja,ma,zb,oa,pa),null!=$a&&$a(db.RoamingActiveX)}catch(rb){}}else null!=Ta&&Ta(bb.Failed)},ShouldShowDialog:function(){return!e()},NavigateToUrlUsingClickingOnATag:G,OpenDocumentWithProtocolHandler:F,OpenDocumentWithProtocolHandlerNoCallBack:function(nb,zb,ma,P){var oa=ea(nb),Ja;return null==oa?
(fa(Ub.DescriptiveUnattemptedEnums?bb.ProtocolHandlerNoCallbackIsNull:bb.Unattempted,Ub.Application),!1):(Ja=T(nb,zb,ma,P,oa),C(Ja,null,null,!1,!1),!0)}}}();a.ClientUtils=a.Xfb},1271:function(u,D,b){function a(d,e){this._url=d;this.dtg=e}b.d(D,"a",function(){return a});u=b(0);var c=b(39);a.prototype.Lre=function(){};a.prototype.g6c=function(){this.dtg?c.a.downloadFile(this._url):c.a.Ze(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")};a.prototype.dispose=function(){};Object(u.a)(a,
"OpenUrlInTabDialogDownloadBehavior",null,[308,10])},1272:function(u,D,b){function a(){c.a.vi(".HyperlinkDialog .ewa-dlg-body-sectionlabel{margin-bottom:5px}.HyperlinkDialog .disabledInput{background-color:#ebebe4;border:solid 1px #b5b5b5}.HyperlinkDialog .ewa-dlg-body-fullLine{width:inherit;min-width:318px;padding-right:5px;padding-left:25px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-fullLine{padding-right:25px;padding-left:5px}.HyperlinkDialog input[type=text]{width:100%;outline:none;padding-left:3px;border:solid 1px #ccc}.HyperlinkDialog .ewa-dlg-body-sectionbreak{height:50px;position:relative}.HyperlinkDialog input[type=radio]{position:absolute;left:0}.ewa-dlg-elements-container-rtl .HyperlinkDialog input[type=radio]{left:auto;right:0}.HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-left:24px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-right:24px;margin-left:auto}.ValidationLabel{position:relative;display:block}.ValidationLabelWarning{color:#cc4200}.ValidationLabelError{color:#d90000}.ValidationWarningGlowColor,.ValidationErrorGlowColor,.ValidationLableGlow{border-style:solid;border-width:1px;-webkit-transition:all .2s ease-in-out;-moz-transition:all .2s ease-in-out;-ms-transition:all .2s ease-in-out;-o-transition:all .2s ease-in-out}.HyperlinkDialog div .ValidationErrorGlowColor{box-shadow:0 0 2px #d90000;border-color:#d90000}.HyperlinkDialog div .ValidationWarningGlowColor{box-shadow:0 0 2px #cc4200;border-color:#cc4200}")}
b.d(D,"a",function(){return a});var c=b(559)},1273:function(u,D,b){function a(l,m,f,w,n,z){this.QX=l;this.RX=m;this.zJc=f;this.zD=w;this.FRb=n;this.yUa=z}b.d(D,"a",function(){return a});u=b(0);var c=b(1400),d=b(4),e=b(52),k=b(84);a.prototype.c5i=function(l){this.Jsf(l)};a.prototype.Nri=function(l){this.Jsf(l)};a.prototype.Jsf=function(l){var m=10;1===l?(k.a.instance.resolve("Common.IOfficeTrialExperience").ojc(this.yUa),m=3):2===l&&((!this.zJc||this.zJc(this.zD))&&this.RX&&c.a.instance.Y7g(this.RX,
this.QX,this.zD),m=5);(0===l||1===l)&&this.QX&&this.QX(this.zD);d.AFrameworkApplication.ctc(e.a.fEf,this.FRb,m);this.dispose()};a.prototype.dispose=function(){this.zD=this.RX=this.QX=null};Af.Object.defineProperties(a.prototype,{Q2f:{configurable:!0,enumerable:!0,get:function(){return!this.RX&&!this.zJc}},nsf:{configurable:!0,enumerable:!0,get:function(){return 2===this.yUa?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}},id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialogWithTrial"}},
wLe:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMessageNoOffice}},l8e:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}},Hva:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},S6e:{configurable:!0,enumerable:!0,get:function(){return"OICFailure"}},icon:{configurable:!0,enumerable:!0,get:function(){return 3}},JXb:{configurable:!0,enumerable:!0,get:function(){return 2===this.yUa?
CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}},Al:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});Object(u.a)(a,"AOICErrorDialogWithTrial",null,[10])},1274:function(u,D,b){function a(){this.BaseDocQuerySignature=null;this.RoamingApp=0}b.d(D,"a",function(){return a});u=b(0);var c=b(1560),d=b(4),e=b(41),k=b(81);a.prototype.dNd=function(){return e.c([this.Caa(),this])};a.prototype.execute=function(l,m,f){var w=
"RoamingAppsHandler.ashx";c.a.instance.roamingAppsAreEnabled&&0<document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")&&(w=k.a.vl(w,"wdEnableRoaming","1"));d.AFrameworkApplication.qd.Yl(w,2,this.dNd(),{"Content-Type":"application/json; charset=utf-8"},!1,this.Fvb(),l,m,f,void 0,void 0,void 0,void 0,"6")};Object(u.a)(a,"ARoamingAppsRequest",null,[])},1275:function(u,D,b){function a(){c.a.vi(".ewa-presentMode-overlay{pointer-events:none}.ewa-presentMode-panel-container{z-index:1054;position:absolute;bottom:32px;visibility:hidden}.ewr-presentMode-on .ewa-presentMode-panel-container{visibility:visible}.ewa-presentMode-rowHdrParent-container{position:relative;z-index:1055}.ewa-presentMode-right-frame{position:absolute;bottom:32px;top:0;right:0;width:0;opacity:0;background-color:#f5f5f5}.ewr-presentMode-on .ewa-presentMode-right-frame{width:32px;opacity:1;background-color:#323130}.ewr-presentMode-on-rtl .ewa-presentMode-right-frame{width:0;opacity:0}.ewr-presentMode-on-headers-off .ewa-presentMode-right-frame{width:12px !important;opacity:1}.ewr-namedsheetview .ewa-presentMode-right-frame{background-color:#000 !important}.ewr-presentMode-transition .ewa-presentMode-right-frame{transition:background-color .4s linear}.ewr-presentMode-on #dialogHost{z-index:1056 !important}")}
b.d(D,"a",function(){return a});var c=b(559)},1276:function(u,D,b){function a(){c.a.vi('.PrintDialogBody{height:260px;width:516px;margin-top:17px}.PrintDialogTitle{font-size:21px;margin-top:14px;margin-left:18px;font-family:"Segoe UI Light"}.ewa-dlg-elements-container-rtl .PrintDialogTitle{margin-left:auto;margin-right:18px}.PrintDialogLeftContainer{float:left;width:240px;height:100%;font-size:14px;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogLeftContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRightContainer{float:left;font-size:14px;width:240px;height:inherit;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogRightContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRadioButtonContainer{width:224px;height:32px;display:flex;align-items:center}.PrintRadioButtonElementInnerDiv{vertical-align:middle;display:table-cell}.PrintRadioButtonElementOuterDiv{position:absolute;top:0;left:64px;height:32px;width:140px;vertical-align:middle;display:table}.ewa-dlg-elements-container-rtl .PrintRadioButtonElementOuterDiv{left:auto;right:64px}.PrintDialogTitleSection{width:224px;height:19px}.PrintDialogComboBoxContainer{width:224px;height:32px;margin-top:12px}.PrintRadioButtonIcon{margin:0 16px;vertical-align:middle}.PrintButtonArea{margin-right:32px}.ewa-dlg-elements-container-rtl .PrintButtonArea{margin-right:auto;margin-left:32px}.PrintPreviewerContainer{height:100%;width:100%;z-index:998;position:absolute;background:#edebe9}.ewa-hide-print-elements-siblings{display:none}')}
b.d(D,"a",function(){return a});var c=b(559)},1277:function(u,D,b){function a(){c.a.vi(".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}")}b.d(D,"a",function(){return a});var c=b(559)},1283:function(u,D,b){function a(d){this.isEnabled=Boolean.parse(d.DirectPrintIsEnabled||"false");Boolean.parse(d.DirectPrintProbeIsEnabled||"false");this.Nii=Boolean.parse(d.DirectPrintEnabledForInternetExplorer||"false");this.ySa=(d.DirectPrintSupportedMimeTypes||"").split(a.N5c);
this.zSa=(d.DirectPrintSupportedPlugins||"").split(a.N5c);this.a8h=(d.DirectPrintImmersivePreviewPlugins||"").split(a.N5c);this.Ybf=Boolean.parse(d.DirectPrintEnabledForEdge||"false");this.wfi=Boolean.parse(d.ChromePrintLayoutFixIsEnabled||"false");this.oXg=parseInt(d.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.Nvd=14;this.Fpf=14394;if(d=d.DirectPrintMinimalSupportedEdgeVersion){var e=d.split(".");2===e.length?(this.Nvd=parseInt(e[0]),this.Fpf=parseInt(e[1])):c.ULS.sendTraceTag(20734112,
208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",d)}else c.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}b.d(D,"a",function(){return a});u=b(0);var c=b(15);a.N5c=",";Object(u.a)(a,"DirectPrintBrsSettings",null,[])},1284:function(u,D,b){function a(){this.printOperationCallbacks=this.universalPrintAppSettings=this.setAdditionalHeaderText=this.disableBackToSheetButton=this.disableTellMeControl=
this.logger=this.printPreviewPaneCallbacks=this.backActionButtonText=null}b.d(D,"a",function(){return a});u=b(0);Object(u.a)(a,"PrintPreviewPaneProps",null,[])},1285:function(u,D,b){function a(){}b.d(D,"a",function(){return a});u=b(0);a.w0i="PrintDialogBody";a.printDialogTitle="PrintDialogTitle";a.a8b="ewa-dlg-elements-container-rtl";a.x0i="PrintDialogLeftContainer";a.y0i="PrintDialogRightContainer";a.U$a="PrintDialogRadioButtonContainer";a.jIf="PrintRadioButtonElementInnerDiv";a.E0i="PrintRadioButtonElementOuterDiv";
a.V$a="PrintDialogTitleSection";a.vEd="PrintDialogComboBoxContainer";a.F0i="PrintRadioButtonIcon";a.v0i="PrintButtonArea";a.Aw="PrintPreviewerContainer";Object(u.a)(a,"CssClassNames",null,[])},1348:function(u,D,b){function a(){Z.a.Fa(c.ka)}function c(Fb){return ub.call(this,Fb)||this}function d(Fb,pc,eb){var ic=this;this.ignorePrintArea=!1;this.LLj=function(){var Ac=ta.g(ic.$).Ea;ic.yQc=!0;Ac.Fxd()};this.uPi=function(){ic.Bhd()};this.tPi=function(Ac,lc,Gc){ka.ULS.sendTraceTag(537154272,0,10,"PrintCommandHandler:OnPageLayoutCommandFailure Method : {0} failed to execute",
Gc);ic.Bhd()};this.$=Fb;this.ea=Fb.ea;this.gia=pc;this.HN=new K(1,this.ignorePrintArea);this.hD=pc=new e(Fb,pc,Y.AFrameworkApplication.qd,eb);this.$.da.Ga(418,pc);this.bIf=new x(Fb);this.$.da.Ga(384,this);this.yQc=!1}function e(Fb,pc,eb,ic){var Ac=this;this.activeCell=this.selectedRange=this.lg=this.graphServiceEndpoint=null;this.Q_=0;this.Gm=this.av=null;this.tH=new y;this.qk=new y;this.Pba=0;this.u7a=null;this.uMb=!1;this.Q2a=this.rFb=null;this.cpd=!1;this.u6a=this.rzb=this.Zgc=!0;this.gma=this.Kya=
this.WMa=null;this.ryb=!1;this.r7a=null;this.M5a=this.TKc=!1;this.szd=function(lc){if(!(lc&&lc.data&&lc.data.Ud&&lc.data.responseHeaders&&lc.data.Ud.length)){var Gc=lc?lc.data?lc.data.Ud?lc.data.responseHeaders?lc.data.Ud.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs";Ac.lg&&(lc=Ac.Tza(xa.a.instance.ga(1192)),Ac.Fna(lc,0));ka.ULS.sendTraceTag(593266765,
0,10,"PrintPreviewManager:OnFileHandlerSuccessCallback - Invalid Parameter : {0}",Gc);Ac.IJd&&(lc=Object(ma.a)(new ob.a,{extendedProperties:new Map}),lc.extendedProperties.set("InvalidParameterName",Gc),oa.Health.instance.recordQosError(Da.a.dIf,[rb.a.eIf],!1,!0,!0,!1,lc))}else if(0<Ac.Pba&&lc.data.id===Ac.Pba){if(lc.data.responseHeaders["Content-Type"]&&(db.a.contains(lc.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)||db.a.contains(lc.data.responseHeaders["Content-Type"].toString(),
"text/plain",!0))){ka.ULS.sendTraceTag(593266764,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - pdf converted successfully");var ed=null;db.a.contains(lc.data.responseHeaders["Content-Type"].toString(),"text/plain",!0)&&(ed=Ac.L4g(lc));Gc={};Ac.TDb(Gc,null,null,ed);lc.data.responseHeaders["Total-Pdf-PageCount"]?(ed=parseInt(lc.data.responseHeaders["Total-Pdf-PageCount"].toString(),10),Ac.ryb||(Ac.yEd>=ed?Ac.gma=ed:Ac.ryb=!0),Ac.u6a&&Ac.lg&&Ac.lg.setPageRangeSettings(ed,Ac.yEd,Ac.ryb,Ac.Kya,
Ac.gma)):ka.ULS.sendTraceTag(537154257,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - did not receive the TotalPdfPageCount header.")}else Gc=gb.a.Vh(lc.data.Ud),bb.a.S9(Gc.Errors)||ec.a(Ac.$).fd.hJ(Gc.Errors[0].MessageId),Ac.D6i(Gc.Errors),Ac.lg&&(ed=Ac.Tza(Gc.Errors[0].Description),-1831476778===Gc.Errors[0].MessageId?(ka.ULS.sendTraceTag(537154256,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - showing pdf print timeout error message"),Ac.Fna(ed,0,xa.a.instance.ga(1195))):Ac.Fna(ed,
0)),297284985===Gc.Errors[0].MessageId?ka.ULS.sendTraceTag(570716892,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - Nothing to print. Message Id: {0}",Gc.Errors[0].MessageId):ka.ULS.sendTraceTag(593266763,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: {0}",Gc.Errors[0].MessageId);lc=lc.data.state;lc.H8c(Gc,lc.userContext,lc.methodName)}};this.rzd=function(lc){if(0<Ac.Pba&&lc.data.id===Ac.Pba){var Gc=ya.a.Of(lc.data);Ac.lg&&Ac.Fna(Ac.Tza(Gc[0].Description),
1);ka.ULS.sendTraceTag(593266762,0,15,"PrintPreviewManager:OnFileHandlerFailureCallback has failed - Errors: [{0}]",bb.a.Dc(Gc));Gc=lc.data.state;Gc.kaa(lc,Gc.userContext,Gc.methodName);Ac.$.userOperationManager.Oka.operation.qna(function(){return Ac.uMb})}};this.zIi=function(lc,Gc,ed){lc.Errors&&0<lc.Errors.length&&Ac.lg?(bb.a.S9(lc.Errors)||ec.a(Ac.$).fd.hJ(lc.Errors[0].MessageId),Ac.Fna(Ac.Tza(lc.Errors[0].Description),0),ka.ULS.sendTraceTag(537154254,0,50,"PrintPreviewManager: Failed to convert workbook. Error message Id: {0}",
lc.Errors[0].MessageId)):(ka.ULS.sendTraceTag(537154253,0,50,"PrintPreviewManager:OnConvertWorkbookToPdfSucceededInWebParts - Pdf conversion succeeded"),Ac.TDb(lc,Gc,ed,null))};this.yIi=function(lc){lc=ya.a.Of(lc.data);Ac.lg&&Ac.Fna(Ac.Tza(lc[0].Description),1);ka.ULS.sendTraceTag(537154252,0,15,"PrintPreviewManager:OnConvertWorkbookToPdfFailed invoked - Errors: [{0}]",bb.a.Dc(lc));Ac.$.userOperationManager.Oka.operation.qna(function(){return Ac.uMb})};this.uzf=function(lc,Gc){if(Gc)switch(Gc.B0i){case 1:if(Ac.qk&&
Ac.Q2a)switch(lc=Ac.Q2a.qc,Ac.Q2a.stop(),Ac.Q2a=null,Ac.qk.vv){case 1:Ac.u_c(lc,4800,"ActiveSheet");break;case 0:Ac.u_c(lc,6100,"CurrentSelection");break;case 2:Ac.u_c(lc,7500,"EntireWorkbook")}break;case 0:Ac.rFb&&(lc=Ac.rFb.qc,Ac.rFb.stop(),2400<lc&&(Gc=Object(ma.a)(new ob.a,{extendedProperties:new Map}),Gc.extendedProperties.set("PaneLoadTime",lc.toString()),oa.Health.instance.recordQosError(Da.a.ICj,[rb.a.x4f],!1,!0,!0,!1,Gc)),Ac.av.ldi(function(ed){Ac.KAj(ed)}))}};this.Bz=function(lc,Gc){(1===
Gc.Fq&&Ac.WMa===Gc.Ff||2===Gc.Fq)&&Ac.uKd()};this.$=Fb;this.gia=pc;this.S2=eb;this.rDb=ic;this.IJd=va.HelperMethods.ZZ;this.Qa=new lb.a;this.yEd=this.$.ya.PrintPreviewerPaginationRange;this.useMSPdfViewer=this.vyj();this.bai();this.Hei=this.wWg();this.bpd=wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebPrintFloodgateSurvey",!1);if(this.isUniversalPrintEnabled=!!ic&&ic.A5a()&&wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&this.$.Lf.get(116))this.graphServiceEndpoint=
this.$.ya.GraphServiceEndpoint}function k(){this.appName=this.disabledChangeGates=this.isUniversalPrintFlowEnabled=this.graphServiceEndpointVersion=this.graphServiceEndpoint=null}function l(){this.onBackToSheet=null}function m(){this.onNotifyPrintJobStatus=this.onClosePreviewer=this.getGraphServiceAuthorizationToken=this.onLocalPrint=null}function f(){this.selectedColor=this.selectedMargin=this.selectedScaling=this.selectedPaperSize=this.selectedOrientation=this.selectedWhatToPrint=0;this.selectedPrintGridlines=
this.selectedIgnorePrintArea=!1;this.selectedRowAndColumnHeadings=this.selectedVerticalCenter=this.selectedHorizontalCenter=this.selectedDraft=this.selectedPageEnd=this.selectedPageStart=null}function w(){this.onDropdownSettingsFocus=this.onPrint=this.onSettingChange=null}function n(Fb,pc,eb,ic,Ac,lc){var Gc=r.call(this,Ac)||this;Gc.Ad=!1;Gc.p4f=!1;Gc.xAd=function(ed){Gc.hD.xAd(ed)};Gc.IAd=function(ed){Gc.hD.IAd(ed)};Gc.$Qi=function(){ka.ULS.sendTraceTag(537154190,0,50,"PrintSettingsManager.OnSavePrintSettingsToFileSuccess: Saving print settings to file successful.")};
Gc.ZQi=function(ed){ed=ya.a.Of(ed.data);ka.ULS.sendTraceTag(537154189,0,10,"PrintSettingsManager.OnSavePrintSettingsToFileFailure: Save print settings to file failed. Errors: {0}.",bb.a.Dc(ed))};Gc.Bz=function(ed,fd){2===fd.Fq?Gc.$u.clear():1===fd.Fq&&Gc.$u&&Gc.$u.contains(fd.Ff)&&(ka.ULS.sendTraceTag(537154188,0,50,"PrintSettingsManager.OnQueueChanged: web method {0} returned, it took {1} milliseconds to complete.",Sa.a(fd.Ff.operation.operationName),fd.Ff.dequeueUtcTime.getTime()-fd.Ff.enqueueUtcTime.getTime()),
Gc.$u.remove(fd.Ff))};Gc.hD=Fb;Gc.HN=eb;Gc.$=pc;Gc.sheetName=ic;Gc.locale=window.navigator.browserLanguage||window.navigator.language||Gc.$.ya.UICultureTag;Gc.iWi=Gc.K2g();Gc.$.userOperationManager.Cr(Gc.Bz);Gc.$u=new Zb.a;Gc.isUniversalPrintEnabled=lc;return Gc}function z(Fb,pc){this.sheetPrintOptions=this.sheetName=null;this.sheetName=Fb;this.sheetPrintOptions=pc}function r(Fb){this.xDi=[.75,.75,.7,.7,.3,.3];this.jCi=[.75,.75,.25,.25,.3,.3];this.fXj=[1,1,1,1,.5,.5];this.aae=this.Uee=this.rce=this.ace=
this.Cie=this.z6=this.narrow=this.wide=this.normal=null;this.sheetPrintOptions={};this.Im=Fb;this.sai();this.zai()}function v(){this.printSettingOptionKey=0;this.printSettingOptionText=null}function A(){this.footer=this.header=this.bottom=this.top=this.right=this.left=0}function B(){this.marginValue=this.printSettingOption=null}function y(){this.margin=this.j0=this.yca=this.orientation=this.vv=0;this.ignorePrintArea=!1;this.sheetPrintOptions=null;this.s1a=!1;this.NoColor=null}function x(Fb){var pc=
this;this.ribbonCommandInfo=this.fFb=null;this.SLj=function(eb,ic,Ac){ic=!!eb&&!!eb.RequestTelemetryData;ta.g(pc.$).ui&&ta.g(pc.$).ui.fla(pc.wKa.na(pc.ribbonCommandInfo.command),eb.StateId,ic?eb.RequestTelemetryData.EcsOperationDuration:0,ic?eb.RequestTelemetryData.EcsRequestDuration:0,ic?eb.RequestTelemetryData.WfeRequestDuration:0);va.HelperMethods.ZZ&&pc.rWg(Ac)};this.$=Fb;this.wKa=new sb.a;this.vva=new sb.a;this.vva.add(78661008,12);this.vva.add(275604654,13);this.vva.add(-13332329,14);this.vva.add(-837651977,
9);this.vva.add(-1778266776,10);this.vva.add(845325699,11);this.bpd=wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebPrintFloodgateSurvey",!1)}function C(){this.LastColumn=this.LastRow=this.FirstColumn=this.FirstRow=0}function G(){this.Max=this.Min=this.Index=0}function E(){this.Col=this.Row=null}function I(Fb){this.sheetName=null;this.sheetName=Fb}function U(Fb){this.sheetName=null;this.sheetName=Fb}function M(Fb){this.sharedSheetCell=null;this.sharedSheetCell=Fb}function T(Fb){this.sharedSheetCell=
null;this.sharedSheetCell=Fb}function F(Fb,pc){this.multiRange=null;this.addToPrintArea=!1;this.multiRange=Fb;this.addToPrintArea=pc}function K(Fb,pc){this.A6=0;this.i7d=!1;this.vv=Fb;this.ignorePrintArea=pc}function J(Fb,pc,eb,ic,Ac,lc,Gc,ed){var fd=X.call(this,Fb,pc,eb,ic,Ac,wa.EwaSettings.ma(397))||this;fd.Nca=null;fd.caa=null;fd.fec=null;fd.oSd=!1;fd.ixa=null;fd.F$a=null;fd.Mya=null;fd.Wza=null;fd.e5a=null;fd.dza=1;fd.sma=1;fd.P_=0;fd.A6=1;fd.qGb=!1;fd.Yr=null;fd.lJb=0;fd.kJb=0;fd.Nya=null;fd.Xza=
null;fd.selectedRange=null;fd.Q_=0;fd.d9a=function(){fd.Q_++;fd.A6=fd.WYc();fd.j7c(fd.caa.checked?!0:!1);fd.t7&&(fd.fec.disabled=fd.Vv.checked);fd.JNd(fd.caa.checked?!0:!1);ka.ULS.sendTraceTag(595194762,0,50,"PdfPrintDialog:OnChangeWhatToPrint What to print option changed to {0}",fd.A6.toString());return!0};fd.euf=function(){fd.Q_++;fd.qGb=fd.e5a.checked;ka.ULS.sendTraceTag(537154311,0,50,"PdfPrintDialog:OnChangeIgnorePrintArea Setting Ignore print area changed to {0}",fd.qGb.toString())};fd.wmc=
function(){fd.Q_++;fd.dza=fd.$ue();ka.ULS.sendTraceTag(595079450,0,50,"PdfPrintDialog:OnChangeOrienation orientation option changed to {0}",fd.dza.toString());return!0};fd.fuf=function(){fd.Q_++;var Bc=fd.sma;fd.sma=J.paperSizeOptions[fd.Mya.selectedIndex];ka.ULS.sendTraceTag(595079449,0,50,"PdfPrintDialog:OnChangePaperSize paperSize option changed from {0} to {1}",Bc.toString(),fd.sma.toString());return!0};fd.guf=function(){fd.Q_++;var Bc=fd.P_;fd.P_=J.scalingOptions[fd.Wza.selectedIndex];2===fd.P_?
(fd.lJb=1,fd.kJb=0):3===fd.P_?(fd.lJb=0,fd.kJb=1):1===fd.P_&&(fd.lJb=1,fd.kJb=1);ka.ULS.sendTraceTag(595079448,0,50,"PdfPrintDialog:OnChangeScaling scaling option changed from {0} to {1}",Bc.toString(),fd.P_.toString());return!0};fd.szd=function(Bc){if(Bc&&Bc.data&&Bc.data.Ud&&Bc.data.responseHeaders&&Bc.data.Ud.length){if(Bc.data.responseHeaders["Content-Type"]&&db.a.contains(Bc.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)){ka.ULS.sendTraceTag(51676164,0,50,"PdfPrintDialog:OnFileHandlerSuccessCallback - pdf converted successfully");
var ld={};fd.TDb(ld,null,null)}else ld=gb.a.Vh(Bc.data.Ud),ka.ULS.sendTraceTag(51676165,0,15,"PdfPrintDialog:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: {0}",ld.Errors[0].MessageId);Bc=Bc.data.state;Bc.H8c(ld,Bc.userContext,Bc.methodName)}else ka.ULS.sendTraceTag(51676163,0,10,"PdfPrintDialog:OnFileHandlerSuccessCallback - Invalid Parameter : {0}",Bc?Bc.data?Bc.data.Ud?Bc.data.responseHeaders?Bc.data.Ud.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":
"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs")};fd.rzd=function(Bc){var ld=ya.a.Of(Bc.data);ka.ULS.sendTraceTag(51676166,0,15,"PdfPrintDialog:OnFileHandlerFailureCallback has failed - Errors: [{0}]",bb.a.Dc(ld));ld=Bc.data.state;ld.kaa(Bc,ld.userContext,ld.methodName)};fd.TDb=function(Bc){Bc.Errors&&0<Bc.Errors.length?ka.ULS.sendTraceTag(51499295,0,50,"PdfPrintDialog: Failed to convert workbook. Error message Id: {0}",
Bc.Errors[0].MessageId):(6===fd.Ed.Me&&Y.AFrameworkApplication.ta.ye.Jj(ta.g(fd.$).EVf),ka.ULS.shipAssertTag(537154309,0,!!fd.$.va.pa,"PdfPrintDialog.OnConvertWorkbookToPdfSucceeded: EwaControl.Sheets.ActiveItem should not be null"),fd.$.va.pa&&fd.gia.q3f(fd.vHa()))};fd.gia=lc;fd.activeCell=fd.$.pa.activeCell.toString();fd.Gm.SelectedRanges&&fd.Gm.SelectedRanges.Ranges&&0<fd.Gm.SelectedRanges.Ranges.length&&fd.Gm.SelectedRanges.Ranges[0]&&(fd.selectedRange=S.B(fd.Gm.SelectedRanges.Ranges[0]).toString());
fd.sheetName=Gc;fd.HN=ed;fd.gCd={};Fb=0;for(pc=J.paperSizeOptions.length;Fb<pc;++Fb)fd.gCd[J.paperSizeOptions[Fb].toString()]=Fb;fd.locale=window.navigator.browserLanguage||window.navigator.language||fd.$.ya.UICultureTag;fd.t7=wa.EwaSettings.isChangeGateEnabled("OfficeVSO:4738349_EnableIgnorePrintAreaSettingInPrintDialog");return fd}function O(Fb,pc){this.printSettings=this.sheetName=null;this.sheetName=Fb;this.printSettings=pc}function N(Fb,pc,eb,ic,Ac){Fb=X.call(this,Fb,pc,eb,ic,Ac)||this;Fb.Qsb=
null;return Fb}function H(Fb,pc,eb,ic,Ac,lc,Gc,ed){ed=Fb.Na(1,void 0===ed?null:ed);ed.sheetName=pc;ed.locale=eb;return La.g(Fb,"GetPrintSettings",ed,ic,Ac,lc,Gc,4)}function Q(Fb,pc,eb,ic,Ac,lc,Gc){Gc=Fb.Na(1,void 0===Gc?null:Gc);Gc.ConvertInParameters=pc;return La.g(Fb,"ConvertWorkbookToPrintPdf",Gc,eb,ic,Ac,lc,4)}function ca(Fb,pc,eb,ic,Ac,lc,Gc,ed){ed=Fb.Na(9,void 0===ed?null:ed);ed.sheetName=pc;ed.printSettings=eb;return La.g(Fb,"SetSheetPrintSettings",ed,ic,Ac,lc,Gc,0)}function X(Fb,pc,eb,ic,
Ac,lc){Fb=ra.call(this,Fb,pc,eb,void 0===lc?!1:lc)||this;Fb.Vv=null;Fb.Gm=ic;Fb.XQb=Ac;return Fb}var Z=b(11),ea=b(0),ka=b(15),Y=b(4),qa=b(1543),fa=b(905),ha=b(51),ia=b(37),wa=b(1),Qa=b(64),S=b(45),da=b(186),xa=b(14),ta=b(21),ab=b(391),Na=b(637),Ka=b(25),la=b(1079),Ea=b(12),ra=la.a;Rk(X,ra);X.prototype.setFocus=function(){this.Vv.checked?Ea.DOMElementExtensions.setFocus(this.Vv):Ea.DOMElementExtensions.setFocus(this.getButton(0).get_element())};Af.Object.defineProperties(X.prototype,{Ed:{configurable:!0,
enumerable:!0,get:function(){return this.XQb}}});X.f5b="printCurrentSelection";Object(ea.a)(X,"BasePrintDialog",la.a,[]);var na=b(118),ba=b(5),sa=b(216),ya=b(121),va=b(10),W=b(239),La=b(61);Rk(N,X);N.prototype.initialize=function(){ka.ULS.sendTraceTag(537154316,0,50,"HtmlPrintDialog:Initialize - Preparing dialog for HTML Legacy print");this.N$h();this.eYa(1199);this.addButton(1);X.prototype.initialize.call(this)};N.prototype.mha=function(){var Fb=this;return function(pc,eb,ic){var Ac=Fb.$.oa.xa,lc=
Fb.Gm;pc=Fb.ija(pc);eb=Fb.Aaa(eb);var Gc=Fb.Ed,ed=Ac.Na(1,null);ed.printOptions=lc;return La.g(Ac,"ValidatePrint",ed,pc,eb,ic,Gc,0)}};N.prototype.commit=function(){this.P_g();return!0};N.prototype.fy=function(Fb,pc,eb){var ic,Ac=Fb.Result;if(Ac&&pc){var lc=0,Gc=0;(null===(ic=Ac.SelectedRanges)||void 0===ic?0:ic.Ranges)&&0<Ac.SelectedRanges.Ranges.length&&Ac.SelectedRanges.Ranges[0]&&(lc=Math.min(N.A0f(Ac.SelectedRanges.Ranges[0]),65535));Ac.UsedRange&&(Gc=Math.min(N.A0f(S.j(S.D(Ac.UsedRange))),65535));
W.h(pc,lc);W.i(pc,Gc)}this.Gm=Ac;X.prototype.fy.call(this,Fb,pc,eb)};N.prototype.setFocus=function(){this.Qsb.checked?Ea.DOMElementExtensions.setFocus(this.Qsb):X.prototype.setFocus.call(this)};N.prototype.N$h=function(){this.Gb.innerHTML=N.y_i(this.$.ea.isNamedObjectViewMode);this.Vv=Ea.DOMElementExtensions.getElementById(this.Gb,X.f5b);this.Qsb=Ea.DOMElementExtensions.getElementById(this.Gb,"printEntireItem");0!==this.Gm.Type&&this.Gm.UseSelection?(this.Vv.checked=!0,this.Qsb.disabled=!this.Gm.SheetName):
(this.Qsb.checked=!0,this.Vv.disabled=0===this.Gm.Type||!ta.g(this.$).ha.sa.tg)};N.prototype.P_g=function(){ka.ULS.sendTraceTag(51499290,0,50,"HtmlPrintDialog:CommitWithGenerateHtml - CommitWithGenerateHtml called");var Fb=new Sys.StringBuilder;this.eGh(Fb);var pc=String.format("location=0,scrollbars=1,resizable=1,menubar=1,toolbar={0},status=0",Ka.a.xf?0:1);va.HelperMethods.Ze(Fb.toString(),"",pc,"PrintDialog.PrintViewUrl")||ka.ULS.sendTraceTag(51499291,0,10,"HtmlPrintDialog:CommitWithGenerateHtml - A browser blocked the xlprintview.aspx page!")};
N.prototype.eGh=function(Fb){var pc=this.$.ya;Fb.append(this.$.Dda+pc.LayoutsRelativeUri+"/xlprintview.aspx?");sa.a.Qg(Fb,ba.a.b2i,this.Gm.SessionId);sa.a.Qg(Fb,ba.a.d2i,this.Vv.checked?"1":"0");if(0===this.Gm.Type)sa.a.Qg(Fb,ba.a.Z1i,this.Gm.ObjectId);else{if(!this.Gm.UsedRangeTooBig){var eb=S.D(this.Gm.UsedRange);(eb=S.x(eb,this.Gm.SheetName))&&sa.a.Qg(Fb,ba.a.e2i,eb)}1===this.Gm.Type?sa.a.Qg(Fb,ba.a.$1i,this.Gm.ObjectId):(eb=S.B(this.Gm.SelectedRanges.Ranges[0]),eb=S.x(eb,this.Gm.SheetName),sa.a.Qg(Fb,
ba.a.a2i,eb))}ya.a.VYa(Fb,pc);sa.a.Qg(Fb,ba.a.c2i,this.Gm.Title)};N.y_i=function(Fb){return String.format("<div class='"+na.a.Cn+"'>{0}</div>\r\n\t<div class='"+na.a.$7b+"'>\r\n\t\t<input type='radio' id='{1}' name='print' /> <label for='{1}'>{2}</label><br />\r\n\t\t<input type='radio' id='{3}' name='print' /> <label for='{3}'>{4}</label>\r\n\t</div>\r\n</div>",xa.a.instance.ga(1200),X.f5b,xa.a.instance.ga(1203),"printEntireItem",Fb?xa.a.instance.ga(1202):xa.a.instance.ga(1201))};N.A0f=function(Fb){return(Fb.LastColumn-
Fb.FirstColumn+1)*(Fb.LastRow-Fb.FirstRow+1)};Af.Object.defineProperties(N.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"HtmlPrintDialog"}}});Object(ea.a)(N,"HtmlPrintDialog",X,[]);var Ia=b(178),mb=b(617),fb=b(13),Ma=b(8),Hb=b(66),Kb=b(1285),Ub=b(980),gb=b(54),Db=b(177),Va=b(307),yb=b(1076),qb=b(218),dc=b(937),bb=b(29),db=b(22),wc=b(295);O.prototype.getSheetName=function(){return this.sheetName};O.prototype.getPrintSettings=function(){return this.printSettings};Object(ea.a)(O,
"MacroRecorderSheetPrintSettingsSavedPayload",null,[409]);var nb=b(158),zb=b(58);Rk(J,X);J.prototype.initialize=function(){this.t7&&wa.EwaSettings.isChangeGateEnabled("OfficeVSO:4879681_PrintAreaCheckboxKeyboardFocus")&&J.Y6g(this.Gb);this.Be?this.zAe(1013,null):(this.El(),this.eYa(1013));X.prototype.initialize.call(this)};J.prototype.dispose=function(){this.hOj();X.prototype.dispose.call(this)};J.prototype.close=function(Fb){ka.ULS.sendTraceTag(591196544,0,50,"PdfPrintDialog.Close: User changed printSettings {0} times before exiting dialog {1} printing done",
this.Q_,0===Fb?"with":"without");this.Mjj();if(this.Yr){var pc=this.ILh();!this.oSd&&!this.caa.checked&&this.$.isEditMode&&this.pid(pc)&&this.Djj(pc)}X.prototype.close.call(this,Fb)};J.prototype.mha=function(){var Fb=this;return function(pc,eb,ic){return H(Fb.$.oa.xa,Fb.$.va.pa.name,Fb.locale,Fb.ija(pc),Fb.Aaa(eb),ic,null)}};J.prototype.fy=function(Fb,pc,eb){this.Yr=Fb.Result;this.lJb=this.Yr.ScalingWidth;this.kJb=this.Yr.ScalingHeight;this.iad();this.u$h();X.prototype.fy.call(this,Fb,pc,eb)};J.prototype.El=
function(){ka.ULS.sendTraceTag(537154315,0,50,"PdfPrintDialog:InitializeDialogElements - Preparing dialog for Print Pdf");this.O$h();X.prototype.El.call(this)};J.prototype.commit=function(){this.O_g();return!0};J.prototype.setFocus=function(){this.Be?qb.a.BAc(this.Nca):this.Nca.checked?Ea.DOMElementExtensions.setFocus(this.Nca):X.prototype.setFocus.call(this)};J.prototype.fbi=function(){switch(this.HN.vv){case 1:this.Nca.checked=!0;break;case 0:this.Vv.disabled?this.Nca.checked=!0:this.Vv.checked=
!0;break;case 2:this.caa.checked=!0;break;default:ka.ULS.sendTraceTag(537154314,0,10,"Invalid what to print state {0}. Resetting to defaults.",this.HN.vv),this.HN.vv=1,this.Nca.checked=!0}};J.prototype.Mjj=function(){this.HN.vv=this.WYc();this.t7&&(this.HN.ignorePrintArea=this.e5a.checked)};J.prototype.iad=function(){if(100!==this.Yr.ScalingPercent||this.Yr.FitToPage&&(1<this.Yr.ScalingWidth||1<this.Yr.ScalingHeight))this.oSd=!0,this.Yr.ScalingWidth=J.l5c,this.Yr.ScalingHeight=J.k5c,this.Yr.ScalingPercent=
J.L5b,this.Yr.FitToPage=J.e5c;this.Yr.PaperSize.toString()in this.gCd||(this.oSd=!0,this.Yr.PaperSize=this.Yr.PaperSize===J.lNg?34:J.Nrb)};J.prototype.u$h=function(){this.dza=this.Yr.IsLandscape?2:1;this.P_=this.Yr.FitToPage?1===this.Yr.ScalingWidth&&1===this.Yr.ScalingHeight?1:this.Yr.ScalingWidth||1!==this.Yr.ScalingHeight?2:3:0;this.sma=this.Yr.PaperSize;this.j7c(this.caa.checked?!0:!1);this.JNd(this.caa.checked?!0:!1)};J.prototype.aai=function(){this.fec.disabled=this.Vv.checked;this.qGb=this.e5a.checked=
this.HN.ignorePrintArea};J.prototype.C9g=function(Fb){this.Xza=document.createElement("select");this.Xza.style.width=224+Hb.a.Xe;this.Xza.style.height=32+Hb.a.Xe;this.Xza.setAttribute(ba.a.bE,"scalingElementId");this.Wza=new dc.a(this.Xza,!0);for(var pc=0,eb=J.scalingOptions.length;pc<eb;++pc){var ic=xa.a.instance.ga(J.jkj[pc]);this.Wza.QL(ic,J.scalingOptions[pc].toString(),!1)}Fb.appendChild(this.Xza)};J.prototype.MDe=function(Fb){this.Nya=document.createElement("select");this.Nya.style.width=224+
Hb.a.Xe;this.Nya.style.height=32+Hb.a.Xe;this.Nya.setAttribute(ba.a.bE,"paperSizeElementId");this.Mya=new dc.a(this.Nya,!0);for(var pc=0,eb=J.paperSizeOptions.length;pc<eb;++pc){var ic=xa.a.instance.ga(J.jWi[pc]);this.Mya.QL(ic,J.paperSizeOptions[pc].toString(),!1)}Fb.appendChild(this.Nya)};J.prototype.ILh=function(){var Fb={};Fb.IsLandscape=2===this.dza;Fb.PaperSize=this.sma;Fb.ScalingWidth=this.lJb;Fb.ScalingHeight=this.kJb;Fb.ScalingPercent=100;Fb.FitToPage=0===this.P_?!1:!0;return Fb};J.prototype.vHa=
function(){var Fb=new Sys.StringBuilder;Fb.append(yb.a(this.$,"Pdf",!0));this.gia.ixc()&&sa.a.Qg(Fb,Ma.a.Xdg,"1");sa.a.Qg(Fb,Ma.a.mFd,""+this.A6);sa.a.Qg(Fb,Ma.a.BJf,this.$.va.pa.name);0===this.A6&&(sa.a.Qg(Fb,Ma.a.AJf,this.selectedRange),sa.a.Qg(Fb,Ma.a.uJf,this.activeCell));sa.a.Qg(Fb,Ma.a.vJf,""+this.dza);sa.a.Qg(Fb,Ma.a.wJf,""+this.sma);sa.a.Qg(Fb,Ma.a.zJf,""+this.P_);sa.a.Qg(Fb,Ma.a.yJf,"1");sa.a.Qg(Fb,Ma.a.tJf,this.qGb?"1":"0");sa.a.Qg(Fb,Ma.a.xJf,"1");ka.ULS.sendTraceTag(51499296,0,50,"PdfPrintDialog: Print Pdf Url {0}",
Fb.toString());return Fb.toString()};J.prototype.Yxb=function(){var Fb=this,pc=null;ka.ULS.sendTraceTag(537154313,0,50,"PdfPrintDialog:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");this.$.userOperationManager.Sb(new Db.a(223,0,function(eb,ic,Ac){eb=new Va.a(eb,null,ic,Ac,null,!0,!1,"GetFileCopyFileHandler","");eb.correlationID=Ia.a.create().toString();pc=eb;Y.AFrameworkApplication.qd.z9(Fb.vHa(),1,null,null,J.v$c,!1,2,Fb.szd,Fb.rzd,pc,void 0,void 0,void 0,12E4);return zb.Task.Ua(!0)},
16),null)};J.prototype.O$h=function(){ka.ULS.sendTraceTag(537154312,0,50,"PdfPrintDialog:InitializeForPrintPdf - Preparing full print pdf dialog");this.x_i(this.Gb);this.j7c(!0);this.JNd(!0);this.Vv=Ea.DOMElementExtensions.getElementById(this.Gb,X.f5b);this.Nca=Ea.DOMElementExtensions.getElementById(this.Gb,"printActiveSheet");this.caa=Ea.DOMElementExtensions.getElementById(this.Gb,"printEntireWorkbook");this.t7&&(this.fec=Ea.DOMElementExtensions.getElementById(this.Gb,"ignorePrintAreaCheckboxButtonId"),
this.e5a=new Ub.a(this.fec));this.Jwc()&&(this.Vv.disabled=!0,this.Gm.SheetName=this.sheetName);this.fbi();this.t7&&this.aai();this.o8i()};J.prototype.Jwc=function(){return!!this.Gm.ObjectId||!ta.g(this.$).ha.sa.tg};J.prototype.o8i=function(){mb.a.instance.qa(fb.a.change,this.Nca,this.d9a);mb.a.instance.qa(fb.a.change,this.caa,this.d9a);mb.a.instance.qa(fb.a.change,this.Vv,this.d9a);mb.a.instance.qa(fb.a.change,this.ixa,this.wmc);mb.a.instance.qa(fb.a.change,this.F$a,this.wmc);mb.a.instance.qa(fb.a.change,
this.Nya,this.fuf);mb.a.instance.qa(fb.a.change,this.Xza,this.guf);this.t7&&this.e5a.Vmb(this.euf)};J.prototype.hOj=function(){mb.a.instance.Aa(fb.a.change,this.Nca,this.d9a);mb.a.instance.Aa(fb.a.change,this.caa,this.d9a);mb.a.instance.Aa(fb.a.change,this.Vv,this.d9a);mb.a.instance.Aa(fb.a.change,this.ixa,this.wmc);mb.a.instance.Aa(fb.a.change,this.F$a,this.wmc);mb.a.instance.Aa(fb.a.change,this.Nya,this.fuf);mb.a.instance.Aa(fb.a.change,this.Xza,this.guf);this.t7&&this.e5a.eda(this.euf)};J.prototype.x_i=
function(Fb){Fb.classList.add(Kb.a.w0i);if(!this.Be){document.getElementById("ewaDialogTitle").classList.add(Kb.a.printDialogTitle);var pc=document.getElementById("ewaDialogCloseButtonLink");pc.style.top=32+Hb.a.Xe;this.rtl?pc.style.left=32+Hb.a.Xe:pc.style.right=32+Hb.a.Xe}pc=J.Zy(Kb.a.x0i);Fb.appendChild(pc);var eb=J.Zy(Kb.a.V$a,1207);eb.style.marginBottom=12+Hb.a.Xe;eb.id="whatToPrintTitleElementId";pc.appendChild(eb);eb=J.Zy(Kb.a.U$a);pc.appendChild(eb);J.erb(eb,this.rtl,"printActiveSheet",1211,
"whatToPrintRbName","PrintWhatExcelActiveSheets_32x32x32","activeSheetRadioButtonInnerLabelElementId","whatToPrintTitleElementId");pc.appendChild(document.createElement("BR"));eb=J.Zy(Kb.a.U$a);pc.appendChild(eb);J.erb(eb,this.rtl,"printEntireWorkbook",1204,"whatToPrintRbName","PrintWhatExcelEntireWorkbook_32x32x32","entireWorkbookRadioButtonInnerLabelElementId","whatToPrintTitleElementId");pc.appendChild(document.createElement("BR"));eb=J.Zy(Kb.a.U$a);pc.appendChild(eb);J.erb(eb,this.rtl,X.f5b,1203,
"whatToPrintRbName","PrintWhatExcelSelection_32x32x32","currentSelectionRadioButtonInnerLabelElementId","whatToPrintTitleElementId");this.t7?(eb=J.Zy(Kb.a.V$a,1236),eb.style.marginTop=24+Hb.a.Xe,eb.id="printAreaElementId",pc.appendChild(eb),wa.EwaSettings.isChangeGateEnabled("OfficeVSO:4879681_PrintAreaCheckboxKeyboardFocus")?(eb.style.marginBottom=12+Hb.a.Xe,eb=J.Zy(na.a.r8c),eb.id="ignorePrintAreaCheckboxWarpperId",Ea.DOMElementExtensions.setVisible(eb,!0),pc.appendChild(eb),pc=this.getElementById("ignorePrintAreaCheckboxButtonId"),
Ea.DOMElementExtensions.setVisible(pc,!0),eb.appendChild(pc),pc=this.getElementById("ignorePrintAreaCheckboxLabelId"),Ea.DOMElementExtensions.setVisible(pc,!0),eb.appendChild(pc)):(eb=J.Zy(Kb.a.U$a),pc.appendChild(eb),J.Q4g(eb,this.rtl))):(eb=J.Zy(Kb.a.V$a,1209),eb.style.marginTop=24+Hb.a.Xe,eb.id="paperSizeElementId",pc.appendChild(eb),eb=J.Zy(Kb.a.vEd),this.MDe(eb),pc.appendChild(eb));pc=J.Zy(Kb.a.y0i);Fb.appendChild(pc);Fb=J.Zy(Kb.a.V$a,1208);Fb.style.marginBottom=12+Hb.a.Xe;Fb.id="orientationTitleElementId";
pc.appendChild(Fb);Fb=J.Zy(Kb.a.U$a);pc.appendChild(Fb);J.erb(Fb,this.rtl,"portraitRadioButtonId",1214,"orientationRbName","Portrait_32x32x32","portraitRadioButtonInnerLabelElementId","orientationTitleElementId");pc.appendChild(document.createElement("BR"));Fb=J.Zy(Kb.a.U$a);pc.appendChild(Fb);J.erb(Fb,this.rtl,"landscapeRadioButtonId",1213,"orientationRbName","Landscape_32x32x32","landscapeRadioButtonInnerLabelElementId","orientationTitleElementId");this.t7&&(Fb=J.Zy(Kb.a.V$a,1209),Fb.style.marginTop=
12+Hb.a.Xe,Fb.id="paperSizeElementId",pc.appendChild(Fb),Fb=J.Zy(Kb.a.vEd),this.MDe(Fb),pc.appendChild(Fb));Fb=J.Zy(Kb.a.V$a,1210);Fb.style.marginTop=(this.t7?10:74)+Hb.a.Xe;Fb.id="scalingElementId";pc.appendChild(Fb);Fb=J.Zy(Kb.a.vEd);this.C9g(Fb);pc.appendChild(Fb);this.Be||document.getElementById("buttonarea").classList.add(Kb.a.v0i);this.ixa=Ea.DOMElementExtensions.getElementById(this.Gb,"landscapeRadioButtonId");this.F$a=Ea.DOMElementExtensions.getElementById(this.Gb,"portraitRadioButtonId")};
J.prototype.O_g=function(){var Fb=this;ka.ULS.sendTraceTag(51499294,0,50,"PdfPrintDialog:CommitWithConvertPdf - CommitWithConvertPdf called");this.A6=this.WYc();2!==this.A6&&(this.dza=this.$ue(),this.Mya&&(this.sma=J.paperSizeOptions[this.Mya.selectedIndex]),this.Wza&&(this.P_=J.scalingOptions[this.Wza.selectedIndex]));if(this.$.pwa&&wa.EwaSettings.isChangeGateEnabled("OfficeVSO:4445349_DisablePrintLatencyImprovementForCrossDomain")){var pc=this.$.oa.xa.Pb();this.$.userOperationManager.Sb(new Db.a(133,
0,function(eb,ic,Ac){var lc={};lc.WhatToPrint=Fb.A6;lc.UseNamedAction=Fb.gia.ixc();lc.SelectedSheetName=Fb.$.va.pa.name;lc.ActiveCell=Fb.activeCell;lc.SelectedRanges=[Fb.selectedRange];lc.IsPdfDocumentRequired=!1;lc.Orientation=Fb.dza;lc.PaperSize=Fb.sma;lc.Scaling=Fb.P_;lc.RichValuesEnabled=!0;Fb.t7&&(lc.IgnorePrintArea=Fb.qGb);return Q(Fb.$.oa.xa,lc,wc.b(Fb.TDb,eb),ic,Ac,pc)},16),null)}else this.Yxb()};J.prototype.j7c=function(Fb){this.F$a.disabled=Fb;this.ixa.disabled=Fb;this.Mya.Nn.disabled=Fb;
this.Wza.Nn.disabled=Fb};J.prototype.JNd=function(Fb){Fb?(this.ixa.checked=!1,this.F$a.checked=!1,this.Mya.selectedIndex=-1,this.Wza.selectedIndex=-1):(2===this.dza?this.ixa.checked=!0:this.F$a.checked=!0,this.Mya.selectedIndex=this.gCd[this.sma.toString()],this.Wza.selectedIndex=this.P_)};J.prototype.Djj=function(Fb){var pc=this;ka.ULS.sendTraceTag(537154310,0,50,"PdfPrintDialog:SavePrintSettingsToFile - We should make a set SheetPrintSettings call here to set print Settings.");var eb=this.$.va.pa.name,
ic=this.$.oa.xa.Pb();this.$.userOperationManager.Sb(new Db.a(226,0,function(Ac,lc,Gc){return ca(pc.$.oa.xa,eb,Fb,Ac,lc,Gc,ic)},void 0,function(){return new O(eb,Fb)}),null)};J.prototype.pid=function(Fb){return this.Yr.IsLandscape!==Fb.IsLandscape||this.Yr.PaperSize!==Fb.PaperSize||this.Yr.FitToPage!==Fb.FitToPage||this.Yr.ScalingHeight!==Fb.ScalingHeight||this.Yr.ScalingWidth!==Fb.ScalingWidth?!0:!1};J.prototype.$ue=function(){return this.ixa&&this.ixa.checked?2:1};J.prototype.WYc=function(){return this.Vv.checked?
0:this.Nca.checked?1:this.caa.checked?2:1};J.Zy=function(Fb,pc){Fb=void 0===Fb?null:Fb;pc=void 0===pc?0:pc;var eb=document.createElement("div");Fb&&(eb.className=Fb);0!==pc&&(eb.innerHTML=xa.a.instance.ga(pc));return eb};J.Y6g=function(Fb){var pc=document.createElement("input");pc.setAttribute("type","checkbox");pc.className=na.a.kMe;pc.id="ignorePrintAreaCheckboxButtonId";pc.setAttribute("name","ignorePrintAreaCbName");pc.style.height=16+Hb.a.Xe;pc.style.width=16+Hb.a.Xe;Ea.DOMElementExtensions.setVisible(pc,
!1);var eb=xa.a.instance.ga(1236),ic=xa.a.instance.ga(1237);pc.setAttribute(ba.a.Gt,eb+Hb.a.space+ic);Fb.appendChild(pc);pc=document.createElement("label");pc.setAttribute("for","ignorePrintAreaCheckboxButtonId");pc.id="ignorePrintAreaCheckboxLabelId";pc.innerHTML=ic;pc.setAttribute(ba.a.vP,"true");pc.style.position="relative";pc.style.marginLeft=15+Hb.a.Xe;Ea.DOMElementExtensions.setVisible(pc,!1);Fb.appendChild(pc)};J.Q4g=function(Fb,pc){var eb=document.createElement("input");eb.setAttribute("type",
"checkbox");eb.id="ignorePrintAreaCheckboxButtonId";eb.setAttribute("name","ignorePrintAreaCbName");eb.setAttribute(ba.a.bE,"printAreaElementId"+Hb.a.space+"ignorePrintAreaCheckboxButtonInnerLabelElementId");eb.style.height=16+Hb.a.Xe;eb.style.width=16+Hb.a.Xe;pc?eb.style.marginRight=0+Hb.a.Xe:eb.style.marginLeft=0+Hb.a.Xe;Fb.appendChild(eb);pc=document.createElement("label");pc.setAttribute("for","ignorePrintAreaCheckboxButtonId");pc.setAttribute(ba.a.vP,"true");pc.style.position="relative";pc.style.marginLeft=
15+Hb.a.Xe;Fb.appendChild(pc);Fb=J.Zy(Kb.a.jIf,1237);Fb.id="ignorePrintAreaCheckboxButtonInnerLabelElementId";pc.appendChild(Fb)};J.erb=function(Fb,pc,eb,ic,Ac,lc,Gc,ed){var fd=document.createElement("input");fd.setAttribute("type","radio");fd.id=eb;fd.setAttribute("name",Ac);fd.setAttribute(ba.a.bE,ed+Hb.a.space+Gc);fd.style.height=16+Hb.a.Xe;fd.style.width=16+Hb.a.Xe;pc?fd.style.marginRight=0+Hb.a.Xe:fd.style.marginLeft=0+Hb.a.Xe;Fb.appendChild(fd);pc=document.createElement("label");pc.setAttribute("for",
eb);pc.style.position="relative";Fb.appendChild(pc);Fb=nb.createClusteredImage(32,32,lc,Kb.a.F0i,!0,xa.a.instance.ga(ic));ic=J.Zy(Kb.a.jIf,ic);ic.id=Gc;ic.setAttribute(ba.a.vP,"true");Gc=J.Zy(Kb.a.E0i);Gc.appendChild(ic);pc.appendChild(Gc);pc.appendChild(Fb)};Af.Object.defineProperties(J.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"PdfPrintDialog"}}});J.l5c=1;J.k5c=0;J.L5b=100;J.Nrb=9;J.e5c=!0;J.lNg=13;J.paperSizeOptions=[1,5,6,7,8,9,11,12,3,20,27,28,34,37,43,14];J.jWi=[1216,
1217,1224,1218,1219,1220,1221,1222,1215,1225,1226,1227,1228,1229,1230,1231];J.scalingOptions=[0,1,2,3];J.jkj=[1232,1233,1234,1235];J.v$c=["Content-Type"];Object(ea.a)(J,"PdfPrintDialog",X,[]);Af.Object.defineProperties(K.prototype,{vv:{configurable:!0,enumerable:!0,get:function(){return this.A6},set:function(Fb){0<=Fb&&2>=Fb?this.A6=Fb:(ka.ULS.sendTraceTag(537154308,0,10,"Attempt to set invalid state. Setting ActiveSheets instead."),this.A6=1)}},ignorePrintArea:{configurable:!0,enumerable:!0,get:function(){return this.i7d},
set:function(Fb){Fb||!Fb?this.i7d=Fb:ka.ULS.sendTraceTag(537154307,0,10,"Attempt to set invalid ignorePrintArea")}}});Object(ea.a)(K,"PdfPrintDialogBrowserSessionState",null,[]);var ma=b(7),P=b(135),oa=b(99),Ja=b(1598);Object(ea.a)(F,"MacroRecorderPrintAreaSetPayload",null,[409]);var $a=b(564),Ta=b(389),pa=b(74);Object(ea.a)(T,"MacroRecorderPageBreakInsertedPayload",null,[409]);Object(ea.a)(M,"MacroRecorderPageBreakRemovedPayload",null,[409]);U.prototype.getSheetName=function(){return this.sheetName};
Object(ea.a)(U,"MacroRecorderPageBreaksAllResetPayload",null,[409]);I.prototype.getSheetName=function(){return this.sheetName};Object(ea.a)(I,"MacroRecorderPrintAreaClearedPayload",null,[409]);var Da=b(126),rb=b(112),Ab=b(50),ob=b(190);Object(ea.a)(E,"PageBreaksInformation",null,[]);Object(ea.a)(G,"RowColBreak",null,[]);Object(ea.a)(C,"SharedRange",null,[]);var sb=b(171);x.prototype.executeCommand=function(Fb,pc,eb,ic,Ac,lc,Gc){Ac=void 0===Ac?null:Ac;lc=void 0===lc?null:lc;Gc=void 0===Gc?null:Gc;
this.lWd();this.ribbonCommandInfo=pc;this.WDj(pc.command);Fb=wc.b(Ac,this.SLj);ka.ULS.sendTraceTag(543794888,0,50,"PrintCommandHandler.ExecuteCommand: {0} command execution started",pc.command);switch(pc.command){case 78661008:return this.n5e(pc,Fb,lc,Gc,!1);case 275604654:return this.n5e(pc,Fb,lc,Gc,!0);case -13332329:return this.n4e(pc,Fb,lc,Gc);case -837651977:return this.A2h(pc,Fb,lc,Gc);case -1778266776:return this.w3h(pc,Fb,lc,Gc);case 845325699:return this.i5e(pc,Fb,lc,Gc)}return da.a(pc.command)};
x.prototype.Ac=function(Fb,pc){switch(pc.command){case 78661008:case 275604654:case -837651977:case -1778266776:return 1===Fb;case 845325699:case -13332329:return!0}return!1};x.prototype.WZf=function(Fb,pc,eb){var ic=ta.g(this.$),Ac=ic.Ea,lc=S.r(ic.ha.sa.selectedRanges,this.$);if((Ac=Ac.QE())&&Ac.length){Ac=ak(Ac);for(var Gc=Ac.next();!Gc.done;Gc=Ac.next()){Gc=Gc.value;var ed=Gc.lf;if(ed){for(var fd=S.j(Gc.kf),Bc=[],ld=ak(lc.Ranges),Bd=ld.next();!Bd.done;Bd=ld.next()){var xb=Bd.value;xb.FirstRow>
fd.LastRow+1||xb.LastRow<fd.FirstRow||xb.FirstColumn>fd.LastColumn+1||xb.LastColumn<fd.FirstColumn||(Bd=this.lUh(fd,xb,ed),xb=this.kUh(fd,xb,ed),Bc.push(Object(ma.a)(new C,{FirstRow:Bd.FirstRow,FirstColumn:xb.FirstColumn,LastRow:Bd.LastRow,LastColumn:xb.LastColumn})))}0<Bc.length&&!eb?ed.setPrintArea(Bc):0<Bc.length&&eb?ed.addToPrintArea(Bc):!eb&&ed.hasPrintArea()&&ed.clearPrintArea();!ed.isDirty()&&ed.hasPageLayout()&&ed.setDirty("PrintAreaBreakManager::SetPrintAreaInstantaneous, hash: "+Gc.Kd,4)}}this.sNb(ic,
Fb,pc)}};x.prototype.jYg=function(Fb,pc){var eb=ta.g(this.$),ic=ta.g(this.$).Ea.QE();if(ic&&ic.length){ic=ak(ic);for(var Ac=ic.next();!Ac.done;Ac=ic.next()){Ac=Ac.value;var lc=Ac.lf;lc&&(lc.clearPrintArea(),!lc.isDirty()&&lc.hasPageLayout()&&lc.setDirty("PrintAreaBreakManager::ClearPrintAreaInstantaneous, hash: "+Ac.Kd,4))}this.sNb(eb,Fb,pc)}};x.prototype.Nbi=function(Fb,pc){var eb=ta.g(this.$),ic=eb.Ea,Ac=S.o(eb.ha.sa.activeCell,this.$);if(Ac){var lc=ic.QE();if(lc&&lc.length){ic=null;for(var Gc=
ak(lc),ed=Gc.next();!ed.done;ed=Gc.next()){ed=ed.value;var fd=ed.lf;if(fd){var Bc=S.j(ed.kf);if(!(Ac.FirstRow>Bc.LastRow||Ac.FirstRow<Bc.FirstRow||Ac.FirstColumn>Bc.LastColumn||Ac.FirstColumn<Bc.FirstColumn)&&(ic=this.j8g(fd,Bc,Ac),fd.insertPageBreak(ic),!fd.isDirty()&&fd.hasPageLayout()&&fd.setDirty("PrintAreaBreakManager::InsertPageBreakInstantaneous, hash: "+ed.Kd,4),ic))break}}if(!ic)for(lc=ak(lc),ed=lc.next();!ed.done;ed=lc.next())if(ic=ed.value,Gc=ic.lf)ic=S.j(ic.kf),ic=this.LDe(Gc,ic,Ac),Gc.insertPageBreak(ic);
this.sNb(eb,Fb,pc)}}};x.prototype.G$i=function(Fb,pc){var eb=ta.g(this.$),ic=eb.Ea,Ac=S.o(eb.ha.sa.activeCell,this.$);if(Ac&&(ic=ic.QE())&&ic.length){ic=ak(ic);for(var lc=ic.next();!lc.done;lc=ic.next()){lc=lc.value;var Gc=lc.lf;if(Gc){var ed=S.j(lc.kf);(ed=this.LDe(Gc,ed,Ac))&&Gc.removePageBreak(ed);!Gc.isDirty()&&Gc.hasPageLayout()&&Gc.setDirty("PrintAreaBreakManager::RemovePageBreakInstantaneous, hash: "+lc.Kd,4)}}this.sNb(eb,Fb,pc)}};x.prototype.xfj=function(Fb,pc){var eb=ta.g(this.$),ic=eb.Ea.QE();
if(ic&&ic.length){ic=ak(ic);for(var Ac=ic.next();!Ac.done;Ac=ic.next()){Ac=Ac.value;var lc=Ac.lf;lc&&(lc.resetAllPageBreak(),!lc.isDirty()&&lc.hasPageLayout()&&lc.setDirty("PrintAreaBreakManager::ResetAllPageBreakInstantaneous, hash: "+Ac.Kd,4))}this.sNb(eb,Fb,pc)}};x.prototype.n5e=function(Fb,pc,eb,ic,Ac){if(!Ac){var lc=this.$.vb.getItemByName("PRINT_AREA");if(lc&&(ka.ULS.sendTraceTag(537154306,0,15,"PrintCommandHandler.HandleSetPrintAreaCommand: Print_Area already present as NamedObject of type : {0}",
lc.type),2===lc.type))return this.udi(),zb.Task.Ua(!0)}lc=ta.g(this.$).ha.sa;var Gc=S.r(lc.selectedRanges,this.$);if(1===Gc.Ranges.length&&!Ac){if(lc.Eba())return this.M3h(Fb,Gc,pc,eb,ic,Ac),zb.Task.Ua(!0);if(S.R(Gc.Ranges[0]))return this.$.va.pa.hasPrintArea?this.n4e(Fb,pc,eb,ic):zb.Task.Ua(!0)}this.WZf(Fb.command,ic,Ac);return this.laf(Fb,pc,eb,Gc,Ac)};x.prototype.n4e=function(Fb,pc,eb,ic){this.jYg(Fb.command,ic);return this.gdi(Fb,pc,eb)};x.prototype.A2h=function(Fb,pc,eb,ic){this.Nbi(Fb.command,
ic);return this.rdi(Fb,pc,eb)};x.prototype.w3h=function(Fb,pc,eb,ic){var Ac=S.r(ta.g(this.$).ha.sa.selectedRanges,this.$);if(S.R(Ac.Ranges[0]))return this.i5e(Fb,pc,eb,ic);this.G$i(Fb.command,ic);return this.vdi(Fb,pc,eb)};x.prototype.i5e=function(Fb,pc,eb,ic){this.xfj(Fb.command,ic);return this.ydi(Fb,pc,eb)};x.prototype.laf=function(Fb,pc,eb,ic,Ac){function lc(){return new F(ic,Ac)}function Gc(fd,Bc,ld){fd=wc.b(fd,pc);Bc=wc.a(Bc,eb);var Bd=ed.Na(1,null);Bd.selectedRanges=ic;Bd.addToPrintArea=Ac;
return La.g(ed,"SetPrintArea",Bd,fd,Bc,ld,null,0)}var ed=this.$.oa.xa;return wa.EwaSettings.Zb()?Ta.a(this.$.userOperationManager,Gc,function(fd){return new Db.a(241,0,fd,64,lc)},Fb):Ta.a(this.$.userOperationManager,Gc,function(fd){return new $a.a(241,0,fd,void 0,lc)},Fb)};x.prototype.gdi=function(Fb,pc,eb){function ic(){return new I(lc)}function Ac(ed,fd,Bc){ed=wc.b(ed,pc);fd=wc.a(fd,eb);var ld=Gc.Na(1,null);ld.sheetName=lc;return La.g(Gc,"ClearPrintArea",ld,ed,fd,Bc,null,0)}var lc=this.$.va.pa.name,
Gc=this.$.oa.xa;return wa.EwaSettings.Zb()?Ta.a(this.$.userOperationManager,Ac,function(ed){return new Db.a(243,0,ed,64,ic)},Fb):Ta.a(this.$.userOperationManager,Ac,function(ed){return new $a.a(243,0,ed,void 0,ic)},Fb)};x.prototype.rdi=function(Fb,pc,eb){function ic(){return new T(ed)}function Ac(fd,Bc,ld){var Bd=lc.$.oa.xa;fd=wc.b(fd,pc);Bc=wc.a(Bc,eb);var xb=Bd.Na(9,null);xb.sheetCell=ed;return La.g(Bd,"InsertPageBreak",xb,fd,Bc,ld,null,0)}var lc=this,Gc=ta.g(this.$),ed=S.o(Gc.ha.sa.activeCell,
this.$);return wa.EwaSettings.Zb()?Ta.a(this.$.userOperationManager,Ac,function(fd){return new Db.a(244,0,fd,64,ic)},Fb):Ta.a(this.$.userOperationManager,Ac,function(fd){return new $a.a(244,0,fd,void 0,ic)},Fb)};x.prototype.vdi=function(Fb,pc,eb){function ic(){return new M(ed)}function Ac(fd,Bc,ld){var Bd=lc.$.oa.xa;fd=wc.b(fd,pc);Bc=wc.a(Bc,eb);var xb=Bd.Na(9,null);xb.sheetCell=ed;return La.g(Bd,"RemovePageBreak",xb,fd,Bc,ld,null,0)}var lc=this,Gc=ta.g(this.$),ed=S.o(Gc.ha.sa.activeCell,this.$);
return wa.EwaSettings.Zb()?Ta.a(this.$.userOperationManager,Ac,function(fd){return new Db.a(245,0,fd,64,ic)},Fb):Ta.a(this.$.userOperationManager,Ac,function(fd){return new $a.a(245,0,fd,void 0,ic)},Fb)};x.prototype.ydi=function(Fb,pc,eb){function ic(){return new U(Gc)}function Ac(ed,fd,Bc){var ld=lc.$.oa.xa;ed=wc.b(ed,pc);fd=wc.a(fd,eb);var Bd=ld.Na(9,null);Bd.sheetName=Gc;return La.g(ld,"ResetAllPageBreaks",Bd,ed,fd,Bc,null,0)}var lc=this,Gc=this.$.va.pa.name;return wa.EwaSettings.Zb()?Ta.a(this.$.userOperationManager,
Ac,function(ed){return new Db.a(246,0,ed,64,ic)},Fb):Ta.a(this.$.userOperationManager,Ac,function(ed){return new $a.a(246,0,ed,void 0,ic)},Fb)};x.prototype.lUh=function(Fb,pc,eb){if(!Fb||!pc||!eb)return null;var ic=new C;ic.FirstRow=pc.FirstRow===Fb.LastRow+1?eb.getRowIndex(Fb.LastRow+1)+1:pc.FirstRow<Fb.FirstRow?0:eb.getRowIndex(pc.FirstRow+1);ic.LastRow=pc.FirstRow===Fb.LastRow+1||pc.LastRow>Fb.LastRow?eb.getRowIndex(Fb.LastRow+1)+1:eb.getRowIndex(pc.LastRow+1);return ic};x.prototype.kUh=function(Fb,
pc,eb){if(!Fb||!pc||!eb)return null;var ic=new C;ic.FirstColumn=pc.FirstColumn===Fb.LastColumn+1?eb.getColumnIndex(Fb.LastColumn+1)+1:pc.FirstColumn<Fb.FirstColumn?0:eb.getColumnIndex(pc.FirstColumn+1);ic.LastColumn=pc.FirstColumn===Fb.LastColumn+1||pc.LastColumn>Fb.LastColumn?eb.getColumnIndex(Fb.LastColumn+1)+1:eb.getColumnIndex(pc.LastColumn+1);return ic};x.prototype.j8g=function(Fb,pc,eb){if(!pc||!eb||!Fb)return null;var ic=Fb.getPrintArea();if(!ic||!ic.length)return null;var Ac=Fb.getRowIndex(eb.FirstRow+
1),lc=Fb.getColumnIndex(eb.FirstColumn+1),Gc=null,ed=null;ic=ak(ic);for(var fd=ic.next();!fd.done;fd=ic.next())if(fd=fd.value,Ac>=fd.FirstRow&&Ac<=fd.LastRow&&lc>=fd.FirstColumn&&lc<=fd.LastColumn){if(eb.FirstRow===fd.FirstRow&&eb.FirstColumn===fd.FirstColumn)return new E;Ac>fd.FirstRow&&(Gc=Object(ma.a)(new G,{Index:Ac-1,Min:fd.FirstColumn-1,Max:Math.min(fd.LastColumn,Fb.getColumnIndex(pc.LastColumn+1))}));lc>fd.FirstColumn&&(ed=Object(ma.a)(new G,{Index:lc-1,Min:fd.FirstRow-1,Max:Math.min(fd.LastRow,
Fb.getRowIndex(pc.LastRow+1))}));break}return Gc||ed?Object(ma.a)(new E,{Row:Gc?[Gc]:null,Col:ed?[ed]:null}):null};x.prototype.y9g=function(Fb,pc,eb){if(!pc||!eb||!Fb)return null;var ic=null;eb.FirstRow>pc.FirstRow&&eb.FirstRow<=pc.LastRow?ic=Object(ma.a)(new G,{Index:Fb.getRowIndex(eb.FirstRow+1)-1,Min:-1,Max:-1}):eb.FirstRow===pc.LastRow+1&&(ic=Object(ma.a)(new G,{Index:Fb.getRowIndex(pc.LastRow+1),Min:-1,Max:-1}));return ic};x.prototype.W4g=function(Fb,pc,eb){if(!pc||!eb||!Fb)return null;var ic=
null;eb.FirstColumn>pc.FirstColumn&&eb.FirstColumn<=pc.LastColumn?ic=Object(ma.a)(new G,{Index:Fb.getColumnIndex(eb.FirstColumn+1)-1,Min:-1,Max:-1}):eb.FirstColumn===pc.LastColumn+1&&(ic=Object(ma.a)(new G,{Index:Fb.getColumnIndex(pc.LastColumn+1),Min:-1,Max:-1}));return ic};x.prototype.LDe=function(Fb,pc,eb){if(!eb||!Fb||!pc)return null;var ic=this.y9g(Fb,pc,eb);Fb=this.W4g(Fb,pc,eb);return ic||Fb?Object(ma.a)(new E,{Row:ic?[ic]:null,Col:Fb?[Fb]:null}):null};x.prototype.udi=function(){var Fb=new P.StandardDialog;
Fb.Rb=0;Fb.mc(1,xa.a.instance.ga(4));Fb.nl(xa.a.instance.ga(572),xa.a.instance.ga(573),1,null)};x.prototype.WDj=function(Fb){if(this.vva.kb(Fb)&&(va.HelperMethods.ZZ&&(this.fFb=this.$.Fb.sc("UserAction","PrintAreaPageBreaksTimeStopwatch")),this.wKa.kb(Fb)&&this.wKa.remove(Fb),this.wKa.add(Fb,Ia.a.create().toString()),ta.g(this.$).ui)){var pc=Ab.b()?Ab.b().fi(Fb):"";ta.g(this.$).ui.w7(this.vva.na(Fb),this.wKa.na(Fb),pc)}};x.prototype.rWg=function(Fb){if(this.fFb&&Fb){var pc=this.fFb.qc;this.fFb.stop();
this.fFb=null;switch(Fb){case "SetPrintArea":this.Gpb(pc,1700,Fb);break;case "ClearPrintArea":this.Gpb(pc,1500,Fb);break;case "InsertPageBreak":this.Gpb(pc,1500,Fb);break;case "RemovePageBreak":this.Gpb(pc,1600,Fb);break;case "ResetAllPageBreaks":this.Gpb(pc,1700,Fb)}}};x.prototype.Gpb=function(Fb,pc,eb){Fb>pc&&(pc=Object(ma.a)(new ob.a,{extendedProperties:new Map}),pc.extendedProperties.set("OperationName",eb),pc.extendedProperties.set("OperationExecutionTime",Fb.toString()),oa.Health.instance.recordQosError(Da.a.JCj,
[rb.a.FCj],!1,!0,!0,!1,pc))};x.prototype.M3h=function(Fb,pc,eb,ic,Ac,lc){var Gc=this,ed=new P.StandardDialog,fd=new Ja.a(xa.a.instance.ga(570),xa.a.instance.ga(571),xa.a.instance.ga(6),xa.a.instance.ga(5));ed.Rb=1;ed.mc(1,fd.confirmButton);ed.mc(0,fd.cancelButton);ed.nl(fd.title,fd.body,3,function(Bc){1===Bc&&(Gc.WZf(Fb.command,Ac,lc),Gc.laf(Fb,eb,ic,pc,lc))})};x.prototype.sNb=function(Fb,pc,eb){eb();this.wKa.kb(pc)&&Fb.ui.B0(this.wKa.na(pc),pa.BasicTelemetryCalculator.NQ)};x.prototype.lWd=function(){this.bpd&&
this.$.Fd(-1753588160,-1,0,null)};Object(ea.a)(x,"PrintAreaBreakManager",null,[723]);var Pb=b(411),Aa=b(90);y.prototype.equals=function(Fb){return Fb?this.orientation===Fb.orientation&&this.yca===Fb.yca&&this.j0===Fb.j0&&this.margin===Fb.margin&&this.sheetPrintOptions===Fb.sheetPrintOptions&&this.s1a===Fb.s1a&&this.NoColor===Fb.NoColor:!1};y.IBe=function(Fb,pc){Fb&&pc&&(pc.vv=Fb.vv,pc.orientation=Fb.orientation,pc.yca=Fb.yca,pc.j0=Fb.j0,pc.margin=Fb.margin,pc.ignorePrintArea=Fb.ignorePrintArea,pc.sheetPrintOptions=
Fb.sheetPrintOptions,pc.s1a=Fb.s1a,pc.NoColor=Fb.NoColor)};Object(ea.a)(y,"PrintSettingsContainer",null,[]);var Ya=b(160),kb=b(357),lb=b(38),ac=b(1024),Dc=b(994),Zb=b(202),mc=b(737),Lb=b(616);Object(ea.a)(B,"PrintSettingMarginOption",null,[]);Object(ea.a)(A,"PrintSettingMarginValue",null,[]);Object(ea.a)(v,"PrintSettingOption",null,[]);r.prototype.dispose=function(){};r.prototype.Evb=function(Fb){if(!Fb)return null;var pc=new A;pc.left=Fb.Left;pc.right=Fb.Right;pc.top=Fb.Top;pc.bottom=Fb.Bottom;pc.header=
Fb.Header;pc.footer=Fb.Footer;return pc};r.prototype.x3c=function(Fb){ka.ULS.shipAssertTag(537154186,0,6===Fb.length,"PrintPreviewManager.CreatePageMargin: marginValue array passed in, doesn't contain 6 margin values");var pc={};pc.Top=Fb[0];pc.Bottom=Fb[1];pc.Left=Fb[2];pc.Right=Fb[3];pc.Header=Fb[4];pc.Footer=Fb[5];return pc};r.prototype.zai=function(){this.Cie=[Object(ma.a)(new v,{printSettingOptionKey:1,printSettingOptionText:this.Im.ga(1211)}),Object(ma.a)(new v,{printSettingOptionKey:2,printSettingOptionText:this.Im.ga(1204)}),
Object(ma.a)(new v,{printSettingOptionKey:0,printSettingOptionText:this.Im.ga(1203)})];this.ace=[Object(ma.a)(new v,{printSettingOptionKey:1,printSettingOptionText:this.Im.ga(1214)}),Object(ma.a)(new v,{printSettingOptionKey:2,printSettingOptionText:this.Im.ga(1213)})];this.rce=[Object(ma.a)(new v,{printSettingOptionKey:1,printSettingOptionText:this.Im.ga(1216)}),Object(ma.a)(new v,{printSettingOptionKey:5,printSettingOptionText:this.Im.ga(1217)}),Object(ma.a)(new v,{printSettingOptionKey:6,printSettingOptionText:this.Im.ga(1224)}),
Object(ma.a)(new v,{printSettingOptionKey:7,printSettingOptionText:this.Im.ga(1218)}),Object(ma.a)(new v,{printSettingOptionKey:8,printSettingOptionText:this.Im.ga(1219)}),Object(ma.a)(new v,{printSettingOptionKey:9,printSettingOptionText:this.Im.ga(1220)}),Object(ma.a)(new v,{printSettingOptionKey:11,printSettingOptionText:this.Im.ga(1221)}),Object(ma.a)(new v,{printSettingOptionKey:12,printSettingOptionText:this.Im.ga(1222)}),Object(ma.a)(new v,{printSettingOptionKey:13,printSettingOptionText:this.Im.ga(1223)}),
Object(ma.a)(new v,{printSettingOptionKey:3,printSettingOptionText:this.Im.ga(1215)})];this.Uee=[Object(ma.a)(new v,{printSettingOptionKey:0,printSettingOptionText:this.Im.ga(1232)}),Object(ma.a)(new v,{printSettingOptionKey:1,printSettingOptionText:this.Im.ga(1233)}),Object(ma.a)(new v,{printSettingOptionKey:2,printSettingOptionText:this.Im.ga(1234)}),Object(ma.a)(new v,{printSettingOptionKey:3,printSettingOptionText:this.Im.ga(1235)})];this.aae=[Object(ma.a)(new B,{printSettingOption:Object(ma.a)(new v,
{printSettingOptionKey:0,printSettingOptionText:this.Im.ga(1238)}),marginValue:this.Evb(this.normal)}),Object(ma.a)(new B,{printSettingOption:Object(ma.a)(new v,{printSettingOptionKey:1,printSettingOptionText:this.Im.ga(1239)}),marginValue:this.Evb(this.wide)}),Object(ma.a)(new B,{printSettingOption:Object(ma.a)(new v,{printSettingOptionKey:2,printSettingOptionText:this.Im.ga(1240)}),marginValue:this.Evb(this.narrow)}),Object(ma.a)(new B,{printSettingOption:Object(ma.a)(new v,{printSettingOptionKey:3,
printSettingOptionText:this.Im.ga(1241)}),marginValue:this.Evb(this.z6)})]};r.prototype.sai=function(){this.normal=this.x3c(this.xDi);this.narrow=this.x3c(this.jCi);this.wide=this.x3c(this.fXj)};Af.Object.defineProperties(r.prototype,{whatToPrintOptions:{configurable:!0,enumerable:!0,get:function(){return this.Cie}},orientationOptions:{configurable:!0,enumerable:!0,get:function(){return this.ace}},paperSizeOptions:{configurable:!0,enumerable:!0,get:function(){return this.rce}},scalingOptions:{configurable:!0,
enumerable:!0,get:function(){return this.Uee}},marginDetailedOptions:{configurable:!0,enumerable:!0,get:function(){return this.aae}}});r.Fch=1;r.sch=1;r.Nrb=9;r.xch=2;r.qch=0;r.jch=!1;r.fch=!1;r.WHa={PrintGrid:!1,HorizontalCenter:!1,VerticalCenter:!1,PrintHeaders:!1};Object(ea.a)(r,"PrintSettingsManagerBase",null,[10]);var Sa=b(128),Cb=b(296);z.prototype.getSheetName=function(){return this.sheetName};Object(ea.a)(z,"MacroRecorderSheetPrintOptionsSavedPayload",null,[409]);Rk(n,r);n.prototype.ldi=function(Fb){var pc=
this;this.mdi(function(eb){Fb&&(eb=pc.qUh(eb),Fb(eb))})};n.prototype.NLd=function(Fb,pc){if(Fb){var eb=new K(Fb.vv,Fb.ignorePrintArea);this.Cjj(eb);!pc||this.p4f?ka.ULS.sendTraceTag(593294034,0,50,"PrintSettingsManager.SavePrintSettings: Saving of print settings skipped because {0}",pc?"skipSaveToFile is true":"shouldFilePersistedPrintSettingsBeSaved is false"):(pc=this.sUh(Fb.j0),pc.IsLandscape=2===Fb.orientation,pc.PaperSize=Fb.yca,this.isUniversalPrintEnabled&&(pc.NoColor=Fb.NoColor),pc.PageMargin=
this.hfd(Fb.margin),pc.SheetPrintOptions=r.WHa,pc.SheetPrintOptions.PrintGrid=Fb.sheetPrintOptions.PrintGrid,pc.SheetPrintOptions.HorizontalCenter=Fb.sheetPrintOptions.HorizontalCenter,pc.SheetPrintOptions.VerticalCenter=Fb.sheetPrintOptions.VerticalCenter,pc.SheetPrintOptions.PrintHeaders=Fb.sheetPrintOptions.PrintHeaders,this.Bjj(pc))}else ka.ULS.sendTraceTag(593294035,0,10,"PrintSettingsManager.SavePrintSettings: printSettingsContainer passed as parameter is null")};n.prototype.hfd=function(Fb){var pc=
{};0===Fb?pc=this.normal:1===Fb?pc=this.wide:2===Fb?pc=this.narrow:3===Fb&&(pc=this.z6);return pc};n.prototype.Cdi=function(Fb){var pc=this;if(Fb){ka.ULS.sendTraceTag(537154197,0,50,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: Make server call to save print options to file");var eb=function(){return new z(pc.$.va.pa.name,Fb)},ic=this.$.oa.xa,Ac=this.$.oa.xa.Pb(),lc=function(Gc,ed,fd){var Bc=pc.$.va.pa.name;Gc=wc.b(pc.xAd,Gc);ed=wc.a(pc.IAd,ed);var ld=ic.Na(1,null);ld.sheetName=Bc;ld.printOptions=
Fb;return La.g(ic,"SetPrintOptions",ld,Gc,ed,fd,Ac,0)};eb=wa.EwaSettings.Zb()?new Db.a(598,0,lc,64,eb):new $a.a(598,0,lc,void 0,eb);this.$.userOperationManager.Sb(eb,null)}else ka.ULS.sendTraceTag(537154198,0,10,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: sheetPrintOptions passed as parameter is null")};n.prototype.dispose=function(){this.Ad||(this.Ad=!0,this.$.userOperationManager.wo(this.Bz),this.bY())};n.prototype.Cjj=function(Fb){this.HN.vv=Fb.vv;this.HN.ignorePrintArea=Fb.ignorePrintArea};
n.prototype.mdi=function(Fb){function pc(ed,fd,Bc){return H(Ac.$.oa.xa,Ac.sheetName,Ac.locale,wc.b(ed,ic),wc.a(fd,eb),Bc,lc)}function eb(ed){ed=ya.a.Of(ed.data);ka.ULS.sendTraceTag(537154194,0,10,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: {0}.",bb.a.Dc(ed));Fb(null)}function ic(ed){Cb.a(ed)?ka.ULS.sendTraceTag(537154196,0,15,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: {0}.",bb.a.Dc(ed.Errors)):(ka.ULS.sendTraceTag(537154195,
0,50,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings succeeded."),Fb(ed.Result))}var Ac=this,lc=this.$.oa.xa.Pb();var Gc=wa.EwaSettings.Zb()?new Db.a(247,0,pc,80):new $a.a(247,0,pc,16);Gc=this.$.userOperationManager.Sb(Gc,null);this.$u.add(Gc)};n.prototype.Bjj=function(Fb){var pc=this;ka.ULS.sendTraceTag(593294031,0,50,"PrintSettingsManager.SavePrintSettingsPersistedInFile: Make server call to save print settings to file");var eb=this.$.oa.xa.Pb();this.$.userOperationManager.Sb(new Db.a(226,
0,function(ic,Ac,lc){return ca(pc.$.oa.xa,pc.sheetName,Fb,wc.b(ic,pc.$Qi),wc.a(Ac,pc.ZQi),lc,eb)},void 0,function(){return new O(pc.sheetName,Fb)}),null)};n.prototype.Fki=function(Fb){return this.Dbf(Fb)||!this.Mef(Fb.PaperSize)};n.prototype.iad=function(Fb){this.Dbf(Fb)&&(ka.ULS.sendTraceTag(537154192,0,50,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Custom scaling present in file."),Fb.ScalingWidth=n.l5c,Fb.ScalingHeight=n.k5c,Fb.ScalingPercent=n.L5b,Fb.FitToPage=n.e5c);this.Mef(Fb.PaperSize)||
(ka.ULS.sendTraceTag(537154191,0,15,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Paper size {0} present in file which is unsupported by XLO.",Fb.PaperSize.toString()),Fb.PaperSize=n.Nrb);return Fb};n.prototype.oUh=function(Fb){if(Fb.FitToPage){if(1===Fb.ScalingWidth&&1===Fb.ScalingHeight)return 1;if(!Fb.ScalingWidth&&1===Fb.ScalingHeight)return 3}else return 0;return 2};n.prototype.nUh=function(Fb){return this.Lod(Fb,this.normal)?0:this.Lod(Fb,this.wide)?1:this.Lod(Fb,this.narrow)?2:3};
n.prototype.Lod=function(Fb,pc){return Fb.Left===pc.Left&&Fb.Right===pc.Right&&Fb.Top===pc.Top&&Fb.Bottom===pc.Bottom&&Fb.Header===pc.Header&&Fb.Footer===pc.Footer};n.prototype.sUh=function(Fb){var pc={};pc.ScalingPercent=n.L5b;pc.FitToPage=0!==Fb;2===Fb?(pc.ScalingWidth=1,pc.ScalingHeight=0):3===Fb?(pc.ScalingWidth=0,pc.ScalingHeight=1):1===Fb&&(pc.ScalingWidth=1,pc.ScalingHeight=1);return pc};n.prototype.Mef=function(Fb){return this.iWi.contains(Fb.toString())};n.prototype.Dbf=function(Fb){return 100!==
Fb.ScalingPercent||Fb.FitToPage&&(1<Fb.ScalingWidth||1<Fb.ScalingHeight)};n.prototype.K2g=function(){for(var Fb=new mc.a(Lb.a.Jk()),pc=0;pc<this.paperSizeOptions.length;pc++)Fb.add(this.paperSizeOptions[pc].printSettingOptionKey.toString());return Fb};n.prototype.qUh=function(Fb){var pc=null;if(Fb){var eb=this.HN.vv,ic=this.HN.ignorePrintArea;this.Fki(Fb)&&(this.p4f=!0,Fb=this.iad(Fb));pc=new y;pc.vv=eb;pc.ignorePrintArea=ic;pc.orientation=Fb.IsLandscape?2:1;pc.yca=Fb.PaperSize;pc.j0=this.oUh(Fb);
pc.sheetPrintOptions=r.WHa;pc.sheetPrintOptions.PrintGrid=Fb.SheetPrintOptions.PrintGrid;pc.s1a=Fb.Draft;this.isUniversalPrintEnabled&&(pc.NoColor=Fb.NoColor);pc.sheetPrintOptions.HorizontalCenter=Fb.SheetPrintOptions.HorizontalCenter;pc.sheetPrintOptions.VerticalCenter=Fb.SheetPrintOptions.VerticalCenter;pc.sheetPrintOptions.PrintHeaders=Fb.SheetPrintOptions.PrintHeaders;pc.margin=this.nUh(Fb.PageMargin);wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5466517_AddPageMarginLogs")&&ka.ULS.sendTraceTag(553965398,
0,50,"PageMargin received : {0}",pc.margin);3===pc.margin&&(this.z6={},this.z6.Left=Fb.PageMargin.Left,this.z6.Right=Fb.PageMargin.Right,this.z6.Top=Fb.PageMargin.Top,this.z6.Bottom=Fb.PageMargin.Bottom,this.z6.Header=Fb.PageMargin.Header,this.z6.Footer=Fb.PageMargin.Footer)}return pc};n.prototype.bY=function(){if(this.$u){for(var Fb=ak(this.$u),pc=Fb.next();!pc.done;pc=Fb.next())pc=pc.value,this.$&&this.$.userOperationManager&&(pc.operation&&ka.ULS.sendTraceTag(537154187,0,50,"PrintSettingsManager.AbortOutstandingUserOperation: Trying to abort pending operation {0}.",
Sa.a(pc.operation.operationName)),this.$.userOperationManager.vta(pc)),this.$u.remove(pc);this.$u=null}};n.l5c=1;n.k5c=0;n.L5b=100;n.Nrb=9;n.e5c=!0;Object(ea.a)(n,"PrintSettingsManager",r,[]);var ec=b(67);Object(ea.a)(w,"PrintSettingsTaskPaneCallbacks",null,[]);Object(ea.a)(f,"SelectedPrintSettings",null,[]);Object(ea.a)(m,"PrintOperationCallbacks",null,[]);Object(ea.a)(l,"PrintPreviewPaneCallbacks",null,[]);var wb=b(1284);Object(ea.a)(k,"UniversalPrintAppSettings",null,[]);var rc=b(395);e.prototype.pGg=
function(Fb){this.Qa.addHandler("ppocek",Fb)};e.prototype.mcj=function(Fb){this.Qa.removeHandler("ppocek",Fb)};e.prototype.JAj=function(Fb,pc){this.Vfj();this.$.userOperationManager.Cr(this.Bz);this.Gm=Fb;this.Qa.raiseEvent("ppocek");this.Gm.SelectedRanges&&this.Gm.SelectedRanges.Ranges&&0<this.Gm.SelectedRanges.Ranges.length&&this.Gm.SelectedRanges.Ranges[0]&&(this.selectedRange=S.B(this.Gm.SelectedRanges.Ranges[0]).toString());ka.ULS.shipAssertTag(537154268,0,!this.av,"PrintPreviewManager.ShowPrintPreviewer: printSettingsManager should be null.");
this.av=new n(this,this.$,pc,this.$.va.pa.name,xa.a.instance,this.isUniversalPrintEnabled);ka.ULS.shipAssertTag(537154267,0,!this.lg,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should be null.");this.lg=new Dc.PrintPreviewPane(this.$,this,this.useMSPdfViewer,this.isUniversalPrintEnabled);this.lg.jgh();this.lg.LAj();this.lg.IFg(this.uzf)};e.prototype.xRh=function(){this.av.z6&&4<=this.av.marginDetailedOptions.length&&(this.av.marginDetailedOptions[3].marginValue=this.av.Evb(this.av.z6));
return this.av.marginDetailedOptions};e.prototype.Jwc=function(){return!!this.Gm&&!!this.Gm.ObjectId||!ta.g(this.$).ha.sa.tg};e.prototype.tUh=function(){var Fb=Object(ma.a)(new f,{selectedWhatToPrint:r.Fch,selectedOrientation:r.sch,selectedPaperSize:r.Nrb,selectedScaling:r.xch,selectedMargin:r.qch,selectedIgnorePrintArea:r.jch,selectedPrintGridlines:r.WHa.PrintGrid,selectedDraft:r.fch,selectedHorizontalCenter:r.WHa.HorizontalCenter,selectedVerticalCenter:r.WHa.VerticalCenter,selectedRowAndColumnHeadings:r.WHa.PrintHeaders});
this.tH?(Fb.selectedWhatToPrint=this.tH.vv,Fb.selectedOrientation=this.tH.orientation,Fb.selectedPaperSize=this.tH.yca,Fb.selectedScaling=this.tH.j0,Fb.selectedMargin=this.tH.margin,Fb.selectedIgnorePrintArea=this.tH.ignorePrintArea,Fb.selectedPrintGridlines=this.tH.sheetPrintOptions.PrintGrid,Fb.selectedDraft=this.tH.s1a,this.isUniversalPrintEnabled&&(Fb.selectedColor=this.tH.NoColor?0:1),Fb.selectedHorizontalCenter=this.tH.sheetPrintOptions.HorizontalCenter,Fb.selectedVerticalCenter=this.tH.sheetPrintOptions.VerticalCenter,
Fb.selectedRowAndColumnHeadings=this.tH.sheetPrintOptions.PrintHeaders):ka.ULS.sendTraceTag(593294038,0,10,"PrintPreviewManager.GetPrintSettingsSelectedOnPaneOpen: initialPrintSettings is null.");return Fb};e.prototype.r0e=function(){var Fb=this;return Object(ma.a)(new l,{onBackToSheet:function(){Fb.Hla()}})};e.prototype.pUh=function(){var Fb=this;return Object(ma.a)(new wb.a,{backActionButtonText:xa.a.instance.ga(1191),printPreviewPaneCallbacks:this.r0e(),logger:new Pb.a,disableTellMeControl:!0,
printOperationCallbacks:Object(ma.a)(new m,{onClosePreviewer:function(){Fb.Hla()},getGraphServiceAuthorizationToken:this.M$b(),onLocalPrint:function(){Fb.hAf()},onNotifyPrintJobStatus:this.onNotifyPrintJobStatus}),universalPrintAppSettings:Object(ma.a)(new k,{graphServiceEndpoint:this.graphServiceEndpoint,graphServiceEndpointVersion:this.Oei()?"testppebeta-print":"v1.0",isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled,appName:"Excel"})})};e.prototype.rUh=function(){var Fb=this;return Object(ma.a)(new w,
{onSettingChange:function(pc){Fb.PPi(pc)},onPrint:function(){Fb.hAf()}})};e.prototype.PPi=function(Fb){this.Q_++;Fb?(this.lg&&this.lg.BBj(),this.qk.vv=Fb.selectedWhatToPrint,this.qk.j0=Fb.selectedScaling,this.qk.orientation=Fb.selectedOrientation,this.qk.yca=Fb.selectedPaperSize,this.qk.margin=Fb.selectedMargin,this.isUniversalPrintEnabled&&(this.qk.NoColor=!Fb.selectedColor),this.qk.ignorePrintArea=Fb.selectedIgnorePrintArea,this.Arj(Fb.selectedPageStart,Fb.selectedPageEnd),this.av&&this.S4h(this.qk,
Fb)?(this.qk.sheetPrintOptions=r.WHa,this.qk.sheetPrintOptions.PrintGrid=Fb.selectedPrintGridlines,this.qk.sheetPrintOptions.HorizontalCenter=Fb.selectedHorizontalCenter,this.qk.sheetPrintOptions.VerticalCenter=Fb.selectedVerticalCenter,this.qk.sheetPrintOptions.PrintHeaders=Fb.selectedRowAndColumnHeadings,this.av.Cdi(this.qk.sheetPrintOptions)):this.Yxb()):ka.ULS.sendTraceTag(593294037,0,10,"PrintPreviewManager.OnPrintSettingsChange: changedPrintSettings passed as input is null.")};e.prototype.Hla=
function(){this.M5a&&(this.uMb=!0);ka.ULS.sendTraceTag(591196513,0,50,"PrintPreviewManager.OnCloseButtonClick: User changed printSettings {0} times before clicking on backToWorkbook icon",this.Q_);this.gAf();this.Jxe()};e.prototype.hAf=function(){ka.ULS.sendTraceTag(591196512,0,50,"PrintPreviewManager.OnPrintButtonClick: User changed printSettings {0} times before clicking on print button.",this.Q_);wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5466517_AddPageMarginLogs")&&ka.ULS.sendTraceTag(543024129,
0,50,"PrintPreviewManager.OnPrintButtonClick: Current margin value : {0}, Initial margin value : {1}",this.qk.margin,this.tH.margin);if(this.useMSPdfViewer)this.fIf();else if(this.u6a)try{this.lg.printPdf(),this.y0c()}catch(Fb){ka.ULS.sendTraceTag(574482433,0,15,"PrintPreviewManager.OnPrintButtonClick: Unable to print. Opening the window."),this.fIf()}else this.gia.q3f(this.vHa(!0)),this.y0c()};e.prototype.fIf=function(){var Fb=this.vHa(!0);this.y0c();va.HelperMethods.Ze(Fb,void 0,void 0,"PrintPreviewManager.CreateFileCopyFileHandlerURL")};
e.prototype.dispose=function(){Aa.a.Ia(this.Qa)};e.prototype.Yxb=function(){var Fb=this;if(this.$.pwa)this.idi();else{this.bY();this.lTf();var pc=null;this.R$h();ka.ULS.sendTraceTag(593266766,0,50,"PrintPreviewManager:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");var eb=function(ic,Ac,lc){ic=new Va.a(ic,null,Ac,lc,null,!0,!1,"GetFileCopyFileHandler","");ic.correlationID=Ia.a.create().toString();pc=ic;Fb.Pba=Fb.S2.z9(Fb.vHa(Fb.u6a?!1:!0,Fb.Hei?"Base64":"Pdf"),1,null,null,e.v$c,!1,
2,Fb.szd,Fb.rzd,pc,void 0,void 0,void 0,12E4);ic.requestId=Fb.Pba;ka.ULS.sendTraceTag(537154264,0,50,"PrintPreviewManager.InvokeGetFileCopyFileHandler: Creating request with id: {0}.",Fb.Pba);return zb.Task.Ua(!0)};this.WMa=wa.EwaSettings.Zb()?this.$.userOperationManager.Sb(new Db.a(223,0,eb,80),null):this.$.userOperationManager.Sb(new $a.a(223,0,eb,16),null)}};e.prototype.y0c=function(){this.gAf();this.Jxe()};e.prototype.xAd=function(Fb){bb.a.Xq(Fb.Errors)?this.lg.showErrorMessageForPrintOptions(xa.a.instance.ga(1242)):
(ka.ULS.sendTraceTag(537154263,0,50,"PrintPreviewManager.OnPrintOptionsUpdationSuccess: SetPrintOptions server call is successful."),this.Yxb(),this.lg&&this.lg.hideErrorMessageForPrintOptions())};e.prototype.IAd=function(Fb){this.lg&&this.lg.showErrorMessageForPrintOptions(xa.a.instance.ga(1242));Fb=ya.a.Of(Fb.data);ka.ULS.sendTraceTag(537154262,0,10,"PrintPreviewManager.OnSavePrintOptionsToFileFailure: Save print options to file failed. Errors: {0}.",bb.a.Dc(Fb))};e.prototype.idi=function(){function Fb(ic,
Ac,lc){var Gc={};Gc.WhatToPrint=pc.qk.vv;Gc.UseNamedAction=pc.gia.ixc();Gc.SelectedSheetName=pc.$.va.pa.name;Gc.ActiveCell=pc.activeCell;Gc.SelectedRanges=[pc.selectedRange];Gc.IsPdfDocumentRequired=!1;Gc.Orientation=pc.qk.orientation;Gc.PaperSize=pc.qk.yca;Gc.Scaling=pc.qk.j0;Gc.RichValuesEnabled=!0;Gc.IgnorePrintArea=pc.qk.ignorePrintArea;Gc.Preview=!0;pc.isUniversalPrintEnabled&&(Gc.NoColor=pc.qk.NoColor);pc.T0f()&&(Gc.PaginationStartPage=pc.Kya,Gc.PaginationEndPage=pc.gma,Gc.OutputTotalPdfPageCount=
!0);var ed=pc.av.hfd(pc.qk.margin);ed&&(Gc.PageMargin={},Gc.PageMargin.Top=ed.Top,Gc.PageMargin.Bottom=ed.Bottom,Gc.PageMargin.Left=ed.Left,Gc.PageMargin.Right=ed.Right,Gc.PageMargin.Header=ed.Header,Gc.PageMargin.Footer=ed.Footer);pc.u7a=Q(pc.$.oa.xa,Gc,wc.b(pc.zIi,ic),wc.a(pc.yIi,Ac),lc,eb);return pc.u7a}var pc=this;ka.ULS.sendTraceTag(553649883,0,50,"PrintPreviewManager:InvokeConvertWorkbookToPrintPdf - Invoking ConvertWorkbookToPrintPdf");this.bY();var eb=this.$.oa.xa.Pb();wa.EwaSettings.Zb()?
this.WMa=this.$.userOperationManager.Sb(new Db.a(133,0,Fb,80),null):this.WMa=this.$.userOperationManager.Sb(new $a.a(133,0,Fb,16),null)};e.prototype.Jxe=function(){this.$.userOperationManager.wo(this.Bz);this.bY();this.lTf();ka.ULS.shipAssertTag(537154261,0,!!this.lg,"PrintPreviewManager.cleanUpPrintPreviewPanes: printPreviewPane should not be null");this.lg&&(this.lg.Qbj(this.uzf),this.lg.sgh(),this.lg=null);this.Gm=null;this.av&&(this.av.dispose(),this.av=null);this.Q2a=this.rFb=null;this.TKc=!1;
this.Qa&&this.Qa.raiseEvent("ppocek")};e.prototype.wwj=function(){return this.$.isEditMode&&!!this.tH&&!!this.qk&&2!==this.qk.vv&&this.pid()};e.prototype.NLd=function(){ka.ULS.shipAssertTag(537154260,0,!!this.av,"PrintPreviewManager.SavePrintSettings: printSettingsManager should not be null");this.av&&this.av.NLd(this.qk,this.wwj())};e.prototype.vHa=function(Fb,pc){pc=void 0===pc?"Pdf":pc;var eb=new Sys.StringBuilder;eb.append(yb.a(this.$,pc,!0));sa.a.Qg(eb,Ma.a.mFd,""+this.qk.vv);Fb&&this.gia.ixc()&&
sa.a.Qg(eb,Ma.a.Xdg,"1");sa.a.Qg(eb,Ma.a.BJf,this.$.va.pa.name);0===this.qk.vv&&(sa.a.Qg(eb,Ma.a.AJf,this.selectedRange),sa.a.Qg(eb,Ma.a.uJf,this.activeCell));sa.a.Qg(eb,Ma.a.vJf,""+this.qk.orientation);sa.a.Qg(eb,Ma.a.wJf,""+this.qk.yca);sa.a.Qg(eb,Ma.a.zJf,""+this.qk.j0);sa.a.Qg(eb,Ma.a.yJf,"1");sa.a.Qg(eb,Ma.a.tJf,this.qk.ignorePrintArea?"1":"0");sa.a.Qg(eb,Ma.a.xJf,"1");this.XJg(eb);this.isUniversalPrintEnabled&&sa.a.Qg(eb,Ma.a.B2i,this.qk.NoColor?"1":"0");this.WJg(eb);db.a.equals(pc,"Pdf",!0)&&
(eb.append("&#toolbar=0"),eb.append("&zoom=100"));Fb=eb.toString().replace("GetFileCopyFileHandler.aspx?","GetFileCopyFileHandler.aspx/?");ka.ULS.sendTraceTag(537154259,0,50,"PrintPreviewManager: Print Pdf Url {0}",Fb);return Fb};e.prototype.Arj=function(Fb,pc){Fb||pc?(this.ryb=!0,this.Kya=Fb,this.gma=pc):this.ySf()};e.prototype.XJg=function(Fb){this.T0f()&&(sa.a.Qg(Fb,Ma.a.D2i,""+this.Kya),sa.a.Qg(Fb,Ma.a.C2i,""+this.gma),sa.a.Qg(Fb,Ma.a.E2i,"1"),ka.ULS.sendTraceTag(537154258,0,50,"PrintPreviewManager: AppendPaginationQueryParameter Print Pdf page range from {0} to {1}",
this.Kya,this.gma))};e.prototype.T0f=function(){return null!=this.Kya&&0<this.Kya&&null!=this.gma&&0<this.gma};e.prototype.WJg=function(Fb){if(this.av&&this.qk){var pc=this.av.hfd(this.qk.margin);pc&&sa.a.Qg(Fb,Ma.a.A2i,""+pc.Top+" "+pc.Bottom+" "+pc.Left+" "+pc.Right+" "+pc.Header+" "+pc.Footer)}};e.prototype.TDb=function(Fb,pc,eb,ic){this.lg&&(ka.ULS.shipAssertTag(537154255,0,!!this.$.va.pa,"PrintPreviewManager.OnConvertWorkbookToPdfSucceeded: ewaControl.Sheets.ActiveItem should not be null"),this.$.va.pa&&
(this.u6a?(ic||(ic=this.vHa(!1)),this.lg.Psi(ic)):this.DAj()))};e.prototype.pid=function(){return!this.tH.equals(this.qk)};e.prototype.gAf=function(){!this.uMb&&0<this.Q_&&(this.cpd?this.NLd():ka.ULS.sendTraceTag(537154251,0,50,"PrintPreviewManager:OnPreviewerClose - Previewer is being closed without settings pane being loaded."));ka.ULS.shipAssertTag(537154250,0,!!this.lg,"PrintPreviewManager.OnPreviewerClose: printPreviewPane should not be null");this.lg&&this.lg.d6h();this.lWd()};e.prototype.kj=
function(){ka.ULS.sendTraceTag(593294036,0,50,"PrintPreviewManager.ShowErrorDialog: Error Dialog displayed.");if(this.lg){var Fb=this.Tza(xa.a.instance.ga(1));this.Fna(Fb,1)}else Fb=bb.a.Wc(1,0,26,0,1,-1100324317,"GetPrintSettingsFailedError"),wa.EwaSettings.qz()?new kb.a(this.$,Fb):(new Ya.ErrorDialog(this.$,Fb)).hf()};e.prototype.KAj=function(Fb){Fb?(0===Fb.vv&&this.Jwc()&&(ka.ULS.sendTraceTag(537154249,0,50,"PrintPreviewManager.ShowPrintPreviewer: Falling back to ActiveSheet because current selection is a ${0}.",
this.Gm.ObjectId?"floatingObject":"discontinuousRange"),Fb.vv=1),y.IBe(Fb,this.tH),y.IBe(Fb,this.qk),ka.ULS.shipAssertTag(537154248,0,!!this.lg,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should not be null"),this.lg&&(this.cpd=!0,this.lg.MAj(),this.Yxb())):(ka.ULS.sendTraceTag(537154247,0,10,"PrintPreviewManager.ShowPrintPreviewer: printSettings fetched from server is null."),this.kj())};e.prototype.u_c=function(Fb,pc,eb){Fb>pc&&(pc=Object(ma.a)(new ob.a,{extendedProperties:new Map}),
pc.extendedProperties.set("WtpSelectedValue",eb),pc.extendedProperties.set("FullyRenderedPdfLoadTime",Fb.toString()),oa.Health.instance.recordQosError(Da.a.HCj,[rb.a.x4f],!1,!0,!0,!1,pc))};e.prototype.bY=function(){this.WMa&&(0<this.Pba||this.u7a)&&(ka.ULS.sendTraceTag(537154246,0,50,"PrintPreviewManager.AbortOutstandingUserOperation: Cancelling request with id: {0}.",this.Pba),this.$.userOperationManager.vta(this.WMa),this.u7a?ya.a.nu(this.u7a.Ht):this.S2.nu(this.Pba),this.uKd())};e.prototype.uKd=
function(){this.u7a=this.WMa=null};e.prototype.R$h=function(){this.IJd&&this.qk&&(this.Q2a=this.$.Fb.sc("UserAction",(1===this.qk.vv?"ActiveSheet":0===this.qk.vv?"CurrentSelection":"EntireWorkbook")+"FullyRenderedPdfLoadTimeStopwatch"))};e.prototype.ySf=function(){this.ryb=!1;this.Kya=1;this.gma=this.yEd};e.prototype.Tza=function(Fb){if(Fb)return Fb.replace("&#39;","'");ka.ULS.sendTraceTag(537154245,0,15,"PrintPreviewManager.SanitizeErrorMessage: error message is null");return Fb};e.prototype.DAj=
function(){ka.ULS.sendTraceTag(537154244,0,50,"PrintPreviewManager.ShowPdfRenderingError invoked");if(this.rzb)if(this.Zgc)ka.ULS.sendTraceTag(537154243,0,10,"PrintPreviewManager.ShowPdfRenderingError: Called when preview was supported in both host & browser");else{var Fb=this.Tza(xa.a.instance.ga(1196));this.Fna(Fb,2)}else Fb=this.Tza(xa.a.instance.ga(1197)),this.Fna(Fb,3)};e.prototype.Fna=function(Fb,pc,eb){this.lg.Oz(Fb,pc,void 0===eb?null:eb)};e.prototype.bai=function(){this.Zgc=this.rxe();this.rzb=
this.PWg();this.u6a=this.QWg();ka.ULS.sendTraceTag(557061534,0,50,"PrintPreviewManager.InitializeIsPdfPreviewSupportedVars: isPdfPreviewSupportedInCurrentBrowser : {0}, isPdfPreviewSupportedInCurrentHost: {1}, isPdfPreviewSupportedInPreviewer: {2}",this.Zgc,this.rzb,this.u6a)};e.prototype.Vfj=function(){this.r7a=null;this.uKd();this.ySf();this.rFb=this.$.Fb.sc("UserAction","paneLoadTimeStopwatch");this.activeCell=this.$.pa.activeCell.toString();this.Q_=0;this.cpd=this.M5a=this.uMb=!1;this.TKc=!0};
e.prototype.vyj=function(){var Fb=this.oni()||this.Zgf()&&wa.EwaSettings.isChangeGateEnabled("OfficeVSO:6059097_EnablePreviewer3rdParty")?!0:!1;ka.ULS.sendTraceTag(537154242,0,50,"PrintPreviewManager.ShouldUseMSPdfViewer : {0}",Fb);return Fb};e.prototype.rxe=function(){return!Ka.a.iB};e.prototype.wWg=function(){var Fb=15;Ka.a.BH&&Ka.a.ysb&&(Fb=parseFloat(Ka.a.ysb));return this.rxe()&&14<Fb&&this.rzb};e.prototype.PWg=function(){return this.Zgf()&&!wa.EwaSettings.isChangeGateEnabled("OfficeVSO:6059097_EnablePreviewer3rdParty")?
!1:!0};e.prototype.oni=function(){return Ka.a.LC||Y.AFrameworkApplication.isUnifiedHostMode};e.prototype.QWg=function(){return this.Zgc&&this.rzb};e.prototype.Zgf=function(){return!this.$.Lf.get(111)};e.prototype.lTf=function(){this.r7a&&(URL.revokeObjectURL(this.r7a),this.r7a=null)};e.prototype.L4g=function(Fb){var pc=Fb.data.Ud;Fb=this.$.Fb.sc("UserAction","PrintPreviewBlobFileCreation");var eb=window.self.atob(pc);pc=new Uint8Array(pc.length);for(var ic=0;ic<eb.length;ic++)pc[ic]=eb.charCodeAt(ic)&
255;eb=new Blob([pc],{type:"application/pdf"});this.r7a=URL.createObjectURL(eb);ka.ULS.sendTraceTag(537154241,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - Blob created. Total time to create : {0} ms. Blob size: {1}",Fb.qc,eb.size);Fb.stop();return this.r7a+"#toolbar=0&zoom=100"};e.prototype.D6i=function(Fb){if(this.IJd&&bb.a.Zg(Fb,e.vXi)){var pc=Object(ma.a)(new ob.a,{extendedProperties:new Map});pc.extendedProperties.set("ErrorMessageIdName",Fb[0].MessageIdName);oa.Health.instance.recordQosError(Da.a.dIf,
[rb.a.eIf],!1,!0,!0,!1,pc)}};e.prototype.S4h=function(Fb,pc){return Fb.sheetPrintOptions.PrintGrid!==pc.selectedPrintGridlines||Fb.sheetPrintOptions.HorizontalCenter!==pc.selectedHorizontalCenter||Fb.sheetPrintOptions.VerticalCenter!==pc.selectedVerticalCenter||Fb.sheetPrintOptions.PrintHeaders!==pc.selectedRowAndColumnHeadings};e.prototype.lWd=function(){this.bpd&&this.$.Fd(-1753588160,-1,0,null)};e.prototype.Oei=function(){return!!this.$.ya&&!!this.$.ya.DocumentHostInfo&&"TestHost"===this.$.ya.DocumentHostInfo.HostTier};
e.prototype.getToken=function(){ka.ULS.sendTraceTag(522314589,0,50,"PrintPreviewManager:GetToken: Token requested for universal print graph service");return this.rDb.EO("Print",this.graphServiceEndpoint).then(function(Fb){return Fb?(Fb.IsSuccess||ka.ULS.sendTraceTag(537154240,0,15,"PrintPreviewManager:GetToken: failed to get token. Error code: {0}, Error message : {1}",Fb.ErrorCode,Fb.ErrorMessage),ka.ULS.sendTraceTag(522314588,0,50,"PrintPreviewManager:GetToken: successfully acquired token for universal print graph service"),
Fb):Object(ma.a)(new ac.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"})}).catch(function(Fb){var pc=new ac.a;Object.getType(Fb)===Object.getType(pc)?pc=Fb:(pc.ErrorMessage=Fb.toString(),pc.ErrorCode="exception");return Promise.resolve(pc)})};e.prototype.M$b=function(){var Fb=this;return function(){var pc=Promise.resolve("");try{if(Fb.rDb&&Fb.rDb.A5a())return Fb.getToken().then(function(eb){return eb.IsSuccess?Promise.resolve(eb.Token):pc},function(){return pc})}catch(eb){ka.ULS.sendTraceTag(537154211,
0,10,"PrintPreviewManager:GetAuthTokenDelegate - Exception thrown while fetching token",eb)}return pc}};e.prototype.onNotifyPrintJobStatus=function(Fb,pc){Fb=rc.a.Iy.notificationBar.G$(Fb,!1);"pending"==pc&&(Fb.displayTimeoutSeconds=3);if(wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactToast",!1))switch(pc){case "failure":Fb.image=1;break;case "success":Fb.image=3;break;default:Fb.image=0}else Fb.image=0;rc.a.Iy.notificationBar.VD(Fb)};Af.Object.defineProperties(e.prototype,{Eki:{configurable:!0,
enumerable:!0,get:function(){return this.TKc}}});e.vXi=[-953554093,1773721536,-1104435974,-1243918982,1205917367,1931972532,1294226134,1239184329,1207537900,-1053855722,-2077518688,1348242499,2030854436,-1831476778];e.v$c=["Content-Type","Total-Pdf-PageCount"];Object(ea.a)(e,"PrintPreviewManager",null,[721,10,722]);d.prototype.Lc=function(){return!1};d.prototype.executeCommand=function(Fb,pc,eb,ic){var Ac=pc.command;return 1588554917===Ac?(pc.Byb=!0,ab.a(this.$)&&this.$.da.za(423).Axc(!1),this.Tgh(pc)?
zb.Task.Ua(!0):da.a(Ac)):this.bIf.executeCommand(Fb,pc,eb,ic,this.uPi,this.tPi,this.LLj)};d.prototype.Ac=function(Fb,pc){return 1588554917===pc.command?(ka.ULS.shipAssertTag(537154305,0,this.$.nka,"Command execute requested for Print operation when data duplication is disallowed."),!0):this.bIf.Ac(Fb,pc)};d.prototype.Qc=function(){return!1};d.prototype.Tgh=function(Fb){return this.$.ea.dc?this.Ugh(Fb):!1};d.prototype.Ugh=function(Fb){ka.ULS.sendTraceTag(21099871,0,50,"PrintCommandHandler:DoPrintHtml");
var pc=this.$.Fb.sc("UserAction","DoPrintHtml"),eb=this.$,ic=this.ea.isNamedObjectViewMode?eb.vb.pa.sheetName:eb.va.pa.name,Ac=this.ea.isNamedObjectViewMode,lc=!Ac;eb=this.mUh(eb,ic,lc);var Gc=!0;!wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5315453_MoveWebpartsSessionsToPreviewer")&&this.$.pwa&&(Gc=!1);lc?Gc?Na.a(this.$)?ka.ULS.sendTraceTag(537154304,0,50,"PrintCommandHandler:DoPrintHtml - Print previewer is already opened."):(this.hD.JAj(eb,this.HN),ka.ULS.sendTraceTag(591196515,0,50,"PrintCommandHandler:DoPrintHtml Print previewer opened")):
((new J(this.$,xa.a.instance.ga(1205),3,eb,Fb,this.gia,ic,this.HN)).hf(),ka.ULS.sendTraceTag(595194760,0,50,"PrintCommandHandler:DoPrintHtml Print dialog shown in pdf mode in {0} ms.",pc.qc)):((new N(this.$,xa.a.instance.ga(1205),3,eb,Fb)).hf(),ka.ULS.sendTraceTag(591196514,0,15,"PrintCommandHandler:DoPrintHtml Print dialog shown in html mode in {0} ms. isNamedObjectViewMode: {1}.",pc.qc,Ac));pc.stop();this.Bhd();return!0};d.prototype.mUh=function(Fb,pc,eb){var ic={};ic.SessionId=this.ea.sessionId;
ic.UsedRangeTooBig=!1;var Ac=ta.g(Fb),lc=Ac.ha,Gc=lc.Qe;if(Qa.e(Fb.pa))ic.Type=0,ic.ObjectId=Fb.pa.name,ic.UseSelection=!1;else if(Qa.g(Fb.pa))ic.Type=1,ic.ObjectId=Fb.pa.hLa,ic.UseSelection=!0;else if(2===Gc||4===Gc||64===Gc)Ac=lc.Oa.Yb.floatingObject,ic.Type=1,ic.SheetName=pc,ic.ObjectId=Ac.id,ic.UseSelection=!0;else if(eb&&Gc&470)ic.ObjectId=lc.Oa.Yb.floatingObject.id,ic.SheetName=pc;else if(Qa.i(Fb.pa)){ic.Type=2;ic.SheetName=pc;if(lc.sa.tg)if(eb=lc.sa.Vc,ic.SelectedRanges=S.q(eb,Fb),20<eb.aM)ic.UseSelection=
!0;else{pc=0;Ac=Ac.pk("PrintCommandHandler.DoPrintHtml",eb);try{for(Ac.$$rst();Ac.$$mn()&&2>pc;)Ac.$$cu().text&&pc++;ic.UseSelection=2<=pc}finally{Ac&&Ac.dispose()}}else ic.UseSelection=!1,ic.SelectedRanges=S.q(lc.sa.activeRange,Fb);this.ea.isNamedObjectViewMode&&(ic.UsedRange=S.v(Fb.pa.usedRange,Fb))}ic.Title=Fb.workbookContext.WorkbookFileName;return ic};d.prototype.Bhd=function(){ta.g(this.$);if(!this.b1f){this.yQc=!0;var Fb=this.$.Fb.sc("UserAction","HandlePageLayoutRendering");this.cMj();ka.ULS.sendTraceTag(537154274,
0,50,"PrintCommandHandler:HandlePageLayoutRendering rendering is done in {0} ms.",Fb.qc);Fb.stop()}};d.prototype.cMj=function(){for(var Fb=ta.g(this.$).Ea,pc=Fb.QE(),eb=!1,ic=0,Ac=0;Ac<pc.length;Ac++){var lc=pc[Ac],Gc=lc.lf;Gc&&Gc.hasPageLayout()&&(eb=!0,Gc.setDirty("PrintCommandHandler::TriggerPageLayoutRendering, hash: "+lc.Kd,4),ic++)}eb&&(ka.ULS.sendTraceTag(537154273,0,50,"PrintCommandHandler:TriggerPageLayoutRendering number of total cached blocks is {0}, number of blocks that require re-rendering is {1}",
pc.length,ic),Fb.Fxd())};Af.Object.defineProperties(d.prototype,{b1f:{configurable:!0,enumerable:!0,get:function(){return this.yQc}}});Object(ea.a)(d,"PrintCommandHandler",null,[403,702]);var Mc=b(1283),Pc=b(1490),Kc=b(1491),ub=fa.a;Rk(c,ub);c.prototype.zd=function(){var Fb=this,pc=Y.AFrameworkApplication.fa.appSettings,eb=this.$.ya.DirectPrintSetting;pc.DirectPrintIsEnabled=eb.DirectPrintIsEnabled.toString();pc.DirectPrintProbeIsEnabled=eb.DirectPrintProbeIsEnabled.toString();pc.DirectPrintEnabledForInternetExplorer=
eb.DirectPrintEnabledForInternetExplorer.toString();pc.DirectPrintSupportedMimeTypes=eb.DirectPrintSupportedMimeTypes;pc.DirectPrintSupportedPlugins=eb.DirectPrintSupportedPlugins;pc.DirectPrintImmersivePreviewPlugins=eb.DirectPrintImmersivePreviewPlugins;pc.DirectPrintMinimalSupportedEdgeVersion=eb.DirectPrintMinimalSupportedEdgeVersion;pc.DirectPrintEnabledForEdge=eb.DirectPrintEnabledForEdge.toString();pc=new Mc.a(pc);var ic=null;eb=null;try{eb=window.navigator.mimeTypes}catch(Gc){ka.ULS.sendTraceTag(537154270,
0,15,"Failed to get Window.Navigator.mimeTypes")}var Ac=null;try{Ac=window.navigator.plugins}catch(Gc){ka.ULS.sendTraceTag(537154269,0,15,"Failed to get Window.Navigator.plugins")}ic=new Kc.a(pc,eb,Ac,Kc.a.Zbf,Kc.a.Dgf,new Pc.a(Y.AFrameworkApplication.ta.hX),Y.AFrameworkApplication.ta.tD,Kc.a.Egf,function(Gc,ed){return new qa.a(Gc,!1,ed)},!1);if(wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&this.$.Lf.get(116)){var lc=ha.GetServiceTaskFactory.Ra(this.$.da,349,350,
this.hb);ia.TaskExtensions.Ba(lc,function(){var Gc=new d(Fb.$,ic,lc.result);Fb.jd([Gc])},this.$.la)}else this.jd([new d(this.$,ic,null)])};c.ka=function(Fb){fa.a.Qd(73,new c(Fb))};Object(ea.a)(c,"PrintCommandHandlerFactory",fa.a,[]);b.d(D,"a",function(){return a})},1353:function(u,D,b){function a(){K.a.Fa(function(ub){ub.da.Ga(57,new c(ub));ub.da.Ga(60,new I(ub));ub.da.Ga(63,new U(ub))})}function c(ub){var Fb=Kc.call(this)||this;Fb.$=ub;ub.da.Ga(56,new e(ub));Fb.Eb();return Fb}function d(ub,Fb){return Pc.call(this,
ub,Fb)||this}function e(ub){var Fb=wb.call(this)||this;Fb.$=ub;Fb.Eb();e.T0g();return Fb}function k(ub,Fb,pc){var eb=l.call(this,!0)||this;eb.Qa=new Ia.a;eb.STe=!1;eb.q6c=!1;eb.Zye=null;eb.wm=null;eb.Z2b=null;eb.Uc=function(){qa.a.xg(S.a(eb.$).fd.activityState,ta.a.hyd)||eb.mua.reset()};eb.yJi=function(ic){eb.cRf(ic)};eb.xJi=function(){eb.tzj()};eb.$=ub;eb.ea=ub.ea;eb.RJ=Fb;eb.businessBar=pc;eb.ea.Wj(eb.Uc);eb.mua=F.Ore(eb.$);eb.U0g();ub.da.Ga(55,eb);eb.cga=va.a.instance.Tb("Common.ISystemInitiatedFeedback");
return eb}function l(ub){this.Kfa=this.B4d=this.JUa=null;this.lib=!1;this.CMc=this.Cbe=null;this.RQb=this.BD=this.gWb="";this.application=this.SB=0;this.GGj=this.TTd=!1;this.jUj=ub&&ra.AFrameworkApplication.fa.ra("OICLaunchDialogIsEnabled");ra.AFrameworkApplication.ub.a4(ya.a.qQa)||ra.AFrameworkApplication.ub.Mb(ya.a.qQa,sa.a.frame,Object(Ea.a)(this,this.whj,"retryOpenInClientAction"));this.$3f=!!ra.AFrameworkApplication.fa&&ra.AFrameworkApplication.fa.ra("SilentExternalHandler")}function m(){}function f(){}
function w(ub){var Fb=db.call(this)||this;Fb.cq=ub;Fb.ze="ProtocolLaunchingDialog";ra.AFrameworkApplication.Bi.K4a&&ra.AFrameworkApplication.Bi.Ctc();ra.AFrameworkApplication.ta.Pa.Qgd&&Fb.Ike(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(Ea.a)(Fb,Fb.Zmc,"onGiveFeedbackClick"));w.N5e?(Fb.Rb=12,Fb.mc(1,CommonUIStrings.l_CloseFile),Fb.mc(2,CommonUIStrings.l_OICDialogContinueHere),Fb.mc(3,CommonUIStrings.l_OICDialogLaunchAgain)):(Fb.Rb=4,Fb.mc(1,CommonUIStrings.l_OICDialogContinueHere),
Fb.mc(2,CommonUIStrings.l_OICDialogLaunchAgain));Fb.uCb(CommonUIStrings.l_OICDialog2ndTitle,5===Fb.cq.$Df?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(Ea.a)(Fb,Fb.cFd,"protocolLaunchingDialogResultHandler"),null);return Fb}function n(ub){var Fb=qb.call(this)||this;Fb.Rea=null;Fb.CUa=null;Fb.Epa=!1;Fb.ipa=null;Fb.cq=ub;Fb.Wf=z.Wf;Fb.sse=!0;Fb.Rb=5;Fb.ze="ProtocolLaunchingDialog";Fb.NGc="OICRetryDialog";ra.AFrameworkApplication.Bi.K4a&&ra.AFrameworkApplication.Bi.Ctc();
ra.AFrameworkApplication.Bi.Eg(new yb.a(2,1,5E3,function(){Fb.switchToBackupMode()},101));Fb.showDialog("",Object(Ea.a)(Fb,Fb.cFd,"protocolLaunchingDialogResultHandler"));Fb.qZf();Fb.YW("Issues");Fb.FTe();Q.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog";return Fb}function z(){}function r(ub){var Fb=Va.call(this)||this;Fb.vCa=null;Fb.DUa=null;Fb.Epa=!1;Fb.cq=ub;Fb.Wf=v.Wf;Fb.sse=!0;Fb.Rb=5;Fb.ze="OICLaunchDialog";Fb.showDialog("",
Object(Ea.a)(Fb,Fb.xFi,"oicLaunchDialogResultHandler"));Fb.qZf();Fb.YW("ProtocolLaunchingDialogTitle");4!==ra.AFrameworkApplication.ta.Pa.editMode&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);Fb.lI(Fb.vCa);Q.ULS.sendTraceTag(22140865,211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog";return Fb}function v(){}function A(ub,Fb,pc,eb,ic){var Ac=document.createElement("img");Ac.alt=
ub;Ac.className=Ma.getImageClassWithCluster(pc,eb);Ac.src=Fb;Ac.setAttribute(Db.a.Hd,Db.a.Is);ub=document.createElement("span");ub.className="ProtocolLaunchingDialogImg32Container";ub.appendChild(Ac);Ac=document.createElement("span");Ac.className="ProtocolLaunchingDialogIconContainer";Ac.appendChild(ub);ic.appendChild(Ac)}function B(ub,Fb,pc,eb,ic,Ac,lc){var Gc=document.createElement("a");Gc.className="ProtocolLaunchingDialogButtonAnchor";Gc.className+=" OICDialog";Gc.id=ub;Gc.setAttribute(Db.a.Hd,
Db.a.Hs);Gc.style.padding="0";Gc.style.margin="0";eb&&A(ic,Fb,pc,eb,Gc);ub=document.createElement("span");ub.className="ProtocolLaunchingDialogButtonLabel";ub.innerText=ic;Gc.appendChild(ub);Gc.tabIndex=0;Ac&&Hb.a.instance.qa(Kb.a.click,Gc,Ac);lc&&gb.KeyInputManager.instance.qa(Kb.a.Gd,Gc,lc);return Gc}function y(ub){return ub.Ca.keyCode===Ub.a.Rh||ub.Ca.keyCode===Ub.a.Eoa?(ub.zb.click(),!0):!1}function x(ub){for(var Fb=0;Fb<ub.children.length;Fb++){var pc=ub.children[Fb];pc.style.position="relative";
pc.style.top=(pc.parentNode.offsetHeight-pc.offsetHeight)/2+"px"}}function C(){}function G(ub,Fb,pc){var eb=this;this.La=ub;this.Wqg=Fb;this.JEc=null;(this.mXb=ra.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&va.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(ic){eb.JEc=ic});this.C1=pc}function E(ub,Fb,pc){this.La=ub;this.Sqg=Fb;this.C1=pc}function I(ub){var Fb=
la.call(this)||this;Fb.$=ub;Fb.Eb();return Fb}function U(ub){var Fb=Ka.call(this)||this;Fb.$=ub;Fb.Eb();return Fb}function M(ub,Fb,pc){pc=void 0===pc?!1:pc;var eb=Na.call(this,ub,Fb)||this;eb.VBb=null;eb.yAd=function(ic){eb.unsubscribe(function(Ac){ic.remove_disposing(Ac)});eb.lh(wa.a.Ek);eb.ep()};eb.mkc=pc;return eb}function T(ub,Fb){var pc=this;this.Uc=function(){qa.a.xg(S.a(pc.$).fd.activityState,ta.a.hyd)||pc.mua.reset()};this.$=Fb;this.mkc=ub;this.ea=Fb.ea;this.ea.Wj(this.Uc);this.mua=F.Ore(this.$)}
function F(ub,Fb){var pc=xa.call(this,ub)||this;pc.fUj=["id","sessionId","workbookType","workbookFileType","dataloss"];pc.command=0;pc.eEb=function(){var eb=pc.CNh();if(eb){pc.$.$H(!0);if(-2028960985!==pc.command&&1461300262!==pc.command){var ic=S.a(pc.$).fd.activityState;ic[Qa.a.aYa]=wa.a.download;ic[da.a.sTc]=pc.command}ia.a(pc.$).qr(eb.Errors)}};pc.iframe=ub;pc.$=Fb;pc.yc.ka("load",pc.eEb);return pc}var K=b(11),J=b(0),O=b(232),N=b(51),H=b(37),Q=b(15),ca=b(90),X=b(85),Z=b(251),ea=b(718),ka=b(216),
Y=b(121),qa=b(34),fa=b(39),ha=b(244),ia=b(42),wa=b(6),Qa=b(35),S=b(67),da=b(651),xa=ha.a;Rk(F,xa);F.prototype.downloadFile=function(ub,Fb){var pc={};(ub=this.Rxh(ub,pc))&&fa.a.Tpc("dlfr",ub,pc);this.command=Fb};F.prototype.Rxh=function(ub,Fb){var pc=ub.split("?");if(2!==pc.length)return ub=null,Q.ULS.sendTraceTag(537154816,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (missing '?')"),ub;pc=pc[1].split("&");pc=ak(pc);for(var eb=pc.next();!eb.done;eb=pc.next()){var ic=eb.value.split("=",
2);if(2!==ic.length){ub=null;Q.ULS.sendTraceTag(537154787,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (key value pair has no '=' sign)");break}eb=ic[0];Array.contains(this.fUj,eb)&&(ic=decodeURIComponent(ic[1]),Fb[eb]=ic,ub=ka.a.GHb(ub,eb))}return ub};F.prototype.reset=function(){this.iframe&&(this.iframe.src="about:blank");this.command=1461300262};F.prototype.CNh=function(){try{return this.iframe.contentWindow.ewaResult}catch(Fb){if(!this.$.ea.ic.isDivSyndicated){var ub=
window.document.referrer.match(RegExp("://(.[^/]+)/"));Q.ULS.sendTraceTag(537154785,0,50,"FileLoader.OnFrameLoad: parent domain: {0}, current domain: {1}, iframe domain: {2}. ewaControl IsCrossDomain: {3}",1<ub.length?ub[1]:"",escape(window.location.host),escape(this.iframe.contentWindow.location.host),this.$.pwa);throw Fb;}return null}};F.Ore=function(ub){var Fb=document.createElement("iframe");Fb.id="ewaFileLoader";Fb.style.cssText="height:0;width:0;display:none";Fb.src="about:blank";Fb.setAttribute("name",
"dlfr");Fb=ub.domElement.appendChild(Fb);return new F(Fb,ub)};Af.Object.defineProperties(F.prototype,{G7h:{configurable:!0,enumerable:!0,get:function(){return"loading"!=this.iframe.contentDocument.readyState&&"uninitialized"!=this.iframe.contentDocument.readyState}}});Object(J.a)(F,"FileLoader",ha.a,[]);var ta=b(147),ab=b(58);T.prototype.zhh=function(){var ub=this,Fb=this.VRg(this.$),pc=this.$.userOperationManager.operationCount;0<pc&&Q.ULS.sendTraceTag(537154822,0,15,"flushing queue in downloadcopy. Queue is {0}",
pc);this.$.userOperationManager.V3("DownloadACopyOperation.DownloadForkedFile");this.mkc&&Q.ULS.sendTraceTag(537154821,0,50,"DownloadACopyOperation - Dataloss scenario");this.mua.downloadFile(Fb,-21742208);H.TaskExtensions.Ba(ab.Task.delay(1),function(){ub.y8e()},this.mua.la,3)};T.prototype.dispose=function(){this.ea&&this.ea.xk(this.Uc);this.$=this.ea=null};T.prototype.y8e=function(ub){var Fb=this;(ub=void 0===ub?null:ub)||(ub=this.$.Fb.sc("LoadResource","DownloadACopyOperation"));!this.mua.G7h&&
ub.qc<T.Bof?window.setTimeout(function(){Fb.y8e(ub)},T.Ahh):(ub.qc>=T.Bof&&Q.ULS.sendTraceTag(537154820,0,15,"Download did not complete after 10 seconds."),S.a(this.$).fd.hM())};T.prototype.VRg=function(ub){var Fb=new Sys.StringBuilder,pc=ub.workbookContext,eb=ub.ya;Fb.append(ub.Dda);Fb.append(eb.FileHandlerRelativeUri);Fb.append("?id=");Fb.append(encodeURIComponent(ka.a.GHb(pc.WorkbookUri,"sc")));ub.ea.dc&&(Fb.append("&sessionId="),Fb.append(encodeURIComponent(ub.ea.sessionId)));Fb.append("&workbookType=FullForkedWorkbook");
Fb.append("&dataloss=");Fb.append(this.mkc?"true":"false");Y.a.VYa(Fb,eb);return Fb.toString()};T.Bof=1E5;T.Ahh=100;Object(J.a)(T,"DownloadACopyOperation",null,[10]);var Na=Z.a;Rk(M,Na);M.prototype.execute=function(ub){var Fb=Object(X.a)(6,ub.ve);if(!Fb.nka)return Q.ULS.sendTraceTag(537154818,0,50,"DownloadAForkedCopyActivity.Execute: blocking Download action as the workbook is protected"),this.Gld(ub),this.lh(wa.a.idle),1;this.VBb||(this.VBb=new T(this.mkc,Fb));this.VBb.zhh();Q.ULS.shipAssertTag(537154817,
0,3!==S.a(Fb).ji.Tt,"The current activity should not be closed.");return 1};M.prototype.Gld=function(ub){var Fb=Object(X.a)(6,ub.ve),pc=new ea.a(Fb);this.subscribe(ub,this.yAd,function(eb){pc.add_disposing(eb)});Q.ULS.sendTraceTag(50954707,0,50,"DownloadAForkedCopyActivity.ProtectedFileDataLeakErrorDialog: showing alert dialog to user");pc.initialize();pc.hf()};M.prototype.dispose=function(){ca.a.Ia(this.VBb);this.VBb=null;Na.prototype.dispose.call(this)};Object(J.a)(M,"DownloadAForkedCopyActivity",
Z.a,[]);var Ka=O.a;Rk(U,Ka);U.prototype.create=function(){var ub=this;H.TaskExtensions.Ba(N.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb),function(){ub.pb(new M(wa.a.r1a,wa.a.Ek,!0))},this.la)};Object(J.a)(U,"DownloadACopyPreDatalossActivityFactory",O.a,[]);var la=O.a;Rk(I,la);I.prototype.create=function(){var ub=this;H.TaskExtensions.Ba(N.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb),function(){ub.pb(new M(wa.a.unmergeableDownloadCopy,wa.a.qoa))},this.la)};Object(J.a)(I,
"DownloadAForkedCopyActivityFactory",O.a,[]);var Ea=b(83),ra=b(4),na=b(81),ba=b(25),sa=b(107),ya=b(27);E.prototype.Cg=function(){this.La.Mb(ya.a.tryMacOffice,sa.a.frame,Object(Ea.a)(this,this.tTi,"onTryMacOffice"));this.La.Mb(ya.a.U$f,sa.a.frame,Object(Ea.a)(this,this.jDf,"onTryMacOfficeFromViewer"));this.La.Mb(ya.a.T$f,sa.a.frame,Object(Ea.a)(this,this.jDf,"onTryMacOfficeFromViewer"))};E.prototype.tTi=function(ub,Fb,pc,eb,ic){if(1===pc)return 32;ic?(ub=ic.SourceControlId,"btnjTryMacOfficeForWordEditor"===
ub?fa.a.Ze(na.a.sZ(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===ub&&fa.a.Ze(na.a.sZ(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.vjf();return 32};E.prototype.jDf=function(ub,Fb,pc){if(1===pc)return 32;switch(ub){case ya.a.U$f:fa.a.Ze(na.a.sZ(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case ya.a.T$f:fa.a.Ze(na.a.sZ(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32};E.prototype.vjf=function(){var ub=
void 0===ub?null:ub;var Fb=0;ub&&(Fb=ub);fa.a.Ze(2===Fb?"https://go.microsoft.com/fwlink/?LinkId=331579":E.zxi,"_blank",void 0,"LaunchMacTrialWindow")};Af.Object.defineProperties(E.prototype,{Twc:{configurable:!0,enumerable:!0,get:function(){return this.Sqg&&ba.a.isMac&&!ba.a.xki&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}},Uwj:{configurable:!0,enumerable:!0,get:function(){return this.Twc}}});Af.Object.defineProperties(E,{zxi:{configurable:!0,enumerable:!0,get:function(){return na.a.fH("522401")}}});
Object(J.a)(E,"MacOfficeOffer",null,[225]);var va=b(84);G.prototype.Cg=function(){this.La.Mb(ya.a.tryOffice,sa.a.frame,Object(Ea.a)(this,this.uTi,"onTryOffice"));this.La.Mb(ya.a.tryOfficeThroughTellMe,sa.a.frame,Object(Ea.a)(this,this.tryOfficeThroughTellMe,"tryOfficeThroughTellMe"));this.La.Mb(ya.a.X$f,sa.a.frame,Object(Ea.a)(this,this.Y$f,"tryOfficeThroughViewer"));this.La.Mb(ya.a.W$f,sa.a.frame,Object(Ea.a)(this,this.Y$f,"tryOfficeThroughViewer"))};G.prototype.uTi=function(ub,Fb,pc,eb,ic){if(this.mXb&&
1===pc)return this.isFreemiumUpsellEnabled&&this.eLb?32:8;2===pc&&(ic?(ub=ic.SourceControlId,"btnjTryOfficeForWordEditor"===ub?fa.a.Ze(na.a.sZ(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===ub?fa.a.Ze(na.a.sZ(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.ojc()):this.ojc());return 32};G.prototype.tryOfficeThroughTellMe=function(ub,Fb,pc,eb,ic){if(this.mXb&&1===pc)return this.isFreemiumUpsellEnabled&&this.eLb?32:8;2===pc&&(ic?(ub=ic.SourceControlId,
fa.a.Ze(na.a.fH("862405")+this.sTh(ub),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):fa.a.Ze(na.a.fH("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32};G.prototype.Y$f=function(ub,Fb,pc){if(this.mXb&&1===pc)return this.isFreemiumUpsellEnabled&&this.eLb?32:8;if(2===pc)switch(ub){case ya.a.X$f:fa.a.Ze(na.a.sZ(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case ya.a.W$f:fa.a.Ze(na.a.sZ(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32};G.prototype.ojc=
function(ub){ub=void 0===ub?null:ub;var Fb=0;ub&&(Fb=ub);fa.a.Ze(G.dRh(Fb),"_blank",void 0,"LaunchOfficeOffer")};G.prototype.sTh=function(ub){var Fb=0;switch(ub){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":Fb=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":Fb=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":Fb=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":Fb=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":Fb=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":Fb=
6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":Fb=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":Fb=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":Fb=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":Fb=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":Fb=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":Fb=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":Fb=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":Fb=19;
break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":Fb=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":Fb=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":Fb=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":Fb=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":Fb=29}return 0===Fb?"":String.format("&pc={0:D}",Fb)};G.dRh=function(ub){if(ba.a.sh)switch(ub){case 1:return na.a.fH("393806");case 2:return na.a.fH("393810");case 3:return na.a.fH("393809");
case 5:return na.a.fH("393805")}else if(ba.a.Wo)switch(ub){case 1:return na.a.fH("521979");case 3:return na.a.fH("521980");case 5:return na.a.fH("521978");case 2:return na.a.fH("522490")}else{if(2===ub)return na.a.fH("517778");if(1===ub)return na.a.sZ(30)}return na.a.fH("522402")};Af.Object.defineProperties(G.prototype,{msf:{configurable:!0,enumerable:!0,get:function(){return this.eLb}},dFi:{configurable:!0,enumerable:!0,get:function(){return this.eLb&&MSOJS.ClientUtils.OfferOfficeInDialog()}},eLb:{configurable:!0,
enumerable:!0,get:function(){return this.Wqg&&!ba.a.isMac}},isFreemiumUpsellEnabled:{configurable:!0,enumerable:!0,get:function(){var ub=!1;this.JEc&&(ub=this.JEc.isFreemiumUpsellEnabled());return ub}}});Object(J.a)(G,"OfficeTrialExperience",null,[224]);C.prototype.Sh=function(ub){ub.register(G,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").tc().Cc(function(){return new G(ra.AFrameworkApplication.ub,ra.AFrameworkApplication.nzb,ra.AFrameworkApplication.lcid)});
ub.register(E,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").tc().Cc(function(){return new E(ra.AFrameworkApplication.ub,ra.AFrameworkApplication.Egc,ra.AFrameworkApplication.lcid)})};Object(J.a)(C,"OpenInClientConfiguration",null,[4]);var W=b(615),La=b(1560),Ia=b(38),mb=b(1400),fb=b(150),Ma=b(158),Hb=b(233),Kb=b(13),Ub=b(86),gb=b(109),Db=b(89);Af.Object.defineProperties(v,{Wf:{configurable:!0,enumerable:!0,get:function(){return fb.a.Po(v.rk,CommonUIStrings.l_OICLaunchDialogTitle)}}});
v.rk="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(J.a)(v,"OICLaunchDialogHtml",null,[]);var Va=fb.a;Rk(r,Va);r.prototype.r9a=function(){this.vCa=B("BtnRichClient",this.cq.esb,this.cq.txb,this.cq.ckd,CommonUIStrings.l_OICLaunchRichClient,Object(Ea.a)(this,this.cBf,"onRichClientButtonClick"),y);document.getElementById("OICLaunchRichClient").appendChild(this.vCa);x(this.vCa);this.DUa=B("BtnReturn",this.cq.esb,this.cq.txb,this.cq.M8e,CommonUIStrings.l_OICReturnToOnlineClient,Object(Ea.a)(this,this.$Af,"onReturnButtonClick"),y);document.getElementById("OICReturnToApp").appendChild(this.DUa);
x(this.DUa)};r.prototype.$Af=function(){this.hide();this.cq.Dbb();return!0};r.prototype.cBf=function(){Q.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();ra.AFrameworkApplication.ub.processAction(ya.a.qQa,2);return!0};r.prototype.xFi=function(){this.cq.Dbb()};r.prototype.dispose=function(){this.Epa||(this.vCa&&(Hb.a.instance.Aa(Kb.a.click,this.vCa,Object(Ea.a)(this,this.cBf,"onRichClientButtonClick")),gb.KeyInputManager.instance.Aa(Kb.a.Gd,this.vCa,y)),this.DUa&&(Hb.a.instance.Aa(Kb.a.click,
this.DUa,Object(Ea.a)(this,this.$Af,"onReturnButtonClick")),gb.KeyInputManager.instance.Aa(Kb.a.Gd,this.DUa,y)),Va.prototype.dispose.call(this),this.Epa=!0)};Object(J.a)(r,"OICLaunchDialog",fb.a,[]);Af.Object.defineProperties(z,{Wf:{configurable:!0,enumerable:!0,get:function(){return fb.a.Po(z.rk,CommonUIStrings.l_OICDialogTitle)}}});z.rk="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(J.a)(z,"ProtocolLaunchingDialogV2Html",null,[]);b(442);var yb=b(108),qb=fb.a;Rk(n,qb);n.prototype.r9a=function(){var ub=document.getElementById("Issues");if(ub){A("",this.cq.esb,this.cq.txb,this.cq.ckd,ub);var Fb=document.createElement("span");Fb.className="WACDialogSectionTitle";Fb.innerText=5===this.cq.$Df?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;ub.appendChild(Fb);x(ub);ub.style.display="none"}ra.AFrameworkApplication.ta.Pa.Qgd?(this.CUa=B("GiveFeedback",
this.cq.esb,this.cq.txb,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(Ea.a)(this,this.Zmc,"onGiveFeedbackClick"),Object(Ea.a)(this,this.ixf,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.CUa),x(this.CUa)):document.getElementById("ButtonGiveFeedback").style.display="none";0===ra.AFrameworkApplication.ta.Pa.editMode||ra.AFrameworkApplication.kfh?document.getElementById("ButtonEdit").style.display="none":(this.Rea=B("Edit",this.cq.esb,
this.cq.txb,"",2===ra.AFrameworkApplication.ta.Pa.Fj?4===ra.AFrameworkApplication.ta.Pa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===ra.AFrameworkApplication.ta.Pa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(Ea.a)(this,this.Rvf,"onEditClick"),Object(Ea.a)(this,this.Vvf,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.Rea),x(this.Rea));0===ra.AFrameworkApplication.ta.Pa.editMode&&
!ra.AFrameworkApplication.nzb&&ub&&(ub.style.display="none")};n.prototype.HTe=function(){return this.ipa?(this.lI(this.ipa),!0):!1};n.prototype.FTe=function(){return this.Rea?(this.lI(this.Rea),!0):!1};n.prototype.Vvf=function(ub){return this.Gyd(ub,0)};n.prototype.ixf=function(ub){return this.Gyd(ub,2)};n.prototype.YAf=function(ub){return this.Gyd(ub,1)};n.prototype.Gyd=function(ub,Fb){var pc=!1;if(ub.Ca.keyCode===Ub.a.Rh||ub.Ca.keyCode===Ub.a.Eoa)ub.zb.click(),pc=!0;else if(ub.Ca.keyCode===Sys.UI.Key.down||
ub.Ca.keyCode===Sys.UI.Key.up)switch(Fb){case 1:pc=this.FTe();break;case 0:pc=this.HTe()}return pc};n.prototype.Rvf=function(){this.hide();4===ra.AFrameworkApplication.ta.Pa.editMode?(Q.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.cq.Dbb()):(Q.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.cq.nhd());return!0};n.prototype.Zmc=function(){Q.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");this.cq.N4e();return!0};n.prototype.Ync=function(){Q.ULS.sendTraceTag(19239263,
211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";ra.AFrameworkApplication.ub.processAction(ya.a.qQa,2);return!0};n.prototype.cFd=function(){this.cq.Dbb()};n.prototype.switchToBackupMode=function(){var ub=document.getElementById("ProtocolLaunchingDialogTitle");if(ub){ub.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(ub=document.getElementById("Issues"))ub.style.display="block";(ub=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!ub.children.length&&
(this.ipa=B("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(Ea.a)(this,this.Ync,"onRetryOICClick"),Object(Ea.a)(this,this.YAf,"onRetryOICKeyUp")),ub.appendChild(this.ipa),x(this.ipa),this.Rea||this.HTe())}};n.prototype.dispose=function(){this.Epa||(this.Rea&&(Hb.a.instance.Aa(Kb.a.click,this.Rea,Object(Ea.a)(this,this.Rvf,"onEditClick")),gb.KeyInputManager.instance.Aa(Kb.a.Gd,this.Rea,Object(Ea.a)(this,this.Vvf,"onEditKeyUp"))),this.CUa&&(Hb.a.instance.Aa(Kb.a.click,this.CUa,Object(Ea.a)(this,
this.Zmc,"onGiveFeedbackClick")),gb.KeyInputManager.instance.Aa(Kb.a.Gd,this.CUa,Object(Ea.a)(this,this.ixf,"onGiveFeedbackKeyUp"))),this.ipa&&(Hb.a.instance.Aa(Kb.a.click,this.ipa,Object(Ea.a)(this,this.Ync,"onRetryOICClick")),gb.KeyInputManager.instance.Aa(Kb.a.Gd,this.ipa,Object(Ea.a)(this,this.YAf,"onRetryOICKeyUp"))),qb.prototype.dispose.call(this),this.Epa=!0)};Object(J.a)(n,"ProtocolLaunchingDialog",fb.a,[]);var dc=b(135),bb=b(459),db=dc.StandardDialog;Rk(w,db);w.prototype.Zmc=function(ub){Q.ULS.sendTraceTag(595342858,
211,50,"Open give feedback dialog");this.kwf(ub)};w.prototype.Ync=function(){Q.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");ra.AFrameworkApplication.ub.processAction(ya.a.qQa,2)};w.prototype.cFd=function(ub){w.N5e?3===ub?this.eTf():2===ub||0===ub?this.continueEditing():1===ub&&this.fZg():2===ub?this.eTf():(1===ub||0===ub)&&this.continueEditing()};w.prototype.fZg=function(){Q.ULS.sendTraceTag(577783557,211,50,"Closing the document");ra.AFrameworkApplication.ub.ae(ya.a.close,2,bb.a)};w.prototype.eTf=
function(){Q.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(Ea.a)(this,this.Ync,"onRetryOICClick"),0)};w.prototype.continueEditing=function(){4===ra.AFrameworkApplication.ta.Pa.editMode||ra.AFrameworkApplication.fa.ra("WordConsumptionViewToEditRedirectIsEnabled")&&1===ra.AFrameworkApplication.ta.mode?(Q.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.cq.Dbb()):(Q.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.cq.nhd())};
Af.Object.defineProperties(w,{N5e:{configurable:!0,enumerable:!0,get:function(){return ra.AFrameworkApplication.fa.ra("OICDialogThreeActions")&&32===ra.AFrameworkApplication.ub.processAction(ya.a.close,1)}}});Object(J.a)(w,"StandardProtocolLaunchingDialog",dc.StandardDialog,[]);var wc=b(1444);Object(J.a)(f,"EditDocumentInClientParams",null,[]);m.S6c=function(ub,Fb,pc,eb,ic,Ac,lc,Gc,ed,fd,Bc,ld,Bd,xb,Fd,Vd){lc=void 0===lc?!1:lc;Gc=void 0===Gc?!1:Gc;ed=void 0===ed?"":ed;fd=void 0===fd?!1:fd;Bc=void 0===
Bc?!1:Bc;ld=void 0===ld?!1:ld;Bd=void 0===Bd?"":Bd;xb=void 0===xb?"":xb;Fd=void 0===Fd?"":Fd;Vd=void 0===Vd?!1:Vd;var se=new f;se.DocumentUrl=ub;se.Mode=Fb;se.Options=pc;se.Application=eb;se.SilentExternalHandler=lc;se.EncodeUrl=Gc;se.CorrelationIdForWinClient=ed;se.NavigateUsingWindowOpen=fd;se.DescriptiveUnattemptedEnums=Bc;se.NoBrowserModalDialogs=ld;se.SessionOrigin=Bd;se.CorrelationId=xb;se.ClickTime=Fd;se.NewTelemetryDataIsEnabled=Vd;MSOJS.ClientUtils.EditDocumentInClient(se,ic,Ac)};Object(J.a)(m,
"ClientUtils",null,[]);var nb=b(99),zb=b(187),ma=b(521),P=b(178),oa=b(1030),Ja=b(392),$a=b(170),Ta=b(80),pa=b(190);l.prototype.hwc=function(ub,Fb,pc){Fb=void 0===Fb?"":Fb;this.BD=(void 0===pc?"":pc)||P.a.create().toString();this.gWb=Fb||ma.a.z_e();this.RQb=ub};l.prototype.whj=function(ub,Fb,pc){return Fb.contextId!==sa.a.frame?2:1===pc?32:this.qQa()};l.prototype.DGj=function(){return!(2===this.application&&ra.AFrameworkApplication.fa.ra("IsEmbeddedScenario"))};l.prototype.closeApplication=function(){this.TTd||
this.Lwh()};l.prototype.Dbb=function(){this.GGj||this.axh()};l.prototype.TLf=function(ub){this.jUj&&ba.a.sh?new r(this):this.Y2b(ub)};l.prototype.Y2b=function(ub){ub=this.Kqi(ub);var Fb=ub.returnValue;Q.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===Fb,ub.nBa);return Fb};l.prototype.lGa=function(ub,Fb,pc,eb,ic,Ac){this.JUa=ub;this.B4d=Fb;this.Kfa=Ac;this.application=pc;this.SB=eb;ra.AFrameworkApplication.downloadCopyOnOpenInClient?this.sjf():ra.AFrameworkApplication.limitedEdit&&
!ra.AFrameworkApplication.hostAuthenticatesUsersDuringOpenInClient?ra.AFrameworkApplication.w3f():this.BNg(ic)};l.prototype.qQa=function(){this.wFi&&this.Jti();return this.Y2b(this.lib)};l.prototype.SWf=function(){var ub=new oa.a($a.a.openInClient);ub.Values["ui-language"]=ra.AFrameworkApplication.lcid.toString();ub.Values[wc.a.h4c]=ra.AFrameworkApplication.userSessionId;return this.Kfa.value.send(ub)?32:8};l.prototype.Jti=function(){nb.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",
["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new pa.a,{inStaging:!0}))};l.prototype.Zmj=function(ub){var Fb=new oa.a($a.a.uWj);Fb.Values["ui-language"]=ra.AFrameworkApplication.lcid.toString();Fb.Values[wc.a.h4c]=ra.AFrameworkApplication.userSessionId;Fb.Values[Ja.a.tWj]=ub;this.Kfa.value.send(Fb)};l.prototype.Kqi=function(ub){this.lib=ub;this.Zmj(5===this.SB?l.PUi:l.RUi);return 5===this.SB?this.Jqi():this.Oqi()};l.prototype.Jqi=function(){this.yjf();return{returnValue:32,nBa:"HostEditUrl,"}};
l.prototype.Oqi=function(){var ub,Fb=ub="";ra.AFrameworkApplication.zle&&(Fb="|f|"+ra.AFrameworkApplication.userSessionId);var pc=ra.AFrameworkApplication.fa.ra("IsAssignmentMode")&&ra.AFrameworkApplication.fa.ra("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||ra.AFrameworkApplication.isUnifiedHostMode||ba.a.Zwa,eb=ra.AFrameworkApplication.fa.ra("UnattemptedEnumIsEnabled"),ic=ra.AFrameworkApplication.fa.ra("NoBrowserModalDialogs");if(ra.AFrameworkApplication.ub.Flc){var Ac=ra.AFrameworkApplication.ub.zZ(3588168074);
Ac&&this.hwc(Ac.epochClickTime,Ac.sessionOrigin,Ac.correlationId);this.Dlf()}if(ra.AFrameworkApplication.bHf){ub+="NewOrder,";Ac=8;this.Kfa&&this.Kfa.value&&this.Kfa.value.isEnabled()&&ra.AFrameworkApplication.CYd&&(ub+="Post,",Ac=this.SWf());if(32===Ac)return{returnValue:Ac,nBa:ub};Q.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return ra.AFrameworkApplication.am.W9a?(Q.ULS.shipAssertTag(5566816,211,!!ra.AFrameworkApplication.am.W9a),ub+="HostUrl,",
{returnValue:ra.AFrameworkApplication.ta.F8a(ra.AFrameworkApplication.am.W9a),nBa:ub}):this.JUa?(Q.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",ra.AFrameworkApplication.userSessionId),ub+="DocUrl,",m.S6c(this.JUa,this.SB,this.options,this.application,Object(Ea.a)(this,this.Uvf,"onEditInClientSuccess"),Object(Ea.a)(this,this.Tvf,"onEditInClientFailure"),this.$3f,ra.AFrameworkApplication.fa.ra("OICEncodeUrlIsEnabled"),Fb,pc,eb,ic,this.gWb,this.BD,this.RQb,ra.AFrameworkApplication.ub.Flc),
{returnValue:32,nBa:ub}):{returnValue:8,nBa:ub}}ub+="OldOrder,";if(!this.JUa&&ra.AFrameworkApplication.am.W9a)return this.Kfa&&this.Kfa.value&&this.Kfa.value.isEnabled()&&ra.AFrameworkApplication.CYd?(ub+="Post,",Fb=this.SWf()):(Q.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),Fb=8),32!==Fb?(Q.ULS.shipAssertTag(22595484,211,!!ra.AFrameworkApplication.am.W9a),ub+="HostUrl,",{returnValue:ra.AFrameworkApplication.ta.F8a(ra.AFrameworkApplication.am.W9a),
nBa:ub}):{returnValue:Fb,nBa:ub};Q.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",ra.AFrameworkApplication.userSessionId);ub+="DocUrl,";m.S6c(this.JUa,this.SB,this.options,this.application,Object(Ea.a)(this,this.Uvf,"onEditInClientSuccess"),Object(Ea.a)(this,this.Tvf,"onEditInClientFailure"),this.$3f,ra.AFrameworkApplication.fa.ra("OICEncodeUrlIsEnabled"),Fb,pc,eb,ic,this.gWb,this.BD,this.RQb,ra.AFrameworkApplication.ub.Flc);return{returnValue:32,nBa:ub}};l.prototype.cRf=
function(ub){ra.AFrameworkApplication.Jm.setDw(8981,ub)};l.prototype.Uvf=function(ub){this.cRf(ub);Q.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===ub&&MSOJS.ClientUtils.ShouldShowDialog()?(this.g7f||this.yjf(),this.Dlf()):this.TTd||this.closeApplication()};l.prototype.Tvf=function(ub,Fb){Fb=void 0===Fb?0:Fb;Q.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",ub,Fb);if(5===ub)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);
else{var pc=!!this.B4d&&!this.lib,eb=0;1===ub&&(eb=2);6<=ub&&13>=ub&&(eb=1,1===Fb&&(this.TTd=!0));this.Ezc.dFi?(Q.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",eb),mb.a.instance.Z7g(this.lib?Object(Ea.a)(this,this.Hsf,"oicErrorDialogHandlerCloseForced"):Object(Ea.a)(this,this.Isf,"oicErrorDialogHandlerNoCloseForced"),pc?Object(Ea.a)(this,this.oyf,"onLaunchDownload"):null,this.gHe(!1)?Object(Ea.a)(this,this.k7h,"iHaveOfficeButtonHandler"):null,eb,Fb)):(Q.ULS.sendTraceTag(18715409,
211,50,"Open OICErrorDialog. Dialog cause: {0}",eb),mb.a.instance.X7g(this.lib?Object(Ea.a)(this,this.Hsf,"oicErrorDialogHandlerCloseForced"):Object(Ea.a)(this,this.Isf,"oicErrorDialogHandlerNoCloseForced"),pc?Object(Ea.a)(this,this.oyf,"onLaunchDownload"):null,eb))}};l.prototype.Dlf=function(){try{var ub=[Object.assign(new Ta.a,{name:"CorrelationId",string:this.BD}),Object.assign(new Ta.a,{name:"SessionOrigin",string:this.gWb}),Object.assign(new Ta.a,{name:"ClickTime",string:this.RQb}),Object.assign(new Ta.a,
{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];zb.a("OpenInClientCompleted",!0,0,ub)}catch(Fb){Q.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+Fb.toString())}};l.prototype.yjf=function(){ra.AFrameworkApplication.ta&&ra.AFrameworkApplication.ta.Pa.Wu&&ra.AFrameworkApplication.fa.ra("StandardProtocolDialogIsEnabled")?new w(this):new n(this)};l.prototype.Hsf=function(){this.closeApplication()};l.prototype.Isf=function(){this.Dbb()};l.prototype.oyf=function(){this.sjf()};
l.prototype.k7h=function(){return this.gHe(!0)};l.prototype.gHe=function(ub){var Fb=(ba.a.YZ||ba.a.BH)&&!!ra.AFrameworkApplication.l6b;Fb&&ub&&(fa.a.Ze(ra.AFrameworkApplication.l6b,"_blank",void 0,"OpenInClient"),this.closeApplication());return Fb};Af.Object.defineProperties(l.prototype,{$Df:{configurable:!0,enumerable:!0,get:function(){return this.SB}},options:{configurable:!0,enumerable:!0,get:function(){var ub=0;ra.AFrameworkApplication.ufj&&(ub|=1);ra.AFrameworkApplication.openInClientEditOnly&&
(ub|=4);this.DGj()&&(ub|=64);return ub}},esb:{configurable:!0,enumerable:!0,get:function(){return ra.AFrameworkApplication.JC}},txb:{configurable:!0,enumerable:!0,get:function(){return ra.AFrameworkApplication.oxb}},M8e:{configurable:!0,enumerable:!0,get:function(){return""}},ckd:{configurable:!0,enumerable:!0,get:function(){return""}},g7f:{configurable:!0,enumerable:!0,get:function(){return ra.AFrameworkApplication.fa.ra("OneNoteMobileViewerIsEnabled")}},Ezc:{configurable:!0,enumerable:!0,get:function(){return this.Cbe||
(this.Cbe=va.a.instance.resolve("Common.IOfficeTrialExperience"))}},wFi:{configurable:!0,enumerable:!0,get:function(){return!!ra.AFrameworkApplication.fa&&ra.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}}});l.RUi="OpenInDesktop";l.PUi="OpenInBrowser";Object(J.a)(l,"AOpenInClientOperation",null,[]);var Da=b(5),rb=b(210),Ab=b(76),ob=b(59),sb=b(337),Pb=b(47),Aa=b(44),Ya=b(197),kb=b(92),lb=b(29),ac=b(1),Dc=b(10),Zb=b(21),mc=b(525),Lb=b(260),
Sa=b(263),Cb=b(156),ec=b(650);Rk(k,l);k.prototype.m0g=function(){this.TLf(this.STe)};k.prototype.m2g=function(){var ub=this,Fb=this.$;H.TaskExtensions.Ba(this.RJ.value,function(pc){ub.lGa(Fb.workbookContext.ClientUrl,ra.AFrameworkApplication.w3,1,Fb.isEditMode?2:0,!0,new W.a(function(){return pc.result}))},this.la,3)};k.prototype.nhd=function(){0!==ob.a.rg.editMode&&(this.$.ob.sz=!1)};k.prototype.N4e=function(){var ub={};ub[Da.a.b9b]=!1;ub[Da.a.SU]="OpenInExcel";this.$.Fd(802602464,Ab.a.Cb,8,ub)};
k.prototype.U1c=function(){var ub=this;if(this.ea.dc){var Fb=this.$;Fb.isEditMode&&H.TaskExtensions.Ba(this.RJ.value,function(pc){ub.lGa(Fb.workbookContext.ClientUrl,ra.AFrameworkApplication.w3,1,2,!1,new W.a(function(){return pc.result}))},this.la,3)}};k.prototype.cBe=function(){var ub=this;this.ea.dc&&H.TaskExtensions.Ba(this.RJ.value,function(Fb){ub.lGa(ub.$.workbookContext.ClientUrl,ra.AFrameworkApplication.w3,1,ub.$.isEditMode?2:0,!1,new W.a(function(){return Fb.result}))},this.la,3)};k.prototype.hwc=
function(ub){l.prototype.hwc.call(this,ub)};k.prototype.openInExcelClient=function(){var ub=this;this.ea.dc&&(this.$.isEditMode||H.TaskExtensions.Ba(this.RJ.value,function(Fb){ub.lGa(ub.$.workbookContext.ClientUrl,ra.AFrameworkApplication.w3,1,0,!1,new W.a(function(){return Fb.result}))},this.la,3))};k.prototype.openInBrowser=function(){var ub=this;this.ea.dc&&H.TaskExtensions.Ba(this.RJ.value,function(Fb){ub.lGa(ub.$.workbookContext.ClientUrl,ra.AFrameworkApplication.w3,1,5,!1,new W.a(function(){return Fb.result}))},
this.la,3)};k.prototype.downloadFile=function(ub){var Fb=this.gue(ub);this.mua.downloadFile(Fb,ub);this.kui()};k.prototype.kui=function(){ra.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1)&&null!=this.cga&&this.cga.execute(function(ub){return ub.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled")})};k.prototype.WDf=function(ub,Fb){Fb=void 0===Fb?0:Fb;if(this.ea.dc){var pc=this.$;
S.a(pc).ELa?this.XDf(ub,pc):0<Fb?this.AEj(ub,pc,Fb):this.j2f(pc)}};k.prototype.lGa=function(ub,Fb,pc,eb,ic,Ac){this.$.ob.sz=!ac.EwaSettings.isChangeGateEnabled("OfficeVSO:5209012_KeepMenuEnableAfterOIC")||!this.$.ic.inWebPart;this.STe=ic;this.Z2b=null;this.q6c=!1;this.GNg(ub,Fb,eb,ic,Ac)};k.prototype.Y2b=function(ub){var Fb=this.$.ic;Q.ULS.sendTraceTag(537154775,0,50,"OpenInExcelOperation.CompleteClientLaunch: IsEmbedded:{0}, InWebPart:{1}, DivSyndicated:{2}, Mode:{3}",Fb.inEmbedView,Fb.inWebPart,
Fb.isDivSyndicated,this.$.isEditMode?rb.a.edit:rb.a.view);return k.kef()?(this.x2b(),m.S6c(this.JUa,this.SB,this.options,1,this.yJi,this.xJi,!1,ra.AFrameworkApplication.fa.ra("OICEncodeUrlIsEnabled")),32):l.prototype.Y2b.call(this,ub)};k.prototype.Lwh=function(){this.gSf();var ub=this.$;if(!this.ea.ic.inWebPart&&this.ea.dc&&!ub.isEditMode){var Fb=new kb.a(2145659238,Ab.a.Cb,this.$.Jc,0,null);this.Zye=Pb.a.instance.create(function(){ub.Ka.Kb(Fb)},0,Aa.a.SUi)}};k.prototype.dispose=function(){this.ea&&
this.ea.xk(this.Uc);ca.a.oc([this.Qa,this.Zye,this.wm]);this.$=this.ea=null};k.prototype.axh=function(){this.gSf()};k.prototype.sjf=function(){var ub=this;Pb.a.instance.create(function(){ub.$.Ka.Kb(new kb.a(-2028960985,Ab.a.Cb,0,30,null))},0,Aa.a.TUi,!0,!0)};k.prototype.BNg=function(ub){var Fb=this.$,pc=S.a(this.$).fd.activityState;pc[mc.a.Mje]=!0;Fb.isEditMode&&this.ea.dc?(this.x2b(),ia.a(Fb).ft(new Lb.a(wa.a.fz,5,function(){Fb.$H(!1);pc[Sa.a.Rq]=wa.a.z2b;pc[mc.a.Kzg]=ub;pc[ta.a.fad]=!0;Fb.isEditMode&&
(pc[ta.a.sT]=1,pc[ta.a.gY]=!0,pc[Cb.a.qYb]=!0,pc[Cb.a.yTc]=!0);pc[mc.a.Pje]=1455037301}))):this.TLf(ub)};k.prototype.Z4f=function(){var ub=ra.AFrameworkApplication.w3;if(this.$.downloadCopyOnOpenInClient){if(8===this.$.frame.F8a(ub,!0)){var Fb=this.$.ea.ic;Q.ULS.sendTraceTag(537154773,0,50,"Url:[{0}] IsEmbedded:[{1}] InWebPart:[{2}] DivSyndicated:[{3}], Mode:[{4}]",ub,Fb.inEmbedView,Fb.inWebPart,Fb.isDivSyndicated,this.$.isEditMode?rb.a.edit:rb.a.view)}}else this.mua.downloadFile(ub,-2028960985);
this.q6c=!0;this.x2b()};k.prototype.gri=function(){this.Ezc.msf&&this.Ezc.ojc(1)};k.prototype.hri=function(){this.Ezc.msf&&Dc.HelperMethods.Ze(na.a.sZ(33),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryOffice")};k.prototype.rri=function(){Dc.HelperMethods.Ze(na.a.sZ(31),"_blank",void 0,"OpenExcelOperation.XLSBackstageUnknownTryMacOffice")};k.prototype.sri=function(){Dc.HelperMethods.Ze(na.a.sZ(34),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryMacOffice")};k.prototype.gue=function(ub){var Fb=
new Sys.StringBuilder,pc=this.$.workbookContext,eb=this.$.ya;Fb.append(this.$.Dda);Fb.append(eb.FileHandlerRelativeUri);Fb.append("?id=");Fb.append(encodeURIComponent(ka.a.GHb(pc.WorkbookUri,"sc")));this.$.ea.dc&&(Fb.append("&sessionId="),Fb.append(encodeURIComponent(this.$.ea.sessionId)));switch(ub){case -974518828:Fb.append("&workbookType=PublishedItemsSnapshot");break;case -1804063550:Fb.append("&workbookType=FullWorkbook");break;case -1059172980:Fb.append("&workbookType=FullWorkbook&workbookFileType=Odf");
break;default:Fb.clear()}Y.a.VYa(Fb,eb);return Fb.toString()};k.prototype.U0g=function(){La.a.instance.aXg();var ub=this.$.ya;MSOJS.ClientUtils.InitUrls(ub.RoamingAppsX86RootUrl,ub.RoamingAppsControlInstallerUrl,ub.RoamingAppsFirefoxExtensionUrl)};k.prototype.gSf=function(){var ub=this.$;this.ea.dc||sb.a.gFd(ub,S.a(ub).fd);this.x2b();this.Z2b&&this.Z2b(this,this.q6c);ub.frame.pt.$l(this.$.frame.Faa());ub.frame.hX.$l(this.$.frame.Faa());ub.ob.sz=!1;Zb.g(ub).focus()};k.prototype.GNg=function(ub,Fb,
pc,eb,ic){var Ac=this.$;ra.AFrameworkApplication.ta&&!k.kef()&&(Ac.frame.pt.Ym(Ac.frame.Faa()),Ac.frame.hX.Ym(Ac.frame.Faa()));l.prototype.lGa.call(this,ub,Fb,1,pc,eb,ic)};k.prototype.x2b=function(){var ub=this.$;S.a(ub).ji.activityName===wa.a.openInExcelClient&&S.a(ub).fd.hM()};k.prototype.tzj=function(){var ub=lb.a.Wc(1,0,684,685,0,1341525452,"OpenInExcelActiveXError");ia.a(this.$).qr([ub])};k.prototype.AEj=function(ub,Fb,pc){var eb=this,ic=null,Ac=window.setTimeout(function(){S.a(Fb).osc(ic);eb.j2f(Fb)},
pc);ic=function(){S.a(Fb).ELa&&(S.a(Fb).osc(ic),window.clearTimeout(Ac),eb.XDf(ub,Fb))};S.a(Fb).yUc(ic)};k.prototype.j2f=function(ub){var Fb=lb.a.Wc(1,1,0,699,0,-1753121099,"ProcessingUserChangesFileDownloadIgnored");ia.a(ub).qr([Fb])};k.prototype.XDf=function(ub,Fb){var pc=this;ia.a(Fb).ft(new Lb.a(wa.a.fz,5,function(){Fb.$H(!1);var eb=S.a(Fb).fd,ic=eb.activityState;ic[Sa.a.Rq]=wa.a.DIe;ic[ec.a.sYb]=Fb.ea.ic.hasUnsupportedFeaturesForEdit;ic[da.a.sTc]=ub;eb.Bt(lb.a.jaa(pc.businessBar.d7c,[1437034227]))}))};
k.kef=function(){return 1<ob.a.getRegisteredEwaInstances().length};Af.Object.defineProperties(k.prototype,{M8e:{configurable:!0,enumerable:!0,get:function(){return"EditInExcelWebApp_32x32x32"}},la:{configurable:!0,enumerable:!0,get:function(){this.wm=this.wm||new Ya.a;return this.wm.token}},ckd:{configurable:!0,enumerable:!0,get:function(){return"excel32"}},g7f:{configurable:!0,enumerable:!0,get:function(){return this.ea.ic.inWebPart}}});Object(J.a)(k,"OpenInExcelOperation",l,[552,10]);var wb=O.a;
Rk(e,wb);e.prototype.create=function(){var ub=this;if(this.$.da.za(55))this.pb(this.$.da.za(55));else{var Fb=N.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb),pc=N.GetServiceTaskFactory.Ra(this.$.da,5,4,this.hb);H.TaskExtensions.Ba(ab.Task.qL(Fb,pc),function(){ub.pb(new k(ub.$,new W.a(function(){return N.GetServiceTaskFactory.create(ub.$.da,137,ub.la,ub.hb)}),pc.result))},this.la,3)}};e.T0g=function(){e.Ksf||(e.Ksf=!0,(new C).Sh(va.a.instance),va.a.instance.resolve("Common.IOfficeTrialExperience").Cg(),
va.a.instance.resolve("Common.IMacOfficeOffer").Cg())};e.Ksf=!1;Object(J.a)(e,"OpenInClientFactory",O.a,[]);var rc=b(115),Mc=b(414),Pc=rc.a;Rk(d,Pc);d.prototype.execute=function(ub){var Fb=Object(X.a)(6,ub.ve);H.TaskExtensions.Ba(N.GetServiceTaskFactory.create(Fb.da,56,Fb.la,0),function(pc){Fb.downloadCopyOnOpenInClient?(ub.activityState[Mc.a.Nje]=!0,pc.result.Z4f()):pc.result.m2g()},Fb.la,3);return 1};Object(J.a)(d,"OpenInExcelClientActivity",rc.a,[]);var Kc=O.a;Rk(c,Kc);c.prototype.create=function(){var ub=
this;H.TaskExtensions.Ba(N.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb),function(){ub.pb(new d(wa.a.openInExcelClient,wa.a.idle))},this.la)};Object(J.a)(c,"OpenInExcelClientActivityFactory",O.a,[]);b.d(D,"a",function(){return a})},1358:function(u,D,b){function a(bb,db){var wc=dc.call(this,db)||this;wc.DCh=K.DOMElementExtensions.gr+",div";wc.pU=Array(68);wc.qm=!1;wc.VV=function(nb){if(nb.Ca.keyCode===E.a.Vz){var zb=wc.jc.querySelectorAll(wc.DCh),ma=K.DOMElementExtensions.Dl(zb);zb=K.DOMElementExtensions.hz(zb);
return K.DOMElementExtensions.lna(nb.Ca,ma,zb)}return!1};wc.jb=bb;wc.set_visible(!1);wc.addCssClass(O.a.omh);yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)&&wc.addCssClass(O.a.ymh);I.KeyInputManager.instance.qa(U.a.Lb,wc.jc,wc.VV);H.a(bb).Oh(wc);return wc}function c(bb,db,wc,nb,zb,ma){var P=C.call(this,bb,db,wc)||this;Va.a.instance.create(function(){if(P.businessBar&&P.businessBar.ULa(db.sGa)){var oa=new Z.a(-847286761,0,P.businessBar.$.Jc,0,null),Ja={};Ja=(Ja.CalloutName=
nb,Ja.Target=yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?P.domElement.getElementsByClassName("ms-Button")[0]:P.zS.domElement,Ja);P.businessBar.$.Ka.Kb(oa,Ja)}},zb,ma,!0,!0);return P}function d(bb,db,wc,nb){bb=Db.call(this,bb,db)||this;bb.automateCommandManager=wc.da.za(352);G.ULS.shipAssertTag(526787654,0,!!bb.automateCommandManager);bb.id=Hb.a.create();bb.$=wc;bb.title=qa.a.instance.ga(2247);bb.message="";bb.mTd=qa.a.instance.ga(2243);bb.hWj=qa.a.instance.ga(2244);
bb.ifg=qa.a.instance.ga(2245);bb.A1g=qa.a.instance.ga(2246);bb.update(nb);return bb}function e(bb,db){bb=va.call(this,bb,db)||this;bb.VBa=ya.a.G4b();bb.Pu=!0;bb.CZ=bb.VBa.pUj;bb.title=bb.VBa.title;bb.message=bb.VBa.message;return bb}function k(bb,db){bb=ba.call(this,bb,db)||this;bb.Pu=!0;bb.title="";return bb}function l(bb,db){db=Na.call(this,bb,db)||this;db.policyManager=bb.$.da.za(274);if(!db.policyManager)return G.ULS.sendTraceTag(537170202,306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered."),
db;db.message=db.policyManager.Kpc;db.title=db.policyManager.title;db.Dva=!0;return db}function m(bb,db){bb=ta.call(this,bb,db)||this;bb.Pu=!0;bb.CZ=!0;return bb}function f(bb,db,wc,nb){bb=xa.call(this,bb,db)||this;bb.Twb=wc;bb.command=nb;bb.Dva=!0;bb.Pu=1461300262!==nb;return bb}function w(bb,db,wc){bb=S.call(this,bb,db)||this;bb.Twb=wc;bb.Dva=!0;return bb}function n(bb,db,wc){bb=Qa.call(this,bb,db)||this;bb.Twb=wc;bb.Pu=!0;return bb}function z(bb,db){bb=ia.call(this,bb,db)||this;bb.Pu=!0;bb.CZ=
!1;return bb}function r(bb,db){bb=ha.call(this,bb,db)||this;bb.Pu=!0;bb.CZ=!0;return bb}function v(bb,db,wc,nb,zb,ma,P,oa){return A.call(this,bb,0,db,wc,nb,zb,ma,P,oa)||this}function A(bb,db,wc,nb,zb,ma,P,oa,Ja){this.SI=this.i8=this.zS=0;this.rlg=bb;this.PJj=db;this.gP=wc;this.Opg=P;this.yib=F.a.Nv(Ja);this.Ing=Ja;this.wlg=oa;0!==nb&&(this.zS=nb);0!==zb&&(this.i8=zb);0!==ma&&(this.SI=ma)}function B(bb,db,wc,nb,zb){bb=y.call(this,bb,db,wc,nb)||this;bb.command=zb;bb.CZ=!0;return bb}function y(bb,db,
wc,nb){bb=Y.call(this,bb,db)||this;bb.error=wc;bb.options=nb;bb.error&&bb.options&2&&(bb.message=bb.error.Description);bb.error&&bb.options&1&&(bb.title=bb.error.Caption);bb.Pu=!(nb&4);return bb}function x(bb,db,wc){return C.call(this,bb,db,wc)||this}function C(bb,db,wc){bb=ea.call(this,bb,db)||this;bb.Pu=!0;bb.command=wc;return bb}b.r(D);u=b(0);var G=b(15),E=b(86),I=b(109),U=b(13),M=b(90),T=b(52),F=b(30),K=b(12),J=b(244),O=b(1264),N=b(5),H=b(273),Q=b(1265),ca=b(918),X=b(1466),Z=b(92),ea=ca.a;Rk(C,
ea);C.prototype.ro=function(bb){ea.prototype.ro.call(this,bb);this.businessBar.$.Ka.Kb(new Z.a(this.command,bb,this.businessBar.$.Jc,10,null))};Object(u.a)(C,"CommandActionBusinessBarEntry",ca.a,[]);Rk(x,C);x.prototype.UC=function(bb){C.prototype.UC.call(this,bb)};Object(u.a)(x,"EditAttemptReadOnlyBusinessBarEntry",C,[]);var ka=b(42),Y=ca.a;Rk(y,Y);y.prototype.ro=function(bb){Y.prototype.ro.call(this,bb);this.error.Appearance&=-33;ka.a(this.businessBar.$).qr([this.error])};Object(u.a)(y,"ErrorBusinessBarEntry",
ca.a,[]);Rk(B,y);B.prototype.C_=function(bb){y.prototype.C_.call(this,bb);this.businessBar.$.Ka.Kb(new Z.a(this.command,bb,this.businessBar.$.Jc,10,null))};Object(u.a)(B,"ErrorAndCommandBusinessBarEntry",y,[]);var qa=b(14);A.ga=function(bb){return qa.a.instance.ga(bb)};Af.Object.defineProperties(A.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return A.ga(this.PJj)}},message:{configurable:!0,enumerable:!0,get:function(){return A.ga(this.gP)}},messageId:{configurable:!0,enumerable:!0,
get:function(){return this.gP}},sGa:{configurable:!0,enumerable:!0,get:function(){return this.rlg}},actionButton:{configurable:!0,enumerable:!0,get:function(){return A.ga(this.zS)}},WFa:{configurable:!0,enumerable:!0,get:function(){return A.ga(this.i8)}},link:{configurable:!0,enumerable:!0,get:function(){return A.ga(this.SI)}},Kk:{configurable:!0,enumerable:!0,get:function(){return this.Opg}},cSg:{configurable:!0,enumerable:!0,get:function(){return this.wlg}},hash:{configurable:!0,enumerable:!0,get:function(){return this.yib}},
alt:{configurable:!0,enumerable:!0,get:function(){var bb=b(1358).BusinessBarControl;switch(this.Kk){case bb.tia:return A.ga(26);case bb.Xz:return A.ga(25);case bb.Oi:return A.ga(24);default:return A.ga(0)}}},V7c:{configurable:!0,enumerable:!0,get:function(){return this.Ing}}});Object(u.a)(A,"EwaBusinessBarEntry",null,[]);Rk(v,A);Af.Object.defineProperties(v.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return""}}});Object(u.a)(v,"EwaNoTitleBusinessBarEntry",A,[]);var fa=b(69),ha=
ca.a;Rk(r,ha);r.prototype.ro=function(bb){ha.prototype.ro.call(this,bb);this.set_visible(!1);this.businessBar.$.cI();this.businessBar.$.Ka.Kb(new Z.a(1038998010,bb,this.businessBar.$.Jc,10,null))};r.prototype.C_=function(bb){ha.prototype.C_.call(this,bb);this.businessBar.$.Ka.Kb(new Z.a(-722953877,bb,this.businessBar.$.Jc,10,null))};r.prototype.UC=function(bb){this.businessBar.removeEntry(54);fa.g(bb)};Object(u.a)(r,"ExternalLinksEnableContentBusinessBarEntry",ca.a,[]);var ia=ca.a;Rk(z,ia);z.prototype.ro=
function(bb){ia.prototype.ro.call(this,bb);this.businessBar.$.Ka.Kb(new Z.a(-722953877,bb,this.businessBar.$.Jc,10,null))};z.prototype.UC=function(bb){this.businessBar.removeEntry(5);fa.g(bb)};Object(u.a)(z,"ExternalLinksShowErrorBusinessBarEntry",ca.a,[]);var wa=b(10),Qa=ca.a;Rk(n,Qa);n.prototype.ro=function(bb){Qa.prototype.ro.call(this,bb);wa.HelperMethods.YV(this.businessBar.$.eG,this.Twb,this.businessBar.$.sS)};Object(u.a)(n,"HelpButtonBusinessBarEntry",ca.a,[]);var S=ca.a;Rk(w,S);w.prototype.Ula=
function(bb){S.prototype.Ula.call(this,bb);wa.HelperMethods.YV(this.businessBar.$.eG,this.Twb,this.businessBar.$.sS)};Object(u.a)(w,"HelpTextBusinessBarEntry",ca.a,[]);var da=b(76),xa=ca.a;Rk(f,xa);f.prototype.ro=function(bb){xa.prototype.ro.call(this,bb);this.businessBar.$.Ka.Kb(new Z.a(this.command,bb,this.businessBar.$.Jc,10,null))};f.prototype.Ula=function(bb){xa.prototype.Ula.call(this,bb);var db=new Z.a(-859308420,bb,this.businessBar.$.Jc,12,null),wc={};bb=(wc[da.a.Vf]="HelpID="+this.Twb,wc.InputMethod=
bb,wc[da.a.Nc]=N.a.JQ,wc[N.a.Zda]=!0,wc);this.businessBar.$.Ka.Kb(db,bb)};Object(u.a)(f,"HelpTextTaskPaneAndCommandBusinessBarEntry",ca.a,[]);var ta=ca.a;Rk(m,ta);m.prototype.ro=function(bb){ta.prototype.ro.call(this,bb);this.set_visible(!1);this.businessBar.$.cI();this.businessBar.$.Ka.Kb(new Z.a(-1081442996,bb,this.businessBar.$.Jc,10,null))};m.prototype.C_=function(bb){ta.prototype.C_.call(this,bb);this.businessBar.$.Ka.Kb(new Z.a(1702917262,bb,this.businessBar.$.Jc,10,null))};m.prototype.UC=function(bb){this.businessBar.removeEntry(58);
fa.g(bb)};Object(u.a)(m,"LinkedEntitiesEnableUntrustedImagesBusinessBarEntry",ca.a,[]);var ab=b(1267),Na=ca.a;Rk(l,Na);l.prototype.Ula=function(bb){Na.prototype.Ula.call(this,bb);(bb=this.policyManager.aOi)&&bb(null)};Af.Object.defineProperties(l.prototype,{linkText:{configurable:!0,enumerable:!0,get:function(){return this.policyManager.linkText}}});Object(u.a)(l,"PolicyBusinessBarEntry",ca.a,[]);var Ka=b(1266),la=b(1269),Ea=b(1268);b(442);var ra=b(187),na=b(27),ba=ca.a;Rk(k,ba);k.prototype.ro=function(bb){ba.prototype.ro.call(this,
bb);ra.c(na.a.OCi);window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ","_blank")};Object(u.a)(k,"UnsupportedBrowserBusinessBarEntry",ca.a,[]);var sa=b(1263),ya=b(1489),va=ca.a;Rk(e,va);e.prototype.ro=function(bb){va.prototype.ro.call(this,bb);this.VBa.Qtf(null)};e.prototype.C_=function(bb){va.prototype.C_.call(this,bb);this.VBa.Ttf(null)};e.prototype.UC=function(bb){va.prototype.UC.call(this,bb);this.VBa.AHe(null)};Af.Object.defineProperties(e.prototype,{actionButton:{configurable:!0,
enumerable:!0,get:function(){return this.VBa.vue}},WFa:{configurable:!0,enumerable:!0,get:function(){return this.VBa.xue}}});Object(u.a)(e,"WildFireMobileAppBusinessBarEntry",ca.a,[]);var W=b(256),La=b(22),Ia=b(227),mb=b(165),fb=b(46),Ma=b(7),Hb=b(178),Kb=b(1171),Ub=b(80),gb=b(133),Db=ca.a;Rk(d,Db);d.prototype.update=function(bb){this.scriptLink=bb.scriptLink;this.runStatus=bb.runStatus;this.buttonText=bb.buttonText||"";this.Lti(bb.clickId);this.Cfj();"preparing"===this.runStatus?(this.message=String.format(qa.a.instance.lb(203),
this.buttonText),this.Pu=!0,this.PXa=this.mTd,this.Zpb=this.jFa=this.M9a):"running"===this.runStatus?(this.message=String.format(qa.a.instance.lb(202),this.buttonText),this.Pu=!0,this.PXa=this.mTd,this.Zpb=this.jFa=this.M9a):"succeeded"===this.runStatus?(this.message=String.format(qa.a.instance.lb(205),this.buttonText),this.Pu=!0,this.PXa=this.ifg,this.jFa=this.xDf,this.CZ=!0,this.FVc=this.hWj,this.GVc=this.VTi):"runFailed"===this.runStatus?(this.message=String.format(qa.a.instance.lb(204),this.buttonText),
this.a5a=a.tia,this.Pu=!0,this.PXa=this.ifg,this.jFa=this.xDf,"false"===bb.isOwner&&(this.CZ=!0,this.FVc=this.A1g,this.GVc=this.hIi)):"fetchFailed"===this.runStatus?(this.a5a=a.tia,this.message=String.format(qa.a.instance.lb(206),this.buttonText)):"canceled"===this.runStatus?(this.a5a=a.Xz,this.message=String.format(qa.a.instance.lb(208),this.buttonText)):"alreadyRunning"===this.runStatus?(this.a5a=a.Xz,this.message=String.format(qa.a.instance.lb(207),this.buttonText),this.Pu=!0,this.PXa=this.mTd,
this.Zpb=this.jFa=this.M9a):"initializing"===this.runStatus&&(this.a5a=a.Oi,this.message=qa.a.instance.ga(2248))};d.prototype.ro=function(bb){Db.prototype.ro.call(this,bb);this.jFa&&this.jFa()};d.prototype.C_=function(bb){Db.prototype.C_.call(this,bb);this.WFa&&this.GVc()};d.prototype.UC=function(bb){Db.prototype.UC.call(this,bb);this.Zpb&&this.Zpb()};d.prototype.Cfj=function(){this.message="";this.a5a=a.Oi;this.Pu=!1;this.PXa="";this.jFa=void 0;this.CZ=!1;this.FVc="";this.GVc=void 0;this.R4a=!1;
this.Zpb=void 0};d.prototype.M9a=function(){var bb=Hb.a.create().toString();this.automateCommandManager.v1h(bb);this.Njc(-2186799,bb)};d.prototype.xDf=function(){var bb=Hb.a.create().toString();this.automateCommandManager.u1h(bb);this.Njc(1036446140,bb)};d.prototype.VTi=function(){var bb=Hb.a.create();if(this.scriptLink){var db=new Kb.b(this.scriptLink);this.automateCommandManager.p5e(this.id.toString(),JSON.stringify(db),bb)}this.Njc(-585097204,bb.toString())};d.prototype.hIi=function(){var bb=Hb.a.create().toString();
this.automateCommandManager.t1h(bb);this.Njc(-639858579,bb)};d.prototype.Lti=function(bb){var db=[];db.push(Object(Ma.a)(new Ub.a,{name:"id",string:this.id.toString()}));db.push(Object(Ma.a)(new Ub.a,{name:"hasScriptLink",bool:!!this.scriptLink}));db.push(Object(Ma.a)(new Ub.a,{name:"runStatus",string:this.runStatus}));db.push(Object(Ma.a)(new Ub.a,{name:"clickId",string:bb}));db.push(Object(Ma.a)(new Ub.a,{name:"hasButtonText",bool:!!this.buttonText&&""!==this.buttonText}));ra.a(gb.a.iFi,void 0,
void 0,db)};d.prototype.Njc=function(bb,db){var wc=[];wc.push(Object(Ma.a)(new Ub.a,{name:"id",string:this.id.toString()}));wc.push(Object(Ma.a)(new Ub.a,{name:"hasScriptLink",bool:!!this.scriptLink}));wc.push(Object(Ma.a)(new Ub.a,{name:"runStatus",string:this.runStatus}));wc.push(Object(Ma.a)(new Ub.a,{name:"clickId",string:db}));ra.d(bb,void 0,void 0,void 0,void 0,void 0,wc)};Af.Object.defineProperties(d.prototype,{Kk:{configurable:!0,enumerable:!0,get:function(){return this.a5a}},actionButton:{configurable:!0,
enumerable:!0,get:function(){return this.PXa}},WFa:{configurable:!0,enumerable:!0,get:function(){return this.FVc}}});Object(u.a)(d,"OfficeScriptsRunStatusBusinessBarEntry",ca.a,[]);var Va=b(47),yb=b(1);Rk(c,C);Object(u.a)(c,"CalloutBusinessBarEntry",C,[]);var qb=b(18);b.d(D,"BusinessBarControl",function(){return a});var dc=J.a;Rk(a,dc);a.prototype.Uf=function(bb,db){db||K.DOMElementExtensions.setFocus(this.domElement.firstChild);return!db};a.prototype.$g=function(bb){return K.DOMElementExtensions.nf(this.jc,
bb)};a.prototype.hj=function(){};a.prototype.Dj=function(){};a.prototype.dispose=function(){this.qm||(I.KeyInputManager.instance.Aa(U.a.Lb,this.jc,this.VV),M.a.oc(this.pU),this.pU=Array(68),this.jb=null,dc.prototype.dispose.call(this),this.qm=!0)};a.prototype.ULa=function(bb){if(!this.get_visible())return!1;bb=this.pU[bb];return!!bb&&bb.isVisible};a.prototype.hC=function(bb){return!!this.pU[bb]};a.prototype.TNb=function(bb,db){if(bb=this.pU[bb])bb.update(db),bb.lQj()};a.prototype.VD=function(bb,db,
wc,nb){wc=void 0===wc?null:wc;nb=void 0===nb?null:nb;var zb=!1;if(this.hC(bb))wc=this.pU[bb].get_visible();else{this.set_visible(!0);var ma=a.n3e()[bb];this.pU[bb]=this.G$(bb,db,wc,nb);wc=!1;zb=!0;nb="";var P=0;db&&(nb=db.MessageIdName,P=db.MessageId);var oa=ma.V7c;G.ULS.sendTraceTag(537170258,0,50,"BusinessBarControl.AddEntry of type: {0}, time from app interactive: {1}",bb,fb.PageLoadTrackingInfo.instance.eKa(new Date));if(yb.EwaSettings.isChangeGateEnabled("OfficeVSO:6069521_TelemetryForBusinessBar")){var Ja=
this.pU.filter(function($a){return null!=$a}).length;1<Ja&&G.ULS.sendTraceTag(525349006,0,50,"Total BizBars: {0}",Ja.toString())}mb.a(this.$).BJd(ma.hash,nb,P,T.a.IAc,!0,1,db,oa)}wc||!Array.contains(X.a.occ(),bb)&&!zb||(this.pU[bb].set_visible(!0),this.$.cI())};a.prototype.removeEntry=function(bb){return this.e$i(bb)};a.prototype.BHd=function(){M.a.oc(this.pU);this.pU=Array(68);this.set_visible(!1)};a.prototype.e$i=function(bb){if(!this.hC(bb))return!1;M.a.Ia(this.pU[bb]);this.pU[bb]=null;this.domElement.hasChildNodes()||
this.set_visible(!1);this.$.cI();return!0};a.prototype.G$=function(bb,db,wc,nb){wc=void 0===wc?null:wc;nb=void 0===nb?null:nb;var zb=a.n3e()[bb],ma=!!(this.$.Bd&64);switch(bb){case 2:case 4:case 23:case 25:case 26:case 35:case 34:bb=new ca.a(this,zb);break;case 12:case 29:case 30:case 31:case 32:case 56:bb=ma?new C(this,zb,-8805455):new ca.a(this,zb);break;case 22:bb=new x(this,zb,-8805455);break;case 45:case 44:bb=ma?new B(this,zb,db,0,-8805455):new y(this,zb,db,0);break;case 11:case 42:case 7:case 0:case 1:case 3:case 33:bb=
new y(this,zb,db,0);break;case 19:bb=new ca.a(this,zb);break;case 46:bb=new y(this,zb,db,0);break;case 6:case 14:bb=new n(this,zb,db.HelpTopicId);break;case 67:case 65:bb=new w(this,zb,db.HelpTopicId);break;case 36:bb=new w(this,zb,N.a.kbh);break;case 37:bb=new ca.a(this,zb);break;case 16:bb=new ca.a(this,zb);bb.title=F.a.Ag(this.$.workbookContext.FullDocumentInfo.IrmPolicyTitle);bb.message=F.a.Ag(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription);break;case 18:bb=new C(this,zb,-1762562205);
bb.R4a=!0;break;case 20:bb=new e(this,zb);break;case 21:case 55:bb=new ca.a(this,zb);break;case 28:bb=new ca.a(this,zb);break;case 24:bb=new k(this,zb);break;case 27:bb=new l(this,zb);break;case 38:bb=new sa.a(this,zb);break;case 39:bb=new Q.a(this,zb);break;case 40:bb=new Ka.a(this,zb);break;case 41:bb=new ab.a(this,zb);break;case 47:bb=new ca.a(this,zb);break;case 48:bb=new ca.a(this,zb);break;case 49:bb=new ca.a(this,zb);break;case 50:bb=new ca.a(this,zb);break;case 51:bb=new ca.a(this,zb);break;
case 52:bb=new Ea.a(this,zb);break;case 53:bb=new la.a(this,zb);break;case 54:bb=new r(this,zb);break;case 5:bb=new z(this,zb);break;case 57:bb=new C(this,zb,-1753056834);db?(db=db.Directive,La.a.wq(db)||"&nbsp;"===db||(bb.message=db)):wc&&(bb.message=wc);break;case 58:bb=new m(this,zb);break;case 59:bb=new ca.a(this,zb);break;case 60:case 63:bb=new w(this,zb,N.a.rEi);break;case 61:bb=new f(this,zb,N.a.rNg,-8805455);break;case 66:bb=new f(this,zb,N.a.G5i,1461300262);break;case 62:bb=yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerBusinessBarTeachingCallout",
!1)?new c(this,zb,515196233,13,3E5,"OptimizeWorkbookManager.ShowBusinessBarTeachingCallout"):new C(this,zb,515196233);break;case 64:bb=new d(this,zb,this.$,nb);break;default:bb=new y(this,zb,db,7)}bb.G2c();return bb};a.n3e=function(){var bb=Ia.a.ZLa()?263:262;return a.lue||(a.lue=[new A(0,278,279,280,0,0,a.tia,1,"BB_UnableToRefreshLock"),new A(1,278,279,280,0,0,a.tia,1,"BB_UnableToRefreshLockExpected"),new A(2,270,271,0,0,0,a.Xz,5,"BB_WorkbookAlmostTooLarge"),new A(3,272,273,274,0,0,a.tia,1,"BB_WorkbookTooLarge"),
new A(4,261,bb,0,0,0,a.Xz,5,"BB_ExternalWorkbookLinksDisabled"),new A(5,265,264,266,0,0,a.tia,1,"BB_ExternalWorkbookLinksShowError"),new A(6,267,268,269,0,0,a.Oi,0,"BB_EditAndRefreshDisabledOnBIAHostedFiles"),new A(7,253,254,255,0,0,a.Oi,0,"BB_UnsupportedFeatures"),new A(8,0,0,0,0,0,a.Oi,0,"BB_CollabDataAndDataStringsLocaleMismatch"),new A(9,0,0,0,0,0,a.Oi,0,"BB_CollabDataStringsLocaleMismatch"),new A(10,0,0,0,0,0,a.Oi,0,"BB_CollabDataLocaleMismatch"),new A(11,281,282,283,0,0,a.tia,1,"BB_LastGenericStatusError"),
new A(12,284,285,286,0,0,a.Xz,5,"BB_ScratchPadWarning"),new A(13,287,288,289,0,0,a.tia,1,"BB_AuthenticationLost"),new A(14,290,291,292,0,0,a.Xz,5,"BB_OdfCompatibilityIssues"),new A(15,0,578,0,0,0,a.Xz,5,"BB_PivotChartInteractivityMissingWarning"),new A(16,0,0,0,0,0,a.Oi,0,"BB_WorkbookIsIrmProtected"),new A(17,0,0,0,0,0,a.Oi,0,"BB_BIFeatureNotAvailable"),new A(18,293,294,289,0,0,a.Xz,5,"BB_AnonymousCreateMode"),new A(19,256,257,0,0,0,a.Xz,5,"BB_UnsupportedInteractiveReportEditing"),new A(20,0,0,0,
0,0,a.Oi,0,"BB_MobileAppCampaignBizBar"),new A(21,299,300,0,0,0,a.Oi,0,"BB_TransientServerCommunicationFailures"),new A(22,1623,1634,1635,0,0,a.Oi,0,"BB_EditAttemptInReadOnly"),new A(23,1623,1634,0,0,0,a.Oi,0,"BB_EditAttemptInReadOnlyNoEditPermissions"),new A(24,0,wa.HelperMethods.IPj(),1612,0,0,a.Oi,0,"BB_UnsupportedBrowser"),new A(25,302,303,0,0,0,a.Oi,0,"BB_ReadOnlyPermissions"),new A(26,304,305,0,0,0,a.Oi,0,"BB_DocumentIsIrmProtectedWarning"),new A(27,0,0,0,0,0,a.Xz,5,"BB_PolicyWarningMessage"),
new A(28,1266,301,0,0,0,a.Oi,0,"BB_WorkingOnIt"),new A(29,1623,1621,1622,0,0,a.Oi,0,"BB_PasswordProtectedWorkbookLockedForEdit"),new A(30,1636,1637,1638,0,0,a.Oi,0,"BB_WorkbookIsReadOnlyRecommended"),new A(31,1623,1639,1640,0,0,a.Oi,0,"BB_WorkbookHasPasswordToModify"),new A(32,1623,1641,1644,0,0,a.Oi,0,"BB_LegacySharedWorkbookEditWarning"),new A(33,1631,1642,255,0,0,a.Oi,0,"BB_LegacyConnectionsWarning"),new A(34,1632,1633,0,0,0,a.Oi,0,"BB_GroupedSlicers"),new A(35,315,316,0,0,0,a.Xz,5,"BB_ThirdPartyAddinDisabled"),
new A(36,1764,1765,0,0,1766,a.Oi,0,"BB_FinanceLinkedEntityDisclaimerBar"),new A(37,1793,1794,0,0,0,a.Xz,5,"BB_WolframDeprecationAlertBar"),new A(38,0,0,0,0,0,a.Oi,0,"BB_WacGdprNotice"),new A(39,0,0,0,0,0,a.Oi,0,"BB_AutomaticSensitivityLabel"),new A(40,0,0,0,0,0,a.Oi,0,"BB_RecommendedSensitivityLabel"),new A(41,0,0,0,0,0,a.Oi,0,"BB_MandatorySensitivityLabel"),new A(42,317,318,319,0,0,a.Oi,0,"BB_LocalStorageDisabled"),new A(43,635,636,0,0,0,a.Oi,0,"BB_AutoRefreshDisabled"),new A(44,1006,1004,1008,1295,
0,a.Oi,0,"BB_CorruptedFileRepaired"),new A(45,1007,1005,1008,1295,0,a.Oi,0,"CorruptedOdsFileRepaired"),new A(46,275,276,277,0,0,a.Xz,5,"BB_MinorVersionLimitReached"),new A(47,306,307,0,0,0,a.Xz,5,"BB_SensitivityApplicationGenericError"),new A(48,308,310,0,0,0,a.Xz,5,"BB_SensitivityApplicationTooLargeFileError"),new A(49,309,310,0,0,0,a.Xz,5,"BB_SensitivityApplicationLabelNotSupportedError"),new A(50,311,312,0,0,0,a.Xz,5,"BB_SensitivityApplicationLabelDisabledError"),new A(51,313,314,0,0,0,a.Xz,5,
"BB_SensitivityApplicationMandatoryConflictError"),new A(52,0,0,0,0,0,a.Xz,5,"BB_SensitivityApplicationMinorVersionLimitReachedError"),new A(53,0,0,0,0,0,a.Xz,5,"BB_SensitivityApplicationSetLabelError"),new A(54,2089,2090,2091,2094,0,a.Oi,0,"BB_ExternalWorkbookLinksPromptEnableContent"),new A(55,299,300,0,0,0,a.Oi,0,"BB_NetworkDown"),new A(56,320,321,322,0,0,a.Oi,0,"BB_DefaultToViewDueToCogs"),new A(57,1790,1791,1792,0,0,a.Oi,0,"BB_RefreshLinkedEntityErrorBar"),new A(58,1767,1768,1769,1770,0,a.Oi,
0,"BB_LinkedEntitiesUntrustedImagesDisabled"),new v(59,252,0,0,0,a.Oi,0,"BB_CanvasHealth"),new A(60,323,324,0,0,325,a.Oi,0,"BB_NovModeDepreciation"),new A(61,1009,1010,1295,0,1011,a.Oi,0,"BB_MismatchedFileFormatConverted"),new A(62,2204,2205,2206,0,0,a.Oi,0,"BB_OptimizeWorkbook"),new A(63,326,327,0,0,328,a.Oi,0,"BB_NovModePostDepreciation"),new A(64,0,0,0,0,0,a.Oi,0,"BB_OfficeScriptsRunning"),new A(65,2182,2183,0,0,2185,a.Oi,0,"BB_PowerQueryRefreshDataSourceNotSupported"),new A(66,329,330,0,0,331,
a.Oi,0,"BB_ReadOnlyPivotTable"),new A(67,2182,2184,0,0,2185,a.Oi,0,"BB_PowerQueryRefreshHostNotSupported")])};Af.Object.defineProperties(a.prototype,{Zd:{configurable:!0,enumerable:!0,get:function(){return W.a.xYc}},jc:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.get_visible()}},$:{configurable:!0,enumerable:!0,get:function(){return this.jb}}});a.tia=qb.a.Hph;a.Xz=qb.a.Jph;a.Oi=qb.a.Iph;a.lue=null;
Object(u.a)(a,"BusinessBarControl",J.a,[422])},1360:function(u,D,b){function a(){M.a.Fa(function(zb){e.ka(zb);c.ka(zb)})}function c(zb){var ma=nb.call(this)||this;ma.$=zb;ma.Eb();return ma}function d(zb){zb.da.Ga(446,this)}function e(zb){return wc.call(this,zb)||this}function k(zb,ma){var P=this;this.sortOptions=this.dSa=this.selectedRange=null;this.tbf=!1;this.activeCell=this.Ee=this.rb=this.rc=null;this.onContentReady=function(){P.iNf(!1);var oa=P.ha();oa.sa.tg&&oa.sa.Vc.equals(P.dSa)&&(Qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")?
oa.updateSelection(P.selectedRange,ea.C(P.activeCell),0,void 0,void 0,void 0,!0):oa.updateSelection(P.selectedRange,oa.sa.activeCell,0,void 0,void 0,void 0,!0))};this.QLi=function(oa,Ja){oa&&!ia.a.Rg(oa.Errors)&&P.rc&&(P.rc.Io=oa.Result,P.eKb(),P.applyPivotSort(Ja))};this.PLi=function(){};this.nTi=function(oa,Ja){Ja&&Ja.hKj&&Qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&(oa=db.d(P.$.va.pa),P.iKj(new bb.a(ea.B(Ja),oa)))};this.$=zb;this.ejf=
"";this.namedSheetViewPublic=ma;this.gridView=ta.g(this.$);this.$.Fb.Lg("LoadResource","LoadDialogControlsStopwatch")}function l(zb,ma,P,oa,Ja,$a,Ta){Ta=zb.Na(41,void 0===Ta?null:Ta);Ta.filterRange=ma;return Kb.g(zb,"ReapplyAutoFilter",Ta,P,oa,Ja,$a,0)}function m(zb,ma,P,oa,Ja,$a,Ta){Ta=zb.Na(41,void 0===Ta?null:Ta);Ta.options=ma;return Kb.g(zb,"Sort",Ta,P,oa,Ja,$a,0)}function f(zb){this.filterRange=null;this.filterRange=zb}function w(zb){this.selection=null;this.selection=zb}function n(zb,ma,P,oa){var Ja=
Ma.call(this,zb)||this;Ja.zQd=!1;Ja.Ofc=!1;Ja.u6=[];Ja.odi=function($a,Ta){var pa=Ja.z6g($a);Ja.sLa(214,function(Da,rb,Ab){return fa.o(Ja.$.oa.xa,pa,Ja.q_a(Da,Ja.iFh(Ta)),Ja.bU(rb),Ab,null)},16,!0)};Ja.ndi=function($a,Ta,pa){$a=fa.n(Ja.$.oa.xa,Ta,Ja.UFh(Ta,pa),Ja.hMi,null,$a);Ja.u6.push($a)};Ja.hMi=function(){J.ULS.sendTraceTag(529105632,0,10,"CustomSortDialog.OnGetSortConditionColorsOrIconsRequestFailure: GetSortConditionColorsOrIcons request failed.");Ja.w6b(n.Uqb())};Ja.I5c=function($a,Ta){if(1===
$a){$a=Ta.sortRangeType;var pa={};pa.SortOptions=Ta.sortOptions;pa.ShouldRestoreSelection=Ja.zQd;pa.SelectedRange=Ja.selectedRange;pa.OriginalActiveCell=Ja.Loc;pa.TopCellAddress=Ja.TSa;pa.ShouldPromptNamedSheetViewTeachingDialog=Qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures")?0===$a||3===$a:!1;if(!Qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures")&&Ja.cxj($a)){var Da=Ja.$;Ja.namedSheetViewPublic.FAa().continueWith(function(rb){rb.result&&
n.mKf(Da,pa)})}else n.mKf(Ja.$,pa)}else Ja.zQd&&Ja.yoa(Ja.selectedRange,Ja.Loc)};Ja.A6h=function($a,Ta){Ja.zQd=!0;Ja.yoa($a,Ta)};Ja.getColorName=function($a){return Na.a.ZJa(la.a.YG($a))};J.ULS.shipAssertTag(529105669,0,!!ma.ActiveCell);J.ULS.shipAssertTag(529105668,0,!!ma.SelectedRange);J.ULS.shipAssertTag(529105667,0,ea.D(ma.SelectedRange).contains(ea.C(ma.ActiveCell)));J.ULS.shipAssertTag(529105666,0,da.a.equals(ma.SelectedRange.SheetName,ma.ActiveCell.SheetName,!0));Qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5963270_DialogMergeSuspension")&&
(Ja.Pbb=new fb.a(zb,mb.a.Lah,function(){return Ja.Ofc},1));Ja.selectedRange=ma.SelectedRange;Ja.Loc=ma.ActiveCell;Ja.UTg=ma.ExpandSelection;Ja.namedSheetViewPublic=P;Ja.TSa=oa;Ja.initializeAndShow(Ea.a.instance.ga(183),Ja.I5c,Ja.Zsa(ma));return Ja}function z(zb,ma){zb=La.call(this,zb,ma)||this;zb.tCb=zb.Jbd();zb.rr();return zb}function r(zb,ma){var P=zb.SortRange;zb=zb.SortTopToBottom?P.LastColumn-P.FirstColumn:P.LastRow-P.FirstRow;return 0<=ma&&ma<=zb}function v(zb,ma){if(!zb.SortColumnInfoItems)return J.ULS.sendTraceTag(537151618,
0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: SortColumnInfoItems is null"),!1;for(var P=new na.a,oa=ak(zb.SortColumnInfoItems),Ja=oa.next();!Ja.done;Ja=oa.next()){Ja=Ja.value;if(!r(zb,Ja.ColumnOffset))return J.ULS.sendTraceTag(537151617,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: offset [{0}] is out of bounds. sort range: {1}",Ja.ColumnOffset,zb.SortRange),!1;if(!Ja.Name)return J.ULS.sendTraceTag(537151616,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: invalid column name for offset [{0}]",
Ja.ColumnOffset),!1;if(Ja.CellColors&&!Ja.CellColors.length)return J.ULS.sendTraceTag(537151587,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: cell colors are not null but length = [{0}]",Ja.CellColors.length),!1;if(Ja.TextColors&&!Ja.TextColors.length)return J.ULS.sendTraceTag(537151586,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: text colors are not null but length = [{0}]",Ja.TextColors.length),!1;if(Ja.Icons&&!Ja.Icons.length)return J.ULS.sendTraceTag(537151585,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: icons are not null but length = [{0}]",
Ja.Icons.length),!1;P.add(Ja.ColumnOffset)}if(zb.SortConditions)for(oa=ak(zb.SortConditions),Ja=oa.next();!Ja.done;Ja=oa.next())if(Ja=Ja.value,!P.contains(Ja.RowColOffset))return J.ULS.shipAssertTag(537151584,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: missing column info item for sort condition [{0}]",Ja.RowColOffset),!1;if(zb.HeaderColumnInfoItems){if(zb.HeaderColumnInfoItems.length!==zb.SortColumnInfoItems.length)return J.ULS.shipAssertTag(537151583,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo length doesn't match sort column info length"),
!1;for(P=0;P<zb.HeaderColumnInfoItems.length;++P){oa=zb.HeaderColumnInfoItems[P];if(ma&&oa.ColumnOffset!==zb.SortColumnInfoItems[P].ColumnOffset)return J.ULS.shipAssertTag(537151582,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo item offset doesn't match sort columnInfo item offset."),!1;if(oa.CellColors&&1<oa.CellColors.length)return J.ULS.sendTraceTag(537151581,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.CellColors is not null and has more than 1 background color"),
!1;if(oa.TextColors&&1<oa.TextColors.length)return J.ULS.sendTraceTag(537151580,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.TextColors is not null and has more than 1 font color"),!1;if(oa.Icons&&1<oa.Icons.length)return J.ULS.sendTraceTag(537151579,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.Icons is not null and has more than 1 icon"),!1}}return!0}function A(zb){if(!zb.SortConditions)return!0;for(var ma=ak(zb.SortConditions),P=ma.next();!P.done;P=
ma.next()){P=P.value;if(!r(zb,P.RowColOffset))return J.ULS.sendTraceTag(537151620,0,10,"SharedSortInfoResultExtension.VerifySortConditions: offset [{0}] is out of bounds. sort range: {1}",P.RowColOffset,zb.SortRange),!1;if(1===P.SortConditionType&&P.FillGradient&&!y.isValid(P.FillGradient))return J.ULS.sendTraceTag(537151619,0,10,"SharedSortInfoResultExtension.VerifySortConditions: sortCondition contains invalid fillGradient"),!1}return!0}function B(zb){return zb.SortRange?4===zb.SortRangeType?(J.ULS.sendTraceTag(537151622,
0,10,"SharedSortInfoResultExtension.VerifySortRange: Unsupported sort range type: {0}",zb.SortRangeType),!1):2===zb.SortRangeType&&zb.SortTopToBottom&&(null==zb.HeaderRowSize||0>zb.HeaderRowSize)?(J.ULS.sendTraceTag(537151621,0,10,"SharedSortInfoResultExtension.VerifySortRange: header row size must be equal or greater than 1, when range is sheetrange"),!1):!0:(J.ULS.sendTraceTag(537151623,0,10,"SharedSortInfoResultExtension.VerifySortRange: sort range is null"),!1)}function y(){}function x(zb,ma,
P,oa){new Sys.UI.Point(zb,ma);new Sys.UI.Point(P,oa)}function C(){}function G(zb,ma,P,oa){zb=zb.HeaderColumnInfo;return oa||zb?2===ma&&P?zb.CellColors&&1!==zb.CellColors.length?(J.ULS.sendTraceTag(537151626,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.CellColors should be null or have exactly 1 color."),!1):zb.TextColors&&1!==zb.TextColors.length?(J.ULS.sendTraceTag(537151625,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.TextColors should be null or have exactly 1 color"),
!1):zb.Icons&&1!==zb.Icons.length?(J.ULS.sendTraceTag(537151624,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.Icons should be null or have exactly 1 icon"),!1):!0:zb?(J.ULS.sendTraceTag(537151627,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo should be null when range type is not SheetRange, or when headerRowSize{0} == 0.",P),!1):!0:!0}function E(zb,ma){zb=zb.ColumnInfo;switch(ma){case 1:return zb.CellColors&&
zb.CellColors.length?!0:(J.ULS.sendTraceTag(537151631,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on cell color result cell colors is null or there are no colors (must have at least 1)."),!1);case 2:return zb.TextColors&&zb.TextColors.length?!0:(J.ULS.sendTraceTag(537151630,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on font color result text colors is nullor there are no colors (must have at least 1)."),!1);case 3:return zb.Icons&&
zb.Icons.length?!0:(J.ULS.sendTraceTag(537151629,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on icon result icons is nullor there are no icons (must have at least 1)."),!1);default:return J.ULS.sendTraceTag(537151628,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: illeagl sort condition type."),!1}}function I(zb){var ma=this;this.Xv=function(P){switch(P){case 0:ma.wNa("Cancel");break;case 1:ma.wNa("Expand and sort");ma.LQe(!0);break;case 2:ma.wNa("Just sort"),
ma.LQe(!1)}};this.LQe=zb}function U(zb){this.options=null;this.options=zb}var M=b(11);u=b(0);var T=b(905),F=b(51),K=b(37),J=b(15),O=b(1278),N=b(153),H=b(24),Q=b(76),ca=b(54);Object(u.a)(U,"MacroRecorderRangeCustomSortedPayload",null,[409]);var X=b(1166),Z=b(1167),ea=b(45),ka=b(564),Y=b(389),qa=b(177),fa=b(258),ha=b(151),ia=b(29),wa=b(296),Qa=b(1),S=b(186),da=b(22),xa=b(295),ta=b(21),ab=b(1011),Na=b(961),Ka=b(325),la=b(217),Ea=b(14),ra=b(135);I.prototype.show=function(){var zb=new ra.StandardDialog;
zb.Rb=11;zb.mc(1,Ea.a.instance.ga(2096));zb.mc(2,Ea.a.instance.ga(2097));zb.s3f(Ea.a.instance.ga(2095),Ea.a.instance.Xa(647),this.Xv)};I.prototype.wNa=function(zb){J.ULS.sendTraceTag(594125219,0,50,"ExpandSortSelectionDialog: user operation: {0}",zb)};Object(u.a)(I,"ExpandSortSelectionDialog",null,[]);var na=b(202);C.isValid=function(zb){return Array.contains(C.rxh,zb.Position)?!0:(J.ULS.shipAssertTag(537159826,0,!1,"FillGradientStopExtension.IsValid: unexpected position value [{0}]",zb.Position),
!1)};C.rxh=[0,.5,1];Object(u.a)(C,"FillGradientStopExtension",null,[]);Object(u.a)(x,"GradientLine",null,[]);y.isValid=function(zb){if(!(zb.Degree.toString()in y.pxh))return J.ULS.shipAssertTag(537159829,0,!1,"FillGradientExtension.IsValid: unexpected degree value [{0}]",zb.Degree),!1;if(!zb.GradientStops)return J.ULS.shipAssertTag(537159828,0,!1,"FillGradientExtension.IsValid: no gradient stops"),!1;if(zb.GradientStops.length<y.oAi||zb.GradientStops.length>y.Yyi)return J.ULS.shipAssertTag(537159827,
0,!1,"FillGradientExtension.IsValid: unexpected number of gradient stops [{0}]",zb.GradientStops.length),!1;zb=ak(zb.GradientStops);for(var ma=zb.next();!ma.done;ma=zb.next())if(!C.isValid(ma.value))return!1;return!0};y.oAi=2;y.Yyi=3;var ba={};y.pxh=(ba["0"]=new x(0,0,1,0),ba["180"]=new x(1,0,0,0),ba["90"]=new x(0,0,0,1),ba["270"]=new x(0,1,0,0),ba["45"]=new x(0,0,1,1),ba["225"]=new x(1,1,0,0),ba["135"]=new x(1,0,0,1),ba["315"]=new x(0,1,1,0),ba);Object(u.a)(y,"FillGradientExtension",null,[]);ba=
b(400);var sa=b(133),ya=b(98),va=b(95),W=b(134),La=ba.a;Rk(z,La);z.prototype.nO=function(zb,ma){if(1===zb){var P=ea.v(this.tCb,this.$);ta.g(this.$).hg(P,null,null,null,0,va.a.$Cj)}P={};P=(P.DialogButton=zb,P.Location="dialog",P);W.b(this.$).Cd(sa.a.bDj,P,null,!0);La.prototype.nO.call(this,zb,ma)};z.prototype.rr=function(){La.prototype.rr.call(this);var zb=this.YCj();this.Rb=1;this.mc(1,Ea.a.instance.ga(2211));this.nl(Ea.a.instance.ga(2212),ya.a.rh(zb),1,this.C0)};z.prototype.YCj=function(){return String.format(Ea.a.instance.lb(170),
this.tCb.toString())};z.prototype.Jbd=function(){var zb=this.error.Description.split("_");return new H.Range(Number.parseInvariant(zb[1])+1,Number.parseInvariant(zb[2])+1,Number.parseInvariant(zb[3])+1,Number.parseInvariant(zb[4])+1,!0,!1)};Af.Object.defineProperties(z.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"SortMergedCellsErrorDialog"}}});Object(u.a)(z,"SortMergedCellsErrorDialog",ba.a,[]);var Ia=b(67),mb=b(639),fb=b(706),Ma=ab.a;Rk(n,Ma);n.prototype.dispose=function(){this.Ofc||
(this.Ofc=!0,this.s1b(),this.u6=null,Qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5963270_DialogMergeSuspension")&&(this.Pbb.dispose(),this.Pbb=null));Ma.prototype.dispose.call(this)};n.prototype.iFh=function(zb){var ma=this;return function(P){if(wa.b(P,-901005882))Ia.a(ma.$).fd.hJ(-901005882),ma.$Ed();else if(wa.b(P,-569193796))Ia.a(ma.$).fd.hJ(-569193796),ma.hide(),new z(ma.$,P.Errors[0]);else if(wa.a(P))J.ULS.sendTraceTag(529105665,0,10,"CustomSortDialog.GenerateGetSortInfoSuccessCallback: GetSortInfo result contains non-status messages"),
ma.hide();else{P=P.Result;ma.$.Oj(P.SortRange);var oa=Qa.EwaSettings.isChangeGateEnabled("OfficeVSO:4545720_FixingSharedSortInfoResultExtension");P&&B(P)&&A(P)&&v(P,oa)?zb(P):ma.w6b(n.Uqb())}}};n.prototype.UFh=function(zb,ma){var P=this;return function(oa,Ja){if(P.Ofc)J.ULS.sendTraceTag(529105635,0,50,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: response was received after dialog is disposed");else if(!oa||wa.a(oa))J.ULS.sendTraceTag(529105634,0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: Unexpected error: {0}",
ia.a.Dc(oa.Errors)),P.$.ea.kp(oa.Errors),P.hide();else{oa=oa.Result;var $a=zb.RangeType,Ta=zb.HeaderRowSize,pa=zb.SortTopToBottom;oa&&E(oa,zb.ConditionType)&&G(oa,$a,Ta,pa)?(oa.ColumnInfo.ColumnOffset=Ja,void 0!==oa.HeaderColumnInfo&&null!==oa.HeaderColumnInfo&&(oa.HeaderColumnInfo.ColumnOffset=Ja),ma(oa,zb.ConditionType,zb.SortTopToBottom)):(J.ULS.sendTraceTag(529105633,0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: sortConditionColorsOrIconsResult is not valid"),P.w6b(n.Uqb()))}}};
n.prototype.cxj=function(zb){return!!this.namedSheetViewPublic&&(0===zb||3===zb)};n.prototype.z6g=function(zb){var ma={};ma.SelectedRange=this.selectedRange;ma.ActiveCell=this.Loc;ma.SortInfoMode=zb;ma.ExpandSortSelection=this.UTg;ma.ExpandSortSelectionSupported=!0;return ma};n.prototype.Zsa=function(zb){var ma={};ma[Ka.a.Yv]=this.nc;ma.fromAutoFilter=zb.FromAutoFilter;ma.gridRTL=ta.g(this.$).rtl;ma.activeCell=zb.ActiveCell;ma.selectedRange=zb.SelectedRange;ma.invokeGetSortInfo=this.odi;ma.invokeGetSortConditionColorsOrIcons=
this.ndi;ma.highlightSortRange=this.A6h;ma.getColorName=this.getColorName;return ma};n.prototype.yoa=function(zb,ma){zb=ea.D(zb);this.ha.sa.Vc.equals(zb)||this.ha.updateSelection(zb,ea.C(ma),0,void 0,void 0,void 0,!0)};n.prototype.$Ed=function(){var zb=this;(new I(function(ma){var P={};P.ActiveCell=zb.Loc;P.SelectedRange=zb.selectedRange;P.ExpandSelection=ma;P.FromAutoFilter=!1;ma={};zb.$.Fd(-207540907,Q.a.Cb,8,(ma.SortCommandData=P,ma))})).show()};n.prototype.s1b=function(){if(void 0!==this.u6&&
null!==this.u6)for(var zb=ak(this.u6),ma=zb.next();!ma.done;ma=zb.next())this.$.oa.xa.yeb(ma.value.Ht)};n.mKf=function(zb,ma){var P={};zb.Fd(1659552324,Q.a.Cb,8,(P.CustomSortCommandData=ma,P))};n.Uqb=function(){return ia.a.Wc(1,0,26,0,1,-1517197771,"CustomSortValidationError")};Af.Object.defineProperties(n.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"CustomSortDialog"}},ha:{configurable:!0,enumerable:!0,get:function(){return ta.g(this.$).ha}}});Object(u.a)(n,"CustomSortDialog",
ab.a,[]);var Hb=b(1279);w.prototype.getSelection=function(){return this.selection};Object(u.a)(w,"MacroRecorderRangeAutoFilterClearedPayload",null,[409]);Object(u.a)(f,"MacroRecorderRangeFilterReappliedPayload",null,[409]);var Kb=b(61),Ub=b(983),gb=b(984),Db=b(112),Va=b(58),yb=b(1280),qb=b(203),dc=b(36),bb=b(355),db=b(64);k.prototype.Lc=function(zb,ma){return!this.Apd(zb,ma)};k.prototype.executeCommand=function(zb,ma,P){var oa=null;zb=ma.command;switch(zb){case -864298118:oa=this.Kgh(ma,P);break;
case -1010737776:oa=this.l6c(!0,ma,P);break;case 2123420468:oa=this.l6c(!1,ma,P);break;case -1089513346:P=this.CXe(P);if(!this.Tzb([ea.D(P.SortOptions.SelectedRange)]))return K.TaskExtensions.jk();oa=this.eIe(ma,P);break;case -1032691499:case -764711886:case -2016161444:oa=this.Y1i(ma,P);break;case -207540907:case -1677817820:oa=this.gridView.Ab.c5(this.ha().sa.activeCell)?this.P1i():this.M1i(ma,P);break;case 1659552324:oa=this.eIe(ma,this.CXe(P));break;case 368460465:oa=this.$gh(ma,P);break;case 529856798:oa=
this.Fgh(ma);break;case 644342024:oa=this.Vgh(ma)}return oa||S.a(zb)};k.prototype.Ac=function(zb,ma){if(zb=1===zb)switch(ma.command){case -864298118:case -1010737776:case 2123420468:case -1089513346:case -207540907:case -1677817820:case 1659552324:case 368460465:case 529856798:case 644342024:break;case -1032691499:case -764711886:case -2016161444:zb=Qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PutSelectedItemOnTop",!1);break;default:zb=!1}return zb};k.prototype.Qc=function(){return!1};
k.prototype.ha=function(){return this.$&&this.gridView?this.gridView.ha:null};k.prototype.iNf=function(zb){zb?this.gridView.Ft(this.onContentReady):this.gridView.Fw(this.onContentReady);this.tbf=zb};k.prototype.hyj=function(zb){return!!this.sortOptions&&da.a.equals(this.ejf,zb.cia,!0)};k.prototype.Apd=function(zb,ma){var P=ta.g(this.$).ha.sa.selectedRanges;return(new ha.a(this.$.va)).Bm(zb,ma,P,this.gridView)};k.prototype.l6c=function(zb,ma,P){var oa=new O.a;Qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6496842_createDefaultSortOptions")?
this.M9e(oa,P,zb):(oa.OperationType=0,oa.IsAscending=zb,oa.HasHeader=!0,oa.GuessHeader=!0,oa.SortTopToBottom=!0,oa.ExpandSortSelectionSupported=!0,P&&void 0!==P[k.Mna]&&null!==P[k.Mna]?(P=P[k.Mna],oa.ActiveCell=P.ActiveCell,oa.SelectedRange=P.SelectedRange,oa.ExpandSortSelection=P.ExpandSelection):(oa.ActiveCell=ea.o(this.sa.activeCell,this.$),oa.SelectedRange=ea.v(this.sa.Vc,this.$),oa.ExpandSortSelection=null));return this.Tzb([ea.D(oa.SelectedRange)])?this.gridView.Ab.c5(ea.D(oa.SelectedRange))?
this.Sgh(zb):this.Hld(oa,ma):K.TaskExtensions.jk()};k.prototype.Kgh=function(zb,ma){J.ULS.shipAssertTag(520901652,0,!1,"SortCommandHandler.doDefaultSort: using default sort");var P=null,oa=this.ha();oa&&(this.hyj(oa)?this.Tzb(oa.sa.selectedRanges)&&(this.sortOptions.IsAscending=!this.sortOptions.IsAscending,P=this.Hld(this.sortOptions,zb)):P=this.l6c(!0,zb,ma));return P};k.prototype.Tzb=function(zb){return Qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6516289_SheetProtectionSettings")&&(Qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")||
this.$.isEditMode)?this.$.isEditMode?this.$.kq(zb,!0,1):this.$.rWc(zb,!0,1):!0};k.prototype.Sgh=function(zb){this.GTh(zb);return Va.Task.Ua(!0)};k.prototype.EQg=function(zb){if(Qa.EwaSettings.isChangeGateEnabled("OfficeVSO:4112173_MacroRecorderTableSortOnRange")){var ma=this.gridView.Ab.dk(this.sa.Vc,!1);if(ma)return new Z.a(ma.name,this.sa.activeCell.left-ma.usedRange.left,zb.IsAscending)}return new X.a(zb)};k.prototype.Hld=function(zb,ma){function P(){return oa.EQg(zb)}var oa=this;this.gridView.ig.IG(!1);
return this.B7c(function(Ja,$a,Ta){return m(oa.$.oa.xa,zb,xa.b(Ja,oa.VFh(ma)),$a,Ta,zb)},function(Ja){return new qa.a(141,0,Ja,void 0,P)},ma,this.bxj(zb))};k.prototype.bxj=function(zb){if(!this.namedSheetViewPublic)return!1;var ma=this.sa.Vc,P=ea.v(this.sa.Vc,this.$),oa=this.gridView.Ab.kMa(ma,!0),Ja=this.sa.Eba()&&this.gridView.Ab.iff(P),$a=this.gridView.Ab.Pki(P);zb=(ma.l5||ma.b_)&&!ma.isSingle&&(null==zb.ExpandSortSelection?!1:zb.ExpandSortSelection)&&this.gridView.Ab.iff(P);return oa||Ja||$a||
zb};k.prototype.P1i=function(){return this.$.Fd(-1556797033,Q.a.Cb,8,null)};k.prototype.M1i=function(zb,ma){zb=8===zb.Me&&ma&&void 0!==ma[k.Mna]&&null!==ma[k.Mna]?ma[k.Mna]:19===zb.Me&&ma&&void 0!==ma[Q.a.Vf]&&null!==ma[Q.a.Vf]?ca.a.Vh(ma[Q.a.Vf]):this.C5g();if(!this.Tzb([ea.D(zb.SelectedRange)]))return K.TaskExtensions.jk();ta.g(this.$).ig.IG(!1);var P=null;(ma=ma.TopCellAddress)&&(P=ea.o(ma,this.$));new n(this.$,zb,this.namedSheetViewPublic,P);return Va.Task.Ua(!0)};k.prototype.CXe=function(zb){return zb[k.Kah]};
k.prototype.eIe=function(zb,ma){function P(Da){return new qa.a(187,0,Da,void 0,oa)}function oa(){return new U(ma.SortOptions)}function Ja(Da,rb,Ab){return m(pa.$.oa.xa,ma.SortOptions,xa.b(Da,Ta),xa.a(rb,$a),Ab,pa.sortOptions)}function $a(){ma.ShouldRestoreSelection&&pa.yoa(ma.SelectedRange,ma.OriginalActiveCell);J.ULS.sendTraceTag(537151575,0,10,"SortCommandHandler.DoCustomSort.onSortFailedCallback: Custom Sort failed. Called from: {0}",zb.Me)}function Ta(Da){Qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5899794_MergedCellsErrorFix")&&
pa.i6e(Da)?pa.W4e(Da.Errors[0]):(ma.ShouldRestoreSelection&&pa.yoa(ma.SelectedRange,ma.OriginalActiveCell),J.ULS.sendTraceTag(537151576,0,50,"SortCommandHandler.DoCustomSort.onSortSuccessCallback: Custom Sort succeeded. Called from: {0}",zb.Me),pa.eMj(ma))}var pa=this;return Qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures")?this.B7c(Ja,P,null,ma.ShouldPromptNamedSheetViewTeachingDialog):Y.a(this.$.userOperationManager,Ja,P,null)};k.prototype.yoa=function(zb,
ma){zb=ea.D(zb);ta.g(this.$).ha.sa.Vc.equals(zb)||ta.g(this.$).ha.updateSelection(zb,ea.C(ma),0,void 0,void 0,void 0,!0)};k.prototype.C5g=function(){var zb={};zb.ActiveCell=ea.o(this.sa.activeCell,this.$);zb.SelectedRange=ea.v(this.sa.Vc,this.$);zb.FromAutoFilter=!1;zb.ExpandSelection=null;return zb};k.prototype.$gh=function(zb,ma){function P(){return new Hb.a(Ja)}var oa=this,Ja=this.Eaa();if(!Ja)return Va.Task.Ua(!1);var $a=this.$.oa.xa.Pb();return Qa.EwaSettings.Zb()?Y.a(this.$.userOperationManager,
function(Ta,pa,Da){return fa.A(oa.$.oa.xa,Ja,xa.b(Ub.a.nva(Db.a.uZa,gb.a.toggleAutoFilter,Ta),oa.nTi),pa,Da,{selection:Ja,hKj:ma.On},$a)},function(Ta){return new qa.a(516,0,Ta,64,P)},zb):Y.a(this.$.userOperationManager,function(Ta,pa,Da){return fa.A(oa.$.oa.xa,Ja,Ub.a.nva(Db.a.uZa,gb.a.toggleAutoFilter,Ta),pa,Da,null,$a)},function(Ta){return new ka.a(516,0,Ta,void 0,P)},zb)};k.prototype.Fgh=function(zb){function ma(){return new w(oa)}var P=this,oa=this.Eaa();if(!oa)return Va.Task.Ua(!1);var Ja=this.gridView.Ab.dk(this.sa.Vc,
!0);Ja&&J.ULS.sendTraceTag(537151574,0,50,"DoClearAutoFilter for namedObject: Type : {0}",Ja.type.toString());var $a=this.$.oa.xa.Pb();Ja=Qa.EwaSettings.Zb()?function(Ta){return new qa.a(517,0,Ta,64,ma)}:function(Ta){return new ka.a(517,0,Ta,void 0,ma)};return this.B7c(function(Ta,pa,Da){var rb=P.$.oa.xa;Ta=Ub.a.nva(Db.a.$ra,gb.a.clearAutoFilter,Ta);var Ab=rb.Na(41,void 0===$a?null:$a);Ab.selectedRange=oa;return Kb.g(rb,"ClearAutoFilter",Ab,Ta,pa,Da,null,0)},Ja,zb)};k.prototype.B7c=function(zb,ma,
P,oa){var Ja=this;return this.namedSheetViewPublic&&(void 0===oa||oa)?this.namedSheetViewPublic.FAa().continueWith(function($a){$a.result&&Y.a(Ja.$.userOperationManager,zb,ma,P)}):Y.a(this.$.userOperationManager,zb,ma,P)};k.prototype.Vgh=function(zb){function ma(){return new f(oa)}var P=this,oa=this.Eaa();if(!oa)return Va.Task.Ua(!1);var Ja=this.$.oa.xa.Pb();return Qa.EwaSettings.Zb()?Y.a(this.$.userOperationManager,function($a,Ta,pa){return l(P.$.oa.xa,oa,Ub.a.nva(Db.a.$ra,gb.a.MKf,$a),Ta,pa,null,
Ja)},function($a){return new qa.a(518,0,$a,64,ma)},zb):Y.a(this.$.userOperationManager,function($a,Ta,pa){return l(P.$.oa.xa,oa,Ub.a.nva(Db.a.$ra,gb.a.MKf,$a),Ta,pa,null,Ja)},function($a){return new ka.a(518,0,$a,void 0,ma)},zb)};k.prototype.VFh=function(zb){var ma=this;return function(P,oa){var Ja;wa.b(P,-901005882)?(Ia.a(ma.$).fd.hJ(-901005882),ma.$Ed(oa,zb.command)):ma.i6e(P)?ma.W4e(P.Errors[0]):!wa.a(P)&&P.Result&&(ma.sortOptions=oa,ma.dSa=ea.D(P.Result.ActualSortRange),ma.ejf=ma.ha().cia,ma.tbf||
(ma.selectedRange=ma.sa.Vc,ma.selectedRange.equals(ma.dSa)||(Qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")&&(ma.activeCell=ea.o(ma.sa.activeCell,ma.$)),ma.kBj())),(null===(Ja=ma.sortOptions)||void 0===Ja?0:Ja.ActiveCell)&&(!Qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6611537_shouldTriggerPivotTableHandRaise")||ma.b2f(ma.sortOptions))&&(P=ma.sortOptions.ActiveCell,P=new H.Range(P.FirstRow+1,P.FirstColumn+1,P.FirstRow+1,P.FirstColumn+1,!0,!1),
ma.jL(P),ma.mWd(P)))}};k.prototype.i6e=function(zb){return wa.b(zb,-569193796)};k.prototype.W4e=function(zb){Ia.a(this.$).fd.hJ(-569193796);new z(this.$,zb)};k.prototype.$Ed=function(zb,ma){var P=this;(new I(function(oa){var Ja={};Ja.ActiveCell=zb.ActiveCell;Ja.SelectedRange=zb.SelectedRange;Ja.ExpandSelection=oa;oa={};P.$.Fd(ma,Q.a.Cb,8,(oa[k.Mna]=Ja,oa))})).show()};k.prototype.kBj=function(){var zb=this.ha();if(Qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")){var ma=
ea.C(this.activeCell);this.dSa.Ae(ma)||(ma=this.dSa.topLeft);zb.updateSelection(this.dSa,ma,0,void 0,void 0,void 0,!0)}else zb.updateSelection(this.dSa,zb.sa.activeCell,0,void 0,void 0,void 0,!0);this.iNf(!0)};k.prototype.Eaa=function(){var zb=this.ha();if(!zb)return J.ULS.shipAssertTag(537151573,0,!!zb,"SelectionManger is null"),null;this.gridView.ig.IG(!1);return ea.v(zb.sa.Vc,this.$)};k.prototype.eKb=function(){this.rc&&this.rc.Io&&(this.Ee=this.rc.Io,this.rb=this.rc.uac())};k.prototype.GTh=function(zb){var ma=
this;if(this.$.isEditMode&&(this.rc=this.gridView.Ab.To(this.sa.activeCell))){this.activeCell=ea.o(this.sa.activeCell,this.$);if(this.rc&&this.rc.Io){var P=this.rc.Io.CurrentCol;if(this.rc.Io.CurrentRow===this.activeCell.FirstRow&&P===this.activeCell.FirstColumn){this.eKb();this.applyPivotSort(zb);return}}this.$.oa.xa.Pb();P=new qa.a(228,0,function(oa,Ja,$a){return fa.k(ma.$.oa.xa,ma.activeCell,xa.b(oa,ma.QLi),xa.a(Ja,ma.PLi),$a,zb)},16);this.$.userOperationManager.Sb(P,null)}};k.prototype.applyPivotSort=
function(zb){var ma=this;if(this.rc&&this.rb&&this.activeCell&&this.Ee){var P=8===this.Ee.CellArea,oa=1===this.Ee.CellArea||2===this.Ee.CellArea;(P||oa)&&8!==this.Ee.CellType&&4!==this.Ee.CellType&&(P?Y.a(this.$.userOperationManager,function(Ja,$a,Ta){return fa.b(ma.$.oa.xa,ma.activeCell,zb?1:2,ma.rb.Caption,Ja,$a,Ta,null)},function(Ja){return new qa.a(1015,0,Ja,void 0,null)},null):(P=1===this.Ee.CellArea?1:2,this.$.ma(698)?N.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,
this.rc.externalSourceIndex,this.rb.Index.toString(),this.rb.Caption,this.rc.isOlap?"":this.rb.Caption,P,zb):N.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.rc.externalSourceIndex,this.rb.Index.toString(),zb)))}};k.prototype.eMj=function(zb){this.b2f(zb.SortOptions)&&(zb.TopCellAddress?zb=ea.C(zb.TopCellAddress):(zb=zb.OriginalActiveCell,zb=new H.Range(zb.FirstRow+1,zb.FirstColumn+1,zb.FirstRow+1,zb.FirstColumn+1,!0,!1)),this.jL(zb))};k.prototype.jL=function(zb){dc.a.Bba(this.$)&&
K.TaskExtensions.Ba(F.GetServiceTaskFactory.Ra(this.$.da,430,431,1),function(ma){ma.result.iea(zb);J.ULS.sendTraceTag(537151571,306,50,"SortCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.la,3)};k.prototype.mWd=function(zb){Qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",!1)&&K.TaskExtensions.Ba(F.GetServiceTaskFactory.Ra(this.$.da,476,475,0),function(ma){ma.result.mWd(zb,0);J.ULS.sendTraceTag(537151570,0,50,"SortCommandHandler:TriggerProactiveSuggestion Trigger proactive suggestion from sort.")},
this.$.la,3)};k.prototype.Y1i=function(zb,ma){if(!this.Tzb(this.sa.selectedRanges))return K.TaskExtensions.jk();var P=new O.a;this.M9e(P,ma);P.SortConditions=[this.P8g(zb)];P.OperationType=2;return this.Hld(P,zb)};k.prototype.P8g=function(zb){var ma=this.gridView.Ub(this.sa.activeCell),P=new yb.a;P.IsAscending=!0;switch(zb.command){case -1032691499:ma.rwb?(zb=qb.a.Qo(ma.backgroundColor),P.SortColor=zb.nS(!0)):P.SortColor=k.NoColor;P.SortConditionType=1;break;case -764711886:P.SortColor=ma.L0c===k.NoColor?
k.NoColor:qb.a.Qse(ma.L0c);P.SortConditionType=2;break;case -2016161444:ma.zwb?(P.SortIcon=ma.cell.Fic,P.SortIconSet=ma.Gic):(P.SortIcon=k.X_d,P.SortIconSet=k.X_d);P.SortConditionType=3;break;default:J.ULS.debugAssertTag(522723787,0,!1,"SortCommandHandler.createSortConditionsFromSelectedCell: ribbon command didn't match any of the case statements")}return P};k.prototype.iKj=function(zb){K.TaskExtensions.Ba(F.GetServiceTaskFactory.Ra(this.$.da,426,427,1),function(ma){ma.result.jWd(zb,"Filter")},this.$.la,
3)};k.prototype.M9e=function(zb,ma,P){zb.OperationType=0;zb.IsAscending=void 0===P?!0:P;zb.HasHeader=!0;zb.GuessHeader=!0;zb.SortTopToBottom=!0;zb.ExpandSortSelectionSupported=!0;ma&&ma[k.Mna]?(ma=ma[k.Mna],zb.ActiveCell=ma.ActiveCell,zb.SelectedRange=ma.SelectedRange,zb.ExpandSortSelection=ma.ExpandSelection):(zb.ActiveCell=ea.o(this.sa.activeCell,this.$),zb.SelectedRange=ea.v(this.sa.Vc,this.$),zb.ExpandSortSelection=null)};k.prototype.b2f=function(zb){return!zb.SortConditions||zb.SortConditions.some(function(ma){return 0===
ma.SortConditionType})};Af.Object.defineProperties(k.prototype,{sa:{configurable:!0,enumerable:!0,get:function(){return this.ha().sa}}});k.Kah="CustomSortCommandData";k.Mna="SortCommandData";k.X_d=-1;k.NoColor=0;Object(u.a)(k,"SortCommandHandler",null,[403]);var wc=T.a;Rk(e,wc);e.prototype.zd=function(){var zb=this;K.TaskExtensions.Ba(F.GetServiceTaskFactory.Ra(this.$.da,309,310,this.hb),function(ma){zb.jd([new k(zb.$,ma.result)])},this.$.la,3)};e.ka=function(zb){T.a.Qd(160,new e(zb))};Object(u.a)(e,
"SortCommandHandlerFactory",T.a,[]);ab=b(232);d.prototype.Z9g=function(zb,ma){new z(zb,ma)};Object(u.a)(d,"SortUtil",null,[758]);var nb=ab.a;Rk(c,nb);c.prototype.create=function(){var zb=this.$.da.za(446);zb||(zb=new d(this.$),this.$.da.Ga(446,zb));this.pb(zb)};c.ka=function(zb){zb.da.Ga(447,new c(zb))};Object(u.a)(c,"SortUtilFactory",ab.a,[]);b.d(D,"a",function(){return a})},1365:function(u,D,b){function a(){Type.registerNamespace("Common.App.SaveToSharePoint");c.main()}function c(){this.fra=this.eNc=
this.$Mc=this.fb=null}function d(W,La,Ia,mb,fb){this.sm=this.zCa=null;this.tEc=!1;this.SPc=this.D8=null;this.fSc=La;this.Ekb=Ia;this.us=mb;this.Se=fb;this.La=W}function e(W){this.eFa=W.appSettings.SaveAsToHostWebServiceBase;this.jA=W.appSettings.FileName;this.pfa=W.Wa("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}function k(W,La,Ia,mb,fb,Ma,Hb,Kb){this.dFa=W;this.jA=La;this.tVa=mb;this.NOc=Ma;this.D8=Ia;this.owg=fb;this.pfa=Hb;this.Ah=Kb}function l(W,La,Ia,mb){this.Ah=this.Yae=null;this.XEa=
W;this.us=La;this.MNc=Ia;this.Se=mb}function m(W,La,Ia,mb,fb,Ma,Hb){this.ib=W;this.YHc=Ia;this.La=La;this.elb=mb;this.cib=fb;this.MNc=Ma;this.Ilg=Hb}function f(){return ha.call(this)||this}function w(W,La,Ia,mb){var fb=this;this.Co=this.ekb=null;this.cib=W;this.Se=Ia;this.Btg=mb;this.rDa=new x.a(function(){return new Z.a(La.value,Object(U.a)(fb,fb.qvb,"getMoreInfoEventReceived"))})}function n(W,La,Ia,mb,fb,Ma,Hb,Kb,Ub,gb){this.La=La;this.ib=W;this.yX=mb;this.rga=Ma;this.us=fb;this.Se=Ia;this.Ree=
Hb;this.Lrg=void 0===Kb?null:Kb;this.XEa=void 0===Ub?null:Ub;this.lXa=void 0===gb?null:gb}function z(W,La,Ia,mb,fb,Ma,Hb,Kb,Ub){this.dMc=null;this.jA="";this.elb=W;this.us=La;this.Ah=Ub;this.rga=Ia;this.Se=fb;this.zv=mb;this.XEa=Hb;this.lXa=Kb;Ma&&(this.dMc=new x.a(function(){return new Z.a(Ma.value,null)}))}function r(){this.properties=this.friendlyPath=this.folderName=null}function v(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}function A(W,
La,Ia,mb,fb,Ma,Hb,Kb){W=H.call(this,W,La,Ia,mb,fb,Ma,Kb)||this;W.Gy=null;W.WPc=null;W.Xpa=null;W.nSg=CommonUIStrings.l_SaveToAnotherFolder;W.Wf=B.Wf;W.ze="FileNameDialog-SaveToSharePoint";W.elb=Hb;W.ftg=Kb;return W}function B(){}function y(){var W=I.call(this)||this;W.Rb=0;W.mc(1,CommonUIStrings.l_DialogClose);return W}u=b(0);var x=b(615),C=b(15),G=b(135),E=b(52),I=G.StandardDialog;Rk(y,I);y.prototype.displayError=function(W,La){this.LHe(W,La,E.a.qjj)};y.prototype.LHe=function(W,La,Ia){C.ULS.sendTraceTag(25180161,
216,10,"Show upload error dialog with error code {0}.",Ia);this.Oz(Ia,W,La,null)};y.prototype.$5c=function(W,La){C.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.Oz(E.a.sjj,W,La,null,!0)};Object(u.a)(y,"ErrorDialog",G.StandardDialog,[208]);var U=b(83);G=b(1258);var M=b(150);Af.Object.defineProperties(B,{Wf:{configurable:!0,enumerable:!0,get:function(){return M.a.Po(B.rk,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,
"")}}});B.rk="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(u.a)(B,"FileNameDialogHtml",null,[]);var T=b(4),F=b(13),K=b(43),J=b(86),O=b(89),N=b(30),H=G.a;Rk(A,H);A.prototype.dQ=function(W){var La=N.a.qq(T.AFrameworkApplication.am.Qm),Ia=T.AFrameworkApplication.breadcrumbFolderName,mb=T.AFrameworkApplication.breadcrumbBrandName,fb={};fb=(fb.txtFileName=W||La,fb);var Ma=CommonUIStrings.L_SaveAs;2===T.AFrameworkApplication.ta.Pa.Fj&&(Ma=CommonUIStrings.L_SaveACopy);this.initializeAndShow(Ma,Object(U.a)(this,this.h9b,"fileNameDialogHandler"),fb);this.sHe(W,
La);this.dIa.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");T.AFrameworkApplication.fa.ra("HideSaveToAnotherFolderButtonforUIHost")||(this.Gy=document.getElementById("anotherFolder"),W=document.getElementById("folderLocation"),this.WPc=O.a.Mpe(W,this.Gy,"anotherFolderDescribedBy"),this.Gy.className="WACButton WACDialogButtonNormal",W=!1,Ia&&Ia.length?(this.nke(this.Gy,this.WPc,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,
mb,Ia)),W=this.jAg(mb,Ia)):this.nke(this.Gy,this.WPc,CommonUIStrings.l_CurrentOnlineFolder),this.gBg(this.Gy),this.lAg(this.Gy),W?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.Gy,"SaveToAnotherLocationTwo"),C.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.Gy,"SaveToAnotherLocationOne"),K.a.addHandler(this.Gy,F.a.click,Object(U.a)(this,this.JAd,"onSaveToAnotherLocationClick")),
K.a.addHandler(this.Gy,F.a.Lb,Object(U.a)(this,this.jBf,"onSaveToAnotherLocationKeyDown")))};A.prototype.jAg=function(W,La){var Ia=!1;var mb=document.getElementById("currentLocation");mb.innerText="";var fb=this.h_e(mb,W),Ma=this.h_e(mb,La),Hb=255,Kb=255;255<fb+Ma&&(Hb=Math.max(238,408-fb),Kb=Math.max(170,408-Ma),Ia=!0);this.ECg(mb,W,Kb,La,Hb);return Ia};A.prototype.h_e=function(W,La){var Ia=document.createElement("div");Ia.innerText=La;Ia.style.visibility="hidden";W.appendChild(Ia);La=Ia.clientWidth;
W.removeChild(Ia);return La};A.prototype.ECg=function(W,La,Ia,mb,fb){La&&(this.lke(W,La,Ia),this.wCg(W));mb&&this.lke(W,mb,fb)};A.prototype.lke=function(W,La,Ia){var mb=document.createElement("div");mb.innerText=La;mb.title=La;mb.className="SaveToAnotherFolderBreadcrumb";mb.style.maxWidth=Ia.toString()+"px";W.appendChild(mb)};A.prototype.wCg=function(W){var La=document.createElement("span");La.id="FolderSeparator";var Ia=document.createElementNS("http://www.w3.org/2000/svg","svg");Ia.setAttribute("class",
"SeparatorCaret");var mb=document.createElementNS("http://www.w3.org/2000/svg","polygon");mb.setAttribute("points","1 4 1 11 5 7.5");Ia.appendChild(mb);La.appendChild(Ia);W.appendChild(La)};A.prototype.nke=function(W,La,Ia){Ia=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,Ia);La&&(La.innerText=Ia);W.tabIndex=0;W.setAttribute(O.a.Hd,O.a.Hs)};A.prototype.lAg=function(W){var La=document.createElement("span");La.id="anotherFolderText";La.innerText=this.nSg;La.className="AnotherFolderTextSpan";
W.appendChild(La)};A.prototype.gBg=function(W){var La=document.createElement("span");La.className="cui-img-cont-float cui-img-16by16 ";this.Xpa=document.createElementNS("http://www.w3.org/2000/svg","svg");this.Xpa.setAttribute("class","FolderIconSVG");var Ia=document.createElementNS("http://www.w3.org/2000/svg","path");Ia.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.Xpa.appendChild(Ia);La.appendChild(this.Xpa);
W.appendChild(La)};A.prototype.jBf=function(W){!W||W.keyCode!==J.a.Rh&&W.keyCode!==J.a.X0||this.JAd(W)};A.prototype.JAd=function(){if(this.MI){var W=N.a.b4(T.AFrameworkApplication.fileName),La=this.MI.value;this.hide();La&&""!==La&&""!==W||1===this.ta.state?(""!==W&&(La+=W),this.i9b(La)?this.us.create().displayError(1,La,!1):this.elb.start(La,this.ftg)):this.us.create().displayError(2,La,!1)}};A.prototype.WVg=function(W){this.Gy&&this.Xpa&&(W?(this.Gy.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.Gy,
"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.Xpa,"DisabledFolderIconSVG")):(this.Gy.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.Gy,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.Xpa,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.Gy,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.Xpa,"DisabledFolderIconSVG"))))};A.prototype.phd=function(){H.prototype.phd.call(this);this.WVg(!!this.MI&&""!==this.MI.value)};A.prototype.dispose=function(){this.Gy&&
(K.a.removeHandler(this.Gy,F.a.click,Object(U.a)(this,this.JAd,"onSaveToAnotherLocationClick")),K.a.removeHandler(this.Gy,F.a.Lb,Object(U.a)(this,this.jBf,"onSaveToAnotherLocationKeyDown")),this.Gy=null);H.prototype.dispose.call(this)};Object(u.a)(A,"FileNameDialog",G.a,[227]);var Q=b(894),ca=b(616),X=b(202),Z=b(1019),ea=b(1114),ka=b(99),Y=b(136);Object(u.a)(v,"SaveAsDialogInput",null,[]);Object(u.a)(r,"SaveLocation",null,[]);var qa=b(392),fa=b(190);z.prototype.HLh=function(){var W=new Q.a(ca.a.Jk());
W.ia("type","currentHost");return Object.assign(new r,{folderName:this.zv.breadcrumbFolderName,friendlyPath:this.zv.breadcrumbBrandName,properties:W})};z.prototype.vmi=function(W){return!!W&&"ClassicMru"===W.type&&!!W.service_info&&!!W.service_info.service_id&&-1!==W.service_info.service_id.indexOf("SHAREPOINT")};z.prototype.aXh=function(){if(!this.dMc||!this.XEa)return null;var W=this.dMc.value.yZ("SaveAsToSharePointDialog",!1);if(!W||3!==W.state||!W.gqf)return null;W=W.gqf;for(var La=new X.a,Ia=
0,mb=0,fb=0;fb<W.length;fb++){var Ma=W[fb];if(this.vmi(Ma)&&(Ia++,Ma.sharepoint_info)){var Hb=Ma.url,Kb=Ma.sharepoint_info.site_url,Ub=Ma.title;Ma=ea.b(Ma,T.AFrameworkApplication.isRtl);if(Hb&&Kb&&Ub&&Ma){mb++;var gb=new Q.a(ca.a.Jk());gb.ia("type","SharePoint");gb.ia("siteUrl",Kb);gb.ia("folderUrl",Hb);mb++;La.add(Object.assign(new r,{folderName:Ub,friendlyPath:Ma,properties:gb}))}}}fb=new Map;fb.set("NumPlaces",W.length.toString());fb.set("NumSharepointPlaces",Ia.toString());fb.set("placesWithMetadata",
mb.toString());ka.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",fb);0<Ia&&(mb?.5>1*mb/Ia&&ka.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):ka.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return La};z.prototype.yMh=function(){var W=new X.a;W.add(this.HLh());var La=this.aXh();La&&W.addRange(La);return Object.assign(new v,{enableMoreLocations:!T.AFrameworkApplication.fa.ra("HideSaveToAnotherFolderButtonforUIHost"),
fileName:this.jA,extension:N.a.b4(this.zv.Qm),saveLocations:W.toArray(),scenario:"SaveToSharePoint"})};z.prototype.yac=function(){return{inputPropsCallback:Object(U.a)(this,this.yMh,"getDialogInput")}};z.prototype.dQ=function(W){this.jA=W;this.jA||(this.jA=String.format(CommonUIStrings.l_SaveACopy_Filename,N.a.qq(this.zv.Qm)));W={};W=(W.id="SaveAsDialog",W.bodyControls=this.yac(),W);var La=CommonUIStrings.L_SaveAs;2===this.Se.Pa.Fj&&(La=CommonUIStrings.L_SaveACopy);var Ia=new M.a(!1,!1,!0);Ia.Rb=
1;Ia.ze="SaveAsDialog";Ia.mc(1,CommonUIStrings.l_SaveButtonLabel);Ia.initializeAndShow(La,Object(U.a)(this,this.mjj,"saveAsDialogHandler"),W)};z.prototype.lAj=function(W,La){W&&""!==W&&""!==La||1===this.Se.state?this.umi()?this.Zsi(W,La):(""!==La&&(W+=La),this.elb.start(W,this.Ah)):(C.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.us.create().displayError(2,W,!1))};z.prototype.Zsi=function(W,La){var Ia=this;ka.Health.instance.recordKpiUsage("SaveACopySFP",
0,"smartfio",null);var mb=this.lXa.XCe(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,null,"SaveACopy",2);this.lXa.sdd(mb).then(function(fb){if(fb&&0<fb.length){var Ma=fb[0][qa.a.VXi];fb=fb[0][qa.a.UFf];if(""!==Ma&&""!==fb)Ia.XEa.Ona(fb,W+La,Ma,Ia.Ah),ka.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{Ia.us.create().displayError(0,W,!1);var Hb=Y.a.Fr();Hb&&(Hb.set("SiteUrlAvailable",""===Ma?"false":"true"),Hb.set("FolderUrlAvailable",""===fb?"false":
"true"));ka.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new fa.a,{extendedProperties:Hb}))}}else Ia.us.create().displayError(0,W,!1),ka.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(function(fb){"Canceled"===fb?((fb=Y.a.Fr())&&fb.set("IsCanceled","true"),ka.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new fa.a,{extendedProperties:fb}))):ka.Health.instance.recordKpiFailure("SaveACopySFP",
fb,!1,!1,null)})};z.prototype.umi=function(){return this.lXa?this.lXa.Vpd():(C.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)};z.prototype.mjj=function(W,La){if(La&&1===W){W=La.fileName;var Ia=N.a.b4(this.zv.Qm);La.moreLocationsSelected&&this.lAj(W,Ia);if(La.locationCallback){var mb=La.locationCallback();mb?mb.properties&&"currentHost"===mb.properties.na("type")?this.rga.Ona(W+Ia,!1,this.Ah):mb.properties&&"SharePoint"===mb.properties.na("type")?(La=mb.properties.na("siteUrl"),
mb=mb.properties.na("folderUrl"),this.XEa.Ona(mb,W+Ia,La,this.Ah)):C.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):C.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else C.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}};Object(u.a)(z,"ReactSaveAsDialog",null,[227]);n.prototype.create=function(W){return this.Se&&this.Se.Pa.Wu?new z(this.Ree,this.us,this.rga,T.AFrameworkApplication.am,this.Se,this.Lrg,this.XEa,this.lXa,W):new A(this.ib,this.La,
this.Se,this.yX,this.us,this.rga,this.Ree,W)};Object(u.a)(n,"FileNameDialogFactory",null,[209]);w.prototype.start=function(W){var La=this;if(!this.QDf)if(T.AFrameworkApplication.breadcrumbFolderUrl&&T.AFrameworkApplication.breadcrumbFolderUrl.length)this.ekb=T.AFrameworkApplication.breadcrumbFolderUrl;else return C.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.Co),!1;
var Ia=this.Btg();Ia.FAj();var mb=Ia.ATh();if(!mb)return C.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.cib.start(function(fb,Ma){Ia.hide();W(fb,Ma)},function(){La.hOa(Ia)},mb,this.ekb);return!0};w.prototype.hOa=function(W){W.hide();C.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")};w.prototype.USh=function(W){W=W.toLowerCase();W.endsWith("/")||(W+="/");var La=W.indexOf("/documents/");return-1!==La?W.substring(0,La+1)+"_layouts/15/onedrive.aspx":
""};w.prototype.qvb=function(W){this.Co||3!==W.state||(this.Co=W)};Af.Object.defineProperties(w.prototype,{QDf:{configurable:!0,enumerable:!0,get:function(){this.ekb||(this.rDa.value.yZ("Save As",!0),this.Co&&this.Co.wR&&this.Co.wR.length&&(this.ekb=this.USh(this.Co.wR)));return this.ekb}}});Object(u.a)(w,"OneDriveFilePickerHelper",null,[211]);var ha=M.a;Rk(f,ha);f.prototype.FAj=function(){this.NGc="FilePickerDialog";this.Wf="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.ze="PickerDialog-MsoSp";
this.showDialog("",null)};f.prototype.ATh=function(){return document.getElementById("FilePickerDiv")};f.prototype.lO=function(){};f.prototype.wPa=function(){};Object(u.a)(f,"PickerDialog",M.a,[210]);var ia=b(739),wa=b(1046),Qa=b(393),S=b(25),da=b(107),xa=b(27);m.prototype.Cg=function(){var W=this,La=this.cib.M3a();La?S.a.iB||this.ib.ra("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.La.Ie(xa.a.saveToSharePoint,da.a.frame,Object(U.a)(this,this.bVf,"saveToSharePointActionDispatcher"),64):(La.O7a.continueWith(function(Ia){Ia.Yf&&
W.cib.Wzd(Ia)}),this.g1b()):C.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")};m.prototype.g1b=function(){Qa.a.bHd(Object(U.a)(this,this.bVf,"saveToSharePointActionDispatcher"));Qa.a.A7c([new wa.a(xa.a.saveToSharePoint,da.a.frame,0)],this.cib.M3a())};m.prototype.bVf=function(W,La,Ia,mb,fb){return La.contextId!==da.a.frame||W!==xa.a.saveToSharePoint?2:this.$6a&&(this.MNc.QDf||this.Gve)?1===Ia?ia.SessionStatusManager.instance.wwb||T.AFrameworkApplication.X4?
8:this.Ilg()?32:8:2===Ia?(C.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(fb&&fb.SaveEntryPoint&&"VersionHistory"===fb.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.Gve?(C.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.YHc.create(fb).dQ(null)):(C.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),this.elb.start(null,fb)),32):8:8};Af.Object.defineProperties(m.prototype,
{$6a:{configurable:!0,enumerable:!0,get:function(){return this.ib.ra("SaveToAnotherFolderBrsIsEnabled")}},Gve:{configurable:!0,enumerable:!0,get:function(){return this.ib.ra("UserCanWriteRelative")}}});Object(u.a)(m,"SaveToSharePointActor",null,[]);l.prototype.start=function(W,La){var Ia=this;C.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.Yae=W;this.Ah=La;this.MNc.start(function(mb,fb){Ia.u1i(mb,fb)})||this.xRd()};l.prototype.u1i=function(W,La){if(W)this.onSuccess(La);else this.c6(La)};
l.prototype.xRd=function(){1!==this.Se.state&&this.us().$5c(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)};l.prototype.onSuccess=function(W){C.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(W&&W.data&&W.data.value&&W.data.value.length&&W.data.value[0].sharePoint){var La=W.data.value[0].sharePoint.url;W=W.data.value[0].sharePoint.listUrl;var Ia=null;if(La&&(Ia=W?this.wXh(W):this.vXh(La))){this.XEa.Ona(La,
this.Yae,Ia,this.Ah);return}C.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!La,!Ia)}C.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.xRd()};l.prototype.vXh=function(W){W.endsWith("/")||(W+="/");for(var La=0,Ia=0;Ia<W.length;Ia++)if("/"===W.charAt(Ia)&&5===++La)return W.substr(0,Ia);return null};l.prototype.wXh=function(W){W.endsWith("/")&&(W=W.substring(0,W.length-1));var La=W.lastIndexOf("/");
return-1!==La?W.substring(0,La):null};l.prototype.c6=function(W){C.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");W&&W.error?C.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",W.error.errorCode,W.error.message):C.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.xRd()};Object(u.a)(l,"SaveToSharePointManager",null,[791]);var ta=b(81);k.prototype.execute=function(W,La){if(!T.AFrameworkApplication.Bg&&T.AFrameworkApplication.qd){var Ia=
this.dFa+this.pfa;Ia=ta.a.vl(Ia,"fu",N.a.$e(this.D8));Ia=ta.a.vl(Ia,"su",N.a.$e(this.owg));Ia=ta.a.vl(Ia,"fn",N.a.$e(this.jA));Ia=ta.a.vl(Ia,"n",N.a.$e((new Date).getTime().toString()));this.Ah&&this.Ah.FileDownloadUrl&&(Ia=ta.a.vl(Ia,"furl",N.a.$e(this.Ah.FileDownloadUrl)));Ia=Ia+"&"+this.NOc;this.tVa&&this.tVa.length?Ia=ta.a.vl(Ia,"fnn",N.a.$e(this.tVa)):C.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");C.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");
T.AFrameworkApplication.qd.Yl(Ia,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,W,La,null,void 0,void 0,void 0,void 0,"9")}};Object(u.a)(k,"SharePointSaveAsCaller",null,[800]);e.prototype.create=function(W,La,Ia,mb){return new k(this.eFa,this.jA,W,La,Ia,T.AFrameworkApplication.aj,this.pfa,mb)};Object(u.a)(e,"SharePointUploadCallerFactory",null,[790]);var ab=b(41),Na=b(39),Ka=b(247),la=b(897),Ea=b(170),ra=b(740),na=b(977);d.prototype.Ona=function(W,La,Ia,mb){this.tEc=!1;C.ULS.sendTraceTag(23881921,
216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.ILb();this.D8=W;mb&&mb.SaveEntryPoint&&(this.SPc=mb.SaveEntryPoint);this.zCa=this.fSc.create(W,La,Ia,mb);mb&&"true"===mb.SkipSaveToHost?this.mQ():this.LCh()};d.prototype.LCh=function(){function W(){C.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");La.mQ()}var La=this;32!==this.La.ae(xa.a.FQa,2,[function(){C.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");
La.mQ()},W])&&W()};d.prototype.mQ=function(){C.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.zCa.execute(Object(U.a)(this,this.dRi,"onSaveToSharePointUploadFinished"),Object(U.a)(this,this.cRi,"onSaveToSharePointUploadFailed"))};d.prototype.dRi=function(W){if(W&&W.data&&W.data.Ud){var La=ab.d(W.data.Ud);var Ia=La.Pt;if(La.returnValue)if(Ia.StatusCode!==Ka.a.TO&&Ia.StatusCode!==Ka.a.mrb)C.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",
W.data.status,Ia.StatusCode),Ia.StatusCode!==Ka.a.TRf&&this.iIe(W.data.status)||(this.mda(Ia.StatusCode.toString()),this.rzj(Ia.StatusCode));else{C.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.QJd();try{Ia.NewDocumentUrl?this.IPa(Ia.NewDocumentUrl):this.JPa()}catch(mb){C.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",mb.toString())}}else Ia={},C.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",(Ia.ResponseData=na.a.xeb(W.data.Ud),
Ia)),this.O6b()||(this.mda("Failed to deserialize response"),this.GLb())}else C.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.O6b()||(this.mda("Unknown"),this.GLb())};d.prototype.cRi=function(W){W&&W.data?this.iIe(W.data.status)||(C.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.mda(la.a[W.data.status]),this.GLb()):(C.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.O6b()||(this.mda("Unknown"),this.GLb()))};d.prototype.O6b=function(){if(!this.tEc)return C.ULS.sendTraceTag(23881930,
216,10,"Upload fail. Retrying."),this.tEc=!0,this.mQ(),!0;C.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1};d.prototype.iIe=function(W){C.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",W);return this.O6b()};d.prototype.JPa=function(){C.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");Na.a.Ze(this.D8,Na.a.qX(3),void 0,"UploadToSharePointManager.RedirectToFolder")};d.prototype.IPa=function(W){var La=!1,Ia=!1;T.AFrameworkApplication.fa&&
(La=T.AFrameworkApplication.fa.ra("SaveACopyIsEnabledForUiHost"),Ia=T.AFrameworkApplication.fa.ra("UiHostSupportsDocRebootFeatures"));C.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",W,La);if(La&&Ia){C.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var mb={};mb[qa.a.DPa]="1";mb[qa.a.documentUrl]=W;mb[qa.a.reason]=ra.a.saveAs;T.AFrameworkApplication.eV().execute(function(fb){fb.xj(Ea.a.Fta,
mb)})}else Na.a.Ze(W,Na.a.qX(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")};d.prototype.ILb=function(){this.Se&&1===this.Se.state||(this.sm=this.Ekb(),this.sm.message=CommonUIStrings.l_CommentProgressTooltip,this.sm.Rb=5,this.sm.Qu=!1,this.sm.GAa(CommonUIStrings.l_DefaultDialogTitle,null,null))};d.prototype.lIa=function(){this.sm&&(this.sm.close(),this.sm=null)};d.prototype.GLb=function(){this.kj(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile)};d.prototype.pAj=
function(){this.kj(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)};d.prototype.xzj=function(){var W=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.kj(CommonUIStrings.l_SaveAsFileTooLargeTitle,W,E.a.njj)};d.prototype.kj=function(W,La,Ia){Ia=void 0===Ia?E.a.rjj:Ia;C.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",W,La);this.lIa();1!==this.Se.state&&this.us().LHe(W,La,Ia)};d.prototype.rzj=function(W){C.ULS.sendTraceTag(25180166,
216,50,"Upload fail with status code: {0}.",W);switch(W){case Ka.a.Aag:this.pAj();break;case Ka.a.TRf:this.xzj();break;default:this.GLb()}};d.prototype.QJd=function(){"VersionHistory"===this.SPc&&this.La.processAction(xa.a.ktc,2)};d.prototype.mda=function(W){if("VersionHistory"===this.SPc){var La={};this.La.ae(xa.a.SJd,2,(La.FailureReason=W,La))}};Object(u.a)(d,"UploadToSharePointManager",null,[789]);var ba=b(257),sa=b(995),ya=b(567),va=b(58);c.prototype.init=function(){};c.prototype.dispose=function(){};
c.prototype.Sh=function(W){var La=this;this.fb=W;this.$Mc=ya.a.Mq(W.Tb("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.eNc=ya.a.Mq(W.Tb("Common.IEventEmitter<Common.IMruResult>"));this.fra=ya.a.Mq(W.Tb("Common.App.SharedFilePicker.ISharedFilePicker"));va.Task.WAA.call(null,this.$Mc,this.eNc,this.fra).continueWith(function(){La.p7i()})};c.prototype.p7i=function(){var W=this;this.fb.register(e,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Cc(function(){return new e(T.AFrameworkApplication.fa)}).tc();
this.fb.register(d,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Cc(function(){return new d(T.AFrameworkApplication.ub,W.fb.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),function(){return(new sa.a).create()},function(){return new y},T.AFrameworkApplication.ta)}).tc();this.fb.register(l,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Cc(function(){return new l(W.fb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),
function(){return new y},W.fb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),T.AFrameworkApplication.ta)}).tc();this.fb.register(w,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Cc(function(){return new w(W.fb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new x.a(function(){return W.$Mc.result}),T.AFrameworkApplication.ta,function(){return new f})}).tc();this.fb.register(n,"Common.App.SaveToSharePoint.FileNameDialogFactory").Cc(function(){return new n(T.AFrameworkApplication.fa,
T.AFrameworkApplication.ub,T.AFrameworkApplication.ta,T.AFrameworkApplication.ta.Pa,W.fb.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),W.fb.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),W.fb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),new x.a(function(){return W.eNc.result}),W.fb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),W.fra?W.fra.result:null)}).tc();this.fb.register(m,"Common.App.SaveToSharePoint.SaveToSharePointActor").Cc(function(){return new m(T.AFrameworkApplication.fa,
T.AFrameworkApplication.ub,W.fb.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),W.fb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),W.fb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),W.fb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),function(){return T.AFrameworkApplication.ta.oUg})}).tc();T.AFrameworkApplication.fa.ra("SaveToAnotherFolderBrsIsEnabled")&&this.fb.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Cg()};
c.main=function(){ba.a.instance.Ui(new c)};Af.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveToSharePoint"}}});Object(u.a)(c,"PackageManager",null,[3,4]);b.d(D,"a",function(){return a})},1371:function(u,D,b){function a(){A.a.Fa(function(sa){c.ka(sa);r.ka(sa)})}function c(sa){var ya=ba.call(this)||this;ya.$=sa;ya.Eb();return ya}function d(sa){var ya=this;this.loa=this.xUe=this.fGb=this.$1a=this.fqc=this.Kca=this.lPa=null;this.Opd=this.VNb=
this.aLd=!1;this.kLb=!0;this.Ufc=!1;this.BRd=!0;this.UNb=this.F0a=this.TAe=0;this.Tuc={};this.Xoc={};this.Woc={};this.BHf=0;this.O6a=this.T8d=!1;this.S$i=function(){ka.DOMElementExtensions.toggleCssClass(ya.$.Wq,"ewr-presentMode-transition",!1);$removeHandler(ya.$1a,"transitionend",ya.loa)};this.Ri=function(){parseInt(ya.$.Rv.style.right,10)!==ya.TAe&&window.requestAnimationFrame(function(){ya.kBc(0);ya.$.kza(H.a.tZ("PresentModeManager.OnContentAreaResized"))})};this.Aya=function(){var va=Object(K.a)(qa.a,
ya.$.pa);if(va&&ya.pz){ya.gridView.Nnd=!1;va=va.headersVisible;var W=ha.g(ya.$).rtl;ka.DOMElementExtensions.toggleCssClass(ya.$.Wq,"ewr-presentMode-on-headers-off",!va);ka.DOMElementExtensions.toggleCssClass(ya.$.Wq,"ewr-presentMode-on-rtl",W);(12!==ya.F0a&&!va||32!==ya.F0a&&va&&!W||0!==ya.F0a&&va&&W)&&window.requestAnimationFrame(function(){ya.kBc(2)})}};this.Yc=function(){ya.jaf();ya.Mg("OnWorkbookOpened");U.ULS.sendTraceTag(537154323,0,50,"PresentModeManager.OnWorkbookOpened: Silent reload happened during present mode")};
this.hp=function(){ya.Opd=!0;ya.pea("OnSelectionStarted")};this.vg=function(){ya.Opd=!1;ya.pea("OnSelectionEnded");ya.UUf()};this.Gh=function(){ya.pea("OnEditStarted")};this.Df=function(){ya.pea("OnEditEnded")};this.uw=function(){if(!ya.Ufc){var va=C.EwaSettings.isChangeGateEnabled("OfficeVSO:5411756_FlickerFixForPresentModeOverlay");ya.pea("OnVisibleAreaChanged",!0,va)}};this.FDb=function(){ya.Ufc=!0};this.fp=function(){ya.pea("OnCurrentSelectionModeChanged");ya.UUf();ya.Mg("OnCurrentSelectionModeChanged")};
this.Fm=function(){ya.pea("OnBlockCacheItemEvicted")};this.ff=function(){ya.pea("OnBlockCacheItemChanged")};this.qF=function(){ya.Ufc||ya.pea("OnActiveItemPanesChanged")};this.wh=function(){ya.Ufc=!1;ya.Kca.Mg("ActiveSheetChanged");ya.Aya()};this.JEb=function(va,W){if(va=Object(K.a)(qa.a,W.item))va.Cpb(16,!0),va.inb(ya.Aya)};this.AKi=function(){e.Whi||(ya.fqc&&ya.fqc.xq&&ya.fqc.hide(),ha.g(ya.$).isEditing&&ha.g(ya.$).Ao(!0),ya.Axc(!1),U.ULS.sendTraceTag(537154321,0,50,"PresentModeManager.OnFullScreenChangeEventHandler: Esc pressed to exit present mode"))};
this.BKi=function(){U.ULS.sendTraceTag(537154320,0,10,"PresentModeManager.OnFullScreenErrorEventHandler: Error handling full screen mode")};this.$=sa;this.gridView=ha.g(this.$);this.tkj=sa.ya.PresentModeRenderUpdateTimeout;this.initialize(sa)}function e(){}function k(sa,ya){var va=ra.call(this,sa)||this;va.a0i=function(){va.Kca.wRd(!0)};va.Kca=ya;va.domElement.classList.add("ewr-presentMode-on");sa={};sa=(sa[k.Yv]=va.nc,sa);va.Rb=0;va.initializeAndShow("",va.a0i,sa);return va}function l(sa){this.YZa=
this.TDd=null;this.$=sa;this.gridView=ha.g(this.$)}function m(){this.overlayCavityInfos=this.overlayContainerInfo=this.containerId=null}function f(){this.height=this.width=0}function w(){this.angle=this.translateY=this.translateX=this.height=this.width=this.top=this.left=0}function n(sa){var ya=this;this.Gre=this.jPa=this.RDd=this.SDd=this.Jca=this.ewaAccessibilityManager=null;this.isInitialized=!1;this.Opc={};this.Npc={};this.gPa=null;this.pGf=0;this.onKeyDown=function(va){va=va.Ca;if(9===va.keyCode){var W=
ya.Jca.querySelectorAll(ka.DOMElementExtensions.gr),La=ka.DOMElementExtensions.Dl(W);W=ka.DOMElementExtensions.hz(W);ka.DOMElementExtensions.lna(va,La,W);return!0}return!1};this.Kl=function(){ya.$.da.Za(337,function(va){ya.jPa.getPresentModeFloatieControlsMap().then(function(W){for(var La={},Ia=0;Ia<W.length;Ia++)La[W[Ia].controlId]=W[Ia].modelType;W=va.K6.f4a(La);0<W.length&&appChrome.api.dispatch(W);ya.Ljj()})})};this.$=sa}function z(){}function r(sa){return E.call(this,sa)||this}function v(sa,
ya){this.$=sa;this.presentModeManager=ya}var A=b(11);u=b(0);var B=b(905),y=b(51),x=b(37),C=b(1),G=b(186);v.prototype.Lc=function(){return!1};v.prototype.Ac=function(sa,ya){if(!C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PresentMode",!1))return!1;switch(ya.command){case 642419866:return!0;case 588342182:return this.presentModeManager.pz;default:return!1}};v.prototype.executeCommand=function(sa,ya){sa=x.TaskExtensions.jk();ya=ya.command;switch(ya){case 642419866:this.presentModeManager.Axc(!this.presentModeManager.pz);
this.presentModeManager.Mg("TogglePresentMode");break;case 588342182:this.presentModeManager.O6a=!this.presentModeManager.O6a;this.presentModeManager.j3f(this.presentModeManager.O6a,"TogglePresentModeOverlay");this.presentModeManager.Mg("TogglePresentModeOverlay");break;default:sa=G.a(ya)}return sa};v.prototype.Qc=function(){return!1};Object(u.a)(v,"PresentModeCommandHandler",null,[403]);var E=B.a;Rk(r,E);r.prototype.zd=function(){var sa=this;x.TaskExtensions.Ba(y.GetServiceTaskFactory.Ra(this.$.da,
423,424,this.hb),function(ya){sa.jd([new v(sa.$,ya.result)])},this.la,3)};r.ka=function(sa){B.a.Qd(420,new r(sa))};Object(u.a)(r,"PresentModeCommandHandlerFactory",B.a,[]);var I=b(232),U=b(15),M=b(127),T=b(4),F=b(113),K=b(85);z.yqh="ewa-presentMode-overlay";z.zqh="ewa-presentMode-panel-container";z.Aqh="ewa-presentMode-rowHdrParent-container";Object(u.a)(z,"CssClassNames",null,[]);var J=b(18),O=b(5),N=b(155),H=b(306),Q=b(133),ca=b(389),X=b(177);b(59);var Z=b(114),ea=b(469),ka=b(12),Y=b(10),qa=b(101),
fa=b(359),ha=b(21),ia=b(134),wa=b(444),Qa=b(109),S=b(13),da=b(273),xa=b(256),ta=b(179),ab=b(44);n.prototype.dispose=function(){this.$=this.RDd=this.SDd=this.Jca=this.jPa=null};n.prototype.G$h=function(){var sa=this;window.requestAnimationFrame(function(){sa.Jca=document.createElement("div");sa.$.Rv.insertBefore(sa.Jca,sa.$.Rv.lastChild);sa.Jca.id=sa.$.yb+O.a.P9b;sa.Jca.classList.add(z.zqh);sa.SDd=document.getElementById(sa.$.yb+O.a.Q4c);sa.RDd=[sa.$.mE];sa.isInitialized=!0});this.jPa=presentMode.PresentModeControllerFactoryGlobal.createPresentModeFloatieController();
this.jPa.initializePresentModeFloatie()};n.prototype.xYh=function(){var sa={};sa.PollingCountPerCaller=F.a.toJSON(this.Npc);sa.PollingDurationPerCaller=F.a.toJSON(this.Opc);return sa};n.prototype.wRd=function(sa){this.isInitialized?sa?(this.jPa.showPresentModeFloatie(this.Jca,this.SDd,this.RDd),this.Mg("ShowOrHideFloatiePanel"),this.r8i()):(this.jPa.hidePresentModeFloatie(),this.dPj()):U.ULS.sendTraceTag(537154326,0,15,"PresentModeFloatieManager.ShowOrHideFloatiePanel called before initialization complete")};
n.prototype.Mg=function(sa){this.pGf=Y.HelperMethods.Qb();this.gPa=sa;this.Gre=ta.AsyncMethodContext.Ps(this.Kl,100,ab.a.$_i+sa,this.Gre)};n.prototype.Uf=function(sa,ya){if(ya)return!1;sa=ka.DOMElementExtensions.Dl(this.Jca.querySelectorAll(ka.DOMElementExtensions.gr));if(!sa)return U.ULS.sendTraceTag(537154325,0,10,"PresentModeFloatieManager.SetFocusOnSection: Could not find first focusable item in present mode toolbar"),!1;sa.focus();return!0};n.prototype.$g=function(sa){return ka.DOMElementExtensions.nf(this.jc,
sa)};n.prototype.hj=function(){};n.prototype.Dj=function(){};n.prototype.r8i=function(){var sa=this;da.a(this.$).Oh(this);this.$.da.Za(15,function(ya){sa.ewaAccessibilityManager=ya;sa.ewaAccessibilityManager.mode=5});Qa.KeyInputManager.instance.qa(S.a.Lb,this.jc,this.onKeyDown)};n.prototype.dPj=function(){da.a(this.$).Gz(this);ha.g(this.$).t0();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0);Qa.KeyInputManager.instance.Aa(S.a.Lb,this.jc,this.onKeyDown)};n.prototype.Ljj=function(){var sa=
Y.HelperMethods.Qb()-this.pGf,ya=this.Opc[this.gPa]?this.Opc[this.gPa]:0;this.Opc[this.gPa]=ya>sa?ya:sa;this.Npc[this.gPa]=this.Npc[this.gPa]?this.Npc[this.gPa]+1:1};Af.Object.defineProperties(n.prototype,{jc:{configurable:!0,enumerable:!0,get:function(){return this.Jca}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){this.jPa.updatePresentModeFloatieShyState(2);return!!this.Jca}},Zd:{configurable:!0,enumerable:!0,get:function(){return xa.a.CHf}}});Object(u.a)(n,"PresentModeFloatieManager",
null,[695,422,10]);var Na=b(7),Ka=b(60);Object(u.a)(w,"OverlayCavityInfo",null,[]);Object(u.a)(f,"OverlayContainerInfo",null,[]);Object(u.a)(m,"PresentModeOverlayProps",null,[]);l.prototype.rai=function(){var sa=this;this.TDd=presentMode.PresentModeControllerFactoryGlobal.createPresentModeOverlayController();window.requestAnimationFrame(function(){sa.YZa=Array(5);for(var ya,va,W=1;4>=W;W++)ya=document.createElement("div"),ka.DOMElementExtensions.setVisible(ya,!1),ya.id=String.format("{0}-{1}","PresentModeOverlay",
W),ka.DOMElementExtensions.toggleCssClass(ya,z.yqh,!0),va=sa.gridView.Ef(W).domElement,va.insertBefore(ya,va.firstChild),sa.YZa[W]=ya})};l.prototype.i3f=function(sa){sa&&this.vSj();for(var ya=1;4>=ya;ya++)this.Lef(ya)&&ka.DOMElementExtensions.setVisible(this.YZa[ya],sa);ka.DOMElementExtensions.toggleCssClass(this.$.Wq,"ewr-presentMode-overlay",sa)};l.prototype.vSj=function(){for(var sa=this.xTg(),ya,va=1;4>=va;va++)ya=va,sa[ya]&&this.TDd.showOverlayWithCavity(this.YZa[ya],sa[ya])};l.prototype.dispose=
function(){this.TDd=this.YZa=this.gridView=this.$=null};l.prototype.xTg=function(){for(var sa,ya,va=ha.g(this.$).rtl,W,La=Array(5),Ia=1;4>=Ia;Ia++)ya=Ia,this.Lef(Ia)&&(sa=this.gridView.Ef(Ia),W=this.gridView.ha.Oa.P4?this.wOh(Ia,sa,va):this.oPh(Ia,sa,va),sa=this.i8g(sa),La[ya]=this.C8g(this.YZa[ya].id,sa,W));return La};l.prototype.Lef=function(sa){return this.gridView.eb.IQ(sa)};l.prototype.i8g=function(sa){return Object(Na.a)(new f,{width:sa.jn.width,height:sa.jn.height})};l.prototype.C8g=function(sa,
ya,va){return Object(Na.a)(new m,{containerId:sa,overlayContainerInfo:ya,overlayCavityInfos:va?[va]:null})};l.prototype.wOh=function(sa,ya,va){var W=ha.g(this.$).ha.Oa.Yb;if(!W)return U.ULS.sendTraceTag(537154317,0,10,"PresentModeOverlayRenderer.GetFloatingObjectOverlayCavityInfo: Selected Floating Object is null."),null;var La=W.extension.zOh(sa);sa=La.OBa;W=La.rotation;var Ia=La.translateX;var mb=La.translateY;return La.returnValue?(La=sa.x-ya.jn.x,Object(Na.a)(new w,{left:(va?ya.jn.width-(La+sa.width):
La)-3+1,top:sa.y-ya.jn.y-3+1,width:sa.width+5,height:sa.height+5,angle:W,translateX:Ia,translateY:mb})):null};l.prototype.oPh=function(sa,ya,va){sa=this.gridView.qb.Bub(this.gridView.ha.sa.activeRange,sa)||Ka.a.K3;if(!sa.Ae(ya.jn))return null;var W=sa.x-ya.jn.x;return Object(Na.a)(new w,{left:va?ya.jn.width-(W+sa.width)-2:W-3,top:sa.y-ya.jn.y-3,width:sa.width+5,height:sa.height+5})};Object(u.a)(l,"PresentModeOverlayRenderer",null,[627,10]);var la=b(61),Ea=b(390),ra=Ea.a;Rk(k,ra);k.prototype.hide=
function(){ra.prototype.hide.call(this);M.a.mv(O.a.o3f,"false",this.$.ya.ShowPresentModeWelcomeDialogCookieExpirationDays)};Af.Object.defineProperties(k.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"PresentModeWelcomeDialog"}}});Object(u.a)(k,"PresentModeWelcomeDialog",Ea.a,[]);e.requestFullscreen=function(sa){sa.webkitRequestFullscreen?sa.webkitRequestFullscreen():sa.msRequestFullscreen?sa.msRequestFullscreen():sa.mozRequestFullScreen?sa.mozRequestFullScreen():sa.requestFullscreen?
sa.requestFullscreen():U.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")};e.exitFullscreen=function(){document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen?document.exitFullscreen():U.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")};Af.Object.defineProperties(e,{ZDh:{configurable:!0,enumerable:!0,
get:function(){return document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":document.mozFullScreenEnabled?"mozfullscreenchange":document.fullscreenEnabled?"fullscreenchange":null}},$Dh:{configurable:!0,enumerable:!0,get:function(){return"undefined"!==typeof document.webkitFullscreenEnabled?"webkitfullscreenerror":"undefined"!==typeof document.msFullscreenEnabled?"MSFullscreenError":"undefined"!==typeof document.mozFullScreenEnabled?"mozfullscreenerror":
"undefined"!==typeof document.fullscreenEnabled?"fullscreenerror":null}},Whi:{configurable:!0,enumerable:!0,get:function(){return!!document.webkitFullscreenElement||!!document.msFullscreenElement||!!document.mozFullScreenElement||!!document.fullscreenElement}}});Object(u.a)(e,"FullscreenUtils",null,[]);d.prototype.Axc=function(sa){var ya=this;this.pz!==sa&&(this.T8d=sa,this.O6a=this.pz,this.jaf(),this.kLb=this.V1f(),window.requestAnimationFrame(function(){ka.DOMElementExtensions.toggleCssClass(ya.$.Wq,
"ewr-presentMode-transition",!0);$addHandler(ya.$1a,"transitionend",ya.loa);ya.vAj(!sa);ya.TVi();ka.DOMElementExtensions.toggleCssClass(ya.$.Wq,"ewr-presentMode-on",sa);ya.uAj(sa);N.b(ya.$).g3f(ya.pz);N.c(ya.$).g3f(ya.pz);ya.$.Kza();ya.lPa.i3f(ya.kLb);if(ya.pz){ya.mZa();M.a.get(O.a.o3f)?ya.Kca.wRd(ya.pz):ya.fqc=new k(ya.$,ya.Kca);var va=wa.b(ya.$);va&&(ya.aLd=va.k7c(!1));ya.BHf=Y.HelperMethods.Qb()}else ya.Kca.wRd(sa),ya.aLd&&(va=wa.b(ya.$))&&(va.k7c(!0),ya.aLd=!1),ya.$5b(),ya.Avi()}))};d.prototype.j3f=
function(sa,ya){this.BRd=sa;this.pea(ya)};d.prototype.Mg=function(sa){this.Kca.Mg(sa)};d.prototype.dispose=function(){this.$5b();this.lPa&&(this.lPa.dispose(),this.lPa=null);this.gridView=this.$=null};d.prototype.vAj=function(sa){var ya=this.$.da.za(25);void 0===ya||null===ya?U.ULS.sendTraceTag(537154324,0,10,"PresentModeManager.ShowOrHideGridPresence: presenceView is null"):sa?ya.uxc():ya.Cdc()};d.prototype.TVi=function(){var sa=this;ka.DOMElementExtensions.toggleCssClass(document.getElementById(T.AFrameworkApplication.i2a),
J.a.Lp,this.pz);ka.DOMElementExtensions.toggleCssClass(this.$.Wq,"ewr-presentMode-on",this.pz);this.yAj(this.pz);this.gridView.Nnd=!this.pz;this.MSj();this.$.da.Za(32,function(ya){ya.iTj(sa.pz)});Z.b(this.$,function(ya){ya.tcg(sa.pz)})};d.prototype.yAj=function(sa){if(this.fGb)if(sa){if(sa=Object(K.a)(qa.a,this.$.pa))ka.DOMElementExtensions.toggleCssClass(this.$.Wq,"ewr-presentMode-on-headers-off",!sa.headersVisible),ka.DOMElementExtensions.toggleCssClass(this.$.Wq,"ewr-presentMode-on-rtl",ha.g(this.$).rtl);
this.kBc(0)}else this.$.Wq.classList.remove("ewr-presentMode-on-headers-off"),this.$.Wq.classList.remove("ewr-presentMode-on-rtl"),this.kBc(1)};d.prototype.kBc=function(sa){var ya=Object(K.a)(qa.a,this.$.pa);if(ya){var va=parseInt(this.$.Rv.style.right,10);if(1===sa||2===sa){if(isNaN(va)||va<this.F0a)return;va-=this.F0a}if(0===sa||2===sa)sa=ya.headersVisible,ya=ha.g(this.$).rtl,sa=sa?ya?0:32:12,va=isNaN(va)?sa:va+sa,this.F0a=sa;this.$.Rv.style.right=Y.HelperMethods.hc(va);this.TAe=va}};d.prototype.MSj=
function(){var sa=document.getElementById(this.$.yb+O.a.A5b).parentNode;ka.DOMElementExtensions.toggleCssClass(sa,z.Aqh,this.pz)};d.prototype.initialize=function(sa){this.lPa=new l(sa);this.lPa.rai();this.Kca=new n(sa);this.Kca.G$h();this.$1a=document.getElementById("MainApp");this.xUe=this.AKi;$addHandler(this.$1a,e.ZDh,this.xUe);$addHandler(this.$1a,e.$Dh,this.BKi);this.fGb||(this.fGb=document.createElement("div"),this.fGb.className="ewa-presentMode-right-frame",this.$.mE.appendChild(this.fGb));
this.loa=this.S$i};d.prototype.mZa=function(){this.gridView.ha.t2(this.hp);this.gridView.ha.mY(this.vg);this.gridView.$b.Bk(this.Gh);this.gridView.$b.vm(this.Df);this.gridView.XD(this.fp);this.gridView.view.Gs(this.uw);this.gridView.tUc(this.FDb);this.gridView.Ea.xG(this.Fm);this.gridView.Ea.Fs(this.ff);this.$.va.Kf(this.wh);this.$.va.Era(this.qF);this.$.va.Iga(this.JEb);this.$.xA(this.Ri);this.$.Tk(this.Yc);var sa=Object(K.a)(fa.a,this.$.va);sa=ak(sa.items);for(var ya=sa.next();!ya.done;ya=sa.next())ya.value.inb(this.Aya)};
d.prototype.$5b=function(){this.gridView&&(this.gridView.ha.Q6(this.hp),this.gridView.ha.yW(this.vg),this.gridView.$b.wk(this.Gh),this.gridView.$b.Nl(this.Df),this.gridView.DF(this.fp),this.gridView.view.Iq(this.uw),this.gridView.lId(this.FDb),this.gridView.Ea.aI(this.Fm),this.gridView.Ea.Gq(this.ff));if(this.$){this.$.va.wg(this.wh);this.$.va.Aza(this.qF);this.$.va.Jma(this.JEb);this.$.kD(this.Ri);this.$.ol(this.Yc);var sa=Object(K.a)(fa.a,this.$.va);sa=ak(sa.items);for(var ya=sa.next();!ya.done;ya=
sa.next())ya.value.WId(this.Aya)}};d.prototype.V1f=function(){if(!this.pz||!this.O6a)return!1;if(1===this.gridView.ha.Qe){var sa=this.$.pa.activeRange.isSingle,ya=1===this.$.pa.selectedRanges.length&&!sa,va=this.gridView.isEditing,W=this.Opd;ya||U.ULS.sendTraceTag(537154322,0,50,"PresentModeManager.ShouldShowPresentModeOverlay: Not showing present mode overlay, single cell selection : {0}",sa);return this.BRd&&ya&&!va&&!W}return this.BRd};d.prototype.uAj=function(sa){sa?e.requestFullscreen(this.$1a):
e.exitFullscreen()};d.prototype.pea=function(sa,ya,va){var W=this;va=void 0===va?!1:va;void 0!==ya&&ya||(this.kLb=this.V1f());U.ULS.sendTraceTag(555356484,0,100,"PresentModeManager.UpdateLayout: UpdateLayout triggered by {0}, visibility: {1}, immediateUpdate: {2}",sa,this.kLb,va);if(this.VNb&&va)U.ULS.sendTraceTag(543023559,0,50,"PresentModeManager.UpdateLayout: Cancel update layout for {0}",this.UNb),window.cancelAnimationFrame(this.UNb),this.UNb=0;else if(this.VNb){U.ULS.sendTraceTag(543023558,
0,50,"PresentModeManager.UpdateLayout: Skipping update layout for {0}",sa);return}va?this.RXd(Y.HelperMethods.Qb(),sa):(this.UNb=window.requestAnimationFrame(function(La){W.RXd(La,sa)}),this.VNb=!0)};d.prototype.RXd=function(sa,ya){var va=this,W=Y.HelperMethods.Qb();if(W-sa>this.tkj)this.UNb=window.requestAnimationFrame(function(Ia){va.RXd(Ia,ya)}),this.VNb=!1,U.ULS.sendTraceTag(537154319,0,50,"PresentModeManager.UpdateLayoutCallback: Scheduling update for next frame,  ElapsedTime = {0}ms.",W-sa);
else{this.lPa.i3f(this.kLb);this.VNb=!1;var La=Y.HelperMethods.Qb();sa=Y.HelperMethods.Qb()-sa;W=La-W;this.yjj(sa,ya);U.ULS.sendTraceTag(537154318,0,50,"PresentModeManager.UpdateLayoutCallback: UpdateLayoutTotalDuration = {0}ms. rafTotalDuration = {1}ms",W,sa)}};d.prototype.jaf=function(){var sa=this;ca.a(this.$.userOperationManager,function(ya,va,W){var La=sa.$.oa.xa,Ia=sa.pz,mb=La.Na(41,null);mb.shouldEnablePresentMode=Ia;return la.g(La,"SetPresentMode",mb,ya,va,W,null,0)},function(ya){return new X.a(252,
0,ya)},null)};d.prototype.UUf=function(){var sa=ea.a(this.gridView.Qe);1!==this.gridView.Qe||this.$.pa.activeRange.isSingle||(sa="Range");this.Tuc[sa]=this.Tuc[sa]?this.Tuc[sa]+1:1};d.prototype.yjj=function(sa,ya){var va=this.Xoc[ya]?this.Xoc[ya]:0;this.Xoc[ya]=va>sa?va:sa;this.Woc[ya]=this.Woc[ya]?this.Woc[ya]+1:1};d.prototype.Avi=function(){var sa={},ya=Y.HelperMethods.Qb()-this.BHf;sa.PresentModeDuration=ya;sa.SelectionCountPerObject=F.a.toJSON(this.Tuc);sa.OverlayCountPerCaller=F.a.toJSON(this.Woc);
sa.OverlayDurationPerCaller=F.a.toJSON(this.Xoc);ya=this.Kca.xYh();for(var va in ya)sa[va]=ya[va];ia.b(this.$).Cd(Q.a.Z_i,sa,void 0,!0)};Af.Object.defineProperties(d.prototype,{pz:{configurable:!0,enumerable:!0,get:function(){return this.T8d}}});Object(u.a)(d,"PresentModeManager",null,[608,10]);var na=b(259),ba=I.a;Rk(c,ba);c.prototype.create=function(){var sa=this,ya=y.GetServiceTaskFactory.Ra(this.$.da,283,284,1);x.TaskExtensions.Ba(ya,function(){x.TaskExtensions.Ba(na.c(ya.result.tn.loadScript("presentMode")),
function(){var va=sa.$.da.za(423);va||(va=new d(sa.$),sa.$.da.Ga(423,va));sa.pb(va)},sa.$.la,3)},this.$.la,3)};c.ka=function(sa){sa.da.Ga(424,new c(sa))};Object(u.a)(c,"PresentModeManagerFactory",I.a,[]);b.d(D,"a",function(){return a})},1375:function(u,D,b){function a(){v.a.Fa(c.ka)}function c($a){return Ja.call(this,$a)||this}function d($a,Ta,pa,Da){var rb=P.call(this)||this;rb.$=$a;rb.businessBar=Da;rb.openInExcelOperation=Ta;rb.RJ=pa;return rb}function e(){}function k($a){var Ta=sa.call(this,$a)||
this;Ta.sessionId=$a.ya.UserSessionId;Ta.PQg=$a.ya.BuildVersion;return Ta}function l($a){var Ta=this;this.l7h="itms-apps://";this.m7h="apps.apple.com/app/apple-store/id586683407?mt=8&pt=80423&ct=miniWAC";this.Mig=function(pa){1==pa&&Ta.EDc()};this.$=$a;this.vx=E.AFrameworkApplication.ta.Pa.vx;this.Dla="ms-excel:ofe|u|"+this.vx;this.jm=E.AFrameworkApplication.fa.Wa("AppUrl");K.a.tba||K.a.sh?this.jm=this.l7h+this.m7h:K.a.Wo&&(E.AFrameworkApplication.fa.ra("UseAppAndroidMarketURL")?(C.ULS.sendTraceTag(523534414,
306,100,"OpenInAppDialogReact: Using app android market url"),this.jm=E.AFrameworkApplication.fa.Wa("WildFireMarketUrlExcelAndroid")):K.a.czb?this.jm=E.AFrameworkApplication.fa.Wa("WildFireUrlChinaStoreAndroid"):4<K.a.LVc.j8a&&(this.jm=E.AFrameworkApplication.fa.Wa("WildFireUrlExcelAndroid")))}function m($a){var Ta=ra.call(this,$a)||this;Ta.JH=null;Ta.MDb=function(){C.ULS.sendTraceTag(574993313,306,50,"MouseClick: Open with redirection timer");if(Ta.$.ya.IsMeetingLiveSession)return Ta.EDc(),!0;K.a.Wo?
(C.ULS.sendTraceTag(574993312,306,50,"Android intent scheme is being used to open android app from browser"),Ta.vx&&Ta.vx.length||C.ULS.sendTraceTag(537162595,306,15,"ClientUrl is null"),Ta.openUrl("intent:"+Ta.vx+"#Intent;scheme=ms-excel;action=android.intent.action.VIEW;S.browser_fallback_url="+Ta.jm+";end","_top")):9<=K.a.Jjd?(C.ULS.sendTraceTag(537162594,306,50,"OpenInAppDialog.onClickHandler: Open in app directly if installed for iOS version 9 or above"),Ta.openUrl(Ta.Dla,"_top"),window.setTimeout(function(){Ta.openUrl(Ta.jm,
"_blank")},9E3)):(C.ULS.sendTraceTag(537162593,306,50,"OpenInAppDialog.onClickHandler: Open in app if installed, else redirection to appstore for iOS version below 9."),Ta.openUrl(Ta.Dla,"_top"),window.setTimeout(function(){Ta.openUrl(Ta.jm,"_blank")},500));return!0};Ta.sOa=function(pa){return pa.Ca.keyCode===xa.a.Rh||pa.Ca.keyCode===xa.a.Eoa?(C.ULS.sendTraceTag(537162592,306,50,"KeyPress: Open with redirection timer"),pa.zb.click(),!0):!1};if(1!==E.AFrameworkApplication.ta.Pa.Fj)return Ta;Ta.vx=
Ta.$.workbookContext.ClientUrl;Ta.Dla="ms-excel:ofe|u|"+Ta.vx;Ta.jm=E.AFrameworkApplication.fa.Wa("AppUrl");K.a.tba?Ta.jm="itms-apps://"+E.AFrameworkApplication.fa.Wa("WildFireUrlExceliOS")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac":K.a.Wo&&(la.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseAppAndroidMarketURL",!1)&&Ta.$.ya.IsMeetingLiveSession?(C.ULS.sendTraceTag(529397969,306,100,"Using app android market url"),Ta.jm=E.AFrameworkApplication.fa.Wa("WildFireMarketUrlExcelAndroid")):
K.a.czb?Ta.jm=E.AFrameworkApplication.fa.Wa("WildFireUrlChinaStoreAndroid"):4<K.a.LVc.j8a&&(Ta.jm=E.AFrameworkApplication.fa.Wa("WildFireUrlExcelAndroid")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac"));return Ta}function f(){}function w($a){this.calculateType=0;this.calculateType=$a}function n($a){this.calculationMode=0;this.calculationMode=$a}function z($a,Ta){var pa=this;this.dialog=null;this.Avf=function(){pa.dialog&&pa.dialog.hide()};this.yFi=$a;this.ob=Ta;this.ob.Ymb(this.Avf)}
function r($a,Ta){return da.call(this,$a,void 0,void 0,Ta)||this}var v=b(11);u=b(0);var A=b(615),B=b(905),y=b(51),x=b(37),C=b(15),G=b(1444),E=b(4),I=b(170),U=b(964),M=b(99),T=b(279),F=b(740),K=b(25),J=b(162),O=b(207),N=b(304),H=b(5),Q=b(153),ca=b(103),X=b(76),Z=b(78),ea=b(389),ka=b(177),Y=b(59),qa=b(61),fa=b(337),ha=b(649),ia=b(1538),wa=b(442),Qa=b(331),S=b(14),da=ia.a;Rk(r,da);r.prototype.blf=function(){C.ULS.sendTraceTag(537162658,0,50,"DownloadACopyAsOdsDialog.LogDialogDisplayed - ODS download dialog displayed")};
r.prototype.dlf=function(){C.ULS.sendTraceTag(537162657,0,50,"DownloadACopyAsOdsDialog.LogDownloadLinkClicked - ODS download dialog link clicked")};r.prototype.qjc=function(){wa.Redirect.showHelp(Qa.a.bFi);return!0};Af.Object.defineProperties(r.prototype,{MNa:{configurable:!0,enumerable:!0,get:function(){return S.a.instance.Xa(411)}},xjc:{configurable:!0,enumerable:!0,get:function(){return S.a.instance.Xa(412)}},wjc:{configurable:!0,enumerable:!0,get:function(){return"DownloadOdsLink"}},jBb:{configurable:!0,
enumerable:!0,get:function(){return"#"}},J7a:{configurable:!0,enumerable:!0,get:function(){return S.a.instance.Xa(413)}},wpf:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(u.a)(r,"DownloadACopyAsOdsDialog",ia.a,[]);z.prototype.Lre=function($a){this.dialog=$a};z.prototype.g6c=function(){this.yFi.WDf(-1059172980)};z.prototype.dispose=function(){this.ob.NHb(this.Avf)};Object(u.a)(z,"DownloadACopyAsOdsDialogDownloadBehavior",null,[308,10]);Object(u.a)(n,"MacroRecorderWorkbookCalculationModeSetPayload",
null,[409]);Object(u.a)(w,"MacroRecorderWorkbookRecalculatedPayload",null,[409]);var xa=b(86),ta=b(150),ab=b(195),Na=b(13),Ka=b(109),la=b(1);ia=b(325);Af.Object.defineProperties(f,{LUi:{configurable:!0,enumerable:!0,get:function(){return f.KUi}}});f.KUi="<div class='\"\"' id='OpenInAppDialog'> <div class='PrivacyDialogTitle UIFontDialogTitle' id='OpenInAppTitle'> <label id='OpenInAppTitle' class='\"\"' style='font-size:16pt' >{0}</label> </div> <div class='WACDialogRow' id='InfoMessageArea'> <label id='InfoMessageAreaLine1' class='\"\"' style='font-size:12pt' >{1}</label> <br/> </div> <br/> <div class='AppInstallButton' id='LinkToInstall' role='button' tabIndex='0'> <div class='clip32x32' id='BottomInfoIconClip' unselectable='on' style='display: inline-block; pointer-events:none;' role='img'> <img id='BottomIconInfo' class='{3}' role='presentation' src={2} /> </div> <div class='\"\"' id='AppstoreLink' style='display:inline-block; padding-top:4px; vertical-align:top;'> <label id='AppstoreLinkTitle' class='PrivacyDialogTitle' unselectable='on' style='font-size: 14pt; margin-left:8px' >{4}</label> </div> </div>";
Object(u.a)(f,"OpenInAppDialogCopyHtml",null,[]);var Ea=b(158),ra=ia.a;Rk(m,ra);m.prototype.openUrl=function($a,Ta){var pa=document.getElementById("link");pa||(pa=document.createElement("a"),pa.id="link",pa.style.visibility="hidden",pa.href="",document.body.appendChild(pa));pa.target=Ta;pa.href=$a;pa.click()};m.prototype.EDc=function(){var $a=this;C.ULS.sendTraceTag(529397968,306,50,"OpenInAppForLiveFiles API invoked");x.TaskExtensions.Ba(y.GetServiceTaskFactory.Ra(this.$.da,21,137,1),function(Ta){var pa=
{};pa.OpenInAppUrl=$a.Dla;pa.StoreUrl=$a.jm;Ta.result.xj("UI_OpenInMobileApp",pa)},this.$.la)};m.prototype.MUi=function(){C.ULS.sendTraceTag(529397967,306,100,"OpenInAppDialogHandler invoked")};m.prototype.sg=function(){this.Wf=ta.a.Po(f.LUi,S.a.instance.ga(665),S.a.instance.ga(666),E.AFrameworkApplication.JC,Ea.getImageClass(E.AFrameworkApplication.fa.Wa("AppIcon")),S.a.instance.ga(667));this.ze="OpenInAppDialog";this.Rb=5;this.initializeAndShow("",this.MUi.bind(this),null);this.lI(this.JH)};m.prototype.kv=
function($a){ra.prototype.kv.call(this,$a);document.getElementById("WACDialogBodyPanel").style.padding="0 4px 0 24px";this.JH=document.getElementById("LinkToInstall");ab.a.instance.qa(Na.a.click,this.JH,this.MDb);Ka.KeyInputManager.instance.qa(Na.a.Gd,this.JH,this.sOa)};m.prototype.dispose=function(){this.JH&&(ab.a.instance.Aa(Na.a.click,this.JH,this.MDb),Ka.KeyInputManager.instance.Aa(Na.a.Gd,this.JH,this.sOa),this.JH=null);ra.prototype.dispose.call(this)};Af.Object.defineProperties(m.prototype,
{nc:{configurable:!0,enumerable:!0,get:function(){return"OpenInAppDialogCopy"}}});Object(u.a)(m,"OpenInAppDialogCopy",ia.a,[]);var na=b(135),ba=b(392);l.prototype.EDc=function(){var $a=this;C.ULS.sendTraceTag(523534413,306,50,"OpenInAppDialogReact: OpenInAppForLiveFiles API invoked");x.TaskExtensions.Ba(y.GetServiceTaskFactory.Ra(this.$.da,21,137,1),function(Ta){var pa={};pa[ba.a.bEf]=$a.Dla;pa[ba.a.jm]=$a.jm;Ta.result.xj("UI_OpenInMobileApp",pa)},this.$.la)};l.prototype.sg=function(){C.ULS.sendTraceTag(523534412,
0,50,"initializeAndShowDialog: React Edit in app dialog opened.");var $a=new na.StandardDialog;$a.Rb=0;$a.mc(1,S.a.instance.ga(671));$a.nl(S.a.instance.ga(669),S.a.instance.ga(670),0,this.Mig)};Object(u.a)(l,"OpenInAppDialogReact",null,[]);ia=b(390);var sa=ia.a;Rk(k,sa);k.prototype.DM=function(){var $a={};return $a[k.Rnj]=S.a.instance.ga(672),$a[k.Snj]=this.sessionId,$a[k.id]="WACSessionIdDialog",$a[k.rYc]=S.a.instance.ga(673),$a[k.buildVersion]=this.PQg,$a};k.prototype.sg=function(){var $a=this.DM();
this.Rb=5;this.initializeAndShow(S.a.instance.ga(1018),this.EWj.bind(this),$a)};k.prototype.EWj=function(){C.ULS.sendTraceTag(521434688,306,100,"Show WACSessionIdDialogHandler invoked")};Af.Object.defineProperties(k.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"WACSessionIdDialog"}}});k.id="id";k.Rnj="sessionIdLabel";k.Snj="sessionIdValue";k.rYc="buildLabel";k.buildVersion="buildVersion";Object(u.a)(k,"WACSessionIdDialog",ia.a,[]);var ya=b(28),va=b(29),W=b(372),La=b(10),Ia=b(186),
mb=b(295),fb=b(21),Ma=b(42),Hb=b(260),Kb=b(494),Ub=b(397),gb=b(50),Db=b(6),Va=b(147),yb=b(1175),qb=b(82),dc=b(35),bb=b(378),db=b(263);e.prototype.zQ=function($a,Ta){$a=va.a.Wc(12,1,674,0,0,0,"Blank");$a.Description=String.format(S.a.instance.ga(675),Ta);return $a};e.prototype.D$b=function($a){switch($a){case 1:case 2:return 0;default:return 2}};Object(u.a)(e,"ReloadCloseConfirmation",null,[553]);var wc=b(156),nb=b(650),zb=b(67),ma=b(58),P=O.a;Rk(d,P);d.prototype.Lc=function(){return!1};d.prototype.executeCommand=
function($a,Ta,pa,Da){var rb=this,Ab=this.Q6b,ob=this.$,sb=Ta.command,Pb=this.openInExcelOperation,Aa=this.$.yb,Ya=pa.SourceControlId;ob.Ok.ole(sb);Pb.hwc(Ta.startTime.getTime().toString());$a=null;switch(sb){case 1455037301:this.$.f5?Pb.cBe():Pb.U1c();break;case -2044628748:case 2004484710:this.$.f5?Pb.cBe():Pb.openInExcelClient();break;case 213236505:"ContextMenu.ShowOpenInAppDialogOnMobile"===Ya?(this.KBb("CellLongPress"),C.ULS.sendTraceTag(576495705,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from cell long press")):
(this.KBb("PencilIcon"),C.ULS.sendTraceTag(576495704,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from pencil icon in toolbar"));this.showOpenInAppDialog();break;case 480922297:la.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowWacSessionIdDialogOnMobile",!1)&&(new k(this.$)).sg();break;case -2028960985:Pb.Z4f();break;case -1059172980:new r(Pb.gue(sb),new z(Pb,ob.ob));break;case -1285148982:this.clientWorkflow.fd.activityState[dc.a.uTc]=!0;this.qAc(!1);
break;case -75280711:this.qAc(!1);break;case -455164169:this.qAc(!0);break;case -1388494670:this.$.da.Za(400,function(Lb){Lb.Byi();rb.qAc(!1)});break;case 810888577:E.AFrameworkApplication.mk=(new Date).getTime();C.ULS.sendTraceTag(537162656,0,50,"FileOperationsCommandHandler.ExecuteCommand: Set AccessTokenTtl to {0}",E.AFrameworkApplication.mk);break;case -1804063550:case -974518828:Ta=0;H.a.tBd in pa&&(Ta=pa[H.a.tBd]);Pb.WDf(sb,Ta);break;case -1339961039:Ta=!1;pa&&H.a.JIb in pa&&(Ta=pa[H.a.JIb]);
this.reloadWorkbook(!1,Ta);break;case -8805455:var kb=this.workbookContext;ob.isEditMode||(d.Jye(ob),$a=x.TaskExtensions.Ba(this.RJ.value,function(Lb){Lb=Lb.result;var Sa=Lb.isEnabled();Sa&&ha.a(Lb,I.a.copyAndEdit,Y.a.rg.oXe(),rb.$.ea.Kg.get(2))?C.ULS.sendTraceTag(537162655,0,50,"FileOperationsCommandHandler.ExecuteCommand: ReloadInEditMode ribbon command was procesed through SendMessageIfOptionSet()"):Sa&&E.AFrameworkApplication.Rdg?(Sa={},Sa[G.a.rEd]=E.AFrameworkApplication.userSessionId,Sa[E.AFrameworkApplication.NAi]=
ya.a.Ta.Jb.getTime().toString(),C.ULS.sendTraceTag(537162654,0,50,"FileOperationsCommandHandler.ExecuteCommand: processing ReloadInEditMode ribbon command whike UseEditModePostMessage flag is ON"),Lb.xj(I.a.editMode,Sa)):Ab.CopyAndEditUrl?rb.m3g():(rb.ic.supportsEditing||kb.EditUrl)&&rb.reloadWorkbookInEditMode()},this.la,3));break;case -723527778:ob.isEditMode&&(d.Jye(ob),this.reloadWorkbookInViewMode());break;case 1783960667:case -1355155015:var lb=ob.oa.xa.Pb(),ac=-1355155015===sb?1:0,Dc=function(){return new w(ac)};
$a=ea.a(this.$.userOperationManager,function(Lb,Sa,Cb){return qa.z(ob.oa.xa,ac,null,Lb,Sa,Cb,null,lb)},function(Lb){return new ka.a(128,0,Lb,void 0,Dc)},Ta);fb.g(ob).ig.IG(!1);break;case -1158102843:$a=fb.g(ob).ig.recalcSheet(Ta);fb.g(ob).ig.IG(!1);break;case -988468372:if(la.EwaSettings.ma(302))if(Da=parseInt(pa[X.a.Nc],10),0<=Da&&3>Da)this.setCalculationMode(Ta,Da);else return C.ULS.sendTraceTag(537162652,0,10,"SetCalculationMode , unexpected menuItemId: {0}",pa[X.a.Nc]),Ia.a(sb);break;case 257398710:Q.a.ntw(Ab.ReportAbuseUrl,
ob);break;case 1800405051:this.tjj();break;case -48469327:this.saveACopy();break;case 214430355:Ta=!1;pa&&H.a.N6c in pa&&(Ta=pa[H.a.N6c]);if(!this.axj(Ta,pa))break;E.AFrameworkApplication.X4?this.businessBar.Jf(41,null):this.businessBar.Jf(Ta?22:23,null);break;case 1389557314:$a=x.TaskExtensions.Ba(this.RJ.value,function(Lb){ha.a(Lb.result,I.a.mzh,null,rb.$.ea.Kg.get(6))||Q.a.ntw(Ab.FileVersionUrl,ob)},this.la,3);break;case 2145659238:this.closeWorkbook();break;case 1773624819:Ya===Aa+H.a.Yhf?Pb.hri():
Pb.gri();break;case 512141517:Ya===Aa+H.a.Xhf?Pb.sri():Pb.rri();break;case -1224038235:var Zb=U.a.On in pa?!pa[U.a.On]:ca.j(ob.ea.workbookContext.Options);pa[U.a.Description]=Zb?S.a.instance.ga(574):S.a.instance.ga(575);$a=ea.a(this.$.userOperationManager,function(Lb,Sa,Cb){var ec=rb.$.oa.xa,wb=ec.Na(9,null);wb.isReadOnlyRecommended=!Zb;return qa.g(ec,"SetReadOnlyRecommended",wb,Lb,Sa,Cb,null,0)},function(Lb){return new ka.a(129,0,Lb)},Ta);break;case 1118926154:if(this.$.isEditMode){var mc=new J.a;
this.$.da.Za(53,function(Lb){Lb?(Lb.Ql.bri(rb.$.yb+H.a.ird),mc.setResult(!0)):C.ULS.sendTraceTag(537162649,0,50,"Ignoring RibbonCommand.LaunchFileMenuShortcut, the ribbonManager is null.")});$a=mc.task}break;case -1698025133:Pb.openInBrowser();break;case 520859864:$a=x.TaskExtensions.Ba(y.GetServiceTaskFactory.Ra(this.$.da,393,394,Da.zja()),function(Lb){Lb.result||C.ULS.sendTraceTag(537162648,0,10,"FileMenuCommandHandler::ExecuteCommand Failed to create SaveToHostManager")},this.$.la,3);break;default:$a=
Ia.a(sb)}return $a||ma.Task.Ua(!0)};d.prototype.KBb=function($a){if(la.EwaSettings.isChangeGateEnabled("OfficeVSO:4859963_LogUsageKpiForOpenInAppDialog"))if(La.HelperMethods.ZZ){var Ta=new Map;Ta.set("EntryPoint",$a);M.Health.instance.recordKpiUsage(Ub.a.JUi,0,Kb.a.wAi,Ta)}else C.ULS.sendTraceTag(537162647,0,15,"FileOperationsCommandHandler.LogUsageKpiOpenInAppDialog: KPI Usage not supported")};d.prototype.showOpenInAppDialog=function(){E.AFrameworkApplication.isMobileMode&&(this.$.ya.IsMeetingLiveSession&&
la.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OpenInAppExcelReactDialog",!1)?(C.ULS.sendTraceTag(522859990,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app React dialog used"),(new l(this.$)).sg()):la.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseOpenInAppDialogCopyMobile",!1)?(C.ULS.sendTraceTag(574993315,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app dialog used"),(new m(this.$)).sg()):(C.ULS.sendTraceTag(574993314,
0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: Git-side open-in-app dialog used"),E.AFrameworkApplication.showOpenInAppDialog()))};d.prototype.axj=function($a,Ta){var pa=this;return E.AFrameworkApplication.isMobileMode&&!Z.a(this.$.ya,30)?(this.showOpenInAppDialog(),C.ULS.sendTraceTag(577300448,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: Open-in-app dialog invoked from cell double tap"),this.KBb("CellDoubleTap"),C.ULS.sendTraceTag(537162646,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view in mobile browser "),
!1):E.AFrameworkApplication.Pgc&&($a&&W.c(this.workbookContext.WorkbookFileName)||!this.workbookContext.FullDocumentInfo.HostEditUrl)?(C.ULS.sendTraceTag(537162645,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view a non-editable format .{0}, HostEditUrl {1}empty. Skipped prompt to edit",W.d(this.workbookContext.WorkbookFileName)?"xls":"csv",this.workbookContext.FullDocumentInfo.HostEditUrl?"not ":""),!1):T.a.any([25,26,30,31,56,32],function(Da){return pa.businessBar.ULa(Da)})?
(C.ULS.sendTraceTag(537162644,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view after opening in Edit by default"),!1):Ta&&H.a.N1i in Ta&&!$a?!1:!0};d.prototype.Ac=function($a,Ta){$a=!1;switch(Ta.command){case 1455037301:case -2044628748:case 2004484710:case -2028960985:case -974518828:case -1339961039:case -8805455:case -723527778:case 1783960667:case -1158102843:case -1355155015:case 257398710:case 214430355:case 1389557314:case 2145659238:case 1773624819:case 512141517:case 1118926154:case -1698025133:case 213236505:$a=
!0;break;case 480922297:case 520859864:$a=la.EwaSettings.isChangeGateEnabled("OfficeVSO:3773098_SaveDeferredActionDispatcherEnabled")?!0:!1;break;case -1285148982:case -75280711:case -455164169:$a=la.EwaSettings.ma(109);break;case -1388494670:$a=la.EwaSettings.ma(109);break;case 810888577:$a=la.EwaSettings.ma(271);break;case -1224038235:$a=this.$.ea.amIAlone;break;case -988468372:$a=la.EwaSettings.ma(302);break;case -1804063550:case -1059172980:case 1800405051:case -48469327:$a=!0,C.ULS.shipAssertTag(537162642,
0,this.$.nka,"Command execute requested for SaveAs or Copy operation when data duplication is disallowed.")}return $a};d.prototype.Qc=function(){return!1};d.prototype.tjj=function(){var $a=this;if(this.dc){var Ta=this.$;Ma.a(Ta).ft(new Hb.a(Db.a.fz,5,function(){Ta.$H(!1,!0);var pa=$a.clientWorkflow.fd.activityState;pa[db.a.Rq]=Db.a.vda;pa[Va.a.sT]=2;pa[dc.a.Cs]=Ta.isEditMode;pa[Va.a.xga]=!1}))}};d.prototype.saveACopy=function(){var $a=this;if(this.dc){var Ta=this.$;Ma.a(Ta).ft(new Hb.a(Db.a.fz,5,
function(){Ta.$H(!1,!1);var pa=$a.clientWorkflow.fd,Da=pa.activityState;Da[db.a.Rq]=Db.a.yUf;Da[nb.a.sYb]=$a.ic.hasUnsupportedFeaturesForEdit;Da[Va.a.xga]=!1;pa.Bt(va.a.jaa($a.businessBar.d7c,[-502303485]))}))}};d.prototype.qAc=function($a){var Ta=this;Ma.a(this.$).ft(new Hb.a(Db.a.hna,2,function(){Ta.$.$H(!0,!0);var pa=zb.a(Ta.$).fd,Da=Ta.$.isEditMode;Da=va.a.Wc(1,1,0,0,0,Da?-315732528:-2087635043,Da?"DeploymentInvalidEditSession":"InvalidOrTimedOutSession");Da.ForceVersionUpgrade=$a;pa.Bt([Da]);
pa=zb.a(Ta.$).fd.activityState;pa[db.a.Rq]=Db.a.hna;pa[dc.a.Cs]=Ta.$.isEditMode;pa[Va.a.xga]=!1}))};d.prototype.closeWorkbook=function(){var $a=this;if(this.dc){var Ta=this.$;Y.a.rg.Gwc("2145659238")?x.TaskExtensions.Ba(this.RJ.value,function(pa){pa.result.xj(I.a.NRe,{})},this.la,3):Ma.a(Ta).ft(new Hb.a(Db.a.fz,5,function(){Ta.$H(!0,!1);var pa=$a.clientWorkflow.fd.activityState;pa[Va.a.gY]=!1;pa[Va.a.xga]=!1;$a.ic.inViewerFromWebPart?(fa.a.gFd(Ta,$a.clientWorkflow.fd),Ta.Ok.Jy("InViewerFromWebPart"),
pa[db.a.Rq]=Db.a.x_):(pa[db.a.Rq]=Db.a.Ek,Ta.Bd&32?pa[Va.a.sT]=0:(pa[Va.a.sT]=1,pa[Va.a.hYb]=new yb.a),pa[wc.a.Lje]=!0)}))}};d.prototype.m3g=function(){var $a=this,Ta=this.ic.vbaRemovedDuringConversion;C.ULS.sendTraceTag(537162636,0,50,"FileOperationsCommandHandler.CopyAndEditWorkbook: vbaRemovedDuringConversion = {0}",Ta);var pa=this.$;Ta?Ma.a(pa).ft(new Hb.a(Db.a.fz,5,function(){var Da=va.a.Wc(3,0,0,1246,0,1069271157,"XLSMacroFailure");$a.clientWorkflow.fd.Bt([Da]);$a.clientWorkflow.fd.activityState[db.a.Rq]=
Db.a.qeb})):E.AFrameworkApplication.hideHeader?La.HelperMethods.Ze(this.Q6b.CopyAndEditUrl,"_blank",void 0,"FileOperationCommandHandler.CopyAndEditUrl"):Q.a.ntw(this.Q6b.CopyAndEditUrl,pa)};d.prototype.reloadWorkbookInEditMode=function(){var $a=this;if(this.dc)if(la.EwaSettings.isChangeGateEnabled("OfficeVSO:4585988_RefreshRibbonCookieOnModeRefresh")&&Y.a.rg.xV&&Y.a.rg.TGd(),E.AFrameworkApplication.Pgc&&!E.AFrameworkApplication.Gka)La.HelperMethods.Ze(this.$.Sob(!0),N.a.blank,void 0,"FileOperationCommandHandler.BuildHostUrl");
else{var Ta=this.$,pa=!1,Da=this.ic.hasUnsupportedFeaturesForEdit,rb=this.workbookContext.FileWasRepaired;W.d(this.workbookContext.WorkbookFileName)?(pa=!0,C.ULS.sendTraceTag(537162634,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an XLS file, unsupported features = {0}",Da)):W.a(this.workbookContext.WorkbookFileName)&&(pa=!0,C.ULS.sendTraceTag(537162633,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an CSV file"));var Ab=Ta.Lf.get(59);Ab=!(Ta.ea.ic.supportsEditing&&
Ab);if(pa&&!Da||Ab&&(pa||Da)){var ob=Ab?Da?-2066104278:816071846:la.EwaSettings.isChangeGateEnabled("OfficeVSO:4035916_RemoveConvertInTeams")&&Z.a(this.$.ya,25)&&!this.$.Lzb?765011943:-213064907;pa=function(){var sb=va.a.OZa([ob]);$a.clientWorkflow.fd.Bt(sb);$a.clientWorkflow.fd.activityState[db.a.Rq]=Db.a.qeb}}else pa=function(){Ta.$H(!0,!1);var sb=$a.clientWorkflow.fd,Pb=sb.activityState;Pb[Va.a.sT]=1;Pb[bb.a.mYb]=F.a.$kc;Pb[dc.a.Cs]=!0;Pb[nb.a.sYb]=$a.ic.hasUnsupportedFeaturesForEdit;Pb[Va.a.xga]=
!!$a.workbookContext.EditUrl;Pb[qb.a.f2]=$a.workbookContext.EditUrl;if(!$a.Q6b.CopyAndEditUrl){var Aa=[la.EwaSettings.isChangeGateEnabled("OfficeVSO:4035912_RemoveEditACopyInTeams")&&Z.a($a.$.ya,25)&&!$a.$.Lzb?-943219229:1821390342];sb.Bt(va.a.jaa($a.businessBar.d7c,Aa))}rb&&!Da?(W.b($a.workbookContext.WorkbookFileName)&&la.EwaSettings.isChangeGateEnabled("OfficeVSO:5693008_CGForFlightODFRepairEnabled")?(sb=va.a.OZa([-425642652]),C.ULS.sendTraceTag(537162631,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an .ods file")):
sb=va.a.OZa([108482388]),$a.clientWorkflow.fd.Bt(sb),Pb[db.a.Rq]=Db.a.MUf):$a.$.ea.k6e?(C.ULS.sendTraceTag(546111811,0,50,"Password-To-Modify Workbook: User trying to switch to edit-mode."),gb.b().$Sd("DialogShown","Password-To-Modify Workbook: Logging StopWatch duration after user tries to switch to exclusive edit-session","PasswordToModifyDialogShown"),Pb[db.a.Rq]=Db.a.zFb):Pb[db.a.Rq]=$a.$.ea.Agc?Db.a.nBb:Db.a.qeb};Ma.a(Ta).ft(new Hb.a(Db.a.fz,5,pa))}};d.prototype.reloadWorkbookInViewMode=function(){var $a=
this;if(this.dc){la.EwaSettings.isChangeGateEnabled("OfficeVSO:4585988_RefreshRibbonCookieOnModeRefresh")&&Y.a.rg.xV&&Y.a.rg.TGd();var Ta=this.$;K.a.sh&&fb.g(Ta).Wb.textBox.blur();Ma.a(Ta).ft(new Hb.a(Db.a.fz,5,function(){Ta.$H(!Ta.ea.isNamedObjectViewMode,!1);var pa=$a.clientWorkflow.fd.activityState;pa[db.a.Rq]=Db.a.Hha;pa[Va.a.sT]=1;pa[Va.a.gY]=!0;pa[dc.a.Cs]=!1;pa[dc.a.ymb]=!0;pa[bb.a.mYb]=F.a.$kc}))}};d.prototype.reloadWorkbook=function($a,Ta){var pa=this;if(this.dc){var Da=this.$;Da.sQ&65536&&
Ma.a(Da).ft(new Hb.a(Db.a.fz,5,function(){Da.$H($a,!0);var rb=pa.clientWorkflow.fd.activityState;rb[db.a.Rq]=Db.a.Fk;rb[dc.a.xTc]=pa.workbookContext.NovMode;Ta||(rb[Va.a.sT]=1,rb[Va.a.hYb]=new e)}))}};d.prototype.setCalculationMode=function($a,Ta){function pa(){return new n(Ta)}var Da=this;C.ULS.sendTraceTag(537162629,0,50,"SetCalculationMode ,calculation mode chosen : {0} ",Ta);var rb=this.$.ea.workbookContext.CalcMode;this.$.ea.workbookContext.CalcMode=Ta;return ea.a(this.$.userOperationManager,
function(Ab,ob,sb){var Pb=Da.$.oa.xa;Ab=mb.b(Ab,d.CRi(Da.$,rb));ob=mb.a(ob,d.BRi(Da.$,rb));var Aa=Pb.Na(9,null);Aa.calc_type=Ta;return qa.g(Pb,"SetCalculationOptions",Aa,Ab,ob,sb,null,0)},function(Ab){return new ka.a(197,0,Ab,void 0,pa)},$a)};d.Jye=function($a){$a.ob&&0<$a.ob.uR&&$a.ob.B9c(function(Ta){Ta.Mt()})};d.CRi=function($a,Ta){return function(pa){va.a.Rg(pa.Errors)&&($a.ea.workbookContext.CalcMode=Ta,C.ULS.sendTraceTag(537162628,0,50,"OnSetCalcModeSucess: successCallback was called with errors for SetCalculationMode. reverting calc mode to {0}.  Error id names: {1}",
Ta,va.a.Dc(pa.Errors)))}};d.BRi=function($a,Ta){return function(){$a.ea.workbookContext.CalcMode=Ta;C.ULS.sendTraceTag(537162627,0,50,"OnSetCalcModeFailure: failedCallback was called for SetCalculationMode. reverting calc mode to {0})",Ta)}};Af.Object.defineProperties(d.prototype,{dc:{configurable:!0,enumerable:!0,get:function(){return this.$.ea.dc}},workbookContext:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext}},Q6b:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.FullDocumentInfo}},
clientWorkflow:{configurable:!0,enumerable:!0,get:function(){return zb.a(this.$)}},ic:{configurable:!0,enumerable:!0,get:function(){return this.$.ic}}});Object(u.a)(d,"FileOperationsCommandHandler",O.a,[403]);var oa=b(159),Ja=B.a;Rk(c,Ja);c.prototype.zd=function(){var $a=this,Ta=this.$,pa=[],Da=y.GetServiceTaskFactory.create(Ta.da,56,this.la,this.hb);pa.push(Da);var rb=y.GetServiceTaskFactory.Ra(Ta.da,5,4,this.hb);pa.push(rb);x.TaskExtensions.Ba(ma.Task.qL.apply(ma.Task,yk(pa)),function(){oa.b(Da)&&
$a.jd([new d(Ta,Da.result,new A.a(function(){return y.GetServiceTaskFactory.create(Ta.da,137,$a.la,$a.hb)}),rb.result)])},this.la,0)};c.ka=function($a){B.a.Qd(94,new c($a))};Object(u.a)(c,"FileOperationsCommandHandlerFactory",B.a,[]);b.d(D,"a",function(){return a})},1376:function(u,D,b){function a(){r.a.Fa(function(gb){m.ka(gb);c.ka(gb)})}function c(gb){return Ub.call(this,gb)||this}function d(gb,Db){var Va=this;this.zQi=function(yb,qb){if(!sa.a(yb)&&qb){var dc=!!yb&&!!yb.RequestTelemetryData;W.g(Va.$).ui.fla(qb,
yb.StateId,dc?yb.RequestTelemetryData.EcsOperationDuration:0,dc?yb.RequestTelemetryData.EcsRequestDuration:0,dc?yb.RequestTelemetryData.WfeRequestDuration:0)}};this.SHi=function(yb,qb){qb&&qb.c0b&&qb.c0b.SheetName&&qb.c0b.Ranges.length&&qb.Jfi&&qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&(yb=Kb.d(Va.$.va.pa),Va.PZg(new Ma.a(X.B(qb.c0b.Ranges[0]),yb)))};this.$=gb;this.Gg=Db}function e(gb,Db){var Va=mb.call(this,gb)||this;Va.ivb=function(yb){yb=
Va.hed(yb);return Va.Ebd(yb)};Va.rgj=function(yb,qb){var dc=Va.Rzb=qb[e.ugi];1===yb?(yb=qb[e.OBj],dc=Va.Q2e(yb,dc),A.ULS.shipAssertTag(537153996,0,dc!==e.lba,"ResizeHeadersDialogHandler - invalid size input, size = {0}",yb),yb=dc!==Va.Kkd,A.ULS.sendTraceTag(537153995,0,50,"ResizeHeadersDialog OK button pressed, isRow = {0}, isDefaultUnits = {1}, inputPx = {2}, inputChanged = {3}.",Va.isRow,Va.Rzb,dc,yb),yb&&Va.k4g(dc)):A.ULS.sendTraceTag(537153994,0,50,"ResizeHeadersDialog Cancel button pressed, isRow = {0}.",
Va.isRow)};Va.isRow=2040891415===Db.command;Va.gridView=W.g(Va.$);Va.xtc=new w(Va.$.workbookContext.DxDigitNormal);Va.Kkd=Va.sTg();gb=Va.W2g(Va.Kkd);Db=Va.Y2g(Va.Kkd);Va.Al=ha.a.instance.ga(Va.isRow?480:481);gb=Va.DM(gb,Db);Va.initializeAndShow(Va.Al,Va.rgj,gb);A.ULS.sendTraceTag(537153997,0,50,"ResizeHeaders React Dialog opened, isRow = {0}.",Va.isRow);return Va}function k(gb){this.resizeParameters=null;this.resizeParameters=gb}function l(gb,Db){this.isRow=!1;this.autoFitRange=null;this.isRow=gb;
this.autoFitRange=Db}function m(){var gb=ta.call(this)||this;gb.Eb();return gb}function f(gb,Db){var Va=xa.call(this,Db.domElement)||this;Va.HSf=!1;Va.NX=!1;Va.pSa=null;Va.t7a=null;Va.pj=null;Va.fKd=!0;Va.Chc=!1;Va.offset=0;Va.Uk=0;Va.jJb=0;Va.G0=null;Va.JW=null;Va.KM=null;Va.v5h="headerResizeTooltip";Va.Gtd=null;Va.dG=null;Va.Mza=!1;Va.O8=!1;Va.iXc=!1;Va.b$a=T.a.ewa;Va.tEf=T.a.ewa;Va.Laf=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6649809_AutoFitHiddenRowCol");Va.PCc=!1;Va.tN=function(yb){if(Va.grid.Rj)return!1;
yb=da.a(Va.grid.$).Sd(yb);if(3===yb.mb&&!Va.dhf(yb.Ca)||!Va.nHf(yb,!1))return!1;A.ULS.sendTraceTag(537154058,2,50,"HeaderResizeBehavior.OnMouseDown: About to generate tooltip");var qb=Va.Exc();Va.Lbd(yb.clientPoint,qb,!0);Va.Mza||(B.a.instance.qa(y.a.hh,Va.domElement.ownerDocument.body,Va.i9a),x.a.instance.qa(y.a.mg,Va.domElement.ownerDocument.body,Va.i9a),Va.Mza=!0);Va.Ycf()&&Va.NX&&Va.E8e(yb);return!1};Va.UDb=function(yb){yb=da.a(Va.grid.$).Sd(yb);Va.Ycf()&&Va.iXc&&Va.E8e(yb);if(qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6093232_ResizeRowColUsingTouch")){if(!yb.Ca.type.includes("touch")&&
yb.Ca.button!==Sys.UI.MouseButton.leftButton||!Va.D6a)return!1}else if(yb.Ca.button!==Sys.UI.MouseButton.leftButton||!Va.D6a)return!1;Y.g(yb.Ca);Va.AKe();yb=Va.grid.Rj?Va.b$a:T.a.ewa;if(Va.grid.Rj&&Va.pj)var qb=yb!==Va.Uk||!Va.Laf&&Va.O8;else Va.pj&&(yb=Va.O8?Va.edd():Va.pj.c4()),qb=yb!==Va.Uk;if(Va.pSa&&qb&&yb!==T.a.ewa){yb=Va.grid;qb=Va.tfd(yb);var dc={};dc.SheetMultiRange=X.r(qb,yb.$);f.yOd(dc,Va.isRow,Va.Uk);Va.Hkh(dc);yb.ZGj=!0}else Va.vg(null,null),Va.AHb();Va.O8=!1;return Va.PCc=!1};Va.oca=
function(yb){if(Va.grid.Rj)return!1;yb=C.a.create(yb.eventName,yb.zb,yb.Ca,yb.mb);yb=da.a(Va.grid.$).Sd(yb);if(!Va.nHf(yb,!0))return!1;yb=Va.grid;var qb=Va.tfd(yb);qb=X.r(qb,yb.$);yb.qb.eh([Va.isRow?13:14]);yb.qb.SRa();Va.AHb();var dc={};yb.$.Fd(Va.isRow?146338636:1391094586,Q.a.Cb,30,(dc.autoFitRanges=qb,dc));return!1};Va.wxf=function(yb){Va.NX?(Va.O8&&!Va.PCc&&Va.cBg(),Va.Chc||Va.Y9e(),yb=new Sys.UI.DomEvent(yb),yb=C.a.create(y.a.lha,Va.domElement,yb,2),yb=da.a(Va.grid.$).Sd(yb),Va.xxf(yb.clientPoint,
void 0)):A.ULS.sendTraceTag(521480320,2,50,"HeaderResizeBehavior.onHeaderResizeChanged: Reached during no resize mode. cellAbsoluteIndex = "+(Va.pj?Va.pj.Xie:-1)+", isRow = "+Va.isRow)};Va.yxf=function(yb){yb=new Sys.UI.DomEvent(yb);yb=C.a.create(y.a.lha,Va.domElement,yb,2);Va.UDb(yb)};Va.GMi=function(yb){Va.mya(yb,Va.pj,!1)};Va.i9a=function(yb){yb=da.a(Va.grid.$).Sd(yb);qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6195348_StopBubblingOnDocumentMouseMoveInnerEvent")&&Y.g(yb.Ca);return Va.xxf(yb.clientPoint,
yb.Ca)};Va.XH=function(yb){if(Va.grid.Rj)return!1;yb=da.a(Va.grid.$).Sd(yb);var qb;if(!Va.Bff||-1!==Va.grid.ha.selectionType)return S.a(Va.grid.$).Pp()&&(qb=Va.Tdd(yb))&&(qb.Eva.style.cursor=""),!1;if(Va.NX)return Va.Y9e(),!1;qb=Va.Tdd(yb);if(!qb)return!1;qb.Eva.style.cursor=!Va.grid.isEditing&&Va.Uqd(qb)?Va.isRow?"row-resize":"col-resize":"";Y.g(yb.Ca);return!0};Va.hp=function(){Va.AHb()};Va.vg=function(){if((3===Q.a.Cb||G.a.Zo)&&Va.grid.ha.sa.tg){var yb=Va.grid.ha.sa.Vc;if(!(!yb.isRow&&!yb.Ue||
!Va.domElement||yb.isRow&&Va.isRow&&!Array.contains(Va.Ge.Fn,yb.top)||yb.Ue&&!Va.isRow&&!Array.contains(Va.Ge.Fn,yb.left))){var qb=Va.grid.gg(yb,Va.Ge.oj.paneType);if(qb){if(Va.grid.Rj){var dc=Va.isRow?yb.bottom:yb.right;Va.pj=Va.Ge.Nr(H.Range.Tc(yb.bottom,yb.right));if(!Va.pj){A.ULS.sendTraceTag(522826880,2,50,"HeaderResizeBehavior.onSelectionEnded: Cell being resized is undefined. Couldn't create touch resizer. Absolute index "+dc+", is row "+Va.isRow);return}}Va.dG||Va.E$g();yb.isRow&&Va.isRow?
(ka.DOMElementExtensions.setVisible(Va.dG,!0),Va.dG.style.top=qb.bottomRight.y-Va.dG.offsetHeight/2+"px"):yb.isRow||Va.isRow||(ka.DOMElementExtensions.setVisible(Va.dG,!0),ia.c(Va.dG.style,Va.grid.rtl,qb.bottomRight.x-Va.dG.offsetWidth/2+"px"))}}}};Va.sF=function(yb,qb){qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6385697_HeaderResize_LogOnPartialInteractivityStatusChanged")&&A.ULS.sendTraceTag(521787422,2,50,"HeaderResizeBehavior.onPartialInteractivityStatusChanged: was called. isActivated "+qb.LL);
qb.LL&&Va.tpb()};Va.Ge=Db;Va.isRow=Db.isRow;Va.rtl=Db.oj.rtl;Va.grid=gb;Va.Cof=Va.isRow?T.a.lvd:T.a.Ekc;Va.r5h=ha.a.instance.ga(439);Va.A5h=ha.a.instance.ga(438);Va.u5h=ha.a.instance.ga(440);wa.a(Va.grid.$,function(yb){Va.Gtd=yb.WP(ca.a.zgj,!1)});Va.R7i();Va.grid.ha.sP(Va.vg);Va.grid.ha.t2(Va.hp);Va.grid.Ft(Va.vg);S.a(Va.grid.$).Tf.E9(Va.sF);return Va}function w(gb){this.F6c=gb}function n(gb,Db,Va,yb,qb,dc,bb){this.Eva=gb;this.CCb=Db;this.cOa=Va;this.Eid=yb;this.Abb=qb;this.chf=dc;this.y4h=bb}function z(){}
var r=b(11);u=b(0);var v=b(232),A=b(15),B=b(245),y=b(13),x=b(161),C=b(728),G=b(25),E=b(233),I=b(4),U=b(279),M=b(87),T=b(8),F=b(31);z.arh="ewa-resizehdr-row-hidden";z.$qh="ewa-resizehdr-col-hidden";Object(u.a)(z,"CssClassNames",null,[]);var K=b(18),J=b(65),O=b(60),N=b(5),H=b(24),Q=b(76),ca=b(133),X=b(45),Z=b(151),ea=b(53),ka=b(12),Y=b(69),qa=b(1),fa=b(10),ha=b(14),ia=b(261),wa=b(134),Qa=b(391),S=b(42);Object(u.a)(n,"HeaderEventCachedInfo",null,[]);w.prototype.tBe=function(gb){gb=fa.HelperMethods.VCd(gb);
return Math.max(0,Math.min(w.Rof,gb))};w.prototype.kBe=function(gb){return this.tYi(gb)};w.prototype.QZg=function(gb){return Math.round(this.F6c*gb+2*this.UXe()+1)};w.prototype.tYi=function(gb){return Math.max(0,Math.min(w.zof,(Math.max(0,Math.min(T.a.Ekc,gb))-2*this.UXe()-1)/this.F6c))};w.prototype.UXe=function(){return Math.floor(Math.max((this.F6c+3)/4,2))};w.prototype.mbc=function(gb,Db){return Db?gb?w.Rof:T.a.lvd:gb?w.zof:T.a.Ekc};w.Rof=409;w.zof=255;Object(u.a)(w,"ResizeHeadersConverter",null,
[]);var da=b(33),xa=M.a;Rk(f,xa);f.prototype.mya=function(gb,Db,Va){gb=new Sys.UI.DomEvent(gb);gb=C.a.create(y.a.lha,this.domElement,gb,2);gb=da.a(this.grid.$).Sd(gb);this.mHf(Db,gb.clientPoint.x,gb.clientPoint.y,!1,Va);Db=this.Exc();this.Lbd(this.pSa,Db,!0);this.Mza||(Db=this.domElement.ownerDocument.body,Db.addEventListener(y.a.lha,this.wxf),Db.addEventListener(y.a.rGa,this.yxf),this.Mza=!0)};f.prototype.EMi=function(gb,Db,Va){this.mHf(Db,gb.clientX,gb.clientY,!0,this.Laf?Va:!1);gb=this.grid;Db=
this.tfd(gb);Db=X.r(Db,gb.$);gb.qb.eh([this.isRow?13:14]);gb.qb.SRa();this.AHb();Va={};gb.$.Fd(this.isRow?146338636:1391094586,Q.a.Cb,30,(Va.autoFitRanges=Db,Va))};f.prototype.dispose=function(){this.Z_c();this.grid.ha&&(this.grid.ha.zW(this.vg),this.grid.ha.Q6(this.hp));this.grid.Fw(this.vg);S.a(this.grid.$)&&S.a(this.grid.$).Tf.hda(this.sF);E.a.instance.Aa(y.a.$j,this.domElement,this.oca);B.a.instance.Aa(y.a.Nd,this.domElement.ownerDocument.body,this.UDb);x.a.instance.Aa(y.a.qe,this.domElement.ownerDocument.body,
this.UDb);G.a.Zo||(B.a.instance.Aa(y.a.pointerDown,this.domElement,this.tN),B.a.instance.Aa(y.a.hh,this.domElement,this.XH));this.Mza&&(B.a.instance.Aa(y.a.hh,this.domElement.ownerDocument.body,this.i9a),x.a.instance.Aa(y.a.mg,this.domElement.ownerDocument.body,this.i9a),this.Mza=!1);this.dG&&(B.a.instance.Aa(y.a.pointerDown,this.dG,this.tN),E.a.instance.Aa(y.a.$j,this.dG,this.oca),this.Z_c(),this.dG=null);this.HSf&&(ka.DOMElementExtensions.gf(f.Bbb),f.Bbb=null);this.Ge=null;xa.prototype.dispose.call(this)};
f.prototype.R7i=function(){E.a.instance.qa(y.a.$j,this.domElement,this.oca);B.a.instance.qa(y.a.Nd,this.domElement.ownerDocument.body,this.UDb);x.a.instance.qa(y.a.qe,this.domElement.ownerDocument.body,this.UDb);G.a.Zo||(B.a.instance.qa(y.a.pointerDown,this.domElement,this.tN),B.a.instance.qa(y.a.hh,this.domElement,this.XH))};f.prototype.plh=function(){if(!f.Bbb){document.getElementById(f.GSf);this.HSf=!0;var gb=f.Bbb=document.createElement("div");this.grid.$.frame.Faa().appendChild(gb);gb.id=f.GSf;
gb.className=F.a.brh;ka.DOMElementExtensions.setVisible(gb,!1)}};f.prototype.AKe=function(){if(this.Mza){var gb=this.domElement.ownerDocument.body;this.grid.Rj?(gb.removeEventListener(y.a.lha,this.wxf),gb.removeEventListener(y.a.rGa,this.yxf)):(B.a.instance.Aa(y.a.hh,gb,this.i9a),x.a.instance.Aa(y.a.mg,gb,this.i9a));this.Mza=!1}this.NX=!1;qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")?this.LOf():(this.iTf(),this.cId());Qa.c(this.grid.$,!0,"HeaderResizeBehavior:PrepareResizeOperation")};
f.prototype.iTf=function(){this.grid.qb.eh([this.isRow?13:14]);this.grid.qb.SRa()};f.prototype.cBg=function(){this.Ge.addRowColToModel(this.pj.Xie-1,this.pj.t9i);this.PCc=!0};f.prototype.xxf=function(gb,Db){if(!this.NX)return!1;this.grid.Rj||qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6195348_StopBubblingOnDocumentMouseMoveInnerEvent")||Y.g(Db);Db=this.isRow;if(!this.grid.Rj&&!this.G0){this.G0=document.createElement("div");this.G0.style.cssText="position: relative; width: inherit; height: inherit;"+
(Db?"top: 0px; ":this.rtl?"right: 0px:":"left: 0px:");for(var Va=this.pj.QJ();Va.nextSibling;)this.G0.appendChild(Va.nextSibling);Va.parentNode.appendChild(this.G0)}Va=Db?gb.y-this.t7a.y:(this.rtl?-1:1)*(gb.x-this.t7a.x);var yb=Db?gb.y-this.pSa.y:(this.rtl?-1:1)*(gb.x-this.pSa.x),qb=this.grid.Rj?this.b$a:this.pj.c4();if(qb===T.a.ewa)return!1;Va&&(0<this.Uk||0<qb+yb)&&qb+yb<=this.Cof&&(this.Uk=this.Exc(yb),this.Lbd(gb,this.Uk,!1),this.grid.Rj?this.Uk>=f.G6e?(this.fKd=!0,this.pj.setCellExtent(this.Uk)):
this.fKd&&(this.fKd=!1,this.pj.setCellExtent(f.G6e)):(ka.DOMElementExtensions.woa(this.pj.QJ(),!Db,Math.max(this.jJb+yb,0)),this.G0.style[Db?"top":this.rtl?"right":"left"]=Math.max(yb,-this.jJb)+"px"),Va=(this.grid.Rj?this.tEf:Db?this.pj.Ge.cE:this.pj.Ge.dE)+Math.max(yb,this.grid.Rj?-this.b$a+f.Fcc:-this.jJb),ka.DOMElementExtensions.woa(this.pj.Ge.domElement,!Db,Va),this.grid.Rj&&this.pj.Ge.yoj(Va),this.t7a=new Sys.UI.Point(gb.x,gb.y),ka.DOMElementExtensions.setVisible(this.dG,!1));return!0};f.prototype.c4=
function(){return this.pj?this.O8?f.I5h:this.pj.c4():T.a.ewa};f.prototype.Lbd=function(gb,Db,Va){this.KM&&Va&&(A.ULS.sendTraceTag(537154051,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),this.cId());this.KM||Va||A.ULS.sendTraceTag(537154050,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead");this.Gtd&&this.Gtd(function(){var yb={};return yb.Location="canvas",
yb});this.KM?this.pVe(Db):(this.KM=document.createElement("div"),this.KM.id=this.v5h,this.pVe(Db),this.KM.className=F.a.uph,Db=document.getElementById(this.grid.$.yb+N.a.pqf),Db.insertBefore(this.KM,Db.firstChild),gb=da.a(this.grid.$).xja(gb),this.KM.style.left=(this.rtl?Math.max(gb.x-this.KM.offsetWidth,0):gb.x-Math.max(gb.x+this.KM.offsetWidth-Db.offsetWidth,0)).toString()+"px",Db=document.getElementById(N.a.$Fa),this.KM.style.top=(gb.y-(I.AFrameworkApplication.ta&&I.AFrameworkApplication.ta.Pa.Pf?
0:Db.offsetHeight)-this.KM.offsetHeight).toString()+"px")};f.prototype.cId=function(){ka.DOMElementExtensions.gf(this.KM);this.KM=null};f.prototype.pVe=function(gb){var Db=new w(this.grid.$.workbookContext.DxDigitNormal);Db=this.isRow?Db.tBe(gb).toFixed(2):Db.kBe(gb).toFixed(2);this.KM.innerText=String.format("{0} {1} ({2} {3})",this.isRow?this.r5h:this.A5h,Db,gb.toString(),this.u5h)};f.prototype.nHf=function(gb,Db){var Va;if(-1!==this.grid.ha.selectionType||2===gb.mb&&gb.Ca.button!==Sys.UI.MouseButton.leftButton||
!this.Uqd(Va=this.Tdd(gb))||!this.Bff)return!1;Y.g(gb.Ca);this.pSa=this.t7a=new Sys.UI.Point(gb.clientPoint.x,gb.clientPoint.y);this.SSg(Va,Db);if(!this.pj)return!1;this.NX=!0;this.xli(this.pj,Va)&&this.z9h();this.jJb=this.edd();return this.oHf(Db)};f.prototype.mHf=function(gb,Db,Va,yb,qb){this.NX=!0;this.O8=qb;this.pj=gb;this.Chc=!1;this.pSa=this.t7a=new Sys.UI.Point(Db,Va);gb=this.pj.getRange();this.JW=qb?this.joe(gb):gb;this.b$a=this.c4();this.tEf=this.isRow?this.pj.Ge.cE:this.pj.Ge.dE;this.oHf(yb)};
f.prototype.oHf=function(gb){var Db={};wa.b(this.grid.$).Cd(ca.a.qgj,(Db.IsResizingHiddenHeader=this.O8,Db.IsAutoFitting=gb,Db.NumberOfSelectedRanges=this.grid.ha.sa.sK,Db.Location="canvas",Db));this.offset=this.pj.Paa();this.Uk=this.grid.Rj?this.b$a:this.pj.c4();if(this.Uk===T.a.ewa)return!1;Qa.c(this.grid.$,!1,"HeaderResizeBehavior:prepareResizeOperationInternal");return!0};f.prototype.xli=function(gb,Db){var Va=this.pj.QJ();if(!Va)return A.ULS.shipAssertTag(537154049,2,!1,"cell being resized element received is null"),
!1;Va=Va.nextSibling;if(!Va)return!1;gb=gb.getRange();Va=this.Ge.Mua(Va).getRange();if(!gb||!Va)return A.ULS.shipAssertTag(537154048,2,!1,"IsResizingHidden: range is null"),!1;var yb=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6101474_EnableUnhideRowByMouseDrag");gb=yb&&this.isRow?gb.bottom:gb.right;Va=yb&&this.isRow?Va.bottom:Va.right;return gb+1!==Va&&gb!==Va&&this.Uqd(Db,!0)};f.prototype.z9h=function(){var gb=this.pj.QJ(),Db=this.Ge.Mua(gb.nextSibling);f.yli(Db,this.isRow)?(this.pj=Db,this.JW=
this.pj.getRange()):(this.dBg(gb),this.pj=Db,gb=this.pj.getRange(),this.JW=this.joe(gb),this.O8=!0)};f.prototype.joe=function(gb){return this.isRow?new H.Range(gb.top-1,gb.left,gb.top-1,gb.right,!1,!0):new H.Range(gb.top,gb.left-1,gb.bottom,gb.left-1,!1,!0)};f.prototype.dBg=function(gb){var Db=this.Ge.Mua(gb.nextSibling),Va=f.I6g(Db,this.isRow,this.rtl);Va&&gb.parentNode.insertBefore(Va,Db.QJ())};f.prototype.tfd=function(gb){var Db=this.JW,Va=gb.ha.sa.selectedRanges;if(gb.ha.sa.jsb(Db))if(this.isRow){if(U.a.all(Va,
function(yb){return yb.isRow}))return Va}else if(U.a.all(Va,function(yb){return yb.Ue}))return Va;return[Db]};f.prototype.getCellExtent=function(){return this.pj.getCellExtent()};f.prototype.edd=function(){var gb=this.pj.QJ().style;return Math.max(0,Math.min(this.Cof,0|parseInt(this.isRow?gb.height:gb.width,10)))};f.prototype.Exc=function(gb){gb=void 0===gb?0:gb;var Db=this.grid,Va=this.Ge.oj.paneType;Va=this.isRow?3===Va?[3,2]:[1,4]:4===Va?[2,4]:[1,3];var yb=Db.view.visibleArea.bottomRight,qb=Math.max(this.grid.Rj?
this.b$a:this.pj.c4(),0);gb=this.O8&&!this.grid.Rj?Math.max(this.edd(),0):Math.max(qb+gb,0);yb=this.isRow?new O.a(0,this.offset,yb.x,gb):new O.a(this.offset,0,gb,yb.y);qb=[this.isRow?13:14];Db.qb.Wi(H.Range.Tc(1,1),qb,!1);Db.qb.qn(qb,yb,Va);return gb};f.prototype.Z_c=function(){this.JW=this.pSa=this.t7a=null;if(this.G0){var gb=this.G0.parentNode;if(gb)for(gb.removeChild(this.G0);this.G0.firstChild;)gb.appendChild(this.G0.firstChild);this.G0=null}this.pj=null;this.NX=!1;qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")||
this.LOf()};f.prototype.LOf=function(){this.Chc=!1;this.cId();ka.DOMElementExtensions.setVisible(f.Bbb,!1);ka.DOMElementExtensions.setVisible(this.dG,!1);qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")&&this.iTf()};f.prototype.Tdd=function(gb){if(ka.DOMElementExtensions.nz(gb.zb,"a"))return null;var Db=this.dhf(gb.Ca);if(Db&&this.grid.ha.sa.tg){var Va=this.grid.ha.sa.Vc;Va=this.Ge.Nr(H.Range.Tc(Va.bottom,Va.right))}else Va=this.Ge.Mua(gb.zb);if(!Va)return null;var yb=
Va.QJ(),qb=new Sys.UI.Bounds(yb.offsetLeft,yb.offsetTop,yb.offsetWidth,yb.offsetHeight),dc=ka.DOMElementExtensions.getBoundingClientRect(gb.zb);dc=new Sys.UI.Point(gb.clientPoint.x-dc.x,gb.clientPoint.y-dc.y);this.isRow&&!Db&&(dc.y+=fa.HelperMethods.FC(gb.zb,yb,this.rtl).y);return new n(yb,dc,qb,Va.getRange(),Math.max(f.tAi,Math.min(f.pzi,(this.isRow?qb.height:qb.width)*f.Agj)),Db,!this.isRow&&0<yb.getElementsByTagName("input").length)};f.prototype.Uqd=function(gb,Db){Db=void 0===Db?!1:Db;if(!gb||
this.grid.isEditing)return!1;if(gb.chf)return!0;var Va=gb.cOa,yb=gb.Abb,qb=this.Ge.oj.paneType,dc=this.grid.Ef(qb).Ug,bb=!!dc&&dc.top===gb.Eid.top,db=!!dc&&dc.left===gb.Eid.left;qb=!!dc&&dc.bottom===gb.Eid.bottom&&(3===qb||2===qb);this.isRow?(db=gb.CCb.y,gb=db<=yb&&!bb,Va=db>=Va.height-yb-(qb?f.RDh:0),Db=Db?gb:Va||gb):(qb=gb.y4h,bb=this.rtl,dc=gb.CCb.x,gb=dc<=yb&&(!db||bb)&&(!qb||!bb),Va=dc>=Va.width-yb&&(!bb||!db)&&(!qb||bb),Db=Db?bb?Va:gb:gb||Va);return Db};f.prototype.SSg=function(gb,Db){var Va=
this.isRow;if(gb.chf)this.pj=this.Ge.Mua(gb.Eva);else if(Va&&gb.CCb.y<=gb.Abb&&gb.cOa.height>gb.Abb||!Va&&gb.cOa.width>gb.Abb&&(!this.rtl&&gb.CCb.x<=gb.Abb||this.rtl&&gb.CCb.x>=gb.cOa.width-gb.Abb)){if(this.pj=gb.Eva.previousSibling?this.Ge.Mua(gb.Eva.previousSibling):this.LQh(),Db&&gb.Eva.classList.contains(Va?F.a.iQe:F.a.hQe)&&(gb=this.Ge.Mua(gb.Eva)))gb=gb.getRange(),this.JW=Va?new H.Range(gb.top-1,gb.left,gb.top-1,gb.right,!1,!0):new H.Range(gb.top,gb.left-1,gb.bottom,gb.left-1,!1,!0)}else this.pj=
this.Ge.Mua(gb.Eva);!this.JW&&this.pj&&(this.JW=this.pj.getRange())};f.prototype.LQh=function(){var gb=this.isRow?1:0;return(gb=this.Ge.oj.gG(this.Ge.oj.Ea.Hg(this.grid.$.pa,J.a.kM(this.Ge.position.X+gb-1,this.Ge.position.Y-gb,this.Ge.position.PaneType))))?gb.KQh():null};f.prototype.Y9e=function(){this.Chc=!0;var gb=this.Bgj;ka.DOMElementExtensions.setVisible(gb,!0);gb.style.cursor=this.isRow?F.a.qNe:F.a.bMe;this.Exc()};f.prototype.Hkh=function(gb){var Db={};this.grid.$.Fd(this.isRow?745189930:-445963340,
Q.a.Cb,30,(Db.resizeRowColumnParameters=gb,Db))};f.prototype.E$g=function(){var gb=document.createElement("div");gb.className=F.a.$rh;var Db=document.createElement("div");Db.className=K.a.RA;gb.appendChild(Db);var Va=document.createElement("img");Va.src=ea.a.Te(0);Va.className=this.isRow?K.a.Zqh:K.a.Uqh;Db.appendChild(Va);this.Ge.GA.domElement.parentNode.insertBefore(gb,this.Ge.GA.domElement);this.grid.Rj?gb.addEventListener(y.a.kha,this.GMi):(B.a.instance.qa(y.a.pointerDown,gb,this.tN),E.a.instance.qa(y.a.$j,
gb,this.oca));ka.DOMElementExtensions.setVisible(gb,!1);this.dG=gb};f.prototype.AHb=function(){this.Z_c();this.dG&&(this.Ge.GA.domElement.parentNode.removeChild(this.dG),this.dG=null)};f.prototype.dhf=function(gb){return ka.DOMElementExtensions.nf(this.dG,gb.target)};f.prototype.tpb=function(){this.NX&&(this.AKe(),ka.DOMElementExtensions.woa(this.pj.QJ(),!this.isRow,this.jJb),this.AHb(),this.PCc=this.O8=!1)};f.prototype.Ycf=function(){return qa.EwaSettings.ma(682)};f.prototype.E8e=function(gb){(gb=
gb.Ca.rawEvent)&&gb.detail===f.glj&&(gb.type===y.a.Tp?(this.NX=!1,this.iXc=!0):gb.type===y.a.QH&&(this.NX=!0,this.iXc=!1))};f.E6g=function(gb,Db){return new f(gb,Db)};f.yOd=function(gb,Db,Va){if(Db)for(gb.ColumnWidth=-1,gb.RowHeight=Va,gb=ak(gb.SheetMultiRange.Ranges),Db=gb.next();!Db.done;Db=gb.next())Db=Db.value,Db.FirstColumn=0,Db.LastColumn=0;else for(gb.RowHeight=-1,gb.ColumnWidth=Va,gb=ak(gb.SheetMultiRange.Ranges),Db=gb.next();!Db.done;Db=gb.next())Db=Db.value,Db.FirstRow=0,Db.LastRow=0};f.yli=
function(gb,Db){if(!gb||!gb.QJ())return A.ULS.shipAssertTag(537154014,2,!1,"header after hidden headers is null"),!1;var Va=gb.getRange();gb=gb.QJ().style;if(!Va||!gb)return A.ULS.shipAssertTag(537154013,2,!1,"header range or style is null"),!1;gb=Db?gb.height:gb.width;return(Db?Va.top:Va.left)===(Db?T.a.vh:T.a.Eh)&&gb===f.xgg};f.I6g=function(gb,Db,Va){if(!gb)return A.ULS.shipAssertTag(537154012,2,!1,"header after hidden is null"),null;var yb=gb.QJ();if(!yb||!yb.style)return A.ULS.shipAssertTag(537154011,
2,!1,"header after hidden element or style is null"),null;gb=document.createElement("div");var qb=yb.style;gb.style.top=Db?qb.top:f.xgg;Db||(Va?gb.style.right=qb.right:gb.style.left=qb.left);gb.classList.add(Db?z.arh:z.$qh);gb.classList.add(Db?F.a.ktb:F.a.jtb);Va=document.createElement("div");Va.classList.add(Db?F.a.VPe:F.a.n9c);yb=Db?Number.parseInvariant(yb.innerText):H.Range.P_a(yb.innerText);Va.innerText=Db?(yb-1).toString():H.Range.MP(yb-1);gb.appendChild(Va);return gb};Af.Object.defineProperties(f.prototype,
{D6a:{configurable:!0,enumerable:!0,get:function(){return this.NX}},Bff:{configurable:!0,enumerable:!0,get:function(){var gb=(new Z.a(this.grid.$.va)).Vd(this.isRow?16:8),Db=this.grid.$.ob.sz,Va=this.grid.xi,yb=S.a(this.grid.$).Pp();return gb&&!Db&&!Va&&!yb}},Bgj:{configurable:!0,enumerable:!0,get:function(){this.plh();return f.Bbb}}});f.tAi=0;f.pzi=5;f.Fcc=1;f.G6e=1;f.I5h=0;f.RDh=3;f.Agj=.1;f.GSf="ewa-rszrbg";f.xgg="0px";f.glj=2;f.Bbb=null;Object(u.a)(f,"HeaderResizeBehavior",M.a,[610]);var ta=v.a;
Rk(m,ta);m.prototype.create=function(){this.pb(f.E6g)};m.ka=function(gb){gb.da.Ga(136,new m)};Object(u.a)(m,"HeaderResizeBehaviorFactory",v.a,[]);var ab=b(905),Na=b(51),Ka=b(37),la=b(178),Ea=b(447),ra=b(564),na=b(389),ba=b(177),sa=b(296),ya=b(295),va=b(74),W=b(21);Object(u.a)(l,"MacroRecorderSheetRowsColumnsAutoFitPayload",null,[409]);Object(u.a)(k,"MacroRecorderSheetRowsColumnsResizedPayload",null,[409]);var La=b(85);v=b(390);var Ia=b(22),mb=v.a;Rk(e,mb);e.prototype.DM=function(gb,Db){var Va={};
return Va[e.z4]=this.nc,Va[e.Lli]=this.isRow,Va[e.X9h]=gb,Va[e.W9h]=Db,Va[e.Fii]=this.Rzb,Va[e.ged]=this.ivb,Va};e.prototype.sTg=function(){var gb=this.dHh();try{return this.KLh(gb)}finally{gb&&gb.dispose()}};e.prototype.k4g=function(gb){var Db={};Db.SheetMultiRange=X.r(this.gridView.ha.sa.selectedRanges,this.$);e.yOd(Db,this.isRow,gb);gb={};this.$.Fd(this.isRow?745189930:-445963340,Q.a.Cb,8,(gb.resizeRowColumnParameters=Db,gb))};e.prototype.Q2e=function(gb,Db){return Ia.a.a5(gb)?Db?this.V2g(gb):
this.X2g(gb):e.lba};e.prototype.X2g=function(gb){return Math.floor(parseFloat(gb))};e.prototype.V2g=function(gb){gb=parseFloat(gb);return 0>gb?e.lba:gb?this.isRow?fa.HelperMethods.BYi(gb):this.xtc.QZg(gb):0};e.prototype.Y2g=function(gb){return gb===e.lba?"":this.isRow?this.xtc.tBe(gb).toString():this.xtc.kBe(gb).toFixed(2)};e.prototype.W2g=function(gb){return gb===e.lba?"":gb.toString()};e.prototype.KLh=function(gb){if(!gb||!gb.$$mn()||!gb.zn)return e.lba;var Db=Object(La.a)(463,gb.zn);if(!Db)return e.lba;
for(Db=this.isRow?Db.Hxb:Db.Ikd;gb.$$mn();){var Va=Object(La.a)(463,gb.zn);if(Va&&(this.isRow?Va.Hxb:Va.Ikd)!==Db)return e.lba}return Db};e.prototype.dHh=function(){for(var gb=[],Db=ak(this.gridView.ha.sa.selectedRanges),Va=Db.next();!Va.done;Va=Db.next()){Va=Va.value.clone();var yb=this.gridView.Ef(this.gridView.eb.gj(Va));yb=Va.Ae(yb.Ug);if(!yb)return null;this.isRow?Va.right=Va.left=yb.left:Va.top=Va.bottom=yb.top;gb.push(Va)}return gb.length?this.gridView.H$("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",
gb):null};e.prototype.hed=function(gb){if(!Ia.a.a5(gb))return 1;gb=this.Q2e(gb,this.Rzb);return!gb&&this.wli()?3:this.roi(gb)?0:2};e.prototype.wli=function(){var gb=this.gridView.ha.sa.selectedRanges;return this.isRow&&X.P(gb)||!this.isRow&&X.O(gb)};e.prototype.Ebd=function(gb){var Db="";switch(gb){case 0:Db="";break;case 1:Db=ha.a.instance.ga(770);break;case 2:gb=this.Rzb;Db=String.format(ha.a.instance.lb(99),0,this.mbc(gb));break;case 3:Db=ha.a.instance.ga(771)}return Db};e.prototype.roi=function(gb){return 0<=
gb&&gb<=this.mbc(!1)};e.prototype.mbc=function(gb){return this.xtc.mbc(gb,this.isRow)};e.yOd=function(gb,Db,Va){if(Db)for(gb.ColumnWidth=e.lba,gb.RowHeight=Va,gb=ak(gb.SheetMultiRange.Ranges),Db=gb.next();!Db.done;Db=gb.next())Db=Db.value,Db.FirstColumn=0,Db.LastColumn=0;else for(gb.RowHeight=e.lba,gb.ColumnWidth=Va,gb=ak(gb.SheetMultiRange.Ranges),Db=gb.next();!Db.done;Db=gb.next())Db=Db.value,Db.FirstRow=0,Db.LastRow=0};Af.Object.defineProperties(e.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"ResizeHeadersDialog"}},
Rzb:{configurable:!0,enumerable:!0,get:function(){return e.g9d},set:function(gb){e.g9d=gb}}});e.z4="id";e.Lli="isRow";e.X9h="initialSizeInPx";e.W9h="initialSizeInDefaultUnits";e.Fii="isInitialUnitsDefaultUnits";e.ged="getInputErrorIfInvalid";e.OBj="size";e.ugi="isDefaultUnits";e.lba=-1;e.g9d=!0;Object(u.a)(e,"ResizeHeadersDialog",v.a,[]);var fb=b(61),Ma=b(355),Hb=b(445),Kb=b(64);d.prototype.Lc=function(gb,Db){gb=!0;switch(Db){case -445963340:case 1391094586:gb=this.Vd(8);break;case 745189930:case 146338636:gb=
this.Vd(16)}return!gb};d.prototype.executeCommand=function(gb,Db,Va){var yb=Ka.TaskExtensions.jk();var qb=W.g(this.$);gb=la.a.create().toString();var dc=Db.command;switch(dc){case 1391094586:case 146338636:var bb=1391094586===dc;(gb=Va.autoFitRanges)&&gb.Ranges&&gb.Ranges.length||(gb=X.r(qb.ha.sa.selectedRanges,this.$));yb=this.Egh(bb?1:0,gb,Db);break;case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:bb=-445963340===dc||-706918724===dc||369708605===dc;if(-445963340===
dc||745189930===dc)bb=Ea.a(Db.command),qb.ui.w7(16,gb,bb),yb=Va.resizeRowColumnParameters;else{Va=qb.ha.sa.selectedRanges;if(qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6476251_ReduceLongOpsTel")){var db=0,wc=ak(Va);for(qb=wc.next();!qb.done;qb=wc.next())if(qb=qb.value,-706918724===dc||369708605===dc)qb=qb.right-qb.left+1,db+=0<qb?qb:-1*qb;else if(1542466017===dc||1051390410===dc)db+=qb.bottom-qb.top+1;369708605===dc||1542466017===dc?A.ULS.sendTraceTag(520938758,0,50,"ResizeCommandHandler.doResize: Unhide Rows/Columns NumberOfRanges={0}",
db):(-706918724===dc||1051390410===dc)&&A.ULS.sendTraceTag(520938757,0,50,"ResizeCommandHandler.doResize: hide Rows/Columns NumberOfRanges={0}",db)}if(-706918724===dc&&6===Db.Me&&X.O(Va)){A.ULS.sendTraceTag(537154007,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideColumn' was ignored because entire row is selected");break}if(1051390410===dc&&6===Db.Me&&X.P(Va)){A.ULS.sendTraceTag(537154006,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideRow' was ignored because entire column is selected");
break}dc=369708605===dc||1542466017===dc?-2:0;yb={};yb.SheetMultiRange=X.r(Va,this.$);if(bb)for(Va=ak(yb.SheetMultiRange.Ranges),qb=Va.next();!qb.done;qb=Va.next())qb=qb.value,qb.FirstRow=0,qb.LastRow=0;else for(Va=ak(yb.SheetMultiRange.Ranges),qb=Va.next();!qb.done;qb=Va.next())qb=qb.value,qb.FirstColumn=0,qb.LastColumn=0;yb.RowHeight=bb?-1:dc;yb.ColumnWidth=bb?dc:-1}yb=this.Ygh(yb,Db,gb);break;case 957527587:case 2040891415:new e(this.$,Db)}return yb};d.prototype.PZg=function(gb){qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",
!1)&&Ka.TaskExtensions.Ba(Na.GetServiceTaskFactory.Ra(this.$.da,426,427,1),function(Db){Db.result.jWd(gb,"ColumnAutoFit")},this.$.la,3)};d.prototype.Ac=function(gb,Db,Va,yb){if(gb=!!Va&&!!yb&&1===yb.tx)switch(Db.command){case 1391094586:case 146338636:case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;default:gb=!1}return gb};d.prototype.Qc=function(){return!1};d.prototype.Tui=function(gb){A.ULS.sendTraceTag(537154004,
0,50,"ResizeCommandHandler.LogInstantaneousResize: Resize operation succeeded: {0}. Reason: {1}.",gb.success,Object(Hb.c)(gb)?void 0:gb.reason)};d.prototype.Vd=function(gb){return(new Z.a(this.$.va)).Vd(gb)};d.prototype.Egh=function(gb,Db,Va){function yb(){return new l(bb,Db)}var qb=this,dc=this.$.oa.xa.Pb(),bb=0===gb;return na.a(this.$.userOperationManager,function(db,wc,nb){var zb=qb.$.oa.xa;db=ya.b(db,qb.SHi);var ma={Jfi:!bb,c0b:Db},P=zb.Na(41,dc);P.isRow=bb;P.autoFitRanges=Db;return fb.g(zb,"AutoFit",
P,db,wc,nb,ma,0)},function(db){return new ba.a(135,0,db,void 0,yb)},Va)};d.prototype.Ygh=function(gb,Db,Va){function yb(){return new k(gb)}function qb(zb,ma,P){dc.$.ry();X.i(bb,",",dc.$,!1);var oa=dc.$.oa.xa;zb=ya.b(zb,dc.zQi);var Ja=oa.Na(41,void 0===nb?null:nb);Ja.resizeRowColumnParameters=gb;return fb.g(oa,"ResizeRowsColumns",Ja,zb,ma,P,Va,0)}var dc=this,bb=X.g(gb.SheetMultiRange.Ranges),db=Db.command;if(745189930===db||-445963340===db){A.ULS.shipAssertTag(537154002,0,this.$.activeItemName===gb.SheetMultiRange.SheetName,
"ResizeCommandHandler.DoResize: should do CSE for active sheet only!");var wc=W.g(this.$);db=745189930===db;wc=this.Gg.aAj(wc,bb,db?gb.RowHeight:gb.ColumnWidth,db);this.Tui(wc);Object(Hb.c)(wc)&&W.g(this.$).ui.B0(Va,va.BasicTelemetryCalculator.NQ)}var nb=this.$.oa.xa.Pb({r_:!0,JZ:3});return wc&&Object(Hb.c)(wc)?qa.EwaSettings.Zb()?na.a(this.$.userOperationManager,qb,function(zb){return new ba.a(136,0,zb,64,yb)},Db):na.a(this.$.userOperationManager,qb,function(zb){return new ra.a(136,0,zb,void 0,yb)},
Db):na.a(this.$.userOperationManager,qb,function(zb){return new ba.a(136,0,zb,void 0,yb)},Db)};Object(u.a)(d,"ResizeCommandHandler",null,[403]);var Ub=ab.a;Rk(c,Ub);c.prototype.zd=function(){var gb=this,Db=Na.GetServiceTaskFactory.create(this.$.da,18,this.la,this.hb);Ka.TaskExtensions.Ba(Db,function(){gb.jd([new d(gb.$,Db.result)])},this.la,3)};c.ka=function(gb){ab.a.Qd(113,new c(gb))};Object(u.a)(c,"ResizeCommandHandlerFactory",ab.a,[]);b.d(D,"a",function(){return a})},1381:function(u,D,b){function a(){Type.registerNamespace("Common.App.OneDriveFilePickerApi");
c.main()}function c(){this.fb=null}function d(T){this.Wl=null;this.Pg=T;this.qPc=3}function e(T,F,K,J){F=l.call(this,T,F,K,J)||this;F.options.advanced.filter=T.Wa("OneDriveApiV72Filter")||"folder,photo";F.options.advanced.linkType="download";F.options.multiSelect=E.AFrameworkApplication.Bpe;T.ra("OneDriveApiV72CommandModeEnabled")&&(F.options.commandMode=T.Wa("OneDriveApiV72CommandMode")||"none");T.ra("OneDriveApiV72QosExtraDataEnabled")&&(F.options.qosExtradata=new k(E.AFrameworkApplication.userSessionId));
return F}function k(T){this.olsSessionId=this.value=this.key=null;this.olsSessionId=T}function l(T,F,K,J){F=w.call(this,T,F,K,J)||this;F.ukg=T;F.options={};F.options.advanced={};F.options.action="query";F.options.clientId=F.fa.Wa("OneDriveApiV72ClientId");F.options.advanced.trapFocus=!0;return F}function m(T,F,K,J,O){T=w.call(this,T,F,K,J)||this;T.Rbe=null;T.GSb=null;T.Fng=O;T.options={};T.options.clientId=T.fa.Wa("OneDriveApiV7ClientId");T.options.cancel=Object(y.a)(T,T.Vzc,"toggleHostDivVisibility");
return T}function f(T,F,K,J,O,N){F=w.call(this,F,K,J,N)||this;F.Ah=null;F.R1=T;F.bwg=O;return F}function w(T,F,K,J){this.gEa=this.d6=null;this.nQc=this.pQc=!1;this.CWa=null;this.ib=T;this.lQb=F;this.NDa=K;this.us=J}function n(){}function z(){var T=v.call(this)||this;T.Rb=0;T.mc(1,CommonUIStrings.l_DialogClose);return T}u=b(0);var r=b(135),v=r.StandardDialog;Rk(z,v);z.prototype.displayError=function(T){this.Oz(T,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)};z.prototype.$5c=
function(T){this.Oz(T,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)};Object(u.a)(z,"ErrorDialog",r.StandardDialog,[574]);var A=b(15),B=b(162);n.prototype.SVe=function(){A.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");var T=new B.a;T.setResult("api.onedrive.com");return T.task};Object(u.a)(n,"OneDriveConsumerEndpointHelper",null,[488]);var y=b(83),x=b(52),C=b(393),G=b(236);w.prototype.M3a=function(){this.CWa||(this.CWa=this.V9a?G.a.create(this.V9a,
null,null,null,!1):null);return this.CWa};w.prototype.setup=function(T){var F=this;this.gEa=T;this.pQc||this.nQc?this.pQc&&this.gEa&&this.gEa(!0):(T=this.M3a())?(this.nQc=!0,T.O7a.continueWith(function(K){F.oPi(K)}),C.a.ria(T)):(A.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.gEa(!1))};w.prototype.Wzd=function(T){A.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",T.exception?T.exception.toString():"No error detail.")};
w.prototype.oPi=function(T){this.nQc=!1;if(T.Yf)this.Wzd(T),this.gEa(!1);else try{this.pQc=!0,A.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.Okd(),A.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.gEa(!0)}catch(F){A.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",F.toString()),this.gEa(!1)}};w.prototype.startPicker=function(T){this.d6=T;this.NDa?A.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(A.ULS.sendTraceTag(23881877,
216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(y.a)(this,this.uyd,"onApiReady")))};w.prototype.uyd=function(T){T?this.njc():this.kj()};w.prototype.kj=function(){this.us().displayError(x.a.xUi)};w.prototype.onSuccess=function(T){A.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.d6&&this.d6(!0,T)};w.prototype.dispose=function(){this.CWa&&this.CWa.dispose()};Af.Object.defineProperties(w.prototype,{tpe:{configurable:!0,enumerable:!0,
get:function(){return this.lQb}},fa:{configurable:!0,enumerable:!0,get:function(){return this.ib}}});Object(u.a)(w,"AOneDriveFilePickerApiManager",null,[331,10]);Rk(f,w);f.prototype.start=function(T,F){this.Ah=T;this.startPicker(F)};f.prototype.Okd=function(){var T={},F={};T=1===this.tpe||2===this.tpe?(T.client_id=this.fa.appSettings.UploadToSkyDriveClientId,T):(F.client_id=this.fa.appSettings.UploadToSkyDriveClientId,F.env="INT",F);WL.init(T)};f.prototype.startPicker=function(T){this.d6=T;!this.NDa&&
this.R1.DLa?(A.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(y.a)(this,this.uyd,"onApiReady"))):(A.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.bwg())};f.prototype.njc=function(){try{A.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),WL.fileDialog(this.Ah).then(Object(y.a)(this,this.onSuccess,"onSuccess"),Object(y.a)(this,this.c6,"onFailure"))}catch(T){A.ULS.sendTraceTag(17909056,352,10,
"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",T,T.stack),this.kj()}};f.prototype.c6=function(T){if(T&&T.error){if("user_canceled"===T.error.code){A.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}A.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",T.error.code,T.error.message)}else A.ULS.sendTraceTag(17909060,352,50,"File Dialog returned with no response");this.d6&&this.d6(!1,T);this.kj()};Af.Object.defineProperties(f.prototype,{V9a:{configurable:!0,
enumerable:!0,get:function(){return this.fa.Wa("OneDriveApiUrl")}}});Object(u.a)(f,"OneDriveFilePickerApiManagerV5",w,[]);Rk(m,w);m.prototype.start=function(T,F){var K=this;this.GSb=F;var J=this.Fng.SVe();J.continueWith(function(){A.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");K.Rbe=J.result;K.startPicker(function(O,N){K.Vzc();T(O,N)})},3);J.continueWith(function(){A.ULS.sendTraceTag(24134242,352,15,J.exception.message);K.Vzc()},5)};m.prototype.Okd=
function(){var T=this;this.options.success=function(F){var K={};K.data=F;T.onSuccess(K)};this.options.error=function(F){var K={};K.error=F;T.c6(K)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.Rbe;this.options.advanced.iframeParentDiv=this.GSb};m.prototype.njc=function(){try{A.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.Vzc(),OneDrive.open(this.options)}catch(T){A.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",
T.message),this.kj()}};m.prototype.c6=function(T){this.d6&&this.d6(!1,T);this.kj()};m.prototype.Vzc=function(){this.GSb.style.visibility="hidden"===this.GSb.style.visibility?"":"hidden"};Af.Object.defineProperties(m.prototype,{V9a:{configurable:!0,enumerable:!0,get:function(){return this.fa.Wa("OneDriveApiV72Url")}}});Object(u.a)(m,"OneDriveFilePickerApiManagerV7",w,[]);Rk(l,w);l.prototype.start=function(T,F,K,J){this.options.advanced.iframeParentDiv=K;this.options.advanced.endpointHint=J;this.options.cancel=
F;this.ukg.ra("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive={},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.startPicker(T)};l.prototype.startPicker=function(T){this.d6=T;this.NDa?A.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(A.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),
this.setup(Object(y.a)(this,this.uyd,"onApiReady")))};l.prototype.Okd=function(){var T=this;this.options.success=function(F){var K={};K.data=F;T.onSuccess(K)};this.options.error=function(F){var K={};K.error=F;T.c6(K)}};l.prototype.njc=function(){try{A.ULS.sendTraceTag(23881879,216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(T){A.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",T.message,T.stack),this.kj()}};l.prototype.Wzd=
function(T){A.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",T.exception?T.exception.toString():"No error detail.");C.a.L$i(this.V9a);this.CWa=null};l.prototype.kj=function(){this.us().$5c(x.a.pjj)};l.prototype.c6=function(T){this.d6&&this.d6(!1,T)};Af.Object.defineProperties(l.prototype,{V9a:{configurable:!0,enumerable:!0,get:function(){return this.fa.Wa("OneDriveApiV72Url")}}});Object(u.a)(l,"OneDriveFilePickerApiManagerV72",w,[]);Object(u.a)(k,"IExtraData",null,[]);
var E=b(4);Rk(e,l);e.prototype.njc=function(){try{A.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",E.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(T){A.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",
T.message,T.stack),this.kj()}};Af.Object.defineProperties(e.prototype,{V9a:{configurable:!0,enumerable:!0,get:function(){return this.fa.Wa("OneDriveApiV72Url")}}});Object(u.a)(e,"OneDriveFilePickerApiOpenManagerV72",l,[]);var I=b(247);d.prototype.SVe=function(){this.Wl=new B.a;A.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.SMd();return this.Wl.task};d.prototype.SMd=function(T){T=void 0===T?null:T;var F=String.format("GetMoreInfoHandler.ashx?{0}",
E.AFrameworkApplication.GHa);this.Pg.z9(F,1,null,T,["PersonalFileStorageUrl","X-NewKey"],!1,2,Object(y.a)(this,this.URh,"getMoreInfoSucceeded"),Object(y.a)(this,this.SRh,"getMoreInfoFailed"),null,void 0,void 0,void 0,void 0,"21")};d.prototype.SRh=function(T){if(T.data.httpStatus===I.a.bGb&&"X-NewKey"in T.data.responseHeaders){A.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");var F={};F["X-Key"]=T.data.responseHeaders["X-NewKey"];
this.SMd(F)}else 0<this.qPc?(A.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.qPc),this.qPc--,this.SMd()):(A.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.Wl.setException(Error.create("GetMoreInfo request failed and no more retries remain")))};d.prototype.URh=function(T){"PersonalFileStorageUrl"in T.data.responseHeaders&&""!==T.data.responseHeaders.PersonalFileStorageUrl?
(A.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.Wl.setResult(T.data.responseHeaders.PersonalFileStorageUrl)):(A.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.Wl.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))};Object(u.a)(d,"OneDriveForBusinessEndpointHelper",null,[488]);var U=b(257),M=b(623);c.prototype.init=function(){};c.prototype.dispose=function(){};c.prototype.Sh=
function(T){var F=this;this.fb=T;this.fb.register(f,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").tc().Cc(function(){return new f(M.a.instance,E.AFrameworkApplication.fa,E.AFrameworkApplication.Q1a,E.AFrameworkApplication.limitedEdit,E.AFrameworkApplication.w3f,function(){return new z})});E.AFrameworkApplication.rgf?this.fb.register(488,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").tc().Cc(function(){return new n}):
this.fb.register(488,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").tc().Cc(function(){return new d(E.AFrameworkApplication.qd)});this.fb.register(m,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").tc().Cc(function(){return new m(E.AFrameworkApplication.fa,E.AFrameworkApplication.Q1a,E.AFrameworkApplication.limitedEdit,function(){return new z},F.fb.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper"))});this.fb.register(l,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").tc().Cc(function(){return new l(E.AFrameworkApplication.fa,
E.AFrameworkApplication.Q1a,E.AFrameworkApplication.limitedEdit,function(){return new z})});this.fb.register(e,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").tc().Cc(function(){return new e(E.AFrameworkApplication.fa,E.AFrameworkApplication.Q1a,E.AFrameworkApplication.limitedEdit,function(){return new z})})};c.main=function(){U.a.instance.Ui(new c)};Af.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.OneDriveFilePickerApi"}}});
Object(u.a)(c,"PackageManager",null,[3,4]);b.d(D,"a",function(){return a})},1388:function(u,D,b){function a(){Type.registerNamespace("Common.App.SaveAsToHost");c.main()}function c(){this.fb=null}function d(ca,X,Z,ea,ka,Y,qa,fa){this.sm=null;this.DWa=this.hDa=!1;this.qga=this.Ah=this.jA=null;this.ib=X;this.dFa=this.ib.appSettings.SaveAsToHostWebServiceBase;this.U7d=ea;this.Ekb=ka;this.Pg=Z;this.us=Y;this.qh=fa;this.Se=qa;this.La=ca;this.pfa=X.Wa("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}
function e(ca,X,Z){this.rga=Z;this.YHc=X;this.ib=ca}function k(ca,X,Z,ea,ka,Y){this.La=X;this.ib=ca;this.yX=ea;this.rga=Y;this.us=ka;this.Se=Z}function l(ca,X,Z,ea,ka,Y){ca=G.call(this,ca,X,Z,ea,ka,Y)||this;ca.Wf=m.Wf;ca.ze="FileNameDialog-SaveAsToHost";return ca}function m(){}function f(ca,X){this.ib=ca;this.La=X;this.Xhb=this.ib.ra("SaveToHostWithExtraCharsInFileName")}function w(ca,X){var Z=B.call(this)||this;Z.DWa=!1;Z.jA=null;Z.La=ca;Z.Xhb=X;Z.TRa=!1;return Z}u=b(0);var n=b(83),z=b(15),r=b(135),
v=b(52),A=b(27),B=r.StandardDialog;Rk(w,B);w.prototype.displayError=function(ca,X,Z){this.jA=X;this.DWa=Z;z.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",ca,Z);ca=this.x_c(ca);0===ca?(this.Rb=6,this.mc(0,CommonUIStrings.l_DialogClose)):(this.Rb=0,this.mc(1,CommonUIStrings.l_DialogClose));0===ca&&z.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.Oz(v.a.ojj,this.Xcd(ca),this.zMh(ca,X),Object(n.a)(this,this.YKd,"retryDialogHandler"),!0)};w.prototype.YKd=
function(ca){1===ca?(z.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.jA?this.La.ae(A.a.dJb,2,[this.jA,this.DWa]):this.La.processAction(A.a.dJb,2)):z.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")};w.prototype.x_c=function(ca){return 0>ca||6<ca?(z.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",ca),0):ca};w.prototype.zMh=function(ca,X){ca=this.x_c(ca);return this.Xhb?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,
CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,X),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][ca]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,X),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][ca]};w.prototype.Xcd=
function(ca){ca=this.x_c(ca);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][ca]};Object(u.a)(w,"ErrorRetryDialog",r.StandardDialog,[802]);f.prototype.create=function(){return new w(this.La,this.Xhb)};Object(u.a)(f,"ErrorRetryDialogFactory",null,[794]);r=b(1258);var y=b(150);Af.Object.defineProperties(m,
{Wf:{configurable:!0,enumerable:!0,get:function(){return y.a.Po(m.rk,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}});m.rk="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(u.a)(m,"FileNameDialogHtml",null,[]);var x=b(4),C=b(30),G=r.a;Rk(l,G);l.prototype.dQ=function(ca,X){var Z=C.a.qq(x.AFrameworkApplication.am.Qm),ea={};X=(ea.txtFileName=ca||Z,ea.lblFolderName=CommonUIStrings.l_ToCurrentFolder,ea.chkOverwrite=X,ea);this.initializeAndShow(CommonUIStrings.L_SaveAs,Object(n.a)(this,this.h9b,"fileNameDialogHandler"),X);this.sHe(ca,Z)};Object(u.a)(l,"FileNameDialog",r.a,[801]);k.prototype.create=function(){return new l(this.ib,this.La,this.Se,this.yX,this.us,this.rga)};
Object(u.a)(k,"FileNameDialogFactory",null,[792]);var E=b(739),I=b(107);e.prototype.Cg=function(){2===x.AFrameworkApplication.ta.Pa.Fj?x.AFrameworkApplication.ub.Ie(A.a.dJb,I.a.frame,Object(n.a)(this,this.HUf,"saveAsToHostActionDispatcher"),4):x.AFrameworkApplication.ub.Mb(A.a.dJb,I.a.frame,Object(n.a)(this,this.HUf,"saveAsToHostActionDispatcher"))};e.prototype.HUf=function(ca,X,Z,ea,ka){return X.contextId!==I.a.frame||ca!==A.a.dJb?2:this.ib.ra("SaveAsToHostBrsIsEnabled")?1===Z?E.SessionStatusManager.instance.wwb||
x.AFrameworkApplication.X4?8:32:2===Z?(z.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),ca=this.YHc.create(),ka&&Object.getType(ka)===Array&&2===ka.length?ca.dQ(ka[0],!!ka[1]):ca.dQ(null,!1),32):8:8};Object(u.a)(e,"SaveAsToHostActor",null,[]);var U=b(41),M=b(81),T=b(39),F=b(247),K=b(392),J=b(170),O=b(740),N=b(977);d.prototype.ILb=function(){1!==this.Se.state&&(this.sm=this.Ekb(),this.sm.message=CommonUIStrings.l_CommentProgressTooltip,this.sm.Rb=5,this.sm.Qu=
!1,this.sm.GAa(CommonUIStrings.l_DefaultDialogTitle,null,null))};d.prototype.eS=function(ca){ca=void 0===ca?0:ca;1!==this.Se.state&&this.us.create().displayError(ca,C.a.qq(this.jA),this.DWa)};d.prototype.JPa=function(){var ca=this.ib.appSettings.BreadcrumbFolderUrl;z.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");T.a.Ze(ca,T.a.qX(3),void 0,"UploadToHostManager.RedirectToFolder")};d.prototype.IPa=function(ca){var X=!1,Z=!1;this.ib&&(X=this.ib.ra("SaveACopyIsEnabledForUiHost"),
Z=this.ib.ra("UiHostSupportsDocRebootFeatures"));z.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",ca,X,Z);if(X&&Z){z.ULS.sendTraceTag(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var ea={};ea[K.a.DPa]="1";ea[K.a.documentUrl]=ca;ea[K.a.reason]=O.a.saveAs;x.AFrameworkApplication.eV().execute(function(ka){ka.xj(J.a.Fta,ea)})}else X&&!Z&&x.AFrameworkApplication.xba?T.a.Ze(ca,T.a.qX(4),void 0,
"UploadToHostManager.RedirectToEditUrl"):T.a.Ze(ca,T.a.qX(3),void 0,"UploadToHostManager.RedirectToEditUrl")};d.prototype.Ona=function(ca,X,Z){Z=void 0===Z?null:Z;z.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.U7d&&!this.U7d()&&this.Pg&&(this.qh&&(this.qga=this.qh.sc("DialogShown","SaveAsToHostUploadTime")),this.ILb(),this.DWa=X,this.jA=ca,(this.Ah=Z)&&"true"===this.Ah.SkipSaveToHost?this.F8b():this.mQ())};d.prototype.mQ=function(){var ca=this;32!==this.La.processAction(A.a.FQa,
1)?(z.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.F8b()):this.La.ae(A.a.FQa,2,[function(){z.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");ca.F8b()},function(X,Z){z.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");ca.eS(Z)}])};d.prototype.KTi=function(ca){this.lIa();this.hDa=!1;if(ca&&ca.data&&ca.data.Ud){var X=U.d(ca.data.Ud);
var Z=X.Pt;if(X.returnValue)if(Z.StatusCode!==F.a.TO&&Z.StatusCode!==F.a.mrb)z.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON."),ca={},ca.FailureReason=Z.StatusCode.toString(),ca.ExtraInfo=Z.ExtraInfo,this.mda(ca),this.eS(parseInt(Z.ExtraInfo));else{z.ULS.sendTraceTag(8194050,216,50,"UploadToHost execute success.");this.QJd();try{Z.NewDocumentUrl&&""!==Z.NewDocumentUrl?this.IPa(Z.NewDocumentUrl):this.JPa()}catch(ea){z.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",
ea.toString())}this.JFb()}else Z={},z.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",(Z.ResponseData=N.a.xeb(ca.data.Ud),Z)),ca={},this.mda((ca.FailureReason="Failed to deserialize response",ca)),this.eS()}else z.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),ca={},this.mda((ca.FailureReason="null response",ca)),this.eS()};d.prototype.JTi=function(ca){if(5!==ca.data.status&&12!==ca.data.status||this.hDa){var X={};z.ULS.sendTraceTag(8194052,216,
10,"UploadToHostManager HTTP failure with code: {0}",(X.Status=ca.data.status,X.HttpStatus=ca.data.httpStatus,X));X={};this.mda((X.FailureReason=ca.data.httpStatus.toString(),X));this.lIa();this.eS();this.JFb()}else z.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.hDa=!0,this.Ah&&"true"===this.Ah.SkipSaveToHost?this.F8b():this.mQ()};d.prototype.lIa=function(){this.sm&&(this.sm.close(),this.sm=null)};d.prototype.JFb=function(){this.qga&&(this.qga.stop(),this.qga=
null)};d.prototype.QJd=function(){this.Ah&&"VersionHistory"===this.Ah.SaveEntryPoint&&this.La.processAction(A.a.ktc,2)};d.prototype.mda=function(ca){this.Ah&&"VersionHistory"===this.Ah.SaveEntryPoint&&this.La.ae(A.a.SJd,2,ca)};d.prototype.F8b=function(){var ca=this.dFa+this.pfa;ca=M.a.vl(ca,"qs",C.a.$e(x.AFrameworkApplication.aj));ca=M.a.vl(ca,"n",C.a.$e((new Date).getTime().toString()));ca=M.a.vl(ca,"ov",C.a.$e(this.DWa.toString()));ca=M.a.vl(ca,"fn",C.a.$e(this.jA));this.Ah&&this.Ah.FileDownloadUrl&&
(ca=M.a.vl(ca,"furl",C.a.$e(this.Ah.FileDownloadUrl)));this.Pg.Yl(ca,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(n.a)(this,this.KTi,"onUploadFinished"),Object(n.a)(this,this.JTi,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")};Object(u.a)(d,"UploadToHostManager",null,[793]);var H=b(257),Q=b(995);c.prototype.init=function(){x.AFrameworkApplication.fa.Tu(Object(n.a)(this,this.sB,"onFullAppSettingsReady"))};c.prototype.sB=function(){x.AFrameworkApplication.fa.ra("SaveAsToHostBrsIsEnabled")&&
this.fb.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Cg()};c.prototype.Sh=function(ca){this.fb=ca;this.fb.register(f,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Cc(function(){return new f(x.AFrameworkApplication.fa,x.AFrameworkApplication.ub)}).tc();this.fb.register(d,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Cc(function(){return new d(x.AFrameworkApplication.ub,x.AFrameworkApplication.fa,
x.AFrameworkApplication.qd,function(){return x.AFrameworkApplication.Bg},function(){return(new Q.a).create()},ca.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),x.AFrameworkApplication.ta,x.AFrameworkApplication.ta.tD)}).tc();this.fb.register(k,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Cc(function(){return new k(x.AFrameworkApplication.fa,x.AFrameworkApplication.ub,x.AFrameworkApplication.ta,x.AFrameworkApplication.ta.Pa,ca.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),
ca.resolve("Common.App.SaveAsToHost.UploadToHostManager"))}).tc();this.fb.register(e,"Common.App.SaveAsToHost.SaveAsToHostActor").Cc(function(){return new e(x.AFrameworkApplication.fa,ca.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),ca.resolve("Common.App.SaveAsToHost.UploadToHostManager"))}).tc()};c.prototype.dispose=function(){};c.main=function(){H.a.instance.Ui(new c)};Af.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveAsToHost"}}});
Object(u.a)(c,"SaveAsToHostPackage",null,[3,4]);b.d(D,"a",function(){return a})},1389:function(u,D,b){function a(){Type.registerNamespace("Common.App.SaveACopy");c.main()}function c(){this.fb=null}function d(N,H,Q,ca,X,Z){H=F.call(this,H,Q,ca,X,Z)||this;H.La=N;return H}function e(N,H,Q,ca,X,Z,ea){H=M.call(this,H,Q,ca,X,Z,ea)||this;H.eog=N;return H}function k(N,H,Q,ca){N=U.call(this,N,H,Q,ca)||this;N.Zsg=H;return N}function l(N){var H=C.call(this)||this;H.Rb=1;H.mc(1,CommonUIStrings.l_RetryButtonLabel);
H.mc(0,CommonUIStrings.l_DialogClose);H.La=N;return H}function m(N,H,Q){this.La=N;this.yX=H;this.Wlb=Q}function f(N,H,Q,ca){var X=B.call(this)||this;X.D8=null;X.tSb=null;X.La=N;X.yX=H;X.Wlb=Q;X.mc(1,CommonUIStrings.l_SaveButtonLabel);X.Wf=w.Wf;X.ze="FileNameDialog-SaveACopy";X.Ah=ca;return X}function w(){}u=b(0);var n=b(83),z=b(15),r=b(150);Af.Object.defineProperties(w,{Wf:{configurable:!0,enumerable:!0,get:function(){return r.a.Po(w.rk,CommonUIStrings.l_SaveACopyFileName)}}});w.rk="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(u.a)(w,"FileNameDialogHtml",null,[]);var v=b(4),A=b(30),B=r.a;Rk(f,B);f.prototype.dQ=function(N,H,Q){this.tSb=N;this.D8=Q;N={};H=(N.txtFileName=A.a.qq(v.AFrameworkApplication.am.Qm),N.lblFolderName=String.format(CommonUIStrings.l_DestinationFolder,H),N);this.initializeAndShow(CommonUIStrings.l_SaveToOneDrive,Object(n.a)(this,this.h9b,"fileNameDialogHandler"),H);z.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()};
f.prototype.h9b=function(N,H){1!==N?z.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(N=H.txtFileName.trim(),z.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),H=A.a.b4(v.AFrameworkApplication.fileName),N&&""!==N&&""!==H&&(N+=H),this.Wlb.Ona(this.tSb,this.D8,N,this.Ah))};Object(u.a)(f,"FileNameDialog",r.a,[733]);m.prototype.create=function(N){return new f(this.La,this.yX,this.Wlb,N)};Object(u.a)(m,"FileNameDialogFactory",
null,[711]);var y=b(135),x=b(27),C=y.StandardDialog;Rk(l,C);l.prototype.displayError=function(N){z.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",N);this.Oz(N,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(n.a)(this,this.YKd,"retryDialogHandler"))};l.prototype.YKd=function(N){1===N?(z.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.La.processAction(x.a.saveACopy,2)):z.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")};
Object(u.a)(l,"RetryDialog",y.StandardDialog,[710]);y=b(1259);var G=b(1046),E=b(393),I=b(107),U=y.a;Rk(k,U);k.prototype.$6a=function(){return this.ib.ra("SaveACopyBrsIsEnabled")};k.prototype.wVe=function(){return x.a.saveACopy};k.prototype.g1b=function(){E.a.bHd(Object(n.a)(this,this.$Uf,"saveToCloudActionDispatcher"));E.a.A7c([new G.a(x.a.saveACopy,I.a.frame,0)],this.Zsg.M3a())};k.prototype.pMf=function(){z.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")};Object(u.a)(k,
"SaveACopyActor",y.a,[]);y=b(1262);var M=y.a;Rk(e,M);e.prototype.onSuccess=function(N){N&&N.data&&N.data.folders?(z.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.eog.create(this.Ah).dQ(N.data.folders[0].id,N.data.folders[0].name,N.data.folders[0].urls.viewInBrowser)):(z.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.kj())};e.prototype.c6=function(N){N&&N.error&&"user_canceled"===N.error.code&&z.ULS.sendTraceTag(7205457,216,50,
"User cancelled upload to their OneDrive in Save A Copy.");M.prototype.c6.call(this,N)};e.prototype.kj=function(){z.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");M.prototype.kj.call(this)};Object(u.a)(e,"SaveACopyManager",y.a,[]);var T=b(1260),F=T.a;Rk(d,F);d.prototype.Fpd=function(){return!!this.Ah&&!!this.Ah.SaveEntryPoint&&"VersionHistory"===this.Ah.SaveEntryPoint.toString()};d.prototype.eS=function(){z.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");
if(this.Fpd()){var N={};this.La.ae(x.a.SJd,2,(N.FailureReason="Unknown",N))}F.prototype.eS.call(this)};d.prototype.JPa=function(){z.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.Fpd()&&this.La.processAction(x.a.ktc,2);F.prototype.JPa.call(this)};d.prototype.IPa=function(N){z.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",N);this.Fpd()&&this.La.processAction(x.a.ktc,2);F.prototype.IPa.call(this,N)};d.prototype.mQ=function(){var N=
this;this.Ah&&"true"===this.Ah.SkipSaveToHost?F.prototype.mQ.call(this):32!==this.La.processAction(x.a.FQa,1)?(z.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),F.prototype.mQ.call(this)):this.La.ae(x.a.FQa,2,[function(){z.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");T.a.prototype.mQ.call(N)},function(){z.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");
N.eS()}])};Object(u.a)(d,"SaveACopyUploadToCloudManager",T.a,[]);var K=b(257),J=b(623),O=b(995);c.prototype.init=function(){v.AFrameworkApplication.fa.Tu(Object(n.a)(this,this.sB,"onFullAppSettingsReady"))};c.prototype.sB=function(){v.AFrameworkApplication.fa.ra("SaveACopyBrsIsEnabled")&&this.fb.resolve("Common.App.SaveACopy.SaveACopyActor").Cg()};c.prototype.dispose=function(){};c.prototype.Sh=function(N){this.fb=N;this.fb.register(d,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Cc(function(){return new d(v.AFrameworkApplication.ub,
N.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),function(){return(new O.a).create()},function(){return new l(v.AFrameworkApplication.ub)},v.AFrameworkApplication.ta,v.AFrameworkApplication.ta.tD)}).tc();this.fb.register(m,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Cc(function(){return new m(v.AFrameworkApplication.ub,v.AFrameworkApplication.ta.Pa,N.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))}).tc();this.fb.register(k,
"Common.App.SaveACopy.SaveACopyActor").Cc(function(){return new k(N.resolve("Common.App.SaveACopy.SaveACopyManager"),N.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),v.AFrameworkApplication.fa,v.AFrameworkApplication.ta.tD)}).tc();this.fb.register(e,"Common.App.SaveACopy.SaveACopyManager").Cc(function(){return new e(N.resolve("Common.App.SaveACopy.FileNameDialogFactory"),N.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),J.a.instance,N.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),
v.AFrameworkApplication.fa,v.AFrameworkApplication.Q1a,function(){return new l(v.AFrameworkApplication.ub)})}).tc()};c.main=function(){K.a.instance.Ui(new c)};Af.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveACopy"}}});Object(u.a)(c,"PackageManager",null,[3,4]);b.d(D,"a",function(){return a})},1390:function(u,D,b){function a(){n.a.Fa(c.ka);n.a.Fa(k.ka)}function c(Q,ca,X,Z){var ea=H.call(this)||this;ea.activityName=Q;ea.nM=ca;ea.IJ=X;
ea.$=Z;ea.Eb();return ea}function d(Q,ca,X){return w.call(this,Q,ca,X)||this}function e(Q,ca){Q=f.call(this,Q)||this;Q.password=null;Q.Ahf=ca;Q.sg();return Q}function k(Q,ca,X,Z){var ea=O.call(this)||this;ea.activityName=Q;ea.nM=ca;ea.IJ=X;ea.$=Z;ea.Eb();return ea}function l(Q,ca,X){return w.call(this,Q,ca,X)||this}function m(Q){var ca=f.call(this,Q)||this;ca.TKd=5;ca.Q8d=!1;ca.passwordToModify=null;ca.pFf=function(){ca.$.isEditMode&&ca.Ygc&&(K.b().w7c("PasswordToModifyPasswordVerifiedTillInteractive"),
ca.$.ol(ca.pFf))};ca.sg();ca.$.Tk(ca.pFf);return ca}function f(Q){var ca=U.call(this,Q)||this;ca.Cpa=0;ca.n5i=function(X,Z){ca.pab(X,Z)};return ca}function w(Q,ca,X){var Z=x.call(this,Q,ca)||this;Z.li=null;Z.rCd=null;Z.gXi=function(ea,ka){Z.AFb(ea,ka)};Z.IJ=X;return Z}var n=b(11);u=b(0);var z=b(232),r=b(15),v=b(30),A=b(85),B=b(251),y=b(35),x=B.a;Rk(w,x);w.prototype.initialize=function(Q){x.prototype.initialize.call(this,Q)};w.prototype.execute=function(Q){this.li=Q;Q=Object(A.a)(6,this.li.ve);this.brb(Q);
return 1};w.prototype.wI=function(Q){x.prototype.wI.call(this,Q)};w.prototype.brb=function(){var Q=this;this.subscribe(this.li,this.gXi,function(ca){Q.rCd.add_disposing(ca)})};w.prototype.AFb=function(Q){this.unsubscribe(function(ca){Q.remove_disposing(ca)});this.li.activityState[y.a.g2]=0};Object(u.a)(w,"PasswordProtectedFileActivity",B.a,[]);var C=b(83),G=b(390),E=b(325),I=b(14),U=G.a;Rk(f,U);f.prototype.pab=function(Q){this.Cpa=Q};f.prototype.f3=function(){var Q={};Q[G.a.description]=I.a.instance.ga(1953);
Q[G.a.lma]=I.a.instance.ga(1949);Q[G.a.oFf]=I.a.instance.ga(1971);Q[G.a.mFf]=I.a.instance.ga(1972);Q[G.a.nFf]=I.a.instance.ga(1950);Q[G.a.qkd]=I.a.instance.ga(1956);Q[G.a.$re]=I.a.instance.ga(1646);Q[G.a.JVj]=I.a.instance.Xa(25);Q[G.a.Veg]=Object(C.a)(this,this.HTa,"verifySubmittedPassword");return Q};f.prototype.Zsa=function(){var Q={};Q[E.a.Yv]=this.nc;Q[G.a.EZa]=this.f3();return Q};f.prototype.sg=function(){this.Rb=1;this.initializeAndShow(this.Al,this.n5i,this.Zsa())};Af.Object.defineProperties(f.prototype,
{nc:{configurable:!0,enumerable:!0,get:function(){return"PasswordDialog"}},Wrb:{configurable:!0,enumerable:!0,get:function(){return this.Cpa}},Al:{configurable:!0,enumerable:!0,get:function(){return I.a.instance.ga(1952)}}});Object(u.a)(f,"PasswordProtectedFilePasswordInputDialog",G.a,[]);var M=b(61),T=b(29),F=b(296),K=b(50);Rk(m,f);m.prototype.pab=function(Q,ca){f.prototype.pab.call(this,Q,ca);r.ULS.sendTraceTag(537154755,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFileModifyPasswordInputDialogDisposing: user response: {0}",
Q)};m.prototype.HTa=function(Q,ca){this.passwordToModify=Q;var X={};X.FileModifyPassword=v.a.$e(Q);M.N(this.$.oa.xa,X,this.PTi(ca),this.OTi(ca),null,null)};m.prototype.f3=function(){var Q=f.prototype.f3.call(this);Q[G.a.qkd]=I.a.instance.ga(1957);Q[G.a.description]=I.a.instance.Xa(24);return Q};m.prototype.sg=function(){K.b().w7c("PasswordToModifyDialogShown");r.ULS.sendTraceTag(557446529,0,50,"PasswordProtectedFileModifyPasswordInputDialog.InitializeAndShowDialog: Initializing dialog.");f.prototype.sg.call(this)};
m.prototype.PTi=function(Q){var ca=this;return function(X){T.a.Zg(X.Errors,[-2019873242])&&ca.w6b(ca.Uqb());if(!X||F.a(X))if(0<ca.TKd)ca.QKf(Q);else{r.ULS.sendTraceTag(537154754,0,10,"VerifyPasswordToModifyOperation.GenerateOnVerifyPasswordToModifyRequestSuccess: Unexpected error: {0}",T.a.Dc(X.Errors));ca.$.ea.kp(X.Errors);ca.hide();return}ca.Q8d=X.Result;ca.Ygc&&(K.b().$Sd("UserAction","Password-To-Modify Workbook: Logging StopWatch duration after user enters corect password","PasswordToModifyPasswordVerifiedTillInteractive"),
r.ULS.sendTraceTag(555758470,0,50,"PasswordProtectedFileModifyPasswordInputDialog.OnVerifyPasswordToModifyRequestSuccess: User entered the correct password."));Q(ca.Ygc?0:1)}};m.prototype.OTi=function(Q){var ca=this;return function(){0<ca.TKd?ca.QKf(Q):(r.ULS.sendTraceTag(537154753,0,10,"PasswordProtectedFileModifyInputDialog.OnVerifyPasswordToModifyRequestFailure: VerifyPasswordToModify request failed."),Q(3))}};m.prototype.QKf=function(Q){--this.TKd;this.HTa(this.passwordToModify,Q)};m.prototype.Uqb=
function(){return T.a.Wc(1,0,1645,1646,1,-2019873242,"TooManyWrongPasswordAttemptFileModifyError")};Af.Object.defineProperties(m.prototype,{Ygc:{configurable:!0,enumerable:!0,get:function(){return this.Q8d}},Al:{configurable:!0,enumerable:!0,get:function(){return I.a.instance.ga(1954)}}});Object(u.a)(m,"PasswordProtectedFileModifyPasswordInputDialog",f,[]);var J=b(6);Rk(l,w);l.prototype.brb=function(Q){this.rCd=new m(Q);w.prototype.brb.call(this,Q)};l.prototype.AFb=function(Q,ca){var X=Q.Wrb,Z=Q.Ygc,
ea=Q.passwordToModify;w.prototype.AFb.call(this,Q,ca);this.li.Lxa([2001366804]);switch(X){case 1:Z?(ca=Object(A.a)(6,this.li.ve),this.li.activityState[y.a.cke]=v.a.$e(ea),this.li.activityState[y.a.$Xa]=!0,Q.passwordToModify="",this.lh(ca.isEditMode?J.a.Hj:this.nM)):r.ULS.sendTraceTag(537154757,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFilePasswordInputDialogDisposing: Unexpected State , Dialog disposed but password not verified.");this.ep();break;case 0:this.li.activityState[y.a.Cs]=
!1;this.lh(this.IJ);this.ep();break;default:r.ULS.sendTraceTag(537154756,0,50,"PasswordToModifyFileModifyActivity.OnPasswordInputCommited: unhandled user response '{0}'",X)}};Object(u.a)(l,"PasswordProtectedFileModifyActivity",w,[]);var O=z.a;Rk(k,O);k.prototype.create=function(){this.pb(new l(this.activityName,this.nM,this.IJ))};k.ka=function(Q){Q.da.Ga(434,new k(J.a.zFb,J.a.qeb,J.a.PGa,Q))};Object(u.a)(k,"PasswordProtectedFileModifyActivityFactory",z.a,[]);var N=b(42);Rk(e,f);e.prototype.HTa=function(Q,
ca){this.password=Q;ca(0)};e.prototype.f3=function(){var Q=f.prototype.f3.call(this);this.Ahf&&(Q[G.a.Glh]=1);return Q};e.prototype.sg=function(){r.ULS.sendTraceTag(537154722,0,50,"PasswordProtectedFileOpenPasswordInputDialog.InitializeAndShowDialog: Initializing dialog. isWrongPassword={0}",this.Ahf);f.prototype.sg.call(this);N.a(this.$).moe()};Object(u.a)(e,"PasswordProtectedFileOpenPasswordInputDialog",f,[]);Rk(d,w);d.prototype.brb=function(Q){var ca=T.a.Zg(this.li.errors,[1217361942]);this.rCd=
new e(Q,ca);Q.ifc||Q.$Ge();w.prototype.brb.call(this,Q)};d.prototype.AFb=function(Q,ca){var X=Q.password;Q.password="";var Z=Q.Wrb;w.prototype.AFb.call(this,Q,ca);this.li.activityState[y.a.CTc]=v.a.$e(X);this.li.activityState[y.a.$Xa]=!0;this.li.Lxa([110414285,1217361942]);r.ULS.sendTraceTag(537154752,0,50,"PasswordProtectedFileOpenActivity.PasswordProtectedFileOpenPasswordInputDialogDisposing: user response: {0}",Z);switch(Z){case 1:this.lh(this.nM);this.ep();break;case 0:this.lh(this.IJ),this.ep()}};
Object(u.a)(d,"PasswordProtectedFileOpenActivity",w,[]);var H=z.a;Rk(c,H);c.prototype.create=function(){this.pb(new d(this.activityName,this.nM,this.IJ))};c.ka=function(Q){Q.da.Ga(386,new c(J.a.npc,J.a.Hj,J.a.Ek,Q))};Object(u.a)(c,"PasswordProtectedFileOpenActivityFactory",z.a,[]);b.d(D,"a",function(){return a})},1399:function(u,D,b){function a(){Type.registerNamespace("Common.App.SaveToCloudStorage");c.main()}function c(){this.fb=null}function d(F){this.ib=F;this.eFa=F.appSettings.SkyDriveUploadWebServiceBase;
this.jA=F.appSettings.FileName;this.pfa=F.Wa("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}function e(F,K,J,O,N,H,Q){this.dFa=F;this.jA=K;this.tVa=J;this.tSb=O;this.NOc=N;this.pfa=H;this.Ah=Q}function k(F,K,J){this.La=F;this.R1=K;this.yX=J}function l(F,K,J){var O=C.call(this)||this;O.La=F;O.R1=K;O.yX=J;O.Av=!1;O.Rb=1;O.i7(1);O.mc(1,CommonUIStrings.l_SignIn);O.mc(0,CommonUIStrings.l_SignInToSaveDialogCancelButton);return O}function m(){var F=w.call(this)||this;F.Rb=0;F.mc(1,CommonUIStrings.l_DialogClose);
return F}u=b(0);var f=b(135),w=f.StandardDialog;Rk(m,w);m.prototype.displayError=function(F){this.Oz(F,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,null)};Object(u.a)(m,"ErrorDialog",f.StandardDialog,[710]);var n=b(1262),z=b(1259),r=b(15),v=b(83),A=b(4),B=b(262),y=b(39),x=b(27),C=f.StandardDialog;Rk(l,C);l.prototype.dQ=function(){this.R1.lYa(Object(v.a)(this,this.lCf,"onSignIn"));this.nl(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,
0,Object(v.a)(this,this.vbi,"inputHandler"))};l.prototype.vbi=function(F){0===F?(r.ULS.sendTraceTag(6590598,216,50,"User dismissed SignIn Dialog."),this.hide()):this.v6()};l.prototype.vWg=function(){var F="2";if(this.yX)switch(this.yX.Fj){case 3:F="0";break;case 2:F="3";break;case 1:F="1"}return F};l.prototype.hide=function(){this.R1.IHb(Object(v.a)(this,this.lCf,"onSignIn"));C.prototype.hide.call(this)};l.prototype.v6=function(){var F=new B.QueryStringBuilder("Signin.aspx");F.Ii("prompt","1");F.Ii("cbcxt",
this.vWg());A.AFrameworkApplication.cYa(F);y.a.Ze(F.toString(),"LoginWindow",void 0,"SignInDialog")};l.prototype.lCf=function(){this.xq&&this.hide();r.ULS.sendTraceTag(7143885,216,50,"User signed in successfully. Calling Savetocloudstorage action handler");this.La.processAction(x.a.saveToCloudStorage,2)};Object(u.a)(l,"SignInDialog",f.StandardDialog,[735]);k.prototype.create=function(){return new l(this.La,this.R1,this.yX)};Object(u.a)(k,"SignInDialogFactory",null,[714]);var G=b(81),E=b(30);e.prototype.execute=
function(F,K){if(!A.AFrameworkApplication.Bg&&A.AFrameworkApplication.qd){var J=this.dFa+this.pfa;J=G.a.vl(J,"fo",E.a.$e(this.tSb));J=G.a.vl(J,"fn",E.a.$e(this.jA));J=G.a.vl(J,"qs",E.a.$e(this.NOc));J=G.a.vl(J,"n",E.a.$e((new Date).getTime().toString()));this.Ah&&this.Ah.FileDownloadUrl&&(J=G.a.vl(J,"furl",E.a.$e(this.Ah.FileDownloadUrl)));this.tVa&&(J=G.a.vl(J,"fnn",E.a.$e(this.tVa)));A.AFrameworkApplication.qd.Yl(J,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,F,K,null)}};Object(u.a)(e,
"SkyDriveUploadCaller",null,[734]);d.prototype.create=function(F,K,J){return new e(this.eFa,this.jA,K,F,A.AFrameworkApplication.aj,this.pfa,J)};Object(u.a)(d,"SkydriveUploadCallerFactory",null,[713]);var I=b(1260),U=b(257),M=b(623),T=b(995);c.prototype.init=function(){A.AFrameworkApplication.fa.ra("SaveToCloudStorageUIIsEnabled")&&this.fb.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Cg()};c.prototype.dispose=function(){};c.prototype.Sh=function(F){this.fb=F;this.fb.register(k,
"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Cc(function(){return new k(A.AFrameworkApplication.ub,M.a.instance,A.AFrameworkApplication.ta.Pa)}).tc();this.fb.register(d,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Cc(function(){return new d(A.AFrameworkApplication.fa)}).tc();this.fb.register(z.a,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Cc(function(){return new z.a(F.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),
F.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),A.AFrameworkApplication.fa,A.AFrameworkApplication.ta.tD)}).tc();this.fb.register(I.a,"Common.App.SaveToCloudStorage.UploadToCloudManager").Cc(function(){return new I.a(F.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),function(){return(new T.a).create()},function(){return new m},A.AFrameworkApplication.ta,A.AFrameworkApplication.ta.tD)}).tc();this.fb.register(n.a,"Common.App.SaveToCloudStorage.SaveToCloudManager").Cc(function(){return new n.a(F.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),
M.a.instance,F.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),A.AFrameworkApplication.fa,A.AFrameworkApplication.Q1a,function(){return new m})}).tc()};c.main=function(){U.a.instance.Ui(new c)};Af.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveToCloudStorage"}}});Object(u.a)(c,"PackageManager",null,[3,4]);b.d(D,"a",function(){return a})},1400:function(u,D,b){function a(){this.Xib=!!n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Pa.Wu}
function c(x,C,G){var E=k.call(this,x,C,G)||this;x={};x=(x.errorMessage=E.xLe,x.errorFileDownloadOffer=E.Usb,x);C={};x.helpLink=(C.type="AppLinkProps",C.id="helpLink",C.text=E.Hva,C.onExecute=function(I){E.dOa(I)},C);C=new y.a(!1,!1,!0);C.Rb=1;C.mc(1,E.Vsb);C.ze=E.id;G={};x=(G.id=E.id,G.dialogIcon=E.icon,G.bodyControls=x,G);C.initializeAndShow(E.Al,Object(f.a)(E,E.VFd,"reactOICErrorDialogHandler"),x);return E}function d(x,C,G,E){var I=m.call(this,x,C,G,E)||this;x={};x=(x.errorMessage=I.errorMessage,
x);C={};x.helpLink=(C.type="AppLinkProps",C.id="helpLink",C.text=I.Hva,C.onExecute=function(U){I.dOa(U)},C);I.Twc?(x.macOfficePreLinkText=I.$nf,C={},x.macOfficeLink=(C.type="AppLinkProps",C.id="macOfficeLink",C.text=I.Xnf,C.onExecute=function(U){I.iyd(U)},C),x.macOfficePostText=I.Znf):I.r3b&&(x.errorFileDownloadOffer=I.Usb);C=new y.a(!1,!1,!0);I.r3b?(C.Rb=1,C.mc(1,I.Vsb)):C.Rb=0;C.ze=I.id;G={};x=(G.id=I.id,G.dialogIcon=I.icon,G.bodyControls=x,G);C.initializeAndShow(I.Al,Object(f.a)(I,I.VFd,"reactOICErrorDialogHandler"),
x);return I}function e(x,C,G){x=k.call(this,x,C,G)||this;x.Ul=null;C=document.createElement("span");C.id="errorMessageText";C.innerText=x.xLe;C.appendChild(document.createElement("br"));C.appendChild(document.createElement("br"));x.Ul=document.createElement("a");x.Ul.href="#";x.Ul.innerText=x.Hva;C.appendChild(x.Ul);A.a.addHandler(x.Ul,"click",Object(f.a)(x,x.dOa,"oicErrorHelpLinkHandler"));C.appendChild(document.createElement("br"));C.appendChild(document.createElement("br"));G=document.createElement("span");
G.innerText=x.Usb;C.appendChild(G);G=new B.StandardDialog;G.ze=x.id;G.Rb=1;G.mc(1,x.Vsb);G.nl(x.Al,null,x.icon,Object(f.a)(x,x.tsd,"legacyOICErrorDialogHandler"),C);G.YW("errorMessageText");return x}function k(x,C,G){this.QX=C;this.RX=x;this.zD=G}function l(x,C,G,E){x=m.call(this,x,C,G,E)||this;x.Ul=null;x.sqa=null;C=document.createElement("span");C.id="errorMessageText";C.innerText=x.errorMessage;C.appendChild(document.createElement("br"));C.appendChild(document.createElement("br"));x.Ul=document.createElement("a");
x.Ul.href="#";x.Ul.innerText=x.Hva;C.appendChild(x.Ul);A.a.addHandler(x.Ul,"click",Object(f.a)(x,x.dOa,"oicErrorHelpLinkHandler"));G=new B.StandardDialog;G.ze=x.id;if(x.Twc){E=document.createElement("span");var I=document.createElement("span");E.innerText=x.$nf;I.innerText=x.Znf;x.sqa=document.createElement("a");x.sqa.href="#";x.sqa.innerText=x.Xnf;C.appendChild(document.createElement("br"));C.appendChild(E);C.appendChild(x.sqa);C.appendChild(I);A.a.addHandler(x.sqa,"click",Object(f.a)(x,x.iyd,"oicErrorMacOfferLinkHandler"))}else x.r3b&&
(C.appendChild(document.createElement("br")),C.appendChild(document.createElement("br")),E=document.createElement("span"),E.innerText=x.Usb,C.appendChild(E));x.r3b?(G.Rb=1,G.mc(1,x.Vsb)):G.Rb=0;G.nl(x.Al,null,x.icon,Object(f.a)(x,x.tsd,"legacyOICErrorDialogHandler"),C);G.YW("errorMessageText");return x}function m(x,C,G,E){this.CMc=null;this.FRb=E;this.QX=x;this.RX=C;this.zD=G;this.Tfe=this.Ynf.Uwj;x=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.gsg=x[0];this.fsg=x[1]}u=b(0);var f=b(83),
w=b(15),n=b(4),z=b(52),r=b(442),v=b(84);m.prototype.VFd=function(x){this.yDb(x)};m.prototype.tsd=function(x){this.yDb(x)};m.prototype.yDb=function(x){var C=10;this.RX&&1===x&&(this.RX(this.zD),C=1);this.QX&&this.QX(this.zD);this.JF(C)};m.prototype.dOa=function(){r.Redirect.showHelp("OICFailure");this.JF(2)};m.prototype.iyd=function(){this.Ynf.vjf();this.JF(4)};m.prototype.JF=function(x){w.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",this.FRb,x);n.AFrameworkApplication.ctc(z.a.dEf,
this.FRb,x)};m.prototype.dispose=function(){this.zD=this.QX=this.RX=null};Af.Object.defineProperties(m.prototype,{Ynf:{configurable:!0,enumerable:!0,get:function(){return this.CMc||(this.CMc=v.a.instance.resolve("Common.IMacOfficeOffer"))}},id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialog"}},errorMessage:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMessage}},Hva:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},
Twc:{configurable:!0,enumerable:!0,get:function(){return this.Tfe}},$nf:{configurable:!0,enumerable:!0,get:function(){return this.gsg}},Znf:{configurable:!0,enumerable:!0,get:function(){return this.fsg}},Xnf:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMacOFficeLink}},icon:{configurable:!0,enumerable:!0,get:function(){return this.Tfe?3:2}},Usb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorFileDownloadOffer}},r3b:{configurable:!0,enumerable:!0,
get:function(){return!!this.RX}},Vsb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}},Al:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});Object(u.a)(m,"AOICErrorDialog",null,[10]);var A=b(43),B=b(135);Rk(l,m);l.prototype.dispose=function(){this.Ul&&(A.a.removeHandler(this.Ul,"click",Object(f.a)(this,this.dOa,"oicErrorHelpLinkHandler")),this.Ul=null);this.sqa&&(A.a.removeHandler(this.sqa,"click",Object(f.a)(this,
this.iyd,"oicErrorMacOfferLinkHandler")),this.sqa=null);m.prototype.dispose.call(this)};Object(u.a)(l,"OICErrorDialog",m,[]);k.prototype.VFd=function(x){this.yDb(x)};k.prototype.tsd=function(x){this.yDb(x)};k.prototype.yDb=function(x){var C=10;1===x&&(this.RX(this.zD),C=1);this.QX&&this.QX(this.zD);this.JF(C)};k.prototype.dOa=function(){r.Redirect.showHelp("OICFailure");this.JF(2)};k.prototype.JF=function(x){n.AFrameworkApplication.ctc(z.a.eEf,3,x)};k.prototype.dispose=function(){this.zD=this.RX=
this.QX=null};Af.Object.defineProperties(k.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialogWithDownload"}},xLe:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDetected}},Hva:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},Usb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorFileDownloadOffer}},Vsb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}},
icon:{configurable:!0,enumerable:!0,get:function(){return 2}},Al:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});Object(u.a)(k,"AOICErrorDialogWithDownload",null,[10]);Rk(e,k);e.prototype.dispose=function(){this.Ul&&(A.a.removeHandler(this.Ul,"click",Object(f.a)(this,this.dOa,"oicErrorHelpLinkHandler")),this.Ul=null);k.prototype.dispose.call(this)};Object(u.a)(e,"OICErrorDialogWithDownload",k,[]);var y=b(150);Rk(d,m);Object(u.a)(d,"ReactOICErrorDialog",
m,[]);Rk(c,k);Object(u.a)(c,"ReactOICErrorDialogWithDownload",k,[]);b.d(D,"a",function(){return a});a.prototype.X7g=function(x,C,G){this.Xib?new d(x,C,null,G):new l(x,C,null,G)};a.prototype.Y7g=function(x,C,G){this.Xib?new c(x,C,G):new e(x,C,G)};a.prototype.Z7g=function(x,C,G,E,I){var U=b(1539).ReactOICErrorDialogWithTrial,M=b(1540).OICErrorDialogWithTrial;this.Xib?new U(x,C,G,null,E,I):new M(x,C,G,null,E,I)};Af.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){return a.Ma||
(a.Ma=new a)}}});a.Ma=null;Object(u.a)(a,"OICErrorDialogFactory",null,[324])},1416:function(u,D,b){function a(){k.a.Fa(c.ka)}function c(U){return I.call(this,U)||this}function d(U,M){this.$=U;this.gridView=M}function e(U,M,T){var F=G.call(this,U)||this;F.umb=0;F.Cyb=!1;F.j1a=null;F.lHe=!1;F.Hqb=!0;F.kTc=null;F.Al=null;F.Twd=0;F.Uwd=null;F.Swd=null;F.removeHyperLink=!1;F.cellValue=null;F.location=null;F.f7h=function(K,J){1===K||2===K?(n.ULS.sendTraceTag(555755670,0,50,"HyperLink {0} pressed",1===K?
"OK":"Remove"),F.Uwd=J[e.isi],F.Twd=J[e.Jlj],F.Swd=J[e.$fh],2===K&&(F.removeHyperLink=!0),F.commit()):n.ULS.sendTraceTag(537157644,0,50,"HyperLink Cancel pressed")};F.qVj=function(K,J){return 0!==J&&K.length?1===J?F.eYe(f.y(K,F.ea.va)||F.XBi(K),763):F.eYe(z.a.fnd(K),765):null};F.selectedRange=M;F.ML=T;F.ea=U.ea;F.sheetName=M.SheetName;F.oLa();F.pn();F.Rb=F.Cyb?9:1;F.mc(1,C.a.instance.ga(4));F.Cyb&&F.mc(2,C.a.instance.ga(766));U={};U=(U[e.jfh]=F.lHe,U[e.agh]=F.j1a,U[e.Azg]=F.umb,U[e.Bzg]=F.kTc,U[e.t3g]=
F.Hqb,U);M={};U=(M[e.Yv]=F.nc,M[e.rVj]=F.qVj,M[e.yOg]=U,M);F.initializeAndShow(F.Al,F.f7h,U);return F}var k=b(11);u=b(0);var l=b(905),m=b(21),f=b(45),w=b(1),n=b(15),z=b(30),r;(function(U){U[U.url=0]="url";U[U.ref=1]="ref";U[U.mailto=2]="mailto"})(r||(r={}));Object(u.b)("HyperlinkSelectionState",r);var v=b(982),A=b(8),B=b(646),y=b(61),x=b(98),C=b(14),G=v.a;Rk(e,G);e.prototype.LZe=function(U,M){switch(M){case 2:return U.startsWith("mailto:")?U:"mailto:"+U;case 1:return String.format("{0}{1}",A.a.WGf,
this.cRh(U));default:return U}};e.prototype.Py=function(){var U=this,M=this.$;this.location=this.LZe(this.Uwd,this.Twd);try{this.location=x.a.rh(this.location)}catch(K){n.ULS.sendTraceTag(537157643,0,15,"Decoding link text failed")}n.ULS.sendTraceTag(555755667,0,50,"Committing {0} link",r[this.Twd]);this.cellValue=this.Swd.length?this.Swd:this.Uwd;M.ry();var T=M.oa.xa.Pb(),F=f.s(this.selectedRange);return function(K,J,O){return y.b(M.oa.xa,F,U.cellValue,U.location,U.removeHyperLink,!1,123,K,J,O,U.ML.range,
T)}};e.prototype.dj=function(){var U=this,M=f.s(this.selectedRange);return function(){return new B.a(M,U.cellValue,U.location)}};e.prototype.Qxh=function(){var U=this.ML.cell.Z4a;this.ML.cell.xwb?U&&U.startsWith("mailto:")?(this.umb=2,U=U.substr(7)):this.umb=0:this.umb=1;return U};e.prototype.oLa=function(){w.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?this.Cyb=this.ML.Xaa:this.Cyb=!!this.ML.WJa(64)||!!this.ML.WJa(128)};e.prototype.pn=function(){if(this.Cyb){this.j1a=this.ML.text;
var U=this.Qxh();U&&(this.kTc=U);this.Al=C.a.instance.ga(826);this.Hqb=this.kTc===this.j1a}else this.ML.text?(this.j1a=this.ML.text,this.Hqb=!1):(this.j1a="",this.Hqb=!0),this.umb=0,this.Al=C.a.instance.ga(825);this.ML.pH&&(this.Hqb=!1,this.lHe=!0,w.EwaSettings.isChangeGateEnabled("OfficeVSO:5533269_formulaTextFixInHyperLink")&&(this.j1a=this.ML.formulaBarText))};e.prototype.XBi=function(U){return this.ea.vb.Mj(U)};e.prototype.eYe=function(U,M){return U?null:C.a.instance.ga(M)};e.prototype.cRh=function(U){var M=
f.Z(U,this.ea.va);var T=M.sheetName;var F=M.range;M.returnValue&&F&&(U=f.x(F,T||this.sheetName,!1));return U};Af.Object.defineProperties(e.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"HyperLinkDialog"}},uv:{configurable:!0,enumerable:!0,get:function(){return 526}}});e.rVj="validateLinkValues";e.yOg="bodyProps";e.jfh="disableDisplayText";e.agh="displayTextValue";e.Azg="activeLinkOption";e.Bzg="activeLinkValue";e.t3g="copyLinkValueToDisplay";e.isi="linkValue";e.Jlj="selectedLink";
e.$fh="displayText";Object(u.a)(e,"HyperlinkDialog",v.a,[]);var E=b(58);d.prototype.Lc=function(){return!1};d.prototype.Ac=function(U,M){return 1===U&&-1583422759===M.command};d.prototype.Qc=function(){return!1};d.prototype.executeCommand=function(){this.Vzj();return E.Task.Ua(!0)};d.prototype.Vzj=function(){var U=f.v(this.gridView.ha.sa.Vc,this.$),M=m.e(this.gridView);(!w.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.kq([this.gridView.ha.sa.Vc],
!0))&&M&&new e(this.$,U,M)};Object(u.a)(d,"ShowHyperlinkCommandHandler",null,[403]);var I=l.a;Rk(c,I);c.prototype.zd=function(){this.jd([new d(this.$,m.g(this.$))])};c.ka=function(U){l.a.Qd(105,new c(U))};Object(u.a)(c,"ShowHyperlinkCommandHandlerFactory",l.a,[]);b.d(D,"a",function(){return a})},1417:function(u,D,b){function a(){l.a.Fa(e.ka);l.a.Fa(c.ka)}function c(E){var I=G.call(this)||this;I.$=E;I.Eb();return I}function d(E,I){this.$=E;this.pi=I;this.$.da.Ga(393,this)}function e(E){var I=x.call(this,
E)||this;I.KCh=function(U,M,T,F,K){return 1===T?32:U===B.a.FQa&&2===T?(U=I.$.oa.xa.Pb(),n.D(I.$.oa.xa,K[0],K[1],null,null,U),32):8};return I}function k(E,I){this.$=E;this.pi=I}var l=b(11);u=b(0);var m=b(4),f=b(107),w=b(905),n=b(61),z=b(51),r=b(37),v=b(15),A=b(186),B=b(27),y=b(58);k.prototype.Lc=function(){return!1};k.prototype.executeCommand=function(E,I,U){E=2;switch(I.command){case -309686558:E=this.pi.ae(B.a.saveACopy,2,U);break;case 617689800:E=this.pi.ae(B.a.saveToCloudStorage,2,U);break;case -1244760097:E=
this.pi.ae(B.a.saveToSharePoint,2,U)}return 2===E&&I?A.a(I.command):y.Task.Ua(!0)};k.prototype.Ac=function(E,I){E=!1;switch(I.command){case -1244760097:case -309686558:case 617689800:E=!0,v.ULS.shipAssertTag(537153984,0,this.$.nka,"Command execute requested for SaveAs operation when data duplication is disallowed.")}return E};k.prototype.Qc=function(){return!1};Object(u.a)(k,"SaveToHostCommandHandler",null,[403]);var x=w.a;Rk(e,x);e.prototype.zd=function(){var E=this;r.TaskExtensions.Ba(z.GetServiceTaskFactory.create(this.$.da,
155,this.la,this.hb),function(){E.jd([new k(E.$,m.AFrameworkApplication.ub)])},this.la,3);m.AFrameworkApplication.ub.Mb(B.a.FQa,f.a.frame,this.KCh)};e.ka=function(E){w.a.Qd(267,new e(E))};Object(u.a)(e,"SaveToHostCommandHandlerFactory",w.a,[]);var C=b(232);d.prototype.Lc=function(E){switch(E){case -309686558:return 8===this.pi.processAction(B.a.saveACopy,1,null);case 617689800:return 8===this.pi.ae(B.a.saveToCloudStorage,1,null);case -1244760097:return 8===this.pi.ae(B.a.saveToSharePoint,1,null)}return!1};
d.prototype.dispose=function(){this.$=null};Object(u.a)(d,"SaveToHostManager",null,[540,10]);var G=C.a;Rk(c,G);c.prototype.create=function(){this.pb(this.$.da.za(393)||new d(this.$,m.AFrameworkApplication.ub))};c.ka=function(E){E.da.Ga(394,new c(E))};Object(u.a)(c,"SaveToHostManagerFactory",C.a,[]);b.d(D,"a",function(){return a})},1418:function(u,D,b){function a(){l.a.Fa(function(O){e.ka(O);c.ka(O)})}function c(O,N){var H=J.call(this)||this;H.activityName=O;H.nM=N;H.Eb();return H}function d(O,N,H,
Q,ca){O=K.call(this,O,N)||this;d.Jud=[-1468309555,611268539,-2087635043,2100961153,810218235,1112506702];d.Iud=[-1468309555,-315732528,-399065540,810218235,1531005923,1593924569,1112506702,1220851643];d.Snf=[-1468309555,611268539,-1750576502,61029505];d.Rnf=[-1468309555,-315732528,1112506702,-238814601,-1750576502,61029505,-1337545025];O.Lxc=H;O.HBj=Q;O.PKj=ca;return O}function e(){var O=B.call(this)||this;O.Eb();return O}function k(O,N){return v.call(this,O,N)||this}var l=b(11);u=b(0);var m=b(232),
f=b(15),w=b(85),n=b(115),z=b(29),r=b(35),v=n.a;Rk(k,v);k.prototype.execute=function(O){var N=Object(w.a)(6,O.ve);f.ULS.shipAssertTag(537153921,0,z.a.Lnb(O.errors),"SessionReloadActivity.Execute: Only recoverable errors should reach this activity.");N.$H(!0,!0);O.activityState[r.a.lYb]=N.ea.sessionId;O.activityState[r.a.xmb]=!0;O.activityState[r.a.rYb]=!0;f.ULS.sendTraceTag(537153920,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state");return 3};Object(u.a)(k,"SessionReloadActivity",
n.a,[]);var A=b(6),B=m.a;Rk(e,B);e.prototype.create=function(){this.pb(new k(A.a.gcb,A.a.Fk))};e.ka=function(O){O.da.Ga(142,new e)};Object(u.a)(e,"SessionReloadActivityFactory",m.a,[]);var y=b(54),x=b(281),C=b(110),G=b(47),E=b(44),I=b(34),U=b(1),M=b(46),T=b(255),F=b(116),K=n.a;Rk(d,K);d.prototype.execute=function(O){var N=Object(w.a)(6,O.ve);O.activityState[r.a.xra]=!0;var H=d.sXh(O);if(d.Pvj(O,H))return d.Dyi(O),H=50,0<O.errors.length&&(H=15),f.ULS.sendTraceTag(537153891,0,H,"SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : {0}",
z.a.Dc(O.errors)),O.activityState[r.a.xra]=!1,this.lh(A.a.idle),3;switch(H){case 1:case 3:this.mbi(O,H);break;case 2:this.lbi(O);break;case 0:O.activityState[r.a.aYa]=null}f.ULS.sendTraceTag(21837003,0,50,"SessionReloadSilentActivity.Execute: silentReloadType:{0}. activityName:{1}. NextActivityName:{2}. TimeFromLastStatefulResponse:{3}.",H,this.activityName,this.z_,N.ea.G7);var Q=I.a.xg(O.activityState,F.a.teb);f.ULS.shipAssertTag(40502925,0,!Q||Q&&(1===H||3===H),"triggerSilentReloadAfterTokenRefresh: {0}, silentReloadType: {1}",
Q,H);N=N.Ok.reloadCount;return 0!==H&&0<N?(Q=x.a.kva(N,200),f.ULS.sendTraceTag(537153890,0,50,"SessionReloadSilentActivity.Execute: schedule Silent-Type [{0}] retryNum [{1}] delayInMs [{2}] activityName [{3}]",H,N,Q,this.activityName),G.a.instance.create(function(){d.hM(O)},Q,E.a.Unj),1):3};d.prototype.mbi=function(O,N){f.ULS.sendTraceTag(8438495,0,50,"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");var H=Object(w.a)(6,O.ve);O.activityState[r.a.xmb]=!0;H.ifc||M.PageLoadTrackingInfo.instance.nj("ReopenOnLoad");
!d.isEditMode(O)&&z.a.Lnb(O.errors)&&(f.ULS.sendTraceTag(537153889,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),O.activityState[r.a.lYb]=H.ea.sessionId,O.activityState[r.a.rYb]=!0);O.Zud();3===N?(H.ea.kg()||H.ea.iEi(),H.$H(!0,!0),this.lh(this.PKj),O.activityState[r.a.Tje]=H.workbookContext.CalcMode):(U.EwaSettings.isChangeGateEnabled("OfficeVSO:5678588_FixSilentReopenAfterTokenRefresh")&&1===N&&H.$H(!0,!0),O.activityState[r.a.uTc]=
!1,this.lh(this.Lxc))};d.prototype.lbi=function(O){f.ULS.sendTraceTag(537153888,0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");O.activityState[r.a.aYa]=null;O.Zud();this.lh(this.HBj);O=Object(w.a)(6,O.ve);O.ifc||(M.PageLoadTrackingInfo.instance.nj("RefreshOnLoad"),O.nIb())};d.hM=function(O){O.hM()};d.sXh=function(O){var N=Object(w.a)(6,O.ve),H=N.ea,Q=d.isEditMode(O),ca=z.a.Zg(O.errors,Q?d.Iud:d.Jud),X=z.a.Zg(O.errors,Q?d.Rnf:d.Snf),Z=N.OQ,ea=N.Ok.reloadCount,ka=
N.ya.MaxConsecutiveSilentReloadAllowed,Y=N.Ok.h6e(),qa=z.a.Dc(O.errors),fa=z.a.Dc(O.fza),ha=0<z.a.sM(function(Qa){return!Qa.triggerSilentReopenOnly},O.errors).length,ia=ca,wa=I.a.xg(O.activityState,F.a.teb);wa&&(ia=!0);ca={name:"SessionReloadSilentActivity.GetSilentReloadType",editMode:Q,isSilentReopenError:ca,isSilentRefreshError:X};ca.reloadSequenceCount=N.Ok.QPa;ca.reloadCount=ea;ca.maxReloads=ka;ca.stopSilentReloads=Y;ca.errorNames=qa;ca.processedErrorNames=fa;ca.isClientDirty=Z;ca.errorsForSilentReopenOnly=
ha;ca.triggerSilentReloadAfterTokenRefresh=wa;ca.IsReopenDisabled=N.oMa;Z=y.a.xc(ca);f.ULS.sendTraceTag(21837004,0,50,Z);if(!Y){if(ia&&(Q?d.Gvj(O):d.Ivj(O)))return T.a.V0f(O,N)?3:N.oMa?2:1;if(X&&(Q||!H.vab))return 2}return 0};d.Pvj=function(O,N){for(var H=ak(O.errors),Q=H.next();!Q.done;Q=H.next())if(Q=Q.value,-1337545025===Q.MessageId||-238814601===Q.MessageId)return!1;return z.a.sM(function(ca){return!ca.triggerSilentReopenOnly},O.errors).length?3!==N:!1};d.Dyi=function(O){var N=z.a.sM(function(Q){return!Q.triggerSilentReopenOnly},
O.errors);N=ak(N);for(var H=N.next();!H.done;H=N.next())O.ela(H.value)};d.isEditMode=function(O){var N=Object(w.a)(6,O.ve);return N.ea.dc?N.Uu&&!!(N.Bd&64):I.a.xg(O.activityState,r.a.Cs)};d.Ivj=function(O){var N=Object(w.a)(6,O.ve),H=z.a.jaa(O.errors,d.Jud);if(C.b(H,function(Q){return Q.ForceVersionUpgrade}))return!1;O=z.a.Lnb(O.errors);return!N.ea.vab||O?!0:!1};d.Gvj=function(O){O=z.a.jaa(O.errors,d.Iud);return!C.b(O,function(N){return N.ForceVersionUpgrade})};d.Jud=null;d.Iud=null;d.Snf=null;d.Rnf=
null;Object(u.a)(d,"SessionReloadSilentActivity",n.a,[]);var J=m.a;Rk(c,J);c.prototype.create=function(){this.pb(new d(this.activityName,this.nM,A.a.Fk,A.a.jj,A.a.lNb))};c.ka=function(O){O.da.Ga(143,new c(A.a.hna,A.a.g0b));O.da.Ga(144,new c(A.a.rvc,A.a.JOa));O.da.Ga(145,new c(A.a.svc,A.a.vBd));O.da.Ga(154,new c(A.a.hcb,A.a.IO))};Object(u.a)(c,"SessionReloadSilentActivityFactory",m.a,[]);b.d(D,"a",function(){return a})},1428:function(u,D,b){function a(){Type.registerNamespace("Common.App.SharedFilePicker");
c.main()}function c(){this.fb=null}function d(r){this.ZKa=this.Z$a=null;this._initialized=!1;this.ujd=r}u=b(0);var e=b(15),k=b(83),l=b(4),m=b(167),f=b(392),w=b(170),n;(function(r){r[r.myFiles=0]="myFiles";r[r.recent=1]="recent";r[r.currentFolder=2]="currentFolder";r[r.yourPhone=3]="yourPhone"})(n||(n={}));Object(u.b)("SharedFilePickerLandingLocation",n);d.prototype.M1a=function(r){this._initialized||(r.Wn(w.a.YLf),r.Ml(w.a.YLf,Object(k.a)(this,this.lQi,"onReceivedPickerResponse")),this._initialized=
!0)};d.prototype.sdd=function(r){var v=this;return this.ZKa=new Promise(function(A,B){var y={};y[f.a.UXi]=r;v.Z$a=function(x,C){""===C?(e.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),A(x)):("Canceled"===C?e.ULS.sendTraceTag(572548164,306,50,C):e.ULS.sendTraceTag(556901065,306,10,C),B(C))};v.ujd.execute(function(x){v.M1a(x);x.xj(w.a.bVi,y)})})};d.prototype.lQi=function(r){this.Z$a(r.Values[f.a.Llj],void 0===r.Values[f.a.PCd]||null===r.Values[f.a.PCd]?"":r.Values[f.a.PCd])};
d.prototype.Vpd=function(){return l.AFrameworkApplication.fa.ra("UiHostCommonFilePicker")};d.prototype.XCe=function(r,v,A,B,y,x,C){var G=void 0===G?null:G;var E={};E[f.a.xlj]=r;E[f.a.titleText]=v;E[f.a.OIg]=A;E[f.a.PIg]=B;E[f.a.QIg]=!1;E[f.a.Rfh]=!0;E[f.a.lzh]=y;E[f.a.YXi]=x;E[f.a.XXi]=n[C];m.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(E[f.a.ZXi]="Dark");G&&(null!=G.EVc&&(E[f.a.EVc]=G.EVc),null!=G.okd&&(E[f.a.okd]=G.okd));return E};Object(u.a)(d,"SharedFilePickerManager",null,
[545]);var z=b(257);c.prototype.Sh=function(r){this.fb=r;r.register(d,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").tc().Cc(function(){return new d(r.Tb("Postmessage.IHostPostmessenger"))})};c.prototype.init=function(){var r=this;l.AFrameworkApplication.fa.Tu(function(){r.Dxb()})};c.prototype.Dxb=function(){this.fb.resolve("Common.App.SharedFilePicker.ISharedFilePicker")};c.prototype.dispose=function(){};c.main=function(){z.a.instance.Ui(new c)};
Af.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SharedFilePicker"}}});Object(u.a)(c,"SharedFilePickerPackage",null,[3,4]);b.d(D,"a",function(){return a})},1429:function(u,D,b){function a(){k.a.Fa(c.ka)}function c(E,I,U,M){var T=G.call(this)||this;T.activityName=E;T.nM=I;T.IJ=U;T.$=M;T.Eb();return T}function d(E,I,U){var M=C.call(this,E,I)||this;M.li=null;M.Rri=function(T){var F=M.rs.fd,K=Object(f.a)(6,F.ve);var J=T.Wrb;M.unsubscribe(function(H){T.remove_disposing(H)});
for(var O=0,N=F.errors.length;O<N;O++)-573864504===F.errors[O].MessageId&&F.ela(F.errors[O]);switch(J){case 1:K.ea.CAc=!0;m.ULS.sendTraceTag(537155485,0,50,"LegacySharedWorkbookActivity.LegacySharedDialogDisposing: User has selected to turn off the Legacy Shared Workbook setting ");M.lh(K.isEditMode?y.a.lNb:M.rch);M.ep();break;case 2:M.lh(y.a.openInExcelClient);M.ep();break;case 0:F.activityState[x.a.Cs]=!1,M.lh(M.IJ),M.ep()}};M.rch=I;M.IJ=U;return M}function e(E,I){E=B.call(this,E,I)||this;E.Cpa=
0;E.rr();return E}var k=b(11);u=b(0);var l=b(232),m=b(15),f=b(85),w=b(251),n=b(331),z=b(29),r=b(14),v=b(400),A=b(98),B=v.a;Rk(e,B);e.prototype.nO=function(E,I){this.Cpa=E;B.prototype.nO.call(this,E,I)};e.prototype.rr=function(){B.prototype.rr.call(this);this.Rb=9;var E=this.VQh();this.mc(1,r.a.instance.ga(1644));this.mc(2,r.a.instance.ga(986));this.nl(r.a.instance.ga(705),A.a.rh(E),this.icon,this.C0)};e.prototype.VQh=function(){return String.format(r.a.instance.ga(706))};Af.Object.defineProperties(e.prototype,
{nc:{configurable:!0,enumerable:!0,get:function(){return"SharedWorkbookDialog"}},Wrb:{configurable:!0,enumerable:!0,get:function(){return this.Cpa}}});Object(u.a)(e,"LegacySharedWorkbookDialog",v.a,[]);var y=b(6),x=b(35),C=w.a;Rk(d,C);d.prototype.initialize=function(E){C.prototype.initialize.call(this,E)};d.prototype.execute=function(E){this.li=E;this.G5g();return 1};d.prototype.wI=function(E){C.prototype.wI.call(this,E)};d.prototype.G5g=function(){var E=Object(f.a)(6,this.li.ve),I=z.a.OZa([-573864504]);
I[0].HelpDescription=r.a.instance.ga(708);I[0].HelpTopicId=n.a.Sri;var U=new e(E,I[0]);this.subscribe(this.li,this.Rri,function(M){U.add_disposing(M)})};Object(u.a)(d,"LegacySharedWorkbookActivity",w.a,[]);var G=l.a;Rk(c,G);c.prototype.create=function(){this.pb(new d(this.activityName,this.nM,this.IJ))};c.ka=function(E){E.da.Ga(460,new c(y.a.nBb,y.a.qeb,y.a.PGa,E))};Object(u.a)(c,"LegacySharedWorkbookActivityFactory",l.a,[]);b.d(D,"a",function(){return a})},1453:function(u,D,b){function a(){Type.registerNamespace("Common.App.DirectPrint");
l.a.instance.Ui(new c)}function c(){this.m4d=this.fb=null}u=b(0);var d=b(1490),e=b(1491),k=b(4);c.prototype.Sh=function(m){var f=this;this.fb=m;m.register(d.a,"Common.App.DirectPrint.DirectPrintDialogFactory").tc().Cc(function(){return new d.a(k.AFrameworkApplication.ta.hX)});m.register(607,"Common.App.DirectPrint.IDirectPrintManager").tc().Cc(function(){return e.a.create(f.fb)})};c.prototype.init=function(){this.m4d=this.fb.resolve("Common.App.DirectPrint.IDirectPrintManager");this.m4d.start()};
c.prototype.dispose=function(){};Af.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.DirectPrint"}}});Object(u.a)(c,"PackageManager",null,[3,4]);var l=b(257);b.d(D,"a",function(){return a})},1466:function(u,D,b){function a(X,Z){var ea=ca.call(this)||this;ea.Qa=new f.a;ea.XT=null;ea.xHc=[];ea.pmc=function(){ea.$.oa.DLa?ea.removeEntry(13):ea.Jf(13,null)};ea.sya=function(){F.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&
d.ULS.sendTraceTag(537170243,0,50,"BusinessBar.OnNetworkResumed: removing TransientServerCommunicationFailures BB");ea.removeEntry(21);ea.hC(55)&&(d.ULS.sendTraceTag(537170242,0,15,"BusinessBar.OnNetworkResumed: removing NetworkDown BB"),ea.removeEntry(55));ea.ZQf("OnNetworkResumed")};ea.ei=function(Y,qa){Y=0;for(var fa=a.occ().length;Y<fa;Y++){var ha=a.occ()[Y];ea.removeEntry(ha)}qa.context&&0<qa.context.communicationErrorRetryCount&&(d.ULS.sendTraceTag(537170240,0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),
ea.removeEntry(21));ea.ZQf("OnWebMethodSuccess")};ea.Jn=function(Y,qa){var fa;Y=ea.Gzh(qa.errors);for(var ha=[],ia=0,wa=Y.length;ia<wa;++ia){var Qa=Y[ia];if(1===Qa.Type&&Qa.Appearance&32)ha=ea.J3h(Qa,ha);else if(qa.Gnj){d.ULS.sendTraceTag(537170210,0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar");var S=(null===(fa=qa.context)||void 0===fa?0:fa.stopwatch)?qa.context.stopwatch.qc:-1;5E3>S?d.ULS.sendTraceTag(537170208,0,
50,"OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = {0}ms).",S):e.AFrameworkApplication.wgf()||ea.kDg(Qa,qa.context.methodName)}S=[].concat(yk(a.occ()));for(var da=0,xa=ha.length;da<xa;++da){var ta=ha[da];ea.Jf(ta,Qa);Array.remove(S,ta)}Qa=0;for(da=S.length;Qa<da;++Qa)ea.removeEntry(S[Qa])}};ea.tEb=function(Y,qa){Y=0;for(var fa=qa.errors.length;Y<fa;++Y){var ha=qa.errors[Y];e.AFrameworkApplication.wgf()||(F.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&
d.ULS.sendTraceTag(537170207,0,15,"BusinessBar.OnNetworkDownEvent: adding NetworkDown BB"),ea.Jf(55,ha))}};ea.Uc=function(Y,qa){ea.Fc(Y,qa)};ea.Fc=function(){var Y=ea.$.ea;Y.dc||Y.kg()||(ea.BHd(),Array.clear(ea.xHc))};ea.Yc=function(Y,qa){ea.$.ea.kg()&&!qa.zV||ea.l9e(qa.zV)};ea.$Eb=function(){var Y=ea.$.userOperationManager.bcc();Y&&Y.operation.flags&1&&ea.P2f()};ea.oxf=function(){ea.P2f()};ea.Sf=function(){ea.axe();ea.Y2f()};ea.sN=function(){if(ea.$.f5&&ea.$.ea.kg()&&ea.$.ea.dc)if(ea.$.ea.isEditMode)ea.removeEntry(44),
ea.removeEntry(12),ea.removeEntry(29),ea.removeEntry(30),ea.removeEntry(31),ea.removeEntry(32),ea.removeEntry(22),ea.removeEntry(56);else{var Y=ea.$.da.za(331);Y&&Y.VIa||ea.removeEntry(54);ea.removeEntry(5)}};ea.$=X;ea.NYa=Z;ea.FLg();e.AFrameworkApplication.qd&&e.AFrameworkApplication.qd.YTc(ea);ea.XXa=Array(68);for(var ka=0;68>ka;ka++)ea.XXa[ka]=null;ea.ah=M.EcmaDateClock.instance;ea.pif=ea.ah.Jb.getTime();Z&&(Z=X.oa,ka=Z.tf,Z.Ky(ea.Jn),Z.Vq(ea.ei),Z.Tmb(ea.pmc),Z.lYa(ea.pmc),F.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled")||
(ka.HFg(ea.tEb),ka.bnb(ea.sya)),X.ea.Wj(ea.Uc),X.ea.Bu(ea.Sf),X.Tk(ea.Yc),X.Ck(ea.Fc),X.ea.p2(ea.sN),X.userOperationManager.Cr(ea.$Eb),F.EwaSettings.ma(170)&&X.ea.Kg.get(45)&&e.AFrameworkApplication.fa.ra("SupportsPolicies")||ea.$4e(),ea.l9e(O.c(X)));X.da.Ga(5,ea);return ea}function c(X,Z,ea){ea=void 0===ea?null:ea;var ka=v.call(this)||this;ka.sGa=X;ka.a6c=Z;ka.data=ea;return ka}u=b(0);var d=b(15),e=b(4),k=b(90),l=b(25),m=b(127),f=b(38),w=b(79),n;(function(X){X[X.unableToRefreshLock=0]="unableToRefreshLock";
X[X.unableToRefreshLockExpected=1]="unableToRefreshLockExpected";X[X.workbookAlmostTooLarge=2]="workbookAlmostTooLarge";X[X.workbookTooLarge=3]="workbookTooLarge";X[X.externalWorkbookLinksDisabled=4]="externalWorkbookLinksDisabled";X[X.externalWorkbookLinksShowError=5]="externalWorkbookLinksShowError";X[X.editAndRefreshDisabledOnBIAHostedFiles=6]="editAndRefreshDisabledOnBIAHostedFiles";X[X.unsupportedFeatures=7]="unsupportedFeatures";X[X.collabDataAndDataStringsLocaleMismatch=8]="collabDataAndDataStringsLocaleMismatch";
X[X.collabDataStringsLocaleMismatch=9]="collabDataStringsLocaleMismatch";X[X.collabDataLocaleMismatch=10]="collabDataLocaleMismatch";X[X.lastGenericStatusError=11]="lastGenericStatusError";X[X.scratchPadWarning=12]="scratchPadWarning";X[X.authenticationLost=13]="authenticationLost";X[X.odfCompatibilityIssues=14]="odfCompatibilityIssues";X[X.pivotChartInteractivityMissingWarning=15]="pivotChartInteractivityMissingWarning";X[X.workbookIsIrmProtected=16]="workbookIsIrmProtected";X[X.biFeatureNotAvailable=
17]="biFeatureNotAvailable";X[X.anonymousCreateSaveWarning=18]="anonymousCreateSaveWarning";X[X.unsupportedInteractiveReportEditing=19]="unsupportedInteractiveReportEditing";X[X.mobileAppCampaignBizBar=20]="mobileAppCampaignBizBar";X[X.transientServerCommunicationFailures=21]="transientServerCommunicationFailures";X[X.editAttemptInReadOnly=22]="editAttemptInReadOnly";X[X.editAttemptInReadOnlyNoEditPermissions=23]="editAttemptInReadOnlyNoEditPermissions";X[X.unsupportedBrowser=24]="unsupportedBrowser";
X[X.readOnlyPermissions=25]="readOnlyPermissions";X[X.documentIsIrmProtectedWarning=26]="documentIsIrmProtectedWarning";X[X.policyWarningMessage=27]="policyWarningMessage";X[X.workingOnIt=28]="workingOnIt";X[X.passwordProtectedWorkbookLockedForEdit=29]="passwordProtectedWorkbookLockedForEdit";X[X.workbookIsReadOnlyRecommended=30]="workbookIsReadOnlyRecommended";X[X.workbookHasPasswordToModify=31]="workbookHasPasswordToModify";X[X.legacySharedWorkbookEditWarningBB=32]="legacySharedWorkbookEditWarningBB";
X[X.legacyConnectionsBB=33]="legacyConnectionsBB";X[X.groupedSlicersBB=34]="groupedSlicersBB";X[X.thirdPartyAddinDisabled=35]="thirdPartyAddinDisabled";X[X.financeLinkedEntityDisclaimerBar=36]="financeLinkedEntityDisclaimerBar";X[X.wolframDeprecationAlertBar=37]="wolframDeprecationAlertBar";X[X.wacGdprNotice=38]="wacGdprNotice";X[X.automaticSensitivityLabel=39]="automaticSensitivityLabel";X[X.recommendedSensitivityLabel=40]="recommendedSensitivityLabel";X[X.mandatorySensitivityLabel=41]="mandatorySensitivityLabel";
X[X.localStorageDisabled=42]="localStorageDisabled";X[X.autoRefreshDisabled=43]="autoRefreshDisabled";X[X.corruptedFileRepaired=44]="corruptedFileRepaired";X[X.corruptedOdsFileRepaired=45]="corruptedOdsFileRepaired";X[X.minorVersionLimitReached=46]="minorVersionLimitReached";X[X.sensitivityApplicationGenericError=47]="sensitivityApplicationGenericError";X[X.sensitivityApplicationTooLargeFileError=48]="sensitivityApplicationTooLargeFileError";X[X.sensitivityApplicationLabelNotSupportedError=49]="sensitivityApplicationLabelNotSupportedError";
X[X.sensitivityApplicationLabelDisabledError=50]="sensitivityApplicationLabelDisabledError";X[X.sensitivityApplicationMandatoryConflictError=51]="sensitivityApplicationMandatoryConflictError";X[X.sensitivityApplicationMinorVersionLimitReachedError=52]="sensitivityApplicationMinorVersionLimitReachedError";X[X.sensitivityApplicationSetLabelError=53]="sensitivityApplicationSetLabelError";X[X.promptEnableExternalLinks=54]="promptEnableExternalLinks";X[X.networkDown=55]="networkDown";X[X.defaultToViewDueToCogs=
56]="defaultToViewDueToCogs";X[X.refreshLinkedEntityErrorBar=57]="refreshLinkedEntityErrorBar";X[X.promptEnableLinkedEntitiesUntrustedImages=58]="promptEnableLinkedEntitiesUntrustedImages";X[X.canvasHealth=59]="canvasHealth";X[X.novModeDepreciation=60]="novModeDepreciation";X[X.mismatchedFileFormatConverted=61]="mismatchedFileFormatConverted";X[X.optimizeWorkbook=62]="optimizeWorkbook";X[X.novModePostDepreciation=63]="novModePostDepreciation";X[X.officeScriptsRunning=64]="officeScriptsRunning";X[X.powerQueryRefreshDataSourceNotSupported=
65]="powerQueryRefreshDataSourceNotSupported";X[X.readOnlyPivotTable=66]="readOnlyPivotTable";X[X.powerQueryRefreshHostNotSupported=67]="powerQueryRefreshHostNotSupported";X[X.count=68]="count"})(n||(n={}));Object(u.b)("EwaBusinessBarEntryType",n);var z=b(5),r=b(1265),v=Sys.EventArgs;Rk(c,v);Object(u.a)(c,"BusinessBarEntryDisplayChangedEventArgs",Sys.EventArgs,[]);var A=b(1267),B=b(1266),y=b(1269),x=b(1268),C=b(1263),G=b(524),E=b(51),I=b(591),U=b(37),M=b(742),T=b(29),F=b(1),K=b(10),J=b(21),O=b(56),
N=b(67),H=b(1047),Q=b(187);b.d(D,"a",function(){return a});var ca=w.a;Rk(a,ca);a.prototype.$4e=function(){T.a.Xq(this.$.ea.vF)&&this.Jn(this,new G.a(this.$.ea.vF,null,!1,-1,-1,-1,-1,"",-1,"",-1))};a.prototype.MDg=function(X){this.Qa.addHandler("bBarAttachedOrDetached",X)};a.prototype.dispose=function(){if(this.$){var X=this.$,Z=X.oa,ea=Z.tf;Z.Hz(this.Jn);Z.cs(this.ei);Z.msc(this.pmc);Z.IHb(this.pmc);ea.VHb(this.sya);ea.Pbj(this.tEb);X.ea.xk(this.Uc);X.ea.Gw(this.Sf);X.ol(this.Yc);X.Ol(this.Fc);X.ea.e0(this.sN);
X.userOperationManager.wo(this.$Eb);J.g(X).Wb.wk(this.oxf)}k.a.Ia(this.XT);this.$=this.XT=null;ca.prototype.dispose.call(this)};a.prototype.Wei=function(X){switch(X){case 4:case 5:case 11:case 54:case 7:case 36:case 37:return!0;case 58:return F.EwaSettings.ma(657);default:return!1}};a.prototype.Jf=function(X,Z,ea,ka,Y){ea=void 0===ea?null:ea;ka=void 0===ka?null:ka;Y=void 0===Y?null:Y;if(!this.$.isMobileMode||this.Wei(X))this.NYa&&!this.hC(X)&&(F.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&
d.ULS.sendTraceTag(537170254,0,50,"Adding entry to BB: {0}",Enum.toString(n,X)),this.XXa[X]=this.ah.Y7,this.XT.VD(X,Z,ka,Y),this.Qa.raiseEvent("bBarAttachedOrDetached",new c(X,!0,ea))),Z&&32===Z.Appearance&&N.a(this.$).fd.ela(Z)};a.prototype.Jzj=function(X,Z,ea,ka){d.ULS.sendTraceTag(537170253,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");C.a.initialize(X,Z,ea,ka);this.Jf(38,null)};a.prototype.Myj=function(X,Z,ea,ka){r.a.initialize(X,Z,ea,ka);this.Jf(39,null)};a.prototype.UAj=function(X,Z,ea,
ka){B.a.initialize(X,Z,ea,ka);this.Jf(40,null)};a.prototype.iAj=function(X,Z,ea,ka){A.a.initialize(X,Z,ea,ka);this.Jf(41,null)};a.prototype.cBj=function(X,Z,ea,ka){x.a.initialize(X,Z,ea,ka);this.Jf(52,null)};a.prototype.bBj=function(X,Z,ea,ka){y.a.initialize(X,Z,ea,ka);this.Jf(53,null)};a.prototype.removeEntry=function(X){this.NYa&&(F.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&d.ULS.sendTraceTag(537170251,0,50,"Removing entry from BB: {0}",Enum.toString(n,X)),this.XXa[X]=
null,this.XT.removeEntry(X)&&this.Qa.raiseEvent("bBarAttachedOrDetached",new c(X,!1)))};a.prototype.ULa=function(X){return this.NYa?this.XT.ULa(X):!1};a.prototype.hC=function(X){return this.NYa?this.XT.hC(X):!1};a.prototype.VCb=function(){d.ULS.sendTraceTag(537170248,0,50,"Network disconnect notification received from the app")};a.prototype.Blc=function(){d.ULS.sendTraceTag(537170247,0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");
this.removeEntry(21)};a.prototype.FLg=function(){var X=b(1358).BusinessBarControl;if(this.NYa&&!this.XT){J.g(this.$).Wb.Bk(this.oxf);var Z=document.getElementById(this.$.yb+z.a.nue);this.XT=new X(this.$,Z)}};a.prototype.BHd=function(){this.NYa&&this.XT.BHd()};a.prototype.ZQf=function(X){if(F.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")){var Z=this.ah.Y7;if(3E5<=Z-this.pif){this.pif=Z;for(var ea=0;68>ea;ea++){var ka=this.XXa[ea];ka&&(ka=Z-ka,3E5<=ka&&d.ULS.sendTraceTag(537170241,
0,50,"{0}: entry [{1}] was activated but not turned off for {2} Millis",X,Enum.toString(n,ea),ka))}}}};a.prototype.Gzh=function(X){for(var Z=[],ea=ak(X),ka=ea.next();!ka.done;ka=ea.next())switch(ka.value.MessageId){case -113742550:ka=[757111532,2113407564,1393475740,1911608588,104919273,-689453604,157762400,-949523941],(this.$.ea.isNamedObjectViewMode||T.a.Zg(X,ka))&&Z.push(-113742550)}return T.a.CF(X,Z)};a.prototype.J3h=function(X,Z){switch(X.MessageId){case 2113407564:for(var ea=T.a.OZa([1821390342,
-943219229,-502303485,1437034227]),ka=0;ka<ea.length;ka++)ea[ka].HelpTopicId=X.HelpTopicId,ea[ka].HelpDescription=X.HelpDescription,this.xHc.push(ea[ka])}switch(X.MessageId){case -395951567:this.Jf(6,X);break;case 1643490758:this.Jf(4,X);break;case -907264831:this.Jf(5,X);break;case 757111532:case 2113407564:this.Jf(7,X);break;case 2010656511:this.Jf(15,X);break;case 1321660996:this.$.E4c=!0;this.Jf(8,X);break;case 526339737:this.$.E4c=!0;this.Jf(9,X);break;case -407088521:this.Jf(10,X);break;case 1756116017:this.Jf(14,
X);break;case -1703455218:this.Jf(17,X);break;case 1393475740:this.Jf(25,X);break;case -949523941:this.Jf(26,X);break;case 1779381952:this.Jf(43,X);break;case 1421575100:this.Jf(44,X);break;case 613676060:this.Jf(45,X);break;case 1233668252:this.Jf(61,X);break;case 1911608588:X=!!(this.$.Bd&64);!this.$.ea.kg()&&X&&Z.push(29);break;case 1544494907:break;case -655555355:Z.push(this.wqd()?1:0);break;case -1221382671:Z.push(2);break;case 1662282929:Z.push(3);break;case 104919273:this.$.ea.kg()||Z.push(30);
break;case -689453604:X=!!(this.$.Bd&64);this.$.ea.k6e=!0;!this.$.ea.kg()&&X&&Z.push(31);break;case 157762400:this.$.ea.Agc=!0;!this.$.ea.kg()&&this.$.Bd&64&&!this.$.isEditMode&&Z.push(32);break;case -73730134:F.EwaSettings.isChangeGateEnabled("OfficeVSO:6079602_EnableEditingOfFilesWithLegacyConnections")&&!this.$.ea.kg()&&this.$.Bd&64&&Z.push(33);break;case -293349236:Z.push(65);break;case 1580811823:Z.push(67);break;case -37299333:break;case 136737622:Z.push(46);break;case -1780327030:this.Jf(54,
X);break;case -113742550:this.Jf(56,X);break;case -260312420:this.$.ea.kg()||Z.push(66);break;default:this.Jf(11,X)}return Z};a.prototype.S9h=function(){var X=this;if(e.AFrameworkApplication.fa.ra("WildFireExcelBizBar")&&!H.a.nod(H.a.icd(1))&&(l.a.Wo||l.a.sh)){var Z=E.GetServiceTaskFactory.create(this.$.da,155,this.$.la,1);U.TaskExtensions.Ba(Z,function(){X.Jf(20,null)},this.la,3)}};a.prototype.P9h=function(){var X=F.EwaSettings.ma(74),Z=F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IE11SoftBlockConsumerIsEnabled",
!1),ea=F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IE11SoftBlockStringIsEnabled",!1);K.HelperMethods.JQd(ea||Z,X)&&(Q.a("NewBrowserSuggestionShown"),ea||m.a.mv("NewBrowserSuggestionShown","true",7),this.Jf(24,null))};a.prototype.l9h=function(X){!X&&I.b(this.$)&&this.Jf(60,null)};a.prototype.m9h=function(X){!X&&I.c(this.$)&&this.Jf(63,null)};a.prototype.l9e=function(X){(!X&&!this.$.printingEnabled||this.$.Lf.get(1))&&this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription&&
(d.ULS.sendTraceTag(537170205,0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),this.Jf(16,null));this.S9h();this.P9h();this.axe();this.Y2f();this.l9h(X);this.m9h(X)};a.prototype.axe=function(){this.$.workbookContext.Options&32768&&this.zzj()};a.prototype.zzj=function(){this.XXa[36]||this.Jf(36,null)};a.prototype.DBj=function(){this.XXa[37]||this.Jf(37,null)};a.prototype.Y2f=function(){F.EwaSettings.ma(657)&&this.$.workbookContext.Options&524288&&this.Jf(58,null)};a.prototype.u3f=
function(X,Z){this.Jf(57,X,null,Z)};a.prototype.ele=function(X,Z){var ea=null,ka=null;ea=void 0===ea?null:ea;ka=void 0===ka?null:ka;Z=void 0===Z?null:Z;this.XT.hC(X)?this.XT.TNb(X,Z):this.Jf(X,null,ea,ka,Z)};a.prototype.P2f=function(){this.$.Bd&8&&this.Jf(12,null)};a.prototype.wqd=function(){var X=this.$.da.za(38);return X?X.tokenExpired:!1};a.prototype.kDg=function(X,Z){if(!this.hC(21)&&-1387426400!==X.MessageId){d.ULS.sendTraceTag(537170204,0,50,"BusinessBar: raising the transient communication failures notification.");
var ea={};ea.FailedMethod=Z;this.Jf(21,X,ea)}};a.occ=function(){return a.Aoe||(a.Aoe=[0,1,2,3])};Af.Object.defineProperties(a.prototype,{d7c:{configurable:!0,enumerable:!0,get:function(){return this.xHc}},domElement:{configurable:!0,enumerable:!0,get:function(){return this.XT?this.XT.domElement:null}}});a.Aoe=null;Object(u.a)(a,"BusinessBarManager",w.a,[942,10,81])},1479:function(u,D,b){function a(){l.a.Fa(c.ka)}function c(m){var f=k.call(this)||this;f.$=m;f.Eb();return f}u=b(0);var d=b(232),e=b(1466),
k=d.a;Rk(c,k);c.prototype.create=function(){this.pb(this.$.da.za(5)||new e.a(this.$,!this.$.cba))};c.ka=function(m){m.da.Ga(4,new c(m))};Object(u.a)(c,"BusinessBarManagerFactory",d.a,[]);var l=b(11);b.d(D,"a",function(){return a})},1489:function(u,D,b){function a(z,r,v,A,B,y){this.ONc=null;this._id=z;this.uOc=r;this.gpg=void 0===B?null:B;this.Rib=A;this.blb=void 0===y?null:y;this.cpa=null;this.GXa=v;this.Alb=c.instance.WXh(r,z)}function c(){this.BEc=new m.a;this.zEc=new m.a;this.yEc=new m.a;this.BPg(this.BEc);
this.APg(this.zEc);this.zPg(this.yEc);this.CJc=new m.a;this.BJc=new m.a;this.AJc=new m.a;this.YRg(this.CJc);this.XRg(this.BJc);this.WRg(this.AJc);this.QFc=new m.a;this.UPg(this.QFc);this.uFa(this.QFc);this.uFa(this.yEc);this.uFa(this.zEc);this.uFa(this.BEc);this.uFa(this.BJc);this.uFa(this.CJc);this.uFa(this.AJc)}u=b(0);var d=b(15),e=b(83),k=b(1062),l=b(1047),m=b(1410);c.prototype.WXh=function(z,r){switch(z){case 1:return this.m0h(r);case 2:return this.THh(r)}return l.a.gxc?this.QFc:null};c.prototype.BPg=
function(z){z.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);z.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);z.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)};c.prototype.APg=function(z){z.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);z.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);z.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)};c.prototype.zPg=function(z){z.add("Headline",
CommonUIStrings.l_WildFireExcelBizBarHeadline);z.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);z.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)};c.prototype.YRg=function(z){z.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);z.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);z.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);z.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);
z.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);z.add("OverlayBig","Get the Word app");z.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");z.add("OverlaySmallSplit1","Discover Word");z.add("OverlaySmallSplit2","designed for the iPad.");z.add("SkipButton","Skip for now")};c.prototype.UPg=function(z){z.add("Headline","Get the Office Online extension for Chrome");z.add("UseAppButton","Get the extension");z.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")};
c.prototype.XRg=function(z){z.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);z.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);z.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);z.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);z.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);z.add("OverlayBig","Get the PowerPoint app");z.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");
z.add("OverlaySmallSplit1","Discover PowerPoint");z.add("OverlaySmallSplit2","designed for the iPad.");z.add("SkipButton","Skip for now")};c.prototype.WRg=function(z){z.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);z.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);z.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);z.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);z.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)};
c.prototype.uFa=function(z){z.add("Corporation","Microsoft Corporation")};c.prototype.m0h=function(z){switch(z){case 3:return this.CJc;case 2:return this.BJc;case 1:return this.AJc}return null};c.prototype.THh=function(z){switch(z){case 3:return this.BEc;case 2:return this.zEc;case 1:return this.yEc}return null};Af.Object.defineProperties(c,{instance:{configurable:!0,enumerable:!0,get:function(){c.Ma||(c.Ma=new c);return c.Ma}}});c.Ma=null;Object(u.a)(c,"WildFireStringFactory",null,[]);var f=b(4),
w=b(39),n=b(25);b.d(D,"a",function(){return a});a.prototype.G2c=function(){this.cpa=new k.a(this.title,this.message,null);this.cpa.addButton(this.vue,Object(e.a)(this,this.Qtf,"onButtonOneClick"),"");this.GXa&&this.cpa.uCg(this.xue,Object(e.a)(this,this.Ttf,"onButtonTwoClick"));this.cpa.t$=Object(e.a)(this,this.AHe,"dismissBar");this.cpa.image=3;this.cpa.id=16;this.cpa.closeable=!0};a.prototype.Qtf=function(){this.GXa?this.Ybi():this.gUj()};a.prototype.Ttf=function(){this.GXa&&this.CUi()};a.prototype.Ybi=
function(){d.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.Rib&&this.blb&&this.blb();l.a.BMf(this._id,this.uOc)};a.prototype.CUi=function(){this.openUrl&&(d.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.Rib&&this.blb&&this.blb(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(l.a.Dpe(this._id),this.openUrl,0,!1))};a.prototype.gUj=function(){l.a.gxc?this.eSg():(d.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),
l.a.OOd("BizBarClicked"),1!==this.uOc&&2!==this.uOc||l.a.FYg(this.openUrl,this.Rib,this._id,this.blb))};a.prototype.eSg=function(){this.Rib?d.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):d.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");w.a.UU(f.AFrameworkApplication.fa.appSettings.WildFireChromeExtensionUrl.toString())};a.prototype.zfh=function(){this.Rib?d.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):d.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");
l.a.OOd(l.a.zxe)};a.prototype.AHe=function(){l.a.gxc?this.zfh():(l.a.OOd(l.a.icd(this._id)),d.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))};a.G4b=function(){var z=f.AFrameworkApplication.ta.Pa,r=new a(z.Fj,l.a.mcc(),8<n.a.$4a,1===z.lca,function(){return z.vx},z.AUf());d.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed");return r};Af.Object.defineProperties(a.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return this.Alb.na("Headline")}},message:{configurable:!0,
enumerable:!0,get:function(){return this.Alb.na("CallToAction")}},pUj:{configurable:!0,enumerable:!0,get:function(){return this.GXa}},vue:{configurable:!0,enumerable:!0,get:function(){return this.GXa?this.Alb.na("InstallButton"):this.Alb.na("UseAppButton")}},xue:{configurable:!0,enumerable:!0,get:function(){return this.GXa?this.Alb.na("OpenAppButton"):""}},aSg:{configurable:!0,enumerable:!0,get:function(){return this.cpa}},openUrl:{configurable:!0,enumerable:!0,get:function(){this.ONc||(this.ONc=
this.gpg());return this.ONc}}});Object(u.a)(a,"WildFireBusinessBar",null,[])},1490:function(u,D,b){function a(x){this.hP=x}function c(x,C,G,E){E=void 0===E?null:E;var I=y.call(this)||this;I.Ppa=null;I.Vl=null;I.lP=null;I.Pm=[];I.MUb=C;I.hP=x;I.Apg=G;I.ZVb=E;I.zlb=new B.a("LoadResource","LoadPrintablePdf");return I}u=b(0);var d=b(15),e=b(83),k=b(135),l=b(4),m=b(13),f=b(96),w=b(43),n=b(183),z=b(1282),r=b(89),v=b(55),A=b(81),B=b(1148),y=k.StandardDialog;Rk(c,y);c.prototype.dQ=function(){this.Rb=5;this.width=
40;var x=document.createElement("span");x.id=this.di("DirectPrintHeaderContent");var C=document.createElement("span");C.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(C,"DirectPrintHeader");this.lP=document.createElement("iframe");this.lP.name="pdfObjectFrame";this.lP.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.lP.onload=Object(e.a)(this,this.G0i,"printablePdfLoaded");if(this.ZVb&&0<this.ZVb.count){var G=A.a.Zed(this.MUb,this.ZVb),E=A.a.ZHd(this.MUb,this.ZVb);
this.Vl=document.createElement("form");this.Vl.id="printPreviewPostForm";this.Vl.method="POST";this.Vl.target=this.lP.name;this.Vl.action=E;G=ak(G);for(E=G.next();!E.done;E=G.next()){E=E.value;var I=document.createElement("input");I.type="hidden";I.name=E.key;I.value=E.value;this.Vl.appendChild(I)}}else this.lP.setAttribute("src",this.MUb);Sys.UI.DomElement.addCssClass(this.lP,n.a.wbe);this.Apg?(Sys.UI.DomElement.addCssClass(this.lP,"DirectPrintPdfObjectHidden"),C.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,
r.a.kh(this.lP,r.a.bC,r.a.Xj)):(Sys.UI.DomElement.addCssClass(this.lP,"DirectPrintPdfObject"),this.Pm.push(this.lP));x.appendChild(C);x.appendChild(document.createElement("br"));x.appendChild(this.lP);this.Vl&&x.appendChild(this.Vl);x.appendChild(document.createElement("br"));x.appendChild(this.q1g(this.Vl?"#":this.MUb));this.zlb.start();this.uCb(CommonUIStrings.l_AppTitle,null,null,null,null,x);this.YW(this.di("DirectPrintHeaderContent"));this.Vl&&this.Vl.submit();this.o6g();d.ULS.sendTraceTag(4771852,
328,50,"Direct Print Dialog launched.")};c.prototype.q1g=function(x){var C=document.createElement("span"),G=document.createElement("span");G.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;C.appendChild(G);l.AFrameworkApplication.fa&&(2===l.AFrameworkApplication.ta.Pa.Fj&&l.AFrameworkApplication.fa.ra("PPTDisableDirectPrintDialogDownloadPDFLink")||1===l.AFrameworkApplication.ta.Pa.Fj&&l.AFrameworkApplication.fa.ra("XLODisableDirectPrintDialogOpenPDFLink"))?(x=document.createElement("span"),
2===l.AFrameworkApplication.ta.Pa.Fj?x.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===l.AFrameworkApplication.ta.Pa.Fj&&(x.innerText=CommonUIStrings.l_InternalError_Directive,d.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.Ppa=x,C.appendChild(document.createElement("br")),C.appendChild(x)):(G=document.createElement("a"),G.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,G.href=x,G.target="_blank",G.id="PrintPDFLink",G.className=
"AllowBrowserClick",this.Ppa=G,C.appendChild(document.createElement("br")),C.appendChild(G),this.Vl&&w.a.addHandler(G,"click",Object(e.a)(this,this.poc,"onSubmit")),this.hP.qa(m.a.click,this.Ppa,Object(e.a)(this,this.GIe,"downloadPDFLinkClicked"),null));this.Pm.push(this.Ppa);return C};c.prototype.poc=function(x){this.Vl&&(this.Vl.target="_blank",this.Vl.submit());x.preventDefault()};c.prototype.o6g=function(){if(0<this.Pm.length){var x=new z.a(this.Pm),C=f.FocusManager.instance().yQ();C&&(this.Ppa.focus(),
C.We=x,C.q_=!0)}};c.prototype.GIe=function(){d.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1};c.prototype.gtd=function(){d.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")};c.prototype.G0i=function(){d.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.zlb&&this.zlb.stop()};c.prototype.dispose=function(){this.Ppa&&(this.hP.Aa(m.a.click,this.Ppa,Object(e.a)(this,this.GIe,"downloadPDFLinkClicked")),
this.Ppa=null);v.a.d0(this.lP);this.lP=null;y.prototype.dispose.call(this)};Object(u.a)(c,"DirectPrintDialog",k.StandardDialog,[628]);b.d(D,"a",function(){return a});a.prototype.FMh=function(x,C,G){return new c(this.hP,x,C,void 0===G?null:G)};Object(u.a)(a,"DirectPrintDialogFactory",null,[611])},1491:function(u,D,b){function a(r,v,A,B,y,x,C,G,E,I){this.pXb=null;this.kng=r;this.Vjb=v;this.pNc=A;this.Jqg=B;this.org=y;this.GOc=new e.a(Object(k.a)(this,this.wUh,"getProbeResults"));this.cVa=x;this.p$d=
E;this.Dwg=C;this.prg=G;this.wrg=I}function c(r,v){this.Y6f=r;this.zSa=v}u=b(0);var d=b(15),e=b(615),k=b(83),l=b(1543),m=b(1283);Object(u.a)(c,"DirectPrintProbeResults",null,[]);var f=b(4),w=b(279),n=b(25),z=b(113);b.d(D,"a",function(){return a});a.prototype.start=function(){};a.prototype.H2i=function(){var r=Array(this.uC.ySa.length);if(void 0!==this.Vjb&&null!==this.Vjb)for(var v=0;v<this.uC.ySa.length;v++)r[v]=this.uC.ySa[v]in this.Vjb&&this.Jqg(this.Vjb[this.uC.ySa[v]]);return r};a.prototype.I2i=
function(){for(var r=Array(this.uC.zSa.length),v=!(void 0===this.pNc||null===this.pNc),A=0;A<this.uC.zSa.length;A++){var B=this.uC.zSa[A];r[A]=v&&B in this.pNc?!0:this.org(B)}return r};a.prototype.kYh=function(){for(var r=this.H2i(),v=Array(r.length),A=0;A<r.length;A++)v[A]=r[A]?this.Txh(this.Vjb[this.uC.ySa[A]]):null;return v};a.prototype.Txh=function(r){if(void 0===r||null===r)return null;r=r.enabledPlugin;return void 0===r||null===r?null:r.name};a.prototype.wUh=function(){for(var r=this.kYh(),
v=this.I2i(),A={},B={},y=0;y<this.uC.ySa.length;y++)A[this.uC.ySa[y]]=r[y];for(r=0;r<this.uC.zSa.length;r++)B[this.uC.zSa[r]]=v[r];return new c(A,B)};a.prototype.syj=function(){return this.wrg||!this.uC.isEnabled||f.AFrameworkApplication.isUnifiedHostMode?!1:this.rGj()};a.prototype.ixc=function(){if(null!=this.pXb)return this.pXb;var r=a.Xbf(this.uC);return this.pXb=this.uC.Ybf&&r||this.ufi()};a.prototype.ufi=function(){return n.a.Xo&&this.uC.wfi&&n.a.Bxe>=this.uC.oXg?!0:!1};a.prototype.rGj=function(){if(!this.prg(this.uC))return!1;
var r=z.a.Bgd(this.GOc.value.Y6f);r=ak(r);for(var v=r.next();!v.done;v=r.next())if(v=v.value,void 0!==v&&null!==v)return!0;r=z.a.Bgd(this.GOc.value.zSa);r=ak(r);for(v=r.next();!v.done;v=r.next())if(v.value)return!0;return!1};a.prototype.I4h=function(){var r=z.a.Bgd(this.GOc.value.Y6f);r=ak(r);for(var v=r.next();!v.done;v=r.next())if(w.a.contains(this.uC.a8h,v.value))return!0;return!1};a.prototype.q3f=function(r){var v=void 0===v?!1:v;var A=void 0===A?null:A;f.AFrameworkApplication.ta&&f.AFrameworkApplication.fa.ra("DirectPrintDialogAsStandardDialogIsEnabled")?
this.p$d(r,A):this.syj()?this.Sfh(r,this.I4h()&&!v,A):this.p$d(r,A)};a.prototype.Sfh=function(r,v,A){A=void 0===A?null:A;var B=this.Dwg.sc("UserAction","OpenDirectPrintDialog");this.cVa.FMh(r,v,A).dQ();B.stop()};a.Dgf=function(r){try{return new ActiveXObject(r),!0}catch(v){d.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",r)}return!1};a.Zbf=function(r){return void 0===r||null===r?!1:!(void 0===r.enabledPlugin||null===r.enabledPlugin)};a.create=function(r){var v=
new m.a(f.AFrameworkApplication.fa.appSettings),A=null;try{A=window.navigator.mimeTypes}catch(I){d.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}var B=null;try{B=window.navigator.plugins}catch(I){d.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}var y=a.Zbf,x=a.Dgf;r=r.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");var C=f.AFrameworkApplication.ta.tD,G=a.Egf,E=!!f.AFrameworkApplication.ta&&f.AFrameworkApplication.ta.Pa.Wu&&!f.AFrameworkApplication.fa.ra("PrintDialogFallbackLinkEnabled");
return new a(v,A,B,y,x,r,C,G,function(I,U){return new l.a(I,!1,U,!0,E)},f.AFrameworkApplication.TLa)};a.Egf=function(r){return n.a.Xo||n.a.yf&&r.Nii||r.Ybf&&a.Xbf(r)?!0:!1};a.Xbf=function(r){var v=n.a.ysb;if(v){var A=v.split(".");if(2===A.length)return v=parseInt(A[0]),A=parseInt(A[1]),v>r.Nvd||v===r.Nvd&&A>=r.Fpf}return!1};Af.Object.defineProperties(a.prototype,{uC:{configurable:!0,enumerable:!0,get:function(){return this.kng}}});Object(u.a)(a,"DirectPrintManager",null,[607])},1538:function(u,D,
b){function a(n,z,r,v,A,B){z=void 0===z?!0:z;r=void 0===r?!1:r;v=void 0===v?null:v;A=void 0===A?null:A;B=void 0===B?!1:B;var y=w.call(this)||this;y.OX=null;y.Vl=null;y.yVa=null;y.zVa=null;var x=y.iVd?y.iVd:CommonUIStrings.l_DefaultDialogTitle;a.Ywb=B;y.MRb=v||new d.a(n,!0);y.MRb.Lre(y);var C=[],G=[];a.pu&&(y.nVc&&y.nVc.forEach(function(M){Array.add(C,M)}),y.Vne&&y.Vne.forEach(function(M){Array.add(G,M)}));z?r?y.ggf?(y.Rb=12,y.mc(1,y.buttonText),y.mc(2,CommonUIStrings.l_ShareLink),y.mc(3,CommonUIStrings.l_DialogClose)):
(y.Rb=4,y.mc(1,y.buttonText),y.mc(2,CommonUIStrings.l_DialogClose)):(y.Rb=6,y.mc(0,CommonUIStrings.l_DialogClose)):y.Rb=5;B=document.createElement("span");y.Y3c&&(B.className=y.Y3c);v=document.createElement("a");v.innerText=y.xjc;v.href=n;v.target="_blank";v.id=y.wjc;v.className=e.AFrame.Coe;var E=!f.a.LC&&!!A&&0<A.count;if(E){var I=m.a.Zed(n,A);A=m.a.ZHd(n,A);v.href="#";v.target="_self";y.Vl=document.createElement("form");y.Vl.id="printPreviewPostForm1";y.Vl.method="post";y.Vl.target="_blank";y.Vl.action=
A;A=ak(I);for(I=A.next();!I.done;I=A.next()){I=I.value;var U=document.createElement("input");U.type="hidden";U.name=I.key;U.value=I.value;y.Vl.appendChild(U)}}else y.Vl=null;y.Vl||a.Ywb?a.Ywb||(n={},Array.add(G,(n.type="AppLinkProps",n.id=y.wjc,n.text=y.xjc,n.onExecute=function(){y.XKf()},n))):(A={},I={},Array.add(G,(I.type="AppLinkProps",I.id=y.wjc,I.text=y.xjc,I.handler=(A.href=E?"#":n,A.target=E?"_self":"_blank",A),I)));y.MNa&&(Array.add(C,y.MNa),y.ggf&&Array.add(C,CommonUIStrings.l_AdditionalText));
r?(n=document.createElement("span"),n.innerText=y.MNa.replace("{0}",""),B.appendChild(n)):y.wpf?(n=document.createElement("span"),n.id=y.di("message"),E=document.createElement("span"),A=document.createElement("span"),I=y.MNa.split("{0}"),E.innerText=I[0],A.innerText=I[1],n.appendChild(E),n.appendChild(v),n.appendChild(A),B.appendChild(n)):(n=document.createElement("span"),n.innerText=y.MNa,B.appendChild(n),B.appendChild(document.createElement("br")),B.appendChild(document.createElement("br")),B.appendChild(v),
a.Ywb||Array.add(C,"{0}"));y.Vl&&B.appendChild(y.Vl);a.pu&&(y.J7a&&(y.jBb?y.Gke(y.J7a,y.jBb):(Array.add(C,"{0}"),n={},Array.add(G,(n.type="AppLinkProps",n.id="LearnMoreLinkId",n.text=y.J7a,n.onExecute=function(){y.qjc()},n)))),y.yra(C,G));y.uCb(x,null,y.s8e,null,Object(c.a)(y,y.Xv,"dialogHandler"),a.pu?null:B);y.YW(y.di("message"));!a.pu&&y.jBb&&y.J7a&&(x=document.createElement("div"),x.className="WACDialogLearnMoreLinkContainer",y.OX=document.createElement("a"),y.OX.innerText=y.J7a,y.OX.href=y.jBb,
y.OX.target="_blank",y.OX.id=y.di("LearnMoreLinkId"),y.OX.className=e.AFrame.Coe,x.appendChild(y.OX),z?y.Db.insertBefore(x,y.Db.lastChild):y.Db.appendChild(x),y.YW(String.format("{0} {1}",y.di("message"),y.di("LearnMoreLinkId"))));y.Ghb=v;r?y.lI(y.MB):y.lI(y.Ghb);y.blf();k.AFrameworkApplication.ta.hX.qa(l.a.click,y.Ghb,Object(c.a)(y,y.EIe,"downloadLinkClicked"),null);y.OX&&k.AFrameworkApplication.ta.hX.qa(l.a.click,y.OX,Object(c.a)(y,y.qjc,"learnMoreLinkClicked"),null);y.LRb=!1;return y}b.d(D,"a",
function(){return a});u=b(0);var c=b(83);D=b(135);var d=b(1271),e=b(274),k=b(4),l=b(13),m=b(81),f=b(25),w=D.StandardDialog;Rk(a,w);a.prototype.PWc=function(){this.Vl&&(this.yVa||(this.yVa=Object(c.a)(this,this.HFi,"onActionButtonClicked"),this.Cy.qa(l.a.click,this.MB,this.yVa)),this.zVa||(this.zVa=Object(c.a)(this,this.IFi,"onActionButtonKeyUp"),this.Yd.qa(l.a.Gd,this.MB,this.zVa)));w.prototype.PWc.call(this)};a.prototype.HFi=function(n){this.BQe(n);return!0};a.prototype.IFi=function(n){return this.hif(n,
Object(c.a)(this,this.BQe,"executeDismissActionButtonFromArgs"))};a.prototype.BQe=function(n){this.Vl&&this.Vl.submit();this.hua(n.zb)};a.prototype.gtd=function(){};a.prototype.EIe=function(){this.dlf();this.Vl?this.Vl.submit():this.MRb.g6c();return!0};a.prototype.qjc=function(){return!1};a.prototype.dispose=function(){this.MRb.dispose();this.Ghb&&(k.AFrameworkApplication.ta.hX.Aa(l.a.click,this.Ghb,Object(c.a)(this,this.EIe,"downloadLinkClicked")),this.Ghb=null);this.OX&&(k.AFrameworkApplication.ta.hX.Aa(l.a.click,
this.OX,Object(c.a)(this,this.qjc,"learnMoreLinkClicked")),this.OX=null);this.Cy&&this.yVa&&(this.Cy.Aa(l.a.click,this.MB,this.yVa),this.yVa=null);this.Yd&&this.zVa&&(this.Yd.Aa(l.a.Gd,this.MB,this.zVa),this.zVa=null);w.prototype.dispose.call(this)};a.prototype.XKf=function(){this.Vl&&(document.body.appendChild(this.Vl),this.Vl.submit(),document.body.removeChild(this.Vl))};a.prototype.Xv=function(n){1===n&&(this.gtd(),this.Vl?a.pu&&this.XKf():this.MRb.g6c());this.dispose()};Af.Object.defineProperties(a.prototype,
{s8e:{configurable:!0,enumerable:!0,get:function(){return null}},iVd:{configurable:!0,enumerable:!0,get:function(){return null}},MNa:{configurable:!0,enumerable:!0,get:function(){return null}},jBb:{configurable:!0,enumerable:!0,get:function(){return null}},J7a:{configurable:!0,enumerable:!0,get:function(){return null}},wpf:{configurable:!0,enumerable:!0,get:function(){return!1}},buttonText:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_Open}},Y3c:{configurable:!0,enumerable:!0,
get:function(){return null}},nVc:{configurable:!0,enumerable:!0,get:function(){return null}},Vne:{configurable:!0,enumerable:!0,get:function(){return null}},ggf:{configurable:!0,enumerable:!0,get:function(){return!1}}});Af.Object.defineProperties(a,{pu:{configurable:!0,enumerable:!0,get:function(){return k.AFrameworkApplication.ta.Pa.Wu&&k.AFrameworkApplication.ta.Pa.lff}},Ywb:{configurable:!0,enumerable:!0,get:function(){return a.Q6d},set:function(n){a.Q6d=n}}});a.Q6d=!1;Object(u.a)(a,"ADialogWithLinkToResource",
D.StandardDialog,[])},1539:function(u,D,b){function a(l,m,f,w,n,z){var r=k.call(this,l,m,f,w,n,z)||this;l={};m=(l.errorMessage=r.wLe,l.offerString=r.nsf,l);l=new e.a(!1,!1,!0);r.Q2f?(l.Rb=1,f={},m.helpLink=(f.type="AppLinkProps",f.id="helpLink",f.text=r.Hva,f.onExecute=function(){d.Redirect.showHelp(r.S6e)},f)):(l.Rb=4,l.mc(2,r.l8e));l.mc(1,r.JXb);l.ze=r.id;f={};m=(f.id=r.id,f.dialogIcon=r.icon,f.bodyControls=m,f);l.initializeAndShow(r.Al,Object(c.a)(r,r.c5i,"reactOICErrorDialogWithTrialHandler"),
m);return r}b.r(D);b.d(D,"ReactOICErrorDialogWithTrial",function(){return a});u=b(0);var c=b(83);D=b(1273);var d=b(442),e=b(150),k=D.a;Rk(a,k);Object(u.a)(a,"ReactOICErrorDialogWithTrial",D.a,[])},1540:function(u,D,b){function a(k,l,m,f,w,n){k=e.call(this,k,l,m,f,w,n)||this;l=document.createElement("span");l.innerText=k.wLe;l.appendChild(document.createElement("br"));l.appendChild(document.createElement("br"));m=document.createElement("span");m.innerText=k.nsf;l.appendChild(m);m=new d.StandardDialog;
k.Q2f?(m.Rb=1,m.Pke(k.Hva,k.S6e)):(m.Rb=4,m.mc(2,k.l8e));m.mc(1,k.JXb);m.ze=k.id;m.nl(k.Al,null,k.icon,Object(c.a)(k,k.Nri,"legacyOICErrorDialogWithTrialHandler"),l);return k}b.r(D);b.d(D,"OICErrorDialogWithTrial",function(){return a});u=b(0);var c=b(83);D=b(1273);var d=b(135),e=D.a;Rk(a,e);Object(u.a)(a,"OICErrorDialogWithTrial",D.a,[])},1541:function(u,D,b){function a(){return c.call(this)||this}b.r(D);b.d(D,"CheckRoamingRightsRequest",function(){return a});u=b(0);b=b(1274);var c=b.a;Rk(a,c);a.prototype.Fvb=
function(){return 2};a.prototype.Caa=function(){return 1};Object(u.a)(a,"CheckRoamingRightsRequest",b.a,[])},1542:function(u,D,b){function a(){return c.call(this)||this}b.r(D);b.d(D,"GetRoamingLauncherRequest",function(){return a});u=b(0);b=b(1274);var c=b.a;Rk(a,c);a.prototype.Fvb=function(){return 0};a.prototype.Caa=function(){return 2};Object(u.a)(a,"GetRoamingLauncherRequest",b.a,[])},1543:function(u,D,b){function a(n,z,r,v,A){r=void 0===r?null:r;v=void 0===v?!0:v;A=void 0===A?!1:A;z=w.call(this,
n,!0,!(a.yTa&&v),new e.a(n,z),r,A)||this;a.yTa=a.yTa&&v;if(a.yTa){v=document.createElement("iframe");A=null;var B=z.Neh;v.name="pdfObjectFrame";v.id="pdfObjectIFrame";if(r&&0<r.count){var y=m.a.Zed(n,r);n=m.a.ZHd(n,r);A=document.createElement("form");A.id="printPreviewPostForm";A.method="POST";A.target=v.name;A.action=n;n=ak(y);for(r=n.next();!r.done;r=n.next())r=r.value,y=document.createElement("input"),y.type="hidden",y.name=r.key,y.value=r.value,A.appendChild(y)}else v.src=n;B.appendChild(v);A&&
(B.appendChild(A),A.submit());Sys.UI.DomElement.addCssClass(v,"DirectPrintPdfObjectHidden");l.a.kh(v,l.a.bC,l.a.Xj)}return z}b.d(D,"a",function(){return a});u=b(0);var c=b(15),d=b(1538),e=b(1271),k=b(4),l=b(89),m=b(81),f=b(25),w=d.a;Rk(a,w);a.prototype.blf=function(){c.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")};a.prototype.dlf=function(){k.AFrameworkApplication.Jm.zxb(9540);c.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")};a.prototype.gtd=function(){c.ULS.sendTraceTag(19462215,
324,50,"Legacy print dialog button clicked")};Af.Object.defineProperties(a.prototype,{s8e:{configurable:!0,enumerable:!0,get:function(){return"Print_32x32x32"}},iVd:{configurable:!0,enumerable:!0,get:function(){return a.yTa?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}},MNa:{configurable:!0,enumerable:!0,get:function(){return a.yTa?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}},nVc:{configurable:!0,enumerable:!0,get:function(){var n=[];Array.add(n,CommonUIStrings.l_PrintDialogCanCloseDocument);
if(d.a.Ywb){var z=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==k.AFrameworkApplication.ta.Pa.$Ee&&(z=k.AFrameworkApplication.ta.Pa.$Ee);Array.add(n,z)}return a.yTa?n:null}},xjc:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}},wjc:{configurable:!0,enumerable:!0,get:function(){return"PrintPDFLink"}},buttonText:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_PrintDialogOpenPDF}},Y3c:{configurable:!0,enumerable:!0,
get:function(){return k.AFrameworkApplication.SGe?"UIFontDialogTextLarge":null}}});Af.Object.defineProperties(a,{yTa:{configurable:!0,enumerable:!0,get:function(){return!!k.AFrameworkApplication.ta&&k.AFrameworkApplication.ta.Pa.Wu&&k.AFrameworkApplication.fa.ra("DirectPrintDialogAsStandardDialogIsEnabled")&&!(f.a.LC||f.a.yf||f.a.xf||f.a.rMa)&&!k.AFrameworkApplication.isUnifiedHostMode&&k.AFrameworkApplication.fa.ra("ShouldHostDefaultToNativeBrowserPrintExperience")},set:function(){}}});Object(u.a)(a,
"PrintDialogWithLinkToPdf",d.a,[])},1560:function(u,D,b){function a(f){this.OFc=!1;this.WWa=a.Aec;this.zPc=this.BNc=0;this.platform=null;this.Yug=f;this.die=this.APc=!1}function c(){this.state=this.callback=null;this.wnd=!1}function d(){this.classId=0}u=b(0);var e=b(83),k=b(41);d.aIa=function(f){try{return k.a(f)}catch(w){}return null};Object(u.a)(d,"ARoamingAppsResponse",null,[]);Object(u.a)(c,"GetRoamingAppsLauncherContext",null,[]);var l=b(4),m=b(108);b.d(D,"a",function(){return a});a.prototype.aXg=
function(){l.AFrameworkApplication.Ugc&&this.roamingAppsAreEnabled&&!this.APc&&!this.OFc&&(this.zPc=1,this.OFc=!0,this.Zfj(),this.yQe())};a.prototype.Zfj=function(){this.WWa=a.Aec;this.BNc=0};a.prototype.getRoamingAppsLauncher=function(f,w,n){this.AUj?(f=new c,f.callback=w,f.state=n,f.wnd=!0,this.DQe(f)):w(!1,"",n)};a.prototype.yQe=function(){var f=new (b(1541).CheckRoamingRightsRequest);f.RoamingApp=this.zPc;f.BaseDocQuerySignature=l.AFrameworkApplication.aj;f.execute(Object(e.a)(this,this.cXg,"checkUserRoamingRightsSucceeded"),
Object(e.a)(this,this.bXg,"checkUserRoamingRightsFailed"),null)};a.prototype.cXg=function(f){l.AFrameworkApplication.Bg||((f=d.aIa(f.data.Ud))?this.QOd(f.HasRights):this.QOd(!1))};a.prototype.bXg=function(){if(!l.AFrameworkApplication.Bg)if(this.BNc>=a.hzi)this.QOd(!1);else{var f=new m.a(2,1,this.WWa,Object(e.a)(this,this.retryCheckUserRoamingRights,"retryCheckUserRoamingRights"),59);l.AFrameworkApplication.Bi.Eg(f);this.BNc++;this.WWa*=a.thj;this.WWa>a.Pof&&(this.WWa=a.Pof)}};a.prototype.QOd=function(f){this.die=
f;this.APc=!0;this.OFc=!1};a.prototype.retryCheckUserRoamingRights=function(){this.yQe()};a.prototype.DQe=function(f){var w=new (b(1542).GetRoamingLauncherRequest);w.RoamingApp=this.zPc;w.BaseDocQuerySignature=l.AFrameworkApplication.aj;w.execute(Object(e.a)(this,this.$Vh,"getRoamingAppsLauncherSucceeded"),Object(e.a)(this,this.ZVh,"getRoamingAppsLauncherFailed"),f)};a.prototype.$Vh=function(f){if(!l.AFrameworkApplication.Bg){var w=d.aIa(f.data.Ud);f=f.data.state;w?(this.platform=w.Platform,f.callback(!0,
w.Launcher,f.state)):f.callback(!1,"",f.state)}};a.prototype.ZVh=function(f){if(!l.AFrameworkApplication.Bg){var w=f.data.state;5===f.data.status&&w.wnd?(w.wnd=!1,this.DQe(w)):w.callback(!1,"",w.state)}};Af.Object.defineProperties(a.prototype,{roamingAppsAreEnabled:{configurable:!0,enumerable:!0,get:function(){return this.Yug}},AUj:{configurable:!0,enumerable:!0,get:function(){return this.roamingAppsAreEnabled&&this.APc?this.die:!1}}});Af.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,
get:function(){return a.XB||(a.XB=new a(l.AFrameworkApplication.ZKg))}}});a.Aec=1E3;a.thj=5;a.Pof=12E5;a.hzi=5;a.XB=null;Object(u.a)(a,"RoamingAppsManager",null,[])},1634:function(u,D,b){function a(Mb){var cc=Xe.call(this)||this;cc.$=Mb;cc.Eb();return cc}function c(Mb){this.stopwatch=this.g_b=this.vzc=this.zUd=null;this.X7f=0;this.$=Mb;(this.pWc=Qd.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC"))||Mb.da.Ga(322,this)}function d(Mb){this.jhe=0;this.Y7f=Mb}function e(Mb,cc,Uc,Rb,qc,Oc,jb){this.title=
Mb;this.body=cc;this.t0i=Uc;this.primaryButtonAction=Rb;this.secondaryButtonAction=Oc;this.fWf=qc;this.targetObject=jb}function k(Mb){var cc=yc.call(this)||this;cc.$=Mb;cc.Eb();return cc}function l(Mb){this.$=Mb;Mb.da.Ga(309,this)}function m(Mb){var cc=hb.call(this,Mb)||this;cc.Mo=null;cc.stopwatch=null;cc.eCi=function(Uc){if(1===Uc)cc.$.Ka.Kb(new pe.a(-2050946363,lf.a.Cb,2,8,null)).continueWith(function(qc){cc.Mo.setResult(!he.a(qc)&&qc.result)}),Uc="Yes";else{var Rb=2===Uc;cc.Mo.setResult(Rb);Uc=
2===Uc?"No":"Close";Rb&&cc.i0i()}cc.jvi(Uc);cc.hide()};return cc}function f(){}function w(Mb){return Me.call(this,Mb)||this}function n(Mb){this.pi=Mb}function z(Mb){return Nd.call(this,Mb)||this}function r(Mb,cc,Uc){var Rb=kd.call(this)||this;Rb.rve=!1;Rb.qve=!1;Rb.QGi=function(){Rb.rve=!0;Rb.v2f()};Rb.$=Mb;Rb.Va=cc;Rb.RJ=Uc;le.a(Rb.$).YGd(new oc.a(Ic.a.vbg,Ic.a.idle,r.PVg),new bd.a(Ic.a.Nye,Ic.a.x_,null,Ic.a.IO,Ic.a.idle));return Rb}function v(Mb){var cc=Ec.call(this,Mb,Pd.a.instance.ga(1252))||
this;cc.textBox=null;cc.MQa=null;cc.kTa=null;cc.nDf=function(){var Uc=cc.$;cc.Mt();var Rb=new A(Uc,1255,1256,1257,function(qc,Oc,jb){var Eb=Uc.oa.xa.Pb(),nc=Uc.oa.xa;Eb=nc.Na(1,Eb);return rc.g(nc,"UnshareForm",Eb,qc,Oc,jb,null,0)},16);Rb.initialize();Rb.hf()};return cc}function A(Mb,cc,Uc,Rb,qc,Oc){Oc=void 0===Oc?0:Oc;Mb=Yb.call(this,Mb,Pd.a.instance.ga(cc),!1)||this;Mb.message=Uc;Mb.zFi=Rb;Mb.KZd=qc;Mb.operationFlags=Oc;return Mb}function B(Mb,cc,Uc){var Rb=G.call(this,Mb,new Sys.UI.Point(B.Gch,
B.ich),Pd.a.instance.ga(cc?1250:1249))||this;Rb.y0a=null;Rb.LKc=!1;Rb.voc=function(qc){function Oc($c,od,de){return cb.m(jb.oa.xa,Lb.b($c,Rb.ARi),od,de,Eb)}var jb=Rb.$,Eb=new y;Eb.nH=qc.Values[x.nH];var nc=!1;switch(qc.MessageId){case x.l0f:Rb.Mt();nc=!0;Eb.tDd=1334518759;break;case x.view:Rb.hBa=Pd.a.instance.ga(1250);Rb.sdg(!0);break;case x.Fye:Rb.Mt(),nc=!0}Qd.EwaSettings.Zb()?(qc=new Dc.a(140,0,Oc),qc.flags=nc?16:80):(qc=nc?new Dc.a(140,0,Oc):new Qb.a(140,0,Oc),qc.flags=16);jb.userOperationManager.Sb(qc,
Rb.Ed)};Rb.zJi=function(){var qc=Rb.$;qc.ya.SurveyRedirectUrl?(Rb.Mt(),qc.Fd(1305810481,0,8,null)):(Rb.hBa=Pd.a.instance.ga(1249),Rb.sdg(!1))};Rb.ORi=function(){var qc=Rb.$;Rb.Mt();qc.Fd(1334518759,0,8,null)};Rb.Cmc=function(qc){var Oc=Rb.$;Rb.Mt();qc.MessageId===x.Pye&&Oc.ea.Sad()};Rb.hQi=function(){Rb.LKc=!0;Rb.raiseEvent(B.usd)};Rb.ARi=function(qc,Oc){if(!kc.a(qc)){qc=Rb.$;if(Oc.nH){var jb=qc.ea.va;if(jb.contains(Oc.nH.SheetName))Rb.knc(Oc);else{var Eb=null;Eb=function(){jb.Jma(Eb);Rb.knc(Oc)};
jb.Iga(Eb)}}1461300262!==Oc.tDd&&qc.Fd(Oc.tDd,0,8,null)}};Rb.U8d=cc;Rb.Ed=Uc;return Rb}function y(){this.nH=null;this.tDd=1461300262}function x(){}function C(Mb){Mb=G.call(this,Mb,new Sys.UI.Point(960,680),Pd.a.instance.ga(1245))||this;Mb.name=Wd.a.$Je;return Mb}function G(Mb,cc,Uc,Rb){var qc=Sd.call(this,Mb,Uc,2,void 0===Rb?null:Rb)||this;qc.xJc=null;qc.onResize=function(){var Oc=qc.SPh();qc.bLa.setAttribute("width",Oc.x.toString());qc.bLa.setAttribute("height",Oc.y.toString());qc.TQj(Oc);qc.Lzd()};
qc.Tkh=function(){var Oc=qc.wx.parentNode.style,jb=Oc.top;Oc.top="2px";Oc.top=jb};qc.aGe=cc;qc.$.xA(qc.onResize);qc.Adc();return qc}function E(Mb){return se.call(this,Mb)||this}function I(Mb){this.$=Mb}function U(Mb,cc,Uc,Rb,qc,Oc,jb,Eb){Eb=Mb.Na(9,void 0===Eb?null:Eb);Eb.sheetName=cc;Eb.directionRtl=Uc;return rc.g(Mb,"ChangeSheetDirection",Eb,Rb,qc,Oc,jb,0)}function M(Mb,cc,Uc,Rb,qc,Oc,jb,Eb){Eb=Mb.Na(9,void 0===Eb?null:Eb);Eb.sheetName=cc;Eb.show=Uc;return rc.g(Mb,"ShowHeadings",Eb,Rb,qc,Oc,jb,
0)}function T(Mb,cc,Uc,Rb,qc,Oc,jb,Eb){Eb=Mb.Na(9,void 0===Eb?null:Eb);Eb.sheetName=cc;Eb.show=Uc;return rc.g(Mb,"ShowGridlines",Eb,Rb,qc,Oc,jb,0)}function F(Mb,cc){this.sheetName=null;this.value=!1;this.sheetName=Mb;this.value=cc}function K(Mb){return ub.call(this,Mb)||this}function J(Mb,cc){this.pi=cc;this.$=Mb}function O(Mb){var cc=Kc.call(this)||this;cc.$=Mb;cc.Eb();return cc}function N(Mb){return Mc.call(this,Mb)||this}function H(Mb){this.ho="Excel";this.$=Mb;this.VU=Sa.a.current}function Q(Mb,
cc,Uc,Rb,qc,Oc,jb){jb=Mb.Na(9,void 0===jb?null:jb);jb.sheetName=cc;jb.confirmationChoice=!0;return rc.g(Mb,"DeleteSheet",jb,Uc,Rb,qc,Oc,0)}function ca(){}function X(Mb){var cc=wb.call(this)||this;cc.s_d=null;cc.u_d=0;cc.rQb=null;cc._state=0;cc.moveNext=function(){try{for(cc._state=1;1===cc._state;)cc.AWa=cc.AWa()}catch(Uc){cc.dispose(),cc.rAa(Uc),cc._state=3}};cc.ut=Mb;cc.AWa=cc.lDc;cc.moveNext();return cc}function Z(){}function ea(Mb){return Pb.call(this,Mb)||this}function ka(Mb){this.pi=Mb}function Y(){}
function qa(){}function fa(Mb,cc,Uc,Rb){this.bib=Mb;this.zqa=cc;this.I1=Uc;this.Vog=Rb}function ha(Mb,cc,Uc,Rb,qc,Oc,jb){var Eb=this;this.Co=null;this.bfe=!1;this.Rpa=this.W1d=0;this.Esg=Mb;this.zWa=cc;this.lUb=Uc;this.bib=Rb;this.zqa=qc;this.I1=Oc;this.rDa=new Ka.a(function(){return new ra.a(jb.value,Object(Ea.a)(Eb,Eb.qvb,"getMoreInfoEventReceived"))})}function ia(Mb,cc,Uc,Rb,qc,Oc,jb,Eb){var nc=this;this.wFc=null;this.wSc=!0;this.CQb="";this.Cxg=0;this.iWa=null;this.OLc=3;this.ib=Eb;this.I1=Mb;
this.$i=cc;this.fog=Uc;this.klg=Rb;this.jlg=qc;this.rDa=new Ka.a(function(){return new ra.a(Oc.value,null)});this.Wog=new Ka.a(function(){return new ra.a(jb.value,Object(Ea.a)(nc,nc.EBi,"mruEventResultReceived"))});this.ib.ra("WacInTabOpenMRUIsEnabledForUiHost");this.ib.ra("UiHostSupportsDocRebootFeatures")}function wa(){return gb.call(this)||this}function Qa(Mb,cc,Uc,Rb,qc,Oc){var jb=this;this.zRc=this.Co=this.DQb=null;this.wWb=this.LQc=!1;this.nae=0;this.zQc=this.UKc=!1;this.I1=Mb;this.bib=cc;this.rDa=
new Ka.a(function(){return new ra.a(Uc.value,Object(Ea.a)(jb,jb.qvb,"getMoreInfoEventReceived"))});this.xsg=Rb;this.zqa=qc;this.Tvg=Oc;this.plb=this.dxc;2===this.rK.gca&&(this.zQc=!0)}function S(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}function da(){}function xa(){}b.r(D);var ta=b(1257),ab=b(0),Na=b(257);xa.prototype.Sh=function(){};xa.prototype.init=function(){};xa.prototype.dispose=function(){};xa.main=function(){Na.a.instance.Ui(new xa)};Af.Object.defineProperties(xa.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.DialogWithLinkToResource"}}});Object(ab.a)(xa,"CommonAppDialogWithLinkToResourcePackage",null,[3,4]);var Ka=b(615),la=b(15),Ea=b(83),ra=b(1019),na=b(30),ba=b(132);da.kkh=function(Mb){return da.hue("New",Mb)};da.lkh=function(Mb){return da.hue("Open",Mb)};da.Ste=function(Mb,cc){return da.oha("LoadingMenuSection",da.iti,Mb,da.Tob("lblLoading",cc))};da.Uob=function(Mb,cc,Uc,Rb){return da.oha("MessageMenuSection",da.fqf,cc,da.Tob("lblMessage",
Mb,void 0===Uc?null:Uc,void 0===Rb?null:Rb))};da.NQg=function(Mb){return da.Ste(Mb,CommonUIStrings.l_VoicedLoadingText)};da.OQg=function(Mb,cc){return da.Uob(CommonUIStrings.l_NewCreationLocationMessage,Mb.ni,cc.wR,cc.Sna)};da.MQg=function(Mb,cc){return da.Uob(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,cc.Sna,"\n\n"),Mb.ni)};da.Ute=function(Mb){return da.Uob(CommonUIStrings.l_NewGenericErrorMessage,Mb.ni)};da.KQg=function(Mb,cc,Uc){return da.oha("menuNewBlank",da.o5h,Uc?Mb.ni:null,
da.Oob(Mb.D6e,Mb.E6e,Mb.F6e,null,Mb.Tja,Mb.mxb,cc,"blank"))};da.JRg=function(){return da.Tob("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)};da.eue=function(){return da.Tob("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)};da.KRg=function(Mb,cc){return da.oha("menuNewTemplates",Mb,null,cc)};da.IQg=function(Mb,cc){return da.oha("menuNewMoreTemplates",da.RTe,null,da.Oob("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,
null,null,Mb,cc))};da.MPg=function(Mb,cc,Uc){var Rb="";Uc&&cc&&(Rb=da.oha("BrowseMoreMenuSection",da.RTe,null,da.Oob("btnBrowseMore",cc,cc,null,null,null,Mb||"1959943459",Uc)));return Rb};da.Tob=function(Mb,cc,Uc,Rb){Uc=void 0===Uc?null:Uc;var qc=Rb=void 0===Rb?null:Rb;cc&&0<cc.length&&(qc=da.$qf.zpc(cc).trimEnd(),qc=0<=qc.indexOf("{0}")?String.format(qc,Rb):String.format("{0} {1}",qc,Rb));Uc=Uc&&Rb?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',
na.a.af(Uc),na.a.af(Rb),na.a.af(qc)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',na.a.af(Mb||""),da.$qf.zpc(na.a.af(cc||"")),Uc)};da.Oob=function(Mb,cc,Uc,Rb,qc,Oc,jb,Eb){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',na.a.af(Mb||""),
na.a.af(cc||""),na.a.af(Uc||""),Rb||"32by32",na.a.af(qc||""),na.a.af(Oc||""),jb,na.a.af(Eb||""))};da.hue=function(Mb,cc){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',Mb,cc)};da.oha=function(Mb,cc,Uc,Rb){Uc=Uc?String.format('Title="{0}"',na.a.af(Uc)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',
na.a.af(Mb||""),na.a.af(cc||""),Uc,Rb)};da.fqf="MenuMru";da.iti="MenuLoading";da.o5h="MenuHeader";da.RTe="MenuFooter";da.$qf=ba.a.Ax("\n","&#10;");Object(ab.a)(da,"NewAndOpenXmlUtilities",null,[]);var sa=b(4),ya=b(99),va=b(167);Object(ab.a)(S,"HostInformation",null,[]);var W=b(108),La=b(39),Ia=b(392),mb=b(170),fb=b(740),Ma=b(640),Hb=b(107),Kb=b(27);Qa.prototype.Cg=function(){var Mb=this.rK.I8a;Mb.Mb(Kb.a.newDocument,Hb.a.frame,Object(Ea.a)(this,this.newDocument,"newDocument"));Mb.Ie(Kb.a.Rpc,Hb.a.frame,
Object(Ea.a)(this,this.Rpc,"populateNewMenu"),96)};Qa.prototype.newDocument=function(Mb,cc,Uc,Rb,qc){return 1===Uc?32:2===Uc&&qc&&qc.MenuItemId&&qc.SourceControlId?this.q0a(qc.MenuItemId,qc.SourceControlId):8};Qa.prototype.q0a=function(Mb,cc){var Uc=this.Elc.s3c;if(null===Uc)return 8;var Rb=sa.AFrameworkApplication.fa.ra("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(sa.AFrameworkApplication.Gka&&Rb){la.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");
var qc={};qc[Ia.a.l8f]=Mb;qc[Ia.a.tP]=this.tP;qc[Ia.a.lcid]=sa.AFrameworkApplication.lcid.toString();qc[Ia.a.reason]=fb.a.createNew;sa.AFrameworkApplication.eV().execute(function(Oc){Oc.xj(mb.a.q0a,qc)})}else Rb=(new Date).getTime(),cc=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",Uc,na.a.$e(this.tla),na.a.$e(Mb),na.a.$e(this.tP),na.a.$e(sa.AFrameworkApplication.lcid.toString()),na.a.$e(Rb.toString()),na.a.$e(cc),na.a.$e(sa.AFrameworkApplication.canary),
sa.AFrameworkApplication.aj),(Uc=sa.AFrameworkApplication.fa.Wa("ScenarioId"))&&""!==Uc&&(cc+="&wdscenarioid="+na.a.$e(Uc)),cc+="&"+sa.AFrameworkApplication.Qbc(),sa.AFrameworkApplication.Fwa&&(cc+="&"+sa.AFrameworkApplication.gbc()),(Uc=this.Co?this.Co.wR:null)&&(cc+="&DestinationUrl="+na.a.$e(Uc)),La.a.Ze(cc,"_blank",void 0,"CreateNewDocument");2===this.rK.gca&&(cc={},la.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",(cc.AppType=Ma.a[this.rK.gca],cc.Template=Mb,cc)));return 32};
Qa.prototype.pwi=function(Mb){var cc=Number.MAX_VALUE,Uc=Number.MIN_VALUE,Rb=window.performance;if(Rb&&"undefined"!==typeof Rb.getEntriesByName){for(var qc=0;qc<Mb.length;qc++){var Oc=Rb.getEntriesByName(Mb[qc]);Oc&&0<Oc.length&&(Oc=Oc[0],cc=Math.min(parseInt(String(Oc.fetchStart)),cc),Uc=Math.max(parseInt(String(Oc.responseEnd)),Uc))}Uc>cc&&(Mb={},la.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",(Mb.TotalElapsedMs=Uc-cc,Mb.MinFetchStart=cc,Mb.MaxResponseEnd=Uc,
Mb)))}};Qa.prototype.Rpc=function(Mb,cc,Uc,Rb,qc){if(1===Uc)return this.zQc&&(sa.AFrameworkApplication.cN("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.zQc=!1),32;2!==Uc||this.UKc||(this.nae=(new Date).getTime(),Mb={},la.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",(Mb.ShouldShowTemplates=this.dxc,Mb.CachedNewMenuXmlExists=!!this.DQb,Mb.ShouldCallGetMoreInfo=this.rK.supportsGetMoreInfoForPersonalStorage,Mb)));return this.iZi(qc)};Qa.prototype.iZi=
function(Mb){Mb&&(this.DQb?Mb.PopulationXML=this.DQb:(this.rK.supportsGetMoreInfoForPersonalStorage&&!this.Co&&this.YCi.yZ("Opened New menu",!0),Mb.PopulationXML=this.KGh(this.getTemplateListJson())));return 32};Qa.prototype.rff=function(){return!this.rK.supportsGetMoreInfoForPersonalStorage||!!this.Co&&3===this.Co.state&&!!this.Co.Sna&&!!this.Co.wR};Qa.prototype.fli=function(){return sa.AFrameworkApplication.ta&&sa.AFrameworkApplication.ta.Pa.a_?!0:this.rff()};Qa.prototype.getTemplateListJson=function(){var Mb=
this;if(!this.dxc||!this.fli())return null;if(this.plb&&!this.wWb){var cc="9",Uc=sa.AFrameworkApplication.fa.appSettings;"NumberOfTemplatesInBackstage"in Uc&&(cc=Uc.NumberOfTemplatesInBackstage);var Rb=this.tP;"TemplateCollectionId"in Uc&&(Rb=Uc.TemplateCollectionId);cc=String.format(this.rK.QV+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",na.a.$e(sa.AFrameworkApplication.lcid.toString()),na.a.$e(Rb),cc);Boolean.parse(Uc.AppendOriginQueryParam||"false")&&(cc+="&org=backstage");cc+="&"+sa.AFrameworkApplication.Qbc();
sa.AFrameworkApplication.Fwa&&(cc+="&"+sa.AFrameworkApplication.gbc());this.rK.WCb.Yl(cc,1,null,null,!1,2,function(qc){Mb.rK.Xba("CreateNewActor.GetTemplateListJson",qc.data);Mb.aIj(qc.data.Ud)},function(qc){Mb.rK.Xba("CreateNewActor.GetTemplateListJson",qc.data);Mb.$Hj()},null,void 0,void 0,void 0,void 0,"5");this.plb=!1}return this.zRc};Qa.prototype.aIj=function(Mb){this.zRc=Mb;this.plb=!1;this.eHb();if(sa.AFrameworkApplication.ta&&sa.AFrameworkApplication.ta.Pa.a_&&va.c()){Mb=sa.AFrameworkApplication.fa.ra("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");
var cc=sa.AFrameworkApplication.Gka;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.zRc,!0,Mb&&cc))}};Qa.prototype.$Hj=function(){this.wWb=this.plb=!0;this.eHb();sa.AFrameworkApplication.ta&&sa.AFrameworkApplication.ta.Pa.a_&&va.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1));ya.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)};Qa.prototype.SYh=function(Mb){for(var cc=0,Uc=0;Uc<Mb.length;Uc++)if("ST"===
Mb[Uc].ImageType){cc=Uc;break}var Rb=Mb.length?Mb[cc]:null;Mb=Rb?Rb.Url||"":"";var qc,Oc=Uc=cc=!1;if(Rb&&(qc=Rb.AspectRatio))qc=parseFloat(qc),1>qc?cc=!0:1.5<qc?Uc=!0:1===qc&&(Oc=!0);else switch(qc={},la.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",(qc.Url=Mb,qc)),this.rK.gca){case 3:cc=!0;break;case 2:Uc=!0;break;case 5:Oc=!0}return{returnValue:Mb,V7h:cc?"95by123":Uc?"123by69":Oc?"100by100":"123by95"}};Qa.prototype.KGh=function(Mb){var cc=this.LQg(Mb,this.Elc,this.Elc.tGa||
"1056925771");Mb=cc.returnValue;if(cc.Ewc){this.DQb=Mb;cc=(new Date).getTime()-this.nae;var Uc={};la.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",(Uc.ElapsedMsSinceMenuOpened=cc,Uc))}return Mb};Qa.prototype.qvb=function(Mb,cc){la.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.Co||3!==Mb.state?2===Mb.state&&(la.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.LQc=!0,this.eHb()):(this.Co=Mb,cc||this.eHb(),
sa.AFrameworkApplication.ta&&sa.AFrameworkApplication.ta.Pa.a_&&va.c()&&va.d("setFileMenuHostInformation")&&(Mb=Object.assign(new S,{hostUrl:this.Co.wR,hostName:this.Co.Sna,folderUrl:sa.AFrameworkApplication.breadcrumbFolderUrl,folderName:sa.AFrameworkApplication.breadcrumbFolderName}),la.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(Mb))))};Qa.prototype.LQg=function(Mb,cc,Uc){var Rb=!1;var qc=this.rff(),
Oc="";if(this.rK.supportsGetMoreInfoForPersonalStorage)if(this.LQc)Oc=da.Ute(cc),this.LQc=!1,la.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure");else if(this.Co)if(qc)Oc=da.OQg(cc,this.Co);else if(this.Co.ici)Rb=!0,this.plb=!1,Oc=da.MQg(cc,this.Co),la.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message");else{Rb=!0;Oc=da.Ute(cc);var jb={};la.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",
(jb.PersonalFileStorageUrlIsSet=!!this.Co.wR,jb.StorageServiceDisplayNameIsSet=!!this.Co.Sna,jb))}else Oc=da.NQg(cc.ni),la.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner");qc&&(qc=Oc,cc=da.KQg(cc,Uc,!Oc),Mb=this.IRg(Mb,Uc),Rb=Mb.Ewc,Oc=qc+(cc+Mb.returnValue));return{returnValue:da.kkh(Oc),Ewc:Rb}};Qa.prototype.IRg=function(Mb,cc){var Uc=!1;if(!this.dxc)return Uc=!0,la.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",
Ewc:Uc};var Rb="",qc="",Oc="MenuTemplate";if(this.wWb)Rb=da.eue(),this.wWb=!1,la.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(Mb){try{var jb=Sys.Serialization.JavaScriptSerializer.deserialize(Mb,!0);Rb=this.HRg(jb,cc);la.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");sa.AFrameworkApplication.arf&&"OneDrive"===this.tla&&(qc=da.IQg(this.ZCi,sa.AFrameworkApplication.arf))}catch(Eb){cc={},la.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",
(cc.JsonToConvert=Mb,cc)),Rb=da.eue()}Uc=!0}else Oc="MenuLoading",Rb=da.JRg(),la.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:da.KRg(Oc,Rb)+qc,Ewc:Uc}};Qa.prototype.HRg=function(Mb,cc){for(var Uc=this,Rb="",qc=[],Oc=0;Oc<Mb.length;Oc++){var jb=Mb[Oc],Eb="";if(jb){var nc=jb.Title,$c=jb.AssetId,od=jb.Thumbnails;$c&&nc&&od&&(jb=void 0,Eb=this.SYh(od),jb=Eb.V7h,Eb=Eb.returnValue,Rb+=da.Oob("jbtnNewTemplate"+Oc,nc,null,jb,null,Eb,cc,$c))}qc[Oc]=
Eb}Mb=new W.a(4,1,5E3,function(){Uc.pwi(qc)},106);this.rK.Clc.Eg(Mb);return Rb};Qa.prototype.eHb=function(){this.UKc=!0;this.rK.Tqf.Qw(this.Elc.Qtb);this.UKc=!1};Af.Object.defineProperties(Qa.prototype,{tP:{configurable:!0,enumerable:!0,get:function(){switch(this.rK.gca){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}},rK:{configurable:!0,enumerable:!0,get:function(){return this.I1.value}},Elc:{configurable:!0,enumerable:!0,get:function(){return this.bib.value}},
YCi:{configurable:!0,enumerable:!0,get:function(){return this.rDa.value}},ZCi:{configurable:!0,enumerable:!0,get:function(){return this.xsg.value}},tla:{configurable:!0,enumerable:!0,get:function(){return this.zqa.value}},dxc:{configurable:!0,enumerable:!0,get:function(){return this.Tvg.value}}});Object(ab.a)(Qa,"CreateNewActor",null,[]);var Ub=b(1537),gb=Ub.a;Rk(wa,gb);wa.prototype.Dle=function(){this.wT(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.wT(1,CommonUIStrings.l_OpenMenuServerErrorMessage);
this.wT(2,CommonUIStrings.l_Open);this.wT(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.wT(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.wT(5,CommonUIStrings.l_VoicedLoadingText)};wa.YUi=function(Mb){return wa.instance.ga(Mb)};Af.Object.defineProperties(wa,{instance:{configurable:!0,enumerable:!0,get:function(){return wa.Ma||(wa.Ma=new wa)}}});wa.Ma=null;Object(ab.a)(wa,"MruActorIntlHelper",Ub.a,[]);var Db;(function(Mb){Mb[Mb.success=0]="success";Mb[Mb.failure=1]="failure";Mb[Mb.spinner=2]="spinner";
Mb[Mb.none=3]="none"})(Db||(Db={}));Object(ab.b)("DisplayState",Db);var Va=b(41);ia.prototype.EBi=function(Mb,cc){this.iWa=Mb;cc||this.TMf()};ia.prototype.N8i=function(){this.vw.I8a.Ie(Kb.a.Qpc,Hb.a.frame,Object(Ea.a)(this,this.Qpc,"populateMruMenu"),96)};ia.prototype.Qpc=function(Mb,cc,Uc,Rb,qc){return 1!==Uc&&qc?this.fZi(qc):32};ia.prototype.fZi=function(Mb){this.Qkh();this.Pkh();Mb.PopulationXML=da.lkh(this.CQb+this.wFc);return 32};ia.prototype.Qkh=function(){var Mb=3,cc=!1;if(this.CQb&&this.Cxg===
this.iWa.LJj)Mb={},la.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",(Mb.CacheRefresh="Not Dirty",Mb)),Mb=this.OLc;else{var Uc={};la.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",(Uc.CacheRefresh="Starting",Uc));Uc=this.vw.ew();this.iWa=this.DBi.yZ("File Open opened",!0);if(this.CQb&&2!==this.OLc&&3!==this.iWa.state)cc=!0;else{Mb=this.JWh(this.iWa);sa.AFrameworkApplication.ta&&sa.AFrameworkApplication.ta.Pa.a_&&va.c()&&
Mb&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(Mb,!0));var Rb=this.LGh(this.iWa);Mb=Rb.QCi;this.CQb=Rb.returnValue}Uc=this.vw.ew()-Uc;Rb={};la.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",(Rb.CacheRefresh="Complete",Rb.ElapsedMs=Uc,Rb))}2!==Mb&&(Uc={},Uc=(Uc.DisplayState=Db[Mb],Uc),1!==Mb&&(Uc.IsStale=cc),la.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",Uc));this.OLc=Mb};ia.prototype.JWh=function(Mb){try{var cc=Va.c(Mb.gwd)}catch(Uc){cc=
null,la.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",Uc)}return cc};ia.prototype.Pkh=function(){if(this.wSc){la.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary.");var Mb=this.Jxi();this.wSc=Mb.MWj;this.wFc=Mb.returnValue}else la.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");Mb={};la.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",(Mb.WaitingOnLinkInfo=
this.wSc,Mb.NotDisplayingLink=!this.wFc,Mb))};ia.prototype.LGh=function(Mb){if(1===Mb.state||0===Mb.state){Mb={};la.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",(Mb.Display="Spinner",Mb));Mb=2;var cc=da.Ste(this.Dja(2),this.Dja(5))}else 3===Mb.state&&Mb.gwd?(cc=this.JQg(Mb.gwd),Mb=0):(Mb={},la.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",(Mb.Display="Server Error",Mb)),cc=da.Uob(this.Dja(1),this.Dja(2)),Mb=1);return{returnValue:cc,QCi:Mb}};ia.prototype.JQg=function(Mb){var cc=
this.qCb.tGa||"2155708348";if(Mb.length){var Uc=da.Tob("lblRecentDocuments",this.Dja(3));for(var Rb=0,qc=0;qc<Mb.length;qc++){var Oc=Mb[qc];"FileName"in Oc&&"DocumentUrl"in Oc&&"Path"in Oc&&(Uc+=da.Oob("MruButton"+qc,Oc.FileName.toString(),Oc.Path.toString(),null,this.qCb.Tja,this.qCb.mxb,cc,Oc.DocumentUrl.toString()),Oc.IsPinned&&Rb++)}Uc=da.oha("RecentDocumentsMenuSection",da.fqf,this.Dja(2),Uc);cc={};la.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",(cc.Display="MRU List",cc.TotalDocuments=
Mb.length,cc.NumPinnedDocuments=Rb,cc))}else Uc=da.Uob(this.Dja(0),this.Dja(2)),Mb={},la.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",(Mb.Display="Empty MRU",Mb));return Uc};ia.prototype.Jxi=function(){var Mb=!0;var cc=this.dPg,Uc=this.cPg;if(cc&&Uc||!this.vw.supportsGetMoreInfoForPersonalStorage)Mb=!1;else{var Rb=this.obc.yZ("File Open",!1);3===Rb.state&&(cc=Rb.wR,Uc=Rb.Sna,Mb=!1)}Uc=Uc?String.format(this.Dja(4),Uc):null;return{returnValue:da.MPg(this.qCb.tGa,Uc,cc),MWj:Mb}};ia.prototype.TMf=
function(){this.vw.Tqf.Qw(this.qCb.Qtb)};Af.Object.defineProperties(ia.prototype,{vw:{configurable:!0,enumerable:!0,get:function(){return this.I1.value}},Dja:{configurable:!0,enumerable:!0,get:function(){return this.$i.value}},qCb:{configurable:!0,enumerable:!0,get:function(){return this.fog.value}},dPg:{configurable:!0,enumerable:!0,get:function(){return this.klg.value}},cPg:{configurable:!0,enumerable:!0,get:function(){return this.jlg.value}},obc:{configurable:!0,enumerable:!0,get:function(){return this.rDa.value}},
DBi:{configurable:!0,enumerable:!0,get:function(){return this.Wog.value}}});Object(ab.a)(ia,"MruRenderer",null,[]);var yb=b(247),qb=b(977);ha.prototype.q0a=function(){!this.Co&&this.Qwd.supportsGetMoreInfoForPersonalStorage?this.obc.yZ("NewDocumentFromStream",!0):this.createNewDocumentFromStream()};ha.prototype.qvb=function(Mb){if(!this.Co&&3===Mb.state)this.Co=Mb;else if(2===Mb.state){this.bfe?la.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.obc.yZ("NewDocumentFromStream",
!0),this.bfe=!0);return}this.createNewDocumentFromStream()};ha.prototype.createNewDocumentFromStream=function(){this.W1d=(new Date).getTime();var Mb=this.$yh.s3c;if(null===Mb)this.zWa(null);else{var cc=this.lUb.menuItemId,Uc=this.lUb.TF,Rb=this.lUb.JFj,qc=this.lUb.ezh;this.Rpa="streamBase64"===Rb?qc.length/1024:0;la.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.tP,this.Rpa);var Oc=(new Date).getTime();Mb=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",
Mb,na.a.$e(this.tla),na.a.$e(cc),na.a.$e(this.tP),na.a.$e(sa.AFrameworkApplication.lcid.toString()),na.a.$e(Oc.toString()),na.a.$e(Uc),na.a.$e(sa.AFrameworkApplication.canary),sa.AFrameworkApplication.aj,na.a.$e(Rb));Mb+="&"+sa.AFrameworkApplication.Qbc();sa.AFrameworkApplication.Fwa&&(Mb+="&"+sa.AFrameworkApplication.gbc());(cc=this.Co?this.Co.wR:null)&&(Mb+="&DestinationUrl="+na.a.$e(cc));this.Qwd.WCb.Yl(Mb,2,qc,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(Ea.a)(this,this.TCi,
"newDocumentFromStreamSuccessHandler"),Object(Ea.a)(this,this.SCi,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,"31")}};ha.prototype.TCi=function(Mb){if(Mb&&Mb.data&&Mb.data.Ud){var cc=Va.d(Mb.data.Ud);var Uc=cc.Pt;cc.returnValue?Uc.StatusCode!==yb.a.TO&&Uc.StatusCode!==yb.a.mrb?(la.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.tP,this.Rpa,Uc.StatusCode),this.zWa(null)):Uc.NewDocumentUrl&&""!==Uc.NewDocumentUrl?
(Mb=(new Date).getTime()-this.W1d,la.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.tP,this.Rpa,Mb),this.Esg(Uc.NewDocumentUrl)):(la.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.tP,this.Rpa),this.zWa(null)):(Uc={},la.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.tP,this.Rpa,
(Uc.ResponseData=qb.a.xeb(Mb.data.Ud),Uc)),this.zWa(null))}else la.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.tP,this.Rpa),this.zWa(null)};ha.prototype.SCi=function(Mb){Mb&&Mb.data&&la.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.tP,this.Rpa,Mb.data.status);this.zWa(null)};Af.Object.defineProperties(ha.prototype,{tP:{configurable:!0,enumerable:!0,
get:function(){switch(this.Qwd.gca){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}},$yh:{configurable:!0,enumerable:!0,get:function(){return this.bib.value}},tla:{configurable:!0,enumerable:!0,get:function(){return this.zqa.value}},Qwd:{configurable:!0,enumerable:!0,get:function(){return this.I1.value}},obc:{configurable:!0,enumerable:!0,get:function(){return this.rDa.value}}});Object(ab.a)(ha,"NewDocumentFromStreamOperation",null,
[]);fa.prototype.create=function(Mb,cc,Uc){return new ha(Mb,cc,Uc,this.bib,this.zqa,this.I1,this.Vog)};Object(ab.a)(fa,"NewDocumentFromStreamOperationFactory",null,[962]);var dc=b(84),bb=b(567),db=b(58);qa.prototype.Sh=function(Mb){Mb.register(fa,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").tc().Cc(function(){return new fa(new Ka.a(function(){return sa.AFrameworkApplication.ta.Pa.qdd()}),new Ka.a(function(){return sa.AFrameworkApplication.tla}),
new Ka.a(function(){return Mb.nh("Common.INewAndOpenCommonHelpers")}),new Ka.a(function(){return Mb.nh("Common.IEventEmitter<Common.IGetMoreInfoResult>")}))})};qa.prototype.init=function(){var Mb=this;sa.AFrameworkApplication.fa.Tu(function(){Mb.Dxb()})};qa.prototype.Dxb=function(){var Mb=bb.a.Mq(dc.a.instance.Tb("Common.INewAndOpenCommonHelpers")),cc=bb.a.Mq(dc.a.instance.Tb("Common.IEventEmitter<Common.IGetMoreInfoResult>"));sa.AFrameworkApplication.tla&&db.Task.WAA.call(null,Mb,cc).continueWith(function(){var Rb=
new Qa(new Ka.a(function(){return Mb.result}),new Ka.a(function(){return sa.AFrameworkApplication.ta.Pa.qdd()}),new Ka.a(function(){return cc.result}),new Ka.a(function(){return sa.AFrameworkApplication.ta.Pa.rdd().tGa||"1959943459"}),new Ka.a(function(){return sa.AFrameworkApplication.tla}),new Ka.a(function(){return sa.AFrameworkApplication.Qji}));Rb.Cg();Rb.eHb()});if(sa.AFrameworkApplication.sLf){var Uc=bb.a.Mq(dc.a.instance.Tb("Common.IEventEmitter<Common.IMruResult>"));db.Task.WAA.call(null,
Mb,cc,Uc).continueWith(function(){var Rb=new ia(new Ka.a(function(){return Mb.result}),new Ka.a(function(){return wa.YUi}),new Ka.a(function(){return sa.AFrameworkApplication.ta.Pa.rdd()}),new Ka.a(function(){return sa.AFrameworkApplication.XUi}),new Ka.a(function(){return sa.AFrameworkApplication.WUi}),new Ka.a(function(){return cc.result}),new Ka.a(function(){return Uc.result}),sa.AFrameworkApplication.fa);Rb.N8i();Rb.TMf()})}};qa.prototype.dispose=function(){};Af.Object.defineProperties(qa.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.NewAndOpen.UX"}}});Object(ab.a)(qa,"UXPackageManager",null,[3,4,10]);var wc=b(1381),nb=b(1388),zb=b(1365),ma=b(1399),P=b(1389),oa=b(1428),Ja=b(1489),$a=b(1047),Ta=b(25);Y.prototype.mke=function(Mb){var cc=!1;Mb&&(Mb.G2c(),Mb.aSg&&(cc=!1));return cc};Y.prototype.S4g=function(){var Mb=sa.AFrameworkApplication.ta.Pa;Mb=new Ja.a(Mb.Fj,$a.a.mcc(),!1,1===Mb.lca);this.mke(Mb)&&la.ULS.sendTraceTag(17571982,306,50,"ChromeExtBannerDisplayed")};
Y.prototype.G4b=function(Mb,cc,Uc,Rb,qc,Oc){Mb=new Ja.a(Mb,Uc,Rb,cc,qc,Oc);this.mke(Mb)&&la.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")};Y.prototype.X$g=function(){var Mb=sa.AFrameworkApplication.ta.Pa,cc=sa.AFrameworkApplication.fa,Uc=Mb.Fj,Rb=1===Mb.lca;if(cc.ra($a.a.A_h(Uc))){var qc=$a.a.mcc(),Oc=8<Ta.a.$4a;if(2!==Uc||2!==qc||!Rb){cc=cc.ra($a.a.B_h(Uc));var jb=Mb.AUf(),Eb=function(){return Mb.vx};cc&&!$a.a.nod($a.a.icd(Uc))&&this.G4b(Uc,Rb,qc,Oc,Eb,jb)}}};Y.prototype.init=function(){var Mb=
sa.AFrameworkApplication.fa,cc=Mb.ra("WildFireChromeExtensionEnabled");Mb=Mb.ra("WildFireChromeExtensionBar")&&cc;$a.a.gxc&&Mb&&!$a.a.nod($a.a.zxe)?this.S4g():(document.body&&$a.a.Txj&&this.X$g(),sa.AFrameworkApplication.ub.Mb(Kb.a.lsd,Hb.a.frame,Object(Ea.a)(this,this.lsd,"launchWildFireBusinessBar")))};Y.prototype.lsd=function(Mb,cc,Uc,Rb,qc){if(1===Uc)return 32;if(!qc)return 8;this.G4b(qc.app,qc.mode,qc.platform,qc.useTwoButton,null,null);return 32};Y.prototype.dispose=function(){};Y.prototype.Sh=
function(){};Y.main=function(){Na.a.instance.Ui(new Y)};Af.Object.defineProperties(Y.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.WildFire"}}});Object(ab.a)(Y,"PackageManager",null,[3,4]);var pa=b(1479);b(1270);var Da=b(11),rb=b(905),Ab=b(51),ob=b(37),sb=b(186);ka.prototype.Lc=function(){return!1};ka.prototype.executeCommand=function(Mb,cc,Uc){return 2!==this.pi.ae(Kb.a.newDocument,2,Uc)?db.Task.Ua(!0):sb.a(cc.command)};ka.prototype.Ac=function(Mb,cc){return 1056925771===
cc.command};ka.prototype.Qc=function(Mb,cc,Uc){Mb=!0;switch(cc){case "PopulateNewMenu":this.pi&&this.pi.ae(Kb.a.Rpc,2,Uc);break;default:Mb=!1}return Mb};Object(ab.a)(ka,"CreateNewCommandHandler",null,[403]);var Pb=rb.a;Rk(ea,Pb);ea.prototype.zd=function(){var Mb=this,cc=Ab.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb),Uc=Ab.GetServiceTaskFactory.create(this.$.da,165,this.la,this.hb);ob.TaskExtensions.Ba(ob.TaskExtensions.Wd([cc,Uc],this.la),function(){Mb.jd([new ka(sa.AFrameworkApplication.ub)])},
this.la,3)};ea.ka=function(Mb){rb.a.Qd(87,new ea(Mb))};Object(ab.a)(ea,"CreateNewCommandHandlerFactory",rb.a,[]);var Aa=b(1375),Ya=b(1272),kb=b(1416),lb=b(559),ac=b(103),Dc=b(177),Zb=b(10),mc=b(22),Lb=b(295),Sa=b(1200);Z.create="Create";Z.activate="Activate";Z.close="Close";Z.remove="Delete";Z.duplicate="Duplicate";Object(ab.a)(Z,"Actions",null,[]);var Cb=b(29),ec=b(42),wb=db.Task;Rk(X,wb);X.prototype.lDc=function(){this.s_d=Cb.a.Wc(3,2,0,1647,0,-1244327602,"MsFormDeleteConfirmation");this.rQb=ec.a(this.ut.$).kj(this.s_d).G();
this.rQb.isCompleted||(this._state=2,this.rQb.f9a(this.moveNext));return this.Ogg};X.prototype.Ogg=function(){this.u_d=this.rQb.yZ();0===this.u_d&&(this.ut.$.workbookContext.Options=Zb.HelperMethods.gO(!1,this.ut.$.workbookContext.Options,2048),this.ut.deleteMsFormMetaDataSheet());this._state=3;this.bKb(!0)};X.prototype.dispose=function(){};Object(ab.a)(X,"$$sm_Microsoft$Office$Excel$WebUI$Client$MsForm$MsFormCommandHandler$DeleteMsForm",db.Task,[10]);ca.action="Action";ca.yBh="FlexPane";ca.d$b="formId";
ca.id="id";ca.title="Title";ca.$Ob="XlWorkbookId";ca.xDh="Fragment";ca.host="Host";ca.NKj="TopView";ca.c2="auth_pvr";Object(ab.a)(ca,"Parameters",null,[]);var rc=b(61);H.prototype.Lc=function(Mb,cc){switch(cc){case -105284469:return!ac.i(this.$.ng)||this.hasMsForm;case -1219864912:case 1674421386:case -1128532220:case 2023601781:return!this.hasMsForm}return!1};H.prototype.executeCommand=function(Mb,cc){Mb=ob.TaskExtensions.jk();cc=cc.command;switch(cc){case -105284469:this.insertMsForm();break;case -1219864912:this.previewMsForm();
break;case -1128532220:this.editMsForm();break;case 1674421386:this.sendMsForm();break;case 2023601781:Mb=this.deleteMsForm();break;default:Mb=sb.a(cc)}return Mb};H.prototype.Ac=function(Mb,cc){if(!this.$.ea.Kg.get(61))return!1;Mb=!1;switch(cc.command){case -105284469:Mb=ac.i(this.$.ng)&&!this.hasMsForm;break;case -1219864912:case 1674421386:case -1128532220:case 2023601781:Mb=this.hasMsForm}return Mb};H.prototype.Qc=function(){return!1};H.prototype.insertMsForm=function(){var Mb=na.a.qq(this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),
cc={},Uc={};cc[ca.action]=Z.create;cc[ca.c2]=this.c2;Uc[ca.action]=Z.create;Uc[ca.$Ob]=encodeURIComponent(this.VOb);Uc[ca.host]=this.ho;Uc[ca.title]=encodeURIComponent(Mb);this.hCb(cc,Uc);this.$.workbookContext.Options=Zb.HelperMethods.gO(!1,this.$.workbookContext.Options,2048)};H.prototype.editMsForm=function(){var Mb={},cc={};Mb[ca.c2]=this.c2;cc[ca.d$b]=this.olc;cc[ca.$Ob]=encodeURIComponent(this.VOb);cc[ca.host]=this.ho;this.hCb(Mb,cc)};H.prototype.previewMsForm=function(){var Mb={},cc={};Mb[ca.c2]=
this.c2;cc[ca.d$b]=this.olc;cc[ca.$Ob]=encodeURIComponent(this.VOb);cc[ca.host]=this.ho;cc[ca.NKj]="Preview";this.hCb(Mb,cc)};H.prototype.sendMsForm=function(){var Mb={},cc={};Mb[ca.c2]=this.c2;cc[ca.d$b]=this.olc;cc[ca.yBh]="SendForm";cc[ca.$Ob]=encodeURIComponent(this.VOb);cc[ca.host]=this.ho;this.hCb(Mb,cc)};H.prototype.deleteMsForm=function(){return new X(this)};H.prototype.deleteMsFormMetaDataSheet=function(){var Mb=this;this.$.userOperationManager.St(new Dc.a(158,0,function(cc,Uc,Rb){return Q(Mb.$.oa.sw,
Mb.VU.Wtb,Lb.b(cc,function(){Mb.gdh()}),Uc,Rb,null)}))};H.prototype.gdh=function(){var Mb={},cc={};Mb[ca.action]=Z.remove;Mb[ca.c2]=this.c2;cc[ca.action]=Z.remove;cc[ca.host]=this.ho;cc[ca.d$b]=encodeURIComponent(this.olc);cc[ca.$Ob]=encodeURIComponent(this.VOb);this.hCb(Mb,cc)};H.prototype.hCb=function(Mb,cc){var Uc=this.$.ya.MsFormBaseUrl+"/Pages/DesignPage.aspx",Rb="",qc="";if(cc){for(var Oc in cc){var jb=Oc,Eb=cc[Oc];qc+=qc.length?"&":"";qc+=jb+"="+Eb}Mb||(Mb={});Mb[ca.xDh]=encodeURIComponent(qc)}if(Mb)for(var nc in Mb)cc=
nc,qc=Mb[nc],Rb+=Rb.length?"&":"?",Rb+=cc+"="+qc;window.open(Uc+Rb,"_blank")};Af.Object.defineProperties(H.prototype,{hasMsForm:{configurable:!0,enumerable:!0,get:function(){return ac.c(this.$.ng)}},olc:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.MsFormId}},VOb:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.MsFormDocUrl}},c2:{configurable:!0,enumerable:!0,get:function(){return mc.a.contains(this.$.Lv.DocumentHostInfo.FileSource,"onedrive",
!0)?"MSA":"OrgId"}}});Object(ab.a)(H,"MsFormCommandHandler",null,[403]);var Mc=rb.a;Rk(N,Mc);N.prototype.zd=function(){var Mb=this,cc=Ab.GetServiceTaskFactory.create(this.$.da,203,this.la,this.hb);ob.TaskExtensions.Ba(ob.TaskExtensions.Wd([cc],this.la),function(){Mb.jd([new H(Mb.$)])},this.la,3)};N.ka=function(Mb){Mb.ea.Kg.get(61)&&rb.a.Qd(215,new N(Mb))};Object(ab.a)(N,"MsFormCommandHandlerFactory",rb.a,[]);var Pc=b(232),Kc=Pc.a;Rk(O,Kc);O.prototype.create=function(){var Mb=this;ob.TaskExtensions.Ba(Ab.GetServiceTaskFactory.create(this.$.da,
164,this.la,this.hb),function(){Mb.pb(new qa)},this.la,3)};Object(ab.a)(O,"NewAndOpenUXFactory",Pc.a,[]);J.prototype.executeCommand=function(Mb,cc,Uc){Mb=2;switch(cc.command){case Kb.a.openUrlInNewTab:Mb=this.pi.ae(Kb.a.openUrlInNewTab,2,Uc);break;case Kb.a.IOa:Mb=this.pi.ae(Kb.a.IOa,2,Uc)}return 2!==Mb?db.Task.Ua(!0):sb.a(cc.command)};J.prototype.Ac=function(Mb,cc){return cc.command===Kb.a.openUrlInNewTab||cc.command===Kb.a.IOa};J.prototype.Qc=function(Mb,cc,Uc){return"PopulateMruMenu"===cc?(this.pi.ae(Kb.a.Qpc,
2,Uc),!0):!1};J.prototype.Lc=function(){return!1};Object(ab.a)(J,"OpenFromMruCommandHandler",null,[403]);var ub=rb.a;Rk(K,ub);K.prototype.zd=function(){var Mb=this,cc=Ab.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb),Uc=Ab.GetServiceTaskFactory.create(this.$.da,165,this.la,this.hb);ob.TaskExtensions.Ba(ob.TaskExtensions.Wd([cc,Uc],this.la),function(){Mb.jd([new J(Mb.$,sa.AFrameworkApplication.ub)])},this.la,3)};K.ka=function(Mb){rb.a.Qd(88,new K(Mb))};Object(ab.a)(K,"OpenFromMruCommandHandlerFactory",
rb.a,[]);var Fb=b(1353),pc=b(1390),eb=b(1429),ic=b(1275),Ac=b(1371),lc=b(1276),Gc=b(1277),ed=b(1376),fd=b(1417),Bc=b(1418),ld=b(85),Bd=b(389),xb=b(101),Fd=b(21),Vd=b(391);F.prototype.getSheetName=function(){return this.sheetName};F.prototype.getValue=function(){return this.value};Object(ab.a)(F,"MacroRecorderSheetOptionToggledPayload",null,[409]);I.prototype.Lc=function(){return!1};I.prototype.executeCommand=function(Mb,cc){function Uc(){return new F(Rb.SheetName,$c)}var Rb={};this.$.Oj(Rb);Mb=cc.command;
var qc=Object(ld.a)(xb.a,this.$.va.getItemByName(Rb.SheetName));if(!qc)return sb.a(Mb);switch(Mb){case 705559150:case -1411193626:var Oc=16;var jb=!qc.hideGridLines;var Eb=T;var nc=183;var $c=qc.hideGridLines;break;case -2052321504:case 515737500:Oc=4;jb=!qc.headersVisible;Eb=M;nc=184;$c=!qc.headersVisible;break;case -1478455630:Oc=2;jb=!qc.displayRtl;Eb=U;nc=185;$c=!qc.displayRtl;Fd.g(this.$).Ea.gQj(jb);break;default:return sb.a(Mb)}qc.Cpb(Oc,jb);var od=this.$.oa.xa;return Bd.a(this.$.userOperationManager,
function(de,ae,ze){return Eb(od,Rb.SheetName,$c,Lb.b(de,function(Xd){I.OEb(Xd,qc,Oc,jb)}),Lb.a(ae,function(){I.$Db(qc,Oc,jb)}),ze,null)},function(de){return new Dc.a(nc,0,de,void 0,Uc)},cc)};I.prototype.Ac=function(Mb,cc){Mb=!1;switch(cc.command){case -1411193626:case 515737500:case -1478455630:Mb=!0;break;case 705559150:case -2052321504:Mb=Vd.a(this.$)}return Mb};I.prototype.Qc=function(){return!1};I.OEb=function(Mb,cc,Uc,Rb){Cb.a.Xq(Mb.Errors)&&cc.Cpb(Uc,!Rb)};I.$Db=function(Mb,cc,Uc){Mb.Cpb(cc,
!Uc)};Object(ab.a)(I,"SheetOptionsToggleCommandHandler",null,[403]);var se=rb.a;Rk(E,se);E.prototype.zd=function(){this.jd([new I(this.$)])};E.ka=function(Mb){rb.a.Qd(100,new E(Mb))};Object(ab.a)(E,"SheetOptionsToggleCommandHandlerFactory",rb.a,[]);var ue=b(178),Ee=b(207),qe=b(153),He=b(64),Ie=b(59),ef=b(216),Ye=b(649),pe=b(92),Qd=b(1),fe=b(260),Hc=b(218),ud=b(47),Gd=b(44),jd=b(12),Sd=Hc.a;Rk(G,Sd);G.prototype.initialize=function(){var Mb=this.$.yb+"iframeDialog_frame",cc=this.$.yb+"iframeDialog";
var Uc=String.format('<iframe id="{0}" frameborder="0" scrolling="auto" src="{1}">\r\n</iframe>',Mb,this.IYe(cc));this.Gb.style.margin=Zb.HelperMethods.hc(0);this.Gb.style.marginBottom=Zb.HelperMethods.hc(-2);this.Gb.innerHTML=Uc;this.xJc=document.getElementById(Mb);this.domElement.id=cc;this.onResize(null,Sys.EventArgs.Empty);Ta.a.xgc&&ud.a.instance.create(this.Tkh,50,Gd.a.i7h,!0,!0);Sd.prototype.initialize.call(this)};G.prototype.dispose=function(){this.$&&this.$.kD(this.onResize);Sd.prototype.dispose.call(this)};
G.prototype.setFocus=function(){jd.DOMElementExtensions.setFocus(this.bLa)};G.prototype.onHide=function(){this.bLa.contentWindow.close();jd.DOMElementExtensions.gf(this.bLa);this.xJc=null;Sd.prototype.onHide.call(this)};G.prototype.TQj=function(Mb){var cc=this.domElement.style;cc.width=Zb.HelperMethods.hc(Mb.x);cc.marginLeft=Zb.HelperMethods.hc(-Mb.x/2)};G.prototype.SPh=function(){var Mb=jd.DOMElementExtensions.getBounds(document.body);return new Sys.UI.Point(Math.min(Math.floor(.9*Mb.width),this.aGe.x),
Math.min(Math.floor(.9*Mb.height),this.aGe.y))};Af.Object.defineProperties(G.prototype,{bLa:{configurable:!0,enumerable:!0,get:function(){return this.xJc}}});Object(ab.a)(G,"IFrameDialog",Hc.a,[]);var Wd=b(5),Le=b(78),Pd=b(14);Rk(C,G);C.prototype.IYe=function(Mb){var cc=new Sys.StringBuilder(this.$.ya.EmbedConfiguratorUrl);ef.a.Qg(cc,Wd.a.cnh,Mb);Le.a(this.$.ya,34)&&ef.a.Qg(cc,Wd.a.cMe,"1");Le.a(this.$.ya,35)&&ef.a.Qg(cc,Wd.a.dMe,"1");return cc.toString()};C.prototype.onShow=function(){la.ULS.sendTraceTag(537151690,
0,50,"EmbeddingDialog.OnShow: the dialog is being shown");G.prototype.onShow.call(this)};Af.Object.defineProperties(C.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"EmbeddingDialog"}}});Object(ab.a)(C,"EmbeddingDialog",G,[]);var Re=b(1444),Qe=b(90),jc=b(81),Fa=b(1030);x.l0f="FrameDialog_ShareFromEdit";x.view="FrameDialog_View";x.Fye="FrameDialog_CloseAndRefresh";x.Muj="FrameDialog_ShareFromView";x.edit="FrameDialog_Edit";x.e7i="FrameDialog_RefreshGrid";x.jZg="FrameDialog_CloseMe";
x.Pye="FrameDialog_CloseMeError";x.ready="FrameDialog_Ready";x.AYi="FrameDialog_PleaseClose";x.nH="GotoRange";Object(ab.a)(x,"PostMessageConstants",null,[]);var Qb=b(564),cb=b(258),Xb=b(121),kc=b(296),Wc=b(95);Object(ab.a)(y,"SessionUpdateContext",null,[]);Rk(B,G);B.prototype.rFg=function(Mb){this.addHandler(B.usd,Mb)};B.prototype.Abj=function(Mb){this.removeHandler(B.usd,Mb)};B.prototype.dispose=function(){Qe.a.Ia(this.y0a);this.y0a=null;G.prototype.dispose.call(this)};B.prototype.initialize=function(){G.prototype.initialize.call(this);
var Mb=jc.a.Maa(this.$.ya.FormLightBoxUrl),cc=this.y0a=new Re.a(this.bLa.contentWindow,Mb);cc.isEnabled()&&cc.sFa(Mb)&&(this.Ama(x.l0f,this.voc),this.Ama(x.view,this.voc),this.Ama(x.Fye,this.voc),this.Ama(x.Muj,this.ORi),this.Ama(x.edit,this.zJi),this.Ama(x.e7i,this.voc),this.Ama(x.ready,this.hQi),this.Ama(x.jZg,this.Cmc),this.Ama(x.Pye,this.Cmc))};B.prototype.close=function(Mb){Mb===this.closeAction&&this.Kdf&&this.y0a.send(new Fa.a(x.AYi))||G.prototype.close.call(this,Mb)};B.prototype.IYe=function(){return this.VCe(this.nhc)};
B.prototype.VCe=function(Mb){var cc=this.$.ya,Uc=new Sys.StringBuilder(cc.FormLightBoxUrl);ef.a.Qg(Uc,Wd.a.fDh,this.$.ea.sessionId);ef.a.Qg(Uc,Wd.a.dDh,Mb?Wd.a.eDh:Wd.a.cDh);Xb.a.VYa(Uc,cc);return Uc.toString()};B.prototype.sdg=function(Mb){this.LKc=!1;this.bLa.src=this.VCe(Mb);this.U8d=Mb};B.prototype.Ama=function(Mb,cc){this.y0a.Wn(Mb);this.y0a.Ml(Mb,cc)};B.prototype.knc=function(Mb){var cc=this.$.ea.va.getItemByName(Mb.nH.SheetName);cc&&0===cc.wy&&Fd.g(this.$).hg(Mb.nH,null,null,null,20,Wc.a.OCh)};
Af.Object.defineProperties(B.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"FormDialog"}},Kdf:{configurable:!0,enumerable:!0,get:function(){return this.LKc}},nhc:{configurable:!0,enumerable:!0,get:function(){return this.U8d}}});B.Gch=900;B.ich=1200;B.usd="lightBoxReady";Object(ab.a)(B,"FormDialog",G,[481]);var id;(function(Mb){Mb[Mb.comment=10]="comment";Mb[Mb.range=12]="range";Mb[Mb.table=13]="table";Mb[Mb.chart=14]="chart"})(id||(id={}));Object(ab.b)("NavigationType",id);var Vc=
b(1079),td=b(118),rd=b(18),za=b(621),tb=b(1153),Wb=b(297),fc=b(938),xc=b(53),Yb=fc.a;Rk(A,Yb);A.prototype.initialize=function(){var Mb="<div class='"+td.a.Cn+"'>\r\n\t<div class='"+td.a.sMe+"'>\r\n\t\t<div class='"+rd.a.wye+"'>\r\n\t\t\t<img src='{0}' class='"+rd.a.mPe+"' alt='{1}' />\r\n\t\t</div>\r\n\t</div>\r\n\t<div class='"+td.a.wMe+"'>\r\n\t\t<p>{2}</p>\r\n\t</div>\r\n</div>";Mb=String.format(Mb,xc.a.Te(13),Pd.a.instance.ga(25),Pd.a.instance.ga(this.message));this.Gb.innerHTML=Mb;this.addButton(0,
this.zFi);this.addButton(1);Yb.prototype.initialize.call(this)};A.prototype.Py=function(){return this.KZd};Af.Object.defineProperties(A.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"WebMethodConfirmationDialog"}},uv:{configurable:!0,enumerable:!0,get:function(){return 1005}},Hsa:{configurable:!0,enumerable:!0,get:function(){return this.operationFlags}}});Object(ab.a)(A,"WebMethodConfirmationDialog",fc.a,[]);var Ec=Vc.a;Rk(v,Ec);v.prototype.dispose=function(){this.kTa&&this.kTa.fda(this.nDf);
Qe.a.oc([this.textBox,this.MQa,this.kTa]);this.kTa=this.MQa=this.textBox=null;Ec.prototype.dispose.call(this)};v.prototype.initialize=function(){var Mb="<div class='"+td.a.Cn+"'>\r\n\t<span>{0}</span>\r\n</div>\r\n<div class='"+td.a.Y1a+"'>\r\n\t<input type='text' id='{1}' class='"+td.a.AC+"' aria-live='polite' aria-atomic='true'/>\r\n\t<br />\r\n\t<a href='#' id='{2}' class='{3}'>{4}</a>\r\n</div>";Mb=String.format(Mb,Pd.a.instance.ga(1253),"sfd_input","sfd_unshare",rd.a.Lp,Pd.a.instance.ga(1254));
this.Gb.innerHTML=Mb;this.textBox=new Wb.a(this.getElementById("sfd_input"));this.MQa=new tb.a(this.textBox.domElement);this.kTa=za.a.create(this.getElementById("sfd_unshare"));this.kTa.q2(this.nDf);this.textBox.text=Pd.a.instance.ga(739);this.textBox.enabled=!1;this.textBox.readOnly=!Ta.a.sh;this.addButton(1,10);Ec.prototype.initialize.call(this)};v.prototype.mha=function(){var Mb=this;return function(cc,Uc,Rb){var qc=Mb.$.oa.xa.Pb(),Oc=Mb.$.oa.xa;cc=Mb.ija(cc);Uc=Mb.Aaa(Uc);qc=Oc.Na(1,qc);return rc.g(Oc,
"ShareForm",qc,cc,Uc,Rb,null,0)}};v.prototype.fy=function(Mb,cc,Uc){this.textBox.text=Mb.Result;this.textBox.enabled=!0;jd.DOMElementExtensions.setVisible(this.kTa.domElement,!0);Ec.prototype.fy.call(this,Mb,cc,Uc)};v.prototype.setFocus=function(){if(this.textBox&&this.textBox.enabled)try{this.textBox.focus();return}catch(Mb){}Ec.prototype.setFocus.call(this)};Af.Object.defineProperties(v.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"ShareFormDialog"}}});Object(ab.a)(v,"ShareFormDialog",
Vc.a,[]);var bd=b(255),Ic=b(6),Md=b(82),ne=b(263),le=b(67),Ke=b(719),oc=b(145),Qc=b(459),md=b(187),dd=b(267),Kd=b(16),ke=b(262),kd=Ee.a;Rk(r,kd);r.prototype.Lc=function(Mb,cc){Mb=this.$.workbookContext.FullDocumentInfo;switch(cc){case 353606613:case -1099009678:case 192430811:return!Qd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.ea.isNamedObjectViewMode||this.$.isMobileMode;case 869186573:return cc=dd.a()&&this.$.ea.Kg.get(5),!Mb.FileSharingUrl&&!cc;case -1570751769:case 1986648902:return 131072!==
(this.$.sQ&131072);case 330035228:return!(this.J2a(!0)&&this.$Cc);case -509039657:return!(this.J2a()&&this.$Cc);case 1334518759:return!(this.J2a()&&this.$Cc&&this.Bve())}return!1};r.prototype.executeCommand=function(Mb,cc,Uc){Mb=this.$.workbookContext.FullDocumentInfo;var Rb=Kb.a.workflow,qc=ob.TaskExtensions.jk(),Oc=cc.command;if(Oc===Rb||-266099===Oc)return this.k4h(cc,Rb,Mb);switch(Oc){case 1986648902:this.A_f();break;case -1570751769:this.S1h(cc);break;case 869186573:cc=Kb.a.Luj;qc=sa.AFrameworkApplication.fa.ra("ShareMenuIsEnabled");
Rb=null;(Qd.EwaSettings.ma(558)||qc)&&Uc&&"CopyLink"===Uc.SourceControlId?(Rb={},Rb[Ia.a.MKb]="copy",cc=Kb.a.k0f):qc&&Uc&&"ManageAccess"===Uc.SourceControlId?(Rb={},Rb[Ia.a.MKb]="manageAccess",cc=Kb.a.Nuj):Uc&&"LinkToComment"===Uc.SourceControlId&&(Rb={},Rb[Ia.a.MKb]="copy",Rb[Ia.a.kPd]=Uc.navId,cc=Kb.a.k0f);qc=this.B3f(Mb,Rb);md.c(cc);break;case -1099009678:qc=this.jPd(12,Mb);break;case 192430811:qc=this.jPd(13,Mb);break;case 353606613:qc=this.jPd(14,Mb);break;case -59906385:case 1197060601:this.y3h(cc,
Mb);break;case 1305810481:this.J4e(!1,cc);break;case 330035228:this.J4e(!0,cc);break;case -509039657:this.deleteForm();break;case 1334518759:cc.Byb=!0;this.shareForm();break;case 710925581:Ie.a.rg.Gwc("710925581")&&(qc=ob.TaskExtensions.Ba(this.RJ.value,function(jb){jb.result.xj(mb.a.conversation,{})},this.la,3));break;case 327119921:this.G1h();break;default:qc=sb.a(Oc)}return qc};r.prototype.Ac=function(Mb,cc){Mb=!1;cc=cc.command;if(cc===Kb.a.workflow)return!0;switch(cc){case 1986648902:case -1570751769:case 869186573:case -59906385:case 1197060601:case 1305810481:case 330035228:case -509039657:case 1334518759:case -266099:case 710925581:case 327119921:Mb=
!0;break;case 353606613:case -1099009678:case 192430811:Mb=Qd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&!this.$.ea.isNamedObjectViewMode}return Mb};r.prototype.Qc=function(Mb,cc,Uc){if("PopulateFormMenu"===cc){cc=this.$Cc?this.Bve()?r.gxh:r.hxh:r.XCi;Mb=this.Va.Bc();for(var Rb=0;Rb<cc.length;Rb++)Mb.buttons.push(this.Va.nb(cc[Rb]));cc=this.Va.mq("Forms.Flyout");cc.pc.push(Mb);Uc.MenuItems=cc.eE();return!0}return!1};r.prototype.k4h=function(Mb,cc,Uc){return this.LLd&&
Mb.command===cc?(this.JLd(Mb,-266099),ob.TaskExtensions.Qaa()):ob.TaskExtensions.Ba(this.RJ.value,function(Rb){Ye.a(Rb.result,mb.a.workflow,null,Uc.WorkflowPostMessage)||Zb.HelperMethods.Ze(Uc.WorkflowUrl,"_blank",void 0,"SocialSharingCommandHandler.WorkflowUrl")},this.la,3)};r.prototype.Bve=function(){return!!this.$.workbookContext.FullDocumentInfo.ShareFormCommandUrl||this.$.ea.Kg.get(26)};r.prototype.G1h=function(){var Mb=ue.a.create().toString();la.ULS.sendTraceTag(528581128,306,50,"Calling share to teams deeplink with ID: "+
Mb);var cc=this.$.frame,Uc=cc.F8a,Rb=this.$,qc=new ke.QueryStringBuilder(sa.AFrameworkApplication.fa.Wa("TeamsMeetingShareEndpoint"));qc.Ii("deeplinkId",Mb);qc.Ii("lm","deeplink");Mb=qc.Ii;var Oc={};var jb=new ke.QueryStringBuilder(sa.AFrameworkApplication.fa.Wa("TeamsAppSharingUrl"));jb.Ii("auth","2");jb.Ii("flight","officeunihost");jb.Ii("source","TEAMS-ELECTRON.meetingStage.deeplink");var Eb={};Eb.fileType=na.a.b4(Rb.workbookContext.FullDocumentInfo.WorkbookPath).substring(1);Eb.objectUrl=Rb.workbookContext.FullDocumentInfo.WorkbookPath;
Eb.baseUrl=Rb.workbookContext.FullDocumentInfo.BreadcrumbBrandUrl;Rb=Rb.workbookContext.WorkbookFileVersionId;for(var nc=decodeURIComponent(Rb);Rb!=nc;)Rb=nc,nc=decodeURIComponent(Rb);0>Rb.indexOf("{")||0>Rb.indexOf("}")?(la.ULS.sendTraceTag(528250338,306,15,"Decoded fileId does not match expected format. Decoded id: "+Rb),Rb=""):Rb=Rb.substring(Rb.indexOf("{")+1,Rb.indexOf("}")).toLowerCase();Eb.fileId=Rb;Eb=Va.c(Va.c(Eb));jb.Ii("subEntityId",Eb.substring(1,Eb.length-1));Oc.appSharingUrl=jb.toString();
Oc.appId=sa.AFrameworkApplication.fa.Wa("TeamsAppId");Oc=JSON.stringify(Oc);Mb.call(qc,"appContext",Oc);Uc.call(cc,qc.toString(),!0)};r.prototype.S1h=function(Mb){this.LLd?this.JLd(Mb,1986648902):this.A_f()};r.prototype.J4e=function(Mb,cc){!Mb&&this.$.ya.SurveyRedirectUrl?this.O1i():(Mb=new B(this.$,Mb,cc),Mb.initialize(),Mb.hf())};r.prototype.y3h=function(Mb,cc){var Uc=this;this.LLd&&1197060601===Mb.command?this.JLd(Mb,-59906385):ob.TaskExtensions.Ba(this.RJ.value,function(Rb){Rb=Rb.result;Rb&&Ye.a(Rb,
mb.a.replyWithChanges,null,Uc.$.ea.Kg.get(8))||(Rb=new Sys.StringBuilder(cc.ReplyWithChangesUrl),ef.a.Qg(Rb,Qc.e,Qc.d),qe.a.ntw(Rb.toString(),Uc.$))},this.la,3)};r.prototype.JLd=function(Mb,cc){var Uc=this,Rb=le.a(this.$).fd.activityState,qc=new pe.a(cc,Mb.method,Mb.mode,Mb.Me,Mb.tabName);ec.a(this.$).ft(new fe.a(Ic.a.fz,5,function(){Rb[ne.a.Rq]=Ic.a.BUf;Rb[Ke.a.qTc]=qc;Uc.$.Ok.Jy("SocialSharingSaveBeforeCommand");Uc.$.Ok.ole(qc.command)}))};r.prototype.A_f=function(){var Mb=this,cc=this.$.ya.DocumentHostInfo;
cc.HostEmbeddedViewUrl||this.rve?this.v2f():this.$.Lf.get(53)&&ob.TaskExtensions.Ba(this.RJ.value,function(Uc){Mb.INj(Uc.result)||qe.a.ntw(cc.FileEmbedCommandUrl,Mb.$)},this.la,3)};r.prototype.INj=function(Mb){return Mb.isEnabled()&&(this.qve||(this.qve=Mb.Ml(mb.a.pve,this.QGi)))?Mb.xj(mb.a.Pyh,null):!1};r.prototype.v2f=function(){if(Ta.a.Zo)qe.a.ntw(this.$.ya.EmbedConfiguratorUrl,this.$);else{var Mb=new C(this.$);Mb.initialize();Mb.hf()}};r.prototype.deleteForm=function(){var Mb=this.$,cc=new A(Mb,
1258,1259,1251,function(Uc,Rb,qc){var Oc=Mb.oa.xa.Pb(),jb=Mb.oa.xa;Oc=jb.Na(9,Oc);Oc.surveyId=null;return rc.g(jb,"DeleteSurvey",Oc,Uc,Rb,qc,null,0)});cc.initialize();cc.hf()};r.prototype.shareForm=function(){var Mb=this,cc=this.$.workbookContext.FullDocumentInfo;if(this.$.ea.Kg.get(26)){var Uc=new v(this.$);Uc.initialize();Uc.hf()}else ob.TaskExtensions.Ba(this.RJ.value,function(Rb){var qc={};Ye.a(Rb.result,mb.a.shareForm,(qc[Ia.a.JGj]=Mb.$.workbookContext.SurveyTitle,qc),Mb.$.ea.Kg.get(10))||qe.a.ntw(cc.ShareFormCommandUrl,
Mb.$)},this.la,3)};r.prototype.O1i=function(){var Mb=this.$;Mb.ya.SurveyRedirectUrl.replace(RegExp("&startupdialog=[formedit|formpreview]","gi"),"");var cc=new Sys.StringBuilder(Mb.ya.SurveyRedirectUrl);ef.a.Qg(cc,"startupDialog","FormEdit");var Uc=le.a(this.$),Rb=Uc.fd.activityState;Rb[Md.a.f2]=cc.toString();Rb[Md.a.OL]=Md.a.Bwd;this.$.Ok.Jy("SocialSharingEnvironmentChange");ec.a(Mb).ft(new fe.a(Ic.a.fz,5,function(){var qc=Cb.a.Wc(3,2,1303,1304,1305,554412057,"FossEnvironmentUnsupported");Uc.fd.Bt([qc]);
Rb[ne.a.Rq]=Ic.a.vbg}))};r.prototype.J2a=function(Mb){return(this.$.ea.isEditMode||(void 0===Mb?!1:Mb))&&this.$.ea.Kg.get(25)&&dd.a()};r.prototype.bXh=function(Mb){var cc=void 0===cc?null:cc;var Uc=Fd.g(this.$).ha;var Rb=this.$.va.pa?He.d(this.$.va.pa):null;if(!Rb)return la.ULS.sendTraceTag(537151649,0,10,"SocialSharingCommandHandler.GetSharingDetail: Unable to find current sheet id for navType: {0}.",id[Mb]),null;14===Mb?cc=this.AWh(Uc):12===Mb?(cc=Uc.cia,cc=mc.a.contains(cc,"!",!0)?cc.split("!")[1]:
cc):13===Mb&&(Uc=Uc.sa.selectedRanges,Uc[0]&&(Uc=Fd.g(this.$).Ab.dk(Uc[0])))&&(cc=Uc.Ei);if(!cc)return la.ULS.sendTraceTag(537151648,0,10,"SocialSharingCommandHandler.GetSharingDetail: Unable to find the selected range reference or object id for navType: {0}",id[Mb]),null;Uc={};Uc[Ia.a.MKb]="copy";Uc[Ia.a.kPd]=this.rNh(Mb,cc,Rb);la.ULS.sendTraceTag(537151647,0,50,"SocialSharingCommandHandler.GetSharingDetail: Send Section_Sharing post message with navType: {0} and sectionNameOrId: {1} and SheetId: {2}",
id[Mb],cc,Rb);return Uc};r.prototype.AWh=function(Mb){if(Mb.Oa.P4&&(Mb=Mb.Oa.Yb.floatingObject)&&0===Mb.type){var cc=Mb.id.split(".");if(1<cc.length)return cc[1];la.ULS.sendTraceTag(537151646,0,10,"SocialSharingCommandHandler.GetSelectedFloatingObjectXluid: Invalid floating object id =  {0}",Mb.id)}return null};r.prototype.rNh=function(Mb,cc,Uc){Mb=btoa(Mb+"_"+cc+"_"+Uc);Mb=Mb.replace(RegExp("\\+","g"),"-");Mb=Mb.replace(RegExp("\\/","g"),"_");return Mb=Mb.replace(RegExp("\\=+$","g"),"")};r.prototype.B3f=
function(Mb,cc){var Uc=this;return ob.TaskExtensions.Ba(this.RJ.value,function(Rb){Ye.a(Rb.result,mb.a.sharing,cc,Uc.$.ea.Kg.get(5))?la.ULS.sendTraceTag(537151644,0,50,"SocialSharingCommandHandler.ShowShareDialog: Send UI_Sharing post message with mode: {0}",cc?cc[Ia.a.MKb]:""):Zb.HelperMethods.Ze(Mb.FileSharingUrl,"_blank",void 0,"SocialSharingCommandHandler.FileSharingUrl")},this.la,3)};r.prototype.jPd=function(Mb,cc){if(!Qd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",
!1)||this.$.isMobileMode)return null;var Uc=this.bXh(Mb);if(Uc)return la.ULS.sendTraceTag(520737606,0,50,"SocialSharingCommandHandler.ShareExcelSection: Calling share dialog with nav id={0}",Uc[Ia.a.kPd]),this.B3f(cc,Uc);la.ULS.sendTraceTag(537151643,0,10,"SocialSharingCommandHandler.ShareExcelSection: Unable to get the sharing details for navType: {0}",id[Mb]);return null};Af.Object.defineProperties(r.prototype,{$Cc:{configurable:!0,enumerable:!0,get:function(){return ac.b(this.$.ng)}},LLd:{configurable:!0,
enumerable:!0,get:function(){return this.$.isEditMode&&(this.$.ea.Aih||this.$.OQ)}}});r.XCi=[103];r.gxh=[107,104,105,106];r.hxh=[104,105];r.PVg=[new Kd.a(Ic.a.Nye,554412057,0,0,1306),new Kd.a(Ic.a.idle,554412057,0,1)];Object(ab.a)(r,"SocialSharingCommandHandler",Ee.a,[403]);var Nd=rb.a;Rk(z,Nd);z.prototype.zd=function(){var Mb=this,cc=new Ka.a(function(){return Ab.GetServiceTaskFactory.create(Mb.$.da,137,Mb.la,Mb.hb)});ob.TaskExtensions.Ba(Ab.GetServiceTaskFactory.create(this.$.da,102,this.la,this.hb),
function(Uc){Mb.jd([new r(Mb.$,Uc.result,cc)])},this.la,3)};z.ka=function(Mb){rb.a.Qd(114,new z(Mb))};Object(ab.a)(z,"SocialSharingCommandHandlerFactory",rb.a,[]);var ge=b(1360);n.prototype.executeCommand=function(Mb,cc,Uc){return 2!==this.pi.ae(Kb.a.tryOfficeThroughTellMe,2,Uc)?db.Task.Ua(!0):sb.a(cc.command)};n.prototype.Ac=function(Mb,cc){return 215809929===cc.command};n.prototype.Qc=function(){return!1};n.prototype.Lc=function(){return!1};Object(ab.a)(n,"TryOfficeThroughTellMeCommandHandler",
null,[403]);var Me=rb.a;Rk(w,Me);w.prototype.zd=function(){this.jd([new n(sa.AFrameworkApplication.ub)])};w.ka=function(Mb){rb.a.Qd(207,new w(Mb))};Object(ab.a)(w,"TryOfficeThroughTellMeCommandHandlerFactory",rb.a,[]);var Ze=b(162),lf=b(76),he=b(159),Se=b(325),ve=b(150),Xa=b(180);f.AM=function(){return ve.a.Po(f.rk,Xa.a.Xa(434))};f.rk="<div class='namedsheetview_teaching_dialog_control' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_description_label' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_textarea' id='TextArea'> <label id='TeachingDescriptionId' class='WACDialogLabel' >{0}</label> </div> </div> </div>";
Object(ab.a)(f,"NamedSheetViewTeachingDialogHtml",null,[]);var h=b(50),hb=Se.a;Rk(m,hb);m.prototype.sg=function(){this.Rb=4;this.stopwatch=this.$.Fb.sc("UserAction",this.nc);var Mb=Pd.a.instance.ga(1888);this.Wf=f.AM();this.Mo=new Ze.a;this.initializeAndShow(Mb,this.eCi,{});return this.Mo.task};m.prototype.kv=function(Mb){hb.prototype.kv.call(this,Mb);this.mc(1,Pd.a.instance.ga(1890));this.mc(2,Pd.a.instance.Xa(447))};m.prototype.i0i=function(){this.$.ea.xlc=!1};m.prototype.jvi=function(Mb){var cc=
{};cc.a=this.$.ya.UserSessionId;cc.b="NamedSheetViewTeachingDialogClose";cc.c=Mb;cc.e=!0;this.stopwatch&&(this.stopwatch.stop(),cc.d=this.stopwatch.qc);h.b().De(53,cc,!0)};Af.Object.defineProperties(m.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"ShowNamedSheetViewTeachingDialog"}}});Object(ab.a)(m,"NamedSheetViewTeachingDialog",Se.a,[]);var Tb=b(163);l.prototype.FAa=function(){if(this.Cxj()){if(Qd.EwaSettings.ma(582)){this.$.va.pa.Md.CQd=!0;var Mb=new Ze.a;this.$.Ka.Kb(new pe.a(-2050946363,
lf.a.Cb,2,0,null)).continueWith(function(cc){Mb.setResult(!he.a(cc)&&cc.result)});return Mb.task}return(new m(this.$)).sg()}return db.Task.Ua(!0)};l.prototype.Cxj=function(){var Mb=this.$.va.pa;return this.$.ea.Q8a&&this.$.ea.xlc&&!Mb.Md.Wx&&this.$.ea.qM&&!Tb.f(this.$)};Object(ab.a)(l,"NamedSheetViewPublic",null,[826]);var yc=Pc.a;Rk(k,yc);k.prototype.create=function(){this.pb(this.$.da.za(309)||new l(this.$))};k.ka=function(Mb){Mb.da.Ga(310,new k(Mb))};Object(ab.a)(k,"NamedSheetViewPublicFactory",
Pc.a,[]);var vc=b(7),yd=b(202),Dd=b(1536),qd=b(1070),xe=b(628);Object(ab.a)(e,"NamedSheetViewTeachingCalloutContent",null,[]);Af.Object.defineProperties(d.prototype,{W7f:{configurable:!0,enumerable:!0,get:function(){return this.jhe}},W1i:{configurable:!0,enumerable:!0,get:function(){return this.W7f<this.Y7f.count?this.Y7f.na(this.jhe++):null}}});Object(ab.a)(d,"NamedSheetViewTeachingCalloutList",null,[]);var Ge=b(1281);c.prototype.K9h=function(Mb){var cc=this;this.X7f=Mb;var Uc=Object(vc.a)(new yd.a,
{});c.vhi(Mb)?(Uc.add(new e(Pd.a.instance.Xa(436),Pd.a.instance.Xa(437),Pd.a.instance.ga(1918),function(){cc.KH(2,"Continue");cc.BJ(!0)},Pd.a.instance.ga(1919),function(){cc.BJ();cc.KH(1,"ExitGuide")},Ge.a())),1===Mb&&Uc.add(new e(Pd.a.instance.ga(1920),Pd.a.instance.Xa(439),Pd.a.instance.ga(1918),function(){cc.KH(2,"FirstEnterTempViewContinueSecond");cc.BJ(!0)},Pd.a.instance.ga(1919),function(){cc.BJ();cc.KH(1,"FirstEnterTempViewExitGuideSecond")},Ge.a())),Uc.add(new e(Pd.a.instance.Xa(440),Pd.a.instance.Xa(441),
Pd.a.instance.ga(1918),function(){cc.KH(2,"FirstEnterExitCalloutContinue");cc.BJ(!0)},Pd.a.instance.ga(1919),function(){cc.BJ();cc.KH(1,"FirstEnterExitCalloutGuide")},c.m_e())),Uc.add(new e(Pd.a.instance.ga(1921),Pd.a.instance.Xa(438),Pd.a.instance.ga(1922),function(){cc.b3f();cc.BJ();cc.KH(1,"LearnMore")},Pd.a.instance.ga(1923),function(){cc.BJ();cc.KH(1,"Done")},c.l_e()))):2===Mb?Uc.add(new e(Pd.a.instance.ga(1920),Pd.a.instance.Xa(439),Pd.a.instance.ga(1917),function(){cc.BJ();cc.KH(1,"EnterTempViewAfterPersistedView")},
null,null,Ge.a())):3===Mb&&(Uc.add(new e(Pd.a.instance.Xa(436),Pd.a.instance.ga(1929),Pd.a.instance.ga(1918),function(){cc.KH(2,"AutoOptInExitCalloutContinue");cc.BJ(!0)},Pd.a.instance.ga(1919),function(){cc.BJ();cc.KH(1,"AutoOptInExitGuide")},c.m_e())),Uc.add(new e(Pd.a.instance.ga(1920),Pd.a.instance.Xa(439),Pd.a.instance.ga(1918),function(){cc.KH(2,"Continue");cc.BJ(!0)},Pd.a.instance.ga(1919),function(){cc.BJ();cc.KH(1,"ExitGuide")},Ge.a())),Uc.add(new e(Pd.a.instance.ga(1921),Pd.a.instance.Xa(438),
Pd.a.instance.ga(1922),function(){cc.b3f();cc.BJ();cc.KH(1,"LearnMore")},Pd.a.instance.ga(1923),function(){cc.BJ();cc.KH(1,"Done")},c.l_e())));this.zUd=new d(Uc)};c.prototype.b3f=function(){var Mb=new pe.a(-859308420,lf.a.Cb,this.$.Jc,9,null),cc={};cc=(cc[lf.a.Vf]="HelpID=SheetViews",cc.InputMethod=lf.a.Cb,cc[lf.a.Nc]=Wd.a.JQ,cc.ShouldCanvasTakeFocus=!0,cc);this.$.Ka.Kb(Mb,cc)};c.prototype.show=function(Mb){this.K9h(Mb);this.hdb()};c.prototype.nrj=function(Mb){this.g_b=Mb};c.prototype.hdb=function(){var Mb=
this,cc=this.zUd.W1i;if(cc){var Uc=Object(vc.a)(new Dd.a,{label:cc.t0i,onExecute:cc.primaryButtonAction}),Rb=null;cc.fWf&&(Rb=Object(vc.a)(new Dd.a,{label:cc.fWf,onExecute:cc.secondaryButtonAction}));cc=Object(vc.a)(new qd.a,{target:cc.targetObject,content:cc.body,title:cc.title,showCloseIcon:!0,primaryButtonProps:Uc,secondaryButtonProps:Rb,useTeachingStyles:!0});cc=this.g_b.callout(cc);Uc=Object(vc.a)(new xe.a,{onShow:function(){Mb.KH(0)}});this.vzc=this.g_b.addNotification(cc,Uc);this.pWc||(this.$.Zpd=
!0)}};c.prototype.dismiss=function(){this.BJ();this.KH(1,"DismissedByOthers")};c.prototype.BJ=function(Mb){Mb=void 0===Mb?!1:Mb;this.vzc&&(this.pWc||(this.$.Zpd=!1),this.g_b.removeNotification(this.vzc),this.vzc=null);Mb&&this.hdb()};c.prototype.KH=function(Mb,cc){var Uc={};Uc.a=this.$.ya.UserSessionId;Uc.b=this.X7f;Uc.c=this.zUd.W7f;Uc.d=Mb;Uc.e=void 0===cc?null:cc;0===Mb?this.stopwatch=this.$.Fb.sc("UserAction","ShowNamedSheetViewTeachingCallout"):(this.stopwatch&&(this.stopwatch.stop(),Uc.f=this.stopwatch.qc,
this.stopwatch=null),2===Mb&&(this.stopwatch=this.$.Fb.sc("UserAction","ShowNamedSheetViewTeachingCalloutNext")));h.b().De(52,Uc,!0)};c.l_e=function(){return document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv")};c.m_e=function(){return document.querySelector("[data-unique-id=Ribbon-NamedSheetViewExit]")};c.vhi=function(Mb){return 0===Mb||1===Mb};Object(ab.a)(c,"NamedSheetViewTeachingCallout",null,[825]);var Xe=Pc.a;Rk(a,Xe);a.prototype.create=function(){var Mb=this.$.da.za(322);Mb||
(Mb=new c(this.$),Qd.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC")&&this.$.da.Ga(322,Mb));this.pb(Mb)};a.ka=function(Mb){Mb.da.Ga(323,new a(Mb))};Object(ab.a)(a,"NamedSheetViewTeachingCalloutFactory",Pc.a,[]);var Bb=b(1453),zc=b(1348);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.BusinessBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.HyperLink");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.MsForm");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PresentMode");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Print");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Resize");Type.registerNamespace("_Ewa");Object(ta.a)();Type.registerNamespace("CADWLTR");xa.main();Type.registerNamespace("Common.App.NewAndOpen.UX");Na.a.instance.Ui(new qa);Object(wc.a)();Type.registerNamespace("Common");Type.registerNamespace("Common.App.OpenInClient");Object(nb.a)();Object(zb.a)();Object(ma.a)();Object(P.a)();Object(oa.a)();Type.registerNamespace("Common.App.WildFire");
Y.main();Object(pa.a)();Da.a.Fa(ea.ka);Object(Aa.a)();Object(Ya.a)();Object(kb.a)();lb.a.vi(".MsformCalloutContent{color:#fff;font-size:13pt;line-height:1;padding-right:5px;margin-bottom:12px;margin-top:-6px;padding-left:10px;width:90%}.MsFormCalloutOuter{background-color:#107c41;z-index:1030}");(function(){Da.a.Fa(function(Mb){N.ka(Mb)})})();(function(){Da.a.Fa(function(Mb){Mb.da.Ga(165,new O(Mb))})})();Da.a.Fa(K.ka);Object(Fb.a)();Object(pc.a)();Object(eb.a)();Object(ic.a)();Object(Ac.a)();Object(lc.a)();
Object(Gc.a)();Object(ed.a)();Object(fd.a)();Object(Bc.a)();Da.a.Fa(E.ka);Da.a.Fa(z.ka);Object(ge.a)();Da.a.Fa(w.ka);(function(){Da.a.Fa(function(Mb){k.ka(Mb);a.ka(Mb)})})();Object(Bb.a)();Object(zc.a)()},918:function(u,D,b){function a(M,T){var F=U.call(this,document.createElement("div"))||this;F.wx=null;F.zS=null;F.i8=null;F.Sba=null;F.w2b=null;F.fje=null;F.Poe=null;F.Sjf=null;F.R4a=!1;F.Pu=!1;F.CZ=!1;F.Dva=!1;F.JHi=function(K){F.UC(K)};F.PHi=function(K){13===K.keyCode&&F.UC(K)};F.lyd=function(K){F.ro(K.mb);
return!0};F.tyd=function(K){F.C_(K.mb);return!0};F.onc=function(K){F.Ula(K.mb?K.mb:0);return!0};F.KHi=function(K){F.UC(K.Ca);return!0};F.Qig=function(K){K=void 0===K?null:K;F.ro(K.inputMethod?K.inputMethod:0);return!0};F.Rig=function(K){K=void 0===K?null:K;F.C_(K.inputMethod?K.inputMethod:0);return!0};F.f1=M;F.zC=T;F.kXc=T.sGa.toString();F.title=T.title;F.message=T.message;F.set_visibilityMode(1);return F}b.d(D,"a",function(){return a});u=b(0);var c=b(7),d=b(15),e=b(90),k=b(233),l=b(13),m=b(109),
f=b(204),w=b(86);D=b(244);var n=b(1264),z=b(18),r=b(5),v=b(335),A=b(53),B=b(12),y=b(69),x=b(14),C=b(21),G=b(98),E=b(1108),I=b(1),U=D.a;Rk(a,U);a.prototype.dispose=function(){e.a.oc([this.w2b,this.zS,this.i8]);this.Pu&&this.zS&&(k.a.instance.Aa(l.a.click,this.zS.domElement,this.lyd),m.KeyInputManager.instance.sv(this.domElement,this.fje));this.CZ&&this.i8&&(k.a.instance.Aa(l.a.click,this.i8.domElement,this.tyd),m.KeyInputManager.instance.sv(this.domElement,this.Poe));this.Dva&&this.Sba&&(k.a.instance.Aa(l.a.click,
this.Sba,this.onc),m.KeyInputManager.instance.sv(this.domElement,this.Sjf));this.Sba=this.wx=this.f1=this.i8=this.zS=null;U.prototype.dispose.call(this)};a.prototype.update=function(){};a.prototype.lQj=function(){this.IDe(!0)};a.prototype.G2c=function(){this.IDe(!1)};a.prototype.W8g=function(){var M=this;this.message=G.a.rh(this.message);this.title=G.a.rh(this.title);f.UISurfaces.zed().then(function(T){T.initializeMessageBarInStore();var F=Object(c.a)(new E.a,{messageTitle:M.title,message:M.message,
isMultiline:!1,messageBarType:M.zC.cSg,closeable:!M.R4a,dismissButtonAriaLabel:x.a.instance.ga(10),onDismiss:M.KHi});if(M.Dva){var K={};F.linkProps=(K.type="AppLinkProps",K.text=M.linkText,K.onExecute=M.onc,K)}M.Pu&&(K={},F.firstActionButtonProps=(K.type="AppButtonProps",K.label=M.actionButton,K.onExecute=M.Qig,K));M.CZ&&(K={},F.secondActionButtonProps=(K.type="AppButtonProps",K.label=M.WFa,K.onExecute=M.Rig,K));T.createNewMessageBar(M.domElement,F);return null},function(T){d.ULS.sendTraceTag(524075914,
0,10,"Business Bar could not be initialized",T);return null});this.domElement.tabIndex=0;this.businessBar.domElement.appendChild(this.domElement)};a.prototype.JDe=function(M){var T="<div class='"+n.a.rmh+"' id='{0}'><div class='"+n.a.pmh+"'><a class='"+n.a.xmh+"' title='{1}'><span class='"+z.a.u2b+" "+n.a.tmh+"' id='{2}'>";this.Kk.length&&(T+="<img class='{3}' src='{4}'/>");T+="</span></a><span class='"+n.a.wmh+"' id='{5}'>{6}</span><span class='"+n.a.vmh+"' id='message'>{7}</span><a id='link' href='#' class='"+
n.a.umh+"'>{8}</a><span class='"+n.a.WLe+"'><button type='button' id='action' class='"+n.a.VLe+"'>{9}</button></span><span class='"+n.a.WLe+"'><button type='button' id='altAction' class='"+n.a.VLe+"'>{10}</button></span></div><a class='"+n.a.smh+"' tabindex='0' role='button'><span id='close' class='"+z.a.RA+"'><img class='"+z.a.$8c+"' src='{11}' alt='{12}' title='{12}' role='button'/></span></a></div>";M||(this.domElement.tabIndex=0,this.businessBar.domElement.appendChild(this.domElement));var F=
this.businessBar.$.yb;M=F+"ewaBusinessBarEntryBody"+this.kXc;var K=F+"ewaBusinessBarEntryTitle"+this.kXc;F=F+"ewaBusinessBarEntryIcon"+this.kXc;this.domElement.className=n.a.qmh;this.domElement.innerHTML=String.format(T,M,this.alt,F,this.Kk,A.a.Te(0),K,this.title,this.message,this.linkText,this.actionButton,this.WFa,A.a.Te(13),x.a.instance.ga(792));B.DOMElementExtensions.ju(this.domElement,r.a.Sra,K,M);this.Sba=$get("link",this.domElement);B.DOMElementExtensions.setVisible(this.Sba,this.Dva);this.Dva&&
(k.a.instance.qa(l.a.click,this.Sba,this.onc),this.Sjf=m.KeyInputManager.instance.Zr(this.Sba,this.onc,w.a.Rh,w.a.X0));this.zS=new v.a(B.DOMElementExtensions.getElementById(this.domElement,"action"));this.zS.isVisible=this.Pu;this.i8=new v.a(B.DOMElementExtensions.getElementById(this.domElement,"altAction"));this.i8.isVisible=this.CZ;this.Pu&&(k.a.instance.qa(l.a.click,this.zS.domElement,this.lyd),this.fje=m.KeyInputManager.instance.Zr(this.zS.domElement,this.lyd,w.a.Rh,w.a.X0),this.CZ&&(k.a.instance.qa(l.a.click,
this.i8.domElement,this.tyd),this.Poe=m.KeyInputManager.instance.Zr(this.zS.domElement,this.tyd,w.a.Rh,w.a.X0)));this.wx=$get("close",this.domElement);this.w2b=this.ke.Td(this.wx);this.w2b.ka("click",this.JHi);this.w2b.ka("keydown",this.PHi);B.DOMElementExtensions.setVisible(this.wx,!this.R4a)};a.prototype.IDe=function(M){64==this.zC.sGa?this.JDe(M):I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.W8g():this.JDe(M)};a.prototype.ro=function(){d.ULS.sendTraceTag(21517968,
0,50,"BusinessBar [{0}]: BusinessBarEntry.OnActionClick() for EntryName {1}",this.zC.hash,this.zC.V7c);C.g(this.businessBar.$).Ao(!0)};a.prototype.C_=function(){d.ULS.sendTraceTag(537170257,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnAltActionClick()",this.zC.hash);C.g(this.businessBar.$).Ao(!0)};a.prototype.Ula=function(){d.ULS.sendTraceTag(537170256,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnLinkClick()",this.zC.hash);C.g(this.businessBar.$).Ao(!0)};a.prototype.UC=function(M){d.ULS.sendTraceTag(21517971,
0,50,"BusinessBar [{0}]: BusinessBarEntry.OnCloseClick() for EntryName {1}",this.zC.hash,this.zC.V7c);this.set_visible(!1);this.businessBar.removeEntry(this.dSg);y.g(M)};Af.Object.defineProperties(a.prototype,{dSg:{configurable:!0,enumerable:!0,get:function(){return this.zC.sGa}},businessBar:{configurable:!0,enumerable:!0,get:function(){return this.f1}},actionButton:{configurable:!0,enumerable:!0,get:function(){return this.zC?this.zC.actionButton:""}},WFa:{configurable:!0,enumerable:!0,get:function(){return this.zC?
this.zC.WFa:""}},linkText:{configurable:!0,enumerable:!0,get:function(){return this.zC?this.zC.link:""}},Kk:{configurable:!0,enumerable:!0,get:function(){return this.zC?this.zC.Kk:""}},alt:{configurable:!0,enumerable:!0,get:function(){return this.zC?this.zC.alt:""}}});Object(u.a)(a,"BusinessBarEntry",D.a,[])},994:function(u,D,b){function a(O,N,H,Q){var ca=J.call(this)||this;ca.xF=null;ca.iD=null;ca.eW=null;ca.Aw=null;ca.rGb=null;ca.xK=null;ca.Ejc=null;ca.yBb=null;ca.xBb=!1;ca.wwa=!0;ca.spc=null;ca.ewaAccessibilityManager=
null;ca.xEd=null;ca.wEd=null;ca.AEd=null;ca.Rmd=!1;ca.Sxf=function(){n.ULS.sendTraceTag(537154206,0,50,"PrintPreviewPane:OnIframeContentChange API invoked with loadPdfCalled: {0}",ca.xBb);ca.xBb&&(ca.n6h(),ca.xK.style.visibility="visible",ca.Ejc?ca.Ejc.stop():n.ULS.sendTraceTag(537154205,0,10,"PrintPreviewPane:OnIframeContentChange - loadPdfStopwatchForIframe is null."),ca.raiseEvent(a.kDb,new f(1)),ca.UNd(),ca.xBb=!1)};ca.$=O;ca.hD=N;ca.I8g();ca.useMSPdfViewer=H;ca.isUniversalPrintEnabled=Q;return ca}
function c(){this.msPdfViewerFileUrl=null;this.useMSPdfViewer=!1;this.onPdfLoad=null}function d(){this.logger=this.printSettingsTaskPaneCallbacks=this.selectedPrintSettingsValues=this.colorOptions=this.marginDetailedOptions=this.marginOptions=this.scalingOptions=this.paperSizeOptions=this.orientationOptions=this.whatToPrintOptions=null;this.isViewMode=this.shouldDisableCurrentSelection=!1;this.dataCultureTag=this.isMetricMeasurementUnit=this.isUniversalPrintFlowEnabled=null}function e(){this.msPdfKitWasmUrl=
this.msPdfKitJSUrl=this.pdfViewerWorkerUrl=null}function k(O){this.lg=O}function l(O){this.lg=O}function m(O){this.lg=O}function f(O){var N=E.call(this)||this;N.B0i=O;return N}b.r(D);u=b(0);var w=b(7),n=b(15),z=b(4);b(25);var r=b(411),v=b(38),A=b(51),B=b(12),y=b(130),x=b(1),C=b(14),G=b(21),E=Sys.EventArgs;Rk(f,E);Object(u.a)(f,"PrintPreviewPaneOperationStatusEventArgs",Sys.EventArgs,[]);var I=b(273),U=b(256);m.prototype.Oh=function(){I.a(this.lg.$).FM(this.Zd)||I.a(this.lg.$).Oh(this)};m.prototype.Q7=
function(){I.a(this.lg.$).FM(this.Zd)&&I.a(this.lg.$).Gz(this)};m.prototype.$g=function(O){return B.DOMElementExtensions.nf(this.jc,O)};m.prototype.hj=function(){this.lg.$.frame.ye.Jj(this.lg.$.frame.ye.zE)};m.prototype.Dj=function(){};m.prototype.Uf=function(O,N){return N?!1:(this.lg.enterPrintPreviewHeaderFocusTrapZone(),!0)};Af.Object.defineProperties(m.prototype,{Zd:{configurable:!0,enumerable:!0,get:function(){return U.a.gIf}},jc:{configurable:!0,enumerable:!0,get:function(){var O=b(994).PrintPreviewPane;
return document.getElementById(O.z0i)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(u.a)(m,"PrintPreviewHeaderKeyboardAccessibleSection",null,[422]);l.prototype.Oh=function(){I.a(this.lg.$).FM(this.Zd)||I.a(this.lg.$).Oh(this)};l.prototype.Q7=function(){I.a(this.lg.$).FM(this.Zd)&&I.a(this.lg.$).Gz(this)};l.prototype.$g=function(O){return B.DOMElementExtensions.nf(this.jc,O)};l.prototype.hj=function(){this.lg.$.frame.ye.Jj(this.lg.$.frame.ye.zE)};l.prototype.Dj=
function(){};l.prototype.Uf=function(O,N){return N?!1:(this.lg.useMSPdfViewer?(O=document.getElementById(b(994).PrintPreviewPane.tCd))&&B.DOMElementExtensions.setFocus(O,!0):B.DOMElementExtensions.setFocus(this.lg.xK),!0)};Af.Object.defineProperties(l.prototype,{Zd:{configurable:!0,enumerable:!0,get:function(){return U.a.hIf}},jc:{configurable:!0,enumerable:!0,get:function(){var O=b(994).PrintPreviewPane;return this.lg.useMSPdfViewer?document.getElementById(b(994).PrintPreviewPane.tCd):document.getElementById(O.AFf)}},
canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(u.a)(l,"PrintPreviewKeyboardAccessibleSection",null,[422]);k.prototype.Oh=function(){I.a(this.lg.$).FM(this.Zd)||I.a(this.lg.$).Oh(this)};k.prototype.Q7=function(){I.a(this.lg.$).FM(this.Zd)&&I.a(this.lg.$).Gz(this)};k.prototype.$g=function(O){return B.DOMElementExtensions.nf(this.jc,O)};k.prototype.hj=function(){this.lg.$.frame.ye.Jj(this.lg.$.frame.ye.zE)};k.prototype.Dj=function(){};k.prototype.Uf=function(O,N){return N?
!1:(this.lg.enterPrintSettingsTaskPaneFocusTrapZone(),!0)};Af.Object.defineProperties(k.prototype,{Zd:{configurable:!0,enumerable:!0,get:function(){return U.a.kIf}},jc:{configurable:!0,enumerable:!0,get:function(){var O=b(994).PrintPreviewPane;return document.getElementById(O.zEd)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(u.a)(k,"PrintSettingsTaskPaneKeyboardAccessibleSection",null,[422]);Object(u.a)(e,"MSPdfViewerFileUrl",null,[]);Object(u.a)(d,"PrintSettingsTaskPaneProps",
null,[]);Object(u.a)(c,"ViewerPaneProps",null,[]);var M=b(1284),T=b(398),F=b(5),K=b(1285);b.d(D,"PrintPreviewPane",function(){return a});var J=v.a;Rk(a,J);a.prototype.IFg=function(O){this.addHandler(a.kDb,O)};a.prototype.Qbj=function(O){this.removeHandler(a.kDb,O)};a.prototype.LAj=function(){this.D8g()};a.prototype.MAj=function(){var O=this.$.Fb.sc("UserAction","createSettingsPaneStopwatch"),N=document.getElementById(a.zEd);this.J8g();var H=this.K8g();this.iD.createPrintSettingsTaskPane(N,H);O.stop();
this.xBb=!1;if(this.isUniversalPrintEnabled&&this.Aw){O="A4";switch(H.selectedPrintSettingsValues.selectedPaperSize){case 8:O="A3";break;case 9:O="A4";break;case 11:O="A5";break;case 12:O="JIS B4";break;case 13:O="JIS B5";break;case 5:O="North America Legal";break;case 1:O="North America Letter";break;case 6:O="North America Invoice";break;case 7:O="North America Executive";break;case 3:O="North America Ledger"}this.xF.setDocumentSettings({mediaSize:O,orientation:2===H.selectedPrintSettingsValues.selectedOrientation?
"landscape":"portrait",colorMode:1===H.selectedPrintSettingsValues.selectedColor?"color":"blackAndWhite"})}this.jHd()};a.prototype.setPageRangeSettings=function(O,N,H,Q,ca){this.iD&&(this.iD.setPageRangeSettings(O,N,H,Q,ca),this.KZf(String.format(C.a.instance.lb(200),Q,ca,O)))};a.prototype.d6h=function(){this.Aw&&(this.Aw.style.display="none")};a.prototype.sgh=function(){this.dispose();this.iXd();this.dOj();this.xF&&this.xF.closePrintPreviewPane();this.eW=this.iD=this.xF=this.Aw=null};a.prototype.Psi=
function(O){n.ULS.sendTraceTag(575534018,0,50,"PrintPreviewPane: LoadPdf invoked.");this.hidePreviewError();this.useMSPdfViewer?((this.yBb=this.$.Fb.sc("UserAction","pdfLoadTimeStopwatchForMsPdfViewer"))||n.ULS.sendTraceTag(537154210,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForMsPdfViewer is null."),this.eW.renderPdf(O)):this.xK&&((this.Ejc=this.$.Fb.sc("UserAction","loadPdfStopwatch"))||n.ULS.sendTraceTag(537154209,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForIframe is null."),this.xBb=
!0,this.xK.src&&this.xK.src===O?this.Sxf(null):this.xK.src=O);if(this.isUniversalPrintEnabled&&this.Aw){var N=T.b(this.$.workbookContext);this.xF.setFileUrl(O,N)}};a.prototype.onPdfLoad=function(){this.yBb?(n.ULS.sendTraceTag(537154208,0,50,"PrintPreviewPane:onPdfLoad - Rendering time : {0} ms, isFirstTimeLoad: {1}",this.yBb.qc,this.wwa),this.yBb.stop()):n.ULS.sendTraceTag(537154207,0,10,"PrintPreviewPane:onPdfLoad - loadPdfStopwatchForMsPdfViewer is null.");this.raiseEvent(a.kDb,new f(1));this.hideWaitCursor();
this.UNd()};a.prototype.printPdf=function(){B.DOMElementExtensions.setFocus(this.xK);this.xK.contentWindow.print()};a.prototype.BBj=function(){this.showSpinner();this.showWaitCursor();this.KZf("")};a.prototype.n6h=function(){this.hideSpinner();this.hideWaitCursor()};a.prototype.Oz=function(O,N,H){this.Aw&&this.eW&&(this.Rmd=!1,this.eW.showErrorDetails(N,O,void 0===H?null:H),this.hD.M5a=!0,this.xK&&(this.xK.src=""),this.disablePrintButton(),this.hideWaitCursor(),a.oki(N)&&(this.Rmd=!0,this.xPi()))};
a.prototype.hidePreviewError=function(){this.hD.M5a=!1;this.eW.hidePreviewError();this.enablePrintButton()};a.prototype.jgh=function(){(this.rGb=document.getElementById(a.iIf))&&this.rGb.parentNode&&this.rGb.parentNode.removeChild(this.rGb)};a.prototype.hideErrorMessageForPrintOptions=function(){this.iD&&this.iD.hideErrorMessageForPrintOptions()};a.prototype.showErrorMessageForPrintOptions=function(O){this.iD&&this.iD.showErrorMessageForPrintOptions(O)};a.prototype.showSpinner=function(){this.hD.M5a||
x.EwaSettings.isChangeGateEnabled("OfficeVSO:5547045_ShowLoadingIconOnSettingsChange")&&this.Rmd?this.hidePreviewError():this.xK&&(this.xK.style.visibility="hidden");this.eW&&this.eW.showSpinner()};a.prototype.hideSpinner=function(){this.eW&&this.eW.hideSpinner()};a.prototype.enablePrintButton=function(){this.iD&&this.iD.enablePrintButton();this.isUniversalPrintEnabled&&this.Aw&&this.xF.updatePrintButtonEnableDisableState(!0)};a.prototype.disablePrintButton=function(){this.iD&&this.iD.disablePrintButton();
this.isUniversalPrintEnabled&&this.Aw&&this.xF.updatePrintButtonEnableDisableState(!1)};a.prototype.showWaitCursor=function(){this.iD&&this.iD.showWaitCursor();this.isUniversalPrintEnabled&&this.Aw&&this.xF.updatePrintButtonEnableDisableState(!1)};a.prototype.hideWaitCursor=function(){this.iD&&this.iD.hideWaitCursor();this.isUniversalPrintEnabled&&this.Aw&&this.xF.updatePrintButtonEnableDisableState(!0)};a.prototype.G8g=function(){if(this.Aw)n.ULS.sendTraceTag(591927430,0,10,"PrintPreviewerPane:CreatePrintPreviewerContainer - printPreviewerContainer should be null");
else if(this.Aw=document.createElement("div"),this.Aw.id=a.iIf,this.Aw.classList.add(a.C0i),this.$.Wq.insertBefore(this.Aw,this.$.Wq.firstChild),z.AFrameworkApplication.ta&&z.AFrameworkApplication.ta.Pa.Pf){var O=document.getElementById(F.a.$Fa);O&&(this.Aw.style.top=O.clientHeight+"px",this.Aw.style.height="calc(100% - "+O.clientHeight+"px)")}};a.prototype.enterPrintPreviewHeaderFocusTrapZone=function(){this.xF.enterPrintPreviewHeaderFocusTrapZone()};a.prototype.enterPrintSettingsTaskPaneFocusTrapZone=
function(){this.xF.enterPrintSettingsTaskPaneFocusTrapZone()};a.prototype.mZi=function(){var O=this;this.$.da.Za(15,function(N){O.ewaAccessibilityManager=N;O.ewaAccessibilityManager.mode=3})};a.prototype.I8g=function(){this.AEd=new k(this);this.xEd=new l(this);this.wEd=new m(this)};a.prototype.jHd=function(){this.AEd.Oh();this.xEd.Oh();this.wEd.Oh();this.mZi()};a.prototype.iXd=function(){this.AEd.Q7();this.xEd.Q7();this.wEd.Q7();G.g(this.$).t0();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=
0)};a.prototype.SN=function(){this.spc=y.a.instance.Td(this.xK);this.spc.ka("load",this.Sxf)};a.prototype.dOj=function(){this.spc&&this.xK&&this.spc.detach("load")};a.prototype.UNd=function(){this.isUniversalPrintEnabled?this.PYf(a.A0i,a.bDi):this.PYf(a.zEd,a.cIf)};a.prototype.PYf=function(O,N){this.wwa&&(O=document.getElementById(O))&&(N=B.DOMElementExtensions.getElementById(O,N))&&(this.wwa=!1,N.focus())};a.prototype.xPi=function(){this.hD.M5a=!1;this.enablePrintButton();this.UNd()};a.prototype.D8g=
function(){var O=this;if(x.EwaSettings.isChangeGateEnabled("OfficeVSO:6068952_FixJSCrahInPrintPreview")){var N=A.GetServiceTaskFactory.Ra(this.$.da,283,284,0).result.tn;N.loadScript("excel-print-preview-sprite").then(function(){N.loadScript("printPreviewer").then(function(){N.loadScript("excelPrintPreviewer").then(function(){O.RDe()})},function(){n.ULS.sendTraceTag(525358669,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load printPreviewer script required for excelPrintPreviewer.")})},function(){n.ULS.sendTraceTag(525358668,
0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load excelPrintPreviewSprite script required for excelPrintPreviewer.")})}else A.GetServiceTaskFactory.Ra(this.$.da,283,284,0).result.tn.loadScript("excelPrintPreviewer").then(function(){O.RDe()})};a.prototype.RDe=function(){var O=this,N=this.$.Fb.sc("UserAction","createEmptyPreviewerStopwatch");this.G8g();this.H8g();this.isUniversalPrintEnabled?this.xF.createEmptyPrintPreviewPaneAsync(this.Aw,this.QDe()).then(function(){N.stop();O.yAe();O.xF.updatePrintButtonEnableDisableState(!1)}):
(this.xF.createEmptyPrintPreviewPane(this.Aw,this.QDe()),N.stop(),this.yAe())};a.prototype.yAe=function(){var O=this.$.Fb.sc("UserAction","createPdfPreviewPaneStopwatch"),N=document.getElementById(a.tCd);this.useMSPdfViewer&&(N.tabIndex=0);this.q8g();this.p8g(N);O.stop();this.raiseEvent(a.kDb,new f(0))};a.prototype.H8g=function(){this.xF||(this.xF=printPreviewer.PrintPreviewPaneControllerFactoryGlobal.createPrintPreviewPaneController());this.xF||n.ULS.sendTraceTag(537154203,0,10,"PrintPreviewerPane:CreatePrintPreviewerController - printPreviewerController should not be null")};
a.prototype.J8g=function(){this.iD||(this.iD=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintSettingsTaskPaneController());this.iD||n.ULS.sendTraceTag(537154202,0,10,"PrintPreviewerPane:CreatePrintSettingsPaneController - printSettingsPaneController should not be null")};a.prototype.q8g=function(){this.eW||(this.eW=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintPreviewController());this.eW||n.ULS.sendTraceTag(537154201,0,10,"PrintPreviewerPane:CreatePdfPreviewPaneController - pdfPreviewerPaneController should not be null")};
a.prototype.p8g=function(O){this.eW.createPrintPreviewPane(O,this.U$g());this.useMSPdfViewer||(this.xK=B.DOMElementExtensions.getElementById(this.Aw,a.AFf),this.xK.title=C.a.instance.ga(1193),this.SN())};a.prototype.K8g=function(){var O="en-US";var N=this.$.ya.IsMetricMeasurementUnit;this.$.ya.DataCultureTag?O=this.$.ya.DataCultureTag:n.ULS.sendTraceTag(536994563,0,50,"PrintPreviewerPane:createPrintSettingsProps - DataCultureTag in ewaControl.bootstrapContext is nullable");return Object(w.a)(new d,
{whatToPrintOptions:this.hD.av.whatToPrintOptions,orientationOptions:this.hD.av.orientationOptions,paperSizeOptions:this.hD.av.paperSizeOptions,scalingOptions:this.hD.av.scalingOptions,marginDetailedOptions:this.hD.xRh(),selectedPrintSettingsValues:this.hD.tUh(),printSettingsTaskPaneCallbacks:this.hD.rUh(),logger:new r.a,shouldDisableCurrentSelection:this.hD.Jwc(),isViewMode:!this.$.isEditMode,isMetricMeasurementUnit:N,dataCultureTag:O,isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled})};a.prototype.QDe=
function(){return this.isUniversalPrintEnabled?this.hD.pUh():Object(w.a)(new M.a,{backActionButtonText:C.a.instance.ga(1191),printPreviewPaneCallbacks:this.hD.r0e(),logger:new r.a,disableTellMeControl:!0})};a.prototype.U$g=function(){var O=this;return this.useMSPdfViewer?Object(w.a)(new c,{useMSPdfViewer:!0,msPdfViewerFileUrl:this.E7g(),onPdfLoad:function(){O.onPdfLoad()}}):Object(w.a)(new c,{useMSPdfViewer:!1})};a.prototype.E7g=function(){return Object(w.a)(new e,{pdfViewerWorkerUrl:this.$.ya.PrintPreviewerPdfViewerWorkerUrl,
msPdfKitJSUrl:this.$.ya.PrintPreviewerMSPdfKitJsUrl,msPdfKitWasmUrl:this.$.ya.PrintPreviewerMSPdfKitWasmUrl})};a.prototype.KZf=function(O){this.Aw&&this.xF.setAdditionalHeaderText(O)};a.oki=function(O){return 3===O||2===O};a.iIf="PrintPreviewerContainer";a.zEd="printSettingsTaskPaneId";a.tCd="previewId";a.AFf="printpreviewiframe";a.z0i="printPreviewHeaderId";a.cIf="printButton";a.A0i="printPreviewPaneId";a.bDi="printButtonId";a.C0i=K.a.Aw;a.kDb="pppnosu";Object(u.a)(a,"PrintPreviewPane",v.a,[760])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.kmhv.js.map/e0e9f0f9c59bb7908ed7e86c8d6a6891/EwaDS.kmhv.js.map