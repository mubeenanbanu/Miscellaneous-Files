(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[31],{1404:function(u,D,b){function a(){Type.registerNamespace("Common.App.SaveStatus");y.a.instance.Ui(new c)}function c(){this.VPc=this.UOc=this.dlb=this.fb=null}function d(x,C,G,E){this.Ufa=this.Ofa=this.Yfa=this.Xfa=null;this.TDa=0;this.ND=this.UPc=this.kCa=this.FEc=this.REa=null;this.Ld=x;this.K8=C;this.r1=G;this.Yi=E;this.o8d=!0;this.BL=!1;this.bA=3;this.Xqa=!0}function e(x,C){this.Qr=null;this.Xfa=CommonUIStrings.l_SavedStatus;
this.Yfa=CommonUIStrings.l_SavingStatus;this.Ofa=CommonUIStrings.l_ReadOnlyStatus;this.Ufa=CommonUIStrings.l_ReviewModeStatus;this.ISb=C;this.r1=x;this.bA=3;this.Xqa=!0}function k(x){this.Ufa=this.Ofa=this.Yfa=this.Xfa=null;this.z6d=this.Q9d=this.Xw=this.BL=!1;this.fPc=this.e$d=null;this.X9d=0;this.ib=this.c$d=null;this.r1=x;this.bA=3;this.Oib=!0}u=b(0);var l=b(83),m=b(15),f=b(167),w=b(39);k.prototype.initialize=function(x,C,G){var E=this;this.Xfa=this.yfd(x,C);this.Yfa=CommonUIStrings.l_SavingStatus;
this.Ofa=CommonUIStrings.l_ReadOnlyStatus;this.Ufa=CommonUIStrings.l_ReviewModeStatus;this.r1&&this.r1.execute(function(I){I.LUc(Object(l.a)(E,E.hOb,"updateToSavingStatus"))});this.Xw=!0;this.ib=G;return!0};k.prototype.qea=function(x,C){this.BL=x;this.bA=C;this.qS(this.Oib)};k.prototype.qS=function(x){!this.Oib&&x&&(this.c$d=new Date);this.Oib=x;x=null;3===this.bA&&(x=this.Oib?this.Xfa:this.Yfa);this.Nfh(x)};k.prototype.yfd=function(x,C){return x?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):
C&&C.length?String.format(CommonUIStrings.l_SavedToStatus,C):CommonUIStrings.l_SavedStatus};k.prototype.hOb=function(){this.qS(!1)};k.prototype.KRh=function(){switch(this.bA){case 1:return this.Ofa;case 2:return this.Ufa;default:return null}};k.prototype.ygi=function(x){return this.Q9d===this.BL&&this.X9d===this.bA&&this.e$d===x};k.prototype.W5c=function(x){var C=this;appChrome.getHeaderApi().then(function(G){G.updateDocumentTitleStatus(C.BL,x,C.KRh(),C.c$d,C.Oib);C.z6d=!0;return null});this.fPc=
null};k.prototype.Nfh=function(x){var C=this;this.Xw&&f.c()&&!this.ygi(x)&&(!this.z6d&&this.ib.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.W5c(x):w.a.WRf()?(this.fPc&&m.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.fPc=window.requestIdleCallback(function(){C.W5c(x)})):window.requestAnimationFrame(function(){C.W5c(x)}),this.Q9d=this.BL,this.e$d=x,this.X9d=this.bA)};Object(u.a)(k,"ReactSaveStatusUIHandler",
null,[669]);var n=b(170);e.prototype.ev=function(){var x=this;this.r1&&this.r1.execute(function(C){C.LUc(Object(l.a)(x,x.hOb,"updateToSavingStatus"))});this.ISb.execute(function(C){x.Qr=C})};e.prototype.qea=function(x,C){this.bA=C;3===C?this.qS(this.Xqa):2===C?this.OWd(this.Ufa):this.OWd(this.Ofa)};e.prototype.hOb=function(){this.qS(!1)};e.prototype.qS=function(x){this.Xqa=x;this.OWd(this.Xqa?this.Xfa:this.Yfa)};e.prototype.OWd=function(x){this.Qr&&this.Qr.xj(n.a.VNj,this.w1g(x))};e.prototype.w1g=
function(x){var C={};C.StatusText=x;return C};Object(u.a)(e,"SaveStatusPostMessageHandler",null,[669]);var z=b(94),r=b(123),v=b(55);d.prototype.initialize=function(x,C){if(!this.Ld)return!1;this.Xfa=this.yfd(x,C);this.Yfa=CommonUIStrings.l_SavingStatus;this.Ofa=CommonUIStrings.l_ReadOnlyStatus;this.Ufa=CommonUIStrings.l_ReviewModeStatus;this.ev();return!0};d.prototype.yfd=function(x,C){return x?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):C&&C.length?String.format(CommonUIStrings.l_SavedToStatus,
C):CommonUIStrings.l_SavedStatus};d.prototype.ev=function(){var x=this;this.K8&&this.K8.execute(function(C){C.eGg(Object(l.a)(x,x.iEe,"createStatusAndModeElements"));C.WFg(Object(l.a)(x,x.Rzj,"showHideSaveStatusElement"));C.MKj&&x.iEe(null,null)});this.r1&&this.r1.execute(function(C){C.LUc(Object(l.a)(x,x.hOb,"updateToSavingStatus"))})};d.prototype.tv=function(){this.ND&&this.Ld&&this.Ld.fG(this.ND)};d.prototype.Rzj=function(x,C){this.qea("true"===C,this.bA)};d.prototype.qea=function(x,C){this.BL=
x;this.bA=C;this.FEc&&(this.FEc.style.display=this.BL||3===this.bA||!this.REa?"none":"");this.kCa&&(this.kCa.style.display=this.BL||3===this.bA?"none":"",this.kCa.innerText=1===this.bA?this.Ofa:this.Ufa,this.kCa.title=1===this.bA?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.UPc&&(this.UPc.style.display=this.BL||1===this.bA||!this.REa&&!this.kCa?"none":"");this.ND&&(this.ND.style.display=this.BL||1===this.bA?"none":"",this.qS(this.Xqa),this.ND.title=CommonUIStrings.l_SaveStatusTooltip)};
d.prototype.iEe=function(x,C){x=document.getElementById(z.CuiHelper.I6e);C&&C.iXj||!x||""===this.Xfa||""===this.Yfa||""===this.Ofa||""===this.Ufa||(this.REa=document.getElementById(z.CuiHelper.D0b),this.FEc=z.CuiHelper.Xsa(x,"BreadcrumbAppModeDash","-",null,!1),this.kCa=z.CuiHelper.Xsa(x,"BreadcrumbAppModeStatus",1===this.bA?this.Ofa:this.Ufa,null,!1),this.jcg(this.kCa),this.UPc=z.CuiHelper.Xsa(x,"BreadcrumbSaveStatusDash","-",null,!1),this.ND=z.CuiHelper.Xsa(x,"BreadcrumbSaveStatus",this.Xfa,null,
!1),this.jcg(this.ND),this.qea(this.BL,this.bA))};d.prototype.hOb=function(){this.qS(!1)};d.prototype.qS=function(x){this.Xqa=x;this.XSj(this.Xqa?this.Xfa:this.Yfa)};d.prototype.XSj=function(x){!this.ND||3!==this.bA&&2!==this.bA||(this.o8d&&!this.Xqa?(this.TDa=this.ND.offsetWidth<this.TDa?this.TDa:this.ND.offsetWidth,this.WPj(this.Yfa),this.o8d=!1):this.ND.innerText=x)};d.prototype.jcg=function(x){x.style.direction=this.Yi?"rtl":"ltr";x.style.width="auto";x.style.textAlign=this.Yi?"right":"left";
x.style.display=this.BL?"none":"";x.setAttribute("Unselectable","on")};d.prototype.WPj=function(x){this.ND&&(this.ND.style.width="",this.ND.innerText=x,this.TDa=this.ND.offsetWidth<this.TDa?this.TDa:this.ND.offsetWidth,x=r.a.aB(this.ND),this.ND.style.width=this.TDa-v.a.aD(x.paddingLeft)-v.a.aD(x.paddingRight)+1+"px")};Object(u.a)(d,"SaveStatusUIHandler",null,[669]);var A=b(4),B=b(93);c.prototype.Sh=function(x){var C=this;this.fb=x;A.AFrameworkApplication.fa.ra("PostMessageEmbedded")&&A.AFrameworkApplication.hideHeaderEmbedded?
this.fb.register(e,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").tc().Cc(function(){return new e(C.fb.Tb("Common.App.HostNotification.EditNotificationEventSource"),C.fb.Tb("Postmessage.IHostPostmessenger"))}):A.AFrameworkApplication.ta.Pa.Hgf||(A.AFrameworkApplication.ta.Pa.isReactSharedHeaderUxEnabled?this.fb.register(k,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").tc().Cc(function(){return new k(C.fb.Tb("Common.App.HostNotification.EditNotificationEventSource"))}):
this.fb.register(d,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").tc().Cc(function(){return new d(B.EventHandlerManager.instance,C.fb.Tb("Common.App.Header.HeaderEventSource"),C.fb.Tb("Common.App.HostNotification.EditNotificationEventSource"),A.AFrameworkApplication.isRtl)}))};c.prototype.init=function(){A.AFrameworkApplication.fa.Tu(Object(l.a)(this,this.sB,"onFullAppSettingsReady"))};c.prototype.sB=function(){var x=A.AFrameworkApplication.fa,C=!!A.AFrameworkApplication.ta.Pa&&
4===A.AFrameworkApplication.ta.Pa.Fj;if(x.ra("WordEditorAutoSaveImprovementIsEnabled")||x.ra("PptEditorSaveStatusInHeaderEnabled")||C&&x.ra("SimplifiedReactRibbonUxIsEnabled")||x.ra("ExcelSaveStatusInHeaderEnabled")||x.ra("VisioSaveStatusInHeaderEnabled"))A.AFrameworkApplication.fa.ra("PostMessageEmbedded")&&A.AFrameworkApplication.hideHeaderEmbedded?(this.VPc=this.fb.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.VPc.ev():A.AFrameworkApplication.ta.Pa.Hgf||(A.AFrameworkApplication.ta.Pa.isReactSharedHeaderUxEnabled?
(this.UOc=this.fb.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.UOc.initialize(x.ra("IsSkyDrive"),x.Wa("HostNameToIncludeInSavedStatus"),A.AFrameworkApplication.fa):(this.dlb=this.fb.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.dlb.initialize(x.ra("IsSkyDrive"),x.Wa("HostNameToIncludeInSavedStatus")))};c.prototype.dispose=function(){this.dlb&&this.dlb.tv()};Af.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveStatus"}}});
Object(u.a)(c,"PackageManager",null,[3,4]);var y=b(257);b.d(D,"a",function(){return a})},1459:function(u,D,b){function a(){e.a.Fa(c.ka)}function c(z){var r=n.call(this)||this;r.Ec=z;r.Eb();return r}function d(z,r){var v=this;this.Qee=this.iKc=!1;this.Dya=function(A,B){(null===B||void 0===B?0:B.TG)&&f.a.$Kg([B.TG])&&(v.suc=!0)};this.uo=function(){v.suc=!1};this.Uc=function(A,B){m.b(B)&&v.qea(!0);v.suc=!1};this.Yc=function(){v.OQ=v.$.OQ;v.qea()};this.iBf=function(){v.qS()};this.lAf=function(){v.OQ=
v.$.OQ};this.Iyd=function(){w.g(v.$).Ea.fv(v.Iyd);v.OQ=v.$.OQ};this.ZUf=r;this.$=z;this.$.userOperationManager.Cr(this.lAf);this.$.Tk(this.Yc);this.$.ea.EGg(this.iBf);this.$.ea.Wj(this.Uc);this.$.nZb(this.Dya);this.$.ea.TL(this.uo);this.qea()}var e=b(11);u=b(0);var k=b(84),l=b(232),m=b(235),f=b(29),w=b(21);d.prototype.dispose=function(){this.$&&(this.$.ol(this.Yc),this.$.Esc(this.Dya),this.$.userOperationManager&&this.$.userOperationManager.wo(this.lAf),this.$.ea&&(this.$.ea.Bcj(this.iBf),this.$.ea.xk(this.Uc),
this.$.ea.GR(this.uo)),w.g(this.$)&&w.g(this.$).Ea&&w.g(this.$).Ea.fv(this.Iyd))};d.prototype.qea=function(z){z=!this.$.isEditMode||(void 0===z?!1:z);this.ZUf.qea(z,this.$.isEditMode?3:1);this.qS()};d.prototype.qS=function(){this.$.isEditMode&&this.ZUf.qS(!this.OQ&&!this.vqi&&!this.suc)};Af.Object.defineProperties(d.prototype,{vqi:{configurable:!0,enumerable:!0,get:function(){return this.$.ea?this.$.ea.ajf:!1}},OQ:{configurable:!0,enumerable:!0,get:function(){return this.iKc},set:function(z){z?this.iKc=
!0:w.g(this.$)&&w.g(this.$).Ea&&(w.g(this.$).Ea.RZ()?this.iKc=!1:w.g(this.$).Ea.mx(this.Iyd));this.qS()}},suc:{configurable:!0,enumerable:!0,get:function(){return this.Qee},set:function(z){this.Qee=z;this.qS()}}});Object(u.a)(d,"SaveStatusManager",null,[10]);var n=l.a;Rk(c,n);c.prototype.create=function(){var z=this,r=k.a.instance;r.Tb("Common.App.SaveStatus.ISaveStatusUIHandler").execute(function(v){var A=new d(z.Ec,v);r.register(d,"Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager").tc().Cc(function(){return A});
z.pb(r.resolve("Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager"))})};c.ka=function(z){z.da.Ga(299,new c(z))};Object(u.a)(c,"SaveStatusFactory",l.a,[]);b.d(D,"a",function(){return a})},1602:function(u,D,b){b.r(D);u=b(1404);b=b(1459);Type.registerNamespace("_Ewa");Object(u.a)();Object(b.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.savestatus.js.map/f6945975f683952512b1affb4100d3db/EwaDS.savestatus.js.map