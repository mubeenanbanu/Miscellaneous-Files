(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[24],{1190:function(u,D,b){function a(k,l){k=e.call(this,k,l)||this;l!==d.a.O9&&k.sFa(l);k.Aga(a.iterateNext);k.Aga(a.exa);k.ETc(c.a.OTa);k.ETc(c.a.PTa);return k}b.d(D,"a",function(){return a});u=b(0);var c=b(170);D=b(1444);var d=b(973),e=D.a;Rk(a,e);a.iterateNext="IterateNext";a.exa="IteratePrevious";a.dNb="ToggleShowChanges";a.setCurrentChangeCount="SetCurrentChangeCount";a.setTotalChangesCount="SetTotalChangesCount";a.FOa=
"OnVHDiffReady";Object(u.a)(a,"VersionHistoryMessenger",D.a,[])},1465:function(u,D,b){function a(J,O,N,H){var Q=this;this.authorColor=this.Z1=this.sea=null;this.T6a=!1;this.H9f=0;this.I0a=-1;this.l4c=0;this.$Ha=100;this.Kka=-1;this.hZd=null;this.vob=f.a.PVj;this.JFe=f.a.QVj;this.ei=function(ca){(ca=B.a(ca)?null:ca.Result)?ca.OperationWaitingForFileDownload?20>Q.l4c?(Q.$Ha*=2,K.Task.delay(Q.$Ha).continueWith(function(){Q.yWd()})):(Q.wBc(),d.ULS.sendTraceTag(537150406,0,50,"VersionHistoryHighlightManager::OnWebMethodSuccess Next Operation enqueue failed")):
ca.ActivityList?(Q.initialize(ca.ActivityList,ca.VersionAuthors),y.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")?Q.FOa():Q.zxc(!0),Q.hZd.stop(),d.ULS.sendTraceTag(41743369,0,50,"VersionHistoryHighlightManager: Time taken For showing diffs in Ms:{0}",Q.hZd.qc.toString())):(Q.wBc(),d.ULS.sendTraceTag(537150407,0,50,"VersionHistoryHighlightManager::OnWebMethodSuccess no activity list found.")):(Q.$Ha*=2,K.Task.delay(Q.$Ha).continueWith(function(){Q.yWd()}),
d.ULS.sendTraceTag(537150408,0,10,"VersionHistoryHighlightManager::OnWebMethodSuccess call returned null result."))};this.Eya=function(){Q.wBc();d.ULS.sendTraceTag(537150405,0,10,"VersionHistoryHighlightManager::OnWebMethodFailure service call failed.")};this.crd=function(ca){d.ULS.sendTraceTag(537150400,0,50,"VersionHistoryHighlightManager.IterateMessageHandler called with MessageID:{0}",ca.MessageId);switch(ca.MessageId){case M.a.iterateNext:Q.iterateNext();Q.Kka=(Q.Kka+1)%Q.gS.length;Q.JJb(M.a.setCurrentChangeCount,
Q.Kka+1);break;case M.a.exa:Q.exa();Q.Kka=0>Q.Kka?0:Q.Kka;Q.Kka=(Q.Kka+Q.gS.length-1)%Q.gS.length;Q.JJb(M.a.setCurrentChangeCount,Q.Kka+1);break;case M.a.dNb:Q.zxc(ca.Values.ToggleValue)}};this.k0g=function(ca,X){return Q.V2b(ca.sk,X.sk)};this.j0g=function(ca,X){return Q.V2b(ca.sk,X)};this.Rc=function(){Q.X5b()};this.fp=function(){Q.X5b()};this.Gh=function(){Q.X5b()};d.ULS.sendTraceTag(537150411,0,50,"VersionHistoryHighlightManager::Constructor.");this.$=J;this.ariaLiveNotifier=H;this.gridView=I.g(this.$);
this.gridView.ha.yG(this.Rc);this.gridView.XD(this.fp);this.gridView.Wb.Bk(this.Gh);this.JRj();O&&(this.hZd=J.Fb.sc("UserAction","VersionHistoryDiffManagerStopWatch"),this.yWd());if(this.Qr=N)J=e.a.Maa(this.$.ya.VersionHistoryActionUrl)||F.a.O9,J!==F.a.O9&&this.Qr.sFa(J),this.Qr.Wn(M.a.iterateNext),this.Qr.Wn(M.a.exa),this.Qr.Wn(M.a.dNb),this.Qr.Ml(M.a.iterateNext,this.crd),this.Qr.Ml(M.a.exa,this.crd),this.Qr.Ml(M.a.dNb,this.crd)}function c(J,O,N){this.pFa=J;this.sk=O;this.fCc=N}u=b(0);var d=b(15),
e=b(81),k=b(1030),l=b(85),m=b(202),f=b(8),w=b(219),n=b(64),z=b(45),r=b(564),v=b(177),A=b(110),B=b(296),y=b(1),x=b(10),C=b(101),G=b(14),E=b(295);b(95);var I=b(21),U=b(355);Object(u.a)(c,"UserActivityLocation",null,[]);var M=b(1190),T=b(61),F=b(973),K=b(58);b.d(D,"a",function(){return a});a.prototype.dispose=function(){this.zza();this.sea=this.Z1=null;this.gridView&&(this.gridView.ha&&this.gridView.ha.EF(this.Rc),this.gridView.DF(this.fp),this.gridView.Wb&&this.gridView.Wb.wk(this.Gh),this.Qr&&(this.Qr.roa(M.a.exa),
this.Qr.roa(M.a.iterateNext),this.Qr.roa(M.a.dNb)))};a.prototype.initialize=function(J,O){J?(this.zza(),this.I0a=-1,this.sea=[],this.T6a=!1,this.Z1={},this.authorColor={},this.pyi(O),this.U3c(J)):d.ULS.shipAssertTag(537150410,0,!1,"VersionHistoryHighlightManager.Initialize - userActivityList was Null")};a.prototype.yWd=function(){function J(N,H,Q){var ca=O.$.oa.xa;N=E.b(N,O.ei);H=E.a(H,O.Eya);var X=ca.Na(1,null);return T.g(ca,"GetVersionHistoryHighlightActivitiesData",X,N,H,Q,null,4)}var O=this;d.ULS.sendTraceTag(537150409,
0,50,"VersionHistoryHighlightManager: TryFetchUserActivityandTriggerDiff triggered: {0} --{1}",this.l4c.toString(),this.$Ha.toString());this.l4c++;y.EwaSettings.Zb()?this.$.userOperationManager.Sb(new v.a(537,0,J,80),null):this.$.userOperationManager.Sb(new r.a(537,0,J,16),null)};a.prototype.zxc=function(J){var O=this.Z1,N;for(N in O){var H=N,Q=O[N];Q?Q.zLb(J):d.ULS.shipAssertTag(537150404,0,!1,"VersionHistoryHighlightManager.ShowOrHideAllHighlights -"+H+"view was Null")}};a.prototype.zza=function(){var J=
this.Z1,O;for(O in J){var N=O,H=J[O];H?H.MHd():d.ULS.shipAssertTag(537150403,0,!1,"VersionHistoryHighlightManager.RemoveAllHighlights -"+N+"view was Null")}this.sea=this.Z1=null};a.prototype.lWf=function(J){var O=this.zSh(J,this.I0a);var N=O.f9e;J=O.eeg;O.returnValue&&(d.ULS.shipAssertTag(537150402,0,!!J,"VersionHistoryHighlightManager.SelectNextOrPreviousChange - userActivityLocation is null"),this.X5b(),J.pFa.toString()in this.Z1?(this.Z1[J.pFa.toString()].Ilj(J.sk),O=z.D(J.sk),this.ariaLiveNotifier.setEnabled(!1),
this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(String.format(G.a.instance.lb(158),N+1,this.gS.length,O.dB(!1),J.fCc.DisplayName)),this.I0a=N):d.ULS.shipAssertTag(537150401,0,!1,String.format("VersionHistoryHighlightManager.SelectNextOrPreviousChange - {0} view not present in views dictionary",J.pFa.toString())))};a.prototype.JJb=function(J,O){if(y.EwaSettings.ma(320))if(this.Qr){var N={};N.count=O;J=new k.a(J);J.Values=N;this.Qr.send(J)}else d.ULS.sendTraceTag(537150370,0,10,
"VersionHistoryHighlightManager.SendIteratorTextUpdateMessage hostPostmessenger is null");else d.ULS.sendTraceTag(537150371,0,50,"VersionHistoryHighlightManager.SendIteratorTextUpdateMessage VersionHistoryIterator BRS is turned off")};a.prototype.zSh=function(J,O){var N=!1;var H=null;for(var Q=0;!N&&Q<this.gS.length;){O=J?this.qSh(O):this.hUh(O);H=this.gS[O];var ca=Object(l.a)(C.a,this.$.va.getItemByName(H.sk.SheetName));if(!ca)return d.ULS.shipAssertTag(537150369,0,!1,String.format("VersionHistoryHighlightManager.GetNextorPreviousUserActivityLocationFromIndex - useractivitylocation contains sheetrange with null sheet")),
{returnValue:!1,f9e:O,eeg:H};ca.visible&&(N=!0);Q++}return{returnValue:N,f9e:O,eeg:H}};a.prototype.qSh=function(J){return-1===J?this.p_e():(J+1)%this.gS.length};a.prototype.hUh=function(J){-1===J&&(J=this.p_e());return J=(J+this.gS.length-1)%this.gS.length};a.prototype.U3c=function(J){this.M$g(J);this.A3c()};a.prototype.OZh=function(J,O){var N=[];if(!J.RangeList)return d.ULS.shipAssertTag(537150368,0,!1,"VersionHistoryHighlightManager.GetUserActivityLocationFromRangeActivityLocation - ActivityLocationType.Range RangeList Null "),
N;J=ak(J.RangeList);for(var H=J.next();!H.done;H=J.next())(H=H.value)&&this.$.va.Mj(H.SheetName)?(H=new c(0,H,O),N.push(H)):d.ULS.shipAssertTag(537150367,0,!1," Inavlid sheet name"+H.SheetName);return N};a.prototype.M$g=function(J){J=ak(J);for(var O=J.next();!O.done;O=J.next())if(O=O.value,!O||A.e(O.LocationList))d.ULS.sendTraceTag(537150366,0,50,"Empty Location list");else for(var N=ak(O.LocationList),H=N.next();!H.done;H=N.next())if(H=H.value)switch(H.Type){case 0:this.sea.push.apply(this.sea,yk(this.OZh(H,
O.Person)));break;default:d.ULS.sendTraceTag(537150364,0,50,"VersionHistoryHighlightManager.CreateViews Failed. Invalid ActivityLocationType")}else d.ULS.shipAssertTag(537150365,0,!1,"VersionHistoryHighlightManager.CreateUserActivityLocationList - LocationList contains Null")};a.prototype.A3c=function(){for(var J={},O=new m.a,N=[],H=ak(this.sea),Q=H.next();!Q.done;Q=H.next())if(Q=Q.value,O.contains(Q.fCc)||O.add(Q.fCc),0===Q.pFa){var ca=new U.a(z.D(Q.sk),n.d(this.$.va.getItemByName(Q.sk.SheetName))),
X=a.ywc(ca);X in J||N.push(ca);J[X]=this.zKh(Q.fCc)}d.ULS.sendTraceTag(42541534,0,15,"VersionHistoryHighlightManager.CreateRangeHighlightView. Total activities : {0}, Highlightable activities: {1},Total userlist in activities : {0}, Total userlist from pane: {1} ",this.sea.length,N.length,O.count,this.H9f);this.wBc();0<N.length&&(J=new (b(1567).RangeVersionHistoryHighlightView)(this.$,N,J,this.vob),this.Z1["0"]=J)};a.prototype.wBc=function(){var J=this.sea?this.gS.length:0;this.JJb(M.a.setCurrentChangeCount,
0);this.JJb(M.a.setTotalChangesCount,J)};a.prototype.FOa=function(){this.JJb(M.a.FOa,0)};a.prototype.pyi=function(J){if(J){this.H9f=J.length;for(var O=0;O<J.length;++O)if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:5140301_HandleEmptyInitialsColor")&&!J[O].InitialsColor)d.ULS.sendTraceTag(537150362,0,15,"VersionHistoryHighlightManager.MapAuthorColorInfo: InitialsColor is null or empty for a version author");else{var N=J[O].EmailAddress;var H=J[O].UserName;var Q=null;if(J[O].LoginName){var ca=J[O].LoginName.split("|");
3===ca.length&&(Q=ca[2])}Q?this.authorColor[Q]=J[O].InitialsColor:N?(d.ULS.sendTraceTag(537150361,0,15,String.format("VersionHistoryHighlightManager Map Author Color: LoginName is null")),this.authorColor[N]=J[O].InitialsColor):H?(d.ULS.sendTraceTag(537150360,0,15,String.format("VersionHistoryHighlightManager Map Author Color: Email Address is null")),this.authorColor[H]=J[O].InitialsColor):d.ULS.sendTraceTag(537150359,0,10,String.format("VersionHistoryHighlightManager Map Author Color: User name is null"))}}else d.ULS.sendTraceTag(537150363,
0,15,"VersionHistoryHighlightManager.MapAuthorColorInfo: versionAuthors is null")};a.prototype.JRj=function(){if(this.$.ya.VersionHistoryHighlightsSettings)for(var J=Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(this.$.ya.VersionHistoryHighlightsSettings))?Sys.Serialization.JavaScriptSerializer.deserialize(this.$.ya.VersionHistoryHighlightsSettings):null,O=0;O<J.length;O++){var N=J[O],H=N.key?N.key:N.Key?N.Key:"";N=N.value?N.value:N.Value?N.Value:"";"DefaultColor"===H?this.JFe=
N:"InitialTint"===H?this.vob=N:d.ULS.sendTraceTag(537150357,0,15,String.format("VersionHistoryHighlightManager.UpdateHighlightSettings Highlight Settings are incorrect"))}else d.ULS.sendTraceTag(537150358,0,15,String.format("VersionHistoryHighlightManager.UpdateHighlightSettings Highlight Settings are null"))};a.prototype.zKh=function(J){if(J.Email in this.authorColor)return this.authorColor[J.Email];if(J.DisplayName in this.authorColor)return this.authorColor[J.DisplayName];d.ULS.sendTraceTag(537150356,
0,15,String.format("VersionHistoryHighlightManager GetColorFromPerson - unable to associate corresponding author in dictionary"));return this.JFe};a.prototype.V2b=function(J,O){var N=Object(l.a)(C.a,this.$.va.getItemByName(J.SheetName)),H=Object(l.a)(C.a,this.$.va.getItemByName(O.SheetName));return N&&H?(N=(N=x.HelperMethods.TC(N.index,H.index))||x.HelperMethods.TC(J.FirstRow,O.FirstRow))||x.HelperMethods.TC(J.FirstColumn,O.FirstColumn):(d.ULS.sendTraceTag(537150355,0,10,"VersionHistoryHighlightManager.CompareSharedSheetRange - null sheet"),
0)};a.prototype.p_e=function(){var J=z.m(this.gridView.ha.sa.activeRange,this.$.va.pa);if(!J)return d.ULS.sendTraceTag(537150354,0,10,"VersionHistoryHighlightManager.GetNearestLocationIndexFromCurrentSelection - SelectedSharedSheetRange is null "),0;J=x.HelperMethods.ox(new w.a(this.gS),0,this.gS.length,J,this.j0g);0>J&&(J=~J);return J%this.gS.length};a.prototype.X5b=function(){if(this.DJb){if(!(this.DJb.pFa.toString()in this.Z1)){d.ULS.shipAssertTag(537150353,0,!1,String.format("VersionHistoryHighlightManager.DeselectCurrentlySelectedView - {0} view not present in views dictionary",
this.DJb.pFa.toString()));return}this.Z1[this.DJb.pFa.toString()].zdh(this.DJb.sk)}this.I0a=-1};a.prototype.iterateNext=function(){this.lWf(!0)};a.prototype.exa=function(){this.lWf(!1)};a.ywc=function(J){return String.format("{0}{1}",J.range,J.sheetId)};Af.Object.defineProperties(a.prototype,{qfb:{configurable:!0,enumerable:!0,get:function(){return this.Z1}},DJb:{configurable:!0,enumerable:!0,get:function(){return-1===this.I0a?null:this.gS[this.I0a]}},gS:{configurable:!0,enumerable:!0,get:function(){this.T6a||
(this.sea.sort(this.k0g),this.T6a=!0);return this.sea}}});Object(u.a)(a,"VersionHistoryHighlightManager",null,[829,10])},1567:function(u,D,b){function a(r,v,A,B){this.wib=null;this.$=r;this.Hvg=v;this.CRa=A;this.DRa={};this.vob=B;this.Nai()}function c(){}b.r(D);u=b(0);var d=b(15),e=b(8);c.csh="ewa-vhr-rectinnerborder";Object(u.a)(c,"CssClassNames",null,[]);var k=b(64),l=b(45),m=b(203),f=b(95),w=b(21),n=b(355),z=b(1465);b.d(D,"RangeVersionHistoryHighlightView",function(){return a});a.prototype.zLb=
function(r){r?this.qb.qn(this.XE):this.qb.eh(this.XE)};a.prototype.MHd=function(){this.zLb(!1);this.qb.scb(new n.a(null,k.d(this.$.pa)),this.XE)};a.prototype.Ilj=function(r){if(this.CRa){var v=new n.a(l.D(r),k.d(this.$.va.getItemByName(r.SheetName))),A=z.a.ywc(v);if(A in this.CRa)if(A in this.DRa){v=m.a.Qo(this.CRa[A]);A=this.DRa[A];for(var B in A)A[B].style.backgroundColor=String.format("rgba({0},{1},{2},{3})",v.r,v.g,v.b,e.a.RVj);w.g(this.$).ha.Oa.PG(null);w.g(this.$).P3e(r,60,!0,f.a.D4i)}else d.ULS.sendTraceTag(537150426,
0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToDivMap doesn't contain entry for "+A);else d.ULS.sendTraceTag(537150427,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToColorMap doesn't contain entry for "+A)}else d.ULS.sendTraceTag(537150428,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToColorMap is null")};a.prototype.zdh=function(r){r=new n.a(l.D(r),k.d(this.$.va.getItemByName(r.SheetName)));var v=z.a.ywc(r);if(v in this.DRa)if(v in this.CRa){r=m.a.Qo(this.CRa[v]);
v=this.DRa[v];for(var A in v)v[A].style.backgroundColor=String.format("rgba({0},{1},{2},{3})",r.r,r.g,r.b,this.vob)}else d.ULS.sendTraceTag(537150424,0,10,"RangeVersionHistoryHighlightView.DeselectView sheetRangeToColorMap doesn't contain entry for "+v);else d.ULS.sendTraceTag(537150425,0,10,"RangeVersionHistoryHighlightView.DeSelectView sheetRangeToDivMap doesn't contain entry for "+v)};a.prototype.Nai=function(){var r=this;this.qb.Lw(this.Hvg,[a.w4],!1,function(v,A){if(v&&v.range&&v.sheetId&&A){var B=
new n.a(v.range,v.sheetId);B=z.a.ywc(B);B in r.DRa||(r.DRa[B]={});r.DRa[B][v.paneType.toString()]=A;B in r.CRa?(v=r.CRa[B],B=m.a.Qo(v),A.style.borderColor=v,A.style.backgroundColor=String.format("rgba({0},{1},{2},{3})",B.r,B.g,B.b,r.vob),v=document.createElement("div"),v.className=c.csh,A.appendChild(v)):d.ULS.sendTraceTag(537150419,0,10,"RangeVersionHistoryHighlightView.InitializeSheetRangeList sheetRangeToColorMap doesn't contain entry for "+B)}else d.ULS.shipAssertTag(537150423,0,!!v,"RangeVersionHistoryHighlightView.AddSheetRangeList: state is null"),
d.ULS.shipAssertTag(537150422,0,!v||!!v.range,"RangeVersionHistoryHighlightView.AddSheetRangeList: state.Range is null"),d.ULS.shipAssertTag(537150421,0,!v||!!v.sheetId,"RangeVersionHistoryHighlightView.AddSheetRangeList: state.SheetId is null"),d.ULS.shipAssertTag(537150420,0,!!A,"RangeVersionHistoryHighlightView.AddSheetRangeList: div is null")})};Af.Object.defineProperties(a.prototype,{XE:{configurable:!0,enumerable:!0,get:function(){return[a.w4]}},qb:{configurable:!0,enumerable:!0,get:function(){return this.wib||
(this.wib=w.g(this.$).qb)}}});a.w4=23;Object(u.a)(a,"RangeVersionHistoryHighlightView",null,[869])},1630:function(u,D,b){function a(Rb){var qc=Uc.call(this)||this;qc.$=Rb;qc.Eb();return qc}function c(Rb,qc,Oc,jb){var Eb=this;Oc=void 0===Oc?null:Oc;jb=void 0===jb?null:jb;this.HGa=null;this.K5e=!1;this.ODf=function(nc){eb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BlueDot",!1)&&!h.a.uh(nc.wywaActivities)&&2!==nc.wywaActivities[0].type&&(Eb.l_a.doj(Eb.UZc.deg),Eb.l_a.zxc(!0),Eb.l_a.y6h(nc.wywaActivities[0]))};
this.$=Rb;this.l_a=new E(this.$);this.k2d=new N(Ta.AFrameworkApplication.ub,eb.EwaSettings.ma(453));Rb=hb.a.$Jj(Sd.a.instance.Tb("Common.App.CatchUpActivity.ICatchUpRequestHandler"));this.Qjf=jb;this.UZc=new w(this.$,Rb,this.i6a());this.rwe=new G(this.$,Ta.AFrameworkApplication.ub);this.emptyCatchUpBehaviorManager=new f(this.$);this.xsi(function(nc){Eb.WGi(nc)},qc);this.wui();qc=null;Oc||(qc=Sd.a.instance.resolve("Common.App.CatchUpActivity.FloodgateEventLogger"));this.flyoutRibbonButton=Oc||new k(qc);
this.flyoutFocus=new l(this.$,this.flyoutRibbonButton)}function d(){this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=null}function e(){this.flyoutAnchorTarget=this.useCompactSummaryString=this.disableDismissOnClick=this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=
this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}function k(Rb){this.buttonClickedCallback=null;this.Tib=this.Lyb=!1;this.lCh=new Date;this.sTe=Rb}function l(Rb,qc){this.$=Rb;this.flyoutRibbonButton=void 0===qc?null:qc;Gc.a(this.$).Oh(this);this.hasFocus=!1}function m(Rb){window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+Rb)}function f(Rb){this.$=
Rb}function w(Rb,qc,Oc){Oc=void 0===Oc?!1:Oc;this.deg=null;this.$=Rb;this.x1b=qc;this.IFb=Sd.a.instance.resolve("Common.App.People.IPeopleColorUtils");this.zqc=Sd.a.instance.resolve("Common.App.People.IUserProfilePictureUtils");this.i6a=Oc}function n(Rb,qc,Oc,jb,Eb,nc,$c){$c=Rb.Na(1,void 0===$c?null:$c);$c.getRelevantActivitiesDataRequest=qc;return rd.g(Rb,"GetRelevantActivitiesData",$c,Oc,jb,Eb,nc,0)}function z(Rb,qc,Oc,jb,Eb,nc){nc=Rb.Na(1,void 0===nc?null:nc);return rd.g(Rb,"GetLineageWywaAuthors",
nc,qc,Oc,jb,Eb,4)}function r(){var Rb=x.call(this)||this;Rb.relationship=0;return Rb}function v(){this.color=this.imageUrl=this.email=this.givenName=this.displayName=this.provider=this.id=null}function A(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}function B(){this.activityFeedItems=null}function y(){this.collectionId=this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=
null}function x(){this.activityFeedItemId=this.activityId=null;this.type=0;this.collectionId=this.state=this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}function C(){}function G(Rb,qc){this.$=Rb;this.pi=qc}function E(Rb){var qc=this;this.NQa=this.H3b=this.Mea=null;this.v4={};this.dDa=null;this.ijd=!1;this.iEb=function(Oc,jb){switch(jb.state){case 0:case 1:3===jb.sEd&&(qc.O5h(),qc.NQa=null);break;case 2:break;case 3:qc.x5c();qc.NQa=jb.activityId;qc.bzj();break;
default:Da.ULS.shipAssertTag(537168030,0,!1,"CatchUpActivityHighlightManager.OnHighlightStateChanged - Invalid CatchUpActivityHighlightState:"+jb.state)}};this.Jl=function(){qc.Trb()};this.Rc=function(){qc.Trb()};this.fp=function(){qc.Trb()};this.Gh=function(){qc.Trb()};this.f2f=function(Oc,jb){qc.Mea&&jb.sH!==qc.Rja&&(jb.isSticky&&qc.r6b(!0),(Oc=qc.YMj(jb.sH))?(qc.Mea.createActivityIndicatorTooltip(Object(Cb.a)(new M,{target:jb.sH,container:Oc,activityIds:[jb.activityId],isSticky:jb.isSticky,dirHint:qc.gridView.rtl?
12:9})),jb.isSticky?(qc.Rja=jb.sH,Da.ULS.sendTraceTag(51172352,0,50,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler: Activity Indicator Raising Selected/Unselected Event.")):(qc.Mdc=jb.sH,Da.ULS.sendTraceTag(51172353,0,50,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler: Activity Indicator Raising Hover/Unhover Event.")),qc.fgc||(qc.gridView.view.Gs(qc.YAc),qc.gridView.Ft(qc.YAc),qc.fgc=!0)):Da.ULS.shipAssertTag(537168027,0,!1,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler FlyoutContainer is null."))};
this.zHe=function(Oc,jb){qc.r6b(jb.Gfh)};this.YAc=function(){qc.Mea?(qc.Rja&&qc.Mea.updateActivityIndicatorTooltip(Object(Cb.a)(new I,{target:qc.Rja,isSticky:!0})),qc.Mdc&&qc.Mea.updateActivityIndicatorTooltip(Object(Cb.a)(new I,{target:qc.Rja,isSticky:!1}))):Da.ULS.shipAssertTag(537168024,0,!1,"CatchUpActivityHighlightManager::UpdateActivityFlyouts ActivityIndicatorTooltipManager is null.")};this.$=Rb;this.gridView=Vc.g(this.$);this.ha=this.gridView.ha;this.Ya=this.gridView.Wb;this.ha.WYb(this.Jl);
this.ha.yG(this.Rc);this.gridView.XD(this.fp);this.Ya.Bk(this.Gh);this.Rja=this.Mdc=null;this.fgc=!1;this.rad={}}function I(){this.target=null;this.isSticky=!1}function U(){this.clearSticky=!1}function M(){this.activityIds=this.container=this.target=null;this.isSticky=!1;this.dirHint=0}function T(){this.u1c=[];this.QKb={};this.Jje={}}function F(Rb,qc,Oc,jb,Eb){Rb=K.call(this,Rb,qc,Oc,jb)||this;Rb.ranges=Eb;Rb.T6a=!1;return Rb}function K(Rb,qc,Oc,jb){var Eb=Xe.call(this)||this;Eb.$=Rb;Eb.C0d=qc;Eb.Pjg=
Oc;Eb.ZB=jb;Eb.state=0;return Eb}function J(Rb,qc,Oc){Oc=xe.call(this,Rb,qc,Oc)||this;Oc.gridView=Vc.g(Rb);Oc.wma=qc;return Oc}function O(Rb){var qc=this;this.iEb=function(){switch(qc.Ru.model.state){case 1:qc.h3f(!0);break;case 0:qc.zLb(!1);break;case 2:case 3:qc.zLb(!0);break;default:Da.ULS.shipAssertTag(537167968,0,!1,"RangeCatchUpActivityView.OnHighlightStateChanged - Invalid CatchUpActivityHighlightState:"+qc.Ru.model.state)}};this.Hpg=Rb;this.Ru.eme(this.iEb);this.kz=[]}function N(Rb){this.pi=
Rb}function H(Rb){return Xa.call(this,Rb)||this}function Q(Rb,qc){this.$=Rb;this.catchUpActivityManager=qc}function ca(){this.fb=null}function X(Rb){this.yu=Rb}function Z(Rb){this.ytg=Rb}function ea(Rb){this.cga=Rb;this.J$d=new he.a}function ka(Rb,qc,Oc){this.Wae=Rb;this.pCa=qc;this.GCa=Oc}function Y(Rb,qc,Oc,jb,Eb,nc){Rb=Ze.call(this,Rb,qc)||this;Rb.ItemIds=null;Rb.ActivityStatesToSet=0;Rb.ActivityStatesToReset=0;Rb.ResetUnseenCount=!1;Rb.ItemIds=Oc;Rb.ActivityStatesToSet=jb;Rb.ActivityStatesToReset=
Eb;Rb.ResetUnseenCount=nc;return Rb}function qa(Rb,qc){return Me.call(this,Rb,qc)||this}function fa(Rb,qc){this.Pg=Rb;this.yu=qc}function ha(Rb){var qc=ke.call(this)||this;qc.$=Rb;qc.Eb();return qc}function ia(Rb){var qc=Kd.call(this)||this;qc.$=Rb;qc.Eb();return qc}function wa(Rb,qc){var Oc=this;this.ppd=!1;this.Sf=function(){Oc.k$f()};this.$=Rb;eb.EwaSettings.ma(613)&&this.$.ea.L7a&&!wa.Fwb&&(qc&&!qc.ndb||this.HVj(),wa.M5e?Da.ULS.sendTraceTag(537155461,0,50,"LineageTeachingCalloutTriggerManager will not trigger WYWA waterline check as it was already checked in session"):
qc&&!qc.ndb||this.NVj());Da.ULS.sendTraceTag(537155460,0,50,"LineageTeachingCalloutTriggerManager is initialized.")}function Qa(Rb){var qc=dd.call(this)||this;qc.hi=null;qc.Wg=null;qc.$=Rb;qc.Eb();return qc}function S(Rb,qc,Oc){var jb=md.call(this,Rb)||this;jb.ee=null;jb.Oye=null;jb.mEb=null;jb.Nod=!0;jb.mu=0;jb.rp=!1;jb.Fc=function(Eb,nc){nc.kg||jb.x0c()};jb.Sj=function(){jb.x0c();return!0};jb.$=qc;jb.taskPaneManager=Oc;jb.$.Ck(jb.Fc);Gc.a(jb.$).Oh(jb);Gd.a.ud(jb.$)&&(jb.isVisible=!1);return jb}
function da(Rb){var qc=Wb.call(this)||this;qc.lineageTaskPane=null;qc.p7=null;qc.$=Rb;qc.Eb();return qc}function xa(Rb,qc,Oc,jb){var Eb=this;this.xtb=this.kF=null;this.UD=this.Dsd=0;this.mEb=function(){Eb.p7&&(Eb.p7.stop(),Eb.p7=null);Eb.oLb.start();Eb.kF.createLineagePane(Eb.ysd,Eb.xtb)};this.lineageOpenPaneOrChangeFilterRequest=function(nc,$c){function od(Xd,te,af){var cf=Eb.$.oa.xa,Pa=ze;Xd=Wc.b(Xd,Eb.ped("LineageOpenPaneOrChangeFilter"));te=Wc.a(te,de);var Sb=cf.Na(1,null);Sb.clientParams=ae;
Sb.lineageFilter=Pa;return rd.g(cf,"LineageOpenPaneOrChangeFilter",Sb,Xd,te,af,null,0)}function de(Xd){Xd=cb.a.Of(Xd.data);Da.ULS.sendTraceTag(537155481,0,50,"LineageManager::LineageOpenPaneOrChangeFilter service call failed. Errors: [{0}]",pc.a.Dc(Xd))}Eb.oLb.stop();td.b(Eb.$).Cd(Qe.a.YNi,{});Eb.oBj();var ae=Object(Cb.a)(new W,{ClientViewCapacity:nc.clientViewCapacity}),ze=null;$c&&(ze=Object(Cb.a)(new va,{FilterSheetMultiRange:Eb.JLj($c.filterSheetMultiRange)}));eb.EwaSettings.Zb()?Eb.$.userOperationManager.Sb(new Qb.a(1010,
0,od,80),null):Eb.$.userOperationManager.Sb(new Fa.a(1010,0,od,16),null)};this.lineageLoadMoreRequest=function(nc){function $c(de,ae,ze){var Xd=Eb.$.oa.xa;de=Wc.b(de,Eb.ped("LineageLoadMore"));ae=Wc.a(ae,od);var te=Xd.Na(1,null);te.fetchFromBelow=nc;return rd.g(Xd,"LineageLoadMore",te,de,ae,ze,null,0)}function od(de){de=cb.a.Of(de.data);Da.ULS.sendTraceTag(537155480,0,50,"LineageManager::LineageLoadMore service call failed. Errors: [{0}]",pc.a.Dc(de))}td.b(Eb.$).Cd(Qe.a.XNi,{});eb.EwaSettings.Zb()?
Eb.$.userOperationManager.Sb(new Qb.a(1011,0,$c,80),null):Eb.$.userOperationManager.Sb(new Fa.a(1011,0,$c,16),null)};this.lineageRefreshViewRequest=function(){function nc(od,de,ae){var ze=Eb.$.oa.xa;od=Wc.b(od,Eb.ped("LineageRefreshView"));de=Wc.a(de,$c);var Xd=ze.Na(1,null);return rd.g(ze,"LineageRefreshView",Xd,od,de,ae,null,0)}function $c(od){od=cb.a.Of(od.data);Da.ULS.sendTraceTag(537155479,0,50,"LineageManager::LineageRefreshView service call failed. Errors: [{0}]",pc.a.Dc(od))}td.b(Eb.$).Cd(Qe.a.ZNi,
{});eb.EwaSettings.Zb()?Eb.$.userOperationManager.Sb(new Qb.a(1012,0,nc,80),null):Eb.$.userOperationManager.Sb(new Fa.a(1012,0,nc,16),null)};this.lineageUpdateViewRequest=function(){ya(Eb.$.oa.xa,function(nc){if(nc=kc.a(nc)?null:nc.Result){var $c={};$c=($c.CountOfUpdatedActivities=nc.LineageActivitiesResponse.ActivityList.length,$c);td.b(Eb.$).Cd(Qe.a.$Ni,$c);nc=Object(Cb.a)(new na,{activityList:Eb.wqc(nc.LineageActivitiesResponse.ActivityList),latestActivityId:nc.LineageActivitiesResponse.LastSearchedActivityId,
oldestActivityId:nc.LineageActivitiesResponse.FirstSearchedActivityId,serverMessageCode:nc.LineageActivitiesResponse.LineageResponseCode,lastSearchedActivityTimestamp:new Date(nc.LineageActivitiesResponse.EcmaLastSearchedDate),hasNewActivities:nc.HasNewActivities,filterSheetMultiRange:Eb.zLj(nc.LineageActivitiesResponse.FilterSheetMultiRange),serverFirstActivityId:nc.LineageActivitiesResponse.ServerFirstActivityId,serverLastActivityId:nc.LineageActivitiesResponse.ServerLastActivityId,showLoadPrevious:nc.LineageActivitiesResponse.ShowLoadPrevious,
eolCorrelationId:nc.LineageActivitiesResponse.EolCorrelationId,eolDateHideHistory:new Date(nc.LineageActivitiesResponse.EolDateHideHistory),eolPersonHideHistory:Eb.Bvb(nc.LineageActivitiesResponse.EolPersonHideHistory)});Eb.kF.onLineageActivitiesUpdateResponse(nc)}else Da.ULS.shipAssertTag(537155475,0,!!nc,"LineageManager.LineageUpdateView returned null response.")},function(nc){nc=cb.a.Of(nc.data);Da.ULS.sendTraceTag(537155474,0,50,"LineageManager::LineageUpdateView service call failed. Errors: [{0}]",
pc.a.Dc(nc))},null,null)};this.onCardSelected=function(nc,$c){if(nc=nc.rangeHighlightLocation){if($c){var od=jc.Z($c,null);var de=od.range;if(od.returnValue){Eb.u7e(nc.sheetName,Eb.Ivb([jc.j(de)]));return}Da.ULS.shipAssertTag(537155472,0,!1,"The produced subCellLocation string "+$c+" is not valid.")}nc.rangeList.length?Eb.u7e(nc.sheetName,nc.rangeList):Eb.z6h(nc.sheetName)}};this.onLearnMoreLinkClicked=function(){if(eb.EwaSettings.isChangeGateEnabled("OfficeVSO:4597686_LineageLearnMoreLinkEnabled")){var nc=
new Fb.a(-859308420,Re.a.Cb,Eb.$.Jc,12,null),$c={};$c=($c[Re.a.Vf]="HelpID=XLO_LineageTS",$c.InputMethod=Re.a.Cb,$c[Re.a.Nc]=He.a.JQ,$c.ShouldCanvasTakeFocus=!0,$c);Eb.$.Ka.Kb(nc,$c)}};this.onVersionHistoryButtonClicked=function(nc){Eb.$.Ka.Kb(new Fb.a(-1112508866,nc,Eb.$.Jc,12,null))};this.isFeatureEnabled=function(){return!1};this.Sf=function(){var nc=Eb.$.ea.lo.LineageVersion;nc!==Eb.Dsd&&(Da.ULS.sendTraceTag(537155470,0,50,"LineageManager.OnWorkbookMetadataChanged: lineageVersion: {0}, this.lineageVersion: {1}",
nc,Eb.Dsd),Eb.Dsd=nc,Eb.k7i())};this.Uc=function(nc,$c){Eb.kF&&!Eb.lineageTaskPane.Bgc&&$c.wH&&(Da.ULS.sendTraceTag(587220563,0,15,"LineageManager::SessionIdChanged detected."),Eb.onStaleActivitiesDetected())};this.uo=function(){Eb.kF&&!Eb.lineageTaskPane.Bgc&&(Da.ULS.sendTraceTag(587220562,0,15,"LineageManager::LoadOnDemandOccurred detected."),Eb.onStaleActivitiesDetected())};this.XC=function(){var nc=Eb.c4a();Eb.kF.onFilterableSheetListChange(nc)};this.Bya=function(){var nc=Eb.c4a();Eb.kF.onFilterableSheetListChange(nc)};
this.joc=function(){var nc=Eb.c4a();Eb.kF.onFilterableSheetListChange(nc)};this.onPaneClosed=function(){Eb.kF.onPaneClosed();sa(Eb.$.oa.xa,null,function(nc){nc=cb.a.Of(nc.data);Da.ULS.sendTraceTag(537155469,0,50,"LineageManager::OnLineageClosePaneFailed service call failed. Errors: [{0}]",pc.a.Dc(nc))},null,null)};this.onRangeFilterInputEnabled=function(nc){nc?Eb.gridView.ha.sP(Eb.Rc):Eb.gridView.ha.zW(Eb.Rc)};this.Rc=function(){var nc=jc.q(Eb.gridView.ha.sa.activeRange,Eb.$);nc=Object(Cb.a)(new Na,
{rangeList:Eb.Ivb(nc.Ranges),sheetName:nc.SheetName});Eb.kF.onSelectedRangeUpdated(nc)};this.tryParseRangeInfo=function(nc){var $c=jc.Z(nc,Eb.$.va);var od=$c.sheetName;nc=$c.range;return $c.returnValue?(od||(od=Eb.$.va.pa.sheetName),$c=[],$c.push(nc),nc=jc.u(od,null,$c),Object(Cb.a)(new Na,{rangeList:Eb.Ivb(nc.Ranges),sheetName:nc.SheetName})):null};this.Az=function(){var nc=Eb.UD!==Eb.$.ea.Ve;Eb.kF&&Eb.lineageTaskPane.isVisible&&nc&&(Eb.UD=Eb.$.ea.Ve,Eb.kF.onRefreshRequired())};this.$=Rb;qc.Ga(366,
this);qc.Ga(501,this);this.gridView=Vc.g(this.$);this.lineageTaskPane=Oc;this.ysd=this.lineageTaskPane.lM();this.batchSize=50;this.p7=jb;this.oLb=this.$.Fb.Lg("UserAction","LineagePaneLoadingShimmerStopWatch");this.zqc=Sd.a.instance.resolve("Common.App.People.IUserProfilePictureUtils");this.iai();this.PAg()}function ta(){this.hasOldValue=this.hasNewValue=!1;this.cellLocation=this.oldValue=this.newValue=null}function ab(){this.activityId=0;this.displayTimestamp=this.author=this.activityGuid=null;this.activityType=
0;this.rangeHighlightLocation=this.isBulkEditOverflow=this.valueChanges=this.gridLocation=this.sheetName=this.nestedActivityList=null;this.degradedCardTypeBits=0}function Na(){this.sheetName=this.rangeList=null}function Ka(){this.lastCol=this.firstCol=this.lastRow=this.firstRow=0}function la(){this.logger=this.uiCulture=this.dataCulture=null;this.clientBatchSize=0;this.lineageAppCallbacks=this.filterableSheetList=null}function Ea(){this.imageUrl=this.email=this.displayName=this.provider=this.id=null}
function ra(){this.onLearnMoreLinkClicked=this.isFeatureEnabled=this.onRangeFilterInputEnabled=this.tryParseRangeInfo=this.onVersionHistoryButtonClicked=this.onCardSelected=this.lineageUpdateViewRequest=this.lineageRefreshViewRequest=this.lineageLoadMoreRequest=this.lineageOpenPaneOrChangeFilterRequest=null}function na(){var Rb=ba.call(this)||this;Rb.hasNewActivities=!1;Rb.filterSheetMultiRange=null;return Rb}function ba(){this.activityList=null;this.oldestActivityId=this.latestActivityId=0;this.lastSearchedActivityTimestamp=
null;this.serverLastActivityId=this.serverFirstActivityId=this.serverMessageCode=0;this.docId=null;this.showLoadPrevious=!1;this.eolPersonHideHistory=this.eolDateHideHistory=this.eolCorrelationId=null}function sa(Rb,qc,Oc,jb,Eb,nc){nc=Rb.Na(1,void 0===nc?null:nc);return rd.g(Rb,"LineageClosePane",nc,qc,Oc,jb,Eb,0)}function ya(Rb,qc,Oc,jb,Eb,nc){nc=Rb.Na(1,void 0===nc?null:nc);return rd.g(Rb,"LineageUpdateView",nc,qc,Oc,jb,Eb,0)}function va(){}function W(){}function La(Rb){var qc=Hc.call(this)||this;
qc.$=Rb;qc.Eb();return qc}function Ia(Rb){this.ndb=!0;Ia.Yaf()?Ia.fbf()?(Da.ULS.sendTraceTag(526434368,0,50,"LineageCatchUpExperimentManager is running in hybrid mode. TUI exhausted: {0}",!Rb),this.ndb=Rb):this.ndb=!1:this.ndb=!0}function mb(Rb){return fe.call(this,Rb)||this}function fb(Rb,qc){this.$=Rb;this.lineageManager=qc;Rb=[new pe.a(Pb.a.Asd,1038647878,0,0,2210),new pe.a(Pb.a.idle,1038647878,0,1)];Bd.a(this.$).YGd(new Qd.a(Pb.a.zsd,Pb.a.idle,Rb),new Ma(Pb.a.Asd,Pb.a.idle,qc))}function Ma(Rb,
qc,Oc){Rb=Ye.call(this,Rb,qc)||this;Rb.lineageManager=Oc;return Rb}function Hb(Rb){var qc=Ee.call(this)||this;qc.$=Rb;qc.Eb();return qc}function Kb(Rb){return se.call(this,Rb)||this}function Ub(Rb){var qc=this;this.baseVersionInfo=this.l3=this.Foa=this.km=this.ewaAccessibilityManager=this.zNb=null;this.tHd=this.lrf=!1;this.WEe=!0;this.dialog=this.JB=this.iTe=this.oD=this.kZd=this.iZd=this.jZd=null;this.RAf=function(Oc){Da.ULS.sendTraceTag(42553885,0,50,"VersionHistoryPaneActor:OnRestoreVersionSelected - Restore is triggered");
if(qc.kyj()){var jb=function(nc){Ab.c(2138207060,!1);qc.km.setRestoreFailedAtServer(nc)};qc.oD&&qc.oD.startTimer(Ub.S8f);var Eb=function(){qc.oD.endTimer(Ub.S8f);qc.lwe(qc.oD)};qc.km.setRestoreInProgress();ic.a(qc.$).ft(new Ac.a(Pb.a.fz,5,function(){var nc=Bd.a(qc.$).fd.activityState;nc[ld.a.Rq]=Pb.a.Yye;nc[Bc.a.gY]=!0;nc[Bc.a.sT]=0;nc[oa.cfg]=Oc;nc[oa.Gqc]=Ta.AFrameworkApplication.aj;nc[oa.Qtd]=Eb;nc[ma.z3f]=jb}))}else Ab.c(2138207060,!1)};this.vDf=function(Oc){qc.zNb.then(function(jb){jb.enterFocusTrapZone();
return null});Da.ULS.sendTraceTag(537150349,0,50,"VersionHistoryPaneActor: OnVersionsReady called");qc.oD.endTimer(Ub.UUd);qc.oD.incrementCounter(Ub.J3g);Da.ULS.sendTraceTag(537150348,0,50,"VersionHistoryPaneActor: OnVersionsReady TimeTakenGetVersionsToOnVersionsReady Ms:{0}",qc.oD.getTimerDuration(Ub.UUd));qc.yfj(Oc.containerDiv);Oc.versions&&0<Oc.versions.length&&(qc.iTe=Ub.UE(Oc.versions[Oc.versions.length-1]));qc.l3&&qc.Foa&&qc.BMd(qc.l3);Da.ULS.sendTraceTag(537150346,0,50,"VersionHistoryPaneActor:OnVersionsReady Exit")};
this.onVersionSelected=function(Oc){Da.ULS.sendTraceTag(537150345,0,50,"VersionHistoryPaneActor:OnVersionSelected called. for Version:{0}, LastSelected:{1}",Ub.UE(Oc.currentVersion),Ub.UE(qc.l3));qc.oD.incrementCounter(Ub.I3g);qc.l3=Oc.currentVersion;qc.baseVersionInfo=Oc.baseVersion;qc.lrf=Oc.noBaseToCompareTo;qc.Foa&&qc.nVj()&&(qc.BMd(Oc.currentVersion),Da.ULS.sendTraceTag(537150344,0,50,"VersionHistoryPaneActor:OnVersionSelected Exit"))};this.Bvf=function(Oc){Da.ULS.sendTraceTag(537150337,0,50,
"VersionHistoryPaneActor:OnDownloadTokenReady called. for Version:{0} UpdatedVersionsCount{1}, LastSelected:{2}",(null===Oc||void 0===Oc?0:Oc.versionSelected)?Ub.UE(Oc.versionSelected.currentVersion):null,(null===Oc||void 0===Oc?0:Oc.updatedVersions)?Oc.updatedVersions.length:0,Ub.UE(qc.l3));qc.oD.incrementCounter(Ub.H3g);if(qc.baseVersionInfo){if((null===Oc||void 0===Oc?0:Oc.updatedVersions)&&2<=Oc.updatedVersions.length){var jb=null,Eb=null,nc=Ub.UE(qc.l3),$c=Ub.UE(qc.baseVersionInfo);Oc=ak(Oc.updatedVersions);
for(var od=Oc.next();!od.done;od=Oc.next()){od=od.value;var de=Ub.UE(od);nc===de?jb=od:$c===de&&(Eb=od);if(jb&&Eb)break}jb&&Eb?(qc.l3=jb,qc.baseVersionInfo=Eb,Da.ULS.sendTraceTag(537150307,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady -Calling versionsViewController:OnVersionSelected RevisionID[N]: {0}, RevisionID[N-1]: {1}.",Ub.UE(qc.l3),Ub.UE(qc.baseVersionInfo)),qc.BMd(qc.l3)):Da.ULS.sendTraceTag(537150306,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady - does not find currentVersion or baseVersion from UpdatedVersions. RevisionID[N]: {0}, RevisionID[N-1]: {1}.",
nc,$c)}else Da.ULS.sendTraceTag(537150305,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady - no diff call due to downloadTokenReadyObject or downloadTokenReadyObject.UpdatedVersions objects are null or not enough.");Da.ULS.sendTraceTag(537150304,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady")}else Da.ULS.sendTraceTag(537150336,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady baseVersionInfo is null in OnDownloadTokenReady callback.")};this.Cuf=function(){Da.ULS.sendTraceTag(537150303,0,50,
"VersionHistoryPaneActor:OnCloseVersionHistoryDialog Called");qc.tZg();var Oc=new Fb.a(1470556788,0,qc.$.Jc,0,null);qc.$.Ka.Kb(Oc)};this.hBf=function(Oc){Da.ULS.sendTraceTag(41739662,0,50,"VersionHistoryPaneActor:OnSaveACopy Called");var jb=new Fb.a(-1244760097,0,qc.$.Jc,0,null);qc.$.Lf.get(51)&&(Da.ULS.sendTraceTag(537150301,0,50,"VersionHistoryPaneActor:OnSaveACopy for ODConsumer Called"),jb=new Fb.a(-309686558,0,qc.$.Jc,0,null));Ab.c(1604651619,!0);var Eb={};qc.$.Ka.Kb(jb,(Eb.FileDownloadUrl=Oc,
Eb))};this.Cvf=function(Oc){Da.ULS.sendTraceTag(537150300,0,50,"VersionHistoryPaneActor:OnDownloadVersion Called");Oc=new ec.QueryStringBuilder(Oc);Oc.Ii("fn",Ta.AFrameworkApplication.fileName);Da.ULS.sendTraceTag(537150299,0,50,"VersionHistoryPaneActor:OnDownloadVersion URL Length is "+Oc.toString().length);8===qc.$.frame.F8a(Oc.toString(),!0)?(Da.ULS.sendTraceTag(587830283,0,10,"VersionHistoryPaneActor:OnDownloadVersion failed"),Ab.c(1316171850,!1)):Ab.c(1316171850,!0)};this.ftf=function(Oc){qc.km.setFullAppErrorCode(Oc)};
this.Kwf=function(Oc){switch(Oc){case 101:Oc="VHFailedToGetDownloadToken";break;case 100:Oc="VHFailedToLoadVersionList";break;case 104:Oc="VHVersioningNotEnabled";break;case 105:Oc="VHFileNotFound";break;case 106:Oc="VHVersionTooOld";break;default:Oc="None"}qc.oD.addEvent("OnFullAppError",Oc);Da.ULS.sendTraceTag(537150291,0,10,"FullApp Error Event: {0}",Oc)};this.XAd=function(Oc){qc.WEe=Oc;Da.ULS.sendTraceTag(537150290,0,50,"VersionHistoryPaneActor:Show Changes toggled to:{0}",Oc.toString());var jb=
{};qc.XMd(lc.a.dNb,(jb.ToggleValue=Oc,jb))};this.byf=function(Oc){Da.ULS.sendTraceTag(50405840,0,50,"VersionHistoryPaneActor:OnIteratorSelected next: {0}",Oc);Ab.c(1488635506,!0);var jb={};Oc?qc.XMd(lc.a.iterateNext,jb):qc.XMd(lc.a.exa,jb)};this.VGb=function(Oc){switch(Oc.MessageId){case wb.a.OTa:Da.ULS.sendTraceTag(537150289,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession WacAppCompleted ");eb.EwaSettings.ma(422)&&qc.km.setVersionLoadComplete();break;case wb.a.PTa:Da.ULS.sendTraceTag(51128035,
0,10,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession WacAppFailed");break;case lc.a.setCurrentChangeCount:Oc=Oc.Values.count;Da.ULS.sendTraceTag(537150288,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession SetCurrentChangeCount : {0}",Oc);qc.km.setCurrentChangeCount(Oc);break;case lc.a.setTotalChangesCount:Oc=Oc.Values.count;Da.ULS.sendTraceTag(537150287,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession SetTotalChangesCount : {0}",Oc);qc.km.setTotalChangesCount(Oc);
break;case lc.a.FOa:qc.XAd(qc.WEe);break;default:Da.ULS.sendTraceTag(537150286,0,15,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession MessageID:{0}",Oc.MessageId)}};this.$=Rb;this.E8b=this.$.yb+Ub.Fwh;this.sHd=!1;eb.EwaSettings.ma(388)&&this.Q$g();this.ZAb="";this.Trd=0;this.perfTelemetryInfos=[]}function gb(){this.perfTelemetryInfos=this.appSettings=this.docId=this.latestStreamServiceBase=this.serviceBase=this.ulsLogger=null}function Db(){this.appName=0;this.wdEnableDownloadTokens=!1;this.retryCount=
0;this.wdEnableIterator=this.wdEnableRestore=this.wdEnableSaveACopy=!1;this.uiLocale=this.wacCluster=this.userSessionId=null;this.disableSaveACopy=this.wdEnableShowVersionChanges=this.wdEnableHiddenButtonsUntilVersionLoadComplete=this.viewerRootPositionRelative=this.useXhr=this.isRtl=!1;this.disabledChangeGates=null;this.wdEnableDeleteVersions=this.wdEnableSaveACopyOverFlowMenu=!1;this.wdExperimentWithIteratorLocation=this.wdEnableAppColorUpdate=null}function Va(){this.telemetryCollector=this.baseVersionInfo=
this.selectedVersionInfo=null}function yb(){this.rootDiv=this.appBootSettings=null}function qb(){this.actionUrl=this.ulsLogger=null;this.useFetch=this.hideEmbedFooter=!1}function dc(Rb){this.ww=Rb}function bb(Rb){this.ww=Rb}function db(Rb){this.ww=Rb}function wc(){}function nb(Rb,qc){this.$=Rb;this.UVj=qc}function zb(Rb,qc){var Oc=kb.call(this)||this;Oc.activityName=Rb;Oc.nM=qc;Oc.Eb();return Oc}function ma(Rb,qc){return Ya.call(this,Rb,qc)||this}function P(Rb,qc,Oc){var jb=Aa.call(this)||this;jb.activityName=
Rb;jb.nM=qc;jb.IJ=Oc;jb.Eb();return jb}function oa(Rb,qc,Oc,jb,Eb){var nc=sb.call(this,Rb,qc)||this;nc.li=null;nc.retryCount=0;nc.EQi=function($c){var od=nc.$Mj($c);$c=od.MKd;od.returnValue?$c.Success?(Ab.c(2138207060,!0),Da.ULS.sendTraceTag(42287318,0,15,"RestoreVersionActivity:onRestoreSuccessCallback Restore version is successful")):(Ab.c(2138207060,!1),Da.ULS.sendTraceTag(42287317,0,10,"RestoreVersionActivity:onRestoreSuccessCallback Restore version failed with message {0}",$c.Output),nc.lh(nc.IJ)):
(Ab.c(2138207060,!1),nc.lh(nc.IJ));($c=nc.li.activityState[oa.Qtd])&&$c();nc.ep();nc.li.hM()};nc.DQi=function(){if(0<nc.retryCount)Da.ULS.sendTraceTag(537150418,0,15,"RestoreVersionActivity:onRestoreFailureCallback Retrying version restore, retry count : {0}",nc.retryCount),nc.retryCount--,nc.cTf();else{Da.ULS.sendTraceTag(42287320,0,10,"RestoreVersionActivity:onRestoreFailureCallback Restore version failed");Ab.c(2138207060,!1);nc.lh(nc.IJ);var $c=nc.li.activityState[oa.Qtd];$c&&$c();nc.ep();nc.li.hM()}};
nc.IJ=Oc;nc.S2=jb;nc.baseUrl=Eb;return nc}b.r(D);var Ja=b(11),$a=b(0),Ta=b(4),pa=b(232),Da=b(15),rb=b(115),Ab=b(187),ob=b(41),sb=rb.a;Rk(oa,sb);oa.prototype.execute=function(Rb){this.li=Rb;this.retryCount=3;this.cTf();return 1};oa.prototype.cTf=function(){var Rb=this.li.activityState[oa.Gqc],qc=this.li.activityState[oa.cfg],Oc=String.format("{0}{1}",this.baseUrl,"restoreversion.ashx");Rb=ob.c({VersionId:qc,QuerySignature:Rb});this.S2.Yl(Oc,2,Rb,{"Content-Type":"application/json; charset=utf-8"},!1,
2,this.EQi,this.DQi,null)};oa.prototype.$Mj=function(Rb){var qc=null;Rb=Rb?Rb.data?Rb.data.Ud:null:null;if(!Rb||!Rb.length)return Da.ULS.sendTraceTag(537150417,0,10,"RestoreVersionActivity:TryGetRestoreResult data returned from restoreversion call is null or empty"),{returnValue:!1,MKd:qc};Rb=ob.d(Rb);qc=Rb.Pt;return Rb.returnValue?{returnValue:!0,MKd:qc}:(Da.ULS.sendTraceTag(537150416,0,10,"RestoreVersionActivity:TryGetRestoreResult Failed in deserialization of returned data from restore version"),
{returnValue:!1,MKd:qc})};oa.cfg="RVAvi";oa.Gqc="RVAqs";oa.Qtd="RVlvrt";Object($a.a)(oa,"RestoreVersionActivity",rb.a,[]);var Pb=b(6),Aa=pa.a;Rk(P,Aa);P.prototype.create=function(){this.pb(new oa(this.activityName,this.nM,this.IJ,Ta.AFrameworkApplication.qd,Ta.AFrameworkApplication.ta.Pa.QV))};P.ka=function(Rb){Rb.da.Ga(320,new P(Pb.a.PKd,Pb.a.jj,Pb.a.QKd))};Object($a.a)(P,"RestoreVersionActivityFactory",pa.a,[]);var Ya=rb.a;Rk(ma,Ya);ma.prototype.execute=function(Rb){var qc=this;(0,Rb.activityState[ma.z3f])(function(){qc.ep();
Rb.hM()});return 1};ma.z3f="RVEAssea";Object($a.a)(ma,"RestoreVersionErrorActivity",rb.a,[]);var kb=pa.a;Rk(zb,kb);zb.prototype.create=function(){this.pb(new ma(this.activityName,this.nM))};zb.ka=function(Rb){Rb.da.Ga(321,new zb(Pb.a.QKd,Pb.a.jj))};Object($a.a)(zb,"RestoreVersionErrorActivityFactory",pa.a,[]);var lb=b(81),ac=b(905),Dc=b(51),Zb=b(37),mc=b(186),Lb=b(391),Sa=b(58);nb.prototype.Lc=function(){return Ta.AFrameworkApplication.fa.ra("IsAnonymousUser")?(Da.ULS.sendTraceTag(537150415,0,15,
"Verison History Command Handler: Anonymous user."),!0):!1};nb.prototype.executeCommand=function(Rb,qc){Da.ULS.sendTraceTag(537150414,0,50,"VersionHistoryCommandHandler:ExecuteCommand called.");Rb=!1;switch(qc.command){case -1112508866:Lb.a(this.$)&&this.$.da.za(423).Axc(!1),Rb=this.UVj.zBj()}Da.ULS.sendTraceTag(537150413,0,50,"VersionHistoryCommandHandler:ExecuteCommand response{0}.",Rb);return Rb?Sa.Task.Ua(Rb):mc.a(qc.command)};nb.prototype.Ac=function(Rb,qc){return-1112508866===qc.command&&this.$.isVersionHistoryEnabled()};
nb.prototype.Qc=function(){return!1};Object($a.a)(nb,"VersionHistoryCommandHandler",null,[403]);var Cb=b(7),ec=b(262),wb=b(170),rc=b(411),Mc=b(25);wc.addAppPLTEventToLog=function(Rb){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(Rb)}catch(qc){}};wc.setIsPageLoadForFirstTime=function(Rb){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(Rb)}catch(qc){}};Object($a.a)(wc,"VersionHistoryLogConnector",null,[]);var Pc=b(1030),Kc=b(1444),ub=b(160),
Fb=b(92),pc=b(29),eb=b(1),ic=b(42),Ac=b(260),lc=b(1190),Gc=b(273),ed=b(256),fd=b(12);db.prototype.Oh=function(){Gc.a(this.ww.$).FM(this.Zd)||Gc.a(this.ww.$).Oh(this)};db.prototype.Q7=function(){Gc.a(this.ww.$).FM(this.Zd)&&Gc.a(this.ww.$).Gz(this)};db.prototype.$g=function(Rb){return fd.DOMElementExtensions.nf(this.jc,Rb)};db.prototype.hj=function(){this.ww.$.frame.ye.Jj(this.ww.$.frame.ye.zE)};db.prototype.Dj=function(){};db.prototype.Uf=function(Rb,qc){qc||this.ww.zNb.then(function(Oc){Oc.enterHeaderFocusTrapZone();
return null});return!qc};Af.Object.defineProperties(db.prototype,{Zd:{configurable:!0,enumerable:!0,get:function(){return ed.a.$eg}},jc:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[id="vhHeader"]')}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object($a.a)(db,"VersionHistoryHeader",null,[422]);bb.prototype.Oh=function(){Gc.a(this.ww.$).FM(this.Zd)||Gc.a(this.ww.$).Oh(this)};bb.prototype.Q7=function(){Gc.a(this.ww.$).FM(this.Zd)&&Gc.a(this.ww.$).Gz(this)};
bb.prototype.$g=function(Rb){return fd.DOMElementExtensions.nf(this.jc,Rb)};bb.prototype.hj=function(){this.ww.$.frame.ye.Jj(this.ww.$.frame.ye.zE)};bb.prototype.Dj=function(){};bb.prototype.Uf=function(Rb,qc){qc||this.ww.zNb.then(function(Oc){Oc.enterFocusTrapZone();return null});return!qc};Af.Object.defineProperties(bb.prototype,{Zd:{configurable:!0,enumerable:!0,get:function(){return ed.a.afg}},jc:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[aria-describedby="versionHistoryPane"]')}},
canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object($a.a)(bb,"VersionHistoryPane",null,[422]);dc.prototype.Oh=function(){Gc.a(this.ww.$).FM(this.Zd)||Gc.a(this.ww.$).Oh(this)};dc.prototype.Q7=function(){Gc.a(this.ww.$).FM(this.Zd)&&Gc.a(this.ww.$).Gz(this)};dc.prototype.$g=function(Rb){return fd.DOMElementExtensions.nf(this.jc,Rb)};dc.prototype.hj=function(){this.ww.$.frame.ye.Jj(this.ww.$.frame.ye.zE)};dc.prototype.Dj=function(){};dc.prototype.Uf=function(Rb,qc){qc||
this.ww.zNb.then(function(Oc){Oc.enterViewerFocusTrapZone();return null});return!qc};Af.Object.defineProperties(dc.prototype,{Zd:{configurable:!0,enumerable:!0,get:function(){return ed.a.bfg}},jc:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[id="vhViewer"]')}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object($a.a)(dc,"VersionHistoryViewer",null,[422]);var Bc=b(147),ld=b(263),Bd=b(67),xb=b(446),Fd=b(973);Object($a.a)(qb,"AppBootSettings",
null,[]);Object($a.a)(yb,"AppVersionControllerFactoryParameters",null,[]);Object($a.a)(Va,"OnVersionSelectedParams",null,[]);Object($a.a)(Db,"AppSettings",null,[]);Object($a.a)(gb,"ControllerFactoryParameters",null,[]);Ub.prototype.dispose=function(){this.Lxe()};Ub.prototype.vZi=function(){var Rb=this;this.$.da.Za(15,function(qc){Rb.ewaAccessibilityManager=qc;Rb.ewaAccessibilityManager.mode=2})};Ub.prototype.Q$g=function(){this.jZd=new bb(this);this.iZd=new db(this);this.kZd=new dc(this)};Ub.prototype.zBj=
function(){var Rb=this;Da.ULS.sendTraceTag(41739649,0,15,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction called");Ta.AFrameworkApplication.cN("Microsoft.Office.Excel.Server.Flighting.IDenyListExcelVersionHistoryEnableODCSaveACopy");Ta.AFrameworkApplication.cN("Microsoft.Office.Excel.Server.Flighting.IDenyListVersionHistorySaveACopyOverFlowMenu");Ta.AFrameworkApplication.cN("Microsoft.Office.Excel.Server.Flighting.IDenyListExcelVersionHistoryRestoreSkipCoauthCheck");this.oD=excelVersionHistory.FactoryGlobal.getTelemetryCollector();
this.perfTelemetryInfos=[];this.oD.startTimer(Ub.R8f);if(!this.km&&(xb.a(function(){Rb.km=versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(Object(Cb.a)(new gb,{ulsLogger:new rc.a,docId:Ta.AFrameworkApplication.aj,appSettings:Object(Cb.a)(new Db,{appName:120,userSessionId:Ta.AFrameworkApplication.userSessionId,wdEnableSaveACopy:eb.EwaSettings.ma(356),wdEnableDownloadTokens:eb.EwaSettings.ma(351),wacCluster:Ta.AFrameworkApplication.qd.vS,uiLocale:Ta.AFrameworkApplication.uiCulture||
"en-us",wdEnableRestore:eb.EwaSettings.ma(322)&&Rb.$.isEditMode,wdEnableIterator:eb.EwaSettings.ma(319)&&eb.EwaSettings.ma(320),useXhr:Mc.a.YZ,wdEnableHiddenButtonsUntilVersionLoadComplete:eb.EwaSettings.ma(422),disableSaveACopy:Rb.a1f(),wdEnableShowVersionChanges:eb.EwaSettings.ma(319)&&eb.EwaSettings.ma(321),disabledChangeGates:Rb.$.ya.VHSDisabledChangeGates,wdEnableSaveACopyOverFlowMenu:eb.EwaSettings.ma(545),isRtl:Ta.AFrameworkApplication.isRtl}),perfTelemetryInfos:Rb.perfTelemetryInfos}))}),
!this.km))return Da.ULS.sendTraceTag(537150352,0,10,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction - VersionHistoryController should not be null"),Ab.c(429638140,!1),!1;this.ABj();this.oD.endTimer(Ub.R8f);this.oD.startTimer(Ub.U8f);Da.ULS.sendTraceTag(537150351,0,50,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction Returned Success");Ab.c(429638140,!0);return!0};Ub.prototype.ABj=function(){this.Ti();if(!document.getElementById(this.E8b)){var Rb=document.createElement("div");Rb.id=this.E8b;
Rb.style.width="100%";Rb.style.zIndex="998";Rb.style.display="block";Rb.style.position="absolute";Ta.AFrameworkApplication.ta.Pa.Pf?(Rb.style.top=document.getElementById("HeaderRegion").offsetHeight+"px",Rb.style.bottom="0px"):Rb.style.height="100%";this.$.Wq.insertBefore(Rb,this.$.Wq.firstChild);this.zNb=this.km.createVersionHistoryDialog(Rb)}document.getElementById(this.E8b).style.display="block";this.jHd();this.oD.startTimer(Ub.UUd);this.km.getVersions("")};Ub.prototype.jHd=function(){eb.EwaSettings.ma(388)&&
(this.jZd.Oh(),this.iZd.Oh(),this.kZd.Oh(),this.vZi())};Ub.prototype.iXd=function(){eb.EwaSettings.ma(388)&&(this.jZd.Q7(),this.iZd.Q7(),this.kZd.Q7(),this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0))};Ub.prototype.Ti=function(){this.km.getVersionsReadyEvent().addListener(this.vDf);this.km.getVersionSelectedEvent().addListener(this.onVersionSelected);this.km.getCloseSelectedEvent().addListener(this.Cuf);this.km.getFullAppErrorEvent().addListener(this.Kwf);this.km.getIteratorSelectedEvent().addListener(this.byf);
this.km.getShowVersionChangesToggledEvent().addListener(this.XAd);eb.EwaSettings.ma(351)&&(this.km.getDownloadTokenReadyEvent().addListener(this.Bvf),this.sHd=!0);eb.EwaSettings.ma(356)&&(this.km.getSaveACopySelectedEvent().addListener(this.hBf),this.km.getDownloadVersionSelectedEvent().addListener(this.Cvf));eb.EwaSettings.ma(322)&&this.$.isEditMode&&(this.km.getRestoreVersionSelectedEvent().addListener(this.RAf),this.tHd=!0);this.Foa&&this.Foa.getAppErrorEvent().addListener(this.ftf)};Ub.prototype.Uj=
function(){this.km.getVersionsReadyEvent().removeListener(this.vDf);this.km.getVersionSelectedEvent().removeListener(this.onVersionSelected);this.km.getCloseSelectedEvent().removeListener(this.Cuf);this.km.getFullAppErrorEvent().removeListener(this.Kwf);this.km.getIteratorSelectedEvent().removeListener(this.byf);this.km.getShowVersionChangesToggledEvent().removeListener(this.XAd);eb.EwaSettings.ma(356)&&(this.km.getSaveACopySelectedEvent().removeListener(this.hBf),this.km.getDownloadVersionSelectedEvent().removeListener(this.Cvf));
this.sHd&&(this.km.getDownloadTokenReadyEvent().removeListener(this.Bvf),this.sHd=!1);this.tHd&&(this.km.getRestoreVersionSelectedEvent().removeListener(this.RAf),this.tHd=!1);this.Foa&&this.Foa.getAppErrorEvent().removeListener(this.ftf)};Ub.prototype.kyj=function(){var Rb=!0;if(eb.EwaSettings.ma(607)&&!this.$.OQ)return Da.ULS.sendTraceTag(537150350,0,15,"VersionHistoryPaneActor:ShouldTriggerRestore - Skipping coauth check with status "+this.$.ea.amIAlone.toString()),!0;if(!this.$.ea.amIAlone&&!eb.EwaSettings.ma(318)){this.Tti();
this.km.setCoauthRestoreError();Rb=!1;var qc=new Fb.a(-729359593,0,this.$.Jc,0,null);this.$.Ka.Kb(qc)}this.$.OQ&&(Da.ULS.sendTraceTag(42522439,0,10,"VersionHistoryPaneActor:ShouldTriggerRestore - Restore failed, Unsaved changes present"),Rb&&(Rb=!1,this.yBj()));return Rb};Ub.prototype.yBj=function(){var Rb=pc.a.Wc(1,0,1878,1877,0,-1603358883,"RestoreVersionUnsavedChangesError");Rb=this.dialog||new ub.ErrorDialog(this.$,Rb);Rb.initialize();Rb.hf()};Ub.prototype.nVj=function(){Da.ULS.sendTraceTag(537150343,
0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters called for BaseVersion{0}",this.baseVersionInfo?Ub.UE(this.baseVersionInfo):"");if(Ub.UE(this.l3)===this.iTe)return Da.ULS.sendTraceTag(537150342,0,15,"VersionHistoryPaneActor:ValidateDiffDiffParameters for last version"),!0;if(eb.EwaSettings.isChangeGateEnabled("OfficeVSO:4381797_XLVHSkipBaseVersionValidateForGroupingUI")&&!this.baseVersionInfo&&this.lrf)return Da.ULS.sendTraceTag(537150341,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters skipping diff last version"),
!0;if(!this.baseVersionInfo)return Da.ULS.sendTraceTag(537150340,0,10,"VersionHistoryPaneActor:ValidateDiffDiffParameters for null BaseVersion"),!1;var Rb=Ub.WMh(this.baseVersionInfo);Da.ULS.sendTraceTag(537150339,0,50,"downloadURL length {0}",Rb?Rb.length:0);return Rb?!0:(Da.ULS.sendTraceTag(537150338,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters downloadURL is null"),!1)};Ub.prototype.a1f=function(){return!this.$.nka};Ub.prototype.tZg=function(){document.getElementById(this.E8b).style.display=
"none";var Rb=new Fb.a(-1423792966,0,this.$.Jc,0,null);this.$.Ka.Kb(Rb);this.Lxe()};Ub.prototype.Lxe=function(){this.oD&&(this.oD.endTimer(Ub.U8f),this.lwe(this.oD),this.oD=null);this.Uj();this.iXd();this.perfTelemetryInfos&&(Da.ULS.sendTraceTag(537150302,0,15,this.perfTelemetryInfos.toString()),this.perfTelemetryInfos=null);this.JB&&(this.JB.roa(wb.a.OTa),this.JB.roa(wb.a.PTa),this.JB.roa(lc.a.setCurrentChangeCount),this.JB.roa(lc.a.setTotalChangesCount),eb.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&
this.JB.roa(lc.a.FOa),this.JB.dispose(),this.JB=null)};Ub.prototype.yfj=function(Rb){var qc=this;try{this.Foa?wc.setIsPageLoadForFirstTime(!1):(wc.setIsPageLoadForFirstTime(!0),xb.a(function(){var Oc=new qb;Oc.ulsLogger=new rc.a;Oc.actionUrl=qc.$.ya.VersionHistoryActionUrl;Oc.hideEmbedFooter=!0;Oc.useFetch=eb.EwaSettings.ma(417)&&!Mc.a.Vu;qc.Foa=excelVersionHistory.FactoryGlobal.getAppVersionControllerInstance(Object(Cb.a)(new yb,{appBootSettings:Oc,rootDiv:Rb}))}))}catch(Oc){Da.ULS.sendTraceTag(41239239,
0,10,"VersionHistoryPaneActor: ResetAppVersionController failed due to exception. {0}",Oc)}};Ub.prototype.BMd=function(Rb){Da.ULS.sendTraceTag(537150298,0,50,"VersionHistoryPaneActor:SelectVersion called. for Version:{0}, LastSelected:{1}",Ub.UE(Rb),this.ZAb);if(Rb)if(Ub.UE(Rb).length){var qc=(new Date).getTime();if(Ub.UE(Rb)===this.ZAb&&1E3>qc-this.Trd)Da.ULS.sendTraceTag(537150295,0,50,"VersionHistoryPaneActor:SelectVersion reattempt within 1 sec");else{Ub.UE(Rb)!==this.ZAb&&(Da.ULS.sendTraceTag(537150294,
0,50,"VersionHistoryPaneActor:Reset Iterator states if user clicks on different version"),this.km.setTotalChangesCount(-1),this.km.setCurrentChangeCount(-1));var Oc=excelVersionHistory.FactoryGlobal.getTelemetryCollector();Oc.addEvent("SelectVersion",Ub.UE(Rb));try{this.SXj(Oc);this.Trd=qc;this.ZAb=Ub.UE(Rb);var jb=new Va;jb.selectedVersionInfo=this.l3;jb.baseVersionInfo=this.baseVersionInfo;jb.telemetryCollector=Oc;this.Foa.onVersionSelectedWithParams(jb);this.km&&eb.EwaSettings.ma(356)&&this.km.setDisableSaveACopy(this.a1f());
var Eb=document.getElementById(Ub.Ewh);Eb&&!this.JB&&(Da.ULS.sendTraceTag(537150293,0,50,"VersionHistoryPaneActor: SelectVersion Lazy instantiate VersionHistoryMessenger"),this.JB=new lc.a(Eb.contentWindow,lb.a.Maa(this.$.ya.VersionHistoryActionUrl)||Fd.a.O9),this.JB.Ml(wb.a.OTa,this.VGb),this.JB.Ml(wb.a.PTa,this.VGb),this.JB.Wn(lc.a.setCurrentChangeCount),this.JB.Wn(lc.a.setTotalChangesCount),eb.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&this.JB.Wn(lc.a.FOa),
this.JB.Ml(lc.a.setCurrentChangeCount,this.VGb),this.JB.Ml(lc.a.setTotalChangesCount,this.VGb),eb.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&this.JB.Ml(lc.a.FOa,this.VGb))}catch(nc){this.Trd=0,this.ZAb="",Oc.addEvent("Exception",nc.toString()),Da.ULS.sendTraceTag(42016832,0,10,"VersionHistoryPaneActor: OnVersionSelected failed due to exception. {0}",nc)}finally{Da.ULS.sendTraceTag(537150292,0,50,Oc?Oc.getJsonForLogging():"")}}}else Da.ULS.sendTraceTag(537150296,
0,50,"VersionHistoryPaneActor:SelectVersion selectedVersion RevisionId is null");else Da.ULS.sendTraceTag(537150297,0,50,"VersionHistoryPaneActor:SelectVersion selectedVersion is null")};Ub.prototype.SXj=function(Rb){for(var qc=ak(this.perfTelemetryInfos),Oc=qc.next();!Oc.done;Oc=qc.next()){var jb=Oc.value;Oc=jb.TelemetryEventKey?jb.TelemetryEventKey:jb.telemetryEventKey?jb.telemetryEventKey:"";jb=jb.TelemetryEventData?jb.TelemetryEventData:jb.telemetryEventData?jb.telemetryEventData:"";Oc&&jb&&Rb.addEvent(Oc,
jb)}Array.clear(this.perfTelemetryInfos)};Ub.prototype.lwe=function(Rb){Da.ULS.sendTraceTag(42553886,0,15,"VersionHistoryPaneActor:CaptureSessionTelemetry - {0} ",Rb?Rb.getJsonForLogging():"")};Ub.prototype.Tti=function(){for(var Rb=this.$.ea.Dm,qc={},Oc=null,jb=ak(Rb),Eb=jb.next();!Eb.done;Eb=jb.next())Eb=Eb.value,Eb.UserEmail&&(qc[Eb.UserEmail]=Eb.UserEmail in qc?qc[Eb.UserEmail]+1:1),Eb.User.UserID===this.$.ea.clientId&&(Oc=Eb.UserEmail);Da.ULS.sendTraceTag(42522438,0,10,"VersionHistoryPaneActor:LogCoauthorsTelemetry Restore failed, TotalAuthors: {0}, TotalAuthorsAsYourself {1}",
Rb.length,Oc?qc[Oc]:-1)};Ub.prototype.XMd=function(Rb,qc){Da.ULS.sendTraceTag(537150285,0,50,"VersionHistoryPaneActor.SendPostMessageToTheVHSession called with MessageID:{0}",Rb);if(this.JB){Rb=new Pc.a(Rb);Rb.Values[Kc.a.h4c]=this.$.ya.UserSessionId;if(qc)for(var Oc in qc)Rb.Values[Oc]=qc[Oc];this.JB.send(Rb)}else Da.ULS.sendTraceTag(537150284,0,10,"VersionHistoryPaneActor.SendPostMessageToTheVHSession versionHistoryMessenger is null")};Ub.UE=function(Rb){return Rb?Rb.RevisionID?Rb.RevisionID:Rb.revisionID?
Rb.revisionID:"":""};Ub.WMh=function(Rb){return Rb?Rb.DownloadUrl?Rb.DownloadUrl:Rb.downloadUrl?Rb.downloadUrl:"":""};Ub.Fwh="_excelVersionHistoryOverlay";Ub.Ewh="vhs_frame";Ub.R8f="TimeTakenShowVersionHistoryDialogAction";Ub.U8f="TimeTillVersionHistoryDialogWasOpenMs";Ub.UUd="TimeTakenGetVersionsToOnVersionsReady";Ub.I3g="CountOnVersionSelectedCalledinOneVHSession";Ub.J3g="CountOnVersionsReadyCalledinOneVHSession";Ub.H3g="CountOnDownloadTokenReadyCalledinOneVHSession";Ub.S8f="TimeTakenVersionRestore";
Object($a.a)(Ub,"VersionHistoryPaneActor",null,[10]);var Vd=b(259),se=ac.a;Rk(Kb,se);Kb.prototype.zd=function(){var Rb=this,qc=this.cti(),Oc=Dc.GetServiceTaskFactory.Ra(this.$.da,21,137,this.hb);Zb.TaskExtensions.Ba(Zb.TaskExtensions.Wd([qc,Oc],this.la,3),function(){var jb=Oc.result,Eb=lb.a.Maa(Rb.$.ya.VersionHistoryActionUrl);Eb!==Fd.a.O9&&jb.sFa(Eb);jb=new Ub(Rb.$);Rb.jd([new nb(Rb.$,jb)])},this.la,3)};Kb.prototype.cti=function(){var Rb=Dc.GetServiceTaskFactory.O3a(this.$.da,283,284,this.hb).then(function(qc){return qc.tn.loadScript("excelVersionHistory")},
function(qc){Da.ULS.sendTraceTag(537150412,0,10,"versionHistoryManagerFactory: Dynamic Script Loading failed due to exception. {0}",qc);return Promise.reject(qc)});return Vd.c(Rb)};Kb.ka=function(Rb){ac.a.Qd(304,new Kb(Rb))};Object($a.a)(Kb,"VersionHistoryCommandHandlerFactory",ac.a,[]);var ue=b(1465),Ee=pa.a;Rk(Hb,Ee);Hb.prototype.create=function(){var Rb=this,qc=Dc.GetServiceTaskFactory.Ra(this.$.da,211,212,this.hb),Oc=Dc.GetServiceTaskFactory.Ra(this.$.da,21,137,this.hb);Zb.TaskExtensions.Ba(Zb.TaskExtensions.Wd([qc,
Oc],this.$.la),function(){Rb.pb(Rb.$.da.za(305)||new ue.a(Rb.$,!0,Oc.result,qc.result))},this.$.la,3)};Hb.ka=function(Rb){Rb.da.Ga(306,new Hb(Rb))};Object($a.a)(Hb,"VersionHistoryHighlightManagerFactory",pa.a,[]);var qe=b(559),He=b(5),Ie=b(168),ef=b(14),Ye=rb.a;Rk(Ma,Ye);Ma.prototype.execute=function(Rb){this.lineageManager.lineageHidePreviousHistory();return Ye.prototype.execute.call(this,Rb)};Object($a.a)(Ma,"LineageClearHistoryConfirmedActivity",rb.a,[]);var pe=b(16),Qd=b(145);fb.prototype.Lc=
function(){return!1};fb.prototype.executeCommand=function(Rb,qc,Oc){Rb=!1;switch(qc.command){case 1834994092:9===qc.Me&&this.RGj();this.Zyj(qc,Oc);Rb=!0;break;case -409942531:this.azj(),Rb=!0}return Rb?Sa.Task.Ua(!0):mc.a(qc.command)};fb.prototype.Ac=function(Rb,qc){return 1834994092===qc.command||-409942531===qc.command};fb.prototype.Qc=function(){return!1};fb.prototype.Zyj=function(Rb,qc){Da.ULS.sendTraceTag(537155483,0,50,"LineageActivityCommandHandler::ShowChangesCore command location: {0}",qc.MenuItemId||
Rb.Me);this.lineageManager.X2f(19===Rb.Me&&!!qc.MenuItemId,qc.MenuItemId,Rb.Me)};fb.prototype.RGj=function(){var Rb=He.a.Xqc;Rb!==Ie.a(this.$).Ql.AB&&Ie.a(this.$).Ql.activateRibbonTab(Rb)};fb.prototype.azj=function(){var Rb=this;ic.a(this.$).ft(new Ac.a(Pb.a.zsd,5,function(){var qc=Bd.a(Rb.$).fd,Oc=pc.a.Wc(3,1,2207,2208,2209,1038647878,"LineageConfirmClearHistory");Oc.HelpTopicId="a1493bf9-25c3-470a-b970-60eceb0136e5";Oc.HelpDescription=ef.a.instance.ga(1300);qc.Bt([Oc])}))};Object($a.a)(fb,"LineageActivityCommandHandler",
null,[403]);var fe=ac.a;Rk(mb,fe);mb.prototype.zd=function(){var Rb=this;Zb.TaskExtensions.Ba(Dc.GetServiceTaskFactory.Ra(this.$.da,366,367,this.hb),function(qc){Rb.jd([new fb(Rb.$,qc.result)])},this.la,3)};mb.ka=function(Rb){ac.a.Qd(363,new mb(Rb))};Object($a.a)(mb,"LineageActivityCommandHandlerFactory",ac.a,[]);Ia.prototype.i6a=function(){return!this.ndb};Ia.fbf=function(){return Ia.Yaf()&&eb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationTeachingUXTreatmentToControl",
!1)};Ia.Yaf=function(){return eb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationSummaryStringTreatment",!1)};Object($a.a)(Ia,"LineageCatchUpExperimentManager",null,[863]);var Hc=pa.a;Rk(La,Hc);La.prototype.create=function(){var Rb=this;Ia.fbf()?Zb.TaskExtensions.Ba(Dc.GetServiceTaskFactory.Ra(this.$.da,456,457,this.hb),function(qc){Zb.TaskExtensions.Ba(qc.result.yxj(),function(Oc){Rb.OCe(Oc.result)},Rb.$.la,3)},this.$.la,3):this.OCe(!0)};La.prototype.OCe=function(Rb){this.pb(this.$.da.za(458)||
this.$.da.Ga(458,new Ia(Rb)))};La.ka=function(Rb){Rb.da.Ga(459,new La(Rb))};Object($a.a)(La,"LineageCatchUpExperimentManagerFactory",pa.a,[]);var ud=b(441),Gd=b(36),jd=b(276),Sd=b(84),Wd=b(154),Le=b(124);Object($a.a)(W,"LineageClientParams",null,[]);Object($a.a)(va,"LineageFilter",null,[]);var Pd=b(64),Re=b(76),Qe=b(133),jc=b(45),Fa=b(564),Qb=b(177),cb=b(121),Xb=b(110),kc=b(296),Wc=b(295),id=b(95),Vc=b(21),td=b(134),rd=b(61),za=b(50),tb=b(356);Object($a.a)(ba,"LineageActivitiesResponseDTO",null,[]);
Rk(na,ba);Object($a.a)(na,"LineageActivitiesUpdateResponseDTO",ba,[]);Object($a.a)(ra,"LineageAppCallbacks",null,[]);Object($a.a)(Ea,"LineageAuthorDTO",null,[]);Object($a.a)(la,"LineageControllerFactoryParams",null,[]);Object($a.a)(Ka,"LineageSharedRangeDTO",null,[]);Object($a.a)(Na,"LineageSheetMultiRangeDTO",null,[]);Object($a.a)(ab,"LineageUserActivityDTO",null,[]);Object($a.a)(ta,"LineageValueChangeDTO",null,[]);xa.prototype.dispose=function(){this.f$i();this.$=null;this.lineageTaskPane&&(this.lineageTaskPane.VN(this.onPaneClosed),
this.lineageTaskPane.GF(this.Az),this.lineageTaskPane=null);this.oLb=this.zqc=this.xtb=this.ysd=this.kF=null};xa.prototype.Xzj=function(){return Object(jd.a)(this,void 0,void 0,function qc(){var Oc=this,jb;return Km(qc,function(Eb){jb=Oc;return Eb.return(new Promise(function(nc){function $c(ae,ze,Xd){var te=jb.$.oa.xa;ae=Wc.b(ae,od);ze=Wc.a(ze,de);var af=te.Na(1,null);return rd.g(te,"LineageLoadInGridBlueDots",af,ae,ze,Xd,null,0)}function od(ae){if(ae=kc.a(ae)?null:ae.Result){var ze={};ze=(ze.CountOfActivities=
ae.ActivityList.length,ze);td.b(jb.$).Cd(Qe.a.esi,ze);ae=jb.wqc(ae.ActivityList);nc(ae)}else Da.ULS.shipAssertTag(520717854,0,!!ae,"LineageManager LineageLoadInGridBlueDots returned null response.")}function de(ae){ae=cb.a.Of(ae.data);Da.ULS.sendTraceTag(520717856,0,50,"LineageManager::LineageLoadInGridBlueDots service call failed. Errors: [{0}]",pc.a.Dc(ae))}Da.ULS.sendTraceTag(520717857,0,50,"LineageManager::showInGridBlueDots");td.b(jb.$).Cd(Qe.a.lineageLoadInGridBlueDots,{});eb.EwaSettings.Zb()?
jb.$.userOperationManager.Sb(new Qb.a(1024,0,$c,80),null):jb.$.userOperationManager.Sb(new Fa.a(1024,0,$c,16),null)}))})})};xa.prototype.X2f=function(Rb,qc,Oc){if(this.lineageTaskPane.isVisible){if(9===Oc){Da.ULS.sendTraceTag(560989858,0,50,"LineageManager::ShowLineageTaskPane open from callout was invoked with an opened pane");return}if(!Rb&&16!==Oc&&18!==Oc){this.lineageTaskPane.x0c();return}}Gd.a.ud(this.$)||(this.oLb.start(),this.p7&&(za.b().wA(this.oLb.id,this.p7.id,"actions","actions"),this.p7.stop(),
this.p7=null));this.lineageTaskPane.Bgc||Da.ULS.sendTraceTag(537155482,0,50,"LineageManager::ShowLineageTaskPane pane reopened by user via {0}",Rb?qc:Oc);this.UD=this.$.ea.Ve;this.xtb=null;Rb&&(Rb=jc.r(this.gridView.ha.sa.selectedRanges,this.$),this.xtb=Object(Cb.a)(new Na,{rangeList:qc.toString()===He.a.p2f?this.Ivb(Rb.Ranges):null,sheetName:Rb.SheetName}));Gd.a.ud(this.$)&&this.lineageTaskPane.Bgc?this.lineageTaskPane.Yqj(this.mEb):this.kF.createLineagePane(this.ysd,this.xtb);this.lineageTaskPane.$f(!0);
this.$.Fd(-71295319,-1,0,null)};xa.prototype.lineageHidePreviousHistory=function(){function Rb(jb,Eb,nc){var $c=qc.$.oa.xa,od=$c.Na(1,null);return rd.g($c,"LineageHidePreviousHistory",od,jb,Eb,nc,null,0)}var qc=this,Oc={};Oc=(Oc.paneVisible=this.lineageTaskPane.isVisible,Oc);Wd.a.sendTelemetryEvent(Object(Cb.a)(new tb.a,{name:"Office.Excel.Online.Lineage.ClearHistoryConfirmed",dataFields:Le.a.gl(Oc)}));eb.EwaSettings.Zb()?this.$.userOperationManager.Sb(new Qb.a(1018,0,Rb,64),null):this.$.userOperationManager.Sb(new Fa.a(1018,
0,Rb,0),null);this.lineageTaskPane.isVisible||this.X2f(!1,null,4)};xa.prototype.iai=function(){var Rb=this,qc=Object(Cb.a)(new ra,{tryParseRangeInfo:this.tryParseRangeInfo,isFeatureEnabled:this.isFeatureEnabled,onCardSelected:this.onCardSelected,onVersionHistoryButtonClicked:this.onVersionHistoryButtonClicked,onRangeFilterInputEnabled:this.onRangeFilterInputEnabled,onLearnMoreLinkClicked:this.onLearnMoreLinkClicked,lineageOpenPaneOrChangeFilterRequest:this.lineageOpenPaneOrChangeFilterRequest,lineageLoadMoreRequest:this.lineageLoadMoreRequest,
lineageRefreshViewRequest:this.lineageRefreshViewRequest,lineageUpdateViewRequest:this.lineageUpdateViewRequest});xb.a(function(){Rb.kF=cellLineage.LineageActivityControllerFactoryGlobal.createLineageActivityController(Object(Cb.a)(new la,{clientBatchSize:Rb.batchSize,filterableSheetList:Rb.c4a(),uiCulture:Rb.$.ya.UICultureTag,dataCulture:Rb.$.ya.DataCultureTag,logger:new rc.a,lineageAppCallbacks:qc}))})};xa.prototype.ped=function(Rb){var qc=this;return function(Oc){if(Oc=kc.a(Oc)?null:Oc.Result){var jb=
{};jb=(jb.CountOfActivities=Oc.ActivityList.length,jb);jb.WebRequestName=Rb;td.b(qc.$).Cd(Qe.a.wLi,jb);Oc=Object(Cb.a)(new ba,{activityList:qc.wqc(Oc.ActivityList),latestActivityId:Oc.LastSearchedActivityId,oldestActivityId:Oc.FirstSearchedActivityId,serverMessageCode:Oc.LineageResponseCode,lastSearchedActivityTimestamp:new Date(Oc.EcmaLastSearchedDate),serverFirstActivityId:Oc.ServerFirstActivityId,serverLastActivityId:Oc.ServerLastActivityId,showLoadPrevious:Oc.ShowLoadPrevious,eolCorrelationId:Oc.EolCorrelationId,
eolDateHideHistory:new Date(Oc.EolDateHideHistory),eolPersonHideHistory:qc.Bvb(Oc.EolPersonHideHistory)});qc.kF.onLineageActivitiesResponse(Oc)}else Da.ULS.shipAssertTag(537155477,0,!!Oc,"LineageManager."+Rb+" returned null response.")}};xa.prototype.zLj=function(Rb){return Xb.e(Rb.Ranges)&&!Rb.SheetName?null:Object(Cb.a)(new Na,{rangeList:this.Ivb(Rb.Ranges),sheetName:Rb.SheetName})};xa.prototype.Ivb=function(Rb){var qc=[];Rb=ak(Rb);for(var Oc=Rb.next();!Oc.done;Oc=Rb.next())Oc=Oc.value,Oc=Object(Cb.a)(new Ka,
{firstCol:Oc.FirstColumn,firstRow:Oc.FirstRow,lastRow:Oc.LastRow,lastCol:Oc.LastColumn}),qc.push(Oc);return qc};xa.prototype.JLj=function(Rb){if(!Rb)return null;var qc={};qc.Ranges=this.pfd(Rb.rangeList);qc.SheetName=Rb.sheetName;return qc};xa.prototype.pfd=function(Rb){var qc=[];if(Xb.e(Rb))return qc;Rb=ak(Rb);for(var Oc=Rb.next();!Oc.done;Oc=Rb.next()){Oc=Oc.value;var jb={};jb.FirstColumn=Oc.firstCol;jb.FirstRow=Oc.firstRow;jb.LastRow=Oc.lastRow;jb.LastColumn=Oc.lastCol;qc.push(jb)}return qc};xa.prototype.z6h=
function(Rb){(Rb=this.$.va.getItemByName(Rb))&&Rb.visible&&Rb.activate(!0)};xa.prototype.u7e=function(Rb,qc){var Oc=[];qc=ak(qc);for(var jb=qc.next();!jb.done;jb=qc.next()){jb=jb.value;var Eb={};Eb.FirstColumn=jb.firstCol;Eb.FirstRow=jb.firstRow;Eb.LastRow=jb.lastRow;Eb.LastColumn=jb.lastCol;Oc.push(jc.D(Eb))}qc=Oc.length-1;jb=Oc[qc].topLeft;Vc.g(this.$).fV(Oc,qc,Rb,null,jb,null,null,3,id.a.fsi,void 0,void 0,void 0,!0)};xa.prototype.k7i=function(){this.kF&&this.lineageTaskPane.isVisible&&(this.UD=
this.$.ea.Ve,this.kF.onRefreshRequired())};xa.prototype.PAg=function(){this.lineageTaskPane.UL(this.onPaneClosed);this.lineageTaskPane.$D(this.Az);this.$.ea.Bu(this.Sf);this.$.ea.Wj(this.Uc);this.$.ea.TL(this.uo);var Rb=this.$.va;Rb.lY(this.XC);Rb.Iga(this.joc);Rb.zFa(this.Bya);Rb.uYa(this.joc)};xa.prototype.f$i=function(){this.$.ea.Gw(this.Sf);this.gridView.ha.zW(this.Rc);this.$.ea.xk(this.Uc);this.$.ea.GR(this.uo);var Rb=this.$.va;Rb.P6(this.XC);Rb.Jma(this.joc);Rb.XPa(this.Bya);Rb.RHb(this.joc)};
xa.prototype.onStaleActivitiesDetected=function(){this.kF.onStaleActivitiesDetected()};xa.prototype.c4a=function(){for(var Rb=[],qc=ak(this.$.va.items),Oc=qc.next();!Oc.done;Oc=qc.next())Oc=Oc.value,Oc.visible&&!Pd.e(Oc)&&Rb.push(Oc.sheetName);return Rb};xa.prototype.oBj=function(){if(eb.EwaSettings.ma(613)){var Rb=this.$.da.za(403);Rb&&Rb.disable();Rb=new Fb.a(-847286761,Re.a.Cb,this.$.Jc,0,He.a.sW);var qc={};qc=(qc.InputMethod=Re.a.Cb,qc);qc.CalloutName=5;this.$.Ka.Kb(Rb,qc)}};xa.prototype.wqc=
function(Rb){var qc=[];Rb=ak(Rb);for(var Oc=Rb.next();!Oc.done;Oc=Rb.next())Oc=Oc.value,Oc=Object(Cb.a)(new ab,{activityId:Number.parseLocale(Oc.UserActivity.Id),activityGuid:Oc.Uid,activityType:Oc.UserActivity.Type,author:this.Bvb(Oc.UserActivity.Person),sheetName:Oc.SheetName,displayTimestamp:new Date(Oc.UserActivity.DisplayTimestamp),gridLocation:Oc.DisplayLocation,valueChanges:this.D1i(Oc.LineageValueChangeList),isBulkEditOverflow:Oc.IsBulkEditOverFlow,rangeHighlightLocation:this.s1i(Oc.UserActivity.LocationList,
Oc.UserActivity.Type),nestedActivityList:this.l1i(Oc.NestedActivityList),degradedCardTypeBits:Oc.DegradedCardTypeBits}),qc.push(Oc);return qc};xa.prototype.s1i=function(Rb,qc){if(!Rb)return Da.ULS.sendTraceTag(537155468,0,15,"LineageManager:: RangeHighlightLocation.ActivityLocationList is null"),null;if(!Rb.length)return Da.ULS.sendTraceTag(537155467,0,50,"LineageManager:: RangeHighlightLocation.ActivityLocationList is empty"),null;var Oc=[],jb=[],Eb="";21===qc?jb.push(Rb[0]):jb=Rb;Rb=ak(jb);for(jb=
Rb.next();!jb.done;jb=Rb.next())switch(jb=jb.value,jb.Type){case 1:break;case 2:Eb=jb.SheetName;break;case 0:if(!jb.RangeList){Da.ULS.sendTraceTag(537155465,0,50,"LineageManager:: RangeHighlightLocation.RangeActivityLocation is null");break}Eb=jb.RangeList[0].SheetName;var nc=[];21===qc?nc.push(jb.RangeList[0]):nc=jb.RangeList;jb=ak(nc);for(nc=jb.next();!nc.done;nc=jb.next())nc=nc.value,nc=Object(Cb.a)(new Ka,{firstCol:nc.FirstColumn,firstRow:nc.FirstRow,lastRow:nc.LastRow,lastCol:nc.LastColumn}),
Oc.push(nc);break;default:Da.ULS.sendTraceTag(537155464,0,50,"LineageManager:: RangeHighlightLocation.ActivityLocationList is of type: ",jb.Type)}return Object(Cb.a)(new Na,{sheetName:Eb,rangeList:Oc})};xa.prototype.D1i=function(Rb){var qc=[];Rb=ak(Rb);for(var Oc=Rb.next();!Oc.done;Oc=Rb.next())Oc=Oc.value,Oc=Object(Cb.a)(new ta,{hasNewValue:Oc.HasNewValue,hasOldValue:Oc.HasOldValue,newValue:Oc.HasNewValue?Oc.NewValue:null,oldValue:Oc.HasOldValue?Oc.OldValue:null,cellLocation:Oc.CellLocation}),qc.push(Oc);
return qc};xa.prototype.l1i=function(Rb){return Rb?this.wqc(Rb):null};xa.prototype.Bvb=function(Rb){if(!Rb)return null;var qc=null;eb.EwaSettings.isChangeGateEnabled("OfficeVSO:4947893_ShowChangesUserProfilePictureSupportEnabled")&&Ta.AFrameworkApplication.fa.ra("IsUserProfilePictureResolutionEnabled")&&(qc=this.zqc.DHa(Rb.Email,Rb.Provider,Ta.AFrameworkApplication.aj,0));return Object(Cb.a)(new Ea,{id:Rb.Id,provider:Rb.Provider,displayName:Rb.DisplayName,email:Rb.Email,imageUrl:qc})};Object($a.a)(xa,
"LineageManager",null,[861,862,10]);var Wb=pa.a;Rk(da,Wb);da.prototype.Ksi=function(Rb){var qc=this;Zb.TaskExtensions.Ba(Rb,function(){qc.pb(qc.$.da.za(366)||new xa(qc.$,qc.$.da,qc.lineageTaskPane,qc.p7))},this.$.la,3)};da.prototype.create=function(){var Rb=this;this.p7=this.$.Fb.sc("UserAction","LineagePaneSeenStopwatch");this.p7.start();var qc=Dc.GetServiceTaskFactory.Ra(this.$.da,365,364,this.hb),Oc=ud.a(this.$),jb=Dc.GetServiceTaskFactory.Ra(this.$.da,283,284,this.hb);Zb.TaskExtensions.Ba(Zb.TaskExtensions.Wd([qc,
Oc,jb],this.$.la),function(){Rb.lineageTaskPane=qc.result;Gd.a.ud(Rb.$)||Oc.result.MQ(Rb.lineageTaskPane);Rb.Ksi(Vd.c(jb.result.tn.loadScript("cellLineage")))},this.$.la,3)};da.ka=function(Rb){Rb.da.Ga(367,new da(Rb))};Object($a.a)(da,"LineageManagerFactory",pa.a,[]);var fc=b(1001),xc=b(233),Yb=b(13),Ec=b(109),bd=b(274),Ic=b(86),Md=b(244),ne=b(18),le=b(913),Ke=b(70),oc=He.a.qzc+"LineageActivityPaneTitle",Qc=He.a.Qdb+"LineageActivityCloseButton",md=Md.a;Rk(S,md);S.prototype.rP=function(Rb){this.get_events().addHandler("LineageTaskPaneRemove",
Rb)};S.prototype.IR=function(Rb){this.get_events().removeHandler("LineageTaskPaneRemove",Rb)};S.prototype.$D=function(Rb){this.addHandler("LineageTaskPaneVisibilityChanged",Rb)};S.prototype.GF=function(Rb){this.removeHandler("LineageTaskPaneVisibilityChanged",Rb)};S.prototype.UL=function(Rb){this.get_events().addHandler("LineageTaskPaneClose",Rb)};S.prototype.VN=function(Rb){this.get_events().removeHandler("LineageTaskPaneClose",Rb)};S.prototype.uH=function(){};S.prototype.Yo=function(){return this.rp};
S.prototype.Rr=function(){return this.rp};S.prototype.tR=function(){};S.prototype.HQ=function(){return!1};S.prototype.hj=function(){};S.prototype.Dj=function(){};S.prototype.dispose=function(){this.$&&(this.$.Ol(this.Fc),Gc.a(this.$).Gz(this));this.ee&&(xc.a.instance.Aa(Yb.a.click,this.ee,this.Sj),Ec.KeyInputManager.instance.sv(this.ee,this.Oye));this.ee=this.taskPaneManager=this.$=null;md.prototype.dispose.call(this)};S.prototype.Uf=function(Rb,qc){if(!qc){Rb=fd.DOMElementExtensions.getElementById(this.domElement,
"LineagePaneFilterButton");if(!Rb)return!1;fd.DOMElementExtensions.setFocus(Rb)}return!qc};S.prototype.$g=function(Rb){return fd.DOMElementExtensions.nf(this.jc,Rb)};S.prototype.$f=function(Rb){this.rp=Rb;var qc=this.taskPaneManager;if(this.isVisible=Rb)this.$.frame.ye.Ij("LineagePane"),this.Nod=!1;if(Gd.a.ud(this.$))Rb?qc.s6("LineageTaskPane",this.XF):qc.hideTaskPane("LineageTaskPane");else{this.taskPaneManager.Pw();var Oc=!!this.taskPaneManager.yg&&15===this.taskPaneManager.yg.taskPane.Og;Rb&&0<
qc.Sz.length&&(!Oc||qc.isCollapsed)&&qc.MF(this,!0)}this.$.jf()};S.prototype.lM=function(){var Rb=this.$.yb;Rb=Gd.a.ud(this.$)?this.domElement:document.getElementById(Rb+He.a.Csd);var qc=this.JG();Rb.appendChild(qc);qc=le.b("div","LineagePaneBodyId","LineageActivityBody");Rb.appendChild(qc);this.Zqj();return qc};S.prototype.x0c=function(){this.$.frame.ye.Ij(this.$.frame.ye.zE||bd.AFrame.JT);this.Nod=!0;this.$f(!1);this.raiseEvent("LineageTaskPaneClose")};S.prototype.Yqj=function(Rb){this.mEb=Rb};
S.prototype.Zqj=function(){this.$.frame.ye.Jj("LineagePane");var Rb=this.$.frame.ye.mi("LineagePane");Rb.parent=bd.AFrame.JT;Rb.$M=!0};S.prototype.JG=function(){var Rb=le.b("div","LineagePaneHeaderId","LineageActivityPaneHeader"),qc=le.b("h1","LineagePaneTitleId",oc);qc.innerText=this.titleText;this.ee=fc.a.nb("LineagePaneCloseButtonId",Qc,ef.a.instance.ga(10),"ClosePaneGlyph_16x16x32",!1);this.ee.classList.add(Ta.AFrameworkApplication.isRtl?He.a.taa:He.a.uaa);xc.a.instance.qa(Yb.a.click,this.ee,
this.Sj);this.Oye=Ec.KeyInputManager.instance.Zr(this.ee,this.Sj,Ic.a.Rh);Rb.appendChild(qc);Rb.appendChild(this.ee);return Rb};S.ka=function(Rb,qc){var Oc=Rb.yb,jb=document.getElementById(Oc+He.a.Csd);jb||(jb=document.createElement("div"),jb.id=Rb.yb+He.a.Csd,jb.classList.add("LineageActivityPane"),Gd.a.ud(Rb)||document.getElementById(Oc+He.a.nR).appendChild(jb));return Rb.da.za(365)||Rb.da.Ga(365,new S(jb,Rb,qc))};Af.Object.defineProperties(S.prototype,{isVisible:{configurable:!0,enumerable:!0,
get:function(){return Object(Ke.a)(S.prototype,this,"isVisible")},set:function(Rb){Object(Ke.a)(S.prototype,this,"isVisible")!==Rb&&(Object(Ke.b)(S.prototype,this,"isVisible",Rb),this.raiseEvent("LineageTaskPaneVisibilityChanged"))}},Bgc:{configurable:!0,enumerable:!0,get:function(){return this.Nod}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},Og:{configurable:!0,enumerable:!0,get:function(){return 15}},Zd:{configurable:!0,enumerable:!0,get:function(){return ed.a.gsi}},
Kk:{configurable:!0,enumerable:!0,get:function(){return ne.a.Hth}},PM:{configurable:!0,enumerable:!0,get:function(){return ef.a.instance.ga(1054)}},qo:{configurable:!0,enumerable:!0,get:function(){return 300}},isResizable:{configurable:!0,enumerable:!0,get:function(){return!1}},jc:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},height:{configurable:!0,enumerable:!0,get:function(){return this.taskPaneManager.uO.offsetHeight}},titleText:{configurable:!0,enumerable:!0,get:function(){return ef.a.instance.ga(1275)}},
XF:{configurable:!0,enumerable:!0,get:function(){var Rb=this;return this.taskPaneManager.Dua(this.jc,this.titleText,this.qo,this.isResizable,function(){Rb.isVisible=!0;Rb.mEb?Rb.mEb():Da.ULS.shipAssertTag(537155462,0,!1,"OnLineagePaneOpened callback not set.")},function(){Rb.isVisible=!1},function(){Rb.isVisible=!0},function(){Rb.isVisible=!1},this.qo)}}});Object($a.a)(S,"LineageTaskPane",Md.a,[860,10,537,422]);var dd=pa.a;Rk(Qa,dd);Qa.prototype.create=function(){var Rb=this,qc=Dc.GetServiceTaskFactory.create(this.$.da,
203,this.la,this.hb),Oc=Dc.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb);Zb.TaskExtensions.Ba(Zb.TaskExtensions.ts(Zb.TaskExtensions.Wd([qc,Oc],this.la),function(){return Rb.$C},this.la),function(){Rb.pb(Rb.Wg)},this.la,3)};Qa.prototype.dispose=function(){this.Wg=this.hi=this.$=null;dd.prototype.dispose.call(this)};Qa.ka=function(Rb){Rb.da.Ga(364,new Qa(Rb))};Af.Object.defineProperties(Qa.prototype,{$C:{configurable:!0,enumerable:!0,get:function(){var Rb=this;this.hi||(this.hi=Zb.TaskExtensions.Ba(ud.a(this.$),
function(qc){Rb.Wg=S.ka(Rb.$,qc.result)},this.la,3));return this.hi}}});Object($a.a)(Qa,"LineageTaskPaneFactory",pa.a,[]);wa.prototype.dispose=function(){this.THd();this.$=null;Da.ULS.sendTraceTag(537155459,0,50,"LineageTeachingCalloutTriggerManager is disposed.")};wa.prototype.disable=function(){wa.Fwb||(wa.Fwb=!0,Da.ULS.sendTraceTag(578557781,0,50,"LineageTeachingCalloutTriggerManager.Disable as the pane was opened."));this.THd()};wa.prototype.NVj=function(){var Rb=this;eb.EwaSettings.ma(609)&&
!this.$.isAnonymousUser()&&rd.i(this.$.oa.xa,function(qc){Rb.$?(qc=qc.Result,Da.ULS.sendTraceTag(578557780,0,50,"CheckLineageWywaChanges service call succeeded, hasnewchanges = {0}.",qc),wa.M5e=!0,qc&&Rb.a$f(0)):Da.ULS.sendTraceTag(537155458,0,50,"LineageTeachingCalloutTriggerManager.VerifyWaterlineTrigger ignoring server response as class is disposed.")},function(){Da.ULS.sendTraceTag(537155457,0,10,"CheckLineageWywaChanges service call failed.")},null,null)};wa.prototype.HVj=function(){eb.EwaSettings.ma(608)&&
!this.k$f()&&(this.$.ea.Bu(this.Sf),this.ppd=!0)};wa.prototype.k$f=function(){return this.$.ea&&this.$.ea.lo&&this.$.ea.lo.ShouldTriggerLineageCalloutOnMerge?(Da.ULS.sendTraceTag(578557778,0,50,"LineageTeachingCalloutTriggerManager.TriggerLineageCalloutOnMerge"),this.a$f(1),!0):!1};wa.prototype.a$f=function(Rb){if(wa.Fwb)Da.ULS.sendTraceTag(537155456,0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout Will not trigger dialog as it was already shown in session");else if(wa.Fwb=!0,Da.ULS.sendTraceTag(578557776,
0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout triggering callout due to reason {0}.",Rb),this.THd(),eb.EwaSettings.ma(482)){Rb=new Fb.a(-847286761,Re.a.Cb,this.$.Jc,0,He.a.sW);var qc={};qc=(qc.CalloutName=4,qc);this.$.Ka.Kb(Rb,qc)}};wa.prototype.THd=function(){this.ppd&&(this.ppd=!1,this.$.ea.Gw(this.Sf))};wa.Fwb=!1;wa.M5e=!1;Object($a.a)(wa,"LineageTeachingCalloutTriggerManager",null,[859,10]);var Kd=pa.a;Rk(ia,Kd);ia.prototype.create=function(){var Rb=this;Zb.TaskExtensions.Ba(Dc.GetServiceTaskFactory.Ra(this.$.da,
458,459,this.hb),function(qc){qc=new wa(Rb.$,qc.result);Rb.pb(qc)},this.$.la,3)};ia.ka=function(Rb){Rb.da.Ga(402,new ia(Rb))};Object($a.a)(ia,"LineageTeachingCalloutTriggerManagerFactory",pa.a,[]);var ke=pa.a;Rk(ha,ke);ha.prototype.create=function(){var Rb=this;Zb.TaskExtensions.Ba(Dc.GetServiceTaskFactory.Ra(this.$.da,366,367,0),function(qc){Rb.pb(qc.result)},this.$.la,3)};ha.ka=function(Rb){Rb.da.Ga(500,new ha(Rb))};Object($a.a)(ha,"LineageBlueDotManagerFactory",pa.a,[]);var kd=b(1084),Nd=b(77);
fa.prototype.XW=function(Rb,qc,Oc,jb){var Eb=this;return this.Xgh(Rb,void 0===jb?null:jb,function(nc){return Eb.Pg.OYb(nc,2,Oc,qc,void 0,void 0,void 0,void 0,void 0,"2")})};fa.prototype.Xgh=function(Rb,qc,Oc){var jb=this,Eb=!!qc&&""!==qc,nc=Rb;Eb&&(nc=lb.a.vT(Rb,"perfTag",qc));var $c=new Date;return kd.a.then(Oc(nc),function(od){var de=+new Date-+$c;if(!od||!od.Sg||!od.Sg.data)return od;Eb&&od.Sg.data.request&&jb.Rmj(od.Sg.data.request.getResolvedUrl(),qc,de);return od})};fa.prototype.Rmj=function(Rb,
qc,Oc){Rb=this.yu.JVh(Rb);if(Rb.count&&(Rb=Nd.last(Rb))){var jb={Message:"Request durations for activities calls."};jb.PerfTag=qc;jb.CustomDuration=Oc;jb.PerformanceDuration=Rb.duration;Da.ULS.sendTraceTag(592189641,3012,50,JSON.stringify(jb))}};Object($a.a)(fa,"CatchUpNetworkingWrapper",null,[242]);var ge=b(252),Me=ge.a;Rk(qa,Me);qa.prototype.Caa=function(){return 6};Object($a.a)(qa,"GetActivityFeedRequest",ge.a,[]);var Ze=ge.a;Rk(Y,Ze);Y.prototype.Caa=function(){return 7};Object($a.a)(Y,"UpdateActivityFeedStateRequest",
ge.a,[]);var lf=b(412);ka.prototype.getActivityFeed=function(Rb){var qc=this;return kd.a.then(this.GCa.execute(new qa(this.pCa(),null),function(Oc,jb,Eb){return qc.Wae.XW(Oc,jb,Eb,"ActivityFeed")},Rb),function(Oc){if(!Oc)return Da.ULS.sendTraceTag(572846937,3012,10,"GetActivityFeed: Response is null"),null;if(!Oc.Sg)return Da.ULS.sendTraceTag(572846938,3012,10,"GetActivityFeed: Response.Args is null"),null;if(!Oc.Sg.data)return Da.ULS.sendTraceTag(572846939,3012,10,"GetActivityFeed: Response.Args.Data is null"),
null;if(!Oc.Sg.data.Ud)return Da.ULS.sendTraceTag(572846940,3012,10,"GetActivityFeed: Response.Args.Data.ResponseData is null"),null;Oc=lf.a.aIa(Oc.Sg.data.Ud);return Oc?Oc:(Da.ULS.sendTraceTag(572846941,3012,10,"GetActivityFeed: Deserialized response is null"),null)})};ka.prototype.QPj=function(Rb,qc,Oc,jb){var Eb=this;return kd.a.then(this.GCa.execute(new Y(this.pCa(),null,Rb,qc,Oc,jb),function(nc,$c,od){return Eb.Wae.XW(nc,$c,od,"UpdateActivityFeedState")},null),function(nc){try{return nc.succeeded}catch($c){return Da.ULS.sendTraceTag(523121054,
3012,10,"UpdateActivityFeed: Exception: "+$c.message),!1}})};Object($a.a)(ka,"CatchUpRequestHandler",null,[219]);var he=b(519);ea.prototype.Rti=function(){this.Dui()};ea.prototype.Dui=function(){var Rb=this;this.cga?this.cga.execute(function(qc){window.setTimeout(function(){Rb.J$d.contains("CatchUpChangesFeedback")||(Rb.J$d.add("CatchUpChangesFeedback"),qc.logActivity("CatchUpChangesFeedback",null))},2E4)}):Da.ULS.sendTraceTag(571586199,383,15,"FloodgateEventLogger: IFuture<ISystemInitiatedFeedback> was null")};
Object($a.a)(ea,"FloodgateEventLogger",null,[]);var Se=b(202);Af.Object.defineProperties(Z.prototype,{duration:{configurable:!0,enumerable:!0,get:function(){return this.ytg.duration}}});Object($a.a)(Z,"PerformanceResourceTimingWrapper",null,[]);X.prototype.JVh=function(Rb){var qc=new Se.a;if(!this.yu)return qc;Rb=this.yu.getEntriesByName(Rb,"resource");if(!Rb)return qc;Rb=ak(Rb);for(var Oc=Rb.next();!Oc.done;Oc=Rb.next())qc.add(new Z(Oc.value));return qc};Object($a.a)(X,"PerformanceWrapper",null,
[]);var ve=b(257);ca.prototype.Sh=function(Rb){var qc=this;this.fb=Rb;this.fb.register(fa,"Common.App.CatchUpActivity.CatchUpNetworkingWrapper").as("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper").tc().Cc(function(){return new fa(Ta.AFrameworkApplication.qd,new X(window.performance))});this.fb.register(ka,"Common.App.CatchUpActivity.CatchUpRequestHandler").as("Common.App.CatchUpActivity.ICatchUpRequestHandler").tc().Cc(function(){return new ka(qc.fb.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper"),
function(){return Ta.AFrameworkApplication.aj},new lf.a)});this.fb.register(ea,"Common.App.CatchUpActivity.FloodgateEventLogger").tc().Cc(function(){return new ea(qc.fb.Tb("Common.ISystemInitiatedFeedback"))})};ca.prototype.init=function(){this.fb.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper");this.fb.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler")};ca.prototype.dispose=function(){};ca.main=function(){ve.a.instance.Ui(new ca)};Af.Object.defineProperties(ca.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.CatchUpActivity"}}});Object($a.a)(ca,"CatchUpActivityPackage",null,[3,4]);Q.prototype.Lc=function(Rb,qc){return this.catchUpActivityManager?-876699925===qc?!this.catchUpActivityManager.Xaf:!1:!0};Q.prototype.executeCommand=function(Rb,qc){Rb=!1;switch(qc.command){case -876699925:Rb=this.catchUpActivityManager.lTi()}return Rb?Sa.Task.Ua(!0):mc.a(qc.command)};Q.prototype.Ac=function(Rb,qc){return eb.EwaSettings.ma(437)&&-876699925===
qc.command?!0:!1};Q.prototype.Qc=function(){return!1};Object($a.a)(Q,"CatchUpActivityCommandHandler",null,[403]);var Xa=ac.a;Rk(H,Xa);H.prototype.zd=function(){var Rb=this;this.$.da.Za(286,function(qc){Rb.jd([new Q(Rb.$,qc)])})};H.ka=function(Rb){ac.a.Qd(285,new H(Rb))};Object($a.a)(H,"CatchUpActivityCommandHandlerFactory",ac.a,[]);var h=b(279),hb=b(567),Tb=b(90),yc=b(85),vc=b(27);N.prototype.doesContentExist=function(Rb){if(!Rb)return Da.ULS.sendTraceTag(537168066,3012,10,"Null activity: DoesContentExist. Default to false."),
!1;switch(Rb.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:if(!Rb.navigationId)return Da.ULS.sendTraceTag(537168065,3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),!1;var qc={};qc.NavigationId=atob(Rb.navigationId);return 32===this.pi.ae(vc.a.oIa,2,qc);default:return!1}};Object($a.a)(N,"CatchUpActivityContentManager",null,[851]);var yd=b(1031),Dd=b(1441);O.prototype.dispose=function(){this.Ru.kPf(this.iEb);this.kz=null};O.prototype.xqj=function(Rb){this.kz.push(Rb)};
O.prototype.sYg=function(){Array.clear(this.kz)};O.prototype.h3f=function(Rb){for(var qc=ak(this.kz),Oc=qc.next();!Oc.done;Oc=qc.next())Oc=Oc.value,Oc.className=yd.a.fVg,Oc=document.getElementById(String.format("{0}-{1}",Oc.id,He.a.qwe)),fd.DOMElementExtensions.setVisible(Oc,Rb)};O.prototype.zLb=function(Rb){for(var qc=ak(this.kz),Oc=qc.next();!Oc.done;Oc=qc.next())if(Oc=Oc.value)Rb?Oc.className=2===this.Ru.model.state?yd.a.t4i:yd.a.u4i:this.h3f(!1)};Af.Object.defineProperties(O.prototype,{Ru:{configurable:!0,
enumerable:!0,get:function(){return this.Hpg}}});Object($a.a)(O,"RangeCatchUpActivityView",null,[909,10]);var qd=b(22),xe=Dd.a;Rk(J,xe);J.prototype.dispose=function(){this.gridView=null;xe.prototype.dispose.call(this)};J.prototype.oDg=function(Rb){var qc=this.qfb[0];qc?qc.xqj(Rb):Da.ULS.shipAssertTag(537168004,0,!1,"RangeCatchUpActivityHighlightController.AddViewElement - RangeCatchUpActivityView is null for activityId"+this.wma.activityId)};J.prototype.kgj=function(){var Rb=this.qfb[0];Rb&&Rb.sYg()};
J.prototype.ABg=function(Rb){this.wma.addRange(Rb)};J.prototype.PKh=function(){if(3!==this.wma.activityType)return null;Da.ULS.shipAssertTag(537168003,0,1===this.wma.XLb.length,"RangeCatchUpActivityHighlightController::GetCommentActivityRange Range Information Length should be 1.");return jc.D(this.wma.XLb[0])};J.prototype.zJb=function(Rb){if(Rb){if(!this.wma)return;this.Awd(this.shj())}xe.prototype.zJb.call(this,Rb)};J.prototype.U3c=function(){var Rb=this.A3c();this.qfb.push(Rb)};J.prototype.A3c=
function(){return new O(this)};J.prototype.Awd=function(Rb){Rb?Rb.SheetName?(this.gridView.ha.Oa.PG(null),this.gridView.focus(),this.gridView.P3e(Rb,3,!1,id.a.s4i)):Da.ULS.shipAssertTag(537168E3,0,!1,"RangeCatchUpActivityHighlightController.NavigateToRange: SheetName in the range is null."):Da.ULS.shipAssertTag(537168001,0,!1,"RangeCatchUpActivityHighlightController.NavigateToRange: Range is null. Either the location list is empty or sheet is hidden.")};J.prototype.shj=function(){if(Xb.e(this.wma.XLb))return Da.ULS.shipAssertTag(537167971,
0,!1,"RangeCatchUpActivityHighlightController.RetrieveRangeInformationForNavigation : SortedRanges is either null or empty."),null;var Rb=this.$.va.pa;Da.ULS.shipAssertTag(537167970,0,!!Rb,"RangeCatchUpActivityHighlightController.RetrieveRangeInformationForNavigation : currentSheet is null.");Rb=this.JMj(Rb.sheetName,this.wma.XLb);if(!Rb&&(Rb=this.s_h(this.wma.XLb),!Rb))return null;var qc={};qc.SheetName=Rb.SheetName;qc.FirstColumn=Rb.FirstColumn;qc.FirstRow=Rb.FirstRow;qc.LastColumn=Rb.FirstColumn;
qc.LastRow=Rb.FirstRow;return qc};J.prototype.s_h=function(Rb){if(Xb.e(Rb))return null;for(var qc=null,Oc=0;Oc<Rb.length;Oc++){var jb=Rb[Oc].SheetName;if(!qd.a.equals(jb,qc,!1)&&(qc=jb,jb=this.$.va.getItemByName(jb),null===jb||void 0===jb?0:jb.visible))return Rb[Oc]}return null};J.prototype.JMj=function(Rb,qc){if(qc){qc=ak(qc);for(var Oc=qc.next();!Oc.done;Oc=qc.next())if(Oc=Oc.value,qd.a.equals(Oc.SheetName,Rb,!1))return Oc}return null};Object($a.a)(J,"RangeCatchUpActivityHighlightController",Dd.a,
[]);var Ge=b(79),Xe=Ge.a;Rk(K,Xe);K.prototype.dispose=function(){this.C0d=null;Xe.prototype.dispose.call(this)};Af.Object.defineProperties(K.prototype,{type:{configurable:!0,enumerable:!0,get:function(){return this.ZB}},activityId:{configurable:!0,enumerable:!0,get:function(){return this.C0d}},activityType:{configurable:!0,enumerable:!0,get:function(){return this.Pjg}}});Object($a.a)(K,"CatchUpActivityHighlightModelBase",Ge.a,[]);Rk(F,K);F.prototype.addRange=function(Rb){Rb=ak(Rb);for(var qc=Rb.next();!qc.done;qc=
Rb.next())this.ranges.push(qc.value)};F.prototype.dispose=function(){this.ranges=null;K.prototype.dispose.call(this)};F.V2b=function(Rb,qc){if(!Rb.SheetName||!qc.SheetName)return Da.ULS.shipAssertTag(537167969,0,!1,"RangeCatchUpActivityHighlightModel.CompareSharedSheetRange : SheetName is null."),0;var Oc=Rb.SheetName.localeCompare(qc.SheetName);return Oc?Oc:Rb.FirstColumn<qc.FirstColumn||Rb.FirstColumn===qc.FirstColumn&&Rb.FirstRow<qc.FirstRow?-1:Rb.FirstColumn===qc.FirstColumn&&Rb.FirstRow===qc.FirstRow?
0:1};Af.Object.defineProperties(F.prototype,{XLb:{configurable:!0,enumerable:!0,get:function(){this.T6a||(this.ranges.sort(F.V2b),this.T6a=!0);return this.ranges}}});Object($a.a)(F,"RangeCatchUpActivityHighlightModel",K,[]);var Bb=b(355);T.prototype.dispose=function(){this.Jje=this.QKb=this.u1c=null};T.prototype.ndj=function(Rb){Vc.g(Rb).qb.qn([24])};T.prototype.s5g=function(Rb,qc,Oc){var jb={};qc=ak(qc);for(var Eb=qc.next();!Eb.done;Eb=qc.next())if((Eb=Eb.value)&&!Xb.e(Eb.LocationList)){for(var nc=
[],$c={},od=[],de=ak(Eb.LocationList),ae=de.next();!ae.done;ae=de.next()){ae=ae.value;if(!ae){Da.ULS.shipAssertTag(537168013,0,!1,"CatchUpActivityHighlightManagerHelper.CreateControllersAndHighlights - Location is Null for activityId : "+Eb.Id);break}switch(ae.Type){case 0:var ze=ae;"0"in $c?(ae=$c["0"],ae.ABg(ze.RangeList)):(ae=new J(Rb,new F(Rb,Eb.Id,Eb.Type,0,ze.RangeList),Oc),nc.push(ae),$c["0"]=ae);ze=ak(ze.RangeList);for(var Xd=ze.next();!Xd.done;Xd=ze.next()){Xd=Xd.value;Xd=new Bb.a(jc.D(Xd),
Pd.d(Rb.va.getItemByName(Xd.SheetName)));if(this.xwc(Xd)in this.QKb)this.QKb[this.xwc(Xd)].push(ae);else{var te=[];te.push(ae);this.QKb[this.xwc(Xd)]=te}od.push(Xd);this.u1c.push(Xd)}break;default:Da.ULS.sendTraceTag(537168012,0,10,"CatchUpHighlightControllersCreator.CreateControllersAndHighlights(): Failed.Invalid ActivityLocationType")}}Da.ULS.shipAssertTag(537168011,0,!(Eb.Id in jb),"CatchUpHighlightControllersCreator.CreateAndUpdateControllers - highlightControllers already has activity: "+Eb.Id);
this.Jje[Eb.Id]=od;jb[Eb.Id]=nc}this.N6g(Rb,this.u1c,this.QKb);return jb};T.prototype.kYg=function(Rb){for(var qc in Rb)for(var Oc=ak(Rb[qc]),jb=Oc.next();!jb.done;jb=Oc.next())jb.value.kgj()};T.prototype.xwc=function(Rb){return String.format("{0}-{1}",Rb.range,Rb.sheetId)};T.prototype.N6g=function(Rb,qc,Oc){var jb=this;this.kYg(Oc);Vc.g(Rb).qb.Lw(qc,[24],!0,function(Eb,nc){var $c=new Bb.a(Eb.range,Eb.sheetId);$c=jb.xwc($c);var od=Oc[$c];if(od)for($c=ak(od),od=$c.next();!od.done;od=$c.next())od=od.value,
od.oDg(nc),Eb.metadata=od;else Da.ULS.shipAssertTag(537168010,0,!1,"CatchUpHighlightControllersCreator.CreateHighlightsAndUpdateControllers(), Missing Controller for SheetRangeKey "+$c)})};Object($a.a)(T,"CatchUpHighlightControllersCreator",null,[]);Object($a.a)(M,"CreateIndicatorTooltipParameters",null,[]);Object($a.a)(U,"DismissIndicatorTooltipParameters",null,[]);Object($a.a)(I,"UpdateIndicatorTooltipParameters",null,[]);E.prototype.dispose=function(){this.ha.nsc(this.Jl);this.ha.EF(this.Rc);this.gridView.DF(this.fp);
this.Ya.wk(this.Gh);this.HGe();this.rad=this.Rja=this.Mdc=this.NQa=this.Ya=this.ha=this.gridView=null};E.prototype.doj=function(Rb){this.HGe();if(!Xb.e(Rb)){Da.ULS.sendTraceTag(537168035,0,50,"In CatchUpActivityHighlightManager:ProcessActivityPayloadHighlights().");if(this.v4=this.G3b.s5g(this.$,Rb,this)){Rb=this.v4;for(var qc in Rb)for(var Oc=ak(Rb[qc]),jb=Oc.next();!jb.done;jb=Oc.next())this.MLg(jb.value)}this.G3b.ndj(this.$)}};E.prototype.zxc=function(Rb){if(Rb&&this.ijd)Da.ULS.shipAssertTag(537168034,
0,!1,"CatchUpActivityHighlightManager.ShowOrHideAllHighlights - Trying to show all highlights when marked as read");else if(Rb||this.Trb(),this.v4){var qc=this.v4,Oc;for(Oc in qc)for(var jb=ak(qc[Oc]),Eb=jb.next();!Eb.done;Eb=jb.next())Eb.value.wAj(Rb)}};E.prototype.y6h=function(Rb){this.Rja&&this.r6b(!0);this.x5c();if(Rb=this.v4[Rb.activityId]){Rb=ak(Rb);for(var qc=Rb.next();!qc.done;qc=Rb.next())qc.value.zJb(!0)}else Da.ULS.sendTraceTag(537168032,0,50,"CatchUpActivityHighlightManager.OnSelectHighlight - Controllers not found during select")};
E.prototype.HGe=function(){if(this.v4){var Rb=this.v4,qc;for(qc in Rb)for(var Oc=ak(Rb[qc]),jb=Oc.next();!jb.done;jb=Oc.next())jb=jb.value,this.g$i(jb),jb.dispose()}this.v4={};this.G3b.dispose();this.G3b=null};E.prototype.bzj=function(){if(this.excelCommentManager){var Rb=this.v4[this.NQa];Rb&&0<Rb.length&&3===Rb[0].model.activityType&&((Rb=Rb[0])?this.excelCommentManager.Dzj(Rb.PKh()):Da.ULS.shipAssertTag(537168029,0,!1,"RangeCatchUpActivityHighlightController::ShowCommentFlyoutOnSelectedActivity RangeController is Null."))}};
E.prototype.O5h=function(){this.excelCommentManager&&this.excelCommentManager.Osb()};E.prototype.x5c=function(){if(this.NQa){var Rb=this.v4[this.NQa];if(Rb){Rb=ak(Rb);for(var qc=Rb.next();!qc.done;qc=Rb.next())qc.value.zJb(!1);this.NQa=null}else Da.ULS.sendTraceTag(537168028,0,50,"CatchUpActivityHighlightManager.DeselectCurrentlySelected - Controllers not found for deselection")}};E.prototype.Trb=function(){this.x5c();this.r6b(!0)};E.prototype.YMj=function(Rb){if(!Rb)return Da.ULS.shipAssertTag(537168026,
0,!1,"CatchUpActivityHighlightManager::TryGetFlyoutContainer HighlightDot is null."),null;Rb=String.format("{0}-{1}",Rb.id,He.a.dVg);var qc=this.rad[Rb];if(!qc){if(!this.gridView.domElement)return Da.ULS.shipAssertTag(537168025,0,!1,"CatchUpActivityHighlightManager::TryGetFlyoutContainer gridView.DOMElement is null."),null;qc=document.createElement("Div");qc.className=yd.a.eVg;qc.id=Rb;this.gridView.domElement.appendChild(qc);this.rad[Rb]=qc}return qc};E.prototype.r6b=function(Rb){this.Mea&&(this.Mea.dismissActivityIndicatorTooltips(Object(Cb.a)(new U,
{clearSticky:Rb})),this.Mdc=null,Rb&&(this.Rja=null),this.fgc&&!this.Rja&&(this.gridView.view.Iq(this.YAc),this.gridView.Fw(this.YAc),this.fgc=!1))};E.prototype.MLg=function(Rb){Rb.eme(this.iEb);Rb.RDg(this.f2f);Rb.QDg(this.zHe)};E.prototype.g$i=function(Rb){Rb.kPf(this.iEb);Rb.maj(this.f2f);Rb.laj(this.zHe)};Af.Object.defineProperties(E.prototype,{Izg:{configurable:!0,enumerable:!0,get:function(){return this.Mea},set:function(Rb){this.Mea=Rb}},excelCommentManager:{configurable:!0,enumerable:!0,get:function(){this.dDa||
(this.dDa=this.$.da.za(65));return this.dDa}},G3b:{configurable:!0,enumerable:!0,get:function(){this.H3b||(this.H3b=new T);return this.H3b},set:function(Rb){this.H3b=Rb}}});Object($a.a)(E,"CatchUpActivityHighlightManager",null,[885,10]);G.prototype.navigateToActivity=function(Rb){if(Rb.fromSummaryString){var qc=new Fb.a(1834994092,Re.a.Cb,this.$.Jc,18,null);this.$.Ka.Kb(qc);return this.WTa(1)}Rb=Rb.activity;if(!this.Xdi(Rb))return this.WTa(4);if(!this.$mi(Rb))return this.WTa(7);var Oc={};try{qc=window.self.atob(Rb.navigationId);
if(!qc)return this.WTa(5);Oc.NavigationId=qc}catch(jb){return Da.ULS.sendTraceTag(537168023,3012,10,"Exception thrown when trying to decode activity NavigationID: {0}",jb),this.WTa(5)}if(8===this.pi.ae(vc.a.oIa,2,Oc))return this.pi.processAction(vc.a.P8a,2),this.WTa(2);qc=32===this.pi.ae(vc.a.V_a,2,Oc)?1:6;return this.WTa(qc)};G.prototype.Xdi=function(Rb){return Rb&&Rb.navigationId?!0:!1};G.prototype.$mi=function(Rb){switch(Rb.type){case 3:case 4:case 6:case 7:case 9:case 8:return!0;default:return!1}};
G.prototype.WTa=function(Rb){return Promise.resolve(Rb)};Object($a.a)(G,"CatchUpActivityNavigationManager",null,[852]);var zc=b(477);Object($a.a)(C,"GetRelevantActivitiesDataRequest",null,[]);Object($a.a)(x,"Activity",null,[]);Object($a.a)(y,"ActivityFeedItem",null,[]);Object($a.a)(B,"ActivityFeedPayload",null,[]);Object($a.a)(A,"ActivityRequestPayload",null,[]);Object($a.a)(v,"Person",null,[]);Rk(r,x);Object($a.a)(r,"TaskActivity",x,[]);w.prototype.requestWYWAActivities=function(){var Rb=this;return this.i6a?
new Promise(function(qc,Oc){z(Rb.$.oa.xa,function(jb){var Eb,nc=kc.a(jb)?null:jb.Result;eb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BlueDot",!1)?(jb=null===(Eb=null===nc||void 0===nc?void 0:nc.WywaAuthors)||void 0===Eb?void 0:Eb.length,null!=jb&&0<jb&&Zb.TaskExtensions.Ba(Dc.GetServiceTaskFactory.Ra(Rb.$.da,501,500,0),function($c){$c.result.Xzj().then(function(od){var de=od.map(function(ae){return{activityId:ae.activityGuid,activityFeedItemId:null,type:1,actors:[{id:ae.author.id,
provider:ae.author.provider,displayName:ae.author.displayName,givenName:null,email:ae.author.email,imageUrl:ae.author.imageUrl,color:null}],location:null,displayTimestamp:ae.displayTimestamp,relevancy:null,navigationId:null,state:0,collectionId:null}});od=od.map(function(ae){var ze=ae.rangeHighlightLocation.rangeList.map(function(Xd){return{Type:0,RangeList:[{SheetName:ae.sheetName,FirstRow:Xd.firstRow,LastRow:Xd.lastRow,FirstColumn:Xd.firstCol,LastColumn:Xd.lastCol}]}});return{Id:ae.activityGuid,
Type:null,Person:null,DisplayTimestamp:null,LocationList:ze}});Rb.deg=od;de={activities:de,actors:nc?Rb.Cbc(nc.WywaAuthors):null,hasMore:!1,highWaterline:w.eia,lowWaterline:w.eia,wywaWaterline:w.eia};qc(de)},function(){})},Rb.$.la,3)):(Eb=Object(Cb.a)(new A,{activities:[],actors:nc?Rb.Cbc(nc.WywaAuthors):null,hasMore:!1,highWaterline:w.eia,lowWaterline:w.eia,wywaWaterline:w.eia}),qc(Eb))},function(){Da.ULS.sendTraceTag(537168022,0,10,"CatchUpActivityRequestManager::GetLineageWywaAuthors service call failed.");
Oc(null)},null,null)}):Promise.resolve(w.K5b)};w.prototype.requestActivities=function(){return Promise.resolve(w.K5b)};w.prototype.requestRelevantActivities=function(){var Rb=this;if(!this.$.ea.dc||this.$.ea.J4a)return Da.ULS.sendTraceTag(537168021,3012,15,"CatchUpActivityRequestManager.RequestRelevantActivities: RequestRelevantActivities skipped [IsSessionActive: {0}, HasRaisedSessionEnded: {1}]",this.$.ea.dc,this.$.ea.J4a),Promise.resolve(w.K5b);var qc=Object(Cb.a)(new C,{SetDaysBack:Ta.AFrameworkApplication.fa.kd("AppWaterlineOverrideDaysValue",
0),SetTimestamp:Ta.AFrameworkApplication.fa.kd("AppWaterlineOverrideTimestampValue",0)});return new Promise(function(Oc,jb){n(Rb.$.oa.xa,qc,function(Eb){var nc=w.K5b;Eb?kc.a(Eb)?Da.ULS.sendTraceTag(578353159,3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call returned errors codes: {0}",pc.a.Dc(Eb.Errors)):nc=Rb.oVh(Eb.Result):Da.ULS.sendTraceTag(537168020,3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call returned Null result.");Oc(nc)},function(Eb){Eb=cb.a.Of(Eb.data);
Da.ULS.sendTraceTag(537168019,3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call has failed - Errors: [{0}]",pc.a.Dc(Eb));jb(null)},null,null)})};w.prototype.requestActivityFeed=function(){var Rb=this;return Vd.b(this.getActivityFeed()).then(function(qc){return Object(Cb.a)(new B,{activityFeedItems:Rb.xLj(qc)})})};w.prototype.updateActivityState=function(Rb){return eb.EwaSettings.ma(453)?Promise.resolve(!0):this.x1b?Vd.b(this.x1b).then(function(qc){var Oc,jb;return Vd.b(qc.QPj(Rb.itemIds,
null!==(Oc=Rb.activityStatesToSet)&&void 0!==Oc?Oc:0,null!==(jb=Rb.activityStatesToReset)&&void 0!==jb?jb:0,Rb.resetUnseenCount))}):Promise.resolve(!1)};w.prototype.getActivityFeed=function(){return this.x1b?kd.a.PUd(this.x1b,function(Rb){return Rb.getActivityFeed(null)}):Sa.Task.Ua([])};w.prototype.oVh=function(Rb){if(!Rb)return Da.ULS.sendTraceTag(537168018,3012,10,"CatchUpActivityRequestManager::GetRelevantActivityRequestPayload response is null."),Object(Cb.a)(new A,{activities:[]});var qc=this.V9f(Rb.NewActivities,
2);Rb=this.V9f(Rb.OutstandingActivities,3);Rb=ak(Rb);for(var Oc=Rb.next();!Oc.done;Oc=Rb.next())qc.push(Oc.value);return Object(Cb.a)(new A,{activities:qc})};w.prototype.V9f=function(Rb,qc){qc=void 0===qc?1:qc;var Oc=[];if(!Rb||!Rb.length)return Oc;Rb=ak(Rb);for(var jb=Rb.next();!jb.done;jb=Rb.next())if(jb=jb.value){var Eb=w.ELj(jb.Type);6===Eb||7===Eb||9===Eb||8===Eb?Oc.push(Object(Cb.a)(new r,{activityId:jb.Id,type:Eb,displayTimestamp:new Date(jb.DisplayTimestamp),navigationId:jb.NavigationId,actors:this.Cbc(jb.People),
relevancy:qc,relationship:this.DLj(jb.Relationship)})):Oc.push(Object(Cb.a)(new x,{activityId:jb.Id,type:Eb,displayTimestamp:new Date(jb.DisplayTimestamp),navigationId:jb.NavigationId,actors:this.Cbc(jb.People),relevancy:qc}))}else Da.ULS.shipAssertTag(537168017,3012,!1,"CatchUpActivityRequestManager.TranslateRelevantActivitiesToActivities: relevantActivity is null");return Oc};w.prototype.DLj=function(Rb){switch(Rb){case 1:return 1;case 2:return 2;case 3:return 3}Da.ULS.sendTraceTag(537168016,0,
10,"Unexpected Relationship.");return 1};w.prototype.xLj=function(Rb){var qc=[];Rb=ak(Rb);for(var Oc=Rb.next();!Oc.done;Oc=Rb.next())Oc=Oc.value,Oc=Object(Cb.a)(new y,{id:Oc.id,type:Oc.type,collectionId:Oc.collectionId,activityState:Oc.activityState,activityFeedItemPayload:Oc.activityFeedItemPayload,timestamp:Oc.timestamp}),qc.push(Oc);return qc};w.prototype.Cbc=function(Rb){var qc=[];if(!Rb||!Rb.length)return qc;Rb=ak(Rb);for(var Oc=Rb.next();!Oc.done;Oc=Rb.next())(Oc=Oc.value)&&qc.push(this.Bvb(Oc));
return qc};w.prototype.Bvb=function(Rb){return Object(Cb.a)(new v,{id:Rb.Id,provider:Rb.Provider,displayName:Rb.DisplayName,email:Rb.Email,imageUrl:this.zqc.DHa(Rb.Email,Rb.Provider,Ta.AFrameworkApplication.aj,0),color:this.IFb.vgd(new zc.a(null,void 0,Rb.DisplayName),6)})};w.ELj=function(Rb){switch(Rb){case 1:return 3;case 2:return 4;case 3:return 6;case 4:return 7;case 6:return 8;case 5:return 9;case 7:return 10;default:return Da.ULS.shipAssertTag(537168015,3012,!1,"CatchUpActivityRequestManager.TranslateRelevantActivityTypeToActivityType: unknown RelevantActivityType"),
1}};w.eia="<WywaWaterline>DefaultWaterline</WywaWaterline>";w.K5b=Object(Cb.a)(new A,{activities:[],actors:[],hasMore:!1,highWaterline:w.eia,lowWaterline:w.eia,wywaWaterline:w.eia});Object($a.a)(w,"CatchUpActivityRequestManager",null,[853]);f.prototype.shouldShowEmptyExperienceButton=function(){if(!this.$.ea.L7a)return!1;if(!eb.EwaSettings.isChangeGateEnabled("OfficeVSO:5892442_CatchupEmptyExperienceNewContract")){var Rb=this.$.da.za(365);return!Rb||!Rb.isVisible}return!0};f.prototype.onButtonClick=
function(){var Rb={};Rb=(Rb.InputMethod=Re.a.Cb,Rb);this.$.Ka.Kb(new Fb.a(1834994092,Re.a.Cb,this.$.Jc,16,null),Rb)};f.prototype.getExplanationText=function(){var Rb=this.$.da.za(365);return ef.a.instance.Xa(Rb&&Rb.isVisible?646:645)};f.prototype.getCommandName=function(){return ef.a.instance.ga(446)};Object($a.a)(f,"CatchUpEmptyExperienceBehaviorManager",null,[854]);l.prototype.dispose=function(){Gc.a(this.$).Gz(this)};l.prototype.Uf=function(Rb,qc){if(qc)return!1;Rb=document.getElementById("flyoutItem0");
if(!Rb)return Da.ULS.sendTraceTag(537168009,3012,10,"Could not find firstItem in flyout when setting up focus"),!1;Rb.focus();this.Mfh(Rb);return!0};l.prototype.$g=function(Rb){return this.jc?fd.DOMElementExtensions.nf(this.jc,Rb):!1};l.prototype.hj=function(){this.hasFocus=!0};l.prototype.Dj=function(){this.hasFocus=!1};l.prototype.Mfh=function(Rb){if(Sys.Browser.agent===Sys.Browser.Firefox){var qc=document.createEvent("KeyboardEvent");qc.initKeyEvent(Yb.a.Lb,!0,!0,window.self,!1,!1,!1,!1,Ic.a.nCc,
0);Rb.dispatchEvent(qc)}else qc=document.createEvent("Events"),qc.initEvent(Yb.a.Lb,!0,!0),qc.keyCode=Ic.a.nCc,qc.which=Ic.a.nCc,Rb.dispatchEvent(qc)};Af.Object.defineProperties(l.prototype,{jc:{configurable:!0,enumerable:!0,get:function(){return document.getElementById("catchUpFlyoutContainer")}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.flyoutRibbonButton.Icf&&!this.hasFocus}},Zd:{configurable:!0,enumerable:!0,get:function(){return ed.a.VZc}}});Object($a.a)(l,"FlyoutFocus",
null,[422,10]);var Mb=b(395);k.prototype.dispose=function(){this.Tib=this.Lyb=!1};k.prototype.registerButtonClickedEvent=function(Rb){this.buttonClickedCallback&&Da.ULS.sendTraceTag(537168008,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.buttonClickedCallback=Rb.buttonClickedCallback};k.prototype.onFlyoutInitialized=function(){this.Lyb&&Da.ULS.sendTraceTag(537168007,3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");var Rb=
(new Date).getTime()-this.lCh.getTime();Da.ULS.sendTraceTag(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",Rb);Ab.c(vc.a.hVg,!0,Ab.e,0,0,Rb);this.Lyb=!0;Mb.a.Iy&&Mb.a.Iy.updateCommandUI(!0)};k.prototype.logFlightTriggers=function(){};k.prototype.toggleCatchUpFlyout=function(){this.Lyb?this.buttonClickedCallback?this.buttonClickedCallback():Da.ULS.sendTraceTag(537168005,3012,10,"ToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered."):
Da.ULS.sendTraceTag(537168006,3012,10,"ToggleCatchUpFlyout: User clicked the button before the flyout was initialized.")};k.prototype.onFlyoutVisibilityChanged=function(Rb){this.Tib!==Rb.flyoutIsVisible&&(this.Tib=Rb.flyoutIsVisible,Mb.a.Iy&&Mb.a.Iy.updateCommandUI(!0),this.Tib||this.sTe&&this.sTe.Rti())};Af.Object.defineProperties(k.prototype,{Icf:{configurable:!0,enumerable:!0,get:function(){return this.Tib}}});Object($a.a)(k,"FlyoutRibbonButton",null,[880]);var cc=b(571);Object($a.a)(e,"CatchUpConfiguration",
null,[]);Object($a.a)(d,"SharedControllerFactoryParameters",null,[]);c.prototype.dispose=function(){this.HGa&&this.HGa.getWywaEvent().removeListener(this.ODf);this.HGa=this.$=null;Tb.a.Ia(this.l_a);this.flyoutRibbonButton=this.flyoutFocus=this.k2d=this.rwe=this.UZc=this.l_a=null};c.prototype.lTi=function(){this.flyoutRibbonButton.toggleCatchUpFlyout();return!0};c.prototype.wui=function(){Da.ULS.sendTraceTag(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");this.taf()&&Da.ULS.sendTraceTag(526718752,
3012,50,"ActivityFeedData is enabled")};c.prototype.xsi=function(Rb,qc){m("ScriptDownload");Zb.TaskExtensions.Ba(Dc.GetServiceTaskFactory.Ra(this.$.da,283,284,qc),function(Oc){Rb(Vd.c(Oc.result.tn.loadScript("catchUpActivity")))},this.$.da.la,3)};c.prototype.i6a=function(){return!!this.Qjf&&this.Qjf.i6a()&&this.$.ea.L7a};c.prototype.taf=function(){return eb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)};c.prototype.WGi=function(Rb){var qc=this;Zb.TaskExtensions.Ba(Rb,
function(){xb.a(function(){qc.HGa=catchUpActivity.FactoryGlobal.getExcelCatchUpAppInstance(Object(Cb.a)(new d,{activityContentManager:Object(yc.a)(851,qc.k2d),activityNavigationManager:Object(yc.a)(852,qc.rwe),activityRequestManager:Object(yc.a)(853,qc.UZc),dataCulture:qc.$.ya.DataCultureTag,flyoutFocus:null,flyoutRibbonButton:Object(yc.a)(k,qc.flyoutRibbonButton),uiCulture:qc.$.ya.UICultureTag,ulsLogger:new rc.a,emptyCatchUpBehaviorManager:Object(yc.a)(854,qc.emptyCatchUpBehaviorManager)}))});qc.l_a.Izg=
qc.HGa.getActivityIndicatorTooltipManager();cc.a(qc.$);qc.HGa.getWywaEvent().addListener(qc.ODf);m("InitializeCatchUpApp");qc.HGa.initialize(Object(Cb.a)(new e,{featuredActivityGroupsEnabled:!1,summaryStringEnabled:qc.i6a(),includeRelevantAuthorsInSummaryString:!1,useCompactSummaryString:eb.EwaSettings.isChangeGateEnabled("OfficeVSO:5788078_useCompactStringOnExcel"),activityFeedDataEnabled:qc.taf()}))},this.$.la,3)};Af.Object.defineProperties(c.prototype,{Xaf:{configurable:!0,enumerable:!0,get:function(){var Rb=
this.flyoutRibbonButton.Lyb;Rb&&!this.K5e&&(Da.ULS.sendTraceTag(588129368,3012,50,"Catch Up Flyout is ready and button is enabled."),this.K5e=!0);return Rb}},gfi:{configurable:!0,enumerable:!0,get:function(){return this.flyoutRibbonButton.Icf}}});Object($a.a)(c,"CatchUpActivityManager",null,[855,10]);var Uc=pa.a;Rk(a,Uc);a.prototype.create=function(){var Rb=this;Zb.TaskExtensions.Ba(Dc.GetServiceTaskFactory.Ra(this.$.da,458,459,this.hb),function(qc){qc=qc.result;Rb.pb(Rb.$.da.za(286)||new c(Rb.$,
Rb.hb,null,qc))},this.$.la,3)};a.ka=function(Rb){Rb.da.Ga(287,new a(Rb))};Object($a.a)(a,"CatchUpActivityManagerFactory",pa.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Lineage");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.VersionHistory");Type.registerNamespace("_Ewa");Ja.a.Fa(Kb.ka);Ja.a.Fa(Hb.ka);Ja.a.Fa(zb.ka);Ja.a.Fa(P.ka);qe.a.vi('.LineageActivityPane{height:100%;display:flex;flex-direction:column;overflow:hidden;background-color:#edebe9}.LineageActivityPaneHeader{display:flex;flex-direction:row;position:relative;overflow:hidden;padding-right:16px;padding-left:16px;padding-top:16px;padding-bottom:11px;height:auto;background-color:#edebe9}.LineageActivityPaneTitle{max-width:240px;display:inline-flex;font-weight:bold;font-family:"Segoe UI Semi Bold","Segoe UI Web",Arial,Verdana,sans-serif;font-size:16px;line-height:16px;flex-grow:1;align-content:center;height:auto;text-overflow:ellipsis;overflow:hidden;background-color:#edebe9;margin:0}.LineageActivityCloseButton{display:inline-flex;align-self:center}.LineageActivityBody{height:100%;padding-left:16px;overflow:hidden;background-color:#edebe9}');
(function(){Ja.a.Fa(function(Rb){Qa.ka(Rb);da.ka(Rb);La.ka(Rb);ia.ka(Rb);eb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BlueDot",!1)&&ha.ka(Rb);mb.ka(Rb)})})();Type.registerNamespace("Common.App.CatchUpActivity");ca.main();(function(){Ja.a.Fa(function(Rb){m("Begin");a.ka(Rb);H.ka(Rb)})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.catchup.js.map/9919f6bcabeba6f2d5a87dcfcbeb26dd/EwaDS.catchup.js.map