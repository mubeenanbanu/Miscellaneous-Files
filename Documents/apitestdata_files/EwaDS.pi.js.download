(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[17],{1058:function(u,D,b){function a(x){var C=this;this.businessBar=this.w7a=null;this.EGi=function(G,E){E.a6c?C.GGi(E):C.FGi(E)};this.ei=function(G,E){G=E.context.methodName;C.w7a&&G===C.w7a&&(w.ULS.sendTraceTag(537155230,0,50,'NetworkConnectionHealthChecker.OnWebMethodSuccess: Failed web method "{0}" has now succeeded. Querying local storage for BB showings.',C.w7a),C.S7a(a.TJb,!0),C.w7a=null);C.Glf(!1);C.j3b=!1};this.Jn=function(G,
E){z.a.Zg(E.errors,[-1387426400])&&!C.j3b&&(C.j3b=!0,C.q1f()&&window.performance.mark(a.Fsf),(new c(C)).Lqi())};this.ug=function(){C.Glf(!0);C.S7a(a.UCb,!1);C.S7a(a.TJb,!1)};this.sya=function(){w.ULS.sendTraceTag(537155225,0,50,"NetworkConnectionHealthChecker.OnNetworkResumed: Network resumed for session. Querying local storage for BB showings.");C.S7a(a.UCb,!0)};this.$=x;this.oa=this.$.oa;this.localStorage=new v.a;this.j3b=!1;this.$.ea.wl(this.ug);this.oa.tf.bnb(this.sya);this.oa.Vq(this.ei);this.$.da.Za(5,
function(G){C.businessBar=G;G.MDg(C.EGi)});this.oa.Ky(this.Jn)}function c(x){var C=this;this.yjd=[l.hhg,l.Vgg];this.xn=function(G,E){C.XN[E]=G;C.W4h()&&C.Mej("OnNetworkDownImmediatePing"===G.caller)};this.rla=x;this.$=x.$;this.XN={}}function d(){}function e(x,C,G,E,I){this.url="";this.k5a=!1;this.H7=-1;this.testIteration=0;this.baseUrl=G;this.Nuf=E;this.N7e=C;this.result=new k(C,I)}function k(x,C){this.testName=null;this.startTimeMs=0;this.isSuccess=!1;this.caller=this.errorStatusCode=this.errorMessage=
null;this.reqTotalDurationMs=0;this.browserResourceTiming=null;this.testIteration=0;this.testName=x;this.caller=C;this.reset()}function l(){}function m(){this.scenario=null;this.timeElapsed=0;this.isNewSession=!1;this.rawData=null}b.r(D);u=b(0);var f=b(7),w=b(15),n=b(334),z=b(29),r=b(10),v=b(324);Object(u.a)(m,"ConnectionErrorLogInfo",null,[]);l.Vgg="b-ring_Apc_Trans";l.hhg="cdn_static_resource_ewa_image";Object(u.a)(l,"ResourceHosts",null,[]);var A=b(54),B=b(262);k.prototype.reset=function(){this.isSuccess=
!1;this.startTimeMs=-1;this.errorStatusCode=this.errorMessage="";this.reqTotalDurationMs=-1;this.browserResourceTiming=null};Object(u.a)(k,"NetworkTestResult",null,[]);var y=b(642);e.prototype.runTest=function(){try{if(this.k5a)return w.ULS.sendTraceTag(537155206,0,50,"NetworkTestReq.RunTest: a test for the host {0} is already mid way, not starting a new one.",this.N7e),!1;this.reset();this.k5a=!0;this.result.startTimeMs=Date.now();var x=new B.QueryStringBuilder(this.baseUrl);x.y9("tid",this.result.startTimeMs.toString());
this.url=x.toString();this.kmj();this.testIteration++;this.result.testIteration=this.testIteration;return!0}catch(C){return this.Btb("Exeption: "+C.message),!1}};e.prototype.reset=function(){this.url="";this.result.reset();this.k5a=!1;this.H7=-1};e.prototype.clearTimeout=function(){-1!==this.H7&&(window.clearTimeout(this.H7),this.H7=-1)};e.prototype.kmj=function(){var x=this;try{var C=new XMLHttpRequest;C.onreadystatechange=function(){4===C.readyState&&(200===C.status?x.TAh():x.Btb(String.format("Error when downloading resource. status code: {0}, status text: {1}",
C.status,C.statusText),C.status.toString()))};C.onerror=function(){x.Btb(String.format("Client error when attempting to download resource. status code: {0}, response: {1}",C.status,C.statusText))};this.H7=window.setTimeout(function(){x.H7=-1;x.Btb("Request timeout")},1E4);C.open("GET",this.url,!0);C.send(null)}catch(G){this.Btb("Exeption: "+G.message)}};e.prototype.TAh=function(){this.k5a&&(this.result.reqTotalDurationMs=Date.now()-this.result.startTimeMs,this.clearTimeout(),this.result.browserResourceTiming=
y.a(this.url),this.result.isSuccess=!0,this.X2b())};e.prototype.Btb=function(x,C){C=void 0===C?null:C;this.k5a&&(this.clearTimeout(),this.result.errorMessage=x,this.result.isSuccess=!1,this.result.errorStatusCode=C,this.X2b())};e.prototype.X2b=function(){this.k5a=!1;this.Nuf&&this.Nuf(this.result,this.N7e)};Object(u.a)(e,"NetworkTestReq",null,[]);d.QFh=function(x,C,G){G=void 0===G?null:G;d.Alc||(d.Alc=Array.isArray(A.a.Vh(C.ya.NetworkMeasurementUrlList))?A.a.Vh(C.ya.NetworkMeasurementUrlList):null);
for(var E=[],I=0;I<d.Alc.length;I++){var U=d.Alc[I],M=U.key;M||(M=U.Key);if(!G||Array.contains(G,M)){var T=U.value;T||(T=U.Value);M&&T&&E.push(new e(C,M,T,x,"OnNetworkDownImmediatePing"))}}return E};d.Alc=null;Object(u.a)(d,"NetworkConnectionHelpers",null,[]);c.prototype.Lqi=function(){var x=d.QFh(this.xn,this.$,this.yjd);x=ak(x);for(var C=x.next();!C.done;C=x.next())C.value.runTest()};c.prototype.W4h=function(){for(var x=ak(this.yjd),C=x.next();!C.done;C=x.next())if(C=C.value,void 0===this.XN[C]||
null===this.XN[C])return!1;return!0};c.prototype.Mej=function(x){var C=this.$.tf.uV;x&&this.FFj(C);x=ak(this.yjd);for(var G=x.next();!G.done;G=x.next())G=G.value,this.XN[G]=Sys.Serialization.JavaScriptSerializer.serialize(this.XN[G]);x=Date.now();G=this.rla.lgd(b(1058).NetworkConnectionHealthChecker.UCb).returnValue;var E=this.rla.lgd(b(1058).NetworkConnectionHealthChecker.TJb).returnValue;this.XN.isOfflineMode=C;this.XN.networkDownBBAge=-1===G?G:x-G;this.XN.transientServerCommunicationFailuresBBAge=
-1===E?E:x-E;this.rla.businessBar?(this.XN.isNetworkDownBBShown=this.rla.businessBar.hC(55).toString(),this.XN.isServerErrorBBShown=this.rla.businessBar.hC(21).toString()):(this.XN.isNetworkDownBBShown="unknown",this.XN.isServerErrorBBShown="unknown");w.ULS.sendTraceTag(537155224,0,50,"ConnectionHealthTestsRunner.ReportPingResults: {0}",Sys.Serialization.JavaScriptSerializer.serialize(this.XN))};c.prototype.FFj=function(x){for(var C=b(1058).NetworkConnectionHealthChecker,G={},E=ak(Object.keys(this.XN)),
I=E.next();!I.done;I=E.next())I=this.XN[I.value],G[I.testName]=I.isSuccess;G.isOfflineMode=x;this.rla.uTd(C.C1c,Sys.Serialization.JavaScriptSerializer.serialize(G))};Object(u.a)(c,"ConnectionHealthTestsRunner",null,[]);b.d(D,"NetworkConnectionHealthChecker",function(){return a});a.prototype.dispose=function(){this.$&&(this.$.ea&&this.$.ea.Ln(this.ug),this.oa&&(this.oa.tf.VHb(this.sya),this.oa.Hz(this.Jn),this.oa.cs(this.ei)))};a.prototype.GGi=function(x){var C={};C.Timestamp=Date.now().toString();
switch(x.sGa){case 21:this.w7a=x.data.FailedMethod;C.FailedMethod=this.w7a;this.uTd(a.TJb,JSON.stringify(C));break;case 55:this.uTd(a.UCb,JSON.stringify(C))}};a.prototype.FGi=function(x){switch(x.sGa){case 21:this.S7a(a.TJb,!0);break;case 55:this.S7a(a.UCb,!0)}};a.prototype.uTd=function(x,C){try{this.localStorage.Cf()&&this.localStorage.setItem(x,C)}catch(G){w.ULS.sendTraceTag(537155231,0,15,"NetworkConnectionHealthChecker.StoreDataInLocalStorage: Failed to set item to local storage. reason: {0}",
G.message||"Unknown")}};a.prototype.lgd=function(x){if(this.localStorage.Cf()&&(x=this.localStorage.jvb(x))&&"null"!==x){var C=JSON.parse(x);x=parseInt(C.Timestamp,10);C=Sys.Serialization.JavaScriptSerializer.serialize(C);return{returnValue:x,rawData:C}}return{returnValue:-1,rawData:null}};a.prototype.Glf=function(x){if(this.localStorage.Cf()){var C=this.localStorage.jvb(a.C1c);if(C&&"null"!==C){var G=-1;this.j3b&&(G=this.aNh(a.Fsf,a.tFi));w.ULS.sendTraceTag(537155229,0,50,"NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: Ping Results: {0}, Period offline: {1}, New session: {2}",
Sys.Serialization.JavaScriptSerializer.serialize(C),G,x);this.localStorage.removeItem(a.C1c)}}};a.prototype.aNh=function(x,C){if(!this.q1f())return-1;window.performance.measure(C,x);x=window.performance.getEntriesByName(C);return x.length&&x[x.length-1]?x[x.length-1].duration:(w.ULS.sendTraceTag(537155228,0,10,"NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: measure name {0} returned no measures.",C),-1)};a.prototype.S7a=function(x,C){try{var G=this.lgd(x);var E=G.rawData;var I=G.returnValue;
if(-1!==I){var U=Object(f.a)(new m,{timeElapsed:Date.now()-I,scenario:x,isNewSession:!C,rawData:E});w.ULS.sendTraceTag(537155227,0,50,"NetworkConnectionHealthChecker.LogNetworkIssueBBShown: {0}",JSON.stringify(U))}this.localStorage.removeItem(x)}catch(M){w.ULS.sendTraceTag(537155226,0,15,"NetworkConnectionHealthChecker.LogNetworkIssueBBShown: Failed to get item from local storage. reason: {0}",M.message||"Unknown")}};a.prototype.q1f=function(){return r.HelperMethods.fYc&&n.a.Kob};a.UCb="NetworkDownBBShown";
a.TJb="ServerCommunicationFailureBBShown";a.C1c="ConnectionHealthPingRsults";a.Fsf="offMoStMa";a.tFi="offMoDuMea";Object(u.a)(a,"NetworkConnectionHealthChecker",null,[10])},1318:function(u,D,b){function a(){Type.registerNamespace("Common.App.InsertFile")}b.d(D,"a",function(){return a})},1319:function(u,D,b){function a(){Type.registerNamespace("Common.App.InsertPicture")}b.d(D,"a",function(){return a})},1321:function(u,D,b){function a(){c.a.vi(".insert-media-dialog-old{width:870px;float:left;margin-top:7px}.insert-media-dialog{width:870px;width:clamp(400px,870px,80vw);float:left;margin-top:7px}.app-rtl .insert-media-dialog{float:right}.insert-media-frame{width:100%;height:100%;visibility:visible}.insert-media-panel-old{height:550px}.insert-media-panel{height:550px;height:clamp(300px,550px,90vh)}.keep-focus-start{position:absolute;width:-1000px;top:-1000px}.keep-focus{position:absolute;width:-1000px;top:1000px}.display-none{display:none}.padding-zero{padding:0}")}
b.d(D,"a",function(){return a});var c=b(559)},1345:function(u,D,b){function a(){jc.a.Fa(function(Fa){c.ka(Fa)})}function c(Fa){var Qb=Qe.call(this)||this;Qb.$=Fa;Qb.Im=dc.a.instance;Qb.Eb();return Qb}function d(Fa){var Qb=this;this.c5b="";this.e2=this.Js=null;this.bqc=!1;this.X6e=function(cb,Xb){Qb.hide(void 0===cb?null:cb,void 0===Xb?null:Xb)};this.gridView=ma.g(Fa);this.gridView.ha.yG(this.X6e)}function e(){}function k(Fa,Qb){var cb=Gd.call(this,Fa)||this;cb.Mo=null;cb.Dbi=function(Xb,kc){1===Xb?
(Xb=k.efh[kc[k.dfh]],Ia.ULS.sendTraceTag(537167683,0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler OK button pressed with valid input, shift direction = {0}",0===Xb?"Horizontal":"Vertical"),cb.Mo.setResult(Xb)):(Ia.ULS.sendTraceTag(537167682,0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler cancel button pressed"),cb.Mo.nt())};cb.sg(Qb);return cb}function l(Fa){this.MEc=this.QOc=null;this.$=Fa}function m(){}function f(){}function w(){}function n(){}function z(Fa){this.k2c=
this.Usa=null;this.p$a=15;this.$=Fa}function r(Fa,Qb){this.$=Fa;this.Wnb=Qb}function v(Fa,Qb,cb,Xb){Fa=Q.call(this,Fa)||this;Fa.isFromCurrentSession=!1;Fa.top=0;Fa.left=0;Fa.isFromCurrentSession=Qb;Fa.top=cb;Fa.left=Xb;return Fa}function A(Fa,Qb,cb,Xb,kc){kc=void 0===kc?null:kc;var Wc=M.call(this,Fa,"ArtCopyPasteHandler")||this;Wc.UYg="XLO";Wc.VYg="3";Wc.wU=new E(Fa);Wc.s$=Qb;Wc.hZa=cb;Wc.ha=ma.g(Fa).ha;Wc.m2c=kc||new U(Wc.s$);Wc.iXi=new B(cb,Fa);Wc.Wnb=Xb;return Wc}function B(Fa,Qb){this.tIb=new mc.a;
this.hZa=Fa;this.$=Qb;this.R1i=function(cb){return Promise.resolve(cb)};this.zEb=function(cb){return Promise.reject(cb)}}function y(Fa,Qb,cb,Xb,kc,Wc,id,Vc,td){this.promise=null;this.ribbonCommandInfo=Fa;this.destination=Qb;this.DGe=cb;this.pOb=kc;this.w0=Wc;this.item=id;this.pasteContext=Vc;this.zNa=cb||Qb.FirstRow+"_"+Qb.FirstColumn;this.Bdf=!0;this.tye=td}function x(Fa,Qb,cb,Xb,kc,Wc,id){this.floatingObjectId=Fa;this.commandParameters=Qb;this.ot=cb;this.Nah=Xb;this.laa=void 0===Wc?null:Wc;this.pOb=
void 0===id?null:id;this.l3g=kc}function C(Fa,Qb,cb,Xb){Qb=I.call(this,Fa,Qb,cb,"AcrossSessionRangeCopyPasteHandler",void 0===Xb?null:Xb)||this;Qb.wU=new E(Fa);return Qb}function G(Fa,Qb){Qb=void 0===Qb?null:Qb;var cb=Ie.call(this,Ee[Fa])||this;cb.copyErrorName=0;cb.ewaErrors=null;cb.copyErrorName=Fa;cb.ewaErrors=Qb;if(null===Qb||void 0===Qb?0:Qb.length)cb.innerError=new He.a(Qb,null);return cb}function E(Fa){this.wU=new ue.a(!0);this.$=Fa}function I(Fa,Qb,cb,Xb,kc){kc=void 0===kc?null:kc;Xb=M.call(this,
Fa,Xb)||this;Xb.v3g=Qb;Xb.s$=cb;Xb.n2c=kc||new U(Xb.s$);Xb.gridView=ma.g(Fa);Xb.ha=Xb.gridView.ha;Xb.clipboardRangeFactory=Fa.da.za(169);return Xb}function U(Fa){this.clipboardItems=this.key=null;this.s$=Fa}function M(Fa,Qb){this._name=Qb;this.$=Fa;this.Im=dc.a.instance;this.Gp=new O(Fa,ma.g(Fa))}function T(Fa){return Fa.shadowWorkbookSizeExceedsLimit?!0:F(Fa)>yb.a.Gkc}function F(Fa){return Fa?Fa.shadowWorkbookSizeExceedsLimit&&void 0!==Fa.shadowWorkbookBlockedSize&&null!==Fa.shadowWorkbookBlockedSize?
Fa.shadowWorkbookBlockedSize:Fa.shadowWorkbookBase64?Fa.shadowWorkbookBase64.length:0:0}function K(){}function J(Fa){var Qb={};this.s6f=(Qb["SourceItemType.Range"]=0,Qb["SourceItemType.Art"]=1,Qb);this.YLb={};Qb={};this.o6f=(Qb["FloatingObjectType.Unknown"]=99,Qb["FloatingObjectType.CardView"]=6,Qb["FloatingObjectType.Chart"]=0,Qb["FloatingObjectType.Group"]=7,Qb["FloatingObjectType.Image"]=1,Qb["FloatingObjectType.Ink"]=8,Qb["FloatingObjectType.InteractiveReport"]=4,Qb["FloatingObjectType.ModernOfficeExtension"]=
3,Qb["FloatingObjectType.Shape"]=5,Qb["FloatingObjectType.Slicer"]=2,Qb["FloatingObjectType.Unsupported"]=100,Qb);Qb={};this.FWc=(Qb["99"]="FloatingObjectType.Unknown",Qb["6"]="FloatingObjectType.CardView",Qb["0"]="FloatingObjectType.Chart",Qb["7"]="FloatingObjectType.Group",Qb["1"]="FloatingObjectType.Image",Qb["8"]="FloatingObjectType.Ink",Qb["4"]="FloatingObjectType.InteractiveReport",Qb["3"]="FloatingObjectType.ModernOfficeExtension",Qb["5"]="FloatingObjectType.Shape",Qb["2"]="FloatingObjectType.Slicer",
Qb["100"]="FloatingObjectType.Unsupported",Qb);Qb={};this.r6f=(Qb["RibbonCommand.Copy"]=-911352779,Qb["RibbonCommand.Cut"]=-1985798686,Qb);Qb={};this.cLd=(Qb["-911352779"]="RibbonCommand.Copy",Qb["-1985798686"]="RibbonCommand.Cut",Qb);Qb={};this.q6f=(Qb["InputManager.InputMethod.NotDefined"]=-1,Qb["InputManager.InputMethod.Unknown"]=0,Qb["InputManager.InputMethod.Keyboard"]=1,Qb["InputManager.InputMethod.Mouse"]=2,Qb["InputManager.InputMethod.Touch"]=3,Qb["InputManager.InputMethod.CrossSlide"]=9,
Qb);this.bka={};Qb={};this.p6f=(Qb["FrameMode.None"]=0,Qb["FrameMode.Reading"]=1,Qb["FrameMode.Edit"]=2,Qb);this.N2a={};Qb={};this.t6f=(Qb["UILocation.Unknown"]=0,Qb["UILocation.UpperRibbon"]=1,Qb["UILocation.Ribbon"]=2,Qb["UILocation.QAT"]=3,Qb["UILocation.Jewel"]=4,Qb["UILocation.NavigationPane"]=5,Qb["UILocation.KeyboardShortcut"]=6,Qb["UILocation.StatusBar"]=7,Qb["UILocation.Dialog"]=8,Qb["UILocation.Floatie"]=9,Qb["UILocation.NotificationBar"]=10,Qb["UILocation.StandaloneCuiRoot"]=11,Qb["UILocation.TaskPane"]=
12,Qb["UILocation.HeroDock"]=13,Qb["UILocation.SingleLineRibbon"]=14,Qb["UILocation.MultilineRibbon"]=15,Qb["UILocation.Overflow"]=16,Qb["UILocation.TellMe"]=17,Qb["UILocation.FarPeripheralControls"]=18,Qb["UILocation.ContextMenu"]=19,Qb["UILocation.DialogMenu"]=20,Qb["UILocation.Header"]=21,Qb["UILocation.FileMenu"]=22,Qb["UILocation.Toolbar"]=26,Qb["UILocation.Canvas"]=30,Qb);this.ur={};this.$=Fa;this.bka.notDefined="InputManager.InputMethod.NotDefined";this.bka.unknown="InputManager.InputMethod.Unknown";
this.bka.keyboard="InputManager.InputMethod.Keyboard";this.bka.mouse="InputManager.InputMethod.Mouse";this.bka.touch="InputManager.InputMethod.Touch";this.bka.crossSlide="InputManager.InputMethod.CrossSlide";this.N2a.none="FrameMode.None";this.N2a.reading="FrameMode.Reading";this.N2a.edit="FrameMode.Edit";this.ur.unknown="UILocation.Unknown";this.ur.upperRibbon="UILocation.UpperRibbon";this.ur.ribbon="UILocation.Ribbon";this.ur.QAT="UILocation.QAT";this.ur.jewel="UILocation.Jewel";this.ur.navigationPane=
"UILocation.NavigationPane";this.ur.keyboardShortcut="UILocation.KeyboardShortcut";this.ur.statusBar="UILocation.StatusBar";this.ur.dialog="UILocation.Dialog";this.ur.floatie="UILocation.Floatie";this.ur.notificationBar="UILocation.NotificationBar";this.ur.standaloneCuiRoot="UILocation.StandaloneCuiRoot";this.ur.taskPane="UILocation.TaskPane";this.ur.heroDock="UILocation.HeroDock";this.ur.singleLineRibbon="UILocation.SingleLineRibbon";this.ur.multilineRibbon="UILocation.MultilineRibbon";this.ur.overflow=
"UILocation.Overflow";this.ur.tellMe="UILocation.TellMe";this.ur.farPeripheralControls="UILocation.FarPeripheralControls";this.ur.header="UILocation.Header";this.ur.fileMenu="UILocation.FileMenu";this.ur.contextMenu="UILocation.ContextMenu";this.ur.dialogMenu="UILocation.DialogMenu";this.ur.toolbar="UILocation.Toolbar";this.ur.canvas="UILocation.Canvas";this.YLb.range="SourceItemType.Range";this.YLb.art="SourceItemType.Art"}function O(Fa,Qb){this.Lic=this.RMa=null;this.WOa=Ja.a.WOa;this.sCd=Ja.a.sCd;
this.Gfc=Db.EwaSettings.getBooleanFeatureGate(Ja.a.L4b,!1);this.Kld=!1;this.Awa=Db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CopyPasteWFEIncreasedLimits",!1);this.$=Fa;this.gridView=Qb;this.Kld&&(this.$.userOperationManager.Cr(Object(ec.a)(this,this.Bz,"onQueueChanged")),this.$u=new wb.a)}function N(Fa,Qb,cb,Xb,kc,Wc,id,Vc,td){this.destinationRange=Fa;this.Gqb=cb;this.vFf=Xb;this.Ed=kc;this.pOb=Wc;this.pasteContext=id;this.Jpb=Vc;this.MVd=td}function H(Fa){this.parameters=null;this.parameters=
Fa}function Q(Fa){this.pasteParameters=null;this.pasteParameters=Fa}function ca(Fa,Qb){this.content=this.destinationRange=null;this.destinationRange=Fa;this.content=Qb}function X(Fa,Qb,cb){this.destinationRange=this.sourceRange=null;this.pasteFlags=0;this.sourceRange=Fa;this.destinationRange=Qb;this.pasteFlags=cb}function Z(Fa,Qb,cb,Xb,kc,Wc,id,Vc){Vc=void 0===Vc?null:Vc;id=Fa.Na(1,void 0===id?null:id);id.pasteParameters=Qb;return ub.g(Fa,"Paste",id,cb,Xb,kc,Wc,64,Vc)}function ea(Fa,Qb,cb,Xb,kc,Wc,
id,Vc){Vc=void 0===Vc?null:Vc;id=Fa.Na(1,void 0===id?null:id);id.copyParameters=Qb;return ub.g(Fa,"Copy",id,cb,Xb,kc,Wc,0,Vc)}function ka(Fa,Qb,cb,Xb,kc,Wc,id,Vc,td){td=void 0===td?null:td;Vc=Fa.Na(9,Vc);Vc.destinationRange=Qb;Vc.source=cb;return ub.g(Fa,"PasteString",Vc,Xb,kc,Wc,id,64,td)}function Y(Fa,Qb,cb,Xb,kc,Wc,id,Vc){Vc=void 0===Vc?null:Vc;id=Fa.Na(1,id);id.pasteHtmlParameters=Qb;return ub.g(Fa,"PasteHtmlContent",id,cb,Xb,kc,Wc,64,Vc)}function qa(){this.E_a=this.xye=null}function fa(Fa,Qb,
cb,Xb,kc,Wc,id,Vc,td){td=void 0===td?null:td;var rd=Cb.call(this)||this;rd.pasteShortcutManager=null;rd.hbf=Db.EwaSettings.tb();rd.Awa=Db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CopyPasteWFEIncreasedLimits",!1);rd.C8f=null;rd.M6a=!1;rd.Ydf=Db.EwaSettings.isChangeGateEnabled("OfficeVSO:6004791_MergedCellOverlapTelemetry");rd.qqd=Db.EwaSettings.isChangeGateEnabled("OfficeVSO:6660890_Tag_aoi75RetryLoggingFix2");rd.bAd=function(za){rd.Svj(za)&&(rd.Gp.Wwb(),Ia.ULS.sendTraceTag(537167777,
0,50,"CopyPasteInfrastructure.OnMetadataChanged: found that cut/copy operation was preformed in another session therefore removed the highlight in this session."))};rd.awi=function(za,tb){Ia.ULS.sendTraceTag(537167768,0,50,"CopyPasteInfrastructure.LogShortcutDialogAndRestoreFocus: Got shortcut dialog, user pressed [{0}]. userPressedExtensionLink={1}",za,tb);rd.gridView.focus()};rd.Yc=function(za,tb){tb.XM||tb.kg||rd.$q("OnWorkbookOpened",!1).catch(function(){})};rd.wh=function(za,tb){za=ta(rd.mK);
var Wb=rd.Gp.Kvb(za);Wb&&(tb.pa&&tb.pa.sheetName===Wb.sheetName&&Wb.isFromCurrentSession(rd.$)?rd.Gp.t7e(Wb.ranges,za.commandParameters.commandType):rd.Gp.Wwb())};rd.jnc=function(za,tb){za=ta(rd.mK);(za=rd.Gp.Kvb(za))&&tb.item&&tb.item.sheetName===za.sheetName&&za.isFromCurrentSession(rd.$)&&rd.$q("OnItemDeleting",!1).catch(function(){})};rd.NEb=function(za,tb){rd.hbf?rd.C8f(za,tb):rd.BCf()};rd.rR=function(za,tb){1===tb.Fq&&tb.Ff.operation.flags&2&&rd.$q("OnQueueItemChanged/ItemRemoved",!1).catch(function(){})};
rd.$=Fa;rd.Gg=cb;rd.gridView=ma.g(Fa);rd.Gp=kc;rd.Cbi=Wc;rd.mK=Qb;rd.L3b=Xb;rd.getStringifiedError=td||copyPasteInfra.getStringifiedError;rd.S1f=1===Vc;rd.Ti();rd.copyPasteShortcutDialogFactory=rd.$.da.za(85);Ia.ULS.shipAssertTag(537167825,0,!!rd.copyPasteShortcutDialogFactory,"CopyPasteInfrastructure.ctor: this.copyPasteShortcutDialogFactory shouldn't be null.");id||(Ia.ULS.sendTraceTag(537167824,0,50,"CopyPasteInfrastructure.ctor: userId is null, using default userId."),id=fa.Ech);rd.userHash=fb.a.Nv(id);
rd.cAi="CultureTag: "+dc.a.instance.Prb+" HASH: ";rd.mK.addMetadataChangeListener(fa.ypf,rd.bAd);rd.fvd=rd.$.ya.MaxCopyPasteLength;rd.Nxa=rd.Awa?Db.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.CopyPasteHtmlImportMaxLength",rd.$.ya.CopyPasteMaxPayloadLength):yb.a.Nxa;rd.ko=Db.EwaSettings.getBooleanFeatureGate(Ja.a.oPa,!1);rd.ko&&Fa.da.Za(478,function(za){rd.pasteShortcutManager=za});rd.hbf&&(rd.C8f=Aa.a(function(){rd.BCf()},1,rd.$.la,"CopyPasteInfrastructure.OnStartEditInternal",!0));return rd}
function ha(Fa){if(!Fa)return"null";var Qb=[];Fa=ak(Fa.get());for(var cb=Fa.next();!cb.done;cb=Fa.next())cb=cb.value,cb=String.format("{0}({1})",cb.clipboardDataFormat,cb.data.length),Qb.push(cb);Qb.sort();return Qb.join(",")}function ia(Fa){switch(Fa){case 0:return"None";case 2:return"Art";case 1:return"Range";default:return"Unknown"}}function wa(Fa,Qb){return Fa?Qb&&Qb.ya?Fa.sessionId!==Qb.ya.UserSessionId:(Ia.ULS.shipAssertTag(537166209,0,!1,"ewaControl shouldn't be null"),!1):(Ia.ULS.shipAssertTag(537166210,
0,!1,"copyContext shouldn't be null"),!1)}function Qa(){}function S(){}function da(){}function xa(Fa,Qb,cb,Xb){this.$=Fa;this.originalDestinations=Qb;this.M8b=cb;this.$jg=Xb;this.qug=this.originalDestinations;this.Sng=this.M8b;this.Irg="PasteRecoveryUI"}function ta(Fa){return Fa&&(Fa=Fa.getCachedMetadata(),null===Fa||void 0===Fa?0:Fa.lastCopy)?Fa.lastCopy:null}function ab(Fa){return Fa.clipboardItems&&(Fa=Fa.clipboardItems.getItem(la.Bfi))&&"1"===Fa?!0:!1}function Na(Fa){return Ka(Fa)&&!(void 0===
Fa.clipboardItems||null===Fa.clipboardItems)&&!!Fa.clipboardItems.getItem(la.png)&&!Fa.clipboardItems.getItem(la.hW)}function Ka(Fa){return Fa.clipboardItems&&(Fa=Fa.clipboardItems.getItem(la.dji))&&"1"===Fa?!0:!1}function la(){}function Ea(){}function ra(Fa){return!!Fa&&Object.getType(Fa)===na}function na(Fa,Qb,cb,Xb,kc){Xb=sa.call(this,Xb,kc)||this;Ia.ULS.shipAssertTag(537167645,0,!!Qb&&0<Qb.length,"RangeSourceItem.ctor: ranges should not be null or empty");Xb.$=Fa;Xb.ranges=Qb;Xb.sheetName=cb;
return Xb}function ba(Fa,Qb,cb,Xb,kc){cb=sa.call(this,cb,Xb)||this;cb.activeFloatingObjectControlId=Fa;cb.sheetName=Qb;cb.type=kc;return cb}function sa(Fa,Qb){var cb=this;this.REh=function(){var Xb={};Xb.SourceItem=cb.toString();return Xb};this.sessionStateId=Fa;this.sessionId=Qb;this.toJSON=this.REh}function ya(Fa,Qb,cb,Xb,kc){var Wc=Fa.Stopwatch,id={};id.a=kc;id.e=Wc.id;id.c="RearrangeRowColumn";id.b="mouse";id.d=Fa.OperationId.toString();id.f=cb.toString();id.g=Xb.toString();id.h=Qb.toString();
id.i=Fa.DragDropIsShiftKeyDown;id.j=!0;id.o=Wc.qc;id.q=!1;id.r=Fa.CopyPasteTargetType.toString();id.s=Fa.EncounteredDeploymentErrors;return id}function va(Fa){Fa=bb.call(this,Fa)||this;Fa.TYg=function(){Ia.ULS.sendTraceTag(537167827,0,50,"ClipboardReadPermissionAskDialog OK button pressed")};Ia.ULS.sendTraceTag(537167828,0,50,"ClipboardReadPermissionAskDialog.ClipboardReadPermissionAskDialog");Fa.Rb=0;Fa.mc(1,dc.a.instance.ga(2226));var Qb=dc.a.instance.ga(2224),cb=Fa.DM();Fa.initializeAndShow(Qb,
Fa.TYg,cb);return Fa}var W=b(0),La=b(7),Ia=b(15),mb=b(232),fb=b(30),Ma=b(25),Hb=b(367),Kb=b(178),Ub=b(279),gb=b(370),Db=b(1),Va=b(38),yb=b(8),qb=b(390),dc=b(14),bb=qb.a;Rk(va,bb);va.prototype.DM=function(){var Fa={};Fa.id=this.nc;var Qb=dc.a.instance.ga(2225);Fa.DialogMessage=Qb;return Fa};Af.Object.defineProperties(va.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"ClipboardReadPermissionAskDialog"}}});Object(W.a)(va,"ClipboardReadPermissionAskDialog",qb.a,[]);var db=b(50);sa.prototype.ccf=
function(Fa){return Fa?this.sessionStateId===Fa.sessionStateId&&this.sessionId===Fa.sessionId:!1};sa.prototype.isFromCurrentSession=function(Fa){return this.sessionId===Fa.ya.UserSessionId};Object(W.a)(sa,"SourceItem",null,[]);Rk(ba,sa);ba.prototype.isEqual=function(Fa){return Fa&&Object.getType(Fa)===ba?this.ccf(Fa)&&this.activeFloatingObjectControlId===Fa.activeFloatingObjectControlId&&this.sheetName===Fa.sheetName:!1};ba.prototype.toString=function(){return this.type.toString()};Object(W.a)(ba,
"ArtSourceItem",sa,[]);var wc;(function(Fa){Fa[Fa.valid=0]="valid";Fa[Fa.notPairwiseDisjoint=1]="notPairwiseDisjoint";Fa[Fa.cutNotSupportedInDiscontinuousSelection=2]="cutNotSupportedInDiscontinuousSelection";Fa[Fa.notValidForm=3]="notValidForm";Fa[Fa.temporarilyBlockedCopy=4]="temporarilyBlockedCopy"})(wc||(wc={}));Object(W.b)("CopySourceValidationOptions",wc);var nb=b(45);Rk(na,sa);na.prototype.isEqual=function(Fa){return Fa&&Object.getType(Fa)===na?this.ccf(Fa)&&nb.Q(this.ranges,Fa.ranges)&&this.sheetName===
Fa.sheetName:!1};na.prototype.toString=function(){return nb.i(this.ranges,",",this.$,!1)};Object(W.a)(na,"RangeSourceItem",sa,[]);Ea.BUj="PasteError_FailedToReadFromClipboard_UserHashMismatchError";Object(W.a)(Ea,"ExpectedErrorNames",null,[]);la.hW="text/plain";la.html="text/html";la.png="image/png";la.iO="data/shadow-workbook";la.dji="metadata/is-last-copy-was-external";la.Bfi="metadata/is-last-copy-was-external-XLO-source";la.nXg="metadata/chrome-extension-id";la.Gqb="copyId";la.KHg="metadata/additional-signature-data-attributes";
Object(W.a)(la,"ClipboardDataFormat",null,[]);var zb=b(48),ma=b(21),P=b(33);xa.prototype.KJa=function(){return xa.qXi};xa.prototype.LMh=function(){return this.M8b&&1===this.M8b.length?this.MMh(this.M8b[0]):null};xa.prototype.MMh=function(Fa){var Qb=ma.g(this.$),cb=Qb.eb.gj(Fa),Xb=Qb.gg(Fa,cb);Qb=Qb.rtl;if(!Xb)return null;Fa=ma.g(this.$).Ef(cb);var kc=Fa.jn;if(!kc.xd(Xb))return null;Xb=kc.Ae(Xb);var Wc=Xb.topLeft.y,id=Xb.bottomRight.y,Vc=Qb?Xb.bottomRight.x:Xb.topLeft.x;Xb=Qb?Xb.topLeft.x:Xb.bottomRight.x;
var td=new zb.a(Xb+(Qb?-81:81),id+38+6);if(kc.iHa(td))return this.S3a(Fa,kc,cb,Xb,id,Qb?12:-3,66);td=new zb.a(Xb+(Qb?-81:81),id);if(kc.iHa(td))return this.S3a(Fa,kc,cb,Xb,id,Qb?20:3,22);td=new zb.a(Xb,id+38+6);if(kc.iHa(td))return this.S3a(Fa,kc,cb,Xb,id,-81+(Qb?18:0),66);Xb=new zb.a(Vc+(Qb?81:-81),id);if(kc.iHa(Xb))return this.S3a(Fa,kc,cb,Vc,id,-81+(Qb?12:-6),22);id=new zb.a(Vc,Wc-38-6);return kc.iHa(id)?this.S3a(Fa,kc,cb,Vc,Wc,Qb?15:0,16):this.S3a(Fa,kc,cb,Qb?kc.topLeft.x:kc.bottomRight.x,kc.bottomRight.y,
-81+(Qb?15:-6),22)};xa.prototype.S3a=function(Fa,Qb,cb,Xb,kc,Wc,id){var Vc=ma.g(this.$),td=Vc.rtl;Fa=Sys.UI.DomElement.getLocation(Fa.domElement);Xb=new Sys.UI.Point(Xb+(td?0:Fa.x)-Qb.topLeft.x,kc+Fa.y-Qb.topLeft.y);td&&(Vc=Vc.view.visibleArea,Xb.x=Vc.bottomRight.x-Vc.topLeft.x-Xb.x,2===cb||4===cb)&&(Xb.x+=Qb.bottomRight.x);Xb=P.a(this.$).xja(Xb);return new Sys.UI.Point(Xb.x+Wc,Xb.y+id)};Af.Object.defineProperties(xa.prototype,{JHg:{configurable:!0,enumerable:!0,get:function(){return this.$jg}},vri:{configurable:!0,
enumerable:!0,get:function(){return this.Irg}},N6i:{configurable:!0,enumerable:!0,get:function(){return this.qug}},oxh:{configurable:!0,enumerable:!0,get:function(){return this.Sng}}});xa.qXi=["PasteRecoveryUI"];Object(W.a)(xa,"PasteRecoveryUI",null,[732]);var oa=b(76),Ja=b(328);da.Dzg="ActiveSelection";da.iO="ShadowWorkbook";da.lig="GVML";da.hW="PlainText";da.html="Html";da.YNg="Bitmap";Object(W.a)(da,"PayloadType",null,[]);S.fCj="Slice4";S.gCj="Slice5";S.hCj="Slice6";Object(W.a)(S,"SliceName",null,
[]);Qa.CDi="NotCalled";Qa.success="Success";Qa.failed="Failed";Object(W.a)(Qa,"SucceededPopulatingSystemClipboardOptions",null,[]);var $a=b(375),Ta;(function(Fa){Fa[Fa.valid=0]="valid";Fa[Fa.destinationRangesIsEmpty=1]="destinationRangesIsEmpty";Fa[Fa.discontinuousSelectionNotSupportPasteFromExternal=2]="discontinuousSelectionNotSupportPasteFromExternal";Fa[Fa.discontinuousSelectionNotSupportPasteCrossSession=3]="discontinuousSelectionNotSupportPasteCrossSession";Fa[Fa.multipleSourcesAndMultipleDestinationsAreNotSupported=
4]="multipleSourcesAndMultipleDestinationsAreNotSupported";Fa[Fa.multipleDestinationsAreNotMultiplyOfSourceRange=5]="multipleDestinationsAreNotMultiplyOfSourceRange";Fa[Fa.sourceAndDestinationAreOverlapping=6]="sourceAndDestinationAreOverlapping";Fa[Fa.copySourceNotValid=7]="copySourceNotValid";Fa[Fa.cutNotSupportedInDiscontinuousSelection=8]="cutNotSupportedInDiscontinuousSelection";Fa[Fa.pasteLinkNotSupportMultipleDestination=9]="pasteLinkNotSupportMultipleDestination";Fa[Fa.temporarilyBlockedPaste=
10]="temporarilyBlockedPaste";Fa[Fa.unknown=100]="unknown"})(Ta||(Ta={}));Object(W.b)("PasteValidationOptions",Ta);var pa=b(51),Da=b(36),rb=b(151),Ab=b(37),ob=b(160),sb=b(357),Pb=b(29),Aa=b(330),Ya=b(10),kb=b(22),lb=b(95),ac=b(126),Dc=b(112),Zb=b(627),mc=b(100),Lb=b(58),Sa=b(259),Cb=Va.a;Rk(fa,Cb);fa.prototype.$Fg=function(Fa){this.addHandler(fa.aBd,Fa)};fa.prototype.$bj=function(Fa){this.removeHandler(fa.aBd,Fa)};fa.prototype.copy=function(Fa){var Qb=this;Fa.stopwatch=this.$.Fb.sc("UserAction",db.b().fi(Fa.ribbonCommandInfo.command)+
"ClientSide");if(this.ko){var cb=pa.GetServiceTaskFactory.Ra(this.$.da,478,479,0);Ab.TaskExtensions.Ba(cb,function(){Qb.pasteShortcutManager=cb.result},this.la,3)}var Xb=!!ta(this.mK);Db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Ma.a.LC&&(this.M6a=!1);this.$q("Copy/before/"+Hb.a[Fa.ribbonCommandInfo.method],!1,void 0,!0,Fa.copyPasteTargetType).catch(function(){});var kc=-1985798686===Fa.ribbonCommandInfo.command;if(1===this.gridView.Qe&&(kc=this.Gp.ubf(this.gridView.ha.sa.selectedRanges,
kc),0!==kc)){var Wc=fa.z2g(kc);this.Wya(Wc,wc[kc],!1);return Promise.reject(!1)}Fa.userHash=this.userHash;Fa.id=Kb.a.create().toString();var id=this,Vc=this;return this.L3b.onCopy(Fa).then(function(td){td.isAsyncCopy||Fa.stopwatch.stop();id.pasteIndicationManager.HIe();Ia.ULS.sendTraceTag(24150883,0,50,"CopyPasteInfrastructure.OnCopy: Copy operation finished successfully. {0}",$a.d(Fa));id.dui(td,Xb);td=Db.EwaSettings.isChangeGateEnabled("OfficeVSO:6591921_CheckTargetTypeForEnterToPaste")?1===Fa.copyPasteTargetType:
!0;!Fa.isFormatPainter&&id.ko&&td&&(id.pasteShortcutManager?id.pasteShortcutManager.hkh():Ia.ULS.shipAssertTag(537167823,0,!1,"Copy: pasteShortcutManager is null."));return Promise.resolve(!0)},function(td){var rd=!1,za="none",tb=fa.Mrb,Wb=!0,fc=-1,xc=fa.copyErrorName+fa.DIa,Yb=!1,Ec=null;if(td){Ec=td.copyContext;fc=td.reason;xc+=fa.RJa(td);td.message&&(tb=td.message);var bd=fa.y2g(td);if(bd)if(3===bd.copyErrorName)rd=!0,tb=za="Async Copy canceled by the user.",Wb=!1;else if(Pb.a.Xq(bd.ewaErrors))if(tb=
Vc.Kac(bd.ewaErrors),Pb.a.Zg(bd.ewaErrors,fa.operationSucceededWithAlert))Yb=rd=!0;else if(Pb.a.Zg(bd.ewaErrors,fa.pasteDataLimitHit)||Pb.a.Zg(bd.ewaErrors,fa.copyThrottlingError))rd=!0;13===td.reason?(rd=!0,Wb=!1):11===td.reason&&(Wb=!1)}rd?Ia.ULS.sendTraceTag(36304157,0,15,"CopyPasteInfrastructure.OnCopy: Copy operation failed with an expected error. clearStateNeeded: {0}, Friendly message: {1}, Error Message: {2}, CommandParameters: {3}",Wb,za,td?Vc.getStringifiedError(td):"null",$a.d(Fa)):Ia.ULS.sendTraceTag(24150912,
0,10,"CopyPasteInfrastructure.OnCopy: Copy operation failed with an unexpected error. clearStateNeeded: {0}, Error Message: {1}, CommandParameters: {2}",Wb,td?Vc.getStringifiedError(td):"null",$a.d(Fa));Wb&&Vc.$q("Copy/fail/"+Hb.a[Fa.ribbonCommandInfo.method],!0,void 0,void 0,Fa.copyPasteTargetType).catch(function(){});Vc.cui(Fa,rd,tb,xc,fc,Yb,Ec);return Promise.reject(td)})};fa.prototype.paste=function(Fa){var Qb=this;Fa.stopwatch=this.$.Fb.sc("UserAction",db.b().fi(Fa.ribbonCommandInfo.command)+
"ClientSide");Db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Ma.a.LC&&(Ia.ULS.sendTraceTag(537167822,0,50,"CopyPasteInfrastructure.OnPaste: Cross-app shadow workbook paste is enabled"),this.M6a=!1,Fa.clipboardPicklingApiDataFormatsToRead=[la.iO]);ma.g(this.$).ui&&ma.g(this.$).ui.w7(this.Ped(Fa.ribbonCommandInfo.command),Fa.stopwatch.id);if(Fa.isPasteCommandFromRecoveryUI){var cb=this.$.da.za(406);var Xb=Ub.a.clone(cb.Mrd);cb=cb.Crd;Fa.pasteRecoveryCachedClipboardItems=
cb?cb[fa.xFf]:null}else Xb=Ub.a.clone(this.gridView.ha.sa.selectedRanges);Fa.originalDestinations=Xb;Fa.expandDestinations=this.XYc(Fa.originalDestinations,Fa.commandType);if(this.jZc(Fa.commandType,Fa.expandDestinations)||this.lUg())return Fa.userHash=this.userHash,Fa.id=Kb.a.create().toString(),Db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PerfImpactExperimentForAsyncApi",!1)&&!Ma.a.LC&&(Fa.clipboardReadPermissionPromptShown=!1,Fa.clipboardAsyncApiDataFormatsToRead=[la.hW+"Async"],
this.L3b.shouldShowClipboardReadPermissionDialog().then(function(kc){kc&&(Fa.clipboardReadPermissionPromptShown=!0,new va(Qb.$));return Promise.resolve(!0)},function(){return Promise.resolve(!0)})),this.L3b.onPaste(Fa).then(function(kc){return Qb.Jnc(kc,Fa)},function(kc){return Qb.zEb(Fa,kc)});this.$.Fd(927125067,oa.a.Cb,30,null);Ia.ULS.sendTraceTag(24150913,0,15,'CopyPasteInfrastructure.OnPaste: paste was triggered but the estimated destination range is not editable, do nothing. ExpandDestinations: {0}, CommandType: {1}, copyPasteTargetType="{2}"',
nb.i(Fa.expandDestinations,",",this.$,!1),Fa.commandType,Fa.copyPasteTargetType);return Promise.resolve(!0)};fa.prototype.Ped=function(Fa){if(Db.EwaSettings.isChangeGateEnabled("OfficeVSO:4313497_PasteOptionPerfTelemetry"))switch(Fa){case 1804571062:return 6;case -185374993:return 7;case 1766348718:return 8}return 3};fa.prototype.lUg=function(){return!!ma.g(this.$).ha.Oa.activeFloatingObjectControlId&&this.$.kq(null,!1,470)};fa.prototype.UAb=function(){var Fa=ta(this.mK);return Fa&&Fa.commandParameters?
Fa.commandParameters.copyPasteTargetType:0};fa.prototype.cji=function(){return!!ta(this.mK)&&wa(ta(this.mK),this.$)};fa.prototype.$q=function(Fa,Qb,cb,Xb,kc){var Wc=this;cb=void 0===cb?!1:cb;Xb=void 0===Xb?!1:Xb;kc=void 0===kc?0:kc;try{this.ko&&this.pasteShortcutManager&&this.pasteShortcutManager.o6b();var id=kc,Vc=this.mqi();if(!Xb&&2===Vc)return Ia.ULS.sendTraceTag(537167821,0,50,"CopyPasteInfrastructure.ClearState clipboard won't be cleared as there's art in the clipboard. clearClipboardContent = '{0}', isExplicit = '{1}', isForce = '{2}', Current CCP operation copyPasteTargetType = '{3}', LastCopyPasteTargetType = '{4}'",
Qb,cb,Xb,kc,Vc),Promise.reject(null);0===id&&(id=Vc);var td=this.$.Fb.sc("UserAction","ClearCopyState"),rd=td.id;Ia.ULS.sendTraceTag(537167820,0,50,"CopyPasteInfrastructure.ClearState clear clipboard state. clearClipboardContent = '{0}', isExplicit = '{1}', isForce = '{2}', Current CCP operation copyPasteTargetType = '{3}', LastCopyPasteTargetType = '{4}'",Qb,cb,Xb,kc,Vc);this.Gp.Wwb();this.c4i();return this.L3b.onCancelCopy(Qb).then(function(){Qb&&Db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",
!1)&&!Ma.a.LC&&(Wc.M6a=!1);td.stop();Wc.$kf(Fa,rd,!0,cb,Qb,"","",td.qc,id);return Promise.resolve(!0)},function(za){Ia.ULS.sendTraceTag(24150915,0,15,"CopyPasteInfrastructure.ClearState: error during call to copyPasteFlowManager.OnClear(). error: {0}",za?Wc.getStringifiedError(za):"null");td.stop();var tb=fa.AUg+fa.DIa,Wb=fa.Mrb;za&&(tb+=fa.RJa(za),za.message&&(Wb=za.message));Wc.$kf(Fa,rd,!1,cb,Qb,Wb,tb,td.qc,id);return Promise.reject(za)})}catch(za){return Promise.reject(null)}};fa.prototype.k2b=
function(Fa,Qb,cb,Xb,kc){cb=void 0===cb?!1:cb;Xb=void 0===Xb?!1:Xb;kc=void 0===kc?0:kc;return Xb||!Db.EwaSettings.ma(660)||this.ihh()?this.$q(Fa,Qb,cb,Xb,kc):(Ia.ULS.sendTraceTag(537167819,0,50,"CopyPasteInfrastructure.ClearStateOnlyIfClipboardHasContentFromSameSession clipboard won't be cleared as there is no content in the clipboard from the current session"),Promise.reject(null))};fa.prototype.Wya=function(Fa,Qb,cb){Ia.ULS.sendTraceTag(590705172,0,50,"CopyPasteInfrastructure.PopupDiscontinuousSelectionErrorDialog: Blocked CCP due to discontinuous selection, reason: {0}",
Qb);var Xb=new mc.a;Xb.ia("reason",Qb);Zb.a(ac.a.discontinuousSelectionBlocking,[cb?Dc.a.kXi:Dc.a.r3g],!0,!0,!1,!1,Xb);Fa=Pb.a.Wc(1,1,754,Fa,0,371863010,"DiscontinuousSelectionBlocking");Db.EwaSettings.qz()?new sb.a(this.$,Fa):(Fa=new ob.ErrorDialog(this.$,Fa),Fa.initialize(),Fa.hf())};fa.prototype.mqi=function(){var Fa=ta(this.mK);return Fa&&Fa.sourceItem?Object.getType(Fa.sourceItem)===ba?2:1:0};fa.prototype.dragDropCells=function(Fa,Qb,cb,Xb,kc){var Wc=this;kc=void 0===kc?!1:kc;Fa.stopwatch=this.$.Fb.sc("UserAction",
"DragDropClientSide");this.$q("DragDrop/before/"+Hb.a[Fa.ribbonCommandInfo.method],!1,void 0,void 0,Fa.copyPasteTargetType).catch(function(){});var id=kc?2:1,Vc=0;Vc=kc?4:Xb?256:128;var td={encounteredDeploymentErrors:!1};td.commandParameters=Fa;Fa.userHash=this.userHash;Fa.id=Kb.a.create().toString();return this.qqd?this.Gp.pasteRange(Fa.ribbonCommandInfo,nb.q(Qb,this.$),nb.q(cb,this.$),id,Vc,[Fa.stopwatch],td,!1,function(){Ia.ULS.sendTraceTag(537167818,0,50,'CopyPasteInfrastructure.DragDropCells: success. copyPasteTargetType="{0}"',
Fa.copyPasteTargetType);Wc.P7a(Fa,id,Qb,cb,td)},function(rd){Ia.ULS.sendTraceTag(537167817,0,10,'CopyPasteInfrastructure.DragDropCells: {0}, copyPasteTargetType="{1}"',rd?Wc.getStringifiedError(rd):"null",Fa.copyPasteTargetType);Wc.k9a(rd,Fa,id,Qb,cb,td)}).then(function(){Wc.gridView.ha.selectionType=-1;return Promise.resolve(!0)},function(rd){return Promise.reject(rd)}):this.Gp.pasteRange(Fa.ribbonCommandInfo,nb.q(Qb,this.$),nb.q(cb,this.$),id,Vc,[Fa.stopwatch],td,!1,null,null).then(function(){Ia.ULS.sendTraceTag(521410075,
0,50,'CopyPasteInfrastructure.DragDropCells: success. copyPasteTargetType="{0}"',Fa.copyPasteTargetType);Wc.gridView.ha.selectionType=-1;Wc.P7a(Fa,id,Qb,cb,td);return Promise.resolve(!0)},function(rd){Ia.ULS.sendTraceTag(521410074,0,10,'CopyPasteInfrastructure.DragDropCells: {0}, copyPasteTargetType="{1}"',rd?Wc.getStringifiedError(rd):"null",Fa.copyPasteTargetType);Wc.k9a(rd,Fa,id,Qb,cb,td);return Promise.reject(rd)})};fa.prototype.Ghh=function(Fa,Qb,cb,Xb,kc){var Wc=this;kc=void 0===kc?!1:kc;Fa.stopwatch=
this.$.Fb.sc("UserAction","DragDropReplaceClientSide");this.k2b("DragDropReplace/before/"+Hb.a[Fa.ribbonCommandInfo.method],!1,void 0,void 0,Fa.copyPasteTargetType).catch(function(){});var id=kc?2:1,Vc=0;Vc=kc?4:Xb?256:128;var td={encounteredDeploymentErrors:!1};td.commandParameters=Fa;Db.EwaSettings.getBooleanFeatureGate(Ja.a.Y6b,!1)&&(Fa.isDragInsert=!1);Fa.userHash=this.userHash;Fa.id=Kb.a.create().toString();return this.qqd?this.Gp.pasteRange(Fa.ribbonCommandInfo,nb.q(Qb,this.$),nb.q(cb,this.$),
id,Vc,[Fa.stopwatch],td,!1,function(){Ia.ULS.sendTraceTag(537167816,0,50,'CopyPasteInfrastructure.DragDropReplaceCells: success. copyPasteTargetType="{0}"',Fa.copyPasteTargetType);Wc.P7a(Fa,id,Qb,cb,td)},function(rd){Ia.ULS.sendTraceTag(537167815,0,10,'CopyPasteInfrastructure.DragDropReplaceCells: {0}, copyPasteTargetType="{1}"',rd?Wc.getStringifiedError(rd):"null",Fa.copyPasteTargetType);return Wc.k9a(rd,Fa,id,Qb,cb,td)}).then(function(){Wc.gridView.ha.selectionType=-1;return Promise.resolve(!0)},
function(rd){return Promise.reject(rd)}):this.Gp.pasteRange(Fa.ribbonCommandInfo,nb.q(Qb,this.$),nb.q(cb,this.$),id,Vc,[Fa.stopwatch],td,!1,null,null).then(function(){Ia.ULS.sendTraceTag(521410073,0,50,'CopyPasteInfrastructure.DragDropReplaceCells: success. copyPasteTargetType="{0}"',Fa.copyPasteTargetType);Wc.gridView.ha.selectionType=-1;Wc.P7a(Fa,id,Qb,cb,td);return Promise.resolve(!0)},function(rd){Ia.ULS.sendTraceTag(521410072,0,10,'CopyPasteInfrastructure.DragDropReplaceCells: {0}, copyPasteTargetType="{1}"',
rd?Wc.getStringifiedError(rd):"null",Fa.copyPasteTargetType);Wc.k9a(rd,Fa,id,Qb,cb,td);return Promise.reject(rd)})};fa.prototype.Fhh=function(Fa,Qb,cb,Xb,kc){var Wc=this;kc=void 0===kc?!1:kc;Fa.stopwatch=this.$.Fb.sc("UserAction","DragDropInsertClientSide");this.k2b("DragDropInsert/before/"+Hb.a[Fa.ribbonCommandInfo.method],!1,void 0,void 0,Fa.copyPasteTargetType).catch(function(){});var id=kc?2:1,Vc=nb.K(this.XYc([cb],id)),td=this.$.ea.pa.sheetName,rd=this.$.ea.pa.sheetName,za=nb.v(Qb,this.$);za.SheetName=
td;td=nb.v(Vc,this.$);td.SheetName=rd;Xb=Vc.isRow||Qb.isRow||Xb?1:0;var tb={encounteredDeploymentErrors:!1};Fa.isDragInsert=!0;tb.commandParameters=Fa;Fa.userHash=this.userHash;Fa.id=Kb.a.create().toString();if(this.qqd)return kc=this.Gp.OIe(tb,za,td,kc,Xb,Fa.ribbonCommandInfo,function(){Ia.ULS.sendTraceTag(537167814,0,50,'CopyPasteInfrastructure.DragDropInsertCells: success. copyPasteTargetType="{0}"',Fa.copyPasteTargetType);Wc.P7a(Fa,id,Qb,cb,tb)},function(fc){Ia.ULS.sendTraceTag(537167813,0,10,
'CopyPasteInfrastructure.DragDropInsertCells: {0}, copyPasteTargetType="{1}"',fc?Wc.getStringifiedError(fc):"null",Fa.copyPasteTargetType);Wc.k9a(fc,Fa,id,Qb,cb,tb)}),Sa.c(kc.then(function(){Wc.gridView.ha.selectionType=-1;return Promise.resolve(!0)},function(fc){return Promise.reject(fc)})).eo(function(){return!0});kc=this.Gp.OIe(tb,za,td,kc,Xb,Fa.ribbonCommandInfo,null,null);var Wb=this;return Sa.c(kc.then(function(){Ia.ULS.sendTraceTag(521410071,0,50,'CopyPasteInfrastructure.DragDropInsertCells: success. copyPasteTargetType="{0}"',
Fa.copyPasteTargetType);Wc.gridView.ha.selectionType=-1;Wc.P7a(Fa,id,Qb,cb,tb);return Promise.resolve(!0)},function(fc){Ia.ULS.sendTraceTag(521410070,0,10,'CopyPasteInfrastructure.DragDropInsertCells: {0}, copyPasteTargetType="{1}"',fc?Wb.getStringifiedError(fc):"null",Fa.copyPasteTargetType);Wb.k9a(fc,Fa,id,Qb,cb,tb);return Promise.reject(fc)})).eo(function(){return!0})};fa.prototype.Bbi=function(Fa,Qb){var cb=this,Xb=ta(this.mK);if(!Xb)return Ia.ULS.sendTraceTag(537167812,0,50,"InsertCopiedCutCells: CopyContext must not be null or undefined"),
Lb.Task.Ua(!1);if(!ra(Xb.sourceItem))return Ia.ULS.sendTraceTag(537167811,0,50,"InsertCopiedCutCells: CopyContext must be a Range"),Lb.Task.Ua(!1);var kc=Xb.sourceItem;if(!kc)return Ia.ULS.shipAssertTag(537167810,0,!!kc,"InsertCopiedCutCells: rangeSourceItem must not be null or undefined"),Lb.Task.Ua(!1);if(!kc.isFromCurrentSession(this.$))return Ia.ULS.sendTraceTag(537167809,0,50,"InsertCopiedCutCells: rangeSourceItem is from a different session"),Lb.Task.Ua(!1);if(1<kc.ranges.length)return Ia.ULS.sendTraceTag(537167808,
0,50,"InsertCopiedCutCells: multiple source ranges are not supported"),this.Wya(2162,"InsertCopiedCutCells",!0),Lb.Task.Ua(!1);Xb=nb.K(kc.ranges);var Wc=this.gridView.ha.sa.Vc.clone();Fa=nb.K(this.XYc([Wc],Fa));var id=this.Qif();kc=kc.sheetName;Wc=this.$.ea.pa.sheetName;var Vc=nb.v(Xb,this.$);Vc.SheetName=kc;var td=nb.v(Fa,this.$);td.SheetName=Wc;return(Fa.Ue||Xb.Ue?Lb.Task.Ua(0):Fa.isRow||Xb.isRow?Lb.Task.Ua(1):this.Cbi.c4b(this.$,ma.g(this.$).rtl)).eo(function(rd){return cb.Gp.executeInsertCopiedCutCellsOperation(Vc,
td,id,rd.result,Qb)}).continueWith(function(){id?cb.Gp.Wwb():cb.$q("InsertCopiedCutCells/success/"+Hb.a[Qb.method],!0)})};fa.prototype.bod=function(){var Fa=ta(this.mK),Qb=this.gridView.ha.sa.tg;return!!Fa&&ra(Fa.sourceItem)&&Qb&&1===Fa.sourceItem.ranges.length};fa.prototype.Qif=function(){return this.Rif(-911352779)};fa.prototype.Yic=function(){return this.Rif(-1985798686)};fa.prototype.jZc=function(Fa,Qb){var cb=new rb.a(this.$.va),Xb=36===Fa,kc=cb.Vd(4);Fa=2===this.UAb()&&cb.Vd(1);Xb=Xb&&kc;cb=
!cb.ij||!this.Yic()||!rb.a.M6b(Qb,ma.g(this.$));return Xb||Fa||this.$.kq(Qb,!0)&&cb};fa.prototype.igc=function(Fa,Qb){return this.Gp.igc(Fa,Qb)};fa.prototype.dispose=function(){Cb.prototype.dispose.call(this);this.Uj();this.mK.removeMetadataChangeListener(fa.ypf)};fa.prototype.i6c=function(Fa,Qb,cb,Xb,kc,Wc){if(!this.BYg(Fa.commandParameters.ribbonCommandInfo.command))return Fa.cseStatus=2,!1;if(Wc&&Qb.xd(Xb))return Fa.cseStatus=4,!1;if(cb!==kc)return Fa.cseStatus=6,!1;if(Db.EwaSettings.isChangeGateEnabled("OfficeVSO:5593878_PasteCSE_CCPErrorTests")&&
(Xb.width%Qb.width||Xb.height%Qb.height))return Fa.cseStatus=16,!1;if(Db.EwaSettings.getBooleanFeatureGate(Ja.a.FEe,!1)){if(cb=Qb,Xb=Xb.Ae(this.gridView.Ug),Qb=null===Qb.Ae(this.gridView.Ug),kc=Fa.commandParameters.ribbonCommandInfo.command,Qb&&1804571062!==kc&&-185374993!==kc||!Xb)return Fa.cseStatus=7,!1}else if(cb=Qb.Ae(this.gridView.Ug),Xb=Xb.Ae(this.gridView.Ug),!cb||!Xb)return Fa.cseStatus=7,!1;Qb=nb.v(cb,this.$);Qb=this.Gg.oXi(this.gridView,Qb,nb.v(Xb,this.$),Fa.commandParameters.ribbonCommandInfo.command,
Fa.commandParameters.stopwatch);1===Qb&&(Wc&&(this.Gg.Y_c(cb,!1),this.Gg.Y_c(cb,!0)),-185374993===Fa.commandParameters.ribbonCommandInfo.command&&ma.g(this.$).O3i(),this.pasteIndicationManager.Oid(Fa.commandParameters.id),this.Ouc(Fa.commandParameters.expandDestinations,Fa.commandParameters.isPasteCommandFromRecoveryUI),this.jye("DoPasteClientEstimation/"+Hb.a[Fa.commandParameters.ribbonCommandInfo.method],Fa));Fa.cseStatus=Qb;return 1===Qb};fa.prototype.IGf=function(){this.copyPasteShortcutDialogFactory.create(this.$).showDialog(!0,
!1,!1,this.awi)};fa.prototype.Jlf=function(Fa,Qb,cb,Xb){Fa=ya(Fa,Qb,cb,Xb,this.$.ya.UserSessionId);Fa.k=!0;db.b().De(45,Fa,!0)};fa.prototype.AAf=function(Fa,Qb,cb,Xb,kc){var Wc=!1,id=!1,Vc=fa.Mrb,td=fa.KIe+fa.DIa;Fa&&(td+=fa.RJa(Fa),Pb.a.Xq(Fa.ewaErrors)?(Vc=this.Kac(Fa.ewaErrors),Pb.a.Zg(Fa.ewaErrors,[-103190598])&&(Wc=!0)):Fa.message&&(Vc=Fa.message));id||(id=this.ond(Fa));Qb=ya(Qb,cb,Xb,kc,this.$.ya.UserSessionId);Qb.k=!1;Qb.l=id;Qb.n=Vc;Qb.p=td;Qb.q=Wc;db.b().De(45,Qb,!0);return Promise.reject(Fa)};
fa.prototype.BYg=function(Fa){switch(Fa){case 237279923:case 808159687:return Ja.a.lki;case -185374993:return!0;case 1804571062:return!0;default:return!1}};fa.prototype.Rif=function(Fa){var Qb=ta(this.mK);if(!Qb)return!1;var cb=Qb.sourceItem;return cb&&!cb.isFromCurrentSession(this.$)?(Ia.ULS.sendTraceTag(537167779,0,50,"CopyPasteInfrastructure.LastOperationWasCopyCut: Last copy operation was from a different session."),!1):Qb.commandParameters.ribbonCommandInfo.command===Fa};fa.prototype.ihh=function(){var Fa=
ta(this.mK);return Fa?(Fa=Fa.sourceItem)&&!Fa.isFromCurrentSession(this.$)?(Ia.ULS.sendTraceTag(537167778,0,50,"CopyPasteInfrastructure.DoesClipboardHaveCopiedOrCutContent: Last copy/cut operation was from a different session."),!1):!0:!1};fa.prototype.Svj=function(Fa){return Fa&&Fa.lastCopy?wa(Fa.lastCopy,this.$):!0};fa.prototype.RXe=function(Fa,Qb,cb,Xb,kc){var Wc={};Wc.a=this.$.ya.UserSessionId;Wc.e=Fa.stopwatch.id;Wc.c=db.b().fi(Fa.ribbonCommandInfo.command);Wc.b=Hb.a[Fa.ribbonCommandInfo.method];
Wc.d=Fa.id;Wc.f=cb.toString();Wc.g=Xb.toString();Wc.h=Qb.toString();Wc.o=Fa.stopwatch.qc;Wc.q=!1;Wc.r=Fa.copyPasteTargetType.toString();Wc.s=kc.encounteredDeploymentErrors;Db.EwaSettings.getBooleanFeatureGate(Ja.a.Y6b,!1)&&(Wc.i=kc.commandParameters.dragDropIsShiftKeyDown,Wc.j=kc.commandParameters.isDragInsert);return Wc};fa.prototype.P7a=function(Fa,Qb,cb,Xb,kc){Fa=this.RXe(Fa,Qb,cb,Xb,kc);Fa.k=!0;db.b().De(45,Fa,!0)};fa.prototype.lui=function(Fa,Qb,cb,Xb,kc,Wc,id,Vc,td){Fa=this.RXe(Fa,Qb,cb,Xb,
td);Fa.k=!1;Fa.l=kc;Fa.n=Wc;Fa.p=id;Fa.q=Vc;db.b().De(45,Fa,!0)};fa.prototype.$kf=function(Fa,Qb,cb,Xb,kc,Wc,id,Vc,td){var rd={};rd.a=this.$.ya.UserSessionId;rd.b=Qb;rd.c=Fa;rd.f=cb;rd.e=Xb;rd.d=kc;rd.g=Wc;rd.h=id;rd.i=Vc;rd.j=td.toString();db.b().De(46,rd,!0)};fa.prototype.dui=function(Fa,Qb){Fa=this.pXe(Fa.commandParameters,Fa);Fa.l=!0;Fa.j=Qb;db.b().De(43,Fa,!0)};fa.prototype.cui=function(Fa,Qb,cb,Xb,kc,Wc,id){Fa=this.pXe(Fa,id);Fa.l=!1;Fa.m=Qb;Fa.o=cb;Fa.y=Xb;Fa.x=kc;Fa.z=Wc;db.b().De(43,Fa,!0);
Ia.ULS.sendTraceTag(537167776,0,15,"CopyPasteInfrastructure.LogCopyFailedTelemetry: ErrorName={0},ErrorReason={1},IsExpectedError={2},IsSucceededWithAlert={3},ErrorMessage={4}",Fa.y,Fa.x,Fa.m,Fa.z,Fa.o)};fa.prototype.pXe=function(Fa,Qb){var cb={};cb.a=this.$.ya.UserSessionId;cb.f=Fa.stopwatch.id;cb.g=Fa.id;cb.c=db.b().fi(Fa.ribbonCommandInfo.command);cb.b=Hb.a[Fa.ribbonCommandInfo.method];cb.q=Fa.stopwatch.qc;cb.bd=fa.R$b();cb.bg=Fa.copyPasteHandlerName;cb.bj=void 0===Fa.ribbonCommandInfo.Me||null===
Fa.ribbonCommandInfo.Me?null:gb.a[Fa.ribbonCommandInfo.Me];cb.bq=Fa.uploadToClipService;cb.br=Fa.floatingObjectType;cb.s=Fa.copyPasteTargetType.toString();cb.bc=ia(Fa.copyPasteTargetType);cb.z=!1;if(Qb){cb.bk=Qb.id;cb.bl=Qb.serverRequestTimeInMs;Qb.requestTelemetryData&&(cb.bm=Qb.requestTelemetryData.EcsOperationDuration,cb.bn=Qb.requestTelemetryData.EcsRequestDuration,cb.bo=Qb.requestTelemetryData.WfeRequestDuration);cb.d=Qb.sourceItem?Qb.sourceItem.toString():null;cb.e=-1;if(ra(Qb.sourceItem)){cb.e=
0;Fa=ak(Qb.sourceItem.ranges);for(var Xb=Fa.next();!Xb.done;Xb=Fa.next())cb.e+=Xb.value.aM}cb.h=Qb.isAsyncCopy;cb.i=Qb.isFromCache;cb.k=Qb.isSelectionAllowed;cb.r=Qb.plainTextPayloadSize;cb.u=Qb.htmlPayloadSize;cb.v=Qb.htmlSizeExceedsLimit;cb.w=Qb.copyTotalSizeExceedsLimit;cb.t=Qb.shadowWorkbookPayloadSize;cb.p=Qb.clientSideCopyTime;cb.ba=Qb.encounteredDeploymentErrors;cb.bb=Qb.shadowWorkbookSizeExceedsLimit;cb.be=Qb.syncClipboardItemsKeys;cb.bf=Qb.asyncClipboardItemsKeys;cb.bh=this.yBe(Qb.succeededPopulatingSystemClipboardSync);
cb.bi=this.yBe(Qb.succeededPopulatingSystemClipboardAsync)}return cb};fa.prototype.Ouc=function(Fa,Qb){Qb=void 0===Qb?!1:Qb;if(!this.gridView.isEditing&&!this.gridView.xi){var cb=this.gridView.ha.sa,Xb=!Qb&&1===Fa.length&&nb.Q(Fa,cb.selectedRanges),kc=Xb?cb.activeCell:Fa[0].topLeft;Fa[0].contains(kc)||(Ia.ULS.shipAssertTag(537167775,0,!1,"CopyPasteInfrastructure.SelectPastedRange: SelectedRanges {0}, IndexOfActiveRange {1}, ActiveCell {2}, calculatedDestinationRanges {3}, keepThePreviousActiveCell {4}, newActiveCell {5}, isPasteCommandFromRecoveryUI {6}",
cb.selectedRanges,cb.Xs,cb.activeCell,Fa,Xb,kc,Qb),kc=Fa[0].topLeft);this.gridView.ha.BB(Fa,0,kc,0,void 0,lb.a.w3g)}};fa.prototype.a0e=function(Fa,Qb){var cb={};cb.a=this.$.ya.UserSessionId;cb.g=Fa.stopwatch.id;cb.t=Fa.stopwatch.qc;cb.bz=!1;Qb&&(cb.bv=Qb.id,cb.bw=Qb.serverRequestTimeInMs,cb.n=Qb.commandParameters.clipboardFormatReadTimes,cb.o=Qb.commandParameters.clipboardFormatReadStatus,cb.p=Qb.commandParameters.clipboardReadPermissionPromptShown,cb.q=Qb.commandParameters.asyncApiReadTimedOut,Qb.requestTelemetryData&&
(cb.cb=Qb.requestTelemetryData.EcsOperationDuration,cb.cc=Qb.requestTelemetryData.EcsRequestDuration,cb.cd=Qb.requestTelemetryData.WfeRequestDuration));cb.x=Fa.copyPasteTargetType.toString();cb.bl=ia(Fa.copyPasteTargetType);cb.br=Fa.copyPasteHandlerName;cb.i=nb.i(Fa.expandDestinations,",",this.$,!1);cb.h=nb.i(Fa.originalDestinations,",",this.$,!1);cb.e=Fa.id;cb.d=Fa.commandType;cb.c=db.b().fi(Fa.ribbonCommandInfo.command);cb.b=Hb.a[Fa.ribbonCommandInfo.method];cb.bf=!1;cb.bg=!1;cb.bp=fa.R$b();cb.bt=
void 0===Fa.ribbonCommandInfo.Me||null===Fa.ribbonCommandInfo.Me?null:gb.a[Fa.ribbonCommandInfo.Me];cb.cj=Fa.isPasteCommandFromEnterShortcut;if(cb.ca=Fa.isPasteCommandFromRecoveryUI)cb.cf=Fa.pasteRecoveryUndoStopwatch.id,cb.cg=Fa.pasteRecoveryUndoStopwatch.qc;if(Qb){if((Fa=Qb.copyContextSnapshot)&&!Qb.wasLastCopyExternal){cb.f=Fa.commandParameters.id;cb.j=Fa.sourceItem.toString();cb.k=-1;if(ra(Fa.sourceItem)){cb.k=0;for(var Xb=ak(Fa.sourceItem.ranges),kc=Xb.next();!kc.done;kc=Xb.next())cb.k+=kc.value.aM}cb.bg=
1===Fa.commandParameters.commandType}else Qb.clipboardItems?cb.f=Qb.clipboardItems.getItem(la.Gqb):Ia.ULS.sendTraceTag(537167774,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext.ClipboardItems is null");cb.bz=Qb.pasteRecoveryUIDisplayed;cb.ci=Qb.cseStatus}else Ia.ULS.sendTraceTag(537167773,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext is null");return cb};fa.prototype.rvi=function(Fa,Qb,cb,Xb,kc,Wc,id,Vc,td){Fa=this.a0e(Fa,Vc);Fa.l=!1;Fa.m=Qb;Fa.s=cb;Fa.bc=Xb;Fa.be=kc;
Fa.bd=Wc;Fa.bf=id;Vc?(Fa.y=Ka(Vc)||!Vc.copyContextSnapshot,Fa.bi=!Fa.y&&wa(Vc.copyContextSnapshot,this.$),Fa.bj=Vc.shadowWorkbookSizeExceedsLimit,Fa.v=Vc.shadowWorkbookPayloadSize,Fa.w=Vc.htmlPayloadSize,Fa.bq=ha(Vc.clipboardItems),Fa.bb=Vc.activeSelectionType,Fa.bs=Vc.isSameSession,Fa.bn=Vc.payloadOrigin,Fa.bo=Vc.payloadType,Fa.bu=Vc.externalAppSource,Fa.bx=Vc.indicationDisplayScheduled,Fa.by=Vc.pasteIndicationDisplayStatus,Fa.ck=Vc.pasteDestinationHasMergedCells):Fa.bi=wa(td,this.$);db.b().De(44,
Fa,!0);Ia.ULS.sendTraceTag(537167772,0,15,"CopyPasteInfrastructure.LogPasteFailedTelemetry: ErrorName={0},ErrorReason={1},IsExpectedError={2},IsSucceededWithAlert={3},ErrorMessage={4}",Fa.be,Fa.bd,Fa.m,Fa.bf,Fa.s)};fa.prototype.svi=function(Fa){var Qb=this.a0e(Fa.commandParameters,Fa);Qb.y=Fa.wasLastCopyExternal;Qb.l=!0;Qb.u=Fa.plainTextPayloadSize;Qb.v=Fa.shadowWorkbookPayloadSize;Qb.w=Fa.htmlPayloadSize;Qb.z=Fa.isClipboardDataContainShadowWorkbook;Qb.ba=Fa.isShadowWorkbookParsedSuccessfully;Qb.bb=
Fa.activeSelectionType;Qb.bc=Fa.pasteResult;Qb.bh=Fa.encounteredDeploymentErrors;Qb.bj=Fa.shadowWorkbookSizeExceedsLimit;Qb.bk=ab(Fa);Qb.bq=ha(Fa.clipboardItems);Qb.bs=Fa.isSameSession;Qb.bn=Fa.payloadOrigin;Qb.bo=Fa.payloadType;Qb.bu=Fa.externalAppSource;Qb.bx=Fa.indicationDisplayScheduled;Qb.by=Fa.pasteIndicationDisplayStatus;Qb.ck=Fa.pasteDestinationHasMergedCells;Qb.bm=Fa.clipboardItems?Fa.clipboardItems.getItem(la.nXg):null;Qb.bi=!Fa.isSameSession&&!Fa.wasLastCopyExternal;db.b().De(44,Qb,!0)};
fa.prototype.Ti=function(){this.$.va.Kf(this.wh);this.$.va.Kme(this.jnc);this.$.userOperationManager.Cr(this.rR);this.$.Tk(this.Yc);ma.g(this.$).Wb.Bk(this.NEb)};fa.prototype.Uj=function(){this.$&&this.$.va&&(this.$.va.wg(this.wh),this.$.va.KPf(this.jnc));this.$&&this.$.userOperationManager&&this.$.userOperationManager.wo(this.rR);this.gridView&&this.gridView.Wb&&this.gridView.Wb.wk(this.NEb)};fa.prototype.zEb=function(Fa,Qb){var cb=null,Xb=!1,kc=null,Wc="UnknownFailure",id=-1,Vc=fa.Mrb,td=fa.pasteErrorName+
fa.DIa,rd=!1;this.pasteIndicationManager.Oid(Fa.id);this.Ydf&&this.pasteDestinationHasMergedCells(Fa.expandDestinations)&&(Qb.pasteContext.pasteDestinationHasMergedCells=!0);var za=ta(this.mK);(Fa.clearStateOnFinish||Fa.clearSystemClipboard)&&this.$q("Paste/fail/"+Hb.a[Fa.ribbonCommandInfo.method],!0,void 0,void 0,Fa.copyPasteTargetType).catch(function(){});if(Qb){id=Qb.reason;td+=fa.RJa(Qb);Qb.message&&(Vc=Qb.message);if(cb=fa.L2g(Qb))if(1===cb.pasteErrorName)Xb=!0,Wc="CopyPasteLengthTooLongPopup",
Vc=kc="The pasted content is too long. Popup a dialog to the user.",Ia.ULS.sendTraceTag(25216992,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',kc,Fa.copyPasteTargetType),cb=Pb.a.Wc(1,0,26,693,0,1306609195,"CopyPasteOversizeError"),Db.EwaSettings.qz()?new sb.a(this.$,cb):(cb=new ob.ErrorDialog(this.$,cb),cb.initialize(),cb.hf());else if(7===cb.pasteErrorName)Xb=!0,Wc="No-Op",Vc=kc="The shadow workbook is not ready yet and an async copy failed to populate the clipboard. Do nothing (by the spec)",
Ia.ULS.sendTraceTag(33948251,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',kc,Fa.copyPasteTargetType);else if(8===cb.pasteErrorName)Xb=!0,Wc="UseShortcutsPopup",Vc=kc="Unable to paste content from the system clipboard. Popup dialog to the user.",Ia.ULS.sendTraceTag(25216994,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',kc,Fa.copyPasteTargetType),this.IGf();else if(18===cb.pasteErrorName){Xb=!0;Wc="PasteExternalNotSupportMultipleSelectionPopup";
Vc="Paste external not support multiple selection.";kc="Unknown";var tb=2162;100!==cb.validationFailureReason&&(kc=Ta[cb.validationFailureReason],tb=fa.rBe(cb.validationFailureReason));this.Wya(tb,kc,!0)}else 20===cb.pasteErrorName||19===cb.pasteErrorName?(Xb=!0,20===cb.pasteErrorName?(Wc="PasteAcrossSessionNotSupportMultipleSelectionPopup",Vc="Paste across session does not support multiple selection."):(Wc="PasteInSameSessionNotSupportMultipleSelectionPopup",Vc="This kind of multiple selection is not supported for same session paste."),
kc="Unknown",tb=2162,100!==cb.validationFailureReason&&(kc=Ta[cb.validationFailureReason],tb=fa.rBe(cb.validationFailureReason)),cb=6===cb.validationFailureReason,this.jZc(Fa.commandType,Fa.expandDestinations)&&cb&&this.Ouc(Fa.expandDestinations),this.Wya(tb,kc,!0)):6===cb.pasteErrorName?(Xb=!0,Wc="No-Op",Vc=kc="Paste Formatting/Transpose is not yet a supported operation on System Clipboard based content",Ia.ULS.sendTraceTag(36263241,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',
kc,Fa.copyPasteTargetType)):17===cb.pasteErrorName?(Xb=!0,Wc="No-Op",Vc=kc="Paste text on Art is not yet a supported operation",Ia.ULS.sendTraceTag(0,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',kc,Fa.copyPasteTargetType)):16===cb.pasteErrorName?(Xb=!0,Wc="No-Op",Vc=kc="Paste has failed because the previous copy has failed",Ia.ULS.sendTraceTag(537167771,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}", error={2}',kc,Fa.copyPasteTargetType,
this.getStringifiedError(cb))):Pb.a.Xq(cb.ewaErrors)?(Pb.a.S9(cb.ewaErrors)||Pb.a.Zg(cb.ewaErrors,Pb.a.tcc())?(Xb=!0,Wc="CommunicationError",kc=Pb.a.Dc(cb.ewaErrors),Ia.ULS.sendTraceTag(36304159,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',Vc,Fa.copyPasteTargetType)):Pb.a.Zg(cb.ewaErrors,fa.Vjj)?(Xb=!0,Wc="SavingWorkbookError",kc=Pb.a.Dc(cb.ewaErrors),Ia.ULS.sendTraceTag(36304160,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',Vc,Fa.copyPasteTargetType)):
Pb.a.Zg(cb.ewaErrors,fa.operationSucceededWithAlert)&&(rd=Xb=!0,Wc="OperationSucceededWithAlert",kc=Pb.a.Dc(cb.ewaErrors),Ia.ULS.sendTraceTag(36304161,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',Vc,Fa.copyPasteTargetType)),Xb||(Vc=this.Kac(cb.ewaErrors),Xb=this.ond(Qb))):11===cb.pasteErrorName&&(Xb=!0,Wc="No-Op",Vc="Paste has failed because user try copy cross-session oart object");15===Qb.reason&&(Xb=!0,Wc="No-Op",Vc="Rejecting deferred paste there is metadata update without copy context. Usually it means that copy canceled before finished.");
kb.a.equals(td,Ea.BUj,!1)&&(Xb=!0,Wc="No-Op",Vc="User hash of the copy is different then the user hash of the paste during cross-session copy-paste. Do nothing.")}Xb||Ia.ULS.sendTraceTag(24150916,0,10,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',Qb?this.getStringifiedError(Qb):"null",Fa.copyPasteTargetType);this.rvi(Fa,Xb,Vc,Wc,td,id,rd,Qb.pasteContext,za);return Promise.reject(Qb)};fa.prototype.Jnc=function(Fa,Qb){var cb;Ia.ULS.sendTraceTag(24150917,0,50,'CopyPasteInfrastructure.OnPasteSuccess: paste succeed. copyPasteTargetType="{0}"',
Qb.copyPasteTargetType);this.pasteIndicationManager.Oid(Qb.id);if(this.tXi(Qb.copyPasteTargetType,Fa)){Db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Ma.a.LC&&Fa.wasLastCopyExternal&&Fa.payloadType===da.iO&&(this.M6a=!0);var Xb=null;(null===(cb=Fa.pastedRange)||void 0===cb?0:cb.Ranges)&&0<Fa.pastedRange.Ranges.length?Xb=nb.g(Fa.pastedRange.Ranges):Fa.wasLastCopyExternal||(Xb=Qb.expandDestinations);this.Elj(Fa,Xb);if(this.Lxj(Fa,Xb)){cb=Ub.a.clone(Qb.originalDestinations);
Xb=1028===Qb.commandType?Ub.a.clone(Qb.expandDestinations):Ub.a.clone(Xb);var kc=null;Fa.wasLastCopyExternal&&(Qb.isKeyboardEvent||Qb.isPasteCommandFromRecoveryUI)&&(kc={},kc=(kc[fa.xFf]=Fa.clipboardItems,kc));this.Ydf&&this.pasteDestinationHasMergedCells(Qb.expandDestinations)&&(Fa.pasteDestinationHasMergedCells=!0);Fa.pasteRecoveryUIDisplayed=!0;var Wc=new xa(this.$,cb,Xb,kc),id=pa.GetServiceTaskFactory.Ra(this.$.da,406,405,0);Ab.TaskExtensions.Ba(id,function(){var Vc=id.result;Vc.XNg(Wc);Vc.VAj(Qb.ribbonCommandInfo.method)},
this.la,8)}}this.jye("Paste/success/"+Hb.a[Qb.ribbonCommandInfo.method],Fa);this.svi(Fa);this.S1f&&(!Qb.isKeyboardEvent||ab(Fa))&&this.$.ea.Kg.get(66)&&(Ia.ULS.sendTraceTag(537167770,0,15,"CopyPasteInfrastructure.OnPasteSuccess: show localStorage disable notification"),this.S1f=!1,this.n4g());return Promise.resolve(!0)};fa.prototype.Lxj=function(Fa,Qb){return!Qb||1!==Qb.length||Fa.commandParameters.clearSystemClipboard||Fa.commandParameters.clearStateOnFinish||Fa.commandParameters.skipClipboardAccess?
!1:Ka(Fa)&&(Qb=Fa.clipboardItems.getItem(la.hW),Fa=Fa.clipboardItems.getItem(la.html),void 0===Qb||null===Qb||Qb.length>this.fvd||void 0===Fa||null===Fa||Fa.length>this.Nxa)?(Ia.ULS.sendTraceTag(537167769,0,50,"CopyPasteInfrastructure.ShouldShowPasteRecoveryUI: Not showing PasteRecoveryUI for external copy."),!1):!0};fa.prototype.tXi=function(Fa,Qb){return 1===Fa||Qb.payloadType===da.hW||Db.EwaSettings.ma(162)&&Qb.payloadType===da.html||Db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",
!1)&&!Ma.a.LC&&Qb.payloadType===da.iO};fa.prototype.pasteDestinationHasMergedCells=function(Fa){var Qb=ma.g(this.$).Ea.QE();if(!Qb||!Qb.length)return!1;Qb=ak(Qb);for(var cb=Qb.next();!cb.done;cb=Qb.next())if(cb.value.hw(Fa[0]))return!0;return!1};fa.prototype.jye=function(Fa,Qb){var cb=this,Xb;(function(){var kc=cb.zfi(Qb);Xb=kc.MGa;return kc})().returnValue&&this.$q(Fa,Xb,void 0,void 0,Qb.commandParameters.copyPasteTargetType).catch(function(){})};fa.prototype.k9a=function(Fa,Qb,cb,Xb,kc,Wc){Ia.ULS.sendTraceTag(24150918,
0,10,"CopyPasteInfrastructure.OnDragAndDropCellsFailed: {0}",Fa?this.getStringifiedError(Fa):"null");var id=!1,Vc=!1,td=!1,rd=fa.Mrb,za=fa.KIe+fa.DIa;Fa&&(za+=fa.RJa(Fa),Pb.a.Xq(Fa.ewaErrors)?(rd=this.Kac(Fa.ewaErrors),Pb.a.Zg(Fa.ewaErrors,fa.operationSucceededWithAlert)&&(id=!0),Pb.a.Zg(Fa.ewaErrors,fa.dragDropNonEmptyRange)&&(Vc=td=!0)):Fa.message&&(rd=Fa.message));td||(td=this.ond(Fa));Vc?this.gridView.ha.selectionType=-1:this.Gp.Q6i(kc);this.lui(Qb,cb,Xb,kc,td,rd,za,id,Wc)};fa.prototype.XYc=function(Fa,
Qb){var cb=Fa,Xb=this.OQh();if(null===Xb||void 0===Xb?0:Xb.ranges)cb=this.Gp.yTg(Qb,Xb.ranges,Fa);return cb};fa.prototype.OQh=function(){var Fa=ta(this.mK);return Fa&&ra(Fa.sourceItem)?Fa.sourceItem:null};fa.prototype.c4i=function(){this.raiseEvent(fa.aBd,null)};fa.prototype.Elj=function(Fa,Qb){var cb=Fa.commandParameters.originalDestinations;Qb&&(nb.Q(this.gridView.ha.sa.selectedRanges,cb)?(this.Ouc(Qb),Ia.ULS.sendTraceTag(537167767,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range, range: {0}",
Ya.HelperMethods.Unb(Qb))):Fa.commandParameters.isPasteCommandFromRecoveryUI?(this.Ouc(Qb,!0),Ia.ULS.sendTraceTag(537167766,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range for IsPasteCommandFromRecoveryUI, range: {0}, active cell: {1}",Qb,Qb[0].topLeft)):Ia.ULS.sendTraceTag(537167765,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: user change his selection during paste operation. don't change selection. originalPasteDestinations: {0}",Ya.HelperMethods.Unb(cb)))};
fa.prototype.zfi=function(Fa){if(Fa.isPlainTextPaste||Fa.isHtmlPaste||Na(Fa)||Fa.commandParameters.isPasteCommandFromEnterShortcut)return{returnValue:!0,MGa:!1};var Qb=Fa.copyContextSnapshot;if(Fa.commandParameters.clearStateOnFinish)return{returnValue:!0,MGa:!0};if(Qb&&ra(Qb.sourceItem)){var cb=Qb.sourceItem;if(!cb.isFromCurrentSession(this.$))return{returnValue:!1,MGa:!0};Qb=-1985798686===Qb.commandParameters.ribbonCommandInfo.command;if(!(1<cb.ranges.length||1<Fa.commandParameters.expandDestinations.length)){var Xb=
nb.K(cb.ranges);Fa=nb.K(Fa.commandParameters.expandDestinations);var kc=this.$.ea.pa.sheetName;cb=cb.sheetName;if(cb===kc&&Fa.equals(Xb))return{returnValue:!1,MGa:!0};if(cb===kc&&Fa.Ae(Xb))return{returnValue:!0,MGa:!1}}return{returnValue:Qb,MGa:!0}}return{returnValue:!1,MGa:!0}};fa.prototype.BCf=function(){var Fa=ta(this.mK);(Fa=this.Gp.Kvb(Fa))&&Fa.isFromCurrentSession(this.$)&&this.$q("OnStartEdit",!1).catch(function(){})};fa.prototype.Kac=function(Fa){Fa=Pb.a.ANh(Fa,fa.DIa);return this.cAi+fb.a.Nv(Fa).toString()};
fa.prototype.ond=function(Fa){Fa=fa.RJa(Fa);return!!Fa&&kb.a.H1a(Fa,fa.bAi)};fa.prototype.n4g=function(){var Fa=Pb.a.Wc(1,2,332,333,Ma.a.Xo?334:Ma.a.BH?335:336,530046625,"ActivateLocalStorage"),Qb=pa.GetServiceTaskFactory.Ra(this.$.da,5,4,0);Ab.TaskExtensions.Ba(Qb,function(){Qb.result.Jf(42,Fa)},this.la,3)};fa.prototype.yBe=function(Fa){return void 0===Fa||null===Fa?Qa.CDi:Fa?Qa.success:Qa.failed};fa.L2g=function(Fa){var Qb=Fa.innerError;return Qb&&0!==Qb.pasteErrorName?Fa.innerError:null};fa.y2g=
function(Fa){var Qb=Fa.innerError;return Qb&&0!==Qb.copyErrorName?Fa.innerError:null};fa.RJa=function(Fa){var Qb="";if(!Fa)return fa.PFe;Fa.errorName&&(Qb=Fa.errorName,Fa.innerError&&(Qb+=fa.DIa+fa.RJa(Fa.innerError)));Qb||(Qb=Fa&&Fa.name?Fa.name:fa.PFe);return Qb};fa.R$b=function(){fa.QLb||(Da.a.oef()?fa.QLb=S.hCj:Da.a.zod()?fa.QLb=S.gCj:fa.QLb=S.fCj);return fa.QLb};fa.rBe=function(Fa){switch(Fa){case 7:case 1:return 2169;case 5:return 2166;case 6:return 2165;case 8:case 3:case 2:case 4:case 9:case 10:return 2162;
default:return Ia.ULS.shipAssertTag(537167764,0,!1,"CopyPasteInfrastructure.ConvertPasteValidationOptionToJsStringId: no case for validationOptions = {0}",Fa),2169}};fa.z2g=function(Fa){switch(Fa){case 3:return 2163;case 1:return 2164;case 2:case 4:return 2162;default:return Ia.ULS.shipAssertTag(537167763,0,!1,"CopyPasteInfrastructure.ConvertCopySourceValidationOptionToJsStringId: no case for validationOptions = {0}",Fa),2169}};Af.Object.defineProperties(fa.prototype,{pasteIndicationManager:{configurable:!0,
enumerable:!0,get:function(){return this.$.da.za(373)}}});fa.ypf="EwaJsMetadataChangeListenerId";fa.aBd="cpiOSC";fa.Ech="cpiDID";fa.Mrb="Unknown";fa.PFe="UnknownError";fa.DIa="_";fa.KIe="DragAndDropError";fa.pasteErrorName="PasteError";fa.AUg="CancelError";fa.copyErrorName="CopyError";fa.bAi="MergedCellOverlap";fa.xFf="PasteRecoveryCachedClipboardItems";fa.Vjj=[1352631530,1679665408];fa.operationSucceededWithAlert=[-103190598];fa.pasteDataLimitHit=[1306609195];fa.copyThrottlingError=[-386183710];
fa.dragDropNonEmptyRange=[563945982];fa.QLb=null;Object(W.a)(fa,"CopyPasteInfrastructure",Va.a,[707,708,10]);Object(W.a)(qa,"ClipboardPlatformInitializationResult",null,[]);var ec=b(83),wb=b(202),rc=b(737),Mc=b(616),Pc=b(128),Kc=b(5),ub=b(61);Object(W.a)(X,"MacroRecorderPasteRangePayload",null,[409]);ca.prototype.getContent=function(){return this.content};Object(W.a)(ca,"MacroRecorderPasteStringPayload",null,[409]);var Fb=b(64);Object(W.a)(Q,"MacroRecorderPastePayload",null,[409]);var pc=b(646),eb=
b(974),ic=b(564),Ac=b(177),lc=b(216),Gc=b(121),ed=b(295),fd=b(355);H.prototype.getParameters=function(){return this.parameters};Object(W.a)(H,"MacroRecorderRangeCopyCutCellsInsertedPayload",null,[409]);var Bc=b(389);Object(W.a)(N,"PasteHtmlRequestParams",null,[]);O.prototype.copy=function(Fa,Qb,cb,Xb,kc){function Wc(rd,za,tb){var Wb={CopyPasteTargetType:1};Wb.SourceRanges=Fa;Wb.CopyOperationId=Qb.id;Ia.ULS.sendTraceTag(537167756,0,50,"CopyPasteInfrastructure.Copy served from CopyPasteProxy : {0}, CopyOperationId : {1}",
id.Awa,Wb.CopyOperationId);id.RMa=id.Awa?ea(id.$.oa.Sv,Wb,ed.b(rd,cb),Xb?ed.a(za,Xb):za,tb,Qb.ribbonCommandInfo,Vc,kc):ea(id.$.oa.xa,Wb,ed.b(rd,cb),Xb?ed.a(za,Xb):za,tb,Qb.ribbonCommandInfo,Vc,kc);return id.RMa}var id=this;Xb=void 0===Xb?null:Xb;kc=void 0===kc?null:kc;var Vc=this.$.oa.xa.Pb();this.Kld&&this.bY();this.Lic=Vc.ClientRequestId;var td=Db.EwaSettings.Zb()?new Ac.a(505,0,Wc,80):new ic.a(505,0,Wc,16);td=this.$.userOperationManager.Sb(td,Qb.ribbonCommandInfo);this.Kld&&this.$u.add(td)};O.prototype.wFf=
function(Fa,Qb,cb,Xb,kc,Wc){var id=this;return new Promise(function(Vc,td){var rd,za=Wc.commandParameters.stopwatch.qc,tb=2;20===Wc.commandParameters.commandType&&(tb=16);36===Wc.commandParameters.commandType&&(tb=32);Da.a.zod()&&68===Wc.commandParameters.commandType&&(tb=64);Da.a.Sqd(id.$)&&1028===Wc.commandParameters.commandType&&(tb=1024);var Wb=null;if(null===(rd=Wc.copyContextSnapshot)||void 0===rd?0:rd.commandParameters)Wb=Wc.copyContextSnapshot.commandParameters.id;O.VMd(id.$,Fa,Xb,Qb,cb,null,
function(fc){O.Scc(fc,Wc,Vc,td,za,id.$,null,null,null)},function(fc){Wc.serverRequestTimeInMs=Wc.commandParameters.stopwatch.qc-za;fc=Gc.a.Of(fc.data);td(new eb.a(5,fc))},kc,tb,Wb,Wc.commandParameters.id)})};O.prototype.pasteRange=function(Fa,Qb,cb,Xb,kc,Wc,id,Vc,td,rd){var za=this;return new Promise(function(tb,Wb){var fc=id.commandParameters.stopwatch.qc;O.Pmj(za.$,Fa,Qb,cb,Xb|-5&kc,function(xc){O.Scc(xc,id,tb,Wb,fc,za.$,null,td,rd)},function(xc){id.serverRequestTimeInMs=id.commandParameters.stopwatch.qc-
fc;xc=Gc.a.Of(xc.data);xc=new eb.a(5,xc);null===rd||void 0===rd?void 0:rd(xc);Wb(xc)},Wc,Vc)})};O.prototype.q1i=function(Fa,Qb,cb,Xb,kc,Wc,id){var Vc=this;return(new Promise(function(td,rd){if(Qb)if(Qb.length>Vc.Nxa){var za=id.clipboardItems.getItem(la.hW),tb=-1;void 0!==za&&null!==za&&(tb=za.length);Ja.a.pcf&&Qb.length<Vc.sCd&&Qb.length>Vc.WOa&&(Vc.BGf(Qb),Vc.wK=new N(Fa,Qb,cb,Xb,kc,Wc,id,0,Vc.qpc.length),window.requestIdleCallback&&window.requestIdleCallback(function(){return Vc.ICd()}));Ia.ULS.sendTraceTag(42071712,
0,15,"CopyPasteInfrastructure.ProcessPasteHtml copy paste length too long. clipboardHtml.Length: {0}, MaxHtmlImportLength: {1}, PlainTextLength: {2}",Qb.length,Vc.Nxa,tb);rd(new eb.a(1))}else za=function(Wb,fc,xc){Vc.$.ry();var Yb=id.commandParameters.stopwatch.qc;Wb=ed.b(Wb,function(Md){O.Scc(Md,id,td,rd,Yb,Vc.$,Qb,null,null)});fc=ed.a(fc,function(Md){id.serverRequestTimeInMs=id.commandParameters.stopwatch.qc-Yb;Md=Gc.a.Of(Md.data);rd(new eb.a(3,Md))});var Ec=Vc.$.oa.xa.Pb(),bd=nb.v(Fa,Vc.$),Ic=
{};Ic.SourceHtml=Qb;Ic.DestinationRanges=bd?nb.s(bd):null;Ic.CopyOperationId=cb;Ic.PasteId=Xb;Ia.ULS.sendTraceTag(537167755,0,50,"CopyPasteInfrastructure.ProcessPasteHtml served from CopyPasteProxy : {0}. PasteId : {1}",Vc.Awa,Ic.PasteId);return Vc.Awa?Y(Vc.$.oa.Sv,Ic,Wb,fc,xc,null,Ec,Wc):Y(Vc.$.oa.xa,Ic,Wb,fc,xc,null,Ec,Wc)},za=Db.EwaSettings.Zb()?new Ac.a(204,0,za,65):new ic.a(204,0,za,1),Vc.$.userOperationManager.Sb(za,kc);else td("")})).then(function(){Ja.a.pcf&&Qb.length>Vc.WOa&&(Vc.BGf(Qb),
Vc.wK=new N(Fa,Qb,cb,Xb,kc,Wc,id,0,Vc.qpc.length),window.requestIdleCallback&&window.requestIdleCallback(function(){return Vc.ICd()}))})};O.prototype.BGf=function(Fa){var Qb=this.$.Fb.sc("Task","pasteHtmlChunkOperation"),cb=Math.floor(Fa.length/this.WOa)+1;this.qpc=Array(cb);for(var Xb=0;Xb<cb;)this.qpc[Xb]=Fa.substring(Xb*this.WOa,(Xb+1)*this.WOa),Xb++;Ia.ULS.sendTraceTag(523257954,0,50,"CopyPasteUtils.populatePasteChunks Time taken for chunking: "+Qb.qc)};O.prototype.ICd=function(){var Fa=this,
Qb=this.qpc[this.wK.Jpb],cb=this.$.Fb.sc("Task","pasteHtmlServerCall");this.mXi(this.wK.destinationRange,Qb,this.wK.Gqb,this.wK.vFf,this.wK.Ed,this.wK.pOb,this.wK.pasteContext,this.wK.Jpb,this.wK.MVd);this.wK.Jpb++;Ia.ULS.sendTraceTag(523257953,0,15,"CopyPasteUtils.performChunkedPasteHtml server call time: "+cb.qc+",\n       pasteid:"+this.wK.vFf+",\n       chunkIndex:"+this.wK.Jpb+",\n       totalChunks:"+this.wK.MVd);this.wK.Jpb<this.wK.MVd&&window.requestIdleCallback(function(){return Fa.ICd()})};
O.prototype.mXi=function(Fa,Qb,cb,Xb,kc,Wc,id,Vc,td){function rd(Wb,fc,xc){var Yb=id.commandParameters.stopwatch.qc;Wb=ed.b(Wb);fc=ed.a(fc,function(){id.serverRequestTimeInMs=id.commandParameters.stopwatch.qc-Yb});var Ec=za.$.oa.xa.Pb(),bd=nb.v(Fa,za.$);bd={SourceHtml:Qb,DestinationRanges:bd?nb.s(bd):null,CopyOperationId:cb,PasteId:Xb+"_chunk_"+Vc,ChunkIndex:Vc,TotalChunks:td};Ia.ULS.sendTraceTag(523257952,0,50,"CopyPasteInfrastructure.ProcessPasteHtml served from CopyPasteProxy : {0}. PasteId : {1}",
za.Awa,bd.PasteId);return Y(za.$.oa.Sv,bd,Wb,fc,xc,null,Ec,Wc)}var za=this,tb=Db.EwaSettings.Zb()?new Ac.a(204,0,rd,65):new ic.a(204,0,rd,1);this.$.userOperationManager.Sb(tb,kc)};O.prototype.r1i=function(Fa,Qb,cb,Xb,kc){var Wc=this;return new Promise(function(id,Vc){Ia.ULS.sendTraceTag(537167754,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: method start. pasteContext.Id={0}",kc.id);Qb&&(Qb=kb.a.trimEnd(Qb,"\n","\r"));Ia.ULS.sendTraceTag(537167753,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after clipboardText.TrimEnd. pasteContext.Id={0}",
kc.id);if(Qb){var td=Wc.fvd;if(Qb.length>td)Ia.ULS.sendTraceTag(24150921,0,15,"CopyPasteInfrastructure.ProcessPasteText copy paste length too long. clipboardText.Length: {0}, MaxCopyPasteLength: {1}",Qb.length,td),Vc(new eb.a(1));else{var rd=nb.v(Fa,Wc.$);Ia.ULS.sendTraceTag(537167752,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before treatAsLink calculation. pasteContext.Id={0}",kc.id);td=!Wc.$.ea.isNamedObjectViewMode&&!Qb.includes("\n")&&!Qb.includes("\t");Ia.ULS.sendTraceTag(537167751,
0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before isLink check. pasteContext.Id={0}. treatAsLink={1}",kc.id,td);td=td&&kb.a.Mdf(Qb);Ia.ULS.sendTraceTag(537167750,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after treatAsLink calculation. pasteContext.Id={0}. treatAsLink={1}",kc.id,td);var za=Wc.$.oa.xa.Pb();if(td){var tb=526;Ia.ULS.sendTraceTag(537167749,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before FixUpUrl. pasteContext.Id={0}",kc.id);
var Wb=lc.a.jad(Qb);Ia.ULS.sendTraceTag(537167748,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after FixUpUrl. pasteContext.Id={0}",kc.id);var fc=nb.s(rd);td=function(Yb,Ec,bd){var Ic=kc.commandParameters.stopwatch.qc;Yb=ed.b(Yb,function(Md){Ia.ULS.sendTraceTag(537167747,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: on ApplyHyperlink successCallback. pasteContext.Id={0}",kc.id);kc.requestTelemetryData=Md.RequestTelemetryData;kc.serverRequestTimeInMs=kc.commandParameters.stopwatch.qc-
Ic;Md.Errors&&0<Md.Errors.length?Vc(new eb.a(2,Md.Errors)):id(Qb)});Ec=ed.a(Ec,function(Md){kc.serverRequestTimeInMs=kc.commandParameters.stopwatch.qc-Ic;Md=Gc.a.Of(Md.data);Vc(new eb.a(2,Md))});Wc.$.ry();Ia.ULS.sendTraceTag(537167746,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before ApplyHyperlink. pasteContext.Id={0}",kc.id);return ub.b(Wc.$.oa.xa,fc,Qb,Wb,!1,!1,63,Yb,Ec,bd,Fa,za,Xb)};var xc=function(){return new pc.a(fc,Qb,Wb)}}else tb=180,td=function(Yb,Ec,bd){Wc.$.ry();var Ic=
kc.commandParameters.stopwatch.qc;Yb=ed.b(Yb,function(Md){Ia.ULS.sendTraceTag(537167745,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: on PasteString successCallback. pasteContext.Id={0}",kc.id);O.Scc(Md,kc,id,Vc,Ic,Wc.$,Qb,null,null)});Ec=ed.a(Ec,function(Md){kc.serverRequestTimeInMs=kc.commandParameters.stopwatch.qc-Ic;Md=Gc.a.Of(Md.data);Vc(new eb.a(4,Md))});Ia.ULS.sendTraceTag(537167744,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before PasteString. pasteContext.Id={0}",
kc.id);return ka(Wc.$.oa.xa,rd,Qb,Yb,Ec,bd,null,za,Xb)},xc=function(){return new ca(rd,Qb)};Ia.ULS.sendTraceTag(537167715,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before UserNonBlockingWebMethodOperation. pasteContext.Id={0}",kc.id);td=Db.EwaSettings.Zb()?new Ac.a(tb,0,td,65,xc):new ic.a(tb,0,td,1,xc);Ia.ULS.sendTraceTag(537167714,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: returning. pasteContext.Id={0}",kc.id);Wc.$.userOperationManager.Sb(td,cb)}}else id("")})};
O.prototype.t7e=function(Fa,Qb){Qb=[1===Qb?4:5];this.gridView.qb.Lw(fd.a.I7(Fb.d(this.$.pa),Fa),Qb,!0);this.gridView.qb.qn(Qb);this.gridView.qb.update(!0)};O.prototype.Wwb=function(){var Fa=[4,5];this.gridView.qb.eh(Fa,!1,!1);this.gridView.qb.Wi(null,Fa,!1);1===this.gridView.ha.Qe&&this.gridView.qn(!1,!1);this.gridView.qb.update(!1,!1)};O.prototype.yTg=function(Fa,Qb,cb){var Xb=[];cb=ak(cb);for(var kc=cb.next();!kc.done;kc=cb.next())Xb.push(this.BTg(Fa,Qb,kc.value));return Xb};O.prototype.bY=function(){if(this.$u)for(var Fa=
ak(this.$u),Qb=Fa.next();!Qb.done;Qb=Fa.next())Qb=Qb.value,this.$&&this.$.userOperationManager&&(Qb.operation&&Ia.ULS.sendTraceTag(526758675,0,50,"CopyPasteUtils.AbortOutstandingUserOperation: Trying to abort pending operation {0}.",Pc.a(Qb.operation.operationName)),this.yUg(),this.$.userOperationManager.vta(Qb))};O.prototype.yUg=function(){if(this.RMa){var Fa=this.RMa.Ht;Ia.ULS.sendTraceTag(526758674,0,15,"Cancelling pending copy request with Id={0}",Fa);Gc.a.nu(Fa);!Db.EwaSettings.isChangeGateEnabled("OfficeVSO:6151555_DisableCancelCopyRequest")&&
this.Lic&&ub.h(this.$.oa.xa,this.Lic,null,null,null);this.Lic=this.RMa=null}};O.prototype.Bz=function(Fa,Qb){2===Qb.Fq?(this.$u.clear(),this.RMa=null):1===Qb.Fq&&this.$u&&this.$u.contains(Qb.Ff)&&(Ia.ULS.sendTraceTag(526758673,0,50,"CopyPasteUtils.OnQueueChanged: web method {0} returned, it took {1} milliseconds to complete.",Pc.a(Qb.Ff.operation.operationName),Qb.Ff.dequeueUtcTime.getTime()-Qb.Ff.enqueueUtcTime.getTime()),this.$u.remove(Qb.Ff),this.RMa=null)};O.prototype.BTg=function(Fa,Qb,cb){Ia.ULS.shipAssertTag(537167713,
0,!!Qb,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray shouldn't be null");Ia.ULS.shipAssertTag(537167712,0,0<Qb.length,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray length shouldn't be zero");var Xb=0,kc=0,Wc=new Set,id=new Set;Qb=ak(Qb);for(var Vc=Qb.next();!Vc.done;Vc=Qb.next()){Vc=Vc.value;var td=String.format("{0}_{1}",Vc.left,Vc.right),rd=String.format("{0}_{1}",Vc.top,Vc.bottom);id.has(td)||(id.add(td),kc+=Vc.width);Wc.has(rd)||(Wc.add(rd),Xb+=Vc.height)}if(36===Fa)return cb.isSingle?
O.TQe(kc,Xb,cb):cb.clone();516===Fa&&(Fa=Xb,Xb=kc,kc=Fa);Fa=!(cb.width%kc)&&!(cb.height%Xb);Wc=cb.b_&&!(cb.height%Xb);cb.l5&&!(cb.width%kc)||Wc?cb=O.TQe(kc,Xb,cb):Fa?cb=cb.clone():(cb=cb.clone(),cb.bottom=Math.min(yb.a.vh,cb.top+Xb-1),cb.right=Math.min(yb.a.Eh,cb.left+kc-1));return cb};O.prototype.YKg=function(Fa,Qb,cb,Xb,kc,Wc,id,Vc,td,rd,za){if(!Xb||!Xb.length)return 1;if(1<Xb.length){if(!this.Gfc&&Wc)return 3;if(rd)return 0;if(Vc)return 9;if(td)return 8;if(za)return 2;if(1<Qb.length)return 4;var tb=
Qb[0];if(!id&&!Ub.a.all(Xb,function(Wb){return Wb.isSingle||!(Wb.width%tb.width)&&!(Wb.height%tb.height)}))return 5;if((!this.Gfc||!Wc)&&kb.a.equals(Fa,cb,!0))for(kc=ak(kc),Fa=kc.next();!Fa.done;Fa=kc.next())if(Fa=Fa.value,Fa.xd(tb)&&!Fa.equals(tb))return 6}else if(Qb&&0<Qb.length){if(0!==this.ubf(Qb,td))return 7;if(1<Qb.length){if(!this.Gfc&&Wc)return 3;if((!this.Gfc||!Wc)&&kb.a.equals(Fa,cb,!0))for(Fa=ak(Qb),Qb=Fa.next();!Qb.done;Qb=Fa.next())if(Qb=Qb.value,cb=kc[0],Qb.xd(cb)&&!Qb.equals(cb))return 6}}return 0};
O.prototype.ubf=function(Fa,Qb){if(!Fa||1>=Fa.length)return 0;if(Qb)return 2;if(!nb.S(Fa))return 1;Qb=new rc.a(Mc.a.Jk());for(var cb=ak(Fa),Xb=cb.next();!Xb.done;Xb=cb.next()){Xb=Xb.value;for(var kc=ak(Fa),Wc=kc.next();!Wc.done;Wc=kc.next()){Wc=Wc.value;var id=Xb.top===Wc.top&&Xb.bottom===Wc.bottom,Vc=Xb.left===Wc.left&&Xb.right===Wc.right,td=Math.max(Xb.left,Wc.left)<Math.min(Xb.right,Wc.right);if(Math.max(Xb.top,Wc.top)<Math.min(Xb.bottom,Wc.bottom)&&!id||td&&!Vc)return 3;Qb.add(String.format("{0}-{1}-{2}-{3}",
Xb.top,Xb.bottom,Wc.left,Wc.right));Qb.add(String.format("{0}-{1}-{2}-{3}",Wc.top,Wc.bottom,Xb.left,Xb.right))}}Fa=ak(Fa);for(cb=Fa.next();!cb.done;cb=Fa.next())cb=cb.value,Qb.remove(String.format("{0}-{1}-{2}-{3}",cb.top,cb.bottom,cb.left,cb.right));return 0<Qb.count?3:0};O.prototype.Q6i=function(Fa){var Qb=this.gridView.ha;Qb.updateSelection(Fa,Fa.topLeft,0);Qb.selectionType=-1};O.prototype.Kvb=function(Fa){if(null===Fa||void 0===Fa?0:Fa.sourceItem){if(!ra(Fa.sourceItem))return null;if((Fa=Fa.sourceItem)&&
nb.cb(Fa.ranges,!0))return Fa}return null};O.prototype.igc=function(Fa,Qb){Ia.ULS.shipAssertTag(537167711,0,!!Fa,"CopyPasteUtils.IsFromKeyboardShortcut: commandInfo shouldn't be null");return Qb&&Kc.a.TF in Qb||Fa.tabName?!1:1===Fa.method};O.Pmj=function(Fa,Qb,cb,Xb,kc,Wc,id,Vc,td){function rd(){return new X(cb,Xb,kc)}function za(Wb,fc,xc){Fa.ry();var Yb=Fa.oa.xa;Wb=ed.b(Wb,Wc);fc=ed.a(fc,id);var Ec=Vc;Ec=void 0===Ec?null:Ec;var bd=Yb.Na(9,tb);bd.sourceRanges=cb;bd.destinationRanges=Xb;bd.flags=kc;
return ub.g(Yb,"PasteRange",bd,Wb,fc,xc,null,64,Ec)}var tb=Fa.oa.xa.Pb(td?{r_:!0,JZ:1}:{r_:!1,JZ:0});td=Db.EwaSettings.Zb()?new Ac.a(506,0,za,65,rd):new ic.a(506,0,za,1,rd);Fa.userOperationManager.Sb(td,Qb)};O.Scc=function(Fa,Qb,cb,Xb,kc,Wc,id,Vc,td){id=void 0===id?null:id;Ia.ULS.sendTraceTag(537167710,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: on HandlePasteResult start. pasteContext.Id={0}",Qb.id);Qb.requestTelemetryData=Fa.RequestTelemetryData;Qb.serverRequestTimeInMs=Qb.commandParameters.stopwatch.qc-
kc;Pb.a.Rg(Fa.Errors)?Pb.a.Tga(Fa.Errors)?(Qb&&(Qb.encounteredDeploymentErrors=!0),Ia.ULS.sendTraceTag(537167707,0,15,"CopyPasteUtils.HandlePasteServerResponse: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",Pb.a.Dc(Fa.Errors))):(Fa=new eb.a(5,Fa.Errors),null===td||void 0===td?void 0:td(Fa),Xb(Fa)):Fa.Result?(Xb=!!Fa&&!!Fa.RequestTelemetryData,ma.g(Wc).ui.fla(Qb.commandParameters.stopwatch.id,Fa.StateId,Xb?Fa.RequestTelemetryData.EcsOperationDuration:
0,Xb?Fa.RequestTelemetryData.EcsRequestDuration:0,Xb?Fa.RequestTelemetryData.WfeRequestDuration:0),Qb.pastedRange=Fa.Result.SheetMultiRange,Ia.ULS.sendTraceTag(537167708,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise ewaResult.Result is not null. pasteContext.Id={0}",Qb.id),null===Vc||void 0===Vc?void 0:Vc(),cb(!0)):(Ia.ULS.sendTraceTag(537167709,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise when ewaResult.Result is null. pasteContext.Id={0}",
Qb.id),cb(id||!0))};O.VMd=function(Fa,Qb,cb,Xb,kc,Wc,id,Vc,td,rd,za,tb){function Wb(){return new Q(Yb)}function fc(Ec,bd,Ic){Fa.ry();return Z(Fa.oa.xa,Yb,ed.b(Ec,id),ed.a(bd,Vc),Ic,Wc,xc,td)}var xc=Fa.oa.xa.Pb(),Yb=O.o8g(cb,Xb,kc,rd,za,tb);cb=Db.EwaSettings.Zb()?new Ac.a(503,0,fc,65,Wb):new ic.a(503,0,fc,1,Wb);Fa.userOperationManager.Sb(cb,Qb)};O.o8g=function(Fa,Qb,cb,Xb,kc,Wc){var id={};id.ShadowWorkbookBase64=Fa.shadowWorkbookBase64;id.SourceRanges={};id.SourceRanges.Ranges=Array(1);id.SourceRanges.Ranges[0]=
{};id.SourceRanges.Ranges[0].FirstRow=Fa.rangeRowStart;id.SourceRanges.Ranges[0].LastRow=Fa.rangeRowEnd;id.SourceRanges.Ranges[0].FirstColumn=Fa.rangeColumnStart;id.SourceRanges.Ranges[0].LastColumn=Fa.rangeColumnEnd;Db.EwaSettings.getBooleanFeatureGate(Ja.a.L4b,!1)?cb?id.DestinationRanges=nb.u(cb.SheetName,cb.NamedObjectName,nb.g(cb.Ranges)):(Ia.ULS.sendTraceTag(537167706,0,15,"CopyPasteInfrastructure.CreatePasteParameters: multiRangeDestination is null"),id.DestinationRanges=null):id.DestinationRanges=
Qb?nb.s(Qb):null;id.CopyPasteTargetType=1;id.PasteType=Xb;id.CopyOperationId=kc;id.PasteId=Wc;id.SourceClientPath=Fa.sourceClientPath;id.SourceSheetName=Fa.sourceSheetName;id.SourceWorkbookName=Fa.sourceWorkbookName;if(!Fa.originalSourceRangesCountExceedsLimit&&Fa.originalSourceRanges&&0<Fa.originalSourceRanges.length&&1024===Xb){id.OriginalSourceMultiRange={};Qb=Array(Fa.originalSourceRanges.length);for(cb=0;cb<Qb.length;++cb)Qb[cb]={},Qb[cb].FirstRow=Fa.originalSourceRanges[cb][0],Qb[cb].FirstColumn=
Fa.originalSourceRanges[cb][1],Qb[cb].LastRow=Fa.originalSourceRanges[cb][2],Qb[cb].LastColumn=Fa.originalSourceRanges[cb][3];id.OriginalSourceMultiRange.Ranges=Qb}return id};O.TQe=function(Fa,Qb,cb){cb=cb.clone();cb.height<Qb&&(cb.bottom=Math.min(yb.a.vh,cb.top+Qb-1));cb.width<Fa&&(cb.right=Math.min(yb.a.Eh,cb.left+Fa-1));return cb};O.prototype.executeInsertCopiedCutCellsOperation=function(Fa,Qb,cb,Xb,kc,Wc,id){function Vc(){return new H(td)}Wc=void 0===Wc?null:Wc;id=void 0===id?null:id;var td={};
td.InsertDirection=Xb;td.SourceRange=Fa;td.DestRange=Qb;td.CopyCutOperation=cb?0:1;var rd=this.$.oa.xa;return Bc.a(this.$.userOperationManager,function(za,tb,Wb){za=Wc?ed.b(za,Wc):za;tb=id?ed.a(tb,id):tb;var fc=rd.Na(41,null);fc.insertCopiedCutCellsParameters=td;return ub.g(rd,"InsertCopiedCutCells",fc,za,tb,Wb,null,4)},function(za){return new Ac.a(104,0,za,void 0,Vc)},kc)};O.prototype.OIe=function(Fa,Qb,cb,Xb,kc,Wc,id,Vc){var td=this;return new Promise(function(rd,za){function tb(fc){fc=Gc.a.Of(fc.data);
fc=new eb.a(21,fc);null===Vc||void 0===Vc?void 0:Vc(fc);za(fc)}function Wb(fc){Fa.requestTelemetryData=fc.RequestTelemetryData;if(fc.Errors&&0<fc.Errors.length){var xc=new eb.a(21,fc.Errors);null===Vc||void 0===Vc?void 0:Vc(xc);za(new eb.a(21,fc.Errors))}else null===id||void 0===id?void 0:id(),rd(!0)}Db.EwaSettings.isChangeGateEnabled("OfficeVSO:6126613_RemoveClearingRunningAntsICCCForDragInsert")?td.executeInsertCopiedCutCellsOperation(Qb,cb,Xb,kc,Wc,Wb,tb):td.executeInsertCopiedCutCellsOperation(Qb,
cb,Xb,kc,Wc,Wb,tb).continueWith(function(){if(Xb)td.Wwb();else{var fc=td.$.da.za(254);fc&&fc.k2b("DragDropInsert/success/"+Hb.a[Wc.method],!0)}})})};Af.Object.defineProperties(O.prototype,{fvd:{configurable:!0,enumerable:!0,get:function(){Ia.ULS.sendTraceTag(537167757,0,50,"CopyPasteUtils.MaxCopyPasteLength returning BootstrapContext.MaxCopyPasteLength. MaxCopyPasteLength={0}",this.$.ya.MaxCopyPasteLength);return this.$.ya.MaxCopyPasteLength}},Nxa:{configurable:!0,enumerable:!0,get:function(){return this.Awa?
Db.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.CopyPasteHtmlImportMaxLength",this.$.ya.CopyPasteMaxPayloadLength):yb.a.Nxa}}});Object(W.a)(O,"CopyPasteUtils",null,[706]);var ld=b(543),Bd;(function(Fa){Fa[Fa.range=0]="range";Fa[Fa.art=1]="art"})(Bd||(Bd={}));Object(W.b)("SourceItemType",Bd);var xb=b(24),Fd=b(92);J.prototype.serializeSourceItem=function(Fa){var Qb={};if(Fa&&Object.getType(Fa)===na)Qb.sheetName=Fa.sheetName,Qb.topArray=Ub.a.map(Fa.ranges,function(cb){return cb.top}),Qb.leftArray=
Ub.a.map(Fa.ranges,function(cb){return cb.left}),Qb.bottomArray=Ub.a.map(Fa.ranges,function(cb){return cb.bottom}),Qb.rightArray=Ub.a.map(Fa.ranges,function(cb){return cb.right}),Qb.sessionStateId=Fa.sessionStateId,Qb.sessionId=Fa.sessionId,Qb.sourceItemType=this.dXf(0);else if(Fa&&Object.getType(Fa)===ba)Qb.activeFloatingObjectControlId=Fa.activeFloatingObjectControlId,Qb.sheetName=Fa.sheetName,Qb.sessionStateId=Fa.sessionStateId,Qb.sessionId=Fa.sessionId,Qb.floatingObjectType=this.rnj(Fa.type),
Qb.sourceItemType=this.dXf(1);else return Ia.ULS.shipAssertTag(537167705,0,!1,"EnvironmentSerializationHelper.SerializeSourceItem: sourceItem shouldn't be null."),null;return JSON.stringify(Qb)};J.prototype.serializeCommandParameters=function(Fa){if(!Fa)return Ia.ULS.shipAssertTag(537167704,0,!1,"EnvironmentSerializationHelper.Serialize: commandParameters shouldn't be null."),null;var Qb={};Qb.id=Fa.id;Qb.commandType=Fa.commandType;Qb.copyPasteTargetType=Fa.copyPasteTargetType;Fa.ribbonCommandInfo&&
(Qb.ribbonCommandName=this.znj(Fa.ribbonCommandInfo.command),Qb.inputMethodName=this.tnj(Fa.ribbonCommandInfo.method),Qb.frameModeName=this.snj(Fa.ribbonCommandInfo.mode),Qb.uiLocationName=this.Cnj(Fa.ribbonCommandInfo.Me),Qb.tabName=Fa.ribbonCommandInfo.tabName);return JSON.stringify(Qb)};J.prototype.deserializeSourceItem=function(Fa){if(!Fa)return null;try{var Qb=JSON.parse(Fa);if(!Qb)return Ia.ULS.shipAssertTag(537167703,0,!1,"EnvironmentSerializationHelper.Deserialize: Json.Parse return null result."),
null;var cb=null;switch(this.Gdh(Qb.sourceItemType)){case 0:cb=new na(this.$,this.Ddh(Qb),Qb.sheetName,Qb.sessionStateId,Qb.sessionId);break;case 1:cb=new ba(Qb.activeFloatingObjectControlId,Qb.sheetName,Qb.sessionStateId,Qb.sessionId,this.Adh(Qb.floatingObjectType))}return cb}catch(Xb){return Ia.ULS.sendTraceTag(537167702,0,10,"EnvironmentSerializationHelper.DeserializeSourceItem: got exception while try to JSON.Parse string length: {0}, errror: {1}",Fa?Fa.length:0,Xb),null}};J.prototype.deserializeCommandParameters=
function(Fa){if(!Fa)return null;try{var Qb=JSON.parse(Fa);if(!Qb)return Ia.ULS.shipAssertTag(537167701,0,!1,"EnvironmentSerializationHelper.DeserializeCommandParameters: Json.Parse return null result."),null;var cb=$a.a();cb.id=Qb.id;cb.ribbonCommandInfo=this.Fdh(Qb);cb.commandType=Qb.commandType;cb.copyPasteTargetType=Qb.copyPasteTargetType;return cb}catch(Xb){return Ia.ULS.sendTraceTag(537167700,0,10,"EnvironmentSerializationHelper.DeserializeCommandParameters: got exception while try to JSON.Parse string length: {0}, errror: {1}",
Fa?Fa.length:0,Xb),null}};J.prototype.Ddh=function(Fa){var Qb=[];Ia.ULS.shipAssertTag(537167699,0,!!Fa.topArray&&0<Fa.topArray.length,"EnvironmentSerializationHelper.DeserializeRanges: TopArray shouldn't be {0}.",Fa.topArray?"empty":"null");Ia.ULS.shipAssertTag(537167698,0,!!Fa.leftArray&&0<Fa.leftArray.length,"EnvironmentSerializationHelper.DeserializeRanges: LeftArray shouldn't be {0}.",Fa.leftArray?"empty":"null");Ia.ULS.shipAssertTag(537167697,0,!!Fa.bottomArray&&0<Fa.bottomArray.length,"EnvironmentSerializationHelper.DeserializeRanges: BottomArray shouldn't be {0}.",
Fa.bottomArray?"empty":"null");Ia.ULS.shipAssertTag(537167696,0,!!Fa.rightArray&&0<Fa.rightArray.length,"EnvironmentSerializationHelper.DeserializeRanges: RightArray shouldn't be {0}.",Fa.rightArray?"empty":"null");if(!(Fa.topArray&&Fa.leftArray&&Fa.bottomArray&&Fa.rightArray))return Qb;Ia.ULS.shipAssertTag(537167695,0,Fa.topArray.length===Fa.bottomArray.length&&Fa.topArray.length===Fa.leftArray.length&&Fa.topArray.length===Fa.rightArray.length,"EnvironmentSerializationHelper.DeserializeRanges: The length of TopArray({0}), BottomArray({1}), LeftArray({2}), RightArray({3}) should be the same.",
Fa.topArray.length,Fa.bottomArray.length,Fa.leftArray.length,Fa.rightArray.length);for(var cb=Math.min(Fa.topArray.length,Fa.bottomArray.length,Fa.leftArray.length,Fa.rightArray.length),Xb=0;Xb<cb;Xb++)Qb.push(new xb.Range(Fa.topArray[Xb],Fa.leftArray[Xb],Fa.bottomArray[Xb],Fa.rightArray[Xb],!1,!1));return Qb};J.prototype.Fdh=function(Fa){return new Fd.a(this.Edh(Fa.ribbonCommandName),this.Cdh(Fa.inputMethodName),this.Bdh(Fa.frameModeName),this.Hdh(Fa.uiLocationName),Fa.tabName)};J.prototype.znj=
function(Fa){return void 0!==Fa&&null!==Fa&&Fa.toString()in this.cLd?this.cLd[Fa.toString()]:(Ia.ULS.shipAssertTag(537167694,0,!1,"EnvironmentSerializationHelper.SerializeRibbonCommand expected to get RibbonCommand.Copy({0}) or RibbonCommand.Cut({1}) but got {2}",-911352779,-1985798686,Fa),this.cLd["-911352779"])};J.prototype.Edh=function(Fa){return Fa&&Fa in this.r6f?this.r6f[Fa]:(Ia.ULS.shipAssertTag(537167693,0,!1,"EnvironmentSerializationHelper.DeserializeRibbonCommand: expected to get RibbonCommand.Copy({0}) or RibbonCommand.Cut({1}) but got {2}",
-911352779,-1985798686,Fa),-911352779)};J.prototype.tnj=function(Fa){return void 0!==Fa&&null!==Fa&&Hb.a[Fa]in this.bka?this.bka[Hb.a[Fa]]:(Ia.ULS.shipAssertTag(537167692,0,!1,"EnvironmentSerializationHelper.SerializeInputMethod: got unexpected value {0}",Fa),this.bka.unknown)};J.prototype.Cdh=function(Fa){return Fa&&Fa in this.q6f?this.q6f[Fa]:(Ia.ULS.shipAssertTag(537167691,0,!1,"EnvironmentSerializationHelper.DeserializeInputMethod: got unexpected value {0}",Fa),0)};J.prototype.snj=function(Fa){return void 0!==
Fa&&null!==Fa&&ld.a[Fa]in this.N2a?this.N2a[ld.a[Fa]]:(Ia.ULS.shipAssertTag(537167690,0,!1,"EnvironmentSerializationHelper.SerializeFrameMode: got unexpected value {0}",Fa),this.N2a.edit)};J.prototype.Bdh=function(Fa){return Fa&&Fa in this.p6f?this.p6f[Fa]:(Ia.ULS.shipAssertTag(537167689,0,!1,"EnvironmentSerializationHelper.DeserializeFrameMode: got unexpected value {0}",Fa),2)};J.prototype.dXf=function(Fa){return void 0!==Fa&&null!==Fa&&Bd[Fa]in this.YLb?this.YLb[Bd[Fa]]:(Ia.ULS.shipAssertTag(537167688,
0,!1,"EnvironmentSerializationHelper.SerializeSourceItemType: got unexpected value {0}",Fa),this.YLb.range)};J.prototype.Gdh=function(Fa){return Fa&&Fa in this.s6f?this.s6f[Fa]:(Ia.ULS.shipAssertTag(537167687,0,!1,"EnvironmentSerializationHelper.DeserializeSourceItemType: got unexpected value {0}",Fa),0)};J.prototype.rnj=function(Fa){return void 0!==Fa&&null!==Fa&&Fa.toString()in this.FWc?this.FWc[Fa.toString()]:(Ia.ULS.shipAssertTag(537167686,0,!1,"EnvironmentSerializationHelper.SerializeArtSourceItemType: got unexpected value {0}",
Fa),this.FWc["99"])};J.prototype.Adh=function(Fa){return Fa&&Fa in this.o6f?this.o6f[Fa]:(Ia.ULS.shipAssertTag(537167685,0,!1,"EnvironmentSerializationHelper.DeserializeArtSourceItemType: got unexpected value {0}",Fa),99)};J.prototype.Cnj=function(Fa){return void 0!==Fa&&null!==Fa&&gb.a[Fa]in this.ur?this.ur[gb.a[Fa]]:(Ia.ULS.shipAssertTag(36229129,0,!1,"EnvironmentSerializationHelper.SerializeUILocation: got unexpected value {0}",Fa),this.ur.ribbon)};J.prototype.Hdh=function(Fa){return Fa&&Fa in
this.t6f?this.t6f[Fa]:(Ia.ULS.shipAssertTag(537167684,0,!1,"EnvironmentSerializationHelper.DeserializeUILocation: got unexpected value {0}",Fa),2)};Object(W.a)(J,"EnvironmentSerializationHelper",null,[]);var Vd=b(4);K.uUf="SameSession";K.GEe="CrossSession";K.Cjf="LegacyCrossSession";K.external="External";Object(W.a)(K,"PayloadOrigin",null,[]);M.prototype.shouldWaitForCopyToComplete=function(){return!1};M.prototype.onDeferredPasteStarted=function(){};M.prototype.onDeferredPasteCompleted=function(){};
M.prototype.beforePaste=function(){};M.prototype.uNj=function(Fa){var Qb=null;try{var cb=Fa.getItem(la.iO);if(!cb)return{returnValue:!1,w0:Qb};Qb=JSON.parse(cb);return{returnValue:this.noi(Qb),w0:Qb}}catch(Xb){return Ia.ULS.sendTraceTag(537167835,0,50,"BaseCopyPasteHandler.TryParseRangeShadowWorkbookPayload: Exception caught: "+Xb),{returnValue:!1,w0:Qb}}};M.prototype.noi=function(Fa){return!!Fa&&(!!Fa.shadowWorkbookBase64||Fa.shadowWorkbookSizeExceedsLimit)&&void 0!==Fa.rangeRowStart&&void 0!==Fa.rangeRowEnd&&
void 0!==Fa.rangeColumnStart&&void 0!==Fa.rangeColumnEnd};M.prototype.opc=function(Fa){Fa.wasLastCopyExternal=!0;if(Db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Ma.a.LC&&516!==Fa.commandParameters.commandType&&1028!==Fa.commandParameters.commandType){var Qb=this.uNj(Fa.clipboardItems);var cb=Qb.w0;if(Qb.returnValue)return Fa.isShadowWorkbookParsedSuccessfully=!0,this.lXi(Fa,cb)}return 516!==Fa.commandParameters.commandType&&36!==Fa.commandParameters.commandType?
Db.EwaSettings.ma(162)&&20!==Fa.commandParameters.commandType&&(null===this.$.shortcutKeyManager||this.$.shortcutKeyManager.Lfc)&&(cb=Fa.clipboardItems.getItem(la.html),void 0!==cb&&null!==cb&&cb&&cb.trim()!==this.IWc&&(cb.startsWith("<")||Ma.a.xf&&cb.startsWith("\n<")))?(Qb=Fa.clipboardItems.getItem(la.Gqb),this.jXi(Fa,cb,void 0===Qb?null:Qb)):this.rFf(Fa):Promise.reject(new eb.a(6))};M.prototype.lXi=function(Fa,Qb){Ia.ULS.sendTraceTag(537167834,0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: Pasting shadow workbook from system clipboard");
Fa.pasteResult="SystemClipboardShadowWorkbookPaste";Fa.payloadType=da.iO;Fa.payloadOrigin=K.external;Fa.shadowWorkbookPayloadSize=F(Qb);Fa.shadowWorkbookSizeExceedsLimit=T(Qb);var cb=null,Xb=null,kc=Fa.commandParameters.originalDestinations;Db.EwaSettings.getBooleanFeatureGate(Ja.a.L4b,!1)?cb=nb.r(kc,this.$):Xb=nb.v(nb.K(kc),this.$);Qb.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(Fa.originalSourceRangesCountExceedsLimit=Qb.originalSourceRangesCountExceedsLimit);if(Fa.shadowWorkbookSizeExceedsLimit)return Ia.ULS.sendTraceTag(537167833,
0,15,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: shadow workbook length({0}) is over the limit({1}). reject the paste request. ShadowWorkbookSizeExceedsLimit: {2}",Fa.shadowWorkbookPayloadSize,yb.a.Gkc,Qb.shadowWorkbookSizeExceedsLimit),Promise.reject(new eb.a(1));Ia.ULS.sendTraceTag(537167832,0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: trigger Paste request. PasteOperationId={0}",Fa.commandParameters.id);return this.Gp.wFf(Fa.commandParameters.ribbonCommandInfo,Xb,
cb,Qb,[Fa.commandParameters.stopwatch],Fa)};M.prototype.rFf=function(Fa){var Qb=Fa.clipboardItems.getItem(la.hW);if(void 0!==Qb&&null!==Qb&&Qb.trim()===this.IWc)return Promise.reject(new eb.a(7));void 0!==Qb&&null!==Qb&&(Fa.plainTextPayloadSize=Qb.length);Fa.isPlainTextPaste=!0;Fa.pasteResult="SystemClipboardPaste";Fa.payloadOrigin=ab(Fa)?K.Cjf:K.external;Fa.payloadType=da.hW;Ia.ULS.sendTraceTag(537167831,0,50,"BaseRangeCopyPasteHandler.PasteByPlainText: trigger ProcessPasteText request. pasteContext.Id={0}, PasteOperationId={1}",
Fa.id,Fa.commandParameters.id);Qb=this.Gp.r1i(nb.K(Fa.commandParameters.originalDestinations),Qb,Fa.commandParameters.ribbonCommandInfo,[Fa.commandParameters.stopwatch],Fa);Ia.ULS.sendTraceTag(537167830,0,50,"BaseRangeCopyPasteHandler.PasteByPlainText: returned from ProcessPasteText. pasteContext.Id={0}",Fa.id);return Qb};M.prototype.jXi=function(Fa,Qb,cb){Fa.htmlPayloadSize=Qb.length;Fa.isHtmlPaste=!0;Fa.pasteResult="SystemClipboardHtmlPaste";Fa.payloadType=da.html;Fa.payloadOrigin=ab(Fa)?K.Cjf:
K.external;Ia.ULS.sendTraceTag(42071711,0,50,"BaseRangeCopyPasteHandler.PasteByHtml: trigger ProcessPasteHtml request. PasteOperationId={0}",Fa.commandParameters.id);return this.Gp.q1i(nb.K(Fa.commandParameters.originalDestinations),Qb,cb,Fa.commandParameters.id,Fa.commandParameters.ribbonCommandInfo,[Fa.commandParameters.stopwatch],Fa)};M.prototype.dEe=function(Fa){var Qb={};Fa&&(Qb.shadowWorkbookBase64=Fa.ShadowWorkbookBase64,Qb.shadowWorkbookSizeExceedsLimit=Fa.ShadowWorkbookSizeExceedsLimit,Qb.originalSourceRangesCountExceedsLimit=
Fa.OriginalSourceRangesCountExceedsLimit,Qb.originalSourceRangesCount=Fa.OriginalSourceRangesCount,Qb.shadowWorkbookBlockedSize=Fa.ShadowWorkbookBlockedSize);return Qb};M.prototype.Heg=function(Fa,Qb){var cb=Ka(Fa),Xb=32===(Fa.commandParameters.commandType&32),kc=1024===(Fa.commandParameters.commandType&1024),Wc=!1,id=null,Vc=null,td=!1;if(!cb){Wc=-1985798686===Fa.commandParameters.ribbonCommandInfo.command;var rd=Fa.copyContextSnapshot;if(Qb)td=!rd.sourceItem.isFromCurrentSession(this.$);else if(rd=
this.Gp.Kvb(rd))id=rd.ranges,Vc=rd.sheetName,td=!Fa.isSameSession}return this.Gp.YKg(Vc,id,this.$.pa.sheetName,Fa.commandParameters.originalDestinations,Fa.commandParameters.expandDestinations,td,Xb,kc,Wc,Qb,cb)};Af.Object.defineProperties(M.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},IWc:{configurable:!0,enumerable:!0,get:function(){return this.Im.Xa(5)}}});Object(W.a)(M,"BaseCopyPasteHandler",null,[775,776,777]);U.prototype.getValue=function(Fa){return this.key&&
this.key.isEqual(Fa)?this.createClipboardItems(this.clipboardItems):null};U.prototype.setValue=function(Fa,Qb){this.key=Fa;this.clipboardItems=this.createClipboardItems(Qb)};U.prototype.createClipboardItems=function(Fa){var Qb=this.s$.create(),cb=Fa.getItem(la.hW);cb&&Qb.setItem(la.hW,cb);(cb=Fa.getItem(la.iO))&&Qb.setItem(la.iO,cb);(Fa=Fa.getItem(la.html))&&Qb.setItem(la.html,Fa);return Qb};Object(W.a)(U,"CopyCache",null,[]);var se=b(74);Rk(I,M);I.prototype.getSourceItem=function(){var Fa=Ub.a.clone(this.gridView.ha.sa.selectedRanges);
return new na(this.$,Fa,this.$.ea.pa.sheetName,this.$.ea.Ve,this.$.ya.UserSessionId)};I.prototype.beforeSerialize=function(Fa){var Qb=this;Fa.isSelectionAllowed=!1;Fa.isAsyncCopy=!1;Fa.isFromCache=!1;Fa.encounteredDeploymentErrors=!1;Fa.plainTextPayloadSize=0;Fa.shadowWorkbookPayloadSize=0;Fa.htmlPayloadSize=0;Fa.clientSideCopyTime=0;var cb=new rb.a(this.$.va),Xb=Fa.sourceItem;Fa.isSelectionAllowed=Ub.a.all(Xb.ranges,function(kc){return Qb.isSelectionAllowed(cb,kc)});Fa.isSelectionAllowed&&this.Gp.t7e(Xb.ranges,
Fa.commandParameters.commandType)};I.prototype.lMa=function(Fa){return this.gridView.Ea.RZ()&&ma.i(this.gridView,Fa)};I.prototype.GXi=function(Fa,Qb,cb,Xb){var kc=!1,Wc=1===Qb.commandParameters.commandType,id=Xb[0].aM;1===cb.ranges.length&&1===Xb.length?Db.EwaSettings.isChangeGateEnabled("OfficeVSO:5593878_PasteCSE_CCPErrorTests1")&&Wc&&1!==id&&id!==cb.ranges[0].aM?Fa.cseStatus=17:kc=this.v3g.i6c(Fa,nb.K(cb.ranges),cb.sheetName,nb.K(Fa.commandParameters.expandDestinations),this.$.ea.pa.sheetName,
Wc):Fa.cseStatus=5;kc&&ma.g(this.$).ui.B0(Fa.commandParameters.stopwatch.id,se.BasicTelemetryCalculator.NQ);return this.rXi(Fa,cb,nb.u(this.$.pa.sheetName,null,Xb),Qb.commandParameters.commandType,kc)};I.prototype.isSelectionAllowed=function(Fa,Qb){return Fa.Qzb(Qb,this.gridView)};I.prototype.rXi=function(Fa,Qb,cb,Xb,kc){Qb=nb.u(Qb.sheetName,null,Qb.ranges);Fa.pasteResult="SameSessionPaste";Fa.payloadOrigin=K.uUf;Fa.payloadType=da.Dzg;Ia.ULS.sendTraceTag(537167829,0,50,"BaseRangeCopyPasteHandler.PasteSameSession: trigger PasteRange request. PasteOperationId={0}",
Fa.commandParameters.id);return this.Gp.pasteRange(Fa.commandParameters.ribbonCommandInfo,Qb,cb,Xb,Fa.commandParameters.commandType,[Fa.commandParameters.stopwatch],Fa,kc,null,null)};Object(W.a)(I,"BaseRangeCopyPasteHandler",M,[]);var ue=b(34);E.prototype.onDeferredPasteStarted=function(Fa){this.wU.kb(Fa.id)||this.wU.add(Fa.id,!0);if(0<this.wU.count){var Qb=pa.GetServiceTaskFactory.Ra(this.$.da,5,4,0);Ab.TaskExtensions.Ba(Qb,function(){Qb.result.Jf(28,null)},this.$.la,3)}};E.prototype.onDeferredPasteCompleted=
function(Fa){var Qb=0<this.wU.count;this.wU.kb(Fa.id)&&this.wU.remove(Fa.id);if(Qb&&!this.wU.count){var cb=pa.GetServiceTaskFactory.Ra(this.$.da,5,4,0);Ab.TaskExtensions.Ba(cb,function(){cb.result.removeEntry(28)},this.$.la,3)}};Object(W.a)(E,"DeferredPasteTracker",null,[]);var Ee;(function(Fa){Fa[Fa.none=0]="none";Fa[Fa.loadClipboardFromServerFailed=1]="loadClipboardFromServerFailed";Fa[Fa.loadCopiedDataFromServerFailed=2]="loadCopiedDataFromServerFailed";Fa[Fa.asyncCopyCanceled=3]="asyncCopyCanceled";
Fa[Fa.loadCopiedArtDataFromServerFailed=4]="loadCopiedArtDataFromServerFailed"})(Ee||(Ee={}));Object(W.b)("CopyErrorType",Ee);var qe=b(1132),He=b(1320),Ie=qe.a;Rk(G,Ie);Object(W.a)(G,"CopyInnerError",qe.a,[]);Rk(C,I);C.prototype.serialize=function(Fa){var Qb=Fa.sourceItem,cb={},Xb=this.n2c.getValue(Qb);if(Xb)cb.synchronousResult=Xb,Fa.isFromCache=!0,Fa.clientSideCopyTime=Fa.commandParameters.stopwatch.qc;else{var kc=null,Wc=nb.F(Qb.ranges);if(!Da.a.kdf()&&this.lMa(Wc)){Ia.ULS.sendTraceTag(537167936,
0,50,"AcrossSessionRangeCopyPasteHandler.Serialize: All data is loaded prepare the data in the client side.");Wc=this.clipboardRangeFactory.create(Wc);try{kc=Wc.toString(),Xb=this.s$.create(),Xb.setItem(la.hW,kc),this.n2c.setValue(Qb,Xb),cb.synchronousResult=Xb,Fa.clientSideCopyTime=Fa.commandParameters.stopwatch.qc}finally{Wc&&Wc.dispose()}}else Fa.isAsyncCopy=!0,cb.synchronousResult=this.s$.create(),cb.synchronousResult.setItem(la.hW,this.IWc);cb.asynchronousResult=this.Ncd(Fa,Qb,kc)}Fa.syncClipboardItemsKeys=
ha(cb.synchronousResult);return cb};C.prototype.shouldWaitForCopyToComplete=function(Fa){if(!Fa||!Fa.copyContextSnapshot)return Ia.ULS.sendTraceTag(537167907,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: pasteContext or pasteContext.CopyContextSnapshot is not define, return false."),!1;Ia.ULS.shipAssertTag(537167906,0,!!this.$.ya,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: this.EwaControl.BootstrapContext shouldn't be null");if(Fa.copyContextSnapshot.sessionId===
this.$.ya.UserSessionId)return Ia.ULS.sendTraceTag(537167905,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: Same session copy scenario, return false."),!1;Ia.ULS.sendTraceTag(537167904,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0};C.prototype.onDeferredPasteStarted=function(Fa){this.wU.onDeferredPasteStarted(Fa)};C.prototype.onDeferredPasteCompleted=function(Fa){this.wU.onDeferredPasteCompleted(Fa)};C.prototype.deserialize=
function(Fa){Fa.isClipboardDataContainShadowWorkbook=!(void 0===Fa.clipboardItems.getItem(la.iO)||null===Fa.clipboardItems.getItem(la.iO));if(ma.g(this.$).ha.Qe&326)return Ka(Fa)&&(Fa.wasLastCopyExternal=!0),Promise.reject(new eb.a(17));var Qb=this.Heg(Fa,!1);if(0!==Qb)return Promise.reject(new eb.a(Ka(Fa)?18:Fa.isSameSession?19:20,void 0,void 0,void 0,Qb));var cb=Fa.copyContextSnapshot,Xb=this.Gp.Kvb(cb);if(Ka(Fa))return this.opc(Fa);Qb=Fa.commandParameters.originalDestinations;if(Xb&&Fa.isSameSession)return this.GXi(Fa,
cb,Xb,Qb);if(516!==Fa.commandParameters.commandType){Xb=this.tNj(Fa.clipboardItems);cb=Xb.w0;if(Xb.returnValue){Fa.isShadowWorkbookParsedSuccessfully=!0;var kc=Xb=null;Db.EwaSettings.getBooleanFeatureGate(Ja.a.L4b,!1)?Xb=nb.r(Qb,this.$):kc=nb.v(nb.K(Qb),this.$);return this.hXi(Fa,kc,Xb,cb)}if(Fa.isClipboardInaccessible)return Promise.reject(new eb.a(8));if(36!==Fa.commandParameters.commandType)return this.rFf(Fa)}return Promise.reject(new eb.a(6))};C.prototype.beforePaste=function(Fa){this.$.da.za(373).okj(Fa);
Fa.indicationDisplayScheduled=!0};C.prototype.NMj=function(Fa){if(!(Fa&&Fa.SourceRanges&&Fa.SourceRanges.Ranges&&Fa.SourceRanges.Ranges.length&&(Fa.OriginalSourceRangesCountExceedsLimit||Fa.OriginalSourceMultiRange&&Fa.OriginalSourceMultiRange.Ranges&&Fa.OriginalSourceMultiRange.Ranges.length)))return{returnValue:!1,w0:null};var Qb=Fa.SourceRanges.Ranges[0];if(!Fa.ShadowWorkbookBase64&&!Fa.ShadowWorkbookSizeExceedsLimit)return{returnValue:!1,w0:null};var cb=this.dEe(Fa);cb.rangeRowStart=Qb.FirstRow;
cb.rangeRowEnd=Qb.LastRow;cb.rangeColumnStart=Qb.FirstColumn;cb.rangeColumnEnd=Qb.LastColumn;cb.sourceClientPath=Fa.SourceClientPath;cb.sourceSheetName=Fa.SourceSheetName;cb.sourceWorkbookName=Fa.SourceWorkbookName;if(!Fa.OriginalSourceRangesCountExceedsLimit)for(Fa=Fa.OriginalSourceMultiRange.Ranges,cb.originalSourceRanges=Array(Fa.length),Qb=0;Qb<Fa.length;++Qb)cb.originalSourceRanges[Qb]=[Fa[Qb].FirstRow,Fa[Qb].FirstColumn,Fa[Qb].LastRow,Fa[Qb].LastColumn];return{returnValue:!0,w0:cb}};C.prototype.tNj=
function(Fa){var Qb=null;Fa=Fa.getItem(la.iO);if(!Fa)return{returnValue:!1,w0:Qb};Qb=JSON.parse(Fa);return{returnValue:this.moi(Qb),w0:Qb}};C.prototype.moi=function(Fa){return!!Fa&&(!!Fa.shadowWorkbookBase64||Fa.shadowWorkbookSizeExceedsLimit)&&void 0!==Fa.rangeRowStart&&void 0!==Fa.rangeRowEnd&&void 0!==Fa.rangeColumnStart&&void 0!==Fa.rangeColumnEnd};C.prototype.hXi=function(Fa,Qb,cb,Xb){Ia.ULS.shipAssertTag(537167903,0,!!Xb,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadowWorkbookPayload shouldn't be null");
Vd.AFrameworkApplication.cN("Microsoft.Office.Excel.Server.Flighting.IDenyListNewCopyPasteExperienceAcrossSessions");Fa.pasteResult="CrossSessionPaste";Fa.payloadOrigin=K.GEe;Fa.payloadType=da.iO;Fa.shadowWorkbookPayloadSize=F(Xb);Fa.shadowWorkbookSizeExceedsLimit=T(Xb);Xb.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(Fa.originalSourceRangesCountExceedsLimit=Xb.originalSourceRangesCountExceedsLimit);if(Fa.shadowWorkbookSizeExceedsLimit)return Ia.ULS.sendTraceTag(34415003,0,15,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadow workbook length({0}) is over the limit({1}). reject the paste request. ShadowWorkbookSizeExceedsLimit: {2}",
Fa.shadowWorkbookPayloadSize,yb.a.Gkc,Xb.shadowWorkbookSizeExceedsLimit),Promise.reject(new eb.a(1));if(1028===Fa.commandParameters.commandType&&Fa.originalSourceRangesCountExceedsLimit)return Ia.ULS.sendTraceTag(572617859,0,15,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: Original source ranges count({0}) is over the limit({1}). Reject the paste request. OriginalSourceRangesCountExceedsLimit: {2}",Xb.originalSourceRangesCount,yb.a.Uyi,Xb.originalSourceRangesCountExceedsLimit),Promise.reject(new eb.a(1));
Ia.ULS.sendTraceTag(537167902,0,50,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: trigger Paste request. PasteOperationId={0}",Fa.commandParameters.id);return this.Gp.wFf(Fa.commandParameters.ribbonCommandInfo,Qb,cb,Xb,[Fa.commandParameters.stopwatch],Fa)};C.prototype.Ncd=function(Fa,Qb,cb){var Xb=this;Ia.ULS.shipAssertTag(537167901,0,!!Fa,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: copyContext shouldn't be null");var kc=Fa.commandParameters.stopwatch.qc;return new Promise(function(Wc,
id){Ia.ULS.sendTraceTag(26035421,0,50,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data for copy Id: {0}",Fa.id);var Vc=nb.u(Qb.sheetName,null,Qb.ranges);Xb.Gp.copy(Vc,Fa.commandParameters,function(td){Fa.requestTelemetryData=td.RequestTelemetryData;Fa.serverRequestTimeInMs=Fa.commandParameters.stopwatch.qc-kc;if(Pb.a.Rg(td.Errors))Pb.a.Tga(td.Errors)?(Fa.encounteredDeploymentErrors=!0,Ia.ULS.sendTraceTag(537167898,0,15,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}. copy Id: {1}",
Pb.a.Dc(td.Errors),Fa.id)):(Ia.ULS.sendTraceTag(26035419,0,10,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}. copy Id: {1}",Pb.a.Dc(td.Errors),Fa.id),id(new G(2,td.Errors)));else if(Ia.ULS.sendTraceTag(537167900,0,50,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeed for copy Id: {0}",Fa.id),Fa.markForCancellation)id(new G(3,td.Errors));else{td=td.Result;var rd=td.PlainTextResult;void 0!==cb&&null!==
cb&&(rd=cb);void 0!==rd&&null!==rd&&(Fa.plainTextPayloadSize=rd.length);var za=Xb.s$.create(),tb=Xb.NMj(td);var Wb=tb.w0;tb.returnValue&&(Fa.shadowWorkbookPayloadSize=F(Wb),Fa.shadowWorkbookSizeExceedsLimit=T(Wb),Fa.originalSourceRangesCountExceedsLimit=td.OriginalSourceRangesCountExceedsLimit,Wb=JSON.stringify(Wb),za.setItem(la.iO,Wb));za.setItem(la.hW,rd);Da.a.kdf()&&(rd=td.HtmlResult,Fa.htmlSizeExceedsLimit=td.HtmlSizeExceedsLimit,void 0!==rd&&null!==rd&&(Fa.htmlPayloadSize=rd.length),za.setItem(la.html,
rd));Fa.copyTotalSizeExceedsLimit=td.CopyTotalSizeExceedsLimit;za.setItem(la.Gqb,Fa.commandParameters.id);Xb.n2c.setValue(Qb,za);Fa.asyncClipboardItemsKeys=ha(za);Wc(za)}},function(td){Fa.serverRequestTimeInMs=Fa.commandParameters.stopwatch.qc-kc;td=Gc.a.Of(td.data);Ia.ULS.sendTraceTag(537167897,0,10,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}. copy Id: {1}",Pb.a.Dc(td),Fa.id);id(new G(2,td))},[Fa.commandParameters.stopwatch])})};Object(W.a)(C,
"AcrossSessionRangeCopyPasteHandler",I,[]);Object(W.a)(x,"CopyArtRequest",null,[]);Object(W.a)(y,"PasteArtRequest",null,[]);B.prototype.z3h=function(Fa){if(this.mki(Fa.zNa)){Ia.ULS.sendTraceTag(537167681,5,50,"PasteArtRequestManager.HandleRequest: Enqueued paste request as a result of rapid paste on same destination: {0}",Fa.zNa);var Qb=this.tIb.na(Fa.zNa);this.tIb.ia(Fa.zNa,Fa);var cb=Qb.promise;Qb.Bdf=!1;return this.Gkh(Fa,cb)}this.tIb.ia(Fa.zNa,Fa);return this.lri(Fa)};B.prototype.mki=function(Fa){return this.tIb.kb(Fa)};
B.prototype.lri=function(Fa){var Qb=this;return new Promise(function(cb,Xb){Fa.promise=Qb.hZa.qFf(Fa).then(function(kc){cb(null);return Qb.Jnc(Fa,kc)},function(kc){Xb(null);return Qb.zEb(kc)})})};B.prototype.Gkh=function(Fa,Qb){var cb=this;return new Promise(function(Xb,kc){Fa.promise=Qb.then(function(Wc){cb.ASj(Fa,Wc);return cb.hZa.qFf(Fa).then(function(id){Xb(null);return cb.Jnc(Fa,id)},function(id){kc(null);return cb.zEb(id)})},function(Wc){return cb.zEb(Wc)})})};B.prototype.Jnc=function(Fa,Qb){Fa.Bdf&&
(this.YXg(Fa.zNa),this.zMd(Fa,Qb));return this.R1i(Qb)};B.prototype.YXg=function(Fa){this.tIb.remove(Fa)};B.prototype.zMd=function(Fa,Qb){var cb=this.zWh();Fa.zNa===cb&&this.hZa.zMd(Fa.destination,Qb,Fa.item.type)};B.prototype.zWh=function(){var Fa=ma.g(this.$).ha.Oa.activeFloatingObjectControlId;Fa||(Fa=nb.v(ma.g(this.$).ha.sa.activeCell,this.$),Fa=Fa.FirstRow+"_"+Fa.FirstColumn);return Fa};B.prototype.ASj=function(Fa,Qb){Fa.destination=null;Fa.DGe=Qb};Object(W.a)(B,"PasteArtRequestManager",null,
[]);var ef=b(191),Ye=b(122),pe=b(105);Rk(A,M);A.prototype.getSourceItem=function(){Ia.ULS.shipAssertTag(537167896,0,!!this.ha.Oa.activeFloatingObjectControlId,"Expecting a floating object to be currently selected for copy");Ia.ULS.sendTraceTag(537167895,0,50,"ArtCopyPasteHandler.GetSourceItem: Creating ArtSourceItem with FloatingObjectId=[{0}]",this.ha.Oa.activeFloatingObjectControlId);return new ba(this.ha.Oa.activeFloatingObjectControlId,this.$.ea.pa.sheetName,this.$.ea.Ve,this.$.ya.UserSessionId,
this.ha.Oa.Yb.floatingObject.type)};A.prototype.beforeSerialize=function(Fa){Fa&&Fa.commandParameters?(Fa?(Fa.isAsyncCopy=!1,Fa.isSelectionAllowed=!1,Fa.isFromCache=!1,Fa.plainTextPayloadSize=0,Fa.shadowWorkbookPayloadSize=0,Fa.htmlPayloadSize=0,Fa.htmlSizeExceedsLimit=!1,Fa.clientSideCopyTime=0,Fa.encounteredDeploymentErrors=!1,Fa.shadowWorkbookSizeExceedsLimit=!1,Fa.originalSourceRangesCountExceedsLimit=!1,Fa.copyTotalSizeExceedsLimit=!1):Ia.ULS.sendTraceTag(537167826,0,10,"CommonCopyPasteUtils.InitializeCopyContext: copyContext is null."),
Fa.commandParameters.copyPasteTargetType=2):Ia.ULS.sendTraceTag(537167894,0,10,"ArtCopyPasteHandler.BeforeSerialize: copyContext or copyContext.CommandParameters is null.")};A.prototype.serialize=function(Fa){var Qb=Fa.sourceItem,cb={};if(!Qb)return Ia.ULS.sendTraceTag(537167893,0,10,"ArtCopyPasteHandler.Serialize: artSourceItem should not be null"),cb;if(!this.ani())return Ia.ULS.sendTraceTag(36824456,0,50,"ArtCopyPasteHandler.Serialize: Unsupported floating object type. This will clear the clipboard"),
cb;Ia.ULS.sendTraceTag(537167892,0,50,"ArtCopyPasteHandler.Serialize: Serializing ArtSourceItem with FloatingObjectId=[{0}]",Qb.activeFloatingObjectControlId);this.DDd();var Xb=this.m2c.getValue(Qb);if(Xb)cb.synchronousResult=Xb,Fa.isFromCache=!0,Fa.isAsyncCopy=!1,Fa.clientSideCopyTime=Fa.commandParameters.stopwatch.qc,1===Fa.commandParameters.commandType&&this.$.Fd(2045211913,Fa.commandParameters.ribbonCommandInfo.method,Fa.commandParameters.ribbonCommandInfo.Me,null);else{Fa.isFromCache=!1;Fa.isAsyncCopy=
!0;Xb=this.s$.create();if(Fa.commandParameters.uploadToClipService){var kc={};kc["data-clipservice-ccpid"]=Fa.commandParameters.id;kc["data-pkey"]=Fa.commandParameters.pKey;kc["data-clipservice-type"]=Fa.commandParameters.clipServiceDataType;kc["data-clipservice-count"]=Fa.commandParameters.objectCount.toString();kc["data-clipservice-dc"]=Fa.commandParameters.clipServiceDataCenter;kc["data-clipservice-client"]=this.UYg;kc["data-TimeStamp"]=(new Date).toUTCString();kc["data-clipservice-version"]=this.VYg;
Xb.setItem(la.KHg,JSON.stringify(kc))}cb.synchronousResult=this.iBg(Xb);cb.asynchronousResult=this.Ncd(Fa,Qb,Xb)}Fa.syncClipboardItemsKeys=ha(cb.synchronousResult);return cb};A.prototype.iBg=function(Fa){Ia.ULS.shipAssertTag(537167891,0,!!this.ha.Oa.Yb,"Expecting a floating object to be currently selected for copy");Fa||(Fa=this.s$.create());var Qb=this.ha.Oa.Yb.mub();Qb&&(Qb=String.format("<img src='{0}'>",Qb),Fa.setItem(la.html,Qb));return Fa};A.prototype.DDd=function(){var Fa=this.ha.Oa.Yb;this.Wnb.DDd(Ye.a.Xpb(Fa.floatingObject),
Ye.a.XYg(Fa.Rt))};A.prototype.shouldWaitForCopyToComplete=function(){Ia.ULS.sendTraceTag(537167890,0,50,"ArtCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0};A.prototype.onDeferredPasteStarted=function(Fa){this.wU.onDeferredPasteStarted(Fa)};A.prototype.onDeferredPasteCompleted=function(Fa){this.wU.onDeferredPasteCompleted(Fa)};A.prototype.deserialize=function(Fa){var Qb=Ka(Fa),cb=null,Xb=null,kc=!1;if(!Qb){cb=Fa.copyContextSnapshot;Xb=cb.sourceItem;if(!Xb)return Promise.reject(new eb.a(10));
kc=Xb.isFromCurrentSession(this.$)}var Wc=this.Heg(Fa,!0);if(0!==Wc)return Promise.reject(new eb.a(Qb?18:kc?19:20,void 0,void 0,void 0,Wc));if(Qb)return this.opc(Fa);if(!kc&&!A.dgi(Xb))return Fa=String.format("User attempted to paste art of type [{0}] between sessions.",Xb.type),Ia.ULS.sendTraceTag(537167889,0,50,Fa),Promise.reject(new eb.a(11,void 0,void 0,Fa));if(cb.isAsyncSerializeFailed)return Promise.reject(new eb.a(16,void 0,void 0,"Last async serialize failed, therefore no current shadow workbook payload to paste"));
try{var id=Fa.clipboardItems.getItem(la.iO);var Vc=JSON.parse(id)}catch(td){return Ia.ULS.sendTraceTag(537167888,0,10,"ArtCopyPasteHandler.Deserialize: Failed to parse shadow workbook JSON with exception: {0}",copyPasteInfra.getStringifiedError(td)),Promise.reject(new eb.a(12,void 0,td))}Vc.floatingObjectId!==Xb.activeFloatingObjectControlId?Ia.ULS.sendTraceTag(537167887,0,10,"ArtCopyPasteHandler.Deserialize: FloatingObjectId mismatch! Deserializing with artSourceItem.ActiveFloatingObjectControlId=[{0}], shadowWorkbookPayload.FloatingObjectId=[{1}]",
Xb.activeFloatingObjectControlId,Vc.floatingObjectId):Ia.ULS.sendTraceTag(537167886,0,50,"ArtCopyPasteHandler.Deserialize: Deserializing with artSourceItem.ActiveFloatingObjectControlId=[{0}], shadowWorkbookPayload.FloatingObjectId=[{1}]",Xb.activeFloatingObjectControlId,Vc.floatingObjectId);if(!Vc||!Vc.shadowWorkbookBase64)return Promise.reject(new eb.a(13,void 0,void 0,String.format("shadowWorkbookPayload is null = {0}",!Vc)));Fa.isShadowWorkbookParsedSuccessfully=!0;Fa.shadowWorkbookPayloadSize=
F(Vc);Fa.shadowWorkbookSizeExceedsLimit=T(Vc);Fa.payloadOrigin=kc?K.uUf:K.GEe;Fa.payloadType=da.lig;if(T(Vc))return Fa=String.format("Shadow workbook size [{0}] is over the limit [{1}]. ShadowWorkbookSizeExceedsLimit: {2}",Fa.shadowWorkbookPayloadSize,yb.a.Gkc,Vc.shadowWorkbookSizeExceedsLimit),Ia.ULS.sendTraceTag(36304156,0,15,"ArtCopyPasteHandler.Deserialize: {0}",Fa),Promise.reject(new eb.a(1,void 0,void 0,Fa));cb=Qb=null;ma.g(this.$).ha.Qe&326?cb=ma.g(this.$).ha.Oa.activeFloatingObjectControlId:
Qb=this.$.pa&&this.$.pa.activeCell?nb.v(this.$.pa.activeCell,this.$):nb.v(nb.K(Fa.commandParameters.originalDestinations),this.$);kc=null;if(this.Wnb.t1f(Xb))try{kc=this.Wnb.i6c()}catch(td){Ia.ULS.sendTraceTag(537167885,0,10,"ArtCopyPasteHandler.Deserialize: Exception encountered while performing client-side estimation. Exception: {0}",copyPasteInfra.getStringifiedError(td))}return this.iXi.z3h(new y(Fa.commandParameters.ribbonCommandInfo,Qb,cb,Fa.commandParameters.commandType,[Fa.commandParameters.stopwatch],
Vc,Xb,Fa,kc))};A.prototype.opc=function(Fa){Fa.wasLastCopyExternal=!0;if(Fa.clipboardItems.getItem("image/png")){var Qb=Fa.commandParameters.stopwatch.qc;Fa.payloadType=da.YNg;var cb={};return Sa.b(this.$.Fd(1403967063,Fa.commandParameters.ribbonCommandInfo.method,Fa.commandParameters.ribbonCommandInfo.Me,(cb.dataUrl=Fa.clipboardItems.getItem("image/png"),cb))).then(function(Xb){Fa.serverRequestTimeInMs=Fa.commandParameters.stopwatch.qc-Qb;return Xb?Promise.resolve(null):Promise.reject(new eb.a(15))},
function(){Fa.serverRequestTimeInMs=Fa.commandParameters.stopwatch.qc-Qb;return Promise.reject(new eb.a(15))})}Ia.ULS.shipAssertTag(537167884,0,!1,"Should not paste external content that is not image via ArtCopyPasteHandler");return M.prototype.opc.call(this,Fa)};A.prototype.ani=function(){var Fa=ma.g(this.$).ha;return Fa.Oa.activeFloatingObjectControlId&&Fa.Oa.Yb&&Fa.Oa.Yb.floatingObject?Fa.Oa.Yb.floatingObject.NTd():!1};A.prototype.Ncd=function(Fa,Qb,cb){var Xb=this;return new Promise(function(kc,
Wc){var id=Fa.commandParameters.stopwatch.qc;Ia.ULS.sendTraceTag(41562516,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data...");Xb.hZa.n3g(new x(Qb.activeFloatingObjectControlId,Fa.commandParameters,function(Vc){Fa.requestTelemetryData=Vc.RequestTelemetryData;Fa.serverRequestTimeInMs=Fa.commandParameters.stopwatch.qc-id;if(Pb.a.Rg(Vc.Errors))Pb.a.Tga(Vc.Errors)?(Fa.encounteredDeploymentErrors=!0,Ia.ULS.sendTraceTag(537167879,0,15,"ArtCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",
Pb.a.Dc(Vc.Errors))):(Ia.ULS.sendTraceTag(36229122,0,10,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}",Pb.a.Dc(Vc.Errors)),Wc(new G(4,Vc.Errors)));else if(Ia.ULS.sendTraceTag(537167883,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeeded for FloatingObjectId=[{0}].",Qb.activeFloatingObjectControlId),Fa.markForCancellation)Wc(new G(3,Vc.Errors));else{Pb.a.Xq(Vc.Errors)&&Ia.ULS.sendTraceTag(537167882,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: Server messages present. Errors: {0}",
Pb.a.Dc(Vc.Errors));var td=Vc.Result;if(td){td=Xb.dEe(td);td.floatingObjectId=Qb.activeFloatingObjectControlId;Fa.shadowWorkbookPayloadSize=F(td);Fa.shadowWorkbookSizeExceedsLimit=T(td);try{var rd=JSON.stringify(td)}catch(za){Wc(new eb.a(14,void 0,za,String.format("Failed to stringify shadow workbook: copyContext.ShadowWorkbookPayloadSize: [{0}], shadowWorkbookPayload.FloatingObjectId: [{1}]",Fa.shadowWorkbookPayloadSize,td.floatingObjectId)));return}Ia.ULS.shipAssertTag(537167881,0,!!cb,"Expecting syncClipboardItems to be defined");
cb.setItem(la.iO,rd);1===Fa.commandParameters.commandType&&(Xb.w_i(Qb.type,Qb.activeFloatingObjectControlId,Vc.StateId),Xb.deleteFloatingObject(Qb.activeFloatingObjectControlId,Qb.type));Xb.m2c.setValue(Qb,cb);Fa.asyncClipboardItemsKeys=ha(cb);kc(cb)}else Ia.ULS.sendTraceTag(537167880,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: Result form server returned null, copied item id: {0}",Qb.activeFloatingObjectControlId),kc(Xb.m2c.getValue(Qb))}},Fa.commandParameters.commandType,Qb.type,function(Vc){Fa.serverRequestTimeInMs=
Fa.commandParameters.stopwatch.qc-id;Vc=Gc.a.Of(Vc.data);1===Fa.commandParameters.commandType&&Xb.hZa.sOj(Qb.type,Qb.activeFloatingObjectControlId);Ia.ULS.sendTraceTag(537167878,0,10,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}",Pb.a.Dc(Vc));Wc(new G(4,Vc))},[Fa.commandParameters.stopwatch]))})};A.prototype.deleteFloatingObject=function(Fa,Qb){Fa=ef.a.$y(Qb,Fa);if(Fa=pe.a(this.$).rq(Fa))pe.a(this.$).deleteFloatingObject(Fa,14,!0),ma.g(this.$).ha.Oa.sC=
null};A.prototype.w_i=function(Fa,Qb,cb){var Xb=this.$.da.za(277);if(Xb){var kc=null;Fa=ef.a.$y(Fa,Qb);Fa=pe.a(this.$).rq(Fa);if(null===Fa||void 0===Fa?0:Fa.Ji)kc=Fa.Ji.block;if(kc){var Wc=Fa.floatingObject.Hg();Xb.CYb(function(){return!kc.Mi.kb(Wc)},cb,"CutArt")}}};A.dgi=function(Fa){return 1===Fa.type||5===Fa.type};Object(W.a)(A,"ArtCopyPasteHandler",M,[]);var Qd=b(54);Rk(v,Q);Object(W.a)(v,"MacroRecorderPasteArtPayload",Q,[]);r.prototype.T8h=function(Fa,Qb,cb,Xb,kc,Wc,id){var Vc=this;Wc=void 0===
Wc?null:Wc;id=void 0===id?null:id;var td=this.$.oa.xa.Pb(),rd=null,za={CopyPasteTargetType:2};za.FloatingObjectId=Fa;za.CopyOperationId=cb.id;cb.floatingObjectType=Qb;za.UploadToClipService=cb.uploadToClipService;za.PKey=cb.pKey;za.ClipServiceDataCenter=cb.clipServiceDataCenter;var tb=0;2===kc?(kc=505,tb=16,rd=function(Wb,fc,xc){return ea(Vc.$.oa.xa,za,ed.b(Wb,Xb),Wc?ed.a(fc,Wc):fc,xc,cb.ribbonCommandInfo,td,id)}):(kc=179,rd=function(Wb,fc,xc){Vc.Igh(Qb,Fa);Vc.$.ry();var Yb=Vc.$.oa.xa;Wb=ed.b(Wb,
Xb);fc=Wc?ed.a(fc,Wc):fc;var Ec=cb.ribbonCommandInfo,bd=id;bd=void 0===bd?null:bd;var Ic=Yb.Na(1,void 0===td?null:td);Ic.copyParameters=za;return ub.g(Yb,"Cut",Ic,Wb,fc,xc,Ec,0,bd)});Db.EwaSettings.Zb()?this.$.userOperationManager.Sb(new Ac.a(kc,0,rd,tb|64),cb.ribbonCommandInfo):this.$.userOperationManager.Sb(new ic.a(kc,0,rd,tb),cb.ribbonCommandInfo)};r.prototype.Igh=function(Fa,Qb){var cb=ef.a.$y(Fa,Qb);(cb=pe.a(this.$).rq(cb))?(ma.g(this.$).ha.Oa.PG(cb),cb.isVisible=!1):Ia.ULS.sendTraceTag(537167876,
0,50,"ArtCopyPasteUtils.DoCutClientEstimation: floatingObjectcontrol is null. FloatingObjectType : {0}, FloatingObjectId: {1}",Fa,Qb)};r.prototype.sOj=function(Fa,Qb){Fa=ef.a.$y(Fa,Qb);if(Fa=pe.a(this.$).rq(Fa))Fa.isVisible=!0};r.prototype.n3g=function(Fa){this.T8h(Fa.floatingObjectId,Fa.l3g,Fa.commandParameters,Fa.ot,Fa.Nah,Fa.laa,Fa.pOb)};r.prototype.s9h=function(Fa,Qb,cb,Xb,kc,Wc,id,Vc,td){var rd=this;Vc=void 0===Vc?null:Vc;td=void 0===td?!0:td;return new Promise(function(za,tb){var Wb=Wc.commandParameters.stopwatch.qc;
rd.VMd(Fa,kc,Qb,cb,function(fc){Wc.requestTelemetryData=fc.RequestTelemetryData;Wc.serverRequestTimeInMs=Wc.commandParameters.stopwatch.qc-Wb;if(Pb.a.Tga(fc.Errors))Wc&&(Wc.encounteredDeploymentErrors=!0),Ia.ULS.sendTraceTag(537167875,0,15,"ArtCopyPasteUtils.PasteArt: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",Pb.a.Dc(fc.Errors));else if(Pb.a.Rg(fc.Errors))Ia.ULS.sendTraceTag(36459652,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: {0}",
Pb.a.Dc(fc.Errors)),tb(new eb.a(9,fc.Errors));else if(fc.Result){var xc=fc.Result;Ia.ULS.sendTraceTag(537167874,0,50,"ArtCopyPasteUtils.PasteArt: PasteArt succeeded.");rd.L_i(id,xc.FloatingObjectId,fc.StateId);za(r.bkd(xc.FloatingObjectId))}else Ia.ULS.sendTraceTag(537167873,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed, result returned from server is null."),tb(new eb.a(9,fc.Errors))},function(fc){Wc.serverRequestTimeInMs=Wc.commandParameters.stopwatch.qc-Wb;fc=Gc.a.Of(fc.data);Ia.ULS.sendTraceTag(537167872,
0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: {0}",Pb.a.Dc(fc));tb(new eb.a(9,fc))},Xb,Vc,td)})};r.prototype.L_i=function(Fa,Qb,cb){var Xb=this,kc=this.$.da.za(277);if(kc){var Wc=ef.a.$y(Fa,r.bkd(Qb));kc.CYb(function(){return!!pe.a(Xb.$).rq(Wc)},cb,"PasteArt")}};r.prototype.YWd=function(Fa,Qb){Qb&&this.Wnb.YWd(Fa,ef.a.$y(Fa.type,Qb))};r.prototype.qFf=function(Fa){var Qb=this;return this.s9h(Fa.ribbonCommandInfo,Fa.destination,Fa.DGe,Fa.pOb,Fa.w0,Fa.pasteContext,Fa.item.type,Fa.tye,Fa.item.isFromCurrentSession(this.$)).then(function(cb){return cb},
function(cb){Qb.YWd(Fa.item,Fa.tye);return Promise.reject(cb)})};r.prototype.zMd=function(Fa,Qb,cb){Fa||(Fa=nb.v(ma.g(this.$).ha.sa.activeCell,this.$));ma.g(this.$).uhc(nb.D(Fa),1)?pe.a(this.$).bna(cb,Qb,!0):ma.g(this.$).ha.Oa.xsa(Fa,Qb,cb).continueWith(function(Xb){Xb.result?Ia.ULS.sendTraceTag(537167843,5,50,"ArtCopyPasteUtils.SelectPastedObject: Selection succeeded in async manner for object ID [{0}]",Qb):Ia.ULS.sendTraceTag(537167842,5,10,"ArtCopyPasteUtils.SelectPastedObject: Selection failed in async manner for object ID [{0}]",
Qb)})};r.prototype.VMd=function(Fa,Qb,cb,Xb,kc,Wc,id,Vc,td){function rd(){if(td){var xc=Qd.a.Vh(Qd.a.xc(fc));xc.FloatingObjectId=Qb.floatingObjectId;fc.DestinationRanges||(xc.DestinationRanges=nb.p(tb.$.va.pa.sheetName,"",0,0,0,0));return new v(xc,td,0,0)}return new v(fc,td,0,0)}function za(xc,Yb,Ec){Vc||tb.$.ry();return Z(tb.$.oa.xa,fc,ed.b(xc,kc),ed.a(Yb,Wc),Ec,null,Wb,id)}var tb=this;td=void 0===td?!0:td;var Wb=this.$.oa.xa.Pb(),fc={};fc.ShadowWorkbookBase64=Qb.shadowWorkbookBase64;fc.FloatingObjectId=
Xb;fc.DestinationRanges=cb?nb.s(cb):null;fc.CopyPasteTargetType=2;fc.ClientEstimationFloatingObjectId=Vc;cb=Db.EwaSettings.Zb()?new Ac.a(503,0,za,void 0,rd):new ic.a(503,0,za,void 0,rd);cb.flags=Db.EwaSettings.Zb()?65:1;this.$.userOperationManager.Sb(cb,Fa)};r.bkd=function(Fa){return String.format("{0}.{{{1}}}",Fa.length+2,Fa.toUpperCase())};Object(W.a)(r,"ArtCopyPasteUtils",null,[763]);var fe=b(226);z.prototype.DDd=function(Fa,Qb){this.Usa=Fa;this.k2c=Qb};z.prototype.i6c=function(){if(!this.Usa||
!this.k2c)return Ia.ULS.sendTraceTag(537167841,0,15,"ArtPasteClientEstimation.DoPasteClientEstimation: copiedFloatingObjectControl and/or copiedEffectsExtents is null, aborting client side estimation."),"";var Fa=Ye.a.Xpb(new ef.a(this.Usa));Fa.Id=r.bkd(Kb.a.create().toString());Fa.Version=-1;Fa.Name="";Fa.IsClientEstimation=!0;var Qb=this.H$h(Fa);if(!Qb)return null;var cb=new ef.a(Fa);Qb.block.Mi.add(cb);cb.yIb();var Xb=pe.a(this.$);Xb.a4b(cb,Qb);Qb=Xb.rq(ef.a.xPh(Fa));!Qb||Qb.floatingObject.WLa||
Qb.floatingObject.sMa||Qb.gRa(this.k2c);Xb.bna(Fa.Type,Fa.Id,!0);return Fa.Id};z.prototype.t1f=function(Fa){return Db.EwaSettings.ma(223)&&Fa.isFromCurrentSession(this.$)&&!ma.g(this.$).rtl&&!ma.g(this.$).eb.Ni};z.prototype.YWd=function(Fa,Qb){this.t1f(Fa)&&(Fa=pe.a(this.$).rq(Qb))&&(Ia.ULS.sendTraceTag(537167840,5,50,"ArtPasteClientEstimation.UndoPasteClientEstimation: undoing client-side estimation. Removing floating object with ID: [{0}] of type [{1}]",Qb,Fa.floatingObject.type),pe.a(this.$).deleteFloatingObject(Fa,
15,!0),Fa.Ji&&Fa.Mab(Fa.Ji,!1))};z.prototype.H$h=function(Fa){if(!Fa)return Ia.ULS.sendTraceTag(537167839,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: Called with null FloatingObjectData."),null;if(ma.g(this.$).ha.Oa.activeFloatingObjectControlId){var Qb=ma.g(this.$).ha.Oa.sC.floatingObject;Fa.OriginDeltaX=Qb.offsetX+this.p$a;Fa.OriginDeltaY=Qb.offsetY+this.p$a;Fa.AbsoluteLeft+=this.p$a;Fa.AbsoluteTop+=this.p$a;Fa.AbsoluteRight+=this.p$a;Fa.AbsoluteBottom+=this.p$a;Fa.ZOrder=Qb.By+
1;return ma.g(this.$).ha.Oa.sC.Ji}if(!this.$.pa||!this.$.pa.activeCell)return Ia.ULS.sendTraceTag(537167838,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: ActiveItem/ActiveCell is null - cannot perform estimation for grid paste."),null;var cb=this.$.pa.activeCell;Qb=ma.g(this.$).Y0(cb);if(!Qb)return Ia.ULS.sendTraceTag(537167837,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: gridViewBlock for range {0} is null.",cb.toString()),null;var Xb=Ya.HelperMethods.wvb(Qb.domElement,
Qb.oj.domElement);cb=Qb.gridView.gg(cb,2);if(!Xb||!cb)return Ia.ULS.sendTraceTag(537167836,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: blockPositionRelativeToGridOrigin is null: {0}. cellPositionRelativeToGridOrigin is null: {1} .",!Xb,!cb),null;Fa.OriginDeltaX=cb.topLeft.x-Xb.x;Fa.OriginDeltaY=cb.topLeft.y-Xb.y;Fa.AbsoluteLeft=cb.topLeft.x;Fa.AbsoluteTop=cb.topLeft.y;Fa.AbsoluteRight=Fa.AbsoluteLeft+Math.abs(this.Usa.AbsoluteRight-this.Usa.AbsoluteLeft);Fa.AbsoluteBottom=Fa.AbsoluteTop+
Math.abs(this.Usa.AbsoluteBottom-this.Usa.AbsoluteTop);Fa.ZOrder=this.Usa.ZOrder+100;return new fe.a(Qb.gridView.Ea.il(Qb.hashCode),Qb.hashCode)};Object(W.a)(z,"ArtPasteClientEstimation",null,[761]);n.prototype.create=function(){var Fa=window.clipboardPlatform;return Fa?Fa.createClipboardItems():null};Object(W.a)(n,"ClipboardItemsFactory",null,[762]);w.undefined="Undefined";Object(W.a)(w,"CCPTelemetryConsts",null,[]);f.cells="Cells";f.floatingObject="FloatingObject";f.unknown="Unknown";Object(W.a)(f,
"ActiveSelection",null,[]);m.Ufh="DisplayNotInvoked";m.a6c="Displayed";m.W_i="PrerequisitesNotReady";Object(W.a)(m,"PasteIndicationDisplayStatus",null,[]);var Hc=b(110);l.prototype.getCopyFlowHandler=function(Fa){var Qb=this.sLh(ma.g(this.$).Qe);Fa.commandParameters.copyPasteHandlerName=Qb.name;return Qb};l.prototype.getPasteFlowHandler=function(Fa){var Qb=Fa.copyContextSnapshot;Qb=Na(Fa)?this.EWc:Ka(Fa)?this.GFd:(null===Qb||void 0===Qb?0:Qb.sourceItem)&&Object.getType(Qb.sourceItem)===ba?this.EWc:
this.GFd;Fa.commandParameters.copyPasteHandlerName=Qb.name;return Qb};l.prototype.initializePasteContext=function(Fa){if(Fa&&(Fa.isSameSession=!1,Fa.isShadowWorkbookParsedSuccessfully=!1,Fa.pasteResult=w.undefined,Fa.payloadOrigin=w.undefined,Fa.payloadType=w.undefined,Fa.encounteredDeploymentErrors=!1,Fa.shadowWorkbookSizeExceedsLimit=!1,Fa.originalSourceRangesCountExceedsLimit=!1,Fa.activeSelectionType=this.eHh(),Fa.indicationDisplayScheduled=!1,Fa.pasteDestinationHasMergedCells=!1,Fa.pasteIndicationDisplayStatus=
m.Ufh,Fa.copyContextSnapshot)){var Qb=Fa.copyContextSnapshot,cb=ra(Qb.sourceItem),Xb=Qb.sourceItem;var kc=!!Xb&&Object.getType(Xb)===ba;Xb=0;var Wc=!1;cb?(Wc=Qb.sourceItem,Fa.isSameSession=Wc.isFromCurrentSession(this.$),Xb=1,Wc=this.nki(Wc,Fa)):kc&&(Fa.isSameSession=Qb.sourceItem.isFromCurrentSession(this.$),Xb=2);if(Fa.copyContextSnapshot.commandParameters){kc=-1985798686===Qb.commandParameters.ribbonCommandInfo.command;var id=Fa.commandParameters;var Vc=this.$;Qb?Vc&&Vc.ya?Qb=Qb.sessionId===Vc.ya.UserSessionId:
(Ia.ULS.shipAssertTag(537166211,0,!1,"ewaControl shouldn't be null"),Qb=!1):(Ia.ULS.shipAssertTag(537166212,0,!1,"copyContext shouldn't be null"),Qb=!1);id.clearSystemClipboard=Qb&&kc&&cb&&!Wc;Fa.commandParameters.copyPasteTargetType=Xb}}};l.prototype.getSessionId=function(){return this.$.ya.UserSessionId};l.prototype.nki=function(Fa,Qb){var cb=Hc.b(Fa.ranges,function(Xb){return Xb.Ue})&&Hc.b(Qb.commandParameters.originalDestinations,function(Xb){return 1!==Xb.top});return Hc.b(Fa.ranges,function(Xb){return Xb.isRow})&&
Hc.b(Qb.commandParameters.originalDestinations,function(Xb){return 1!==Xb.left})||cb};l.prototype.sLh=function(Fa){switch(Fa){case 1:return this.GFd;case 64:case 4:case 2:case 256:return this.EWc;default:throw Error.invalidOperation("Unsupported selection");}};l.prototype.eHh=function(){return ma.g(this.$).ha.Qe&470?f.floatingObject:1===ma.g(this.$).ha.Qe?f.cells:f.unknown};l.prototype.getDialogResponse=function(){};Af.Object.defineProperties(l.prototype,{GFd:{configurable:!0,enumerable:!0,get:function(){if(!this.QOc){var Fa=
this.$.da.za(254,!0);Fa&&(this.QOc=new C(this.$,Fa,new n))}return this.QOc}},EWc:{configurable:!0,enumerable:!0,get:function(){if(!this.MEc&&this.$.da.za(254,!0)){var Fa=new z(this.$);this.MEc=new A(this.$,new n,new r(this.$,Fa),Fa)}return this.MEc}}});Object(W.a)(l,"ExcelCopyPasteApplicationHost",null,[705]);var ud=b(162),Gd=qb.a;Rk(k,Gd);k.prototype.sg=function(Fa){this.Mo=new ud.a;var Qb=dc.a.instance.ga(16);Fa=this.DM(Fa);this.initializeAndShow(Qb,this.Dbi,Fa)};k.prototype.DM=function(Fa){var Qb=
{};return Qb[k.Yv]=this.nc,Qb[k.Qli]=Fa,Qb};Af.Object.defineProperties(k.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"InsertCopiedCutCellsDialog"}}});k.dfh="direction";k.Qli="isRtl";var jd={};k.efh=(jd.Vertical=1,jd.Horizontal=0,jd);Object(W.a)(k,"InsertCopiedCutCellsDialog",qb.a,[]);e.prototype.c4b=function(Fa,Qb){return(new k(Fa,Qb)).Mo.task};Object(W.a)(e,"InsertCopiedCutCellsDialogFactory",null,[703]);var Sd=b(90),Wd=b(47),Le=b(44);d.prototype.HIe=function(){var Fa=this;
this.bqc||(Ia.ULS.sendTraceTag(537167680,0,50,"PasteIndicationManager.DownloadPrerequisitesIfNeeded: Trying to get appChrome"),this.gridView.$.eB(function(Qb){Qb.gja(0).then(function(){Fa.bqc=!0})}))};d.prototype.okj=function(Fa){var Qb=this,cb=Fa.commandParameters.id;Ia.ULS.sendTraceTag(537167651,0,50,"PasteIndicationManager.ScheduleDisplay: pasteCommandId = {0}, cancelCtx is null = {1}, PrerequisitesDownloaded = {2}",cb,!this.Js,this.bqc);this.HIe();this.c5b=cb;cb=!this.brf();if(!this.Js||cb)this.Lve(),
this.Js=Wd.a.instance.create(function(){Qb.Tfh(Fa)},void 0===Fa.timeoutToShowSpinnerInMs||null===Fa.timeoutToShowSpinnerInMs?100:Fa.timeoutToShowSpinnerInMs,Le.a.nXi);this.e2=Fa.commandParameters.originalDestinations};d.prototype.Tfh=function(Fa){this.bqc?(this.display(Fa.commandParameters.originalDestinations),Fa.pasteIndicationDisplayStatus=m.a6c):(Ia.ULS.sendTraceTag(537167650,0,50,"PasteIndicationManager.DisplayIfPossible: Prerequisites were not ready, skipping display"),this.hide(),Fa.pasteIndicationDisplayStatus=
m.W_i)};d.prototype.display=function(Fa){Ia.ULS.sendTraceTag(537167649,0,50,"PasteIndicationManager.Display: started");this.gridView.qb.Lw(fd.a.I7(Fb.d(this.gridView.$.pa),Fa),d.ppc,!0);this.gridView.qb.qn(d.ppc)};d.prototype.Oid=function(Fa){Ia.ULS.sendTraceTag(537167648,0,50,"PasteIndicationManager.HideForPasteId: pasteCommandId = {0}, currentPasteCommandId = {1}",Fa,this.c5b);Fa&&kb.a.equals(Fa,this.c5b,!1)&&this.hide()};d.prototype.hide=function(Fa){this.e2&&(void 0===Fa?0:Fa)&&this.brf()&&Ia.ULS.sendTraceTag(537167647,
0,15,"PasteIndicationManager.Hide: Triggered by a SelectionChanged event while indication is (or will be) active but active range did not change");this.c5b="";this.Lve();this.e2=null;this.gridView.qb.eh(d.ppc);this.gridView.qb.Wi(null,d.ppc)};d.prototype.brf=function(){return nb.Q(this.gridView.ha.sa.selectedRanges,this.e2)};d.prototype.Lve=function(){this.Js&&(Sd.a.Ia(this.Js),this.Js=null)};d.prototype.dispose=function(){this.hide();this.gridView.ha.EF(this.X6e)};d.ppc=[30];Object(W.a)(d,"PasteIndicationManager",
null,[704,10]);var Pd=b(1184),Re=b(53),Qe=mb.a;Rk(c,Qe);c.prototype.create=function(){var Fa=this,Qb=Re.a.KV([73,74],4,this.hb,void 0,void 0,void 0,c.hAa),cb=pa.GetServiceTaskFactory.create(this.$.da,18,this.$.la,this.hb);Ab.TaskExtensions.Ba(Ab.TaskExtensions.Wd([cb,Qb],this.la),function(){var Xb=new Pd.a,kc=null;Fa.Q0g(Xb).then(function(Wc){kc=Wc.xye;var id=copyPasteInfra.createCopyPasteInfra(kc,new l(Fa.$),Xb,Fa.$);Ia.ULS.shipAssertTag(537167762,0,!!Fa.$.ya,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext should not be null");
Ia.ULS.shipAssertTag(537167761,0,!!Fa.$.ya&&!!Fa.$.ya.DocumentHostInfo,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext.DocumentHostInfo should not be null");var Vc=kc.getMetadataManager();Fa.pb(new fa(Fa.$,Vc,cb.result,id,new O(Fa.$,ma.g(Fa.$)),new e,Fa.$.ya.DocumentHostInfo.UserId,kc.getInitializationError()));Wc.E_a?Ia.ULS.sendTraceTag(41731933,0,50,"CopyPasteInfrastructureFactory.Create: Initialize CCP infra succeed. SliceName={0}, StrategyType={1}, StrategyCapabilities={2}, IsBestStrategyTypeInitialized={3}, InfraLoadTimeMS={4}",
fa.R$b(),Wc.E_a.dataClipboardStrategyType,JSON.stringify(Wc.E_a.dataClipboardCapabilities),Wc.E_a.clipboardStrategiesToInitialize[0].clipboardStrategyType===Wc.E_a.dataClipboardStrategyType,void 0===window.bsqmXLSPageLoadStartTime||null===window.bsqmXLSPageLoadStartTime?"-1":(Date.now()-window.bsqmXLSPageLoadStartTime.getTime()).toString()):Ia.ULS.shipAssertTag(537167760,0,!1,"CopyPasteInfrastructureFactory.Create: initResult.ClipboardPlatformEnvironmentInitializationInfo should not be null")},function(Wc){Ia.ULS.shipAssertTag(38847436,
0,!1,"CopyPasteInfrastructureFactory.Create: error during call to clipboardPlatformEnvironment.Init(). Copy Paste operations will not be available in this session. SliceName: {0} error: {1}",fa.R$b(),Wc?copyPasteInfra.getStringifiedError(Wc):"null")})},this.la,3)};c.prototype.dispose=function(){Qe.prototype.dispose.call(this)};c.prototype.Q0g=function(Fa){var Qb=null,cb=window.clipboardPlatform;cb&&(Qb=cb.getClipboardPlatformEnvironment());if(!Qb)return Ia.ULS.shipAssertTag(537167759,0,!1,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: getClipboardPlatformEnvironment should have returned a valid object"),
Promise.reject(null);cb=this.$.ya;var Xb=[cb.OfficeOnlineChromeExtensionId,cb.ChromeClipboardAccessExtensionId],kc=this.Im.Xa(5),Wc=this.$.Lf.get(57),id=!Wc&&this.$.Lf.get(5),Vc=this.$.ea.ic;Vc&&(Vc.inWebPart||Vc.inViewerFromWebPart||Vc.isDivSyndicated)&&(id=!1);Wc=this.qKh(id,!Wc);Ia.ULS.shipAssertTag(537167758,0,!!cb.DocumentHostInfo,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: bootstrapContext.DocumentHostInfo should not be null");return Qb.init(this.$,Fa,Xb,cb.SharedClipboardHostingApp,
cb.SharedClipboardHostingApps,cb.SharedClipboardHostingEnvironments,cb.SharedClipboardOverrideOrigin,cb.SharedClipboardSchemaVersion,cb.SharedClipboardExpirationInMinutes,cb.ClipboardPromiseTimeoutInMinutes,kc,cb.MachineCluster,new J(this.$),Wc,cb.DocumentHostInfo.UserId,cb.ClipboardTtlInMS,Db.EwaSettings.ma(311),cb.UserSessionId).then(function(td){return Object(La.a)(new qa,{xye:Qb,E_a:td})},function(td){return Promise.reject(td)})};c.prototype.qKh=function(Fa,Qb){var cb=[];Fa&&Qb&&cb.push(this.m$g());
Qb&&(cb.push(this.Q3c(7)),cb.push(this.Q3c(0)));Fa&&cb.push(this.lDe());cb.push({clipboardStrategyType:4});Ia.ULS.sendTraceTag(39978242,0,50,"CopyPasteInfrastructureFactory.GetClipboardStrategiesInitList: create clipboard stratgy initialization list: isBrowserStorageAllowed={0}, isSystemClipboardAllowed={1}, result = {2}",Fa,Qb,cb?cb.join(","):"[]");return cb};c.prototype.lDe=function(){var Fa=this.$.ya,Qb={clipboardStrategyType:5};Qb.sessionId=Fa.UserSessionId;Qb.useSharedClipboardIframe=!0;Qb.sharedClipboardHostingApp=
Fa.SharedClipboardHostingApp;Qb.sharedClipboardHostingApps=Fa.SharedClipboardHostingApps;Qb.sharedClipboardHostingEnvironments=Fa.SharedClipboardHostingEnvironments;Qb.sharedClipboardOverrideOrigin=Fa.SharedClipboardOverrideOrigin;Qb.sharedClipboardSchemaVersion=Fa.SharedClipboardSchemaVersion;Qb.sharedClipboardExpirationInMinutes=Fa.SharedClipboardExpirationInMinutes;Qb.wacCluster=Fa.MachineCluster;return Qb};c.prototype.m$g=function(){var Fa={clipboardStrategyType:6};Fa.localStorageStrategyParameters=
this.lDe();Fa.systemClipboardStrategyParameters=this.Q3c(0);return Fa};c.prototype.Q3c=function(Fa){var Qb={};Qb.clipboardStrategyType=Fa;Qb.skipFilesIfPlainTextExists=!0;return Qb};c.ka=function(Fa){Fa.da.Ga(373,new d(Fa));Fa.da.Ga(c.hAa,new c(Fa))};c.hAa=255;Object(W.a)(c,"CopyPasteInfrastructureFactory",mb.a,[]);var jc=b(11);b.d(D,"a",function(){return a})},1362:function(u,D,b){function a(){Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");c.main()}
function c(){this.fb=null}function d(Qa,S){if(void 0===Qa||null===Qa||void 0===S||null===S)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.ib=Qa;this.Pg=S;this.oQc=this.ie=null}function e(){this.BIe=this.geg=this.Ot=0;this.CIe=this.heg=this.nHa="";this.XQc=this.uea=2}function k(Qa,S){this.NFc=0;this.A2b=null;this.Fib=new v(Qa,S);this.ib=Qa;S=Qa.Wa("HostAuthType");this.fEa=Qa.ra("OcpsIsEnabled")&&Qa.ra("IsO365CommercialHost")&&!(void 0===S||null===S)&&"aad"===S.toLowerCase();
this.ybe=K.b(Qa.Wa("OcpsDefaultSettings")||"{}");this.ujb=this.ebc();S=this.ib.co("ServicesControlsMicrosoftControllerServicesList")?this.ib.gw("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.kRb=new J.a;for(var da=0;da<S.length;da++)this.kRb.add(S[da]);this.fEa&&!Qa.ra("IsAnonymousUser")&&Qa.ra("SideCarIsEnabled")?this.A2b=this.kNj():this.A2b=this.noa(this.fEa,this.Uua("/afhs/CloudPolicySettings.ashx"),Object(C.a)(this,this.CWi,"parseCloudPolicySettingsResponse"));this.A2b.then(function(){return null}).catch(function(xa){B.ULS.sendTraceTag(50622685,
3004,10,JSON.stringify(xa))})}function l(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}function m(){}function f(Qa,S){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=Qa.PolicySettings;Qa=new Date;Qa.setMinutes(Qa.getMinutes()+S);this.ExpirationTime=Qa.getTime()}function w(Qa,S,da,xa,ta){var ab=this;da=void 0===da?null:da;xa=void 0===xa?null:xa;ta=void 0===ta?null:ta;this.jua=this.EVb=this.$de=this.mqa=this.HWb=null;this.Fib=new v(Qa,S);this.ib=Qa;this.Nrg=
Qa.kd("LicensingMaxRetryAttempts",0);this.QKc=Qa.ra("IsO365ConsumerHost");this.PKc=Qa.ra("IsO365CommercialHost");this.kTb=Qa.ra("PremiumUpsellIsEnabled");this.G2d=da;this.hie=xa;this.La=ta;this.lqa=Qa.ra("LicensingIsEnabled");this.fEa=Qa.ra("OcpsIsEnabled")&&this.PKc;this.lSc=Qa.ra("ShowPrivacyDialog")&&!!xa;this.P7d=Qa.ra("IsAnonymousUser");this.e$c=new Promise(function(Na){Na(!1)});this.pBa=new Promise(function(Na){Na(!0)});this.iua=new y.a(x.a.Jk());this.sXb=this.ib.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SupportUserConsentBasedFeaturesInAFH",
!1);this.r$d=this.bRh();this.Eod()&&!this.P7d?(void 0!==M.AFrameworkApplication.ta&&null!==M.AFrameworkApplication.ta&&(this.HWb=M.AFrameworkApplication.ta.tD,void 0!==this.HWb&&null!==this.HWb&&(this.mqa=this.HWb.Lg("WebServiceCall","ApplicationFeatureHelperService"))),this.jua=this.EWd()):this.jua=new Promise(function(Na){Na({})});this.jua.catch(function(Na){B.ULS.sendTraceTag(42513088,3004,10,JSON.stringify(Na))});this.sXb&&(this.kTb=!1,this.isFeatureEnabled("FreemiumUpsell",!0).then(function(Na){ab.kTb=
ab.ib.ra("PremiumUpsellIsEnabled")&&Na;return null}))}function n(Qa,S,da){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=Qa;this.isEnabled=S;this.tierName=da}function z(Qa,S){this.uKj=3E5;if(void 0===Qa||null===Qa||void 0===S||null===S)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.ib=Qa;this.hQb=new y.a(x.a.Jk());this.Fib=new v(Qa,S);void 0!==F.a.Xtd&&null!==F.a.Xtd&&void 0!==F.a.ckc&&null!==F.a.ckc&&0<F.a.ckc&&(Qa=new r,Qa.Token=F.a.Xtd,Qa.ExpirationTime=
F.a.ckc,this.hQb.ia("loki",Qa))}function r(){this.Token=null;this.ExpirationTime=0}function v(Qa,S){this.ib=Qa;this.Pg=S}function A(){this.message=null;this.Zdc=0}u=b(0);var B=b(15),y=b(894),x=b(616),C=b(83),G=b(85),E;(function(Qa){Qa[Qa.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";Qa[Qa.cloudPolicySettings=1]="cloudPolicySettings";Qa[Qa.alternateAuthToken=2]="alternateAuthToken"})(E||(E={}));Object(u.b)("ApplicationFeatureHelperRequestType",E);Object(u.a)(A,"HttpRequstToPromiseRejectData",
null,[]);var I=b(99),U=b(247);v.prototype.f3c=function(Qa,S,da,xa,ta,ab,Na,Ka){var la=this;xa=void 0===xa?null:xa;ta=void 0===ta?null:ta;ab=void 0===ab?null:ab;Na=void 0===Na?null:Na;Ka=void 0===Ka?null:Ka;var Ea=E[da],ra=Ea+"RequestFailure";I.Health.instance.recordKpiUsage(ra,0,"jpittsdirects",null);return new Promise(function(na,ba){B.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",Ea);var sa=null!=Na?Na:la.ib.kd("ApplicationFeatureHelperRequestQueueTimeout",
15E3),ya=null!=Ka?Ka:la.ib.kd("ApplicationFeatureHelperRequestSentTimeout",3E4);la.Pg.z9(Qa,1,null,la.HPh(da,xa),ab,!1,1,function(va){B.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",Ea);try{if(void 0===va||null===va||void 0===va.data||null===va.data||void 0===va.data.Ud||null===va.data.Ud){I.Health.instance.recordKpiFailure(ra,"Invalid RequestSucceededEventArgs",!1,!0,null);var W=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",
Ea);ba(la.Lvb(W,va))}else if(va.data.httpStatus!==U.a.TO){I.Health.instance.recordKpiFailure(ra,"HttpStatusCode_"+va.data.httpStatus.toString(),!1,!0,null);var La=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",va.data.httpStatus,Ea);ba(la.Lvb(La,va))}else{void 0!==ta&&null!==ta&&void 0!==va.data.responseHeaders&&null!==va.data.responseHeaders&&ta(va.data.responseHeaders);var Ia=
S(va.data.Ud);if(Ia)B.ULS.sendTraceTag(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",Ea),na(Ia);else{I.Health.instance.recordKpiFailure(ra,"Parse Failure",!1,!0,null);var mb=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",Ea);ba(la.Lvb(mb,va))}}}catch(fb){I.Health.instance.recordKpiFailure(ra,"Unexpected Failure",!1,!0,null),W=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",
fb,Ea),ba(la.Lvb(W,va))}},function(va){B.ULS.sendTraceTag(50622691,3004,10,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} failed.",Ea);if(va.data){I.Health.instance.recordKpiFailure(ra,"HttpStatusCode_"+va.data.httpStatus.toString(),!1,!0,null);var W=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",va.data.httpStatus,va.data.Ud||"No Data",Ea)}else I.Health.instance.recordKpiFailure(ra,
"Invalid RequestFailedEventArgs",!1,!0,null),W=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",Ea);ba(la.Lvb(W,va))},null,void 0,void 0,sa,ya)})};v.prototype.Lvb=function(Qa,S){var da=new A;da.message=Qa;da.Zdc=S&&S.data?S.data.httpStatus:-1;return da};v.prototype.HPh=function(Qa,S){var da={};da["x-UserDataSignature"]=this.ib.Wa("UserDataSignature");da["x-LicensingIsEnabled"]=this.ib.ra("LicensingIsEnabled").toString();
da["x-CacheIsEnabled"]=this.ib.ra("LicensingRedisIsEnabled").toString();da["x-OcpsIsEnabled"]=this.ib.ra("OcpsIsEnabled").toString();da["x-LicensingAADIdIsEnabled"]=this.ib.ra("LicensingAadIdIsEnabled").toString();0===Qa&&(da["x-LicenseCheckOnTenantEnabled"]=this.ib.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksLicenseCheck",!1).toString(),da["x-SupportUserConsentDependentFeatures"]=this.ib.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SupportUserConsentBasedFeaturesInAFH",
!1).toString(),da["x-AFHUserConsentGroupValue"]=this.ib.getIntFeatureGate("Microsoft.Office.SharedOnline.AFHUserConsentGroupValue",0).toString(),da["x-UseShellServiceForUserConsentGroup"]=this.ib.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseShellServiceForUserConsentGroup",!1).toString(),da["x-UseSALForLicensing"]=this.ib.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseSALForLicensingAFHS",!1).toString(),da["x-SMBUserLicensingEnabled"]=this.ib.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SMBUserLicensingEnabled",
!1).toString());if(S){Qa=ak(S.keys);for(var xa=Qa.next();!xa.done;xa=Qa.next())xa=xa.value,da[xa]=S.na(xa)}return da};Object(u.a)(v,"HttpRequestToPromiseUtility",null,[]);var M=b(4),T;(function(Qa){Qa[Qa.loki=0]="loki";Qa[Qa.augloopACLP=1]="augloopACLP"})(T||(T={}));Object(u.b)("AlternateAuthSupportApp",T);var F=b(942),K=b(41);Object(u.a)(r,"WacAlternateAuthToken",null,[]);z.prototype.RHh=function(){var Qa=null;this.hQb.kb(T[0])&&(Qa=this.hQb.na(T[0]));return void 0===Qa||null===Qa||this.wqd(Qa)?
this.Ayh():Promise.resolve(Qa.Token)};z.prototype.wqd=function(Qa){return Qa.ExpirationTime-Date.now()<this.uKj};z.prototype.Ayh=function(){var Qa=this,S=new y.a(x.a.Jk());S.ia("X-AlternateAuthApp",T[0]);return this.Fib.f3c(this.Uua("/afhs/AlternateAuthHelperHandler.ashx"),Object(C.a)(this,this.yWi,"parseAlternateAuthTokenResponse"),2,S).then(function(da){B.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",T[0]);Qa.hQb.ia(T[0],
da);return da.Token},function(da){da=Object(G.a)(A,da);B.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",da.message,da.Zdc);return null})};z.prototype.yWi=function(Qa){var S=K.d(Qa).Pt;B.ULS.sendTraceTag(545821457,3004,S?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",Qa);return S};z.prototype.Uua=function(Qa){return String.format("{0}{1}?{2}",this.ib.Wa("WebServiceBase"),Qa,M.AFrameworkApplication.aj)};
Object(u.a)(z,"AlternateAuthHelper",null,[491]);var J=b(491);Object(u.a)(n,"FeatureStateChangeArgs",null,[]);var O=b(136),N=b(262),H=b(25),Q=b(113),ca=b(178),X;(function(Qa){Qa[Qa.Enabled=0]="Enabled";Qa[Qa.Disabled=1]="Disabled"})(X||(X={}));Object(u.b)("FeatureState",X);var Z=b(84),ea=b(27),ka=b(190);w.prototype.bRh=function(){for(var Qa=this.ib.co("AllLicensedFeatures")?this.ib.gw("AllLicensedFeatures"):[],S=new J.a,da=0;da<Qa.length;da++)S.add(Qa[da]);return S};w.prototype.Eod=function(){return this.PKc||
this.QKc};w.prototype.EWd=function(Qa,S){var da=this;Qa=void 0===Qa?0:Qa;S=void 0===S?!1:S;B.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",S);var xa=O.a.Fr();xa&&(xa.set("retryAttempt",Qa.toString()),xa.set("forceRefresh",S.toString()),xa.set("isO365ConsumerHost",this.QKc.toString()),xa.set("isO365CommercialHost",this.PKc.toString()),xa.set("isFreemiumUpsellEnabled",this.kTb.toString()));I.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest",
"waclicensing",xa);I.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",xa);void 0!==this.mqa&&null!==this.mqa&&this.mqa.start();var ta=null;S&&(ta=new y.a(x.a.Jk()),ta.ia("x-LicensingForceRefresh","true"));this.$de=new Date;return(this.lqa?this.Fib.f3c(this.Uua("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(C.a)(this,this.BWi,"parseApplicationFeatureHelperResponse"),0,ta,Object(C.a)(this,this.T0i,"processApplicationFeatureHelperResponseHeaders"),["Date"]):Promise.resolve({})).then(function(ab){var Na=
Object.assign(new ka.a,{durationMs:da.K5f()});Na.extendedProperties=xa;Na.extendedProperties&&ab&&(Na.extendedProperties.set("featureCount",Q.a.count(ab).toString()),Na.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in ab).toString()),Na.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in ab).toString()),da.EVb&&Na.extendedProperties.set("fromCache",(da.EVb<da.$de).toString()));I.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",Na);return ab},
function(ab){var Na=Object.assign(new ka.a,{durationMs:da.K5f()}),Ka=Object(G.a)(A,ab);if(!Ka)return B.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),I.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,Na),new Promise(function(la,Ea){Ea(ab)});Na.extendedProperties=xa;Na.extendedProperties&&Na.extendedProperties.set("status",Ka.Zdc.toString());I.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest",
"RequestFailed",!1,!0,Na);return 408===Ka.Zdc&&++Qa<=da.Nrg?da.EWd(Qa):new Promise(function(la,Ea){Ea(Ka)})})};w.prototype.BWi=function(Qa){(Qa=K.b(Qa))?(B.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),B.ULS.sendTraceTag(50938594,3004,50,"{0}",Qa)):B.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");return Qa.Features};w.prototype.Uua=function(Qa){var S=
String.format("{0}{1}",this.ib.Wa("WebServiceBase"),Qa);this.ib.co("ApplicationFeatureHelperHttpCachingEnabled")&&this.ib.ra("ApplicationFeatureHelperHttpCachingEnabled")&&(Qa=w.ebc(this.ib))&&0<Qa.length&&(this.sXb&&(Qa+="ucbf"),S=new N.QueryStringBuilder(S),S.Ii("afhskey",Qa),S=S.toString());return S};w.prototype.isFeatureEnabled=function(Qa,S){var da=this;if(!this.fEa&&!this.lSc&&!this.lqa)return this.pBa;B.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",
Qa);if("ConnectedServices"===Qa){var xa=this.fEa?this.G2d.NJ("ControllerConnectedServicesEnabled"):this.pBa,ta=this.lSc?this.hie.getSettings().then(function(Ka){return 2!==Ka.Ot},function(){return S}):this.pBa;return xa.then(function(Ka){return Ka?ta:da.e$c})}xa=null;xa=this.fEa?this.G2d.isFeatureEnabled(Qa):this.pBa;var ab=null;ab=this.lqa?this.mhi(Qa,S):this.pBa;var Na=null;Na=this.lSc?this.hie.isFeatureEnabled(Qa):this.pBa;return xa.then(function(Ka){return Ka?Na.then(function(la){return la?ab:
da.e$c}):da.e$c}).then(function(Ka){da.jlf(Qa,Ka,!0);return Ka},function(){da.jlf(Qa,S,!1);return S})};w.prototype.jlf=function(Qa,S,da){B.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",Qa,S,da)};w.prototype.getFeatureTier=function(Qa,S){var da=this;if(!this.lqa)return new Promise(function(xa){xa(2)});B.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",Qa);return this.jua.then(function(xa){return da.ecc(Qa,
xa,S)},function(){return S})};w.prototype.isFreemiumUpsellEnabled=function(){return this.kTb&&this.QKc&&!this.P7d};w.prototype.launchUpsellExperience=function(Qa,S){S=void 0===S?null:S;B.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",Qa));var da=O.a.Fr();da&&(da.set("experienceId",Qa),S&&da.set("campaignId",S));I.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",1,"waclicensing",da);if(da=
Z.a.instance.nh("Common.IInProductMessagingUIManager")){var xa=Object(C.a)(this,this.M1h,"handleDimeTaskComplete");da.rjf(Qa,xa,S)}else B.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),I.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),S={},this.La.ae(ea.a.k$b,2,(S.experience=Qa,S))};w.prototype.zma=function(Qa,S){if(!this.lqa)return null;if(!Qa||!S)return B.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),
null;var da=ca.a.create().toString();this.iua.kb(Qa)||this.iua.ia(Qa,new y.a(x.a.Jk()));this.iua.na(Qa).add(da,S);B.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",da,Qa));return da};w.prototype.JHd=function(Qa,S){this.lqa&&(Qa&&this.iua.kb(Qa)?S&&ca.a.isValid(S)?this.iua.na(Qa).kb(S)?(B.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",
S,Qa)),this.iua.na(Qa).remove(S)):B.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",S,Qa)):B.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",S,Qa)):B.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",
Qa)))};w.prototype.ecc=function(Qa,S,da){return this.sXb?Qa in S?S[Qa].LicenseTier:da:Qa in S?this.ZWi(S[Qa],da):da};w.prototype.ZWi=function(Qa,S){switch(Qa.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return S}};w.prototype.M1h=function(){var Qa=this;B.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.jua.then(function(S){Qa.RMf(S)}).catch(function(){Qa.RMf({})})};w.prototype.RMf=function(Qa){var S=this;B.ULS.sendTraceTag(594051087,
3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");var da=this.EWd(0,!0);da.then(function(xa){S.jua=da;Q.a.count(xa)>Q.a.count(Qa)?I.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):I.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(var ta=ak(S.iua.keys),ab=ta.next();!ab.done;ab=ta.next())if(ab=ab.value,ab in xa){var Na=S.ecc(ab,xa,0);ab in Qa?S.ecc(ab,Qa,0)!==Na&&S.Bxd(ab,!0,Na):S.Bxd(ab,!0,Na)}else ab in
Qa&&S.Bxd(ab,!1,S.ecc(ab,Qa,0))}).catch(function(xa){I.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);B.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(xa))})};w.prototype.Bxd=function(Qa,S,da){B.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",Qa,S,da);S=new n(Qa,S,da);da=this.iua.na(Qa);da=ak(da);for(var xa=da.next();!xa.done;xa=da.next()){xa=
xa.value;try{xa.value(S)}catch(ta){B.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",Qa,xa.key,ta.message))}}};w.prototype.Vd=function(Qa,S){var da=this;if(this.lqa){var xa=this.r$d.contains(Qa),ta=!0,ab="",Na=!1;return this.jua.then(function(Ka){Qa in Ka?(Ka=Ka[Qa],ab=X[Ka.FeatureState],ta=1!==Ka.FeatureState):ta=!xa;da.tlf(Qa,xa,ab,Na,S,ta);return ta},function(){Na=
!0;xa&&(ta=S);da.tlf(Qa,xa,ab,Na,S,ta);return ta})}return this.pBa};w.prototype.tlf=function(Qa,S,da,xa,ta,ab){B.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",Qa,S,xa,da,ta,ab)};w.prototype.mhi=function(Qa,S){if(this.sXb)return this.Vd(Qa,S);if(this.lqa){if(this.r$d.contains(Qa))return this.jua.then(function(da){return Qa in da},function(){return S});B.ULS.sendTraceTag(590385821,3004,
50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",Qa)}return this.pBa};w.prototype.T0i=function(Qa){try{Qa&&"Date"in Qa&&(this.EVb=new Date(Qa.Date),B.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.EVb.toString()))}catch(S){B.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",S)}};w.prototype.K5f=function(){if(void 0!==this.mqa&&
null!==this.mqa){var Qa=this.mqa.qc;this.mqa.stop();return Qa}return null};w.ebc=function(Qa){try{if(H.a.EGj){var S=Qa.Wa("UserDataSignature").split(".");if(1<S.length){var da=window.self.atob(S[1]),xa=JSON.parse(da).LocalStorageKey;if(void 0!==xa&&null!==xa&&0<xa.length)return xa}}}catch(ta){B.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",ta.toString())}return null};Object(u.a)(w,"ApplicationFeatureHelper",null,[492]);var Y=b(202);Object(u.a)(f,"CloudPolicySettingsCacheData",
null,[]);var qa=b(1027),fa=b(393),ha=b(236);m.S3f=function(){return M.AFrameworkApplication.fa.ra("SideCarIsEnabled")?m.Auc&&m.Umd?new Promise(function(Qa){Qa(!0)}):new Promise(function(Qa,S){m.Auc=ha.a.create(M.AFrameworkApplication.fa.Wa("SideCarUrl"));fa.a.ria(m.Auc);m.Auc.D9(function(da,xa){(m.Umd=xa.succeeded)?Qa(xa.succeeded):S(xa.succeeded)})}):new Promise(function(Qa){Qa(!1)})};m.Umd=!1;m.Auc=null;Object(u.a)(m,"SideCarLoader",null,[]);Object(u.a)(l,"CloudPolicySettingsData",null,[]);k.prototype.NJ=
function(Qa,S){S=void 0===S?!0:S;if(!this.fEa){var da=this;return new Promise(function(Na){Na(da.vvb(Qa))})}var xa=this,ta=this,ab=this.A2b.then(function(Na){try{var Ka=null;Na.PolicySettings&&"unknown"in Na.PolicySettings&&(Ka=Na.PolicySettings.unknown);if(Ka){if(Qa in Ka&&void 0!==Ka[Qa]&&null!==Ka[Qa])return new Promise(function(Ea){Ea("0"!==Ka[Qa])});var la=Qa.toLowerCase();if(la in Ka&&void 0!==Ka[la]&&null!==Ka[la])return new Promise(function(Ea){Ea("0"!==Ka[la])});B.ULS.sendTraceTag(51512667,
3004,50,"Policy"+Qa+" not found, using default");return new Promise(function(Ea){Ea(xa.vvb(Qa))})}return new Promise(function(Ea){Ea(xa.vvb(Qa))})}catch(Ea){return B.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+Qa+" policy value. Error Message: {0}",Ea.message),xa.handleError(Ea.toString(),S,xa.vvb(Qa))}},function(Na){return ta.handleError(Na,S,ta.vvb(Qa))});ab.then(function(Na){B.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",
Qa,Na);return null});return ab};k.prototype.isFeatureEnabled=function(Qa,S){S=void 0===S?!0:S;if(this.ib.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.ohi(Qa,S);var da=new Promise(function(ta){ta(!0)}),xa="";this.kRb.contains(Qa)&&(xa="ControllerConnectedServicesEnabled",da=this.NJ(xa,S));da.then(function(ta){B.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",
Qa,ta,xa);return null});return da};k.prototype.ohi=function(Qa,S){S=void 0===S?!0:S;var da=new Promise(function(ta){ta(!0)}),xa="";"mso_sendASmile"===Qa?xa="Enabled":"Survey"===Qa||"FloodgateSurvey"===Qa?xa="SurveyEnabled":this.kRb.contains(Qa)&&(xa="ControllerConnectedServicesEnabled");""!==xa&&(da=this.NJ(xa,S));da.then(function(ta){B.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",Qa,ta,xa);return null});return da};
k.prototype.handleError=function(Qa,S,da){return S?new Promise(function(xa){xa(da)}):new Promise(function(xa,ta){ta(Qa)})};k.prototype.noa=function(Qa,S,da){var xa=this;if(!Qa)return Promise.resolve(new l);var ta=!1,ab=null;I.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);var Na=this.D2c("GetCloudPolicySettings");return(new Promise(function(Ka,la){if(void 0!==xa.ujb&&null!==xa.ujb&&0<xa.ujb.length){var Ea=xa.VMj();if(void 0!==Ea&&null!==Ea){ta=!0;Ka(Ea);return}}xa.Fib.f3c(S,
da,1,null,Object(C.a)(xa,xa.X0i,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],xa.ib.kd("CloudPolicySettingsRequestQueueTimeout",15E3),xa.ib.kd("CloudPolicySettingsRequestSentTimeout",3E4)).then(function(ra){B.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");xa.KNj(ra);Ka(ra);return ra},function(ra){la(ra);return null})})).then(function(Ka){var la=xa.vyc(Na);Na=la.stopwatch;ab=la.returnValue;(la=O.a.Fr())&&la.set("FromCache",ta.toString());la=Object.assign(new ka.a,
{durationMs:ab,extendedProperties:la});I.Health.instance.recordKpiSuccess("GetCloudPolicySettings",la);return Ka})};k.prototype.kNj=function(){return m.S3f().then(function(){B.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})};k.prototype.Uua=function(Qa){return String.format("{0}{1}",this.ib.Wa("WebServiceBase"),Qa)};k.prototype.CWi=function(Qa){var S=K.d(Qa).Pt;B.ULS.sendTraceTag(50622687,
3004,S?50:10,"ParseCloudPolicySettingsResponse: fetched CloudPolicySettingsData from {0}",Qa);return S};k.prototype.X0i=function(Qa){try{if(void 0!==Qa&&null!==Qa&&"CheckIn-Interval"in Qa){var S=parseInt(Qa["CheckIn-Interval"]);void 0!==S&&null!==S&&0<S&&(this.NFc=S)}}catch(da){B.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",da)}};k.prototype.vvb=function(Qa){return Qa in this.ybe?"0"!==this.ybe[Qa]:!0};k.prototype.VMj=function(){try{var Qa=qa.a.instance.getItem(this.ujb);
if(void 0===Qa||null===Qa)return B.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;B.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",Qa);var S=JSON.parse(Qa);if(void 0===S||null===S)return B.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===S.ExpirationTime||null===S.ExpirationTime)return B.ULS.sendTraceTag(51662939,
3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(S.ExpirationTime)).getTime()<Date.now())return B.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;var da=new l;da.PolicySettings=S.PolicySettings;da.ControllerConnectedServicesFeatureNames=new Y.a;this.ib.co("ServicesControlsMicrosoftControllerServicesList")&&this.ib.gw("ServicesControlsMicrosoftControllerServicesList");for(var xa=
ak(this.kRb),ta=xa.next();!ta.done;ta=xa.next())da.ControllerConnectedServicesFeatureNames.add(ta.value);B.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return da}catch(ab){return B.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",ab.toString()),null}};k.prototype.KNj=function(Qa){try{if(void 0===Qa||null===Qa||void 0===Qa.PolicySettings||null===Qa.PolicySettings)B.ULS.sendTraceTag(51662944,3004,
15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.NFc)B.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{var S=new f(Qa,this.NFc),da=JSON.stringify(S);B.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",da);qa.a.instance.setItem(this.ujb,da);B.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(xa){B.ULS.sendTraceTag(51662976,
3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",xa.toString())}};k.prototype.ebc=function(){var Qa=w.ebc(this.ib);return Qa&&0<Qa.length?"OCPS"+Qa:null};k.prototype.D2c=function(Qa){var S=Z.a.instance.nh("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==S&&null!==S?S.sc("WebServiceCall",Qa):null};k.prototype.vyc=function(Qa){if(void 0!==Qa&&null!==Qa){var S=Qa.qc;Qa.stop();return{returnValue:S,stopwatch:null}}return{returnValue:null,stopwatch:Qa}};Object(u.a)(k,
"CloudPolicySettingsHelper",null,[489]);e.prototype.clone=function(){var Qa=new e;Qa.Ot=this.Ot;Qa.geg=this.geg;Qa.BIe=this.BIe;Qa.nHa=this.nHa;Qa.heg=this.heg;Qa.CIe=this.CIe;Qa.uea=this.uea;Qa.XQc=this.src;return Qa};e.prototype.serialize=function(Qa){Qa=void 0===Qa?null:Qa;var S={};if(!Qa||Qa.contains(e.$Na))S[e.$Na]=this.Ot;if(!Qa||Qa.contains(e.vDb))S[e.vDb]=this.nHa;if(!Qa||Qa.contains(e.wDb))S[e.wDb]=this.uea;return JSON.stringify(S)};e.create=function(Qa,S){S=void 0===S?null:S;var da=new e;
da.XQc=Qa;void 0!==S&&null!==S&&(e.$Na in S&&(da.Ot=S[e.$Na]),e.vDb in S&&(da.nHa=S[e.vDb]),e.wDb in S&&(da.uea=S[e.wDb]));return da};e.deserialize=function(Qa,S){try{var da=JSON.parse(Qa);if(void 0!==da&&null!==da)return e.create(S,da);B.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",Qa);throw Error.argument("settingsData");}catch(xa){throw B.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",xa.toString()),xa;}};
Af.Object.defineProperties(e.prototype,{src:{configurable:!0,enumerable:!0,get:function(){return this.XQc}}});e.$Na="CCS";e.vDb="CCSTime";e.wDb="OfficePrivacyRoamedNoticeShown";Object(u.a)(e,"UserPrivacySettings",null,[]);var ia=b(127);d.prototype.Uua=function(Qa){var S=String.format("{0}RoamingServiceHandler.ashx?action=",this.ib.appSettings.RoamingServiceHandlerWebServiceBase||"");S=new Sys.StringBuilder(S);S.append(Qa);S.append("&");S.append(M.AFrameworkApplication.aj);return S.toString()};d.prototype.executeRequest=
function(Qa,S,da,xa){return this.Pg.OYb(Qa,S,void 0===xa?null:xa,null,da,"33",!1,null,6E4)};d.prototype.saveSettings=function(Qa){var S=this;return new Promise(function(da,xa){try{if(void 0===S.ie||null===S.ie||void 0===Qa||null===Qa)B.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),xa("Can't determine setting changes to save");else{var ta=S.ie.Ot!==Qa.Ot;if(2===S.ie.src&&ta)S.Jjj(Qa),da(!0);else{var ab=S.Anj(Qa);if(void 0===ab||null===ab||!ab.length)B.ULS.sendTraceTag(50917389,
3004,15,"SaveUserPrivacySettings: returning since nothing changed"),xa("No changes to save");else if(1===S.ie.src)da(S.cag(ab));else if(0===S.ie.src){B.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",ab);var Na=S.executeRequest(S.Uua("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",ab);Na.continueWith(function(){if(Na.Ch||Na.Yf)B.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),da(!1);else{var Ka=
Na.result;void 0!==Ka.Sg&&null!==Ka.Sg&&void 0!==Ka.Sg.data&&null!==Ka.Sg.data&&Ka.Sg.data.httpStatus===U.a.TO?(B.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),da(!0)):(B.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),da(!1))}})}}}}catch(Ka){B.ULS.sendTraceTag(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",Ka.toString()),da(!1)}})};d.prototype.Anj=function(Qa){if(void 0===this.ie||null===this.ie||void 0===
Qa||null===Qa)throw Error.invalidOperation("User Privacy settings have not been initialized");var S=new Y.a;0===Qa.src?(this.ie.Ot!==Qa.Ot&&(S.add(e.$Na),S.add(e.vDb)),this.ie.uea!==Qa.uea&&S.add(e.wDb)):1===Qa.src&&this.ie.Ot!==Qa.Ot&&S.add(e.$Na);return S.count?Qa.serialize(S):(B.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)};d.prototype.getSettings=function(){if(!this.oQc){var Qa=this;this.oQc=new Promise(function(S){try{Qa.ie?S(Qa.ie.clone()):
Qa.cNj().then(function(da){Qa.ie=da;S(Qa.ie.clone());return null},function(){Qa.aNj().then(function(da){Qa.ie=da;S(Qa.ie.clone());return null},function(){Qa.bNj().then(function(da){Qa.ie=da;S(Qa.ie.clone());return null},function(){B.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");Qa.ie=new e;S(Qa.ie.clone());return null});return null});return null})}catch(da){B.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",
da.toString()),Qa.ie=new e,S(Qa.ie.clone())}})}return this.oQc};d.prototype.cNj=function(){var Qa=this;return new Promise(function(S,da){try{var xa=-1!==window.location.href.indexOf("&wd_pn=2");if(Qa.ib.ra("PrivacyDialogShouldCheckRoaming")||xa){var ta=Qa.executeRequest(Qa.Uua("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");ta.continueWith(function(){try{if(ta.Ch||ta.Yf)B.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{var ab=ta.result;
if(ab&&ab.Sg&&ab.Sg.data)if(ab.Sg.data.httpStatus!==U.a.TO)B.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",ab.Sg.data.httpStatus);else{if(ab.Sg.data.Ud){S(d.parse(ab.Sg.data.Ud,0));B.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",ab.Sg.data.Ud);return}B.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else B.ULS.sendTraceTag(50860935,
3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");da("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(Na){B.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",Na.toString()),da("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else B.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),da("Roaming should not be used")}catch(ab){B.ULS.sendTraceTag(50860939,
3004,10,"TryGetSettingsFromRoaming Exception = {0}",ab.toString()),da("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})};d.prototype.aNj=function(){var Qa=this;return new Promise(function(S,da){try{var xa=ia.a.get("WacUPToggleState"),ta=null;void 0!==xa&&null!==xa&&0<xa.length&&(ta=decodeURIComponent(xa));if(void 0!==ta&&null!==ta&&0<ta.length){var ab=d.parse(ta,1);B.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",ab.toString());
S(ab)}else{var Na=e.create(1),Ka=new Y.a;Ka.add(e.$Na);var la=Na.serialize(Ka);Qa.cag(la)?(B.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",la),S(Na)):(B.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",la),da("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(Ea){B.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",
Ea.toString()),da("UserPrivacySettings TryGetSettingsFromCookie Eception")}})};d.prototype.bNj=function(){return new Promise(function(Qa){try{var S=-1!==window.location.href.indexOf("&wdccsoff=1"),da=e.create(2);S?(da.Ot=2,M.AFrameworkApplication.jHe(),B.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",da.toString())):(da.Ot=1,B.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",da.toString()));
Qa(da)}catch(xa){B.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",xa.toString()),S=e.create(2),S.Ot=1,Qa(S)}})};d.prototype.Jjj=function(Qa){B.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===Qa.Ot?M.AFrameworkApplication.jHe():M.AFrameworkApplication.ckh();B.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",Qa)};d.prototype.cag=function(Qa){try{B.ULS.sendTraceTag(51258455,3004,
50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",Qa);var S=this.ib.Wa("PrivacyCookieDomain")||"";if(!S||!S.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");B.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",Qa);return ia.a.TOd("WacUPToggleState",Qa,ia.a.OV,"/",S)}catch(da){return B.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",da.toString()),!1}};d.prototype.isFeatureEnabled=function(Qa){var S=
this;return this.getSettings().then(function(da){for(var xa=S.ib.co("ServicesControlsMicrosoftControllerServicesList")?S.ib.gw("ServicesControlsMicrosoftControllerServicesList"):[],ta=new J.a,ab=0;ab<xa.length;ab++)ta.add(xa[ab]);return ta.contains(Qa)?2!==da.Ot:!0},function(){B.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",Qa);return!0})};d.parse=function(Qa,S){try{return B.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",Qa,S),e.deserialize(Qa,
S)}catch(da){throw B.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",da.toString()),da;}};Object(u.a)(d,"UserPrivacySettingsHelper",null,[490]);var wa=b(257);c.prototype.Sh=function(Qa){var S=this;this.fb=Qa;this.fb.register(489,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").tc().Cc(function(){return new k(M.AFrameworkApplication.fa,M.AFrameworkApplication.qd)});this.fb.register(490,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").tc().Cc(function(){return new d(M.AFrameworkApplication.fa,
M.AFrameworkApplication.qd)});this.fb.register(491,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").tc().Cc(function(){return new z(M.AFrameworkApplication.fa,M.AFrameworkApplication.qd)});this.fb.register(492,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").tc().Cc(function(){return new w(M.AFrameworkApplication.fa,M.AFrameworkApplication.qd,S.fb.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),S.fb.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),
M.AFrameworkApplication.ub)})};c.prototype.init=function(){var Qa=this;M.AFrameworkApplication.fa.Tu(function(){var S=Qa.fb.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");M.AFrameworkApplication.fa.ra("LicensingIsEnabled")&&(S.isFeatureEnabled("LicensingTestFeature",!1).then(function(da){B.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",da,M.AFrameworkApplication.fa.Wa("IsAnonymousUser"));
return null}),S.getFeatureTier("LicensingTestFeature",0).then(function(da){B.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",da,M.AFrameworkApplication.fa.Wa("IsAnonymousUser"));return null}));Qa.fb.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");Qa.bIj()})};c.prototype.dispose=function(){};c.prototype.bIj=function(){try{M.AFrameworkApplication.fa.ra("SideCarIsEnabled")&&m.S3f().then(function(Qa){B.ULS.sendTraceTag(594057429,
3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",Qa);return Qa})}catch(Qa){}};c.main=function(){wa.a.instance.Ui(new c)};Af.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}}});Object(u.a)(c,"ApplicationFeatureHelperPackage",null,[3,4]);b.d(D,"a",function(){return a})},1366:function(u,D,b){function a(){x.a.Fa(function(Kb){c.ka(Kb)})}function c(Kb){var Ub=Hb.call(this)||
this;Ub.$=Kb;Ub.Eb();return Ub}function d(){}function e(Kb,Ub,gb,Db,Va,yb,qb){Kb=l.call(this,Kb,Ub,gb,Db,Va,!1)||this;Kb.AYd=!1;Kb.H0=qb;Kb.hec=e.cFh(yb);yb=Kb.ZYd(Kb.hec.name,Kb.hec.size);if(0!==yb)return Kb.pRd(yb),Kb.H0.setException(Error.create("DataUrlUploaderWrapper: Invlid data url")),Kb.dispose(),Kb;Kb.zj=new z(Kb.$.domElement,Object(fa.a)(Kb,Kb.XEb,"onUploadFrameInitialized"),Object(fa.a)(Kb,Kb.Aoa,"uploadResponseReceived"),Db,!1,Kb.$);return Kb}function k(Kb,Ub){this.filename=Kb;this.blob=
Ub}function l(Kb,Ub,gb,Db,Va,yb){yb=void 0===yb?!0:yb;Kb=w.call(this,Kb,gb,Db,Va,!1)||this;Kb.Ed=Ub;yb&&Kb.showDialog();return Kb}function m(Kb,Ub){this.dataUri=this.sheetName=null;this.sheetName=Kb;this.dataUri=Ub}function f(Kb,Ub,gb,Db,Va,yb){yb=void 0===yb?!0:yb;Ub=w.call(this,Kb,Ub,gb,Db,!1)||this;Ub.bzh=Va;Ub.k9b=Kb.Fb.Lg("LoadResource","FileReaderUploaderLoadResource");yb&&Ub.showDialog();return Ub}function w(Kb,Ub,gb,Db,Va){Va=void 0===Va?!0:Va;var yb=Ia.call(this,null,Ub,gb)||this;yb.ot=null;
yb.kaa=null;yb.Y6a=!1;yb.QCd=null;yb.Aoa=function(qb){yb.PZd.stop();yb.S_b.cancel();if(z.khi(qb))yb.Rzc?yb.w4e(4):(qb=new I.a(0,2,null,null,!1,null,null,null),qb.status=8,yb.hWd(new U.a(qb),null,"InsertPictureWebMethod")),G.ULS.sendTraceTag(526399121,0,50,"Http Error occurred, isTimeoutError: {0}",yb.Rzc);else{var dc=w.tVj(qb);0!==dc?(G.ULS.sendTraceTag(526399122,0,50,"Server returned error, response: {0}",qb),yb.w4e(dc)):yb.U3h(qb)}yb.woc();yb.dispose()};yb.XJi=function(qb){yb.KBa(qb,yb.zj)&&yb.finalizeUpload(yb.zj,
null)};yb.XEb=function(qb){G.ULS.sendTraceTag(526399120,0,50,"Upload frame initialized");yb.zj=qb;if(!yb.e1a){if(yb.AYd){if(yb.vve()||yb.D8a&&M.a.hF){qb.K6b(yb.XJi);return}var dc=qb.K6b(null);if(!yb.KBa(dc,qb))return}yb.finalizeUpload(qb,null)}};yb.eTi=function(){yb.Rzc=!0};yb.jb=Kb;yb.PZd=Kb.Fb.Lg("WebServiceCall","InsertPictureOperation");yb.S_b=Q.a.instance.create(yb.eTi,1E5,ca.a.vNg,!1);yb.Rzc=!1;yb.Dkc=yb.$.ya.InsertPictureMaxFileSizeBytes;Db&&(yb.Y6a="TestOnly"in Db);Va&&yb.showDialog();return yb}
function n(Kb,Ub,gb){var Db=A.call(this,Kb,!1)||this;Db.NU=null;Db.RAa=!1;Db.Jmc=function(){Db.EXd("");Db.RAc();return!1};Db.$=Ub;Db.ZBc=Kb;Db.LQ=ta.a.instance;Db.fa=gb;Db.C_f();Db.Rkd();Db.$.ob.sz=!0;return Db}function z(Kb,Ub,gb,Db,Va,yb,qb){Kb=r.call(this,Kb,Ub,gb,Db,Va,"UploadFrame",yb.ea.sessionId,"image/*",!1,null,void 0===qb?!1:qb)||this;Kb.$=yb;Kb.Vdg=!0;Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5329840_InsertPictureOpenFileBrowserDirectly")?Kb.b$e():Kb.Qpe();return Kb}function r(Kb,Ub,
gb,Db,Va,yb,qb,dc,bb,db,wc){bb=void 0===bb?!0:bb;wc=void 0===wc?!1:wc;this.VRe="FileUpload.ashx";this.Sn=null;this._initialized=!1;this.Dg=this.aib=this.WHc=this.pga=this.iSb=this.Oq=this.vs=null;this.qm=!1;this.BD=this.jSb=this.hSc=null;this._parent=Kb;this.eqg=Ub;this.Nug=gb;this.e6d=Va;this.lQc=qb;this.n0d=dc;this.j2d=void 0===db?null:db;this.gSc=!1;this.Dqg=Db.ra("CanaryRenewalForFileUploadIsEnabled");this.Vdg=!1;(this.Bqa=wc)||this.h4g(yb);bb&&this.b$e()}function v(Kb,Ub,gb){if(Kb){var Db=0;
do{try{Kb();break}catch(Va){if(G.ULS.sendTraceTag(50946190,306,10,"RetryOnException: [Retries: {0}] [Caller: {1}] [Exception: {2}] [Callstack: {3}].",Db,gb,Va.message,Va.stack),Db>=Ub)break}Db++}while(1)}}function A(Kb,Ub){return y.call(this,Kb,void 0===Ub?!0:Ub)||this}function B(){}function y(Kb,Ub){Ub=void 0===Ub?!0:Ub;var gb=xa.call(this,!1,!1,y.pu)||this;gb.NWa=null;gb.A5d=!1;gb.Pm=[];gb.zj=null;gb.lXb=Kb;gb.Cvg=Ub;gb.Wge=!1;gb.Av=!1;gb.pga=null;gb.XHc=!1;gb.Wf=gb.Ieh;gb.ze="InsertFileDialog";
gb.mc(1,gb.JXb);if(y.pu){Kb={};Ub={};var Db={};gb.NWa=(Db.id=gb.ze,Db.bodyControls=(Ub.uploadButtonProps=(Kb.label=CommonUIStrings.l_DialogChooseFile,Kb.onExecute=Object(fa.a)(gb,gb.HTi,"onUploadButtonClick"),Kb),Ub),Db.uploadStatusLabel=CommonUIStrings.l_DialogNoFileChosen,Db.onFrameReady=Object(fa.a)(gb,gb.zKi,"onFrameReady"),Db);gb.initializeAndShow(gb.titleText,Object(fa.a)(gb,gb.Nec,"insertDialogHandler"),gb.NWa);gb.LRb=!0}else gb.showDialog(gb.titleText,Object(fa.a)(gb,gb.Nec,"insertDialogHandler")),
Ub&&gb.C_f(),(Kb=gb.YU(1))&&gb.Pm.push(Kb),(Kb=gb.YU(0))&&gb.Pm.push(Kb),gb.Icg(),gb.LRb=!1;return gb}var x=b(11);u=b(0);var C=b(232),G=b(15),E=b(1563),I=b(733),U=b(612),M=b(25),T=b(90),F=b(30),K=b(162),J=b(8),O=b(54),N=b(160),H=b(357),Q=b(47),ca=b(44),X=b(29),Z=b(1),ea=b(22),ka=b(14),Y=b(105),qa=b(85),fa=b(83),ha=b(150),ia=b(4),wa=b(13),Qa=b(96),S=b(43),da=b(1282),xa=ha.a;Rk(y,xa);y.prototype.validate=function(){this.zj.FE||G.ULS.sendTraceTag(25798091,322,10,"UploadFrame.FileInputElement is null");
return this.zj.FE.value?!0:(y.Oz(CommonUIStrings.l_FileUploadNoFileSpecified),!1)};y.prototype.zKi=function(Kb){this.Cvg&&(this.zj=this.B_f(Kb,this.lXb))};y.prototype.HTi=function(){this.zj&&this.zj.FE&&(this.A5d||(this.zj.A8i(Object(fa.a)(this,this.qzd,"onFileChosen")),this.A5d=!0),this.zj.PRe())};y.prototype.qzd=function(Kb){this.NWa.uploadStatusLabel=Kb;this.nTa(this.titleText,Object(fa.a)(this,this.Nec,"insertDialogHandler"),this.NWa)};y.prototype.Nec=function(Kb){1===Kb&&this.isEnabled()?y.pu&&
this.zj.FE&&!this.zj.FE.value?(this.NWa.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,this.nTa(this.titleText,Object(fa.a)(this,this.Nec,"insertDialogHandler"),this.NWa)):(this.axb(),this.lXb.finalizeUpload(this.zj,Object(fa.a)(this,this.dispose,"dispose"))):0===Kb&&this.hide()};y.prototype.C_f=function(){this.XHc=!1;this.zj=this.B_f(document.getElementById("uploadFrameContainer"),this.lXb);ia.AFrameworkApplication.fa.ra("InsertPictureDialogFocusLoopFixIsEnabled")&&(this.pga=Object(fa.a)(this,
this.jBd,"onUploadFrameLoad"),S.a.addHandler(this.zj.iFrame,"load",this.pga));this.zj.FE||G.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.HIf()};y.prototype.jBd=function(){this.HIf()};y.prototype.HIf=function(){if(this.zj&&!this.XHc){var Kb=this.zj.FE;Kb&&(S.a.addHandler(Kb,wa.a.Lb,Object(fa.a)(this,this.onKeyDown,"onKeyDown")),Kb=[Kb],this.Pm=Kb.concat.apply(Kb,this.Pm),this.Icg(),this.XHc=!0)}};y.prototype.dispose=function(){if(this.zj&&!y.pu){var Kb=this.zj.FE;Kb&&
S.a.removeHandler(Kb,wa.a.Lb,Object(fa.a)(this,this.onKeyDown,"onKeyDown"));this.pga&&S.a.removeHandler(this.zj.iFrame,"load",this.pga)}this.zj=null;xa.prototype.dispose.call(this)};y.prototype.Icg=function(){if(0<this.Pm.length){var Kb=new da.a(this.Pm),Ub=Qa.FocusManager.instance().yQ();Ub&&(this.Pm[0].focus(),Ub.We=Kb,Ub.q_=!0)}};y.prototype.onKeyDown=function(Kb){4!==Qa.FocusManager.instance().JIf(Kb)&&Kb.preventDefault()};y.Oz=function(Kb){var Ub=document.getElementById("errorText");Ub.innerText=
Kb;Ub.style.display="inline-block"};Af.Object.defineProperties(y.prototype,{eUj:{configurable:!0,enumerable:!0,get:function(){return this.lXb}}});Af.Object.defineProperties(y,{pu:{configurable:!0,enumerable:!0,get:function(){return ia.AFrameworkApplication.ta.Pa.Wu&&ia.AFrameworkApplication.ta.Pa.mff}}});Object(u.a)(y,"InsertFileDialog",ha.a,[]);Af.Object.defineProperties(B,{Wf:{configurable:!0,enumerable:!0,get:function(){return ha.a.Po(B.rk,CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}});
B.rk="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";Object(u.a)(B,"InsertImageDialogHtml",null,[]);Rk(A,y);A.prototype.validate=function(){this.zj.FE||G.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");var Kb=Object(qa.a)(E.a,this.eUj),Ub=Kb.Feg(this.zj.FE.value);
return 0!==Ub?(y.Oz(Kb.dYe(Ub)),!1):!0};Af.Object.defineProperties(A.prototype,{JXb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_ImageUploadButtonText}},titleText:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_ImageUploadingTitle}},Ieh:{configurable:!0,enumerable:!0,get:function(){return B.Wf}}});Object(u.a)(A,"InsertImageDialog",y,[]);var ta=b(617),ab=b(108),Na=b(89),Ka=b(41),la=b(262),Ea=b(205),ra=b(81),na=b(496),ba=b(178);r.prototype.b$e=function(){this.BD=
ba.a.create().toString();this.Bqa?this.G7c():this.Qpe()};r.prototype.h4g=function(Kb){this.Sn=document.createElement("iframe");this.Sn.className=Kb;this.Sn.id=Kb;this.e6d&&(this.Sn.style.visibility="visible",this.Sn.style.height="30px",this.Sn.setAttribute("frameborder","0"));this.pga=Object(fa.a)(this,this.jBd,"onUploadFrameLoad");S.a.addHandler(this.Sn,"load",this.pga)};r.prototype.K6b=function(Kb){var Ub=this;Kb=void 0===Kb?null:Kb;ia.AFrameworkApplication.ta.$pc();if(!this.Oq)return G.ULS.sendTraceTag(25798093,
322,50,"_fileInput is null"),"";S.a.addHandler(this.Oq,"change",function(){Ub.Wyh(Kb)});v(Object(fa.a)(this,this.PRe,"fileInputClick"),1,"DoFileOpenDialog");return this.Oq.value};r.prototype.Wyh=function(Kb){Kb&&Kb(this.Oq.value)};r.prototype.Xyh=function(){this.iSb&&(this.iSb.innerText=this.pZe())};r.prototype.A8i=function(Kb){var Ub=this;S.a.addHandler(this.Oq,"change",function(){Kb(Ub.pZe())})};r.prototype.pZe=function(){var Kb=null;if(this.Oq.value){var Ub=this.Oq.value,gb=Ub.lastIndexOf("\\");
0<gb&&(Kb=Ub.substring(gb+1,Ub.length))}return Kb?Kb:""};r.prototype.PRe=function(){try{G.ULS.sendTraceTag(35939520,322,50,"UploadFrame.FileInputClick - Clicking on File input element."),this.Oq.click()}catch(Kb){throw G.ULS.sendTraceTag(36783331,322,10,"UploadFrame.FileInputClick Exception: {0}",Kb.message),Kb;}};r.prototype.RFj=function(){this.lmi()?this.E6f():(this.rYd(),this.vs.submit())};r.prototype.lmi=function(){return(this.Dqg||this.Bqa)&&!(void 0===window.self.FormData||null===window.self.FormData)};
r.prototype.WWf=function(Kb){if(Kb){var Ub=this.YBe();this.Dg=new XMLHttpRequest;this.Dg.open("POST",Ub);this.Dg.setRequestHeader("X-CorrelationId",this.BD);this.zui(Kb);this.Dg.onreadystatechange=Object(fa.a)(this,this.Aoa,"uploadResponseReceived");this.Dg.send(Kb)}};r.prototype.zui=function(Kb){if(!M.a.iB&&Kb.get){var Ub=Kb.get("ImageId");Kb=window.self.navigator;var gb={};Ub=(gb.CorrelationId=this.BD,gb.Canary=ia.AFrameworkApplication.canary,gb.ImageNodeId=Ub,gb);Kb&&(Kb=Kb.connection?Kb.connection:
Kb.mozConnection?Kb.mozConnection:Kb.webkitConnection?Kb.webkitConnection:null)&&(Ub.effectiveType=Kb.effectiveType,Ub.downlink=Kb.downlink,Ub.type=Kb.type,Ub.rtt=Kb.rtt);G.ULS.sendTraceTag(573345858,322,50,"LogFileUploadStatistics: FileUpload {0}",Ub)}};r.prototype.E6f=function(){try{this.rYd();G.ULS.sendTraceTag(594888409,322,50,"SubmitFormWithRequest is preparing to send an upload request");var Kb=new (Type.parse("FormData"))(this.vs);this.WWf(Kb)}catch(Ub){G.ULS.sendTraceTag(594888407,322,10,
"SubmitFormWithRequest failed to send the request with exception "+Ub.message),this.R9a(null)}};r.prototype.D6f=function(Kb){try{if(this.rYd(),G.ULS.sendTraceTag(594888406,322,50,"SubmitFormWithBlob is preparing to send an upload request"),this.pVj(Kb)){this.jSb=Kb;this.vs.contains(this.Oq)&&this.vs.removeChild(this.Oq);var Ub=new (Type.parse("FormData"))(this.vs);Ub.append("applicationfileInput",Kb.blob,Kb.filename);this.WWf(Ub)}else this.R9a(null)}catch(gb){G.ULS.sendTraceTag(591267743,322,10,"SubmitFormWithBlob failed to send the request with exception "+
gb.message),this.R9a(null)}};r.prototype.pVj=function(Kb){return Kb&&void 0!==Kb.blob&&null!==Kb.blob&&void 0!==Kb.filename&&null!==Kb.filename&&""!==Kb.filename?void 0===window.self.FormData||null===window.self.FormData?(G.ULS.sendTraceTag(578380442,322,10,"FormData isn't supported"),!1):!0:(Kb=Kb?String.format("[isNull: false] [blobIsNullorEmpty: {0}] [filenameIsNullOrEmpty: {1}]",void 0===Kb.blob||null===Kb.blob,void 0===Kb.filename||null===Kb.filename||""===Kb.filename):"[isNull: true] [blobIsNullorEmpty: false] [filenameIsNullOrEmpty: false]",
G.ULS.sendTraceTag(578380441,322,10,String.format("Content of the blob is empty {0}",Kb)),!1)};r.prototype.Aoa=function(){if(4===this.Dg.readyState)if(200===this.Dg.status){G.ULS.sendTraceTag(594888405,322,50,"UploadResponseReceived received a successful response. CorrelationId: {0}",this.BD);var Kb=this.Dg.getResponseHeader("X-NewKey"),Ub=this.ffi(this.Dg),gb=!1;if(void 0!==Kb&&null!==Kb&&Ub&&(gb=this.fVj(Kb),!this.gSc&&gb)){G.ULS.sendTraceTag(594888404,322,50,"UploadResponseReceived resubmitting the upload request with a fresh canary. correlationId: {0}",
this.BD);this.gSc=!0;void 0!==this.jSb&&null!==this.jSb?this.D6f(this.jSb):this.E6f();return}G.ULS.sendTraceTag(594888403,322,50,"UploadResponseReceived processing the response [retried: {0}] [canaryInvalid: {1}] [gotNewCanary: {2}] [canaryRenewed: {3}] [CorrelationId: {4}]",this.gSc,Ub,!(void 0===Kb||null===Kb),gb,this.BD);this.R9a(this.Dg.responseText)}else G.ULS.sendTraceTag(42874946,322,15,"Upload request failed with status: {0} [isResponseNull: {1}] [correlationId: {2}]",this.Dg.status,this.Dg.responseText?
!1:!0,this.BD),this.R9a(null)};r.prototype.ffi=function(Kb){try{var Ub=Ka.a(Kb.responseText).Responses;if(void 0!==Ub&&null!==Ub&&1===Ub.length){var gb=Ub[0];if(void 0!==gb&&null!==gb&&2===gb.length&&28===gb[1].StatusCode)return!0}}catch(Db){}return!1};r.prototype.fVj=function(Kb){na.a.Mbg(Kb);return ia.AFrameworkApplication.canary!==Kb?!1:!0};r.prototype.rYd=function(){this.hSc||(this.hSc=new Date)};r.prototype.dispose=function(){this.qm||(this.Bqa?this._parent.removeChild(this.vs):(this._parent.removeChild(this.Sn),
S.a.removeHandler(this.Sn,"load",this.pga),this.pga=null),this.WHc&&(S.a.removeHandler(this.Oq,"change",this.WHc),this.WHc=null),this.QRe&&(this.aib&&(S.a.removeHandler(this.Oq,"change",this.aib),this.aib=null),this.iSb=null),this.Oq=this.vs=this._parent=this.Sn=null,this.qm=!0,this.hSc=null,G.ULS.sendTraceTag(25798094,322,50,"UploadFrame disposed"))};r.prototype.delayedDispose=function(){this.dispose()};r.prototype.K6g=function(Kb){if(this.vs){var Ub;(Ub=this.vs.querySelector("input[name=__REQUESTDIGEST]"))?
Ub.value=Kb:(Ub=this.j3c(),Ub.type="hidden",Ub.id="__REQUESTDIGEST",Ub.name="__REQUESTDIGEST",Ub.value=Kb,this.vs.appendChild(Ub))}};r.prototype.j3c=function(){return this.Bqa?document.createElement("input"):this.Sn.contentWindow.document.createElement("input")};r.prototype.jBd=function(){try{if(!this.Sn.contentWindow.document.body)return}catch(Db){this.f4h();return}if(!(this._initialized||this.D8a&&M.a.hF))this.G7c();else if(!this.D8a||!M.a.hF||this.iji){var Kb=M.a.yf?this.Sn.contentWindow.document.body.innerText:
this.Vdg?this.Sn.contentWindow.document.body.firstChild.innerText:this.Sn.contentWindow.document.body.firstChild.innerHTML;var Ub=this.Sn.contentWindow.document.body.innerText.toLowerCase(),gb=0<=Ub.indexOf("responses")||0<=Ub.indexOf("wopisrc");Ub=0<=Ub.indexOf("http error");!gb&&Ub&&G.ULS.sendTraceTag(42551183,322,15,"Couldn't obtain a valid response but the frame contains: "+this.Sn.contentWindow.document.body.innerText);this.R9a(Kb)}};r.prototype.G7c=function(){if(!this._initialized){var Kb=this.ga("uploadForm"),
Ub=this.ga("fileInput"),gb=this.YBe();this.q6g();this.vs.id=Kb;this.vs.method="post";this.vs.encoding="multipart/form-data";this.vs.action=gb;this.Oq.type="file";this.n0d&&(this.Oq.accept=this.n0d,this.j2d&&(this.Oq.capture=this.j2d));this.Oq.id=Ub;this.Oq.name=Ub;this.RIg&&(this.Oq.multiple=!0);!this.QRe||M.a.yf||M.a.BH||(this.aib=Object(fa.a)(this,this.Xyh,"fileInputChangedHandleAccessibility"),S.a.addHandler(this.Oq,"change",this.aib),this.iSb=Na.a.Mpe(this.vs,this.Oq,"InputFileDescription"));
this.e6d&&(this.Bqa||(Kb=this.Sn.contentWindow.document.body,Kb.style.margin="0",Kb.style.overflow="hidden"),Kb=ia.AFrameworkApplication.ta,this.Oq.style.fontFamily=Kb.P0,this.Oq.style.fontSize=Kb.DAc,this.Oq.style.margin="0");(Kb=document.getElementById("__REQUESTDIGEST"))&&this.K6g(Kb.value);this.vs.appendChild(this.Oq);this._initialized=!0;this.eqg(this)}};r.prototype.q6g=function(){if(this.Bqa)this.vs=document.createElement("form"),this._parent.appendChild(this.vs),this.Oq=document.createElement("input");
else{this.vs=this.Sn.contentWindow.document.createElement("form");var Kb=this.Sn.contentWindow.document;Kb.body.appendChild(this.vs);this.Oq=Kb.createElement("input")}};r.prototype.Qpe=function(){this._parent.appendChild(this.Sn);this.D8a&&M.a.hF&&this.G7c()};r.prototype.YBe=function(){var Kb=new la.QueryStringBuilder(this.VRe);ia.AFrameworkApplication.cYa(Kb);this.ooj(Kb);Kb=Kb.toString();if(M.a.xf||M.a.hF||M.a.BH)Kb=ra.a.vVe(Kb);return Kb};r.prototype.zke=function(){var Kb=new ab.a(2,1,0,Object(fa.a)(this,
this.delayedDispose,"delayedDispose"),4);ia.AFrameworkApplication.Bi.Eg(Kb)};Af.Object.defineProperties(r.prototype,{RSf:{configurable:!0,enumerable:!0,get:function(){return this.Nug}},sessionId:{configurable:!0,enumerable:!0,get:function(){return this.lQc}},iFrame:{configurable:!0,enumerable:!0,get:function(){return this.Sn}},FE:{configurable:!0,enumerable:!0,get:function(){return this.Oq}},D8a:{configurable:!0,enumerable:!0,get:function(){return ia.AFrameworkApplication.fa?ia.AFrameworkApplication.fa.ra("NativeFileOpenDialogIsEnabled"):
!1}},QRe:{configurable:!0,enumerable:!0,get:function(){return ia.AFrameworkApplication.fa?ia.AFrameworkApplication.fa.ra("FileInputDescriptionAccessibilityIsEnabled"):!1}},iji:{configurable:!0,enumerable:!0,get:function(){return this.Bqa?!1:Ea.b(this.Sn.contentWindow.location.pathname,this.VRe,0)}},RIg:{configurable:!0,enumerable:!0,get:function(){return!M.a.iB&&ia.AFrameworkApplication.fa.ra("AllowMultipleImageInsertFromLocalDevice")}}});Object(u.a)(r,"UploadFrame",null,[10]);var sa=b(45),ya=b(121),
va=b(21);Rk(z,r);z.prototype.ga=function(Kb){return Kb};z.prototype.ooj=function(Kb){G.ULS.shipAssertTag(526399105,0,!!this.sessionId,"SessionId shouldn't be null.");ya.a.ZVc(Kb,this.$.ya);Kb.y9(J.a.sessionId,this.sessionId);var Ub=va.g(this.$).ha;Ub=sa.o(Ub.sa.Y3,this.$);Kb.y9(J.a.k2i,this.$.va.pa.name);Kb.y9(J.a.j2i,Ub.FirstRow.toString());Kb.y9(J.a.i2i,Ub.FirstColumn.toString())};z.prototype.f4h=function(){this.RSf("ServerUploadError")};z.prototype.R9a=function(Kb){this.RSf(Kb)};z.khi=function(Kb){return!Kb||
ea.a.equals(Kb,"ServerUploadError",!1)};Object(u.a)(z,"UploadFrameWrapper",r,[]);Rk(n,A);n.prototype.B_f=function(Kb,Ub){return new z(Kb,Object(fa.a)(Ub,Ub.XEb,"onUploadFrameInitialized"),Object(fa.a)(Ub,Ub.Aoa,"uploadResponseReceived"),this.fa,!0,this.$)};n.prototype.dispose=function(){this.RAc();this.LQ=this.ZBc=null;A.prototype.dispose.call(this)};n.prototype.hide=function(){A.prototype.hide.call(this);this.$.ob.sz=!1};n.prototype.validate=function(){var Kb=this.ZBc.ZYd(this.zj.FE.value,this.ZBc.I$f(this.zj));
return 0!==Kb?(Kb=this.ZBc.idd(Kb).Description,this.EXd(Kb),this.CTd(),!1):!0};n.prototype.isEnabled=function(){return!0};n.prototype.EXd=function(Kb){this.NU.innerHTML=Kb};n.prototype.Rkd=function(){this.NU=document.getElementById("errorText");this.NU.style.display="inline-block";this.RAa=!1;this.EXd("");this.dIa.style.maxWidth=this.dIa.currentStyle.minWidth};n.prototype.CTd=function(){this.LQ.qa(wa.a.click,this.zj.FE,this.Jmc);this.LQ.qa(wa.a.Lb,this.zj.FE,this.Jmc);this.RAa=!0};n.prototype.RAc=
function(){this.RAa&&(this.LQ.Aa(wa.a.click,this.zj.FE,this.Jmc),this.LQ.Aa(wa.a.Lb,this.zj.FE,this.Jmc),this.RAa=!1)};Object(u.a)(n,"InsertImageDialogWrapper",A,[]);var W=b(50),La=b(58),Ia=E.a;Rk(w,Ia);w.prototype.dispose=function(){T.a.Ia(this.S_b);this.zj&&this.zj.zke();this.zj=this.S_b=this.jb=null};w.prototype.I5i=function(Kb){function Ub(){Db.Ow(!0)}var gb=this;if(!this.$)return G.ULS.sendTraceTag(526399119,0,50,"ReadPictureAsDataURLTask: EwaControl is null"),La.Task.Ua(!0);if(!this.$.wba)return La.Task.Ua(!0);
var Db=new K.a,Va=new FileReader;Kb=Kb.FE.files[0];Va.onload=function(){gb.QCd=Va.result;Db.Ow(!0)};Va.onerror=Ub;Va.onabort=Ub;Va.readAsDataURL(Kb);return Db.task};w.prototype.I$f=function(Kb){var Ub=-1;Kb=Kb.FE;(null===Kb||void 0===Kb?0:Kb.files)&&0<Kb.files.length&&(Ub=Kb.files[0].size);return Ub};w.prototype.ZYd=function(Kb,Ub){var gb=w.f3g(E.a.KBa(Kb));0===gb?-1!==Ub&&(G.ULS.sendTraceTag(526399118,0,50,"Validating picture, pictureSize: {0}, maxAllowedSize: {1}, remainingWorkbookSize: {2}",Ub,
this.Dkc,this.$.ea.Wif),Ub>this.Dkc?gb=3:Ub>this.$.ea.Wif&&(gb=7)):6===gb&&this.ywi(Kb);G.ULS.sendTraceTag(526399117,0,50,"Validated file on client, validation result: {0}",gb);return gb};w.prototype.KBa=function(Kb,Ub){Kb=this.ZYd(Kb,this.I$f(Ub));return 0!==Kb?(this.e1a||1===Kb||this.pRd(Kb),!1):!0};w.prototype.e$f=function(Kb){Kb.RFj()};w.prototype.idd=function(Kb){var Ub=0,gb=1,Db=-1100324317,Va="InsertPictureUnknownError",yb=null;switch(Kb){case 1:Ub=1733;gb=0;Db=940870981;Va="InsertPictureNoFileSelected";
break;case 3:gb=0;Db=1250467391;Va="InsertPicturePictureTooBig";yb=String.format(ka.a.instance.lb(176),this.Myi.toLocaleString());break;case 6:Ub=1737;gb=0;Db=1380041209;Va="InsertPictureUnsupportedFormat";break;case 7:Ub=1734;gb=0;Db=-903115058;Va="InsertPictureExceedWorkbookSize";break;case 4:Ub=1735;gb=0;Db=1218352119;Va="InsertPictureUploadTimeout";break;case 5:Ub=1736,gb=0,Db=1979899005,Va="InsertPictureServiceNonDeterministicError"}Kb=w.Wc(Ub,gb,Db,Va);yb&&(Kb.Description=yb);return Kb};w.prototype.showDialog=
function(){this.vve()?(this.e1a=!1,this.zj=new z(this.$.domElement,this.XEb,this.Aoa,this.fa,!1,this.$,!0)):(G.ULS.sendTraceTag(526399115,0,50,"Showing Insert Picture dialog"),!this.Y6a&&(M.a.Vu||M.a.hF&&72>M.a.Bxe)?(this.e1a=!1,this.zj=new z(this.$.domElement,this.XEb,this.Aoa,this.fa,!1,this.$)):(this.e1a=!0,this.zj=(new n(this,this.$,this.fa)).zj))};w.prototype.U3h=function(Kb){var Ub={};try{if(Ub=O.a.Vh(Kb),W.b().wA(this.PZd.id,Ub.ServerCorrelationId,"actions","ServerActions"),!X.a.Rg(Ub.Errors)&&
Ub.Result){this.$.ea.nX(Ub.StateId,"BasePictureUploaderWrapper.UploadResponseReceived");var gb=Ub.Result;Y.a(this.$).bna(1,gb);var Db=this.$.da.za(277);Db&&Db.UTc(this.$,1,Ub.Result,Ub,"InsertPicture");G.ULS.sendTraceTag(526399114,0,50,"Insert picture completed successfully :)")}}catch(Va){G.ULS.sendTraceTag(526399113,0,50,"BasePictureUploaderWrapper.HandleSuccessCallback: got exception while try to JSON.Parse string length: {0}, errror: {1}",Kb?Kb.length:-1,Va)}this.rAc(Ub,null,"InsertPictureWebMethod")};
w.prototype.w4e=function(Kb){Kb={Errors:[this.idd(Kb)]};this.rAc(Kb,null,"InsertPictureWebMethod")};w.prototype.rAc=function(Kb,Ub,gb){this.ot(Kb,Ub,gb)};w.prototype.hWd=function(Kb,Ub,gb){this.kaa(Kb,Ub,gb)};w.prototype.pRd=function(Kb){Kb=this.idd(Kb);Z.EwaSettings.qz()?new H.a(this.$,Kb):(new N.ErrorDialog(this.$,Kb)).hf()};w.prototype.ywi=function(Kb){var Ub=this.$.ya.InsertPicturUnsupportedExtensionsForLogging;Kb=F.a.rl(Kb);for(var gb=0;gb<Ub.length;++gb)if(Kb.endsWith(Ub[gb])){G.ULS.sendTraceTag(526399112,
0,50,"Insert picture blocked invalid extension: {0}",Ub[gb]);break}};w.tVj=function(Kb){return!Kb||ea.a.equals(Kb,J.a.insertPictureUnknownError,!0)?2:ea.a.equals(Kb,J.a.insertPictureNoFileSelectedError,!0)?1:ea.a.equals(Kb,J.a.Obi,!0)?3:ea.a.equals(Kb,J.a.Pbi,!0)?5:0};w.Wc=function(Kb,Ub,gb,Db){return X.a.Wc(1,0,0,Kb,Ub,gb,Db)};w.f3g=function(Kb){switch(Kb){case 1:return 1;case 2:return 6}return 0};w.prototype.vve=function(){return Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5329840_InsertPictureOpenFileBrowserDirectly")&&
!this.Y6a&&void 0!==window.self.FormData&&null!==window.self.FormData?!0:!1};Af.Object.defineProperties(w.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.jb}},Myi:{configurable:!0,enumerable:!0,get:function(){return this.Dkc/1024/1024}}});Object(u.a)(w,"BasePictureUploaderWrapper",E.a,[10]);Rk(f,w);f.prototype.yzj=function(){this.Dkc=28E5;this.pRd(3)};f.prototype.F$c=function(Kb){var Ub=this;G.ULS.sendTraceTag(526399111,0,50,"FileReaderUploaderWrapper.finalizeUploadImpl - Start function.");
var gb=new FileReader;Kb=Kb.FE.files;if(0==Kb.length)G.ULS.sendTraceTag(526399110,0,15,"FileReaderUploaderWrapper.finalizeUploadImpl - No image file found.");else{var Db=Kb[0];gb.onload=function(){Ub.k9b.stop();Ub.bzh.zSi(gb.result,Ub);G.ULS.sendTraceTag(526399109,0,50,"FileReaderUploaderWrapper.finalizeUploadImpl - End function. Type:{0}, Size:{1}",Db.type,Db.size.toString())};gb.onerror=function(){Ub.k9b.stop();G.ULS.sendTraceTag(526399108,0,10,"FileReaderUploaderWrapper.finalizeUploadImpl - Can't read image. Type:{0}, Size:{1}",
Db.type,Db.size.toString())};gb.onabort=function(){Ub.k9b.stop();G.ULS.sendTraceTag(526399107,0,10,"FileReaderUploaderWrapper.finalizeUploadImpl - Aborted read image. Type:{0}, Size:{1}",Db.type,Db.size.toString())};this.k9b.start();gb.readAsDataURL(Db)}};f.prototype.finalizeUpload=function(Kb,Ub){this.F$c(Kb,Ub)};Object(u.a)(f,"FileReaderUploaderWrapper",w,[623]);var mb=b(564),fb=b(389),Ma=b(177);m.prototype.getSheetName=function(){return this.sheetName};Object(u.a)(m,"MacroRecorderPictureInsertedPayload",
null,[409]);Rk(l,w);l.prototype.F$c=function(Kb,Ub){var gb=this;w.prototype.finalizeUpload.call(this,Kb,Ub);fb.a(this.$.userOperationManager,function(Db,Va){gb.ot=Db;gb.kaa=Va;gb.PZd.start();gb.S_b.Kq();gb.Rzc=!1;gb.e$f(Kb);return gb.I5i(Kb)},function(Db){function Va(){return new m(qb,gb.QCd?gb.QCd:"")}var yb={};gb.$.Oj(yb);var qb=yb.SheetName;Db=Z.EwaSettings.Zb()?new Ma.a(510,0,Db,72,Va):new mb.a(510,0,Db,8,Va);Db.qna(function(){return!0});Db.Ed=gb.Ed;return Db},this.Ed)};l.prototype.finalizeUpload=
function(Kb,Ub){this.F$c(Kb,Ub)};Object(u.a)(l,"PictureUploaderWrapper",w,[]);Object(u.a)(k,"UploadBlobParameters",null,[]);Rk(e,l);e.prototype.hWd=function(Kb,Ub,gb){l.prototype.hWd.call(this,Kb,Ub,gb);this.H0.setException(Error.create("DataUrlUploaderWrapper.TriggerFailedCallback: File upload request failed"))};e.prototype.rAc=function(Kb,Ub,gb){l.prototype.rAc.call(this,Kb,Ub,gb);X.a.Rg(Kb.Errors)?this.H0.setException(Error.create(String.format("DataUrlUploaderWrapper.TriggerSuccessCallback: File upload request returned with errors: {0}",
X.a.Dc(Kb.Errors)))):this.H0.setResult(!0)};e.prototype.e$f=function(Kb){var Ub=new k(this.hec.name,this.hec);Kb.D6f(Ub)};e.cFh=function(Kb){var Ub=Kb.split(",");Kb=Ub[0].includes("base64")?window.self.atob(Ub[1]):window.self.decodeURI(Ub[1]);Ub=Ub[0].split(":")[1].split(";")[0];for(var gb=new Uint8Array(Kb.length),Db=0;Db<Kb.length;Db++)gb[Db]=Kb.charCodeAt(Db);Kb=new Blob([gb],{type:Ub});Kb.name="Image.png";return Kb};Object(u.a)(e,"DataUrlUploaderWrapper",l,[]);d.prototype.vai=function(Kb,Ub,gb,
Db,Va){new l(Kb,Ub,gb,Db,Va,!0)};d.prototype.s$h=function(Kb,Ub,gb,Db,Va,yb){new e(Kb,null,Ub,gb,Db,Va,yb)};d.prototype.E$h=function(Kb,Ub,gb,Db,Va){new f(Kb,Ub,gb,Db,Va,!0)};Object(u.a)(d,"UploaderCreator",null,[604]);var Hb=C.a;Rk(c,Hb);c.ka=function(Kb){Kb.da.Ga(485,new c(Kb))};c.prototype.create=function(){var Kb;this.pb(null!==(Kb=this.$.da.za(484))&&void 0!==Kb?Kb:this.$.da.Ga(484,new d))};Object(u.a)(c,"UploaderCreatorFactory",C.a,[]);b.d(D,"a",function(){return a})},1396:function(u,D,b){function a(){f.a.Fa(function(ba){c.ka(ba)})}
function c(ba){return na.call(this,ba)||this}function d(ba,sa){this.$=ba;this.uploaderCreator=sa}function e(ba,sa,ya,va,W,La){var Ia=Ka.call(this,null,ya,va)||this;Ia.Cmf=0;Ia.EPi=function(mb){K.a(mb)?A.ULS.sendTraceTag(537155799,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded with errors. Errors: {0}",F.a.Dc(mb.Errors)):(A.ULS.sendTraceTag(537155801,0,50,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded."),mb.Result?H.a(Ia.$).bna(1,mb.Result):
A.ULS.sendTraceTag(537155800,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess:Result.result is null"))};Ia.DPi=function(){A.ULS.sendTraceTag(537155798,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadFailed: Operation failed")};Ia.$=ba;Ia.Ed=sa;Ia.H0=La;Ia.upe=y.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");Ia.showDialog();return Ia}function k(ba,sa,ya,va,W,La){var Ia=ta.call(this)||this;Ia.tgc=!1;Ia.Zva=null;Ia.yR=null;Ia.fNa=null;Ia.SGi=function(){Ia.hua(Ia.Lob)};
Ia.wrd=function(mb){mb.keyCode===Sys.UI.Key.tab&&("KeepFocusDiv"!==mb.target.id||mb.shiftKey?"KeepFocusStartDiv"===mb.target.id&&mb.shiftKey&&(mb.preventDefault(),document.getElementById("KeepFocusDiv").focus()):(mb.preventDefault(),document.getElementById("KeepFocusStartDiv").focus()))};Ia.UNi=function(){Ia.Bnb&&(Ia.Bnb.launchUpsellExperience("stockimages"),A.ULS.sendTraceTag(537155807,0,50,"OnLaunchM365Upsell: Launched Dime Upsell flow"))};Ia.Al=La;Ia.$=ba;Ia.o$e=sa;Ia.Bnb=ya;Ia.bAa=[];Ia.epf=va;
Ia.Jeh=W;Ia.Koe=Ia.$.ya.InsertOnlinePictureMaxCountOfImagesToInsert;Ia.Wf=Ia.Z6g();return Ia}function l(){}function m(ba,sa){return S.call(this,ba,Qa.a.Maa(sa))||this}var f=b(11);u=b(0);var w=b(905),n=b(162),z=b(104),r=b(4),v=b(186),A=b(15),B=b(1563),y=b(84),x=b(30),C=b(99),G=b(619),E=b(178),I=b(45),U=b(389),M=b(177),T=b(258),F=b(29),K=b(296),J=b(10),O=b(14),N=b(295),H=b(105),Q=b(21),ca=b(150),X=b(89),Z=b(96),ea=b(170),ka=b(183),Y=b(83),qa=b(98),fa=b(160),ha=b(357),ia=b(1),wa=b(1444),Qa=b(81),S=wa.a;
Rk(m,S);m.prototype.Crc=function(ba,sa){this.isEnabled()&&this.sFa(this.targetOrigin)&&(this.Wn(ba),this.Ml(ba,sa))};Object(u.a)(m,"InsertMediaCrossDocumentMessenger",wa.a,[665,185,10]);var da=b(7);Object(u.a)(l,"OnlineMediaSearchResult",null,[]);var xa=b(326),ta=ca.a;Rk(k,ta);k.prototype.Yzj=function(ba){var sa=this;this.tgc=!1;this.showDialog(this.Al,null);this.Zva=document.getElementById(this.di("InsertMediaFrame"));if(!this.Zva)throw this.hua(this.Lob),Error.invalidOperation("Couldn't get InsertMediaIframe.");
var ya=document.getElementById(this.di("WACDialogPanel"));ya&&ya.setAttribute(X.a.Hd,X.a.cZa);ya=document.createElement("div");ya.id="KeepFocusStartDiv";ya.tabIndex=0;ya.className="keep-focus-start";this.Zva.parentNode.insertBefore(ya,this.Zva.parentNode.firstChild);ya=document.createElement("div");ya.id="KeepFocusDiv";ya.tabIndex=0;ya.className="keep-focus";this.Zva.parentNode.appendChild(ya);$addHandler(this.dIa,"keydown",this.wrd);this.Zva.src=this.o$e;this.Zva.frameBorder="0";ya=document.getElementById(this.di("WACDialogButtonPanel"));
if(!ya)throw Error.invalidOperation("Couldn't get WACDialogButtonPanel.");ya.className="display-none";ya=document.getElementById(this.di("WACDialogTitleText"));if(!ya)throw Error.invalidOperation("Couldn't get WACDialogTitleText.");ya.className="display-none";2===this.epf&&(document.getElementById(this.di("WACDialogTitlePanel")).className="display-none",document.getElementById(this.di("WACDialogBodyPanel")).className="padding-zero");Z.FocusManager.instance().yQ().scope.$M=!0;this.yR=new m(this.Zva.contentWindow,
this.o$e);this.yR.Crc(ea.a.oBg,function(va){sa.NFi(va,Object(Y.a)(ba,ba.Aoa,"uploadResponseReceived"))});this.yR.Crc(ea.a.insert,function(){sa.jNi(Object(Y.a)(ba,ba.Aoa,"uploadResponseReceived"))});this.yR.Crc(ea.a.rZc,this.SGi);2===this.epf&&0===this.Jeh&&(this.yR.Crc(ea.a.cri,this.UNi),this.fNa=this.Bnb.zma("MsoPremiumStockImages",function(va){A.ULS.sendTraceTag(537155811,0,50,"OnCompleteM365Upsell: Upsell completed from stock images");if(va.isEnabled){var W={};sa.yR.xj(ea.a.ZTj,(W.LicenseTier=
va.toString(),W))}else A.ULS.sendTraceTag(537155810,0,10,"OnCompleteM365Upsell: Upsell completed but license tier didn't upgrade.")}))};k.prototype.dispose=function(){this.bAa=null;this.Bnb&&this.fNa&&this.Bnb.JHd("MsoPremiumStockImages",this.fNa);this.yR&&(this.yR.dispose(),this.yR=null);ta.prototype.dispose.call(this)};k.prototype.hide=function(){ta.prototype.hide.call(this);qa.a.Nvc(this.$)};k.prototype.NFi=function(ba,sa){ba=ba&&ba.Values?(ba=ba.Values)?Object(da.a)(new l,{Action:ba.action||"",
Caption:ba.caption||"",ContentType:ba.contentType||"",FileExtension:ba.extension||"",PageUrl:ba.pageUrl||"",SourceUrl:ba.sourceUrl||"",ThumbnailUrl:ba.thumbnailUrl||"",LicenseUrl:ba.licenseUrl||"",LicenseDisplayName:ba.licenseDisplayName||"",Height:ba.height||0,Width:ba.width||0}):null:null;ba&&(this.bAa.push(ba),this.tgc&&(A.ULS.sendTraceTag(537155809,0,50,"InsertMediaDialog.OnAddItem: Insert Message handling was pending"),sa(this.bAa),this.tgc=!1,this.hua(this.Lob)))};k.prototype.jNi=function(ba){this.bAa&&
0<this.bAa.length?this.bAa.length<=this.Koe?(ba(this.bAa),this.hua(this.Lob)):(this.Oz(),A.ULS.sendTraceTag(537155808,0,10,"OnInsert : Tried to insert more than allowed limit of items."),Array.clear(this.bAa)):this.tgc=!0};k.prototype.Z6g=function(){var ba=document.createElement("div");ba.id="InsertMediaDialog";ba.className=ia.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixHorizonalScroll",!0)?"insert-media-dialog":"insert-media-dialog-old";var sa=document.createElement("div");
sa.id="InsertMediaPanel";sa.className=ia.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixCancelButton",!0)?"insert-media-panel":"insert-media-panel-old";var ya=document.createElement("iframe");ya.id="InsertMediaFrame";ya.className="insert-media-frame";ba.appendChild(sa);sa.appendChild(ya);return xa.b(ba)};k.prototype.Oz=function(){var ba=F.a.Wc(1,0,0,0,0,466721363,"InsertPictureExceededAllowedCount");ba.Description=String.format(O.a.instance.lb(201),this.Koe.toLocaleString());
ia.EwaSettings.qz()?new ha.a(this.$,ba):(new fa.ErrorDialog(this.$,ba)).hf()};Af.Object.defineProperties(k.prototype,{Z3:{configurable:!0,enumerable:!0,get:function(){return ka.a.f6b+"/InsertMediaDialog"}},canBePreempted:{configurable:!0,enumerable:!0,get:function(){return!1}}});Object(u.a)(k,"InsertMediaDialog",ca.a,[]);var ab=b(494),Na=b(397),Ka=B.a;Rk(e,Ka);e.prototype.Aoa=function(ba){var sa=this;if(ba){for(var ya=Array(ba.length),va=0;va<ba.length;va++){var W=ba[va];ya[va]={};ya[va].SourceUrl=
W.SourceUrl;x.a.Dwa(W.LicenseUrl)&&x.a.Dwa(W.PageUrl)&&(ya[va].LicenseUrl=W.LicenseUrl,ya[va].LicenseDisplayName=W.LicenseDisplayName,ya[va].PageUrl=W.PageUrl);ya[va].AltText=-2053056795===this.Ed.command?W.Caption:""}var La=-2009825598===this.Ed.command?"bing":"M365";va=Q.g(this.$);var Ia=I.o(va.ha.sa.activeCell,this.$);U.a(this.$.userOperationManager,function(mb,fb,Ma){return T.r(sa.$.oa.xa,Ia,ya,La,N.b(mb,sa.EPi),N.a(fb,sa.DPi),Ma,null)},function(mb){return new M.a(595,0,mb)},this.Ed);J.HelperMethods.ZZ?
(va=new Map,va.set("MediaProvider",La),va.set("ImagesCount",ba.length.toString()),va.set("TimeTakenToOpenDialog",this.Cmf.toString()),C.Health.instance.recordKpiUsage(Na.a.Lbi,1,ab.a.b8f,va)):A.ULS.sendTraceTag(537155805,0,15,"OnlinePictureUploaderWrapper.UploadResponseReceived: KPI Usage not supported.");this.woc()}else A.ULS.sendTraceTag(537155806,0,10,"OnlinePictureUploaderWrapper.UploadResponseReceived: Response is null")};e.prototype.dispose=function(){this.$=null};e.prototype.showDialog=function(){var ba=
this,sa=null;sa=this.$.Fb.sc("UserAction","showOnlineImagesDialogTimeStopwatch");switch(this.Ed.command){case -2009825598:this.jzj();break;case -2053056795:this.upe.execute(function(ya){ya.isFeatureEnabled("MsoPremiumStockImages",!1).catch(function(va){return A.ULS.sendTraceTag(557200643,0,10,"OnlinePictureUploaderWrapper::ShowDialog - Failed to load the premium state from application feature helper: {0}",va)}).then(function(va){ba.kzj(va);return null})})}sa.stop();this.Cmf=sa.qc};e.prototype.jzj=
function(){var ba=this.$.ya.BingPictureEndpoint,sa=G.a.cH(r.AFrameworkApplication.lcid),ya=E.a.create();ba?(ba=0<ba.search(RegExp("insertmedia.bing.office.net","gi"))?String.format(ba,1,1):String.format(ba,1,r.AFrameworkApplication.lcid,sa?sa.name:"en-us",r.AFrameworkApplication.buildVersion,ya.toString(),1,this.$.ya.DocumentHostInfo.LoggableUserId),this.c4b(ba,1,-1,O.a.instance.ga(1739))):(A.ULS.sendTraceTag(537155804,0,10,"OnlinePictureUploaderWrapper::ShowDialogForBingPictures - Can't access the Bing service endpoint"),
this.H0.setException(Error.create("Failed to access the Bing service endpoint")))};e.prototype.kzj=function(ba){var sa=this.$.ya.M365PictureEndpoint,ya=E.a.create();if(sa){var va=this.$.ya.DocumentHostInfo.UserId;va=va?x.a.Nv(va).toString():"0";var W=this.upe.instance.isFreemiumUpsellEnabled();ba=ba?1:W?0:-1;ya=ya.toString();W=G.a.cH(r.AFrameworkApplication.lcid).name;sa=String.format(sa,r.AFrameworkApplication.lcid,W,r.AFrameworkApplication.buildVersion,ya,1,va,ba,1);this.c4b(sa,2,ba,O.a.instance.ga(1738))}else A.ULS.sendTraceTag(537155803,
0,10,"OnlinePictureUploaderWrapper::ShowDialogForStockImages - Can't access the M365 service endpoint"),this.H0.setException(Error.create("Failed to access the M365 service endpoint"))};e.prototype.c4b=function(ba,sa,ya,va){try{(new k(this.$,ba,y.a.instance.nh("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),sa,ya,va)).Yzj(this),this.H0.setResult(!0)}catch(W){A.ULS.sendTraceTag(537155802,0,10,"OnlinePictureUploaderWrapper::CreateAndShowDialog failed [Exception : {0}] [MediaProvider : {1}] [DialogLicenseTier : {2}]",
W,sa,ya),this.H0.setException(W)}};Object(u.a)(e,"OnlinePictureUploaderWrapper",B.a,[10]);var la=b(58);d.prototype.executeCommand=function(ba,sa,ya){ba=sa.command;switch(ba){case 1403967063:if(ya&&"dataUrl"in ya)return sa=new n.a,this.uploaderCreator&&this.uploaderCreator.s$h(this.$,z.a.instance,r.AFrameworkApplication.fa,ya,ya.dataUrl,sa),sa.task;this.uploaderCreator&&this.uploaderCreator.vai(this.$,sa,z.a.instance,r.AFrameworkApplication.fa,ya);return la.Task.Ua(!0);case -2053056795:case -2009825598:return ba=
new n.a,new e(this.$,sa,z.a.instance,r.AFrameworkApplication.fa,ya,ba),ba.task;default:return v.a(ba)}};d.prototype.Ac=function(ba,sa){if(ba=this.$.isEditMode)switch(sa.command){case 1403967063:ba=!0;break;case -2053056795:ba=!0;break;case -2009825598:ba=!0;break;default:ba=!1}return ba};d.prototype.Qc=function(){return!1};d.prototype.Lc=function(){return!1};Object(u.a)(d,"PictureCommandHandler",null,[403]);var Ea=b(37),ra=b(51),na=w.a;Rk(c,na);c.prototype.zd=function(){var ba=this;Ea.TaskExtensions.Ba(ra.GetServiceTaskFactory.Ra(this.$.da,
484,485,1),function(sa){ba.jd([new d(ba.$,sa.result)])},this.$.la,3)};c.ka=function(ba){w.a.Qd(90,new c(ba))};Object(u.a)(c,"PictureCommandHandlerFactory",w.a,[]);b.d(D,"a",function(){return a})},1419:function(u,D,b){function a(){k.a.Fa(function(y){c.ka(y)})}function c(y){var x=B.call(this)||this;x.$=y;x.Eb();return x}function d(y,x){var C=A.call(this)||this;C.$=y;C.Ku=x;C.wua={};C.iS={};C.Zqe=!1;C.styles=null;C.tKi=function(G,E,I){m.ULS.sendTraceTag(520710152,1,50,"FontServiceManager.onFontPreviewRequestComplete: Attempt to request FontUrl method: {0} has succeeded.",
I);C.A_i(G);C.Zqe=!0;C.t3i()};C.uKi=function(G,E,I){m.ULS.sendTraceTag(520710151,1,10,"FontServiceManager.onFontPreviewRequestFailed: Encountered errors for {0}.",I)};C.gfj=function(){C.cn&&C.Bdd(C.tKi,C.uKi)};C.cn=r.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FontServiceIntegration",!1);C.gfj();return C}function e(){}var k=b(11);u=b(0);var l=b(232),m=b(15),f=b(559),w=b(38),n=b(61);e.Bdd="GetFontPreviewData";Object(u.a)(e,"FontWebServiceMethods",null,[]);var z=b(10),r=b(1),v={xlyellow:"xlyellow"},
A=w.a;Rk(d,A);d.prototype.A_i=function(y){var x=this;if(this.foi(y)){var C=z.HelperMethods.dca(function(){var G=y.Result;x.styles='@font-face{font-family:"msofpNew";font-style:normal;font-weight:normal;src:url(\''+G.PreviewUrl+"') format('truetype')}";var E=G.FontFacePropertiesList;G.FontNameList.forEach(function(I,U){x.wua[I]=E[U].Codepoint;x.styles=x.PJg(x.styles,I,"https://fs.microsoft.com/fs/"+G.CatalogVersion+"/rawguids/"+E[U].FontGuid);x.iS[I]=I});f.a.vi(x.styles)});10<C&&m.ULS.sendTraceTag(520710159,
1,50,"FontServiceManager.prepareFontCodepointMap: Duration for prepareFontCodepointMap the model, duration={0}",C)}};d.prototype.foi=function(y){if(!y.Result)return m.ULS.sendTraceTag(520710158,1,15,"FontServiceManager.isValidFontPreviewData: Result in EwaResult is Null."),!1;y=y.Result;return y?y.PreviewUrl?y.FontFacePropertiesList?y.FontNameList?0===y.FontFacePropertiesList.length||y.FontFacePropertiesList.length!==y.FontNameList.length?(m.ULS.sendTraceTag(520710153,1,15,"FontServiceManager.isValidFontPreviewData: Mismatch in length of FontFacePropertiesList and FontNameList in fontListPreviewData."),
!1):!0:(m.ULS.sendTraceTag(520710154,1,15,"FontServiceManager.isValidFontPreviewData: FontNameList in fontListPreviewData is Null."),!1):(m.ULS.sendTraceTag(520710155,1,15,"FontServiceManager.isValidFontPreviewData: FontFacePropertiesList in fontListPreviewData is Null."),!1):(m.ULS.sendTraceTag(520710156,1,15,"FontServiceManager.isValidFontPreviewData: PreviewUrl in fontListPreviewData is Null."),!1):(m.ULS.sendTraceTag(520710157,1,15,"FontServiceManager.isValidFontPreviewData: fontListPreviewData is Null."),
!1)};d.prototype.PJg=function(y,x,C){return y+('@font-face{font-family:"'+x+"\";src:url('"+C+"')}")};d.prototype.Bdd=function(y,x){var C=this.Ku,G=this.Ku.Pb(),E=e.Bdd;G=C.Na(5,void 0===G?null:G);return n.g(C,E,G,y,x,null,null,644)};d.prototype.t3i=function(){this.Bnd&&this.raiseEvent(d.QTe)};d.prototype.isFontSupported=function(y){return this.cn&&this.iS&&(!!this.iS[y]||!!v[y.replace(/\s/g,"").toLowerCase()])};d.prototype.dne=function(y){this.addHandler(d.QTe,y)};Af.Object.defineProperties(d.prototype,
{Tyc:{configurable:!0,enumerable:!0,get:function(){return this.iS}},FCh:{configurable:!0,enumerable:!0,get:function(){return this.wua}},Bnd:{configurable:!0,enumerable:!0,get:function(){return this.Zqe}}});d.QTe="fsmFD";Object(u.a)(d,"FontServiceManager",w.a,[599]);var B=l.a;Rk(c,B);c.ka=function(y){y.da.Ga(505,new c(y))};c.prototype.create=function(){this.pb(new d(this.$,this.$.oa.Ku))};Object(u.a)(c,"FontServiceManagerFactory",l.a,[]);b.d(D,"a",function(){return a})},1457:function(u,D,b){function a(){x.a.Fa(function(C){c.ka(C)})}
function c(C){var G=y.call(this)||this;G.$=C;G.Eb();return G}function d(C,G,E){var I=A.call(this)||this;I.statusBarManager=null;I.qHe=function(){I.o6b()};I.mfh=function(){I.o6b()};I.pHe=function(U){10===U&&I.o6b()};I.onKeyDown=function(U){if(13===U.Ca.keyCode){U=new n.a(237279923,1,2,6,null);var M={};I.$.Ka.Kb(U,(M[v.a.skipClipboardAccess]=!0,M[v.a.lLe]=!0,M));return!0}return!1};I.$=C;I.kr=G;I.lm=E;I.S7c=!1;I.T1f=z.EwaSettings.getBooleanFeatureGate(w.a.oPa,!1);I.Bgf=z.EwaSettings.isChangeGateEnabled("OfficeVSO:6082903_PasteToEnterKeyDownEventForGrid");
I.T1f&&I.$.da.Za(29,function(U){I.statusBarManager=U;U.jJ(I)});return I}u=b(0);var e=b(109),k=b(232),l=b(15),m=b(13),f=b(38),w=b(328),n=b(92),z=b(1),r=b(21),v=b(5),A=f.a;Rk(d,A);d.prototype.dispose=function(){this.Uj();this.lm=this.kr=this.$=null;this.statusBarManager&&(this.statusBarManager.BF(this),this.statusBarManager=null)};d.prototype.dn=function(){return this.T1f};d.prototype.Lr=function(C,G){if("QueryPasteShortcutEnabledLabel"!==C&&!Array.contains(d.cFj,C))return!1;var E=this.ko();"QueryPasteShortcutEnabledLabel"===
C?(G.Visible=E,l.ULS.sendTraceTag(537167636,0,100,"PasteShortcutManager.ExecuteRootCommand: Setting visible to {0} for commandId {1}",E,C)):(G.Visible=!E,l.ULS.sendTraceTag(537167635,0,100,"PasteShortcutManager.ExecuteRootCommand: Setting visible to {0} for commandId {1}",!E,C));return!0};d.prototype.hkh=function(){this.Ti();this.raiseEvent("pasteShortcutStatusChanged")};d.prototype.o6b=function(){this.Uj();this.raiseEvent("pasteShortcutStatusChanged")};d.prototype.ko=function(){return this.S7c};
d.prototype.jq=function(C){this.addHandler("pasteShortcutStatusChanged",C)};d.prototype.Hq=function(C){this.removeHandler("pasteShortcutStatusChanged",C)};d.prototype.Ti=function(){if(!this.ko()){this.S7c=!0;r.g(this.$).Ki.Bk(this.qHe);this.lm.ka("blur",this.mfh);var C=this.$.da.za(65);C&&C.X2&&C.X2.registerForCommentEvents(this.pHe);this.kr.jt(m.a.Lb,this.Bgf?this.$.Rv:this.$.domElement,this.onKeyDown,!0)}};d.prototype.Uj=function(){if(this.ko()){this.S7c=!1;r.g(this.$).Ki.wk(this.qHe);this.lm.detach("blur");
var C=this.$.da.za(65);C&&C.X2&&C.X2.unregisterForCommentEvents(this.pHe);this.kr.tt(m.a.Lb,this.Bgf?this.$.Rv:this.$.domElement,this.onKeyDown,!0)}};d.cFj=["QuerySheetNumberButton","QueryWorkbookStatisticsButton"];Object(u.a)(d,"PasteShortcutManager",f.a,[603,465,157,10]);var B=b(130),y=k.a;Rk(c,y);c.prototype.create=function(){var C=this.$;this.pb(C.da.za(478)||this.$.da.Ga(478,new d(C,e.KeyInputManager.instance,B.a.instance.LG())))};c.ka=function(C){C.da.Ga(479,new c(C))};Object(u.a)(c,"PasteShortcutManagerFactory",
k.a,[]);var x=b(11);b.d(D,"a",function(){return a})},1458:function(u,D,b){function a(){e.a.Fa(function(F){c.ka(F)})}function c(F){var K=T.call(this)||this;K.$=F;K.Eb();return K}function d(F,K,J,O){var N=this;this.recoveryUI=null;this.lya=function(){N.qba()&&(N.grid.Zab(N.lya),N.f$f())};this.f$f=function(){if(x.g(N.$).Ab.e5(N.pasteRange))w.ULS.sendTraceTag(526758983,306,50,"RecoveryUIController:triggerHandRaiseAfterConsistentGrid Last paste was a table. Table hand raise is not triggered.");else if(x.g(N.$).Ab.c5(N.pasteRange))w.ULS.sendTraceTag(526758982,
306,50,"RecoveryUIController:triggerHandRaiseAfterConsistentGrid Last paste was a pivot table. Table hand raise is not triggered.");else{var H=E.d(N.$.va.pa);H=new I.a(N.pasteRange,H);N.oMj(H)}};this.Ycg=function(){N.recoveryUI&&(N.BZd=y.a.Ta.Xd.m,N.hide(),B.a.instance.create(function(){N.ISj()},250,"RecoveryUI.UpdatePositionOnVisibleAreaChanged",void 0,!0))};this.FHe=function(H){10===H&&N.kIa()};this.Efh=function(){if(N.recoveryUI){var H=document.getElementById("PasteRecoveryUI");H&&v.a.Xj===H.getAttribute(v.a.pY)&&
H.click();N.documentHidden=!0;N.kIa()}};this.GHe=function(){N.kIa()};this.HHe=function(){N.kIa()};this.onKeyUp=function(H){if(N.recoveryUI){if(N.h_)return!1;if(17===H.Ca.keyCode&&N.N8b){H=document.getElementById("PasteRecoveryUI");if(!H)return w.ULS.shipAssertTag(537154070,0,!1,"RecoveryUIController.OnKeyUp: recoveryUIElement is null."),!1;var Q=H.getAttribute(v.a.pY)||"";if(v.a.Yq===Q)return H.click(),!0}}return!1};this.onKeyDown=function(H){if(N.recoveryUI){N.N8b=!1;N.h_=H.ctrlKey;H=H.Ca.keyCode;
if(27===H)return N.kIa(),C.EwaSettings.isChangeGateEnabled("OfficeVSO:6022397_ClearStateWhileHidingRecoveryUI")&&(H=N.$.da.za(254))&&H.$q("RecoveryUIController.onKeyDown",!0,!0).catch(function(){}),!0;if(17===H)return N.N8b=!0}return!1};this.oR=function(H,Q){H=Q.Ed;N.FAb=H;-1027730316!==H.command&&-1059615499!==H.command?N.kIa():(Q=Q.properties)&&Q.launcherId!==N.SQh()&&N.kIa()};this.$=F;this.Vqc=K;this.kr=J;this.lm=O;this.Mrd=this.FAb=this.Crd=null;this.h_=this.N8b=this.t6b=this.Bdc=!1;this.BZd=
0;this.documentHidden=!1;this.grid=x.g(this.$);this.pasteRange=null;C.EwaSettings.xl()||this.$.da.Ga(406,this)}var e=b(11);u=b(0);var k=b(109),l=b(232),m=b(130),f=b(7),w=b(15),n=b(4),z=b(1601),r=b(13),v=b(5),A=b(1246),B=b(47),y=b(28),x=b(21),C=b(1),G=b(45),E=b(64),I=b(355),U=b(37),M=b(51);d.prototype.dispose=function(){this.Wag();this.cbg();this.Mrd=this.Crd=this.recoveryUI=this.lm=this.kr=this.Vqc=this.$=null;this.BZd=0};d.prototype.XNg=function(F){this.recoveryUI=F;this.Crd=F.JHg;this.Mrd=F.N6i};
d.prototype.kIa=function(){this.recoveryUI&&(this.pasteRange=G.K(this.recoveryUI.oxh),this.TCj(),this.hide(),this.Wag(),this.recoveryUI=null)};d.prototype.TCj=function(){var F=[1868184698,-1985798686,753331043,2137617149,237279923,1804571062,1766348718,42074747,-875588320,-958589048,-185374993,-111689794,-1502853784,-1096627081,1441131127,-1027730316];n.AFrameworkApplication.p_("XLS-SmartView-OnPasteEnabled-Control;XLS-SmartView-OnPasteEnabled-Treatment");C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.OnPasteEnabled",
!1)&&this.pasteRange&&(w.ULS.sendTraceTag(523622037,0,50,"RecoveryUIController:smartViewOnPaste RecoveryUI is being dismissed."),null!=this.FAb&&F.includes(this.FAb.command)?(w.ULS.sendTraceTag(526758984,306,50,"RecoveryUIController:smartViewOnPaste Table hand raise is not triggered. Last command was {0}",A.a[this.FAb.command]),this.FAb=null):this.documentHidden?(w.ULS.sendTraceTag(523833603,306,50,"RecoveryUIController:smartViewOnPaste Table hand raise is not triggered. User clicked outside of document."),
this.documentHidden=!1):this.qba()?this.f$f():(w.ULS.sendTraceTag(520725721,306,50,"RecoveryUIController:smartViewOnPaste Grid is not in consistent state."),this.grid.sYa(this.lya)))};d.prototype.qba=function(){return this.grid.Ea.bK(4,this.$.pa)};d.prototype.kli=function(){return!!this.recoveryUI&&this.Vqc.yhi};d.prototype.VAj=function(F){this.recoveryUI?this.show(F):w.ULS.shipAssertTag(537154072,0,!1,"RecoveryUIController.ShowRecoveryUI: recoveryUI is null.")};d.prototype.SQh=function(){return this.recoveryUI?
this.recoveryUI.vri:null};d.prototype.show=function(F){var K=this.recoveryUI.LMh();K?(this.Vqc.showFloatie(Object(f.a)(new z.a,{x:K.x,y:K.y}),this.recoveryUI.KJa(),F),this.Ti()):w.ULS.sendTraceTag(537154071,0,100,"RecoveryUIController.Show: point is null.")};d.prototype.hide=function(){this.kli()&&this.Vqc.wC();this.cbg()};d.prototype.Ti=function(){if(!this.t6b){var F=x.g(this.$);F.view.Gs(this.Ycg);F.Ki.Bk(this.GHe);this.lm.ka("blur",this.Efh);this.$.Ka.yFa(this.oR);this.$.va.Kf(this.HHe);(F=this.$.da.za(65))&&
F.X2&&F.X2.registerForCommentEvents(this.FHe);this.t6b=!0}this.Bdc||(this.kr.jt(r.a.Lb,this.$.domElement,this.onKeyDown,!0),this.kr.jt(r.a.Gd,this.$.domElement,this.onKeyUp,!0),this.Bdc=!0)};d.prototype.Wag=function(){if(this.t6b){var F=x.g(this.$);F.view.Iq(this.Ycg);F.Ki.wk(this.GHe);this.lm.detach("blur");this.$.Ka.Cza(this.oR);this.$.va.wg(this.HHe);(F=this.$.da.za(65))&&F.X2&&F.X2.unregisterForCommentEvents(this.FHe);this.t6b=!1}};d.prototype.cbg=function(){this.Bdc&&(this.kr.tt(r.a.Lb,this.$.domElement,
this.onKeyDown,!0),this.kr.tt(r.a.Gd,this.$.domElement,this.onKeyUp,!0),this.Bdc=this.h_=this.N8b=!1)};d.prototype.ISj=function(){this.recoveryUI&&250<=y.a.Ta.Xd.m-this.BZd&&this.show(-1)};d.prototype.oMj=function(F){U.TaskExtensions.Ba(M.GetServiceTaskFactory.Ra(this.$.da,426,427,1),function(K){K.result.iea(F,"Paste");w.ULS.sendTraceTag(523622036,0,50,"RecoveryUIController.triggerTableInvitationHandRaise: IntelligentMetadataOverlayManager is triggered.")},this.$.la,3)};Object(u.a)(d,"RecoveryUIController",
null,[638,10]);var T=l.a;Rk(c,T);c.prototype.create=function(){var F=this;if(C.EwaSettings.xl())this.PCi();else{var K=this.$;K.eB(function(J){J.uec().then(function(O){F.pb(F.$.da.za(406)||new d(K,O,k.KeyInputManager.instance,m.a.instance.LG()))})})}};c.prototype.PCi=function(){var F=this,K=this.$,J=this.$.da.za(406);J?this.pb(J):K.eB(function(O){O.uec().then(function(N){J=new d(K,N,k.KeyInputManager.instance,m.a.instance.LG());F.$.da.Ga(406,J);F.pb(J)})})};c.ka=function(F){F.da.Ga(405,new c(F))};
Object(u.a)(c,"RecoveryUIControllerFactory",l.a,[]);b.d(D,"a",function(){return a})},1563:function(u,D,b){function a(z,r,v){z=c.call(this,z,r,v)||this;z.ora=null;z.UUb=null;return z}function c(z,r,v){this.zj=this.iBd=null;this.BEa=this.Tqa=0;this.kSb=null;this.JS=z;this.de=r;this.ib=v;this.e1a=!1;this.AYd=!0;this.Yfj();this.D8a=this.fa.ra("NativeFileOpenDialogIsEnabled")}u=b(0);var d=b(15),e=b(83);b(108);var k=b(25);c.prototype.XEb=function(z){this.zj=z;if(!this.e1a){if(this.AYd){if(this.D8a&&k.a.hF){this.kSb=
z.K6b(Object(e.a)(this,this.qzd,"onFileChosen"));return}this.kSb=z.K6b(null);if(!this.KBa(this.kSb,z))return}this.finalizeUpload(z,null)}};c.prototype.qzd=function(z){if(this.KBa(z,this.zj)){if(k.a.hF||k.a.xf)this.kSb=z;this.finalizeUpload(this.zj,null)}};c.prototype.woc=function(){this.iBd&&this.iBd()};c.prototype.Yfj=function(){this.Tqa=0;this.BEa=this.fa.kd("Box4UploadRetryDelayStart",200);this.zj&&(this.zj.dispose(),this.zj=null)};Af.Object.defineProperties(c.prototype,{context:{configurable:!0,
enumerable:!0,get:function(){return this.JS}},fa:{configurable:!0,enumerable:!0,get:function(){return this.ib}},retryCount:{configurable:!0,enumerable:!0,get:function(){return this.Tqa}},XKd:{configurable:!0,enumerable:!0,get:function(){return this.BEa}}});Object(u.a)(c,"FileUploader",null,[]);var l=b(4),m=b(333),f=b(995),w=b(135),n=b(30);b.d(D,"a",function(){return a});Rk(a,c);a.prototype.dYe=function(z){switch(z){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;
default:return""}};a.prototype.Feg=function(z){return a.KBa(z,this.d_h())};a.prototype.d_h=function(){return a.lie};a.prototype.KBa=function(z,r){r=void 0===r?null:r;z=this.Feg(z);return 0!==z?(r&&r.zke(),2===z&&this.kj(0,this.dYe(z)),!1):!0};a.prototype.finalizeUpload=function(z,r){d.ULS.sendTraceTag(36783360,322,50,"PictureUploader.FinalizeUpload");this.iBd=r;this.fAj();m.a.mark(5576);this.UUb=this.qO.sc("LoadResource","PictureUploadTime")};a.prototype.kj=function(z,r){var v=new w.StandardDialog;
v.Rb=0;v.Oz(z,CommonUIStrings.l_ImageUploadFailedTitle,r,null)};a.prototype.woc=function(){d.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");c.prototype.woc.call(this);this.UUb&&(this.UUb.stop(),this.UUb=null);this.iZg()};a.prototype.fAj=function(){this.ora=(new f.a).create();this.ora.message=CommonUIStrings.l_ImageUploadWait;this.ora.Rb=5;this.ora.Qu=!1;this.ora.GAa(null,null,null)};a.prototype.iZg=function(){this.ora&&(this.ora.close(),this.ora=null)};a.g5h=function(z,r){z=
n.a.rl(z);for(var v=0;v<r.length;++v)if(z.endsWith(r[v]))return!0;return!1};a.KBa=function(z,r){r=void 0===r?null:r;r||(r=a.lie);return z?a.g5h(z,r)?0:2:1};Af.Object.defineProperties(a.prototype,{qO:{configurable:!0,enumerable:!0,get:function(){return l.AFrameworkApplication.ta.tD}}});a.lie=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(u.a)(a,"PictureUploader",c,[])},1635:function(u,D,b){function a(Yb){var Ec=tb.call(this)||this;Ec.$=Yb;Ec.Eb();return Ec}function c(Yb,Ec,bd){bd=void 0===
bd?!0:bd;var Ic=za.call(this)||this;Ic.XRa=null;Ic.Gna=null;Ic.bOa=null;Ic.l3b=null;Ic.z0=null;Ic.Rqf=0;Ic.Iab=!1;Ic.Hab=!1;Ic.Jrc=!1;Ic.documentVisibilityObserver=null;Ic.Sqf=null;Ic.JBj=null;Ic.ufa=!1;Ic.E7=0;Ic.mkd=0;Ic.Bzb=!1;Ic.a4f=0;Ic.mQd=!1;Ic.M0=null;Ic.tEb=function(){va.ULS.sendTraceTag(537155219,0,50,"NetworkConnectionStateManager.OnNetworkDownEvent: Network down.");Ic.blc(1,!1)};Ic.j9a=function(){Ic.oka||Ic.OBb?window.setTimeout(function(){Ic.rVd()},Ic.Rqf):Ic.rVd();Ic.documentVisibilityObserver.OHb(Ic.j9a);
Ic.Bzb=!1};Ic.Df=function(){va.ULS.sendTraceTag(537155218,0,50,"NetworkConnectionStateManager.OnEditEnded: Edit ended. IsInOfflineMode:{0}, IsInDuringWorkSilentReopenMode:{1}",Ic.OBb&&Ic.Owc,Ic.dkc&&!Ic.ufa&&Ic.aLb);Ic.OBb&&Ic.Owc&&Ic.nje();Ic.dkc&&!Ic.ufa&&Ic.aLb&&Ic.kje();mc.g(Ic.$).$b.Nl(Ic.Df);Ic.Hab=!1;Ic.Iab=!1};Ic.qzf=function(){va.ULS.sendTraceTag(537155213,0,50,"NetworkConnectionStateManager.OnNetworkResumedEvent: network was resumed.");Ic.blc(1,!0);Ic.Hab&&!Ic.Iab&&mc.g(Ic.$).$b.Nl(Ic.Df);
Ic.Hab=!1};Ic.DOa=function(Md,ne){Ic.mkd=Ic.E7;Ic.E7=ne.Mzc};Ic.qCf=function(){Ic.$&&(Ic.Jrc||(Pc.a(Ic.$).wQ(Mc.a.JOa).BEg(Ic.Azf),Ic.$.Tk(Ic.Yc),Ic.Jrc=!0),Ic.ufa=Ic.Dei(),Ic.blc(2,!1))};Ic.Azf=function(){var Md=Pc.a(Ic.$).ji,ne=Md.KKg();Md=ec.f(Md.rs.fd.errors,function(le){return le.MessageIdName});va.ULS.sendTraceTag(545842889,0,50,"NetworkConnectionStateManager.OnOpenWebMethodErrorUserAlertExecuting: IsStateUnrecoverable:{0}, IsB2W:{1}, Errors: {2}",ne,Ic.ufa,Re.a.xc(Md));ne&&(Ic.XRa?(Ic.ufa=
!1,Ic.AFe(),Ic.OAc()):Ic.Gna&&(Ic.BFe(),Ic.OAc()))};Ic.Yc=function(){Ic.$?(va.ULS.sendTraceTag(541193955,0,50,"NetworkConnectionStateManager.OnWorkbookOpened: Workbook opened."),Ic.ufa=!1,Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:5543662_StopSilentReopenDuringWorkTimerMethodContextOnWorkbookOpened")&&Ic.z0&&Ic.z0.Qp&&(Le.a.Ia(Ic.z0),Ic.z0=null),Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&Ic.M0&&Ic.M0.Qp&&(Le.a.Ia(Ic.M0),Ic.M0=null),Ic.blc(2,!0),
Ic.OAc()):va.ULS.sendTraceTag(537155212,0,10,"NetworkConnectionStateManager.OnWorkbookOpened: bug monitoring: EwaControl is null.")};Ic.Vuf=function(){Ic.Opf(!0)};Ic.Wuf=function(){Ic.Opf(!1)};Ic.bWb=v.rsi;Ic.D1c=v.connected;Ic.$=Yb;Ic.tf=Yb.oa.tf;Ic.e1f=Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:5618694_BackToWorkLoadingUIEnabled");Ic.aLb=Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:5798300_SilentReopenDuringWorkUIEnabled");Ic.Owc=Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled");
bd&&(Ic.Sqf=new k(Yb,Ec));Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:5589104_AlwaysInitDocumentVisibilityObserver")&&Ic.$.da.Za(291,function(Md){Ic.documentVisibilityObserver=Md});Ic.Owc&&(Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:5589104_AlwaysInitDocumentVisibilityObserver")||Ic.$.da.Za(291,function(Md){Ic.documentVisibilityObserver=Md}),Ic.Rqf=Ic.$.ya.ExcelNetworkCheckAfterTabActivationDelayMs,Ic.tf.GFg(Ic.tEb),Ic.tf.bnb(Ic.qzf),Ic.tf.lme(Ic.Vuf),Ic.tf.gEg(Ic.Wuf));if(Ic.e1f||Ic.aLb)Ic.JBj=
new d(Ic.$,Ic);Ic.umf=Ic.$.ya.LongInactivityTimePeriodSeconds;Ic.$.ea.cVc(Ic.qCf);Ic.$.ea.df.Gra(Ic.DOa);Ic.aLb&&(Ic.a4f=Ic.$.ya.SilentReopenDuringWorkDelayMs);return Ic}function d(Yb){var Ec=this;this.v7=null;this.rCf=function(bd,Ic){Ec.oCf(Ic,3)};this.Hyf=function(bd,Ic){Ec.oCf(Ic,2)};this.$=Yb;this.Tf=Qb.a(this.$).Tf;this.Tf.Tme(this.Hyf);this.Tf.UGg(this.rCf)}function e(Yb,Ec,bd,Ic){Yb=r.call(this,Yb,Ec,bd)||this;Yb.wasInteruptedByOfflineMode=!1;Yb.type=Ic;Yb.wasInteruptedByOfflineMode=!1;return Yb}
function k(Yb,Ec){this.rla=this.KCi=this.Gsf=null;this.$=Yb;!Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled")||Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&ma.a.xf||(this.Gsf=new l(Yb,Ec));!Dc.EwaSettings.ma(563)||Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&ma.a.xf||(this.rla=new Vc.NetworkConnectionHealthChecker(this.$));this.l1g=new w(this.$)}function l(Yb,Ec){var bd=this;this.aOa=
this.qU=null;this.nEd=-1;this.Otb=null;this.$if=Kb.Task.delay(0);this.F9a=function(Ic,Md){Md.LL?bd.kPi(Md.Xna):bd.lPi()};this.vca=function(Ic,Md){5===Md.kFf&&bd.A2a()};this.KUf=function(Ic,Md){bd.qU.Kpj(Md.MU)};this.A2a=function(){bd.aOa.OQj();bd.Pjj(l.pCd,Sys.Serialization.JavaScriptSerializer.serialize(bd.aOa))};this.Hej=function(Ic){if(Ic=Ic.result)bd.Gfg=!0,va.ULS.sendTraceTag(576811915,0,50,"OfflineModeTelemetryManager.ReportOfflinePartialInteractivityDataFromIDB: Previous session's offline partial interactivy data: {0}",
Ic)};this.Y9i=function(){bd.Gfg&&(bd.$?Wd.TaskExtensions.Ba(bd.indexedDB.t5c(l.pCd),function(){va.ULS.sendTraceTag(537155204,0,50,"OfflineModeTelemetryManager.RemoveDataFromIDB: Previous session's offline partial interactivy data successfuly removed from IDB.")},bd.$.la):va.ULS.sendTraceTag(537155203,0,10,"OfflineModeTelemetryManager.RemoveDataFromIDB: EwaControl is null when attempting to remove offline mode data stored in IDB."))};this.fOa=function(){if(bd.aOa&&0<bd.aOa.count){var Ic=Sys.Serialization.JavaScriptSerializer.serialize(bd.aOa);
va.ULS.sendTraceTag(560791644,0,50,"OfflineModeTelemetryManager.OnBeforeUnload: This session's offline partial interactivy data: {0}",Ic)}};this.$=Yb;this.indexedDB=Ec;this.Gfg=!1;this.indexedDB.Cf()&&(this.indexedDB.initialize(l.tkd,l.ukd),this.dej(),this.aOa=new f(this.$.ya.UserSessionId),Qb.a(this.$).Tf.KUc(this.F9a));this.lm=td.a.instance.LG();this.lm.ka("beforeunload",this.fOa)}function m(Yb,Ec,bd){Yb=r.call(this,Yb,Ec,bd)||this;Yb.timeFromLastOffline=0;Yb._errorDataDuringOfflineMode=null;Yb.timeFromLastOffline=
-1;Yb.type=5;return Yb}function f(Yb){this._count=0;this.sessionID=this.allOfflinePartialInteractivitiesDataInSession=null;this.allOfflinePartialInteractivitiesDataInSession=[];this.sessionID=Yb}function w(Yb){var Ec=this;this.Oic=this.data=null;this.b$c=0;this.JAe=null;this.Xuf=function(bd,Ic){Ic.LL?(Ec.data=new z(Ie.a.Ta.Jb,Ec.$,5===Ic.Xna,0!==Ic.Xna,Ec.$.tf.disconnectionSource,Ec.JAe),Ec.Oic=Ec.$.tf.fjf,Ec.b$c=1,Ec.$.oa.tf.qHg(Ec.Jn),Xb.a(Ec.$).zUc(Ec.JUf)):(Ec.data.dIi(Ec.$,5===Ic.Xna),Ec.$.oa.tf.mQf(Ec.Jn),
Ec.data.lastFailedRequestToOnlineTimeGapSec=jc.getElapsedSeconds(Ec.Oic,Ie.a.Ta.Jb),Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_7pzab_ConnectivityIssues")?id.b().PJb(557682689,0,50,n.connectivityIssues,Ec.data.durationMs,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: {0}",Re.a.xc(Ec.data)):va.ULS.sendTraceTag(557682689,0,50,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: {0}",
Re.a.xc(Ec.data)),Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:5508233_ReportNetworkDownVeto")&&Ec.data&&Ec.data.isToastShown&&Pd.Health.instance.recordQosError(kc.a.zYg,[Wc.a.ujc],!0,!1,!1,!1,null),Xb.a(Ec.$).uId(Ec.JUf),Ec.data=null)};this.JUf=function(bd,Ic){Ec.data.Jpj(Ic.MU)};this.Jn=function(bd,Ic){Ec.data.t6i(Ic.context.methodName);bd=Ie.a.Ta.Jb;Ic=jc.getElapsedSeconds(Ec.Oic,bd);Ec.Oic=bd;Ic>Ec.data.longestDurationBetweenFailedRequestsSec&&(Ec.data.longestDurationBetweenFailedRequestsSec=
Ic);Ec.b$c++;Ec.data.averageDurationBetweenFailedRequestsSec=Ec.eTg(Ic)};this.Uuf=function(bd,Ic){Ec.JAe=Ic.rMj};this.$=Yb;Qb.a(this.$).Tf.mme(this.Xuf);this.$.tf.lme(this.Uuf)}function n(){}function z(Yb,Ec,bd,Ic,Md,ne){Yb=r.call(this,Yb,Ec,Ic)||this;Yb.swappedByOffline=!1;Yb.swappedOffline=!1;Yb.averageDurationBetweenFailedRequestsSec=0;Yb.longestDurationBetweenFailedRequestsSec=0;Yb.lastFailedRequestToOnlineTimeGapSec=0;Yb.disconnectionSource=null;Yb.errorDataDuringConnectivityIssuesMode=null;
Yb.failedRequests=[];Yb.triggeringRequest=null;Yb.type=4;Yb.swappedOffline=bd;Yb.disconnectionSource=Enum.toString(cb.a,Md);Yb.triggeringRequest=ne;return Yb}function r(Yb,Ec,bd){var Ic=this,Md;this.type=0;this.startTime=null;this.blockedOperationsCount=this.durationMs=0;this.blockedActions=null;this.blockedUserOperationsWhileToastShown=this.durationUntilToastShownMs=0;this.toastRaiser=null;this.wasUserActiveOnPIEnd=this.wasUserActiveOnPIStart=this.hasTabbedOut=this.isToastShown=!1;this.durationUntilUserInactive=
-1;this.isTaskPaneCollapsed=this.isTaskPaneShown=this.isDialogShown=!1;this.Ltf=function(ne,le){Ic.blockedOperationsCount++;ne=String.format("{0}_{1}_{2})",le.componentName,le.actionName,le.details);Ic.blockedActions[ne]=Ic.blockedActions[ne]?Ic.blockedActions[ne]+1:1;Ic.isToastShown&&Ic.blockedUserOperationsWhileToastShown++};this.lBd=function(ne){Ic.durationUntilUserInactive=jc.getElapsedSeconds(Ic.startTime,Ie.a.Ta.Jb);ne.cJd(Ic.lBd)};this.a6=function(){Ic.hasTabbedOut=!0};this.vca=function(ne,
le){le.kFf!==Ic.type||Ic.isToastShown||(Ic.durationUntilToastShownMs=Fa.a(Ie.a.Ta,Ic.startTime),Ic.toastRaiser=le.toastRaiser,Ic.isToastShown=!0)};this.startTime=Yb;this.durationUntilToastShownMs=0;this.blockedActions={};this.isToastShown=bd;if(null===(Md=Ec.ea)||void 0===Md?0:Md.df)this.wasUserActiveOnPIStart=Ec.ea.df.Tr;this.Ti(Ec);Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:5340853_ImprovePIData")?(this.isDialogShown=0<Ec.ob.uR,Yb=Ec.da.za(183),this.isTaskPaneShown=!!Yb&&Yb.isVisible&&!Yb.isCollapsed,
this.isTaskPaneCollapsed=!!Yb&&Yb.isVisible&&Yb.isCollapsed):this.isTaskPaneCollapsed=this.isTaskPaneShown=this.isDialogShown=!1}function v(){}function A(Yb){var Ec=jd.call(this)||this;Ec.Ec=Yb;Ec.Eb();return Ec}function B(Yb,Ec,bd){bd=void 0===bd?null:bd;var Ic=Gd.call(this)||this;Ic.n_a=null;Ic.c5a=null;Ic.rec=null;Ic.DCa=null;va.ULS.sendTraceTag(537155417,0,50,"MergeSuspensionManager.ctor started");Ic.$=Yb;Ic.FWa=new M(Yb);Dc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SelectionAdjust",
!1)&&(Ic.cAa=new y(Ic.$));Ic.k1a=new G(Ic.$.oa.xa,Ic.$,void 0,void 0,Ic.cAa);Ic.C9h(Yb,bd);Ic.Dfa=new T(Ic.DCa,Ic.FWa);Ic.WJd=new E(Yb,Ic.Dfa,Ec,Ic.k1a);Dc.EwaSettings.ma(255)&&(Ic.rec=new N(Yb,Ic));va.ULS.sendTraceTag(588276810,0,50,"MergeSuspensionManager created");return Ic}function y(Yb){var Ec=this;this.fMb=0;this.Ly=this.Rx=null;this.M0d=new C;this.N0d=new C(!0);this.PC=0;this.fIj=!1;this.Ipf=1E4;this.Yc=function(){Ec.aEe()};this.Ai=function(){Ec.XWc(!0,!1)};this.c9a=function(){Ec.XWc(!1,!1)};
this.$=Yb;this.gridView=mc.g(this.$);this.gridView.Ea.mx(this.Ai);this.gridView.Ea.Fs(this.c9a);this.gridView.Ea.dme(this.c9a);this.gridView.Ea.Gga(this.c9a);Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:6385622_SelectionAdjustImplementsCustomReportManager")&&this.$.Tk(this.Yc);this.Rej=Dc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReportSelections",!1);this.aEe();this.ICb=Dc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SelectionAdjustMultiRangeSupport",!1);this.mej=Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:6354017_reportEditRaceCondition");
this.eRf=Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:6367531_reportDivergenceOnResponse");this.Toe=Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:6409189_alwaysVerifyMaxBlockRevisionBeforeAdjust")}function x(Yb,Ec,bd,Ic,Md,ne){var le=this;this.QI=void 0;this.jb=Yb;this.iG=Ec;this.m9=bd;this.kWb=Ic;this.$Dc=Md;Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:6592063_GetIndexOfActiveRangeFromInitialSelection_V2")&&(this.QI=ne);this.jUb=Dc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SelectionAdjustMultiRangeSupport",
!1);this.j6d=Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:6399793_GetBlocksOnAdjustCheck");this.bkg=Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:6399805_adjustIfNoCachedBlocks");this.j6d||(this.jUb?this.uQb=this.selectedRanges.map(function(Ke){return le.vAc(Ke,Md)}):this.fCa&&(this.uQb=[this.vAc(this.selectedRanges[0],Md)]))}function C(Yb){this.divergenceOnResponse=this.adjustedDidntChangeWithDivergence=this.editBoxDivergence=this.differentSheetAdjust=this.parallel=this.errors=this.nonContinuous=
this.divergenceOnViewportReady=this.adjusted=this.adjustedDidntChange=0;this.d8h=void 0===Yb?!1:Yb}function G(Yb,Ec,bd,Ic,Md){bd=void 0===bd?null:bd;Ic=void 0===Ic?null:Ic;Md=void 0===Md?null:Md;var ne=Ye.call(this)||this;ne.TAb=null;ne.qBd=0;ne.documentVisibilityObserver=null;ne.qif=!1;ne.xa=Yb;ne.rtc=Ec.ya.MergeSuspensionRequestThrottlingTimeInMs;var le=Ec.ya.GetRangeContentPrefetchDelayForMergeInMs;ne.ry=function(){Ec.wVf(le)};ne.ah=bd||Ie.a.Ta;ne.PYd=0;ne.vO=Ic;ne.cAa=Md;ne.Qdg=Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:6248201_useDoPendingMergeSuccessCallback");
ne.JTg=Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:6237816_CallDoPendingMergeRequest");Ec.da.Za(291,function(Ke){ne.documentVisibilityObserver=Ke});return ne}function E(Yb,Ec,bd,Ic){var Md=Ee.call(this)||this;Md.k1a=null;Md.sAb=0;Md.n7a=null;Md.tAb=null;Md.zAf=function(ne,le){Md.k1a.sMg(le.eca,le.SIg)};Md.TEb=function(ne,le){le.Lwa?Md.rEj():Md.yyc()};Md.Nyf=function(){Md.sAb=0};Md.NWf=function(){var ne=Md.K5.yed();I(Md.xa,null!=ne.SuspensionStartTimestamp?ne.SuspensionStartTimestamp:0,null,function(){Md.FNi(ne)},
null,null,Md.xa.Pb())};Md.SBa=function(ne,le){if(le){le.snb.MergeCount=Md.K5.yed();var Ke=mc.g(Md.$).rAi();ne=Ke.min;Ke=Ke.max;Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:5524817_LogOnMergeRaceCondition2")?le.snb.ClientRevisions=Object(Ac.a)(new U,{Min:ne,Max:Ke,MaxFromBlockCache:mc.g(Md.$).Ea.kvd}):le.snb.ClientRevisions=Object(Ac.a)(new U,{Min:ne,Max:Ke})}};Md.$=Yb;Md.kZa=bd;Md.K5=Ec;Md.K5.qGg(Md.zAf);Md.K5.zZb(Md.TEb);Md.K5.zFg(Md.Nyf);Md.$.oa.Kga(Md.SBa);Md.xa=Md.$.oa.xa;Md.rtc=Md.$.ya.MergeSuspensionRequestThrottlingTimeInMs;
Md.Mpi=Md.$.ya.KeepBlockingPendingMergesRequestIntervalMs;Md.k1a=Ic;va.ULS.sendTraceTag(588276807,0,50,"RequestController initialized");return Md}function I(Yb,Ec,bd,Ic,Md,ne,le){le=Yb.Na(1,void 0===le?null:le);le.suspensionStartTimestamp=Ec;return ue.g(Yb,"KeepBlockingPendingMerges",le,bd,Ic,Md,ne,0)}function U(){}function M(Yb){var Ec=Vd.call(this)||this;Ec.D1=null;Ec.Tic=0;Ec.b8=function(bd,Ic){var Md;if(null===(Md=null===Ic||void 0===Ic?void 0:Ic.Xc)||void 0===Md?0:Md.MergeCount)pc.a.equals(Ic.Xc.SessionId,
Ec.$.ea.sessionId,!1)?Ec.pya(Ic.Xc.MergeCount,M.usb):va.ULS.sendTraceTag(579737049,0,50,"Stale merge counter ({0}/{1})",Ic.Xc.MergeCount.Current,Ic.Xc.MergeCount.Pending)};Ec.sCb=function(bd,Ic){(null===Ic||void 0===Ic?0:Ic.eca)&&Ec.pya(Ic.eca,M.RZd)};Ec.qvc=function(){Ec.wSf();Ec.gKf(Ec.D1,M.Qfj)};Ec.m9a=function(bd,Ic){Ic.nqb&&Ec.D1.SuspensionStartTimestamp&&va.ULS.sendTraceTag(17318084,0,50,"PendingMergeMonitor.OnEditCellEnded: committed with counter {0}",ea(Ec.D1))};Ec.wSf();Ec.$=Yb;Ec.$.ea.Wj(Ec.qvc);
Ec.$.ea.TL(Ec.qvc);mc.g(Ec.$).Wb.vm(Ec.m9a);Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:6329027_UpdateMergeCountWhenWebMethodReturnsWithErrors")||Ec.$.oa.Vq(Ec.b8);Ec.$.da.Za(292,function(bd){bd.wYa(Ec.sCb);va.ULS.sendTraceTag(588276809,0,50,"PendingMergeMonitor initialized")});return Ec}function T(Yb,Ec){var bd=Fd.call(this)||this;bd.qya=function(Ic,Md){Ic=bd.getState();var ne=bd.kla;bd.kla=Md.eca;Md=bd.getState();bd.tvi(Ic,Md,ne);bd.raiseEvent(T.Cvd);bd.PSe(Ic,Md)};bd.yOa=function(Ic,Md){Ic=bd.getState();
bd.PH=Md.PH;Md=bd.getState();bd.PSe(Ic,Md)};bd.wyb=Dc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DoPendingMergeWhenUnsafe",!1);bd.Eha=Yb;bd.Eha.uZb(bd.yOa);bd.ima=Ec;bd.ima.wYa(bd.qya);bd.kla=Object(Ac.a)(new lc.a,{Pending:0,Current:0,SuspensionStartTimestamp:null});bd.PH=bd.h9h();return bd}function F(Yb,Ec){Yb=xb.call(this,Yb)||this;Yb.SIg=Ec;return Yb}function K(Yb){this.Ioe=!1;this.Ioe=Yb;return this}function J(){}function O(Yb){var Ec=Gc.call(this)||this;Ec.Lwa=Yb;return Ec}function N(Yb,
Ec){var bd=ic.call(this)||this;bd.statusBarManager=null;bd.axd=!1;bd.qya=function(Ic,Md){Ic=String.format("{0}{1}",Md.eca.Current===Md.eca.Pending?"\u26ad":"\u26ae",Md.eca.Current);pc.a.equals(bd.Dlc,Ic,!1)||(bd.Dlc=Ic,bd.xz())};bd.yOa=function(Ic,Md){Ic=0==Md.PH;bd.axd!==Ic&&(bd.axd=Ic,bd.xz())};bd.mergeSuspensionManager=Ec;bd.mergeSuspensionManager.ima.wYa(bd.qya);bd.Dlc="";ub.a.i2(1905775613,Fb.a.wc,0,1);bd.Ka=Yb.Ka;bd.cNb=new H;Yb.da.Za(29,function(Ic){bd.mergeSuspensionManager&&(bd.statusBarManager=
Ic,Ic.jJ(bd),bd.mergeSuspensionManager.Eha.uZb(bd.yOa))});bd.Ka.j2(bd.cNb);return bd}function H(){return eb.call(this)||this}function Q(Yb,Ec){Ec=void 0===Ec?null:Ec;var bd=Kc.call(this,1)||this;bd.wfa=!1;bd.rN=function(){bd.refresh()};bd.gvf=function(){bd.refresh()};bd.$=Yb;bd.e7d=Ec||Pc.a(Yb).wQ(Mc.a.idle);Pc.a(Yb).yUc(bd.gvf);bd.b5a.jq(bd.rN);bd.refresh();return bd}function ca(Yb,Ec){var bd=rc.call(this)||this;bd.Yif=null;bd.Uic=!1;bd.BQa=new P.a;bd.Wie=Yb;bd.ima=Ec;bd.wyb=Dc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DoPendingMergeWhenUnsafe",
!1);bd.wyb&&(bd.Wie.AFg(bd.Oyf.bind(bd)),bd.ima.wYa(bd.qya.bind(bd)));return bd}function X(Yb){return(null===Yb||void 0===Yb?void 0:Yb.SuspensionStartTimestamp)&&Yb.Pending>Yb.Current}function Z(Yb,Ec){return Yb||Ec?Yb&&Ec?Yb.Current===Ec.Current&&Yb.Pending===Ec.Pending&&Yb.SuspensionStartTimestamp===Ec.SuspensionStartTimestamp:!1:!0}function ea(Yb){return Yb?String.format("{0} / {1} @{2}",Yb.Current,Yb.Pending,Yb.SuspensionStartTimestamp):null}function ka(Yb,Ec){this.handler=null;this.publisher=
Yb;this.PH=Ec}function Y(Yb){var Ec=Sa.call(this,1)||this;Ec.wfa=!1;Ec.cuf=function(){Ec.refresh()};Ec.duf=function(){Ec.refresh()};Ec.gridView=mc.g(Yb);Ec.gridView.Wb.Bk(Ec.duf);Ec.gridView.Wb.vm(Ec.cuf);Ec.refresh();return Ec}function qa(Yb){var Ec=Pb.call(this)||this;Ec.kkd=null;Ec.$=Yb;Ec.Eb();return Ec}function fa(Yb){var Ec=ob.call(this)||this;Ec.$=Yb;Ec.Eb();return Ec}function ha(Yb,Ec){this.dTe=Yb;this.nBh=Ec}function ia(Yb){this.$=Yb}function wa(){this.fb=null}function Qa(){this.hib=this.qSb=
this.Dv=null}function S(Yb,Ec,bd,Ic,Md){this.Dv=Yb;this.uib=Ec;this.qib=bd;this.Xce=void 0===Ic?null:Ic;this.zkb=void 0===Md?null:Md}function da(){this.fb=null}function xa(Yb){this.Vb=Yb}function ta(){this.Che=0;this.lWa=Array(5);this.lWa[0]=10;this.lWa[1]=15;this.lWa[2]=50;this.lWa[3]=100;this.lWa[4]=200}function ab(Yb,Ec,bd,Ic,Md){this.j$b=!1;this.Yrb=null;this.La=Yb;this.EXa=Ec;this.BVb=bd;this.d1=Ic;this.EEc=Md}function Na(){this.ONf=this.ISf=this.N7f=this.mjc=this.instance=null}function Ka(Yb,
Ec,bd){this.La=Yb;this.Se=Ec;this.SSb=bd}function la(){this.completed=this.B9i=!1}function Ea(){this.age=this.Dae=this.l1d=!0;this.Ydj=this.yYi=null;this.OBi=!1;this.locale=null;this.uag={}}function ra(){}function na(){this.$Ub=this.pSb=null}function ba(Yb){return mb.call(this,Yb)||this}b.r(D);var sa=b(1362),ya=b(0),va=b(15),W=b(4),La=b(120),Ia=b(422),mb=Ia.a;Rk(ba,mb);ba.prototype.createElement=function(){var Yb=document.createElement("link");Yb.setAttribute("rel","stylesheet");Yb.setAttribute("type",
"text/css");Yb.setAttribute("href",this.kt);return Yb};ba.prototype.d3c=function(){return null};ba.prototype.Orc=function(){this.element.setAttribute("href","");this.element.setAttribute("href",this.Jz.kt)};Af.Object.defineProperties(ba.prototype,{Q3b:{configurable:!0,enumerable:!0,get:function(){return!1}}});Object(ya.a)(ba,"CssResource",Ia.a,[]);var fb=b(393),Ma=b(236),Hb=b(30),Kb=b(58);na.prototype.Dsi=function(){this.pSb||(va.ULS.sendTraceTag(21030598,324,50,"InProductMessagingDependenciesLoad usage"),
this.pSb=Kb.Task.WAA(na.Isi(),na.Asi()),this.pSb.continueWith(function(Yb){va.ULS.sendTraceTag(21030599,324,10,"{0}",Hb.a.jdd(Yb.exception))},5));return this.pSb};na.prototype.Fsi=function(){if(!this.$Ub)try{va.ULS.sendTraceTag(39978390,324,50,"InProductMessagingFreemiumDependenciesLoad usage"),this.$Ub=Kb.Task.WAA(na.z7c(Ma.a.create(W.AFrameworkApplication.fa.Wa("DimeUrl"),null,null))),this.$Ub.continueWith(function(Yb){va.ULS.sendTraceTag(39978391,324,10,"{0}",Hb.a.jdd(Yb.exception))},5)}catch(Yb){va.ULS.sendTraceTag(594874951,
324,10,"{0}",Hb.a.jdd(Yb))}return this.$Ub};na.Isi=function(){var Yb=na.gcc("inproductmessaging.js");Yb=Ma.a.create(Yb,null,null);return na.z7c(Yb)};na.Asi=function(){var Yb=na.gcc("inproductmessaging.css");Yb=new ba(Yb);return na.z7c(Yb)};na.gcc=function(Yb){return La.a.U2b(String.format("ipm/{0}",Yb))};na.z7c=function(Yb){fb.a.ria(Yb);return Yb.O7a};Object(ya.a)(na,"DependencyDownloader",null,[1002]);ra.MVi="inProductMessagingOverlayDiv";ra.xYi="PlayButtonImage";ra.Xdj="ReplayButtonImage";Object(ya.a)(ra,
"Constants",null,[]);Ea.prototype.Lrj=function(){this.Qle(ra.xYi,this.yYi);this.Qle(ra.Xdj,this.Ydj)};Ea.prototype.Qle=function(Yb,Ec){Ec&&(this.uag[Yb]=Ec)};Af.Object.defineProperties(Ea.prototype,{TMg:{configurable:!0,enumerable:!0,get:function(){return this.l1d},set:function(Yb){this.l1d=Yb}},RAi:{configurable:!0,enumerable:!0,get:function(){return this.Dae},set:function(Yb){this.Dae=Yb}},bAj:{configurable:!0,enumerable:!0,get:function(){return this.age},set:function(Yb){(this.age=Yb)&&this.Lrj()}}});
Object(ya.a)(Ea,"FirstRunExperienceUISettings",null,[1001]);Object(ya.a)(la,"FirstRunExperienceViewData",null,[1E3]);var Ub=b(83),gb=b(181),Db=b(107),Va=b(27);Ka.prototype.Cg=function(){this.La.Ie(Va.a.oBh,Db.a.frame,Object(Ub.a)(this,this.mBh,"firstRunExperienceHandler"),64);this.La.Mb(Va.a.cTe,Db.a.frame,Object(Ub.a)(this,this.g8h,"inProductMessagingTabHandler"));this.La.Mb(Va.a.bTe,Db.a.frame,Object(Ub.a)(this,this.f8h,"inProductMessagingShiftTabHandler"));this.La.Mb(Va.a.$eh,Db.a.frame,Object(Ub.a)(this,
this.afh,"dimeLaunchHandler"));this.La.Mb(Va.a.jRf,Db.a.frame,gb.ActionManager.fg);this.La.Mb(Va.a.uej,Db.a.frame,gb.ActionManager.fg);this.La.Mb(Va.a.vej,Db.a.frame,gb.ActionManager.fg);this.Se&&this.Se.updateCommandUI()};Ka.prototype.mBh=function(Yb,Ec,bd,Ic,Md){2===bd&&this.SSb.ari(Md);return 32};Ka.prototype.afh=function(Yb,Ec,bd,Ic,Md){2===bd&&this.SSb.Yqi(Md);return 32};Ka.prototype.g8h=function(Yb,Ec,bd){return 2===bd?this.SSb.awd():32};Ka.prototype.f8h=function(Yb,Ec,bd){return 2===bd?this.SSb.Zvd():
32};Object(ya.a)(Ka,"InProductMessagingActor",null,[]);var yb=b(85);Object(ya.a)(Na,"DimeExperienceUISettings",null,[]);var qb=b(167),dc=b(500);ab.prototype.U$h=function(Yb){qb.b("getHeaderApi")?Yb.isFeatureEnabled("MsoPremiumBadge",!0).then(function(Ec){var bd=Yb.isFreemiumUpsellEnabled();bd&&(appChrome.getHeaderApi().then(function(Ic){Ic.updatePremiumStatus(Ec,bd);return null}),Yb.zma("MsoPremiumBadge",function(Ic){appChrome.getHeaderApi().then(function(Md){Md.updatePremiumStatus(Ic.isEnabled,bd);
return null})}));return null}):va.ULS.sendTraceTag(593859840,324,10,"getHeaderApi not available")};ab.prototype.ari=function(Yb){var Ec=this;this.BVb.Dsi().continueWith(function(){Ec.EXa.wBj(Yb)})};ab.prototype.Yqi=function(Yb){function Ec(){}var bd="gopremium",Ic=null;Yb?(Yb.experience&&""!==Object(yb.a)(String,Yb.experience)&&(bd=Object(yb.a)(String,Yb.experience)),Yb.onTaskComplete&&(Ec=Yb.onTaskComplete),Yb.campaignId&&""!==Object(yb.a)(String,Yb.campaignId)&&(Ic=Object(yb.a)(String,Yb.campaignId))):
va.ULS.sendTraceTag(51675402,324,50,"Experience not given, using default experience");this.rjf(bd,Ec,Ic)};ab.prototype.rjf=function(Yb,Ec,bd){var Ic=this;bd=void 0===bd?null:bd;if(this.j$b&&this.Yrb){var Md={};Md.experience=Yb||"gopremium";Md.campaignId=bd||dc.b(this.d1,this.EEc,Object(yb.a)(String,Md.experience),!0);this.La.processAction(Va.a.jRf,2);va.ULS.sendTraceTag(51675403,324,50,"Launching Freemium Upsell dialog: "+Md.experience);try{var ne=Object.assign(new Na,{instance:this.Yrb,mjc:Md,N7f:Ec||
function(){},ISf:function(le){va.ULS.sendTraceTag(51675405,324,50,"Dime launch result: "+le.status)},ONf:function(){va.ULS.sendTraceTag(51675406,324,10,"Dime launch error");Ic.j$b=!1;Ic.Yrb=null}});this.EXa.Izj(ne)}catch(le){va.ULS.sendTraceTag(51675407,324,10,"Dime launch error: "+le.message),this.j$b=!1,this.Yrb=null,Yb={},this.La.ae(Va.a.k$b,2,(Yb.experience=Md.experience,Yb))}}else va.ULS.sendTraceTag(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),Md={},this.La.ae(Va.a.k$b,2,(Md.experience=
Yb,Md))};ab.prototype.jkf=function(){var Yb=this;this.BVb.Fsi().continueWith(function(){try{var Ec=Hb.a.rl(W.AFrameworkApplication.uiCulture),bd=dc.c(Yb.d1);if(bd){Ec={partnerId:bd,language:Ec};Ec.sessionId=W.AFrameworkApplication.userSessionId;Ec.authHint=W.AFrameworkApplication.fa.Wa("UserPrincipalName");var Ic=W.AFrameworkApplication.fa.Wa("Puid")||"";""!==Ic&&(Ec.userInfo={puid:Ic});Yb.Yrb=new Dime(Ec);Yb.j$b=!0;va.ULS.sendTraceTag(592721856,324,50,"Dime initialized")}else va.ULS.sendTraceTag(51675409,
324,15,"App not supported")}catch(Md){va.ULS.sendTraceTag(51675410,324,10,"FreemiumUpsellDialogDependencies failed: "+Md.message)}},3)};ab.prototype.awd=function(){return this.EXa.awd()};ab.prototype.Zvd=function(){return this.EXa.Zvd()};Object(ya.a)(ab,"InProductMessagingUIManager",null,[998]);ta.prototype.Init=function(Yb){this.Che=Yb};ta.prototype.SendTrace=function(Yb,Ec){va.ULS.sendTraceTag(34182235,this.Che,this.lWa[Yb],"{0}",Ec)};Object(ya.a)(ta,"DefaultNetworkingManager",null,[1014]);var bb=
b(274),db=b(327),wc=b(96);xa.prototype.wBj=function(Yb){Yb&&(InProductMessaging.Networking.NetworkingMgr=new ta,InProductMessaging.Networking.NetworkingMgr.Init(387),InProductMessaging.Init(Yb.bAj,Yb.RAi,Yb.TMg,Yb.OBi,Yb.locale,Object(Ub.a)(this,this.dJi,"onDismissFirstRunExperience"),Yb.uag),this.lRa(ra.MVi,!0))};xa.prototype.Izj=function(Yb){var Ec=this;if(Yb&&Yb.instance&&Yb.mjc){var bd=document.getElementById("wacDimeContainer");bd||(bd=document.createElement("div"),bd.id="wacDimeContainer",document.body.appendChild(bd));
W.AFrameworkApplication.fa.ra("DimeFocusManagerIsEnabled")&&this.lRa("wacDimeContainer",!1);Yb.mjc.parentElementId="wacDimeContainer";Yb.instance.launch(Yb.mjc,Yb.N7f).then(function(Ic){Ec.xHb();document.body.removeChild(bd);Yb.ISf(Ic)}).catch(function(Ic){Ec.xHb();document.body.removeChild(bd);Yb.ONf(Ic)})}else throw Error.argument("DimeExperienceUISettings");};xa.prototype.lRa=function(Yb,Ec){if(this.Vb&&Yb&&(Yb=document.getElementById(Yb),this.L$h(Yb),Yb=this.Vb.EM("InProductMessagingFocusId"))){var bd=
this.Vb.ki;bd&&"InProductMessagingFocusId"===bd.name||this.Vb.zR("InProductMessagingFocusId",!1);Ec&&this.ULf(Yb.scope)}};xa.prototype.L$h=function(Yb){var Ec=!1;Ec=void 0===Ec?!0:Ec;var bd=this.Vb.mi("InProductMessagingFocusId");bd.parent=bb.AFrame.JT;var Ic=new db.DOMFocusListing(function(){return Yb});Ic.Lab=Ec;Ic.Xn(3);Ic.Xn(2);Ic.Xn(4);Ec=this.Vb.isa(function(){return Yb},bd,Ic);Ec.pHb();Ec.q_=!0;Ec.fHa=!0};xa.prototype.ULf=function(Yb){Yb.hk(wc.FocusManager.instance().U1);Yb.hk(wc.FocusManager.instance().W1);
Yb.bindAction(wc.FocusManager.instance().U1,Va.a.cTe);Yb.bindAction(wc.FocusManager.instance().W1,Va.a.bTe)};xa.prototype.xHb=function(){this.Vb&&(this.Vb.Hca("InProductMessagingFocusId"),this.Vb.VPa("InProductMessagingFocusId"))};xa.prototype.dJi=function(Yb,Ec){this.xHb();Yb=Object.assign(new la,{completed:Yb,B9i:Ec});W.AFrameworkApplication.ub.ae(Va.a.lBh,2,Yb)};xa.prototype.awd=function(){var Yb=document.activeElement,Ec=this.Vb.yQ();return Yb&&Ec&&Ec.We&&Yb===Ec.We.mw?(Ec.We.sl(Yb),Ec.Rxa()?
32:8):4};xa.prototype.Zvd=function(){var Yb=document.activeElement,Ec=this.Vb.yQ();return Yb&&Ec&&Ec.We&&Yb===Ec.We.firstElement?(Ec.We.sl(Yb),Ec.RNa()?32:8):4};Object(ya.a)(xa,"InProductMessagingUIWrapper",null,[999]);var nb=b(142),zb=b(257),ma=b(25);da.prototype.Sh=function(Yb){Yb.register(na,"Common.App.InProductMessaging.DependencyDownloader").as("Common.App.InProductMessaging.IDependencyDownloader").tc().Cc(function(){return new na});Yb.register(xa,"Common.App.InProductMessaging.InProductMessagingUIWrapper").as("Common.IInProductMessagingUIWrapper").tc().Cc(function(){return new xa(wc.FocusManager.instance())});
Yb.register(ab,"Common.App.InProductMessaging.InProductMessagingUIManager").as("Common.IInProductMessagingUIManager").tc().Cc(function(){return new ab(W.AFrameworkApplication.ub,Yb.resolve("Common.IInProductMessagingUIWrapper"),Yb.resolve("Common.App.InProductMessaging.IDependencyDownloader"),W.AFrameworkApplication.ta.Pa.Fj,W.AFrameworkApplication.ta.Pa.lca)});Yb.register(Ka,"Common.App.InProductMessaging.InProductMessagingActor").tc().Cc(function(){return new Ka(W.AFrameworkApplication.ub,W.AFrameworkApplication.ta,
Yb.resolve("Common.IInProductMessagingUIManager"))});Yb.register(Ea,"Common.App.InProductMessaging.FirstRunExperienceUISettings").as("Common.IFirstRunExperienceUISettings").tc().Cc(function(){return new Ea});Yb.register(la,"Common.App.InProductMessaging.FirstRunExperienceViewData").as("Common.IFirstRunExperienceViewData").tc().Cc(function(){return new la});this.fb=Yb};da.prototype.init=function(){var Yb=this;this.fb.resolve("Common.App.InProductMessaging.InProductMessagingActor").Cg();W.AFrameworkApplication.fa.Tu(function(){W.AFrameworkApplication.ta.Pa.isReactSharedHeaderUxEnabled&&
nb.a.get_instance().ak(15,function(){Yb.fb.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Ec){Yb.fb.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").U$h(Ec)})});W.AFrameworkApplication.fa.ra("FreemiumUpsellShowDialogIsEnabled")&&dc.a()&&!ma.a.iB&&1!==W.AFrameworkApplication.ta.Pa.Fj&&Yb.fb.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Ec){Ec.isFeatureEnabled("MsoPremiumBadge",!0).then(function(bd){!bd&&
Ec.isFreemiumUpsellEnabled()&&Yb.fb.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").jkf();return null})})})};da.prototype.dispose=function(){};da.main=function(){zb.a.instance.Ui(new da)};Af.Object.defineProperties(da.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.InProductMessaging"}}});Object(ya.a)(da,"InProductMessagingPackage",null,[3,4]);var P=b(202),oa=b(41);S.prototype.C9c=function(Yb){var Ec=new Sys.StringBuilder(this.Dv.OIb);Ec.append("RoamingServiceHandler.ashx?action=");
Ec.append("getFirstRunExperienceSettings");Ec.append("&");Ec.append(this.jfd(Yb));Ec.append("&");Ec.append(W.AFrameworkApplication.aj);W.AFrameworkApplication.qd.Yl(Ec.toString(),1,null,null,!0,2,Object(Ub.a)(this,this.hKa,"getRequestSuccessCallback"),Object(Ub.a)(this,this.yja,"getRequestFailureCallback"),null)};S.prototype.mtb=function(Yb){var Ec=new Sys.StringBuilder(this.Dv.OIb);Ec.append("RoamingServiceHandler.ashx?action=");Ec.append("saveFirstRunExperienceSettings");Ec.append("&");Ec.append(W.AFrameworkApplication.aj);
Ec=Ec.toString();Yb=oa.c(Yb);W.AFrameworkApplication.qd.Yl(Ec,2,Yb,null,!0,4,Object(Ub.a)(this,this.WZi,"postRequestSuccessCallback"),Object(Ub.a)(this,this.x6,"postRequestFailureCallback"),null)};S.prototype.hKa=function(Yb){var Ec=!1,bd=null;try{if(0<Yb.data.Ud.length){var Ic=Object(yb.a)(Object,oa.a(Yb.data.Ud)),Md=Ic?Ic[this.Dv.UVc]:null;Md&&(bd=Object(yb.a)(Object,oa.a(Md.toString())))}Ec=!0}catch(ne){this.yja(null)}Ec&&this.uib&&this.uib(Yb.data,bd)};S.prototype.yja=function(Yb){this.qib&&this.qib(Yb?
Yb.data:null)};S.prototype.WZi=function(Yb){this.Xce&&this.Xce(Yb?Yb.data:null)};S.prototype.x6=function(Yb){this.zkb&&this.zkb(Yb?Yb.data:null)};S.prototype.jfd=function(Yb){for(var Ec=new Sys.StringBuilder("requestedsettings="),bd=0;bd<Yb.count;bd++)Ec.append(Yb.na(bd)),bd<Yb.count-1&&Ec.append(";");return Ec.toString()};Object(ya.a)(S,"FirstRunExperienceRequestHandler",null,[]);var Ja=b(84);Qa.prototype.jRd=function(Yb){Yb?(this.Dv=Yb,this.wji()&&(va.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),
Yb=new P.a,Yb.add(this.Dv.UVc),this.qSb=new S(this.Dv,Object(Ub.a)(this,this.hKa,"getRequestSuccessCallback"),Object(Ub.a)(this,this.yja,"getRequestFailureCallback"),null,Object(Ub.a)(this,this.x6,"postRequestFailureCallback")),this.qSb.C9c(Yb)),(this.Dv.Y6a||W.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.kRd()):va.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")};Qa.prototype.wji=function(){try{if(this.Dv.Y6a)return!0;
if(!W.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||W.AFrameworkApplication.fa.ra("IsAnonymousUser"))return!1;if(this.Dv.pgi||this.Dv.$6a||W.AFrameworkApplication.fa.ra("IsO365ConsumerHost"))return!0;var Yb=W.AFrameworkApplication.fa.Wa("FlightId");return-1!==(Yb?Yb.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(Ec){va.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",Ec?Ec.toString():null)}return!1};
Qa.prototype.LUf=function(Yb){var Ec={},bd={};bd.FREDisplayedDate=(new Date).toUTCString();bd.VersionDisplayed=Yb;bd.RemindMeLater=!1;Ec[this.Dv.UVc]=oa.c(bd);va.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.qSb&&this.qSb.mtb(Ec)};Qa.prototype.hKa=function(Yb,Ec){Yb=Yb?+Yb.Z2-+Yb.bF:-1;Yb>this.Dv.CTf?va.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",
Yb,this.Dv.CTf):Ec?this.yyj(Ec)?(va.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.Dv.Gpf),this.kRd()):va.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required."):(va.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.kRd())};Qa.prototype.yja=function(Yb){va.ULS.sendTraceTag(51675541,
306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",Yb?Yb.httpStatus:-1)};Qa.prototype.x6=function(Yb){va.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",Yb?Yb.httpStatus:-1)};Qa.prototype.kRd=function(){var Yb=this,Ec=Ja.a.instance.nh("Common.ISystemInitiatedFeedback");Ec?this.I2f(Ec):(va.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),W.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",
!0)&&((Ec=Ja.a.instance.Tb("Common.ISystemInitiatedFeedback"))?Ec.execute(function(bd){Yb.I2f(bd)}):va.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))};Qa.prototype.I2f=function(Yb){if(Yb){var Ec=this.Dv.ABh;Ec&&(W.AFrameworkApplication.Wka(Ec),W.AFrameworkApplication.p_(Ec));va.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",Ec);Yb.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.hib=
Object(Ub.a)(this,this.bKi,"onFirstRunExperienceCampaignEvent"),window.addEventListener("FGWebSurfaceEvent",this.hib,!0),window.addEventListener("FRELaunchedEvent",this.hib,!0)):(va.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.LUf(this.Dv.currentVersion))}else va.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")};Qa.prototype.bKi=function(Yb){if(Yb){var Ec=Yb.detail;Yb=Yb.type;var bd=this.Dv&&this.Dv.campaignId?this.Dv.campaignId.split("-")[0]:
null;if("FRELaunchedEvent"===Yb||bd&&Ec&&Ec.id&&-1!==Ec.id.indexOf(bd))Ec.success&&(va.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.LUf(this.Dv.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.hib,!0),window.removeEventListener("FRELaunchedEvent",this.hib,!0))}};Qa.prototype.yyj=function(Yb){if("RemindMeLater"in Yb&&"FREDisplayedDate"in Yb){if("true"===Yb.RemindMeLater.toString()&&(+new Date-+new Date(Yb.FREDisplayedDate.toString()))/
36E5>this.Dv.Gpf)return!0}else if(W.AFrameworkApplication.fa.ra("WacShowVersionBasedFREToAllUsers")&&"VersionDisplayed"in Yb&&Yb.VersionDisplayed<this.Dv.currentVersion)return va.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1};Object(ya.a)(Qa,"FirstRunExperienceLauncher",null,[980]);wa.prototype.Sh=function(Yb){this.fb=Yb;this.fb.register(980,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").tc().Cc(function(){return new Qa})};
wa.prototype.init=function(){};wa.prototype.dispose=function(){};wa.main=function(){zb.a.instance.Ui(new wa)};Af.Object.defineProperties(wa.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.FirstRunExperienceLauncher"}}});Object(ya.a)(wa,"FirstRunExperienceLauncherPackage",null,[3,4]);var $a=b(1318),Ta=b(1319),pa=b(1345),Da=b(1457),rb=b(11),Ab=b(232);ia.prototype.isEnabled=function(){if(W.AFrameworkApplication.fa?W.AFrameworkApplication.fa.ra("IsAnonymousUser"):1)return!1;
var Yb=W.AFrameworkApplication.Ob?Object(yb.a)(String,W.AFrameworkApplication.Ob.AudienceGroup):"";return"Unknown"!==Yb&&"Automation"!==Yb};Af.Object.defineProperties(ia.prototype,{UVc:{configurable:!0,enumerable:!0,get:function(){return"Excel"}},campaignId:{configurable:!0,enumerable:!0,get:function(){return"aed9de6b-d4e7-4878-988a-9dfec66fed9e"}},version:{configurable:!0,enumerable:!0,get:function(){return 1}},currentVersion:{configurable:!0,enumerable:!0,get:function(){return 0}},pgi:{configurable:!0,
enumerable:!0,get:function(){return this.isEnabled()&&this.$.ma(337)}},$6a:{configurable:!0,enumerable:!0,get:function(){return this.isEnabled()&&this.$.ma(339)}},Y6a:{configurable:!0,enumerable:!0,get:function(){return this.$.ma(338)}},ABh:{configurable:!0,enumerable:!0,get:function(){return null}},Gpf:{configurable:!0,enumerable:!0,get:function(){return 24}},CTf:{configurable:!0,enumerable:!0,get:function(){return 4E3}},OIb:{configurable:!0,enumerable:!0,get:function(){return this.$.ya.WebServiceBase||
""}}});Object(ya.a)(ia,"FirstRunExperienceLauncherSettings",null,[997]);ha.prototype.jRd=function(){this.dTe&&this.dTe.jRd(this.nBh)};Object(ya.a)(ha,"FirstRunExperienceManager",null,[996]);var ob=Ab.a;Rk(fa,ob);fa.prototype.create=function(){this.pb(this.$.da.za(311)||this.k6g())};fa.prototype.k6g=function(){var Yb=new ia(this.$);Yb=new ha(Ja.a.instance.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"),Yb);Yb.jRd();return Yb};fa.ka=function(Yb){Yb.da.Ga(312,new fa(Yb))};
Object(ya.a)(fa,"FirstRunExperienceManagerFactory",Ab.a,[]);var sb=b(59),Pb=Ab.a;Rk(qa,Pb);qa.prototype.create=function(){this.pb(this.$.da.za(361)||this.W6g())};qa.prototype.W6g=function(){var Yb=this;this.kkd=Ja.a.instance.nh("Common.IInProductMessagingUIManager");sb.a.rg.isReactSharedHeaderUxEnabled?nb.a.get_instance().ak(16,function(){Yb.e$e()}):this.e$e();return this.kkd};qa.prototype.e$e=function(){var Yb=this;Ja.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Ec){Ec.isFeatureEnabled("MsoPremiumBadge",
!0).then(function(bd){!bd&&Ec.isFreemiumUpsellEnabled()&&Yb.kkd.jkf();return null})})};qa.ka=function(Yb){Yb.da.Ga(362,new qa(Yb))};Object(ya.a)(qa,"InProductMessagingManagerFactory",Ab.a,[]);var Aa=b(1396),Ya=b(1321),kb=b(47),lb=b(440),ac=b(79),Dc=b(1),Zb=b(593),mc=b(21),Lb=b(639),Sa=Zb.a;Rk(Y,Sa);Y.prototype.YOd=function(Yb){this.wfa!==Yb&&(this.wfa=Yb,this.FGb())};Y.prototype.dispose=function(){this.gridView.Wb.wk(this.duf);this.gridView.Wb.Nl(this.cuf);this.gridView=null;Sa.prototype.dispose.call(this)};
Y.prototype.FGb=function(){this.CFd(this.wfa)};Y.prototype.refresh=function(){this.YOd(!this.gridView.isEditing)};Af.Object.defineProperties(Y.prototype,{PH:{configurable:!0,enumerable:!0,get:function(){return this.Tkc(this.wfa)}},name:{configurable:!0,enumerable:!0,get:function(){return Lb.a.cellEdit}}});Object(ya.a)(Y,"CellEditSafeStatePublisher",Zb.a,[]);var Cb=b(38),ec=b(110);Object(ya.a)(ka,"SafeStatePublisherState",null,[]);var wb=b(707),rc=Cb.a;Rk(ca,rc);ca.prototype.uZb=function(Yb){this.addHandler(ca.AQa,
Yb)};ca.prototype.Isc=function(Yb){this.removeHandler(ca.AQa,Yb)};ca.prototype.xza=function(Yb,Ec){function bd(ne,le){Md.PH=le.PH;Ic.HGb()}var Ic=this,Md=new ka(Yb,Ec);this.BQa.add(Md);Yb.uZb(bd);Md.handler=bd;this.HGb()};ca.prototype.kXd=function(Yb){for(var Ec=null,bd=ak(this.BQa),Ic=bd.next();!Ic.done;Ic=bd.next())if(Ic=Ic.value,Ic.publisher===Yb){this.rbg(Ic);Ec=Ic;break}Ec&&(this.BQa.remove(Ec),this.HGb())};ca.prototype.dispose=function(){for(var Yb=ak(this.BQa),Ec=Yb.next();!Ec.done;Ec=Yb.next())this.rbg(Ec.value);
this.BQa.clear();this.wyb&&(this.Wie.Jbj(this.Oyf.bind(this)),this.ima.abb(this.qya.bind(this)));rc.prototype.dispose.call(this)};ca.prototype.K$b=function(){var Yb=B.K$b(this.BQa.toArray().map(function(Ec){return Ec.PH}));return this.Uic&&1===Yb?2:Yb};ca.prototype.rbg=function(Yb){Yb.publisher.Isc(Yb.handler)};ca.prototype.HGb=function(){var Yb=this.K$b();Yb!==this.Yif&&(this.raiseEvent(ca.AQa,new wb.a(Yb)),this.Yif=Yb)};ca.prototype.Oyf=function(){this.Uic&&va.ULS.sendTraceTag(523317957,0,15,"ClientStateMonitor.onMergeWasAborted: Aborted merge occurred after another aborted merge.");
this.Uic=!0;this.HGb()};ca.prototype.qya=function(Yb,Ec){Yb=Ec.eca;(Ec=!X(Yb))||(Ec=this.rqi,Ec=(null===Yb||void 0===Yb?void 0:Yb.SuspensionStartTimestamp)!==(null===Ec||void 0===Ec?void 0:Ec.SuspensionStartTimestamp));Ec&&(this.Uic=!1);this.rqi=Yb;this.HGb()};Af.Object.defineProperties(ca.prototype,{wPj:{configurable:!0,enumerable:!0,get:function(){return ec.f(ec.c(this.BQa.toArray(),function(Yb){return 0!=Yb.PH}),function(Yb){return Yb.publisher.name})}}});ca.AQa="SSC";Object(ya.a)(ca,"ClientStateMonitor",
Cb.a,[]);var Mc=b(6),Pc=b(67),Kc=Zb.a;Rk(Q,Kc);Q.prototype.YOd=function(Yb){Yb!==this.wfa&&(this.wfa=Yb,this.FGb())};Q.prototype.dispose=function(){Pc.a(this.$).osc(this.gvf);this.b5a.Hq(this.rN);this.e7d=null;Kc.prototype.dispose.call(this)};Q.prototype.FGb=function(){this.CFd(this.wfa)};Q.prototype.refresh=function(){this.YOd(1===this.b5a.Tt||Pc.a(this.$).ji===this.b5a)};Af.Object.defineProperties(Q.prototype,{PH:{configurable:!0,enumerable:!0,get:function(){return this.Tkc(this.wfa)}},name:{configurable:!0,
enumerable:!0,get:function(){return Lb.a.b5a}},b5a:{configurable:!0,enumerable:!0,get:function(){return this.e7d}}});Object(ya.a)(Q,"IdleActivitySafeStatePublisher",Zb.a,[]);var ub=b(329),Fb=b(3),pc=b(22),eb=ac.a;Rk(H,eb);H.prototype.Lc=function(){return!1};H.prototype.executeCommand=function(){return Kb.Task.Ua(!0)};H.prototype.Ac=function(Yb,Ec){return 1905775613===Ec.command};H.prototype.Qc=function(){return!1};Object(ya.a)(H,"ToggleMergeSuspensionSafeState",ac.a,[403]);var ic=Cb.a;Rk(N,ic);N.prototype.jq=
function(Yb){this.addHandler(N.Hvd,Yb)};N.prototype.Hq=function(Yb){this.removeHandler(N.Hvd,Yb)};N.prototype.xz=function(){this.raiseEvent(N.Hvd)};N.prototype.dn=function(Yb){return Yb===N.s2i&&!!this.mergeSuspensionManager};N.prototype.Lr=function(Yb,Ec){if(!this.dn(Yb))return!1;this.mergeSuspensionManager&&(Ec.LabelText=this.Dlc,Ec.On=this.axd);return!0};N.prototype.dispose=function(){this.cNb&&(this.Ka.Oab(this.cNb),this.cNb.dispose(),this.cNb=null);this.mergeSuspensionManager&&(this.mergeSuspensionManager.ima.abb(this.qya),
this.mergeSuspensionManager.Eha.Isc(this.yOa),this.mergeSuspensionManager=null);this.statusBarManager&&(this.statusBarManager.BF(this),this.statusBarManager=null);this.Dlc=null;ic.prototype.dispose.call(this)};N.Hvd="MSMSC";N.s2i="QueryMergeSuspensionStatus";Object(ya.a)(N,"MergeSuspensionIndicatorManager",Cb.a,[465,157,10]);var Ac=b(7),lc=b(1086),Gc=Sys.EventArgs;Rk(O,Gc);Object(ya.a)(O,"TogglePendingMergeBlockedByClientEventArgs",Sys.EventArgs,[]);Object(ya.a)(J,"SuspensionState",null,[]);Rk(K,
J);Object(ya.a)(K,"ReadyForPendingMergeState",J,[]);var ed=new J,fd=new J,Bc=new K(!1),ld=new K(!0),Bd=b(1087),xb=Bd.a;Rk(F,xb);Object(ya.a)(F,"ReadyForPendingMergesUpdatedEventArgs",Bd.a,[]);var Fd=Cb.a;Rk(T,Fd);T.prototype.h9h=function(){return Object(lb.a)(ca,this.Eha)?Object(yb.a)(ca,this.Eha).K$b():1};T.prototype.zZb=function(Yb){this.addHandler(T.sVd,Yb)};T.prototype.Lsc=function(Yb){this.removeHandler(T.sVd,Yb)};T.prototype.qGg=function(Yb){this.addHandler(T.lGd,Yb)};T.prototype.ncj=function(Yb){this.removeHandler(T.lGd,
Yb)};T.prototype.zFg=function(Yb){this.addHandler(T.Cvd,Yb)};T.prototype.Ibj=function(Yb){this.removeHandler(T.Cvd,Yb)};T.prototype.d4i=function(){this.AFd(this.getState()===fd)};T.prototype.dispose=function(){this.Eha.Isc(this.yOa);this.Eha=null;this.ima.abb(this.qya);this.ima=null;Fd.prototype.dispose.call(this)};T.prototype.yed=function(){return Object(Ac.a)(new lc.a,{Current:this.kla.Current,Pending:this.kla.Pending,SuspensionStartTimestamp:this.kla.SuspensionStartTimestamp})};T.prototype.getState=
function(){return X(this.kla)?0==this.PH?ld:this.wyb&&1==this.PH?Bc:fd:ed};T.prototype.PSe=function(Yb,Ec){Yb!==Ec&&(Ec===fd?this.AFd(!0):Yb===fd&&this.AFd(!1));Ec instanceof K&&this.raiseEvent(T.lGd,new F(this.kla,Ec.Ioe||!this.wyb))};T.prototype.tvi=function(Yb,Ec,bd){Yb===ed&&Ec!==ed?(Yb=Ec===fd,Ec=Ec===Bc,va.ULS.sendTraceTag(252760283,0,50,"MergeSuspensionStateHandler.LogPendingMergesStatusChanged: Pending changes exist. IsBlocking: {0} publisher: {1} counter: {2} isBlockingAllMerges: {3}",Ec,
Ec||Yb?this.Eha.wPj.join(","):"",ea(this.kla),Yb)):Yb!==ed&&Ec===ed&&va.ULS.sendTraceTag(252760284,0,50,"MergeSuspensionStateHandler.LogPendingMergesStatusChanged: No pending changes. counter: {0}",ea(bd))};T.prototype.AFd=function(Yb){this.raiseEvent(T.sVd,new O(Yb))};T.sVd="TPMBBC";T.lGd="RFPMU";T.Cvd="MCC";Object(ya.a)(T,"MergeSuspensionStateHandler",Cb.a,[]);var Vd=Cb.a;Rk(M,Vd);M.prototype.wYa=function(Yb){this.addHandler("MCU",Yb)};M.prototype.abb=function(Yb){this.removeHandler("MCU",Yb)};
M.prototype.pya=function(Yb,Ec){Ec=void 0===Ec?"":Ec;var bd=this.D1.Current<Yb.Current||this.D1.Pending<Yb.Pending;if(Yb.SuspensionStartTimestamp&&this.Tic!==Yb.SuspensionStartTimestamp){if(this.Tic>Yb.SuspensionStartTimestamp){bd&&va.ULS.sendTraceTag(553736149,0,50,"PendingMergeMonitor.OnMergeCounterReceivedFromServer: skipping a higher stale counter received via {0}. S: {1}, C: {2}",Ec,M.rCb(Yb),M.rCb(this.D1));return}bd||va.ULS.sendTraceTag(553736148,0,50,"PendingMergeMonitor.OnMergeCounterReceivedFromServer: recovering from a potentially stale counter. S: {0}, C: {1}",
M.rCb(Yb),M.rCb(this.D1))}else if(!bd)return;this.D1=Yb;this.gKf(Yb,Ec)};M.prototype.dispose=function(){this.$.ea.xk(this.qvc);this.$.ea.GR(this.qvc);mc.g(this.$).Wb.Nl(this.m9a);Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:6329027_UpdateMergeCountWhenWebMethodReturnsWithErrors")||this.$.oa.cs(this.b8);var Yb=this.$.da.za(292);Yb&&Yb.abb(this.sCb);Vd.prototype.dispose.call(this)};M.prototype.gKf=function(Yb,Ec){Ec=void 0===Ec?"":Ec;X(Yb)&&Yb.SuspensionStartTimestamp>this.Tic&&(va.ULS.sendTraceTag(537155416,
0,50,"PendingMergeMonitor.RaiseMergeCounterUpdated: Merge suspension requested. MergeCounter: {0}, Origin: {1}",ea(Yb),Ec),this.Tic=Yb.SuspensionStartTimestamp);this.raiseEvent("MCU",new Bd.a(Yb))};M.prototype.wSf=function(){va.ULS.sendTraceTag(588276808,0,50,"PendingMergeMonitor.ResetMergeCounter : Last counter was {0}",M.rCb(this.D1));this.D1=Object(Ac.a)(new lc.a,{Pending:0,Current:0,SuspensionStartTimestamp:null})};M.rCb=function(Yb){return Yb?String.format("({0}/{1} @{2})",Yb.Current,Yb.Pending,
Yb.SuspensionStartTimestamp):"null"};Af.Object.defineProperties(M.prototype,{kla:{configurable:!0,enumerable:!0,get:function(){return this.D1}}});M.RZd="PMM.RTC";M.usb="PMM.EwaResult";M.Qfj="PMM.resetMergeCounter";Object(ya.a)(M,"PendingMergeMonitor",Cb.a,[]);Object(ya.a)(U,"ClientRevisions",null,[]);var se=b(44),ue=b(61),Ee=Cb.a;Rk(E,Ee);E.prototype.dispose=function(){this.$.oa.Kma(this.SBa);this.yyc();this.K5.ncj(this.zAf);this.K5.Lsc(this.TEb);this.K5.Ibj(this.Nyf);this.K5=null;Ee.prototype.dispose.call(this)};
E.prototype.rEj=function(){this.yyc();if(this.dHe()){var Yb=this.K5.yed();va.ULS.sendTraceTag(537155414,0,50,"RequestController.StartKeepBlockingPendingMergesTimer: Prevented starting StartKeepBlockingPendingMergesTimer because of repeated failure in counter {0} fail count: {1}",ea(Yb),this.sAb)}else this.tAb=this.kZa.create(this.NWf,this.rtc,se.a.tAb),this.n7a=this.kZa.sE(this.NWf,this.Mpi,se.a.n7a)};E.prototype.yyc=function(){this.n7a&&(this.tAb.cancel(),this.n7a.cancel(),this.n7a=this.tAb=null)};
E.prototype.FNi=function(Yb){var Ec=" fail count: "+this.sAb;this.sAb++;this.dHe()&&this.yyc();va.ULS.sendTraceTag(542229773,0,10,"RequestController.OnKeepBlockingPendingMergesRequestFailed: request failed {0}{1}",ea(Yb),Ec)};E.prototype.dHe=function(){return this.sAb>E.azi};E.azi=5;Object(ya.a)(E,"RequestController",Cb.a,[]);var qe=b(162),He=b(214),Ie=b(28),ef=b(295),Ye=Cb.a;Rk(G,Ye);G.prototype.AFg=function(Yb){this.addHandler(G.Ivd,Yb)};G.prototype.Jbj=function(Yb){this.removeHandler(G.Ivd,Yb)};
G.prototype.sMg=function(Yb,Ec){var bd=this;this.mLb(Yb,Ec)?(new qe.a).setResult(!0):(Ec=this.EXi(Yb,Ec),this.TAb=Yb,this.qBd++,Ec.continueWith(function(){bd.hJi()},0,He.a.none,this.vO))};G.prototype.EXi=function(Yb,Ec){this.PYd=this.ah.Y7;this.qif=Ec;va.ULS.sendTraceTag(554767493,0,50,"DoPendingMergeSender.performDoPendingMergeInternal: Sending DoPendingMerge {0} / {1} @{2}. allowSelectionAdjustment: {3}",Yb.Current,Yb.Pending,Yb.SuspensionStartTimestamp,Ec);this.isDocumentHidden||this.ry();return this.smj(Ec,
Yb)};G.prototype.mLb=function(Yb,Ec){if(this.cAa&&!Ec&&!this.cAa.Qmi())return va.ULS.sendTraceTag(523317956,0,50,"DoPendingMergeSender.shouldThrottle: We can't retrieve selection and selection adjustments are disallowed."),!0;if(!this.TAb||Yb.SuspensionStartTimestamp>this.TAb.SuspensionStartTimestamp)return this.vLa&&va.ULS.sendTraceTag(523551556,0,50,"DoPendingMergeSender.shouldThrottle: Allowing request for new suspension while previous is ongoing, new counter: {0} / {1} @{2}",Yb.Current,Yb.Pending,
Yb.SuspensionStartTimestamp),!1;if(this.vLa)return!0;if(this.Qdg){Yb=Z(Yb,this.TAb);var bd=this.ah.Y7-this.PYd<this.rtc;Ec=this.qif===Ec;return Yb&&bd&&Ec}return Z(Yb,this.TAb)&&this.ah.Y7-this.PYd<this.rtc};G.prototype.smj=function(Yb,Ec){function bd(){va.ULS.sendTraceTag(588276806,0,10,"DoPendingMergeSender.sendDoPendingMergeRequest: request failed {0} / {1} @{2}",Ec.Current,Ec.Pending,Ec.SuspensionStartTimestamp)}var Ic=this.xa.Pb();return this.cAa?this.cAa.Wij(this.OMh(Yb,bd,Ic)):this.ive(null,
!0,void 0,bd,Ic)};G.prototype.OMh=function(Yb,Ec,bd){var Ic=this;return function(Md,ne,le){var Ke=void 0;Ic.Qdg&&(va.ULS.shipAssertTag(523317955,0,null!=Md||Yb,"!allowSelectionAdjustment requires a non-null initialViewportState."),Ke=Ic.iJi.bind(Ic));ne&&(Ke=ef.b.call(null,function(oc){var Qc=oc.Result,md=null===Qc||void 0===Qc?void 0:Qc.AdjustedViewportState;3===(null===Qc||void 0===Qc?void 0:Qc.MergeResultState)&&(md=void 0);ne(md,oc.StateId)},Ke));le&&(Ec=ef.a.call(null,le,Ec));return Ic.ive(Md,
Yb,Ke,Ec,bd)}};G.prototype.ive=function(Yb,Ec,bd,Ic,Md){if(this.JTg){var ne=this.xa;Md=ne.Na(1,void 0===Md?null:Md);Md.viewportState=Yb;Md.allowViewAdjustment=Ec;Yb=ue.g(ne,"DoPendingMerge",Md,bd,Ic,null,null,0)}else ne=this.xa,Md=ne.Na(1,void 0===Md?null:Md),Md.viewportState=Yb,Md.allowViewAdjustment=Ec,Yb=ue.g(ne,"DoPendingMergeNew",Md,bd,Ic,null,null,0);return Yb};G.prototype.iJi=function(Yb){Yb=Yb.Result;void 0!=Yb&&3===Yb.MergeResultState&&(va.ULS.sendTraceTag(523317954,0,50,"DoPendingMergeSender.onDoPendingMergeSucceeded: Aborted merge."),
this.H3i())};G.prototype.H3i=function(){this.raiseEvent(G.Ivd,new Sys.EventArgs)};G.prototype.hJi=function(){this.qBd--};Af.Object.defineProperties(G.prototype,{vLa:{configurable:!0,enumerable:!0,get:function(){return 0<this.qBd}},isDocumentHidden:{configurable:!0,enumerable:!0,get:function(){return!!this.documentVisibilityObserver&&this.documentVisibilityObserver.Qi}}});G.Ivd="MWA";Object(ya.a)(G,"DoPendingMergeSender",Cb.a,[1012,1013]);Af.Object.defineProperties(C.prototype,{reportName:{configurable:!0,
enumerable:!0,get:function(){return this.d8h?"SelectionAdjustInHiddenDocument":"SelectionAdjust"}}});Object(ya.a)(C,"SelectionAdjustSessionEndsReport",null,[444]);var pe=b(45),Qd=b(95);x.prototype.ofg=function(Yb){var Ec=this;this.j6d&&(this.jUb?this.uQb=this.selectedRanges.map(function(ne){return Ec.vAc(ne,Ec.$Dc)}):this.fCa&&(this.uQb=[this.vAc(this.selectedRanges[0],this.$Dc)]));for(var bd=ak(this.uQb),Ic=bd.next();!Ic.done;Ic=bd.next()){Ic=Ic.value;if(!this.bkg&&!Ic)return!1;if(Ic){Ic=ak(Ic);
for(var Md=Ic.next();!Md.done;Md=Ic.next())if(Md=Md.value,Md.tk&&Md.je.Revision<Yb)return!1}}return!0};x.prototype.XJj=function(){var Yb;if(this.fCa||this.jUb){var Ec={SheetName:this.sheetName,ActiveCell:null===(Yb=this.activeCell)||void 0===Yb?void 0:Yb.toString(),SelectedRange:this.selectedRanges[0].toString(),TopLeft:void 0,SelectedRanges:void 0};this.jUb&&(Ec.SelectedRange=void 0,Ec.SelectedRanges=pe.r(this.selectedRanges,this.jb));return Ec}};x.prototype.toString=function(){var Yb,Ec;return String.format("active cell: {0} selection: {1}",
null!==(Ec=null===(Yb=this.activeCell)||void 0===Yb?void 0:Yb.toString())&&void 0!==Ec?Ec:"null",ec.f(this.selectedRanges,function(bd){var Ic;return null!==(Ic=null===bd||void 0===bd?void 0:bd.toString())&&void 0!==Ic?Ic:"null"}).join(","))};x.prototype.equals=function(Yb){return Yb?this.activeCell.equals(Yb.activeCell)&&pe.Q(this.selectedRanges,Yb.selectedRanges)&&this.sheetName===Yb.sheetName:!1};x.prototype.rTg=function(){for(var Yb=ak(this.selectedRanges.entries()),Ec=Yb.next();!Ec.done;Ec=Yb.next()){var bd=
ak(Ec.value);Ec=bd.next().value;bd=bd.next().value;if(null===bd||void 0===bd?0:bd.contains(this.activeCell))return Ec}return-1};x.prototype.vAc=function(Yb,Ec){var bd,Ic=mc.g(this.jb).Ea.f3a(Yb,Ec);Ic||va.ULS.sendTraceTag(522803340,0,50,"SelectionState.tryGetBlockCacheItemsFromRange: no items found. range: {0} ; activeItemNameIsDefined: {1}",null!==(bd=null===Yb||void 0===Yb?void 0:Yb.toString())&&void 0!==bd?bd:"null",!!Ec);return Ic};Af.Object.defineProperties(x.prototype,{activeCell:{configurable:!0,
enumerable:!0,get:function(){return this.iG}},selectedRanges:{configurable:!0,enumerable:!0,get:function(){return this.m9}},Xs:{configurable:!0,enumerable:!0,get:function(){var Yb=!1;if(null===this.QI||void 0===this.QI)Yb=!0;else if(this.QI>=this.selectedRanges.length||!this.selectedRanges[this.QI].contains(this.activeCell))va.ULS.sendTraceTag(521200010,0,50,"SelectionState.indexOfActiveRange: the index of the adjusted active range has changed. indexOfActiveRange: {0}, selectedRangesLength: {1}",
this.QI,this.selectedRanges.length),Yb=!0;Yb&&(this.QI=this.rTg());return this.QI}},activeRange:{configurable:!0,enumerable:!0,get:function(){return 0>this.Xs?this.activeCell:this.selectedRanges[this.Xs]}},sheetName:{configurable:!0,enumerable:!0,get:function(){return this.kWb}},activeItemName:{configurable:!0,enumerable:!0,get:function(){return this.$Dc}},fCa:{configurable:!0,enumerable:!0,get:function(){return 1===this.selectedRanges.length}}});Object(ya.a)(x,"SelectionState",null,[]);var fe=b(208),
Hc;(function(Yb){Yb[Yb.none=0]="none";Yb[Yb.waitingForAdjusted=1]="waitingForAdjusted";Yb[Yb.invalid=2]="invalid";Yb[Yb.nonContinuous=3]="nonContinuous";Yb[Yb.noAdjustRequired=4]="noAdjustRequired";Yb[Yb.noAdjustRequiredWithDivergence=5]="noAdjustRequiredWithDivergence";Yb[Yb.divergenceOnResponse=6]="divergenceOnResponse";Yb[Yb.waitingForViewport=7]="waitingForViewport";Yb[Yb.adjusted=8]="adjusted";Yb[Yb.divergenceOnViewportReady=9]="divergenceOnViewportReady";Yb[Yb.differentSheetAdjust=10]="differentSheetAdjust";
Yb[Yb.editBoxDivergence=11]="editBoxDivergence";Yb[Yb.exception=12]="exception"})(Hc||(Hc={}));Object(ya.b)("SelectionAdjustState",Hc);var ud=b(948);y.prototype.Wij=function(Yb){function Ec(){bd.PFi()}var bd=this,Ic=null,Md=null;this.yaf()?(this.WL.parallel++,va.ULS.sendTraceTag(526390086,0,15,"SelectionAdjustManager.runRequestWithSelectionAdjust: Skipping parallel request. Current adjustedSelection is defined : {0}",!!this.Ly)):(Ic=function(ne,le){bd.QFi(ne,le)},Md=this.Prj());return null===Yb||
void 0===Yb?void 0:Yb(Md,Ic,Ec)};y.prototype.Qmi=function(){return!this.yaf()&&this.Eaa().fCa};y.prototype.Prj=function(){var Yb;va.ULS.shipAssertTag(525135961,0,0===this.PC,"SelectionAdjustManager.setPreRequestState: unexpected state");this.Ly&&(this.WL.errors++,va.ULS.sendTraceTag(526960090,0,10,"SelectionAdjustManager.setPreRequestState: About to ignore a defined Adjusted selection: {0}",this.Ly.toString()));this.Ly=null;this.Rx=this.Eaa();var Ec=null,bd=null===(Yb=this.Rx)||void 0===Yb?void 0:
Yb.XJj();bd&&(Ec={ActiveSheetName:this.Rx.sheetName,SheetViewportStateChanges:[bd]});this.PC=1;return Ec};y.prototype.PFi=function(){va.ULS.shipAssertTag(525135960,0,1===this.PC,"SelectionAdjustManager.onAdjustedRequestFailed: unexpected state");this.WL.errors++;this.PC=2;this.$q()};y.prototype.QFi=function(Yb,Ec){try{va.ULS.shipAssertTag(525135959,0,1===this.PC,"SelectionAdjustManager.onAdjustedSelectionReady: unexpected state"),this.fMb=Ec,Ec=2,this.Rx?Yb?(this.Ly=this.qvj(Yb))?(Ec=7,this.ICb||
this.Rx.fCa)?this.Rx.equals(this.Ly)?this.eRf&&!this.Rx.equals(this.Eaa())?(this.WL.adjustedDidntChangeWithDivergence++,Ec=5):(this.WL.adjustedDidntChange++,Ec=4):this.Rx.sheetName!=this.Ly.sheetName?(this.WL.differentSheetAdjust++,Ec=10):this.eRf&&!this.Rx.equals(this.Eaa())&&(this.WL.divergenceOnResponse++,Ec=6,this.dRf()):(this.WL.nonContinuous++,Ec=3):this.WL.errors++:(this.WL.errors++,va.ULS.sendTraceTag(537155412,0,15,"SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted returned null, initialSelection: {0}",
this.Rx.toString())):(this.WL.errors++,va.ULS.sendTraceTag(537155413,0,10,"SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted selection results returned when not waiting for them, adjusted:  ActiveCell: {0}, SelectedRange: {1}",null===Yb||void 0===Yb?void 0:Yb.ActiveCell,null===Yb||void 0===Yb?void 0:Yb.SelectedRange)),this.PC=Ec}catch(bd){this.PC=12,va.ULS.sendTraceTag(525135958,0,10,"SelectionAdjustManager.OnAdjustedSelectionReady: caught Exception {0}",bd)}finally{7!=this.PC?this.$q():this.XWc(!1,
!0)}};y.prototype.dispose=function(){this.gridView.Ea.fv(this.Ai);this.gridView.Ea.Gq(this.c9a);this.gridView.Ea.iPf(this.c9a);this.gridView.Ea.Sab(this.c9a);Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:6385622_SelectionAdjustImplementsCustomReportManager")&&this.$.ol(this.Yc)};y.prototype.yaf=function(){return 1===this.PC||7===this.PC};y.prototype.qvj=function(Yb){var Ec=this,bd,Ic;if(!function(){var Ke=pe.Z(Yb.ActiveCell,Ec.$.va);bd=Ke.range;return Ke}().returnValue)return va.ULS.sendTraceTag(537155411,
0,10,"SelectionAdjustManager.sheetViewportStateToSelectionState: Unable to extract active cell {0}",Yb.ActiveCell),null;var Md=[];if(this.ICb){var ne=this.$.pa,le=!!ne&&2===ne.QF;if(Yb.SelectedRanges)Md=pe.g(Yb.SelectedRanges.Ranges);else if(!le)return va.ULS.sendTraceTag(522826913,0,10,"SelectionAdjustManager.sheetViewportStateToSelectionState: SelectedRanges is null, active sheet exists: {0}",!!ne),null}else{if(!function(){var Ke=pe.Z(Yb.SelectedRange,Ec.$.va);Ic=Ke.range;return Ke}().returnValue)return va.ULS.sendTraceTag(537155410,
0,10,"SelectionAdjustManager.sheetViewportStateToSelectionState: Unable to extract selected range {0}",Yb.SelectedRange),null;Md.push(Ic)}return new this.zWf(this.$,bd,Md,Yb.SheetName,this.Rx.activeItemName,this.Rx.Xs)};y.prototype.Eaa=function(){var Yb=this.$.pa;if((null===Yb||void 0===Yb?0:Yb.activeCell)&&Yb.selectedRanges&&Yb.sheetName)return new this.zWf(this.$,Yb.activeCell,Yb.selectedRanges,Yb.sheetName,this.$.activeItemName,Yb.Xs);va.ULS.sendTraceTag(525135957,0,10,"SelectionAdjustManager.getCurrentSelection: invalid activeItem. activeItem null: {0}, activeCell null: {1}, selectedRanges null: {2}, sheetName null: {3}",
!Yb,!(null===Yb||void 0===Yb?0:Yb.activeCell),!(null===Yb||void 0===Yb?0:Yb.selectedRanges),!(null===Yb||void 0===Yb?0:Yb.sheetName));return null};y.prototype.aEe=function(){var Yb=this;this.$.da.Za(276,function(){var Ec=fe.a(Yb.$);Ec.jY(Yb.M0d);Ec.jY(Yb.N0d)})};y.prototype.XWc=function(Yb,Ec){var bd;if(this.eli(Yb))if(Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:6280340_preventRecursionOfAttemptAdjustSelection")&&8===this.PC)va.ULS.sendTraceTag(523106438,0,15,"SelectionAdjustManager.attemptAdjustSelection: skipping as was already adjusted");
else{Ec&&va.ULS.sendTraceTag(524039250,0,50,"SelectionAdjustManager.attemptAdjustSelection: viewport ready on response");try{if(va.ULS.shipAssertTag(525135956,0,7===this.PC,"SelectionAdjustManager.attemptAdjustSelection: unexpected state"),this.Rx.equals(this.Eaa()))if(this.mej&&(null===(bd=this.gridView)||void 0===bd?0:bd.isEditing))this.WL.editBoxDivergence++,this.PC=11;else{Yb=0;if(this.ICb&&(Yb=this.Ly.Xs,-1==Yb)){this.WL.errors++;va.ULS.sendTraceTag(522826912,0,10,"SelectionAdjustManager.attemptAdjustSelection: invalid indexOfActiveRange");
return}this.WL.adjusted++;this.PC=8;Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:6413876_AdjustSelectionWithoutCallingGoto")?this.gridView.ha.BB(this.Ly.selectedRanges,Yb,this.Ly.activeCell,0,void 0,Qd.a.xWf):this.gridView.fV(this.Ly.selectedRanges,Yb,this.Ly.sheetName,null,this.Ly.activeCell,null,null,0,Qd.a.xWf)}else this.WL.divergenceOnViewportReady++,this.dRf(),this.PC=9}catch(Ic){this.PC=12,va.ULS.sendTraceTag(525135955,0,10,"SelectionAdjustManager.attemptAdjustSelection: caught Exception {0}",
Ic)}finally{this.$q()}}};y.prototype.eli=function(Yb){if(!this.Ly)return!1;if(!this.Rx)return va.ULS.sendTraceTag(537155409,0,10,"SelectionAdjustManager.attemptAdjustSelection: initialSelection is null while adjustedSelection isn't null, adjustedSelection: {0}",this.Ly.toString()),!1;if(this.Toe&&mc.g(this.$).Ea.kvd<this.fMb)return!1;if(Yb||this.fIj){if(!this.Toe&&mc.g(this.$).Ea.kvd<this.fMb)return!1;(this.ICb||this.Rx.fCa)&&va.ULS.sendTraceTag(528590295,0,15,"SelectionAdjustManager.attemptAdjustSelection: got to blockCacheConsistent while pending for selection adjust")}else if(!this.Rx.fCa&&
!this.ICb||!this.Rx.ofg(this.fMb)||!this.Ly.ofg(this.fMb))return!1;return!0};y.prototype.$q=function(){var Yb,Ec,bd,Ic;this.Rej&&2!=this.PC&&va.ULS.sendTraceTag(526792898,0,50,"SelectionAdjustManager.clearState: initial: {0}, adjusted: {1}, state: {2}, hidden: {3}",null!==(Ec=null===(Yb=this.Rx)||void 0===Yb?void 0:Yb.toString())&&void 0!==Ec?Ec:"null",null!==(Ic=null===(bd=this.Ly)||void 0===bd?void 0:bd.toString())&&void 0!==Ic?Ic:"null",Hc[this.PC],ud.a.gB(this.Ipf));this.Rx=this.Ly=null;this.PC=
0};y.prototype.dRf=function(){var Yb=this.Eaa();va.ULS.sendTraceTag(537155408,0,50,"SelectionAdjustManager.ReportDivergence: initial: {0} current: {1} adjusted: {2} sheetSameBetweenInitialAndAdjusted: {3} sheetSameBetweenInitialAndCurrent: {4}",this.Rx.toString(),Yb?Yb.toString():"",this.Ly.toString(),this.Rx.sheetName===this.Ly.sheetName,this.Rx.sheetName===(Yb?Yb.sheetName:null))};Af.Object.defineProperties(y.prototype,{zWf:{configurable:!0,enumerable:!0,get:function(){return x}},WL:{configurable:!0,
enumerable:!0,get:function(){return ud.a.gB(this.Ipf)?this.N0d:this.M0d}}});Object(ya.a)(y,"SelectionAdjustManager",null,[1011,10]);var Gd=ac.a;Rk(B,Gd);B.prototype.zZb=function(Yb){this.Dfa.zZb(Yb)};B.prototype.Lsc=function(Yb){this.Dfa&&this.Dfa.Lsc(Yb)};B.prototype.xza=function(Yb,Ec){this.DCa.xza(Yb,Ec)};B.prototype.kXd=function(Yb){this.DCa.kXd(Yb)};B.prototype.pya=function(Yb,Ec){this.FWa.pya(Yb,void 0===Ec?"":Ec)};B.prototype.dispose=function(){this.rec&&(this.rec.dispose(),this.rec=null);
this.cAa&&this.cAa.dispose();this.k1a.dispose();this.WJd&&(this.WJd.dispose(),this.WJd=null);this.Dfa&&(this.Dfa.dispose(),this.Dfa=null);this.FWa.dispose();this.FWa=null;this.DCa.dispose();this.DCa=null;this.n_a&&(this.n_a.dispose(),this.n_a=null);this.c5a&&(this.c5a.dispose(),this.c5a=null);this.$=null;Gd.prototype.dispose.call(this)};B.prototype.FGb=function(){this.Dfa.d4i()};B.K$b=function(Yb){var Ec=0;Yb=ak(Yb);for(var bd=Yb.next();!bd.done;bd=Yb.next()){bd=bd.value;if(2==bd)return 2;1==bd&&
(Ec=1)}return Ec};B.prototype.C9h=function(Yb,Ec){this.DCa=new ca(this.k1a,this.FWa);Ec?Object(lb.a)(Q,Ec)?this.xza(Ec,Object(yb.a)(Q,Ec).PH):Object(lb.a)(Y,Ec)?this.xza(Ec,Object(yb.a)(Y,Ec).PH):this.xza(Ec,0):(this.n_a=new Y(Yb),this.c5a=new Q(Yb),this.xza(this.n_a,this.n_a.PH),this.xza(this.c5a,this.c5a.PH))};Af.Object.defineProperties(B.prototype,{Eha:{configurable:!0,enumerable:!0,get:function(){return this.DCa}},ima:{configurable:!0,enumerable:!0,get:function(){return this.FWa}},K5:{configurable:!0,
enumerable:!0,get:function(){return this.Dfa}}});Object(ya.a)(B,"MergeSuspensionManager",ac.a,[995,10]);var jd=Ab.a;Rk(A,jd);A.prototype.create=function(){va.ULS.sendTraceTag(537155419,0,50,"MergeSuspensionFactory.Create");this.pb(this.Ec.da.za(343)||this.Ec.da.Ga(343,new B(this.Ec,kb.a.instance)))};A.ka=function(Yb){va.ULS.sendTraceTag(537155418,0,50,"MergeSuspensionFactory.Attach");Yb.da.Ga(344,new A(Yb))};Object(ya.a)(A,"MergeSuspensionFactory",Ab.a,[]);var Sd=b(51),Wd=b(37),Le=b(90),Pd=b(99),
Re=b(54),Qe=b(14);v.rsi=3;v.connected=0;Object(ya.a)(v,"ConnectionStateConstants",null,[]);var jc=b(111),Fa=b(119),Qb=b(42);r.prototype.xYf=function(){this.durationMs=Fa.a(Ie.a.Ta,this.startTime)};r.prototype.rAd=function(Yb){var Ec=this,bd;this.xYf();Qb.a(Yb).Gsc(this.Ltf);Qb.a(Yb).Tf.Hsc(this.vca);Yb.da.Za(291,function(Ic){Ic.Vab(Ec.a6)});if(null===(bd=Yb.ea)||void 0===bd?0:bd.df)Yb.ea.df.cJd(this.lBd),this.wasUserActiveOnPIEnd=Yb.ea.df.Tr};r.prototype.Ti=function(Yb){var Ec=this;Qb.a(Yb).pZb(this.Ltf);
this.isToastShown?this.toastRaiser="Immediate":Qb.a(Yb).Tf.SUc(this.vca);Yb.da.Za(291,function(bd){Ec.hasTabbedOut=bd.Qi;bd.oYa(Ec.a6)});this.wasUserActiveOnPIStart&&Yb.ea.df.Jne(this.lBd)};Object(ya.a)(r,"PartialInteractivityData",null,[]);var cb=b(1322);Rk(z,r);z.prototype.dIi=function(Yb,Ec){this.swappedByOffline=Ec;this.rAd(Yb)};z.prototype.Jpj=function(Yb){this.errorDataDuringConnectivityIssuesMode=Yb};z.prototype.t6i=function(Yb){10>this.failedRequests.length&&(Yb=Yb+"_"+jc.getElapsedSeconds(this.startTime,
Ie.a.Ta.Jb).toString(),this.failedRequests.push(Yb))};Object(ya.a)(z,"ConnectivityIssuesData",r,[]);var Xb=b(165),kc=b(126),Wc=b(112);n.jih="DuringWork";n.connectivityIssues="ConnectivityIssues";n.offline="Offline";Object(ya.a)(n,"UnavailabilityTypes",null,[]);var id=b(50);w.prototype.dispose=function(){this.$&&(Qb.a(this.$).Tf.rPf(this.Xuf),this.$.tf&&this.$.tf.qPf(this.Uuf));this.data&&this.$.oa.tf.mQf(this.Jn);this.$=null};w.prototype.eTg=function(Yb){var Ec=this.b$c-1;return(this.data.averageDurationBetweenFailedRequestsSec*
(Ec-1)+Yb)/Ec};Object(ya.a)(w,"ConnectivityIssuesTelemetryManager",null,[10]);var Vc=b(1058),td=b(130),rd=b(998);f.prototype.OQj=function(){this.qU&&this.qU.xYf()};f.prototype.TBg=function(Yb){this.allOfflinePartialInteractivitiesDataInSession.push(Yb);this._count++};Af.Object.defineProperties(f.prototype,{count:{configurable:!0,enumerable:!0,get:function(){return this._count}},qU:{configurable:!0,enumerable:!0,get:function(){return this.allOfflinePartialInteractivitiesDataInSession[this.allOfflinePartialInteractivitiesDataInSession.length-
1]}}});Object(ya.a)(f,"OfflinePartialInteractivitiesDataForLog",null,[]);Rk(m,r);m.prototype.ltj=function(Yb){this.timeFromLastOffline=Yb};m.prototype.Kpj=function(Yb){this._errorDataDuringOfflineMode=Yb};Object(ya.a)(m,"OfflinePartialInteractivityData",r,[]);l.prototype.dispose=function(){this.$&&Qb.a(this.$)&&Qb.a(this.$).Tf.GId(this.F9a);Le.a.Ia(this.Otb);this.$=this.Otb=null};l.prototype.kPi=function(Yb){this.qU=new m(Ie.a.Ta.Jb,this.$,0!==Yb);this.qU.ltj(-1!==this.nEd?window.performance.now()-
this.nEd:-1);this.aOa.TBg(this.qU);Qb.a(this.$).Tf.SUc(this.vca);this.A2a();this.Otb=kb.a.instance.sE(this.A2a,l.YBh,se.a.A2a);Xb.a(this.$).zUc(this.KUf)};l.prototype.lPi=function(){this.qU.rAd(this.$);this.A2a();Le.a.Ia(this.Otb);this.Otb=null;this.nEd=window.performance.now();Qb.a(this.$).Tf.Hsc(this.vca);Xb.a(this.$).uId(this.KUf);this.iej()};l.prototype.Pjj=function(Yb,Ec){var bd=this;this.$?this.$if=Wd.TaskExtensions.Ba(this.$if,function(){bd.indexedDB.Rbb(new rd.a(Yb,Ec))},this.$.la):va.ULS.sendTraceTag(537155205,
0,15,"OfflineModeTelemetryManager.SaveToIndexedDBSequential: EwaControl is null when attempting to write to IDB")};l.prototype.dej=function(){var Yb=this.$.la;Wd.TaskExtensions.Ba(Wd.TaskExtensions.Ba(this.indexedDB.E3a(l.pCd),this.Hej,Yb),this.Y9i,Yb)};l.prototype.iej=function(){if(this.qU){var Yb=Sys.Serialization.JavaScriptSerializer.serialize(this.qU);Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_71qb3_Offline")?id.b().PJb(560791645,0,50,n.offline,this.qU.durationMs,
"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: {0}",Yb):va.ULS.sendTraceTag(560791645,0,50,"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: {0}",Yb)}Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:5508233_ReportNetworkDownVeto")&&this.qU&&this.qU.isToastShown&&Pd.Health.instance.recordQosError(kc.a.EUj,[Wc.a.ujc],!0,!1,!1,!1,null)};l.tkd="NetworkAvailability";l.ukd=
"NetworkAvailabilityData";l.pCd="partialInteractivityData";l.YBh=3E3;Object(ya.a)(l,"OfflineModeTelemetryManager",null,[10]);k.prototype.dispose=function(){Le.a.Ia(this.Gsf);Le.a.Ia(this.KCi);Le.a.Ia(this.rla);Le.a.Ia(this.l1g);this.$=null};Object(ya.a)(k,"NetworkConnectionTelemetryManager",null,[10]);Rk(e,r);e.prototype.F9a=function(){this.wasInteruptedByOfflineMode=!0};Object(ya.a)(e,"SilentReopenData",r,[]);d.prototype.dispose=function(){this.Tf.RPf(this.Hyf);this.Tf.Ocj(this.rCf);this.v7=this.Tf=
this.$=null};d.prototype.oCf=function(Yb,Ec){Yb.LL?this.v7=new e(Ie.a.Ta.Jb,this.$,0!==Yb.Xna,Ec):(5===Yb.Xna&&(this.v7.wasInteruptedByOfflineMode=!0),3!==Yb.Xna&&2!==Yb.Xna||va.ULS.sendTraceTag(537155202,0,10,"SilentReopenPartialInteractivityTelemetryManager.OnSilentReopen: BackToWork/DuringWork partial interactivity has been swapped to DuringWork/BackToWork."),this.v7.rAd(this.$),2===Ec?Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_8dtae_B2W")?id.b().QJb(571289604,
0,50,n.offline,this.v7.durationMs,this.v7):va.ULS.sendTraceTag(571289604,0,50,Re.a.xc(this.v7)):Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_6w9lg_DuringWork")?id.b().QJb(542782150,0,50,n.jih,this.v7.durationMs,this.v7):va.ULS.sendTraceTag(542782150,0,50,Re.a.xc(this.v7)),this.v7=null)};Object(ya.a)(d,"SilentReopenPartialInteractivityTelemetryManager",null,[10]);var za=Cb.a;Rk(c,za);c.prototype.dispose=function(){this.tf&&(this.Owc&&(this.tf.Obj(this.tEb),this.tf.VHb(this.qzf)),
this.tf.qPf(this.Vuf),this.tf.Aaj(this.Wuf));this.Bzb&&this.documentVisibilityObserver&&(this.documentVisibilityObserver.OHb(this.j9a),this.Bzb=!1);this.$&&(this.Jrc&&this.OAc(),this.$.ea&&(this.$.ea.gQf(this.qCf),this.$.ea.df&&this.$.ea.df.ZPa(this.DOa)));Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&this.M0&&(this.M0.dispose(),this.M0=null);Le.a.Ia(this.Sqf);this.$=null;za.prototype.dispose.call(this)};c.prototype.Byi=function(){this.mQd=!0};c.prototype.kje=
function(){this.Gna||(this.Gna=Qb.a(this.$).Tf.SXa(3,"NetworkConnectionStateManager.ActivateDuringWorkSilentReopenPartialInteractivity"))};c.prototype.Dei=function(){if(this.mQd)return this.mQd=!1,!0;var Yb=this.E7>this.umf||this.mkd>this.umf&&10>this.E7;va.ULS.sendTraceTag(537155223,0,50,"NetworkConnectionStateManager.IsBackToWorkSilentReopen: Inactivity duration: Time from last activity:{0}, Time gap between last two activities: {1}. return value:{2}",this.E7,this.mkd,Yb);return Yb};c.prototype.Tej=
function(){Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&(this.M0=kb.a.instance.create(function(){Pd.Health.instance.recordQosError(kc.a.KCj,[Wc.a.ujc],!0,!0,!1,!1,null)},6E3,"ReportLongSilentReopenBackToWorkVeto",void 0,!0))};c.prototype.xzg=function(){var Yb=this;this.Gna||this.z0?va.ULS.sendTraceTag(542782155,0,10,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Trying to activate during-work partial interactivity when we are already in this partial interactivity or there is a running timer that's going to do it soon."):
this.z0=kb.a.instance.create(function(){Yb.$?Yb.Gna?va.ULS.sendTraceTag(537155221,0,15,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Tried to activate SilentReopenDuringWork PI when there is already an DuringWorkSilentReopen partial interactivity object"):mc.g(Yb.$).isEditing?(Yb.Hab||(mc.g(Yb.$).$b.vm(Yb.Df),va.ULS.sendTraceTag(541893722,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Registered OnEditEnded while during-work silent reopen")),
Yb.Iab=!0,va.ULS.sendTraceTag(537155220,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Need to init during-work silent reopen partial interactivity but the user is during a cell edit. Registered to OnEditEnded event.")):Yb.kje():va.ULS.sendTraceTag(537155222,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: EwaControl is null")},this.a4f,se.a.IBj,void 0,!0)};c.prototype.Opf=function(Yb){this.D1c=this.Pue(2,Yb,!0);this.foe()};c.prototype.blc=
function(Yb,Ec){this.bWb=this.Pue(Yb,Ec,!1);this.foe()};c.prototype.Pue=function(Yb,Ec,bd){bd=bd?this.D1c:this.bWb;return Ec?bd|Yb:bd&~Yb};c.prototype.rVd=function(){var Yb=!!this.bOa,Ec=!!this.XRa,bd=!!this.Gna,Ic=!!this.l3b;this.OBb&&!Yb?this.wzg():!this.OBb&&Yb&&this.Lbh();!this.dkc||Ec||bd?this.dkc||(Ec?this.AFe():(bd||this.z0&&this.z0.Qp)&&this.BFe()):this.e1f&&this.ufa?this.uzg():!this.aLb||this.ufa||Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:5658794_DontActivatePartialInteractivityIfTimerIsRunning")&&
this.z0||this.xzg();this.oka&&!Ic?this.n9f(!0):!this.oka&&Ic&&this.n9f(!1)};c.prototype.wzg=function(){this.$?this.bOa?va.ULS.sendTraceTag(537155215,0,15,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Tried to activate offline PI when there is already an offline partial interactivity object"):mc.g(this.$).isEditing?(this.Iab||(mc.g(this.$).$b.vm(this.Df),va.ULS.sendTraceTag(537155217,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Registered OnEditEnded during offline mode")),
this.Hab=!0,va.ULS.sendTraceTag(537155216,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Turned offline while user is editing a cell, registered to OnEditEnded event.")):this.nje():va.ULS.sendTraceTag(537155214,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: EwaControl is null")};c.prototype.nje=function(){this.bOa||(this.bOa=Qb.a(this.$).Tf.SXa(5,"NetworkConnecStateManager.ActivateOfflinePartialInteractivity"))};c.prototype.Lbh=function(){this.bOa&&
(Le.a.Ia(this.bOa),this.bOa=null)};c.prototype.AFe=function(){this.XRa&&(Le.a.Ia(this.XRa),this.XRa=null);Dc.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&this.M0&&this.M0.Qp&&this.M0.cancel();this.M0=null};c.prototype.BFe=function(){this.Gna&&(Le.a.Ia(this.Gna),this.Gna=null);this.z0&&(Le.a.Ia(this.z0),this.z0=null);this.Iab&&!this.Hab&&mc.g(this.$).$b.Nl(this.Df);this.Iab=!1};c.prototype.uzg=function(){this.XRa||(this.XRa=Qb.a(this.$).Tf.SXa(2,"NetworkConnectionStateManager.ActivateLongInactivitySilentReopenPartialInteractivity",
void 0,Qe.a.instance.ga(2160)));this.Tej()};c.prototype.n9f=function(Yb){Yb?(this.l3b=Qb.a(this.$).Tf.SXa(4,"NetworkConnectionStateManager.ConnectivityIssues"),this.t2i()):(Le.a.Ia(this.l3b),this.l3b=null)};c.prototype.t2i=function(){if(this.$&&this.$.oa){var Yb=this.$.oa.xa.Pb();ue.J(this.$.oa.xa,null,null,null,Yb)}};c.prototype.OAc=function(){Pc.a(this.$).wQ(Mc.a.JOa).Hq(this.Azf);this.$.ol(this.Yc);this.Jrc=!1};c.prototype.foe=function(){this.documentVisibilityObserver||va.ULS.sendTraceTag(537155211,
0,15,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: Document visibility observer is null while it shouldn't be.");this.documentVisibilityObserver&&this.documentVisibilityObserver.Qi?this.Bzb||(this.documentVisibilityObserver.ZYb(this.j9a),this.Bzb=!0,va.ULS.sendTraceTag(541193954,0,50,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: tabbed out user, will update the partial interactivity state when the user will be back.")):this.rVd()};Af.Object.defineProperties(c.prototype,
{Fgi:{configurable:!0,enumerable:!0,get:function(){return this.ufa}},OBb:{configurable:!0,enumerable:!0,get:function(){return!(this.bWb&1)}},dkc:{configurable:!0,enumerable:!0,get:function(){return!(this.bWb&2)}},oka:{configurable:!0,enumerable:!0,get:function(){return!!(this.D1c&2)}}});Object(ya.a)(c,"NetworkConnectionStateManager",Cb.a,[994,10]);var tb=Ab.a;Rk(a,tb);a.prototype.create=function(){var Yb=this;Wd.TaskExtensions.Ba(Sd.GetServiceTaskFactory.Ra(this.$.da,395,396,this.hb),function(Ec){Yb.pb(Yb.$.da.za(400)||
new c(Yb.$,Ec.result))},this.$.la,3)};a.ka=function(Yb){Yb.da.Ga(401,new a(Yb))};Object(ya.a)(a,"NetworkConnectionStateManagerFactory",Ab.a,[]);var Wb=b(1458),fc=b(1366),xc=b(1419);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.InsertPicture");Type.registerNamespace("_Ewa");Object(sa.a)();Object($a.a)();Object(Ta.a)();Object(pa.a)();Object(Da.a)();Object(Aa.a)();Object(Ya.a)();Object(xc.a)();Type.registerNamespace("Common.App.InProductMessaging");da.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");
wa.main();(function(){rb.a.Fa(function(){rb.a.Fa(fa.ka)})})();(function(){rb.a.Fa(function(){rb.a.Fa(qa.ka)})})();rb.a.Fa(A.ka);rb.a.Fa(a.ka);Object(Wb.a)();Object(fc.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.pi.js.map/a81473348c21734cc7cb1a8017b1a43a/EwaDS.pi.js.map