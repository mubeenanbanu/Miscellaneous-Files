(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[29],{1349:function(u,D,b){function a(){Type.registerNamespace("Common.App.Rename");La.a.instance.Ui(new c,7)}function c(){this.ib=this.fb=null}function d(Ia,mb,fb,Ma,Hb,Kb,Ub,gb,Db,Va){var yb=k.call(this,Ia,fb,Ma,Hb,Kb,Db)||this;yb.wXb=null;yb.Rkb=null;yb.Ctg=mb;yb.La=Ub;yb.de=gb;Va&&Va.execute(function(qb){yb.n9i(qb)});return yb}function e(Ia,mb,fb,Ma,Hb,Kb,Ub,gb){Ia=k.call(this,Ia,mb,fb,Ma,Hb,Kb)||this;Ia.Pde=Hb;Ia.wug=Ub;
Ia.Mpg=gb;return Ia}function k(Ia,mb,fb,Ma,Hb,Kb){this.tl=!1;this.YLc=new va.a;this.iVa=mb;this.xL=fb;this.Ulg=Ma;this.ib=Hb;this.Bge=Kb}function l(Ia,mb,fb,Ma,Hb){this.cGc=Hb;this.Z8d=fb;this.Y8d=Ma;this.hyg=Ia;this.cqa=mb}function m(Ia,mb){this.La=Ia;this.Vb=mb}function f(Ia){this.x8=null;this.Qpa=0;this.La=Ia;this._initialized=!1}function w(Ia,mb,fb){var Ma=Ea.call(this)||this;Ma.La=Ia;Ma.zv=mb;Ma.Qpa=fb;Ma.ze="RenameDialog";Ma.Wf=n.Wf;return Ma}function n(){}function z(Ia,mb,fb){this.dialog=null;
this.La=Ia;this.zv=mb;this.Qpa=fb}function r(Ia,mb){this.La=Ia;this.cVa=mb}function v(){}function A(Ia,mb,fb,Ma,Hb,Kb,Ub,gb,Db,Va,yb,qb){this.Y8d=Ia;this.La=mb;this.cGc=fb;this.zv=Ma;this.NDa=Hb;this.dyg=Kb;this.pra=Ub;this.She=gb;this.yug=Db;this.cqa=Va;this.ib=yb;this.xug=qb}function B(){this.VCi=this.RCi=this.wah=null}function y(){}function x(Ia,mb,fb,Ma,Hb,Kb,Ub,gb,Db,Va,yb,qb){this._initialized=!1;this._element=null;this.UDa=0;this.eQc=this.IJc=!1;this.La=Ia;this.ZEc=mb;this.Yd=fb;this.oA=Ma;
this.x8=Hb;this.Tee=Kb;this.UVb=Ub;this.TFc=gb;this.K8=Db;this.M8d=Va;this.VVa=yb;this.AKc=qb}function C(Ia,mb){this.UDa=0;this.La=Ia;this.x8=mb}function G(Ia,mb,fb,Ma,Hb){var Kb=H.call(this)||this;Kb.y1=new M(Ia,mb,fb);Kb.pra=Ma;Kb.cqa=Hb;Kb.ze="RenameDisabledDialog";Kb.Rb=0;Kb.mc(1,CommonUIStrings.l_DialogClose);Kb.Wf=E.Wf;Kb.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);Kb.YW("RenameRow");return Kb}function E(){}function I(Ia,mb,fb,Ma,Hb){return U.call(this,Ia,mb,fb,Ma,Hb)||
this}function U(Ia,mb,fb,Ma,Hb){var Kb=O.call(this)||this;Kb.IUd=[];Kb.y1=new M(Ia,mb,fb);Kb.pra=Ma;Kb.cqa=Hb;Kb.ze="RenameDisabledDialog";Kb.Rb=0;Kb.mc(1,CommonUIStrings.l_DialogClose);Kb.ktj();Kb.rdj();return Kb}function M(Ia,mb,fb){this.rRd=this.sRd=this.tRd=!1;this.IRd=!Ia&&!mb;this.JRd=!Ia&&!fb;this.IRd||this.JRd||(this.tRd=!Ia,this.sRd=!mb,this.rRd=!fb)}u=b(0);var T=b(83),F=b(615),K=b(15),J=b(135);Object(u.a)(M,"RenameDisabledDialogInfo",null,[]);var O=J.StandardDialog;Rk(U,O);U.prototype.ktj=
function(){this.y1.IRd?this.ELb(this.pra?this.cqa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.y1.JRd?this.ELb(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.rBg();this.yra(this.IUd)};U.prototype.ELb=function(Ia){Array.add(this.IUd,Ia)};U.prototype.rBg=function(){var Ia=[];this.y1.tRd||Array.add(Ia,CommonUIStrings.l_RenameFileRenameDisabledSignIn);this.y1.sRd||
Array.add(Ia,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.y1.rRd||Array.add(Ia,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<Ia.length&&Array.add(this.IUd,Ia)};Object(u.a)(U,"ReactRenameDisabledDialogBase",J.StandardDialog,[]);Rk(I,U);I.prototype.rdj=function(){this.uCb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)};Object(u.a)(I,"ReactRenameDisabledDialog",U,[]);var N=b(150);Af.Object.defineProperties(E,{Wf:{configurable:!0,enumerable:!0,get:function(){return N.a.Po(E.rk,
CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}});E.rk="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(u.a)(E,"RenameDisabledDialogHtml",null,[]);var H=N.a;Rk(G,H);G.prototype.r9a=function(){if(this.y1.IRd){var Ia=this.pra?this.cqa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;G.ELb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),Ia)}else this.y1.JRd?G.ELb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),
CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.m6h()};G.prototype.m6h=function(){this.y1.tRd&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.y1.sRd&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display="none");this.y1.rRd&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")};G.ELb=function(Ia,mb,fb){Ia.style.display="none";mb.innerText=fb};Object(u.a)(G,"RenameDisabledDialog",N.a,[]);
var Q=b(4),ca=b(30),X=b(107),Z=b(27);C.prototype.initialize=function(Ia){if(!this.La||!this.x8)return!1;this.UDa=Ia;this.Cg();return!0};C.prototype.Cg=function(){this.La.Mb(Z.a.Lha,X.a.frame,Object(T.a)(this,this.Lha,"commitNewDocumentTitle"))};C.prototype.Lha=function(Ia,mb,fb,Ma,Hb){if(1===fb)return this.La.processAction(Z.a.renameFile,1);Ia=ca.a.qq(this.x8.Qm);Hb=(0,Hb.getNewDocumentTitle)();Hb.length>this.UDa&&(Hb=Hb.substr(0,this.UDa));if(32!==this.La.ae(Z.a.renameFile,2,Hb))return this.oX(Ia),
8;this.oX(Hb);return 32};C.prototype.oX=function(Ia){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(Ia))};C.ied=function(){return new C(Q.AFrameworkApplication.ub,Q.AFrameworkApplication.am)};Object(u.a)(C,"ReactRenameUIHandler",null,[684]);var ea=b(94),ka=b(569),Y=b(617),qa=b(13),fa=b(109),ha=b(245),ia=b(89),wa=b(39),Qa=b(25),S=b(84);x.prototype.initialize=function(Ia,mb,fb){if(!(this.La&&this.x8&&this.Tee&&this.UVb&&this.TFc&&mb)||0>=Ia)return!1;this._element=mb;this._element.title=
fb;this._element.setAttribute(ia.a.Hd,ia.a.Hs);this._element.setAttribute("Unselectable","on");this.UDa=Ia;this.ev();return this._initialized=!0};x.prototype.ev=function(){this.ZEc&&(this.ZEc.qa(qa.a.blur,this._element,Object(T.a)(this,this.onBlur,"onBlur")),this.ZEc.qa(qa.a.paste,this._element,Object(T.a)(this,this.onPaste,"onPaste")));this.Yd.qa(qa.a.Lb,this._element,Object(T.a)(this,this.onKeyDown,"onKeyDown"));this.oA.qa(qa.a.pointerDown,this._element,Object(T.a)(this,this.onPointerDown,"onPointerDown"));
this.oA.qa(qa.a.Nd,this._element,Object(T.a)(this,this.pf,"onPointerUp"))};x.prototype.onBlur=function(){this.isActive&&!this.IJc&&(this.M8d||this.TFc(this._element),this.Vze(),this.U4c(!1));return this.IJc=!1};x.prototype.onPaste=function(){K.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0};x.prototype.onKeyDown=function(Ia){return this.isActive?this.JNi(Ia):this.KNi(Ia)};x.prototype.JNi=function(Ia){var mb=!1;switch(Ia.Ca.keyCode){case Sys.UI.Key.enter:this.Vze();
this.U4c(this.VVa||this.AKc);mb=!0;break;case Sys.UI.Key.tab:this.M8d&&this.TFc(this._element);break;case Sys.UI.Key.esc:this.LKd(),this.U4c(this.VVa||this.AKc),mb=!0}return mb};x.prototype.KNi=function(Ia){var mb=!1;switch(Ia.Ca.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.t$f(this.AKc),this.isActive&&this.UVb(this._element),mb=!0}return mb};x.prototype.onPointerDown=function(){this.isActive||(this.t$f(!1),this.isActive&&(this._element.focus(),this.UVb(this._element),this.eQc=!0));return!1};
x.prototype.pf=function(){return this.eQc?(this.UVb(this._element),this.eQc=!1,!0):!1};x.prototype.B6a=function(){return 32===this.La.processAction(Z.a.renameFile,1)};x.prototype.Vze=function(){var Ia=ca.a.qq(this.x8.Qm),mb=this._element.innerText.trim();mb.length>this.UDa&&(mb=mb.substr(0,this.UDa));mb!==Ia&&""!==mb?32!==this.La.ae(Z.a.renameFile,2,mb)?this.LKd():this.oX(mb):this.LKd()};x.prototype.LKd=function(){this.oX(ca.a.qq(this.x8.Qm))};x.prototype.oX=function(Ia){this._initialized&&(this._element.innerText=
Ia,this.Tee())};x.prototype.t$f=function(Ia){this.B6a()?this.isActive||(Ia&&(this.IJc=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(ia.a.Hd,ia.a.CWc),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,ea.CuiHelper.oJe),this.K8&&this.K8.execute(function(mb){mb.qKf(!0)}),Ia&&this._element.focus(),K.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.La.processAction(Z.a.ldb,
2)};x.prototype.U4c=function(Ia){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(ia.a.Hd,ia.a.Hs);Sys.UI.DomElement.removeCssClass(this._element,ea.CuiHelper.oJe);this.K8&&this.K8.execute(function(mb){mb.qKf(!1)});Ia&&(this._element.blur(),this._element.focus())};x.Kz=function(){ka.a.Kz(Q.AFrameworkApplication.isRtl)};x.ied=function(){return new x(Q.AFrameworkApplication.ub,Y.a.instance,fa.KeyInputManager.instance,ha.a.instance,
Q.AFrameworkApplication.am,x.Kz,wa.a.vlj,wa.a.nYg,S.a.instance.Tb("Common.App.Header.HeaderEventSource"),Qa.a.tV,Qa.a.sh,Qa.a.xf)};Af.Object.defineProperties(x.prototype,{isActive:{configurable:!0,enumerable:!0,get:function(){return"true"===this._element.getAttribute("contentEditable")}}});Object(u.a)(x,"RenameUIHandler",null,[684]);Af.Object.defineProperties(y,{instance:{configurable:!0,enumerable:!0,get:function(){return Q.AFrameworkApplication.ta.Pa.isReactSharedHeaderUxEnabled?y.Ma||(y.Ma=C.ied()):
y.Ma||(y.Ma=x.ied())}}});y.Ma=null;Object(u.a)(y,"RenameUIHandlerFactory",null,[]);var da=b(99),xa=b(136);Object(u.a)(B,"RenameMruEntryProperties",null,[]);var ta=b(392),ab=b(170),Na=b(740),Ka;(function(Ia){Ia[Ia.unknown=-1]="unknown";Ia[Ia.success=0]="success";Ia[Ia.renameInvalidFileName=1]="renameInvalidFileName";Ia[Ia.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";Ia[Ia.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";Ia[Ia.permissionDenied=4]="permissionDenied";Ia[Ia.serverCommunicationFailure=
5]="serverCommunicationFailure";Ia[Ia.fileNameTooLong=6]="fileNameTooLong"})(Ka||(Ka={}));Object(u.b)("CommonOperationResult",Ka);A.prototype.Cg=function(){Q.AFrameworkApplication.ta&&Q.AFrameworkApplication.ta.Pa.isReactSharedHeaderUxEnabled||this.pi.Mb(Z.a.Mxb,X.a.frame,Object(T.a)(this,this.Mxb,"initializeRenameUIHandler"));this.pi.Mb(Z.a.ldb,X.a.frame,Object(T.a)(this,this.ldb,"showRenameDisabledDialog"));this.pi.Mb(Z.a.renameFile,X.a.frame,Object(T.a)(this,this.renameFile,"renameFile"));this.pi.Ie(Z.a.fileNameUpdate,
X.a.frame,Object(T.a)(this,this.d7i,"refreshFilename"),64);this.pi.Ie(Z.a.llc,X.a.frame,Object(T.a)(this,this.llc,"moveToFolderCompleteByHost"),64);this.pi.Mb(Z.a.SNa,X.a.frame,Object(T.a)(this,this.SNa,"moveToFolder"));Q.AFrameworkApplication.ta&&(Q.AFrameworkApplication.fa.ra("PostMessageEmbedded")||Q.AFrameworkApplication.fa.ra("IsJsApi"))&&Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",!0)&&Q.AFrameworkApplication.eV().execute(function(Ia){Ia.Wn(ab.a.dqf);
Ia.Ml(ab.a.dqf,A.Z5i);Ia.Wn(ab.a.x$c);Ia.Ml(ab.a.x$c,A.X5i)})};A.prototype.B6a=function(){return 0===this.xug.L0e()?32:8};A.prototype.uUj=function(){return this.Uy?this.pra?this.Uy.oIe:this.Uy.tub:!0};A.prototype.Mxb=function(){return y.instance.initialize(Q.AFrameworkApplication.j9b,Q.AFrameworkApplication.m1a,Q.AFrameworkApplication.fJd||CommonUIStrings.l_RenameFileTooltip)?32:8};A.prototype.ldb=function(){var Ia=this.uUj(),mb=this.dyg();K.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.NDa,mb,Ia,this.pra);Q.AFrameworkApplication.ta&&Q.AFrameworkApplication.ta.Pa.Wu&&Q.AFrameworkApplication.fa.ra("ReactRenameDisabledDialogIsEnabled")?new I(this.NDa,!mb,!Ia,this.pra,this.cqa()):new G(this.NDa,!mb,!Ia,this.pra,this.cqa());return 32};A.prototype.renameFile=function(Ia,mb,fb,Ma,Hb){if(1===fb)return this.B6a();if(!Q.AFrameworkApplication.I8b)return 8;if(8===this.B6a())return this.pi.processAction(Z.a.ldb,2),8;K.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");Q.AFrameworkApplication.I8b(Hb,
Object(T.a)(this,this.DEb,"onRenameFileSuccess"),Object(T.a)(this,this.tQi,"onRenameFileFailure"));return 32};A.prototype.DEb=function(Ia,mb){Ia?0!==Ia.OperationResult?this.C4e(Ia.OperationResult):(this.Nmj(mb,Ia.NewName),this.XPj(Ia,Object(T.a)(Q.AFrameworkApplication.ta.Pa,Q.AFrameworkApplication.ta.Pa.Qcg,"updateOpenInClientDocumentUrl")),Q.AFrameworkApplication.fa.ra("DocumentNameInJewelInfoMenuIsEnabled")&&Q.AFrameworkApplication.ta.updateCommandUI(),this.yug.ybg()):this.C4e(5)};A.prototype.Nmj=
function(Ia,mb){var fb={};fb[ta.a.dzh]=mb;Ia.xj(ab.a.x$c,fb)};A.prototype.XPj=function(Ia,mb){this.kQj(Ia);Q.AFrameworkApplication.l6b=Ia.DirectInvokeDavUrl;mb=mb(Ia.EditDocInClientUrl);var fb=new B;fb.VCi=this.zv.Qm;fb.wah=mb;fb.RCi=Ia.EditDocInClientUrl;this.pi.ae(Z.a.renameMostRecentlyUsedFileEntry,2,fb)};A.prototype.C4e=function(Ia){switch(Ia){case 1:Ia=new J.StandardDialog,Ia.Rb=0,Ia.dX(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.$Sf()}};A.prototype.kQj=
function(Ia){this.zv.Qm=A.MJg(this.zv.Qm,Ia.NewName);Ia.BreadcrumbFolderName&&(this.zv.breadcrumbFolderName=Ia.BreadcrumbFolderName);Ia.BreadcrumbFolderUrl&&(this.zv.breadcrumbFolderUrl=Ia.BreadcrumbFolderUrl);this.She(Ia.NewName)};A.prototype.tQi=function(Ia){var mb=new J.StandardDialog;mb.Rb=0;switch(Ia){case 1:K.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");mb.DAa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:K.ULS.sendTraceTag(38114564,
203,50,"OnRenameFileFailure: FileNameTooLong");mb.DAa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,null);break;default:var fb={};K.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",(fb.Result=Ia,fb));mb.DAa(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}Q.AFrameworkApplication.eV().execute(function(Ma){var Hb={};Ma.xj(ab.a.czh,(Hb.FailureMessage=Ka[Ia],Hb))});this.$Sf()};A.prototype.d7i=function(Ia,mb,
fb){if(1===fb)return this.B6a();if(!Q.AFrameworkApplication.QIa)return 8;Q.AFrameworkApplication.QIa(Object(T.a)(this,this.Tnc,"onRefreshFilenameSuccess"),Object(T.a)(this,this.Snc,"onRefreshFilenameFailure"),!1);return 32};A.prototype.SNa=function(Ia,mb,fb,Ma,Hb){if(1===fb)return Q.AFrameworkApplication.fa.ra("UiHostSupportsMoveToFolder")?32:8;if(2===fb){var Kb={};Ia=Q.AFrameworkApplication.Gka;mb=Q.AFrameworkApplication.fa.ra("UiHostSupportsDocRebootFeatures");Ia=(!Ia||Ia&&mb)&&Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",
!1);Kb[ta.a.qGj]=Ia;Hb&&Hb.MoveButtonClickedTime&&(Kb[ta.a.lBi]=Hb.MoveButtonClickedTime.getTime());Q.AFrameworkApplication.eV().execute(function(Ub){Ub.xj(ab.a.SNa,Kb)});if(Hb&&Hb.MoveButtonClickedTime){if(Ia=xa.a.Fr())Hb=(new Date).getTime()-Hb.MoveButtonClickedTime.getTime(),Ia.set("MovePostDuration",Hb.toString());da.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",Ia)}return 32}return 8};A.prototype.llc=function(Ia,mb,fb,Ma,Hb){if(1===fb)return Q.AFrameworkApplication.fa.ra("UiHostSupportsMoveToFolder")?
this.B6a():8;if(2===fb){if(!Q.AFrameworkApplication.LWf)return da.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),8;if(!Hb)return da.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(Hb[ta.a.egi])if(Hb[ta.a.Kdg])if(Ia=Hb[ta.a.Kdg].toLowerCase(),mb=Q.AFrameworkApplication.fa.ra("UiHostSupportsDocRebootFeatures"),fb=Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",
!1),mb&&Q.AFrameworkApplication.Gka&&fb){var Kb={};Kb[ta.a.DPa]="1";Kb[ta.a.documentUrl]=Ia;Kb[ta.a.reason]=Na.a.saveAs;da.Health.instance.recordKpiSuccess("MoveToFolder",null);Q.AFrameworkApplication.eV().execute(function(Ub){Ub.xj(ab.a.Fta,Kb)})}else if(!Q.AFrameworkApplication.Gka&&fb)da.Health.instance.recordKpiSuccess("MoveToFolder",null),wa.a.Ze(Ia,wa.a.qX(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return da.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",
!1,!1,null),8;else da.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else Q.AFrameworkApplication.QIa(Object(T.a)(this,this.Tnc,"onRefreshFilenameSuccess"),Object(T.a)(this,this.Snc,"onRefreshFilenameFailure"),!1),Q.AFrameworkApplication.LWf(),da.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32};A.prototype.pyj=function(Ia,mb){return Ia&&mb?Ia!==this.zv.breadcrumbFolderName||mb!==this.zv.breadcrumbFolderUrl:!1};A.prototype.Tnc=function(Ia,mb){Ia&&(Ia.NewName!==
ca.a.qq(this.zv.Qm)||this.pyj(Ia.BreadcrumbFolderName,Ia.BreadcrumbFolderUrl))&&this.DEb(Ia,mb)};A.prototype.Snc=function(){};A.prototype.$Sf=function(){this.She(ca.a.qq(this.zv.Qm))};A.uub=function(){return new A(Q.AFrameworkApplication.C6a,new F.a(function(){return Q.AFrameworkApplication.ub}),new F.a(function(){return Q.AFrameworkApplication.Uy}),Q.AFrameworkApplication.am,Q.AFrameworkApplication.limitedEdit,function(){return Q.AFrameworkApplication.userCanRename},Q.AFrameworkApplication.Psc,Object(T.a)(y.instance,
y.instance.oX,"updateTitle"),S.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),function(){return Q.AFrameworkApplication.isReadOnlyRecommended},Q.AFrameworkApplication.fa,S.a.instance.resolve("Common.IRenameProps"))};A.MJg=function(Ia,mb){Ia=ca.a.b4(Ia);return mb+Ia};A.Z5i=function(Ia){var mb=Ia.Values[ta.a.Hji];K.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",mb);mb?Q.AFrameworkApplication.ub.ae(Z.a.llc,2,Ia.Values):da.Health.instance.recordKpiFailure("MoveToFolder",
"MoveToFolder Server Failure",!1,!1,null)};A.X5i=function(Ia){Q.AFrameworkApplication.ub.ae(Z.a.renameFile,2,Ia.Values.NewName)};Af.Object.defineProperties(A.prototype,{pi:{configurable:!0,enumerable:!0,get:function(){return this.La.value}},Uy:{configurable:!0,enumerable:!0,get:function(){return this.cGc.value}}});Af.Object.defineProperties(A,{instance:{configurable:!0,enumerable:!0,get:function(){return A.Ma||(A.Ma=A.uub())}}});A.Ma=null;Object(u.a)(A,"RenameActor",null,[]);b(632);Object(u.a)(function(){},
"ActivityEventName",null,[]);v.compatMode="CompatMode";v.noSelection="NoSelection";Object(u.a)(v,"ActivityEventReason",null,[]);var la=b(739);r.prototype.Cg=function(){this.La.Mb(Z.a.v3f,X.a.frame,Object(T.a)(this,this.XAj,"showRenameDialogAction"))};r.prototype.XAj=function(Ia,mb,fb){Ia=32;if(1===fb)return la.SessionStatusManager.instance.wwb||Q.AFrameworkApplication.X4?8:32;2===fb&&(32!==this.La.processAction(Z.a.renameFile,1)?(this.La.processAction(Z.a.ldb,2),Ia=8):32===this.La.processAction(Z.a.DLb,
1)?this.La.processAction(Z.a.DLb,2):this.cVa.value.create().lxc());return Ia};Object(u.a)(r,"RenameDialogActor",null,[677]);z.prototype.rVh=function(){var Ia={},mb={};Ia.nameInputProps=(mb.type="AppInputProps",mb.id=z.l1a,mb.label=CommonUIStrings.l_RenameDialogLabel,mb.value=ca.a.qq(this.zv.Qm),mb.maxLength=this.Qpa,mb);return Ia};z.prototype.lxc=function(){var Ia=this.rVh(),mb={};Ia=(mb.id="RenameDialog",mb.bodyControls=Ia,mb);this.dialog=new N.a(!1,!1,!0);this.dialog.Rb=1;this.dialog.ze="RenameDialog";
this.dialog.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(T.a)(this,this.dJd,"renameDialogHandler"),Ia)};z.prototype.dJd=function(Ia,mb){mb&&1===Ia&&mb[z.l1a]&&(Ia=ca.a.qq(this.zv.Qm),mb=(mb[z.l1a]||"").trim(),mb!==Ia&&""!==mb&&this.La.ae(Z.a.renameFile,2,mb))};z.l1a="txtDocumentName";Object(u.a)(z,"ReactRenameDialog",null,[686]);Af.Object.defineProperties(n,{Wf:{configurable:!0,enumerable:!0,get:function(){return N.a.Po(n.rk,CommonUIStrings.l_RenameDialogLabel)}}});n.rk="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(u.a)(n,"RenameDialogHtml",null,[]);var Ea=N.a;Rk(w,Ea);w.prototype.lxc=function(){var Ia={};Ia=(Ia.txtDocumentName=ca.a.qq(this.zv.Qm),Ia);this.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(T.a)(this,this.dJd,"renameDialogHandler"),Ia);Ia=document.getElementById(w.l1a);0<this.Qpa&&(Ia.maxLength=this.Qpa);Ia.focus()};w.prototype.dJd=function(Ia,mb){1===Ia&&(Ia=ca.a.qq(this.zv.Qm),mb=(mb[w.l1a]||"").trim(),mb!==Ia&&""!==mb&&this.La.ae(Z.a.renameFile,2,mb))};w.l1a="txtDocumentName";
Object(u.a)(w,"RenameDialog",N.a,[686]);f.prototype.initialize=function(Ia,mb){this.x8=Ia;this.Qpa=mb;this._initialized=!0};f.prototype.create=function(){return this._initialized?Q.AFrameworkApplication.ta&&Q.AFrameworkApplication.ta.Pa.Wu&&Q.AFrameworkApplication.fa.ra("ReactRenameDialogIsEnabled")?new z(this.La,this.x8,this.Qpa):new w(this.La,this.x8,this.Qpa):null};Object(u.a)(f,"RenameDialogFactory",null,[676]);var ra=b(274),na=b(187),ba=b(167),sa=b(108),ya=b(104);m.prototype.Cg=function(){this.La.Mb(Z.a.DLb,
X.a.frame,Object(T.a)(this,this.YAj,"showRenameFlyoutAction"))};m.prototype.kUg=function(){return ba.d("setDocumentTitleFlyoutOpened")&&Q.AFrameworkApplication.ta.Pa.isReactSharedHeaderUxEnabled};m.prototype.YAj=function(Ia,mb,fb){if(1===fb)return this.kUg()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32};m.prototype.BCg=function(){var Ia=this;m.ymi&&Q.AFrameworkApplication.q6a&&ya.a.instance.Eg(new sa.a(5,1,5E3,function(){32===Ia.La.processAction(Z.a.DLb,
1)&&Ia.Vb&&Ia.Vb.ki.name===ra.AFrame.U$&&(na.a("RenameFloatieShownOnNewDocumentLoad",!0),Ia.La.processAction(Z.a.DLb,2))}))};Af.Object.defineProperties(m,{ymi:{configurable:!0,enumerable:!0,get:function(){m.vTb&&null!=m.vTb||(Q.AFrameworkApplication.Yjc("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),m.vTb=Q.AFrameworkApplication.fa?Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return m.vTb}}});
m.vTb=null;Object(u.a)(m,"RenameFlyoutActor",null,[675]);l.prototype.L0e=function(){if(!this.Y8d())return 5;if(this.cqa())return 1;if(this.Uy){if(this.Z8d&&!this.Uy.oIe)return 3;if(!this.Z8d&&!this.Uy.tub)return 4}return this.hyg()?0:2};Af.Object.defineProperties(l.prototype,{Uy:{configurable:!0,enumerable:!0,get:function(){return this.cGc.value}}});Object(u.a)(l,"RenameProps",null,[674]);b(202);var va=b(100);k.prototype.enable=function(){this.tl||(this.ybg(),this.eTd(),this.tl=!0)};k.prototype.generateKey=
function(Ia,mb,fb){return String.format("{0}/{1}/{2}",fb,Ia,mb)};k.prototype.BQh=function(){var Ia=ca.a.qq(this.iVa().Qm);return this.generateKey(this.iVa().breadcrumbFolderName,this.iVa().breadcrumbFolderUrl,Ia)};k.prototype.CQh=function(Ia,mb,fb){return Ia&&mb?this.generateKey(Ia,mb,fb):fb};k.prototype.Veh=function(Ia,mb,fb){return Ia&&Ia!==this.iVa().breadcrumbFolderName||mb&&mb!==this.iVa().breadcrumbFolderUrl?!0:fb!==ca.a.qq(this.iVa().Qm)};k.prototype.ybg=function(){var Ia=this.BQh();this.YLc.ia(Ia,
new Date)};k.prototype.KCd=function(Ia){this.Xwj(Ia)&&this.dje(Ia)};k.prototype.Xwj=function(Ia){var mb=this.Ulg();return mb?this.Bge&&this.Bge.azb||!mb.tcf||!Q.AFrameworkApplication.QIa?(this.X5f(Ia),this.tl=!1):!0:!1};k.prototype.wCf=function(Ia,mb,fb,Ma){var Hb=this.Veh(Ia,mb,fb);Ia=this.CQh(Ia,mb,fb);mb=this.YLc.zc(Ia).returnValue;Hb&&!mb&&(this.D4e(Ma),K.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.ytd));Hb||this.YLc.ia(Ia,this.xL())};Object(u.a)(k,"ARenamedFileChecker",
null,[661]);Rk(e,k);e.prototype.eTd=function(){this.Pde.PUc(Object(T.a)(this,this.o5e,"handleSettingsRefresh"))};e.prototype.o5e=function(Ia,mb){mb&&mb.YCb&&mb.BFi&&(mb.L6a("BreadcrumbDocName")||mb.L6a("BreadcrumbFolderName")||mb.L6a("BreadcrumbFolderUrl")||mb.L6a("DirectInvokeDAVUrl")||mb.L6a("EditDocInClientUrl"))&&(K.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.ytd),this.KCd(mb))};e.prototype.X5f=function(){this.Pde.Zbj(Object(T.a)(this,this.o5e,"handleSettingsRefresh"))};
e.prototype.dje=function(Ia){if(Ia&&Ia.YCb){var mb=Ia.YCb;this.wCf(mb.Wa("BreadcrumbFolderName"),mb.Wa("BreadcrumbFolderUrl"),mb.Wa("BreadcrumbDocName"),Ia)}};e.prototype.D4e=function(Ia){var mb=this,fb={OperationResult:0,classId:1};Ia=Ia.YCb;fb.BreadcrumbFolderName=Ia.Wa("BreadcrumbFolderName");fb.BreadcrumbFolderUrl=Ia.Wa("BreadcrumbFolderUrl");fb.DirectInvokeDavUrl=Ia.Wa("DirectInvokeDAVUrl");fb.EditDocInClientUrl=Ia.Wa("EditDocInClientUrl");Ia=Ia.Wa("BreadcrumbDocName");fb.NewName=Q.AFrameworkApplication.Eta?
Ia:ca.a.qq(Ia);this.Mpg.execute(function(Ma){mb.wdi(fb,Ma)})};e.prototype.wdi=function(Ia,mb){this.wug().DEb(Ia,mb)};Af.Object.defineProperties(e.prototype,{ytd:{configurable:!0,enumerable:!0,get:function(){return"RenamedFileCheckerUsingSettingsRefresh"}}});Object(u.a)(e,"RenamedFileCheckerUsingSettingsRefresh",k,[]);Rk(d,k);d.prototype.n9i=function(Ia){this.wXb=Ia;this.wXb.gGg(Object(T.a)(this,this.Rhd,"handleVisibilityChange"))};d.prototype.Rhd=function(Ia,mb){!this.tl||0!==mb.newState&&1!==mb.newState||
this.Rkb||(this.eTd(),this.KCd(this.Rkb))};d.prototype.eTd=function(){this.Rkb=new sa.a(3,2,this.Ctg(),Object(T.a)(this,this.KCd,"performRenameFileCheckTick"),89);this.de.Eg(this.Rkb)};d.prototype.X5f=function(Ia){this.de.Ip(Ia)};d.prototype.dje=function(Ia){this.wXb&&2===this.wXb.SZj?this.n$i(Ia):Q.AFrameworkApplication.QIa(Object(T.a)(this,this.Tnc,"onRefreshFilenameSuccess"),Object(T.a)(this,this.Snc,"onRefreshFilenameFailure"),!0)};d.prototype.n$i=function(Ia){this.de.Ip(Ia);this.Rkb=null};d.prototype.Tnc=
function(Ia){Ia&&this.wCf(Ia.BreadcrumbFolderName,Ia.BreadcrumbFolderUrl,Ia.NewName,null)};d.prototype.D4e=function(){this.La.processAction(Z.a.fileNameUpdate,2)};d.prototype.Snc=function(){};Af.Object.defineProperties(d.prototype,{ytd:{configurable:!0,enumerable:!0,get:function(){return"RenamedFileCheckerUsingTask"}}});Object(u.a)(d,"RenamedFileCheckerUsingTask",k,[]);var W=b(96);c.prototype.Sh=function(Ia){var mb=this;this.fb=Ia;this.ib=Q.AFrameworkApplication.fa;this.fb.register(r,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Cc(function(){return new r(Q.AFrameworkApplication.ub,
mb.fb.FKd("Common.App.Rename.IRenameDialogFactory"))}).tc();this.fb.register(f,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Cc(function(){return new f(Q.AFrameworkApplication.ub)}).tc();this.fb.register(661,"Common.App.Rename.IRenamedFileChecker").Cc(function(){return mb.g9g()}).tc();this.fb.register(m,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Cc(function(){return new m(Q.AFrameworkApplication.ub,W.FocusManager.instance())}).tc()};
c.prototype.g9g=function(){var Ia=this;if(this.ib.ra("RenamedFileCheckerWithSettingsRefreshIsEnabled")){var mb=this.fb.nh("Common.IRefreshableAppSettings");if(mb&&mb.npd)return new e(function(){return mb.kd("RenamedFileCheckerMaxCachedAgeInMs",48E4)},function(){return Q.AFrameworkApplication.am},function(){return new Date},function(){return Q.AFrameworkApplication.Uy},mb,this.fb.nh("Common.ISessionStatus"),function(){return A.instance},this.fb.Tb("Postmessage.IHostPostmessenger"))}return new d(function(){return Ia.ib.kd("RenamedFileCheckerMaxCachedAgeInMs",
48E4)},function(){return Ia.ib.kd("RenamedFileCheckerPingIntervalInMs",12E4)},function(){return Q.AFrameworkApplication.am},function(){return new Date},function(){return Q.AFrameworkApplication.Uy},Q.AFrameworkApplication.fa,Q.AFrameworkApplication.ub,Q.AFrameworkApplication.Bi,this.fb.nh("Common.ISessionStatus"),this.fb.Tb("Common.App.VisibilityManagement.IVisibilityManager"))};c.prototype.init=function(){this.ib.Tu(Object(T.a)(this,this.sB,"onFullAppSettingsReady"))};c.prototype.sB=function(){var Ia=
Q.AFrameworkApplication.ta.Pa.isReactSharedHeaderUxEnabled;Q.AFrameworkApplication.C6a()&&y.instance.initialize(Q.AFrameworkApplication.j9b,Ia?null:Q.AFrameworkApplication.m1a,Ia?null:Q.AFrameworkApplication.fJd||CommonUIStrings.l_RenameFileTooltip)&&(this.fb.register(l,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Cc(function(){return new l(function(){return Q.AFrameworkApplication.userCanRename},function(){return Q.AFrameworkApplication.isReadOnlyRecommended},Q.AFrameworkApplication.Psc,
Q.AFrameworkApplication.C6a,new F.a(function(){return Q.AFrameworkApplication.Uy}))}).tc(),A.instance.Cg(),this.ib.ra("RenameDialogIsEnabled")&&(this.fb.resolve("Common.App.Rename.RenameDialogFactory").initialize(Q.AFrameworkApplication.am,Q.AFrameworkApplication.j9b),this.fb.resolve("Common.App.Rename.IRenameDialogActor").Cg()),this.fb.resolve("Common.App.Rename.IRenameFlyoutActor").Cg(),Q.AFrameworkApplication.Psc&&this.fb.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.fb.resolve("Common.App.Rename.IRenameFlyoutActor").BCg())};
c.prototype.dispose=function(){};Af.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.RenameFile"}}});Object(u.a)(c,"PackageManager",null,[3,4]);var La=b(257);b.d(D,"a",function(){return a})},1650:function(u,D,b){function a(fa){return qa.call(this,fa)||this}function c(fa){this.pi=fa}function d(fa){var ha=Y.call(this)||this;ha.renameFileManager=null;ha.RY=null;ha.$=fa;ha.Eb();return ha}function e(fa,ha){var ia=ea.call(this)||this;ia.a5c=null;
ia.qQf=null;ia.eJd=null;ia.Yca=null;ia.Nja=function(){var wa=ia.$.ea.lo;if(wa&&wa.WorkbookFileName){var Qa=U.a.qq(wa.WorkbookFileName),S=!!Q.a.compare(ia.$.workbookContext.WorkbookFileName,wa.WorkbookFileName,!1),da=H.EwaSettings.ma(544)&&!!wa.BreadcrumbFolderUrl&&!!Q.a.compare(ia.$.workbookContext.FullDocumentInfo.BreadcrumbFolderUrl,wa.BreadcrumbFolderUrl,!1);if(S||da)ia.Yca={},ia.Yca.NewFileName=Qa,ia.Yca.EditDocInClientUrl=wa.EditDocInClientUrl,ia.Yca.DirectInvokeDAVUrl=wa.DirectInvokeDAVUrl,
ia.Yca.DownloadACopyUrl=wa.DownloadACopyUrl,H.EwaSettings.ma(544)&&wa.BreadcrumbFolderUrl&&(ia.Yca.BreadcrumbFolderName=wa.BreadcrumbFolderName,ia.Yca.BreadcrumbFolderUrl=wa.BreadcrumbFolderUrl),wa=r.AFrameworkApplication.ub.ae(B.a.fileNameUpdate,2,Qa),ia.Yca=null,I.ULS.shipAssertTag(537154064,0,32===wa,"RenameFileManager.HandleWorkbookMetadataChanged - Workbook Name Update Failed")}};ia.NJi=function(wa,Qa,S){ia.qQf=Qa;ia.eJd=S;Qa={};ia.$.Ka.Kb(new O.a(1897077126,F.a.Cb,2,3,null),(Qa.newFileName=
wa,Qa))};ia.MJi=function(wa){ia.Yca&&wa(ia.M0e(ia.Yca),ia.Qr)};ia.DEb=function(wa){N.a(wa)||!wa.Result?(wa=e.hGh(wa),Z.a(ia.$).fd.hJ([-414480287,650565124,-782844485,1223808266,-62451516,1636785843]),ia.eJd(wa)):ia.qQf(ia.M0e(wa.Result),ia.Qr)};ia.sQi=function(){ia.eJd(5)};ia.$=fa;ia.Qr=ha;ia.$.ea.Bu(ia.Nja);return ia}function k(fa){this.$=fa}function l(fa){return x.call(this,fa)||this}function m(fa){this.renameFileManager=fa}b.r(D);u=b(1349);var f=b(11);D=b(0);var w=b(905),n=b(51),z=b(37),r=b(4),
v=b(59),A=b(186),B=b(27),y=b(58);m.prototype.executeCommand=function(fa,ha,ia){switch(ha.command){case B.a.Lha:return v.a.rg.isReactSharedHeaderUxEnabled?2!==r.AFrameworkApplication.ub.ae(B.a.Lha,2,ia)?y.Task.Ua(!0):A.a(ha.command):A.a(ha.command);case 1897077126:return this.renameFileManager.renameFile(ia,ha),y.Task.Ua(!0);default:return A.a(ha.command)}};m.prototype.Ac=function(fa,ha,ia,wa){switch(ha.command){case B.a.Lha:return v.a.rg.isReactSharedHeaderUxEnabled;case 1897077126:return!!wa&&2===
wa.tx}return!1};m.prototype.Qc=function(){return!1};m.prototype.Lc=function(){return!1};m.prototype.dispose=function(){this.renameFileManager=null};Object(D.a)(m,"RenameFileCommandHandler",null,[403,10]);var x=w.a;Rk(l,x);l.prototype.zd=function(){var fa=this,ha=n.GetServiceTaskFactory.create(this.$.da,119,this.la,this.hb);z.TaskExtensions.Ba(ha,function(){fa.jd([new m(ha.result)])},this.la,3)};l.ka=function(fa){w.a.Qd(118,new l(fa))};Object(D.a)(l,"RenameFileCommandHandlerFactory",w.a,[]);var C=
b(90),G=b(232),E=b(223),I=b(15),U=b(30),M=b(79),T=b(398),F=b(76),K=b(389),J=b(177),O=b(92),N=b(296),H=b(1),Q=b(22),ca=b(295);Af.Object.defineProperties(k.prototype,{tcf:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.FileCoauthorable}},azb:{configurable:!0,enumerable:!0,get:function(){return!1}},tub:{configurable:!0,enumerable:!0,get:function(){return this.$.ea.amIAlone}},oIe:{configurable:!0,enumerable:!0,get:function(){if(this.tub)return!0;for(var fa=ak(this.$.ea.Dm),
ha=fa.next();!ha.done;ha=fa.next())if(!ha.value.SupportsRename)return!1;return!0}}});Object(D.a)(k,"EwaCoauthManager",null,[217]);var X=b(61),Z=b(67),ea=M.a;Rk(e,ea);e.prototype.initialize=function(){r.AFrameworkApplication.I8b=this.NJi;r.AFrameworkApplication.QIa=this.MJi;this.a5c=r.AFrameworkApplication.Uy;r.AFrameworkApplication.Uy=new k(this.$)};e.prototype.dispose=function(){r.AFrameworkApplication.I8b=null;r.AFrameworkApplication.QIa=null;this.$.ea.Gw(this.Nja);r.AFrameworkApplication.Uy=this.a5c;
this.$=this.a5c=null;ea.prototype.dispose.call(this)};e.prototype.renameFile=function(fa,ha){var ia=this,wa=fa.newFileName;if(wa){var Qa=this.$.oa.xa.Pb();K.a(this.$.userOperationManager,function(S,da,xa){var ta=ia.$.oa.xa;S=ca.b(S,ia.DEb);da=ca.a(da,ia.sQi);var ab=ta.Na(9,Qa);ab.newFileName=wa;return X.g(ta,"RenameFile",ab,S,da,xa,null,0)},function(S){return new J.a(134,0,S)},ha)}};e.prototype.Pfi=function(){return 32===r.AFrameworkApplication.ub.processAction(B.a.Lha,1)};e.prototype.M0e=function(fa){var ha=
this.$.workbookContext;r.AFrameworkApplication.w3=fa.DownloadACopyUrl;var ia=H.EwaSettings.ma(544)&&!!fa.BreadcrumbFolderUrl;ia&&(r.AFrameworkApplication.am.breadcrumbFolderName=fa.BreadcrumbFolderName,r.AFrameworkApplication.am.breadcrumbFolderUrl=fa.BreadcrumbFolderUrl,ha.FullDocumentInfo.BreadcrumbFolderUrl=fa.BreadcrumbFolderUrl,ha.FullDocumentInfo.BreadcrumbFolderName=fa.BreadcrumbFolderName);ha.FullDocumentInfo.BreadcrumbDocName=fa.NewFileName;T.d(ha,fa.NewFileName);ha={};ha.NewName=fa.NewFileName;
ha.DirectInvokeDavUrl=fa.DirectInvokeDAVUrl;ha.EditDocInClientUrl=fa.EditDocInClientUrl;ia&&(ha.BreadcrumbFolderName=fa.BreadcrumbFolderName,ha.BreadcrumbFolderUrl=fa.BreadcrumbFolderUrl);ha.OperationResult=0;return ha};e.hGh=function(fa){switch(fa.Errors[0].MessageId){case -414480287:fa=2;break;case 650565124:fa=1;break;case 1636785843:fa=6;break;case -782844485:fa=4;break;default:fa=5}return fa};Object(D.a)(e,"RenameFileManager",M.a,[657,10]);var ka=b(50),Y=G.a;Rk(d,Y);d.prototype.create=function(){var fa=
this;if(!this.RY){var ha=E.a.BHa(ka.b(),this.la,"Task","IRenameFileManager");this.RY=ha.task;var ia=n.GetServiceTaskFactory.create(this.$.da,137,this.la,this.hb),wa=n.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb);z.TaskExtensions.Ba(z.TaskExtensions.Wd([wa,ia],this.la),function(){var Qa=new e(fa.$,ia.result);fa.$.da.Ga(120,Qa);ha.setResult(Qa)},this.la,3)}this.RY.continueWith(function(Qa){fa.pb(Qa.result)})};d.prototype.dispose=function(){C.a.Ia(this.renameFileManager);this.$=this.renameFileManager=
null;Y.prototype.dispose.call(this)};d.ka=function(fa){fa.da.Ga(119,new d(fa))};Object(D.a)(d,"RenameFileManagerServiceFactory",G.a,[]);c.prototype.Lc=function(){return!1};c.prototype.executeCommand=function(fa,ha,ia){return 2!==this.pi.ae(B.a.v3f,2,ia)?y.Task.Ua(!0):A.a(ha.command)};c.prototype.Ac=function(fa,ha){return 1204860550===ha.command};c.prototype.Qc=function(){return!1};Object(D.a)(c,"RenameFileDialogCommandHandler",null,[403]);var qa=w.a;Rk(a,qa);a.prototype.zd=function(){var fa=this;
z.TaskExtensions.Ba(n.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb),function(){fa.jd([new c(r.AFrameworkApplication.ub)])},this.la,3)};a.ka=function(fa){w.a.Qd(131,new a(fa))};Object(D.a)(a,"RenameFileDialogCommandHandlerFactory",w.a,[]);Type.registerNamespace("_Ewa");Object(u.a)();(function(){f.a.Fa(function(fa){d.ka(fa);l.ka(fa)})})();f.a.Fa(a.ka)}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.rn.js.map/dc5dddbeb6d8262d6740c140a8c81192/EwaDS.rn.js.map