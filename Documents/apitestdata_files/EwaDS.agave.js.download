/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <http://feross.org>
 @license  MIT
 ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1020:function(u,D,b){function a(d,e,k){this.$Pb=d;this.Qjg=e;this.Rjg=k}function c(){this.title=this.id=this.tabs=null}u=b(0);Object(u.a)(c,"AddInDataTransferObject",null,[]);b.d(D,"a",function(){return a});a.kub=function(d){return(d=d.XV)?Object.assign(new c,{tabs:d.Ds.toArray(),id:d.jBg,title:d.kBg}):null};Af.Object.defineProperties(a.prototype,{Ds:{configurable:!0,enumerable:!0,get:function(){return this.$Pb}},jBg:{configurable:!0,
enumerable:!0,get:function(){return this.Qjg}},kBg:{configurable:!0,enumerable:!0,get:function(){return this.Rjg}}});Object(u.a)(a,"OneLineRibbonExtensibility",null,[])},1057:function(u,D,b){function a(I,U,M){M=void 0===M?null:M;this.hEc=new n.a;var T=new f.a;U&&T.add(U.xxi);M&&T.addRange(M);this.Mm=I;this.Hxg=T}function c(I,U,M,T){this.fT=new f.a;this.oG=new f.a;this.kpa=null;this.Mkb=new f.a;this.a$d=Promise.resolve(null);this.bge=!1;this.AVb=U;this.Emg=I;this.Gge=M;this.Vjg=T}function d(){var I=
e.call(this)||this;I.errorCode=0;return I}function e(){this.FQb=new f.a;this.N9=this.L9=!1;this.foa=this.authChallenge=null;this.startTime=this.retryCount=0;this.Tne=null}function k(){this.token=null;this.expiresOn=0;this.aha=this.authChallenge=null}function l(){this.accessToken=null}function m(){this.startTime=0;this.callback=null}b.r(D);u=b(0);var f=b(202),w=b(15),n=b(100);Object(u.a)(m,"SSOCallbackInfo",null,[]);Object(u.a)(l,"AccessTokenInformation",null,[252]);var z=b(1173);Object(u.a)(k,"CachedTokenInfo",
null,[]);Af.Object.defineProperties(e.prototype,{callbacks:{configurable:!0,enumerable:!0,get:function(){return this.FQb}}});Object(u.a)(e,"SSORequestInfo",null,[]);Rk(d,e);Object(u.a)(d,"SSOFailedRequestInfo",e,[]);var r=b(4);c.prototype.pxj=function(I){if(this.kpa&&this.kpa.authChallenge===I.authChallenge){if(Date.now()/1E3+c.Wyi>this.kpa.expiresOn)return this.kpa=null,!1;I=new z.a;I.token=this.kpa.token;I.expiresOn=this.kpa.expiresOn;I.aha=this.kpa.aha;I.PSa=!0;I.Wvb=0;this.nwb(I);return!0}return!1};
c.prototype.Xvj=function(I){for(var U=0;U<this.oG.count;U++)if(this.oG.na(U).authChallenge===I.authChallenge&&this.oG.na(U).foa===I.foa){var M=void 0;(M=this.oG.na(U)).retryCount=M.retryCount+1;I.retryCount=this.oG.na(U).retryCount;if(this.oG.na(U).retryCount<c.tzi||!this.oG.na(U).L9&&I.L9||!this.oG.na(U).N9&&I.N9){if(!this.oG.na(U).L9&&I.L9||!this.oG.na(U).N9&&I.N9)I.retryCount=0;this.oG.removeAt(U);break}I=new z.a;I.errorCode=this.oG.na(U).errorCode;this.nwb(I);return!0}return!1};c.prototype.aDg=
function(I,U){for(var M=0;M<this.oG.count;M++)if(this.oG.na(M).foa===I.foa&&this.oG.na(M).authChallenge===I.authChallenge)return;this.oG.add(Object.assign(new d,{L9:I.L9,N9:I.N9,authChallenge:I.authChallenge,foa:I.foa,errorCode:U,retryCount:I.retryCount}))};c.prototype.Qbd=function(I,U,M,T,F,K){var J=this,O=b(1057).AppsForOfficeSingleSignOnManager;""===M&&(M=null);if(this.bge)O.z5(K,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{for(var N=null,H=ak(this.fT),Q=H.next();!Q.done;Q=
H.next())if(Q=Q.value,Q.L9===I&&Q.N9===U&&Q.authChallenge===M&&Q.foa===F){N=Q;break}N||(N=Object.assign(new e,{L9:I,N9:U,authChallenge:M,Tne:T,foa:F,retryCount:0,startTime:O.ew()}),this.fT.add(N));N.retryCount=0;N.callbacks.add(K);this.a$d=this.a$d.then(function(){var ca=b(1057).AppsForOfficeSingleSignOnManager;if(0<J.fT.count){var X=J.fT.na(0);if(J.pxj(X)||J.Xvj(X))return null;for(var Z=0;Z<J.Mkb.count;)J.Mkb.na(Z)+c.IIj<ca.ew()?J.Mkb.removeAt(Z):Z++;if(J.Mkb.count>=c.ozi||J.fT.count>=c.Tyi)return X=
new z.a,X.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,J.nwb(X),null;var ea=null;r.AFrameworkApplication.ta&&(ca=r.AFrameworkApplication.ta.tD)&&(ea=ca.sc("ComponentAttach",J.Emg+c.Ewg));return X.foa.fzg(J.resource,X.L9,X.N9,X.authChallenge,J.Vjg,X.Tne).then(function(ka){ea&&ea.stop();J.nwb(ka)},function(){ea&&ea.stop();var ka=new z.a;ka.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;J.nwb(ka)})}return null})}};c.prototype.nwb=function(I){var U=b(1057).AppsForOfficeSingleSignOnManager;
try{if(this.fT.count){var M=this.fT.na(0);this.fT.removeAt(0);var T=null;I.errorCode||(T=new l,T.accessToken=I.token);I.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&I.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&I.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&I.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.aDg(M,I.errorCode);var F={};null!=I.Wvb&&(F.getTokenSilentTime=I.Wvb.toString());null!=I.mgd&&
(F.getTokenPopupTime=I.mgd.toString());null!=I.Ydd&&(F.getIDTokenTime=I.Ydd.toString());null!=I.PSa&&(F.tokenCached=I.PSa.toString());I.BUd&&(F.detailedError=I.BUd);I.aha&&(F.authLibrary=I.aha);M.retryCount&&(F.retryCount=M.retryCount);for(var K=ak(M.callbacks),J=K.next();!J.done;J=K.next())U.z5(J.value,I.errorCode,T,F);null!=I.PSa&&I.PSa||this.Mkb.add(M.startTime);if(!I.errorCode)for(null!=I.expiresOn&&(this.kpa=Object.assign(new k,{token:I.token,expiresOn:I.expiresOn,authChallenge:M.authChallenge,
aha:I.aha})),this.oG.clear(),K=0;K<this.fT.count;)if(this.fT.na(K).authChallenge===M.authChallenge){var O=ak(this.fT.na(K).callbacks);for(J=O.next();!J.done;J=O.next())U.z5(J.value,I.errorCode,T,F);this.fT.removeAt(K)}else K++}}catch(N){w.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",N.message)}};c.prototype.shutdown=function(){this.bge=!0;this.fT.clear()};Af.Object.defineProperties(c.prototype,{resource:{configurable:!0,enumerable:!0,get:function(){return this.AVb}}});
c.IIj=6E4;c.ozi=6;c.Tyi=6;c.tzi=3;c.Wyi=300;c.Ewg="GetAccessToken";Object(u.a)(c,"SSOCallbackManager",null,[]);var v=b(935),A=b(942),B=b(124),y=b(81),x=b(25),C=b(30),G=b(154),E=b(356);b.d(D,"AppsForOfficeSingleSignOnManager",function(){return a});a.prototype.Rbd=function(I,U,M,T,F,K,J,O,N,H){H=Object.assign(new m,{startTime:a.ew(),callback:H});try{var Q=!!M&&""!==M,ca=H.startTime,X=this.getOsfControl(I),Z=X.getStoreType()||"",ea=X.getOwnerAddinStoreType()||"",ka=X.getSolutionId()||"",Y=X.getVersion()||
"";Z=Z.toLowerCase();ea=ea.toLowerCase();ka=ka.toLowerCase();var qa=y.a.Xdd(U)||"",fa=y.a.Xdd(X.getIframeUrl())||"",ha=qa.toLowerCase()===fa.toLowerCase();qa=Z;"inmemory"===Z&&(qa=ea);var ia=Telemetry.PrivacyRules.GetPrivacyCompliantId(ka,qa,X.getAssetId(),null,null,X.getStoreId());X={};var wa=(X.callInstanceId=ca.toString(),X.controlAssetId=ia,X.controlVersion=Y,X.storeType=Z,X.ownerStoreType=ea,X.allowConsentPrompt=T.toString(),X.forMSGraphAccess=F.toString(),X.allowSignInPrompt=K.toString(),X.hasAddinAuthChallenge=
Q.toString(),X.securityOriginEqualsSourceLocation=ha.toString(),X.singleSignOnEnabled=J.toString(),X.accountTypeFilter=O||"",X);w.ULS.sendTraceTag(51401115,344,50,"{0}",wa);G.a.sendTelemetryEvent(Object.assign(new E.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:B.a.gl(wa)}));ca=!0;var Qa=r.AFrameworkApplication.fa.Wa("HostAuthType");switch(O){case "aad":ca="aad"===Qa;break;case "msa":ca="msa"===Qa;break;default:ca=!O||"noFilter"===O}if(ca){O=null;if(J)for(var S=ak(this.Hxg),
da=S.next();!da.done;da=S.next()){var xa=da.value;if(xa.Xgi(ka)){O=xa;break}}O?this.isSSOAddin(I)?(J=!0,"omex"===qa&&(J=!1),"spapp"===qa||"spcatalog"===qa?(w.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),a.z5(H,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):F&&!J?(w.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),a.z5(H,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,
null,null)):(F&&"exchange"===qa&&(T=!1),this.Qbd(I,U,M,qa,T,K,N,O,H))):(w.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),a.z5(H,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):a.z5(H,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else a.z5(H,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(ta){this.Ojc(),w.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",
ta.message),a.z5(H,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}};a.prototype.getAccessToken=function(I,U,M,T){this.Rbd(I,M[v.a.jVc]||null,M[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,M[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,M[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,M[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,U,M[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||
null,M[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,T)};a.prototype.Qbd=function(I,U,M,T,F,K,J,O,N){this.hEc.kb(I)?T=this.hEc.na(I):(T=new c(I,this.getWebApplicationResource(I).split(",")[0],T,this.getDefaultDisplayName(I)),this.hEc.add(I,T));var H=T.resource;I=a.KVh(H,this.getWebApplicationId(I));var Q=OfficeExt.WACUtils.getHostSecure(U);I&&Q?I.toLowerCase()===Q.toLowerCase()?T.Qbd(F,K,M,J,O,N):(a.xNa('SSO Resource "'+H+'" cannot be used from "'+U+'" origin due to domain mismatch.'),
w.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),a.z5(N,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(I||w.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),Q||w.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),a.z5(N,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))};a.prototype.Ojc=function(){var I={};w.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",
(I.UserAgent=window.navigator.userAgent,I))};a.prototype.getOsfControl=function(I){return this.Mm.getOsfControl(I)};a.prototype.isSSOAddin=function(I){return this.getOsfControl(I).getManifest().isSSOAddin()};a.prototype.getWebApplicationId=function(I){return this.getOsfControl(I).getManifest().getWebApplicationId()};a.prototype.getWebApplicationResource=function(I){return this.getOsfControl(I).getManifest().getWebApplicationResource()};a.prototype.getDefaultDisplayName=function(I){return this.getOsfControl(I).getManifest().getDefaultDisplayName()};
a.uXh=function(){try{var I={};x.a.Zwa&&A.a.exb&&(I.UiHostSupportsAuthTokenAddinList=a.ZSe);I.UiHostSupportsAuthToken=A.a.exb;return I}catch(U){w.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",U.message)}return null};a.getInstance=function(I,U,M){a.Ma||(a.Ma=new a(I,void 0===M?null:M));return a.Ma};a.xNa=function(I){window.console.warn&&window.console.warn(I)};a.KVh=function(I,U){if(!I)return"";U||(U="");var M=I.toLowerCase(),T=U.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(T)||
(a.xNa('SSO App Id "'+U+'" is not a valid format. It will be rejected from store submission.'),w.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));M.endsWith(T)||(a.xNa('SSO Resource "'+I+'" does not end with App Id "'+U+'". It will be rejected from store submission.'),w.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!M.startsWith("https://")&&!M.startsWith("api://"))return a.xNa('SSO Resource "'+I+'" must be https:// or api:// protocol.'),w.ULS.sendTraceTag(590962909,
344,10,"Resource not using https or api protocol."),"";for(U=0;U<I.length;U++){T=I.charAt(U);var F=C.a.charCodeAt(I,U);if(33>F||126<F||"&"===T||"?"===T||"#"===T||"%"===T||"\\"===T)return a.xNa('SSO Resource "'+I+'" contains an invalid character "'+T+'".'),w.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+T+"' in resource URI."),""}if(0<=I.indexOf("::"))return a.xNa('SSO Resource "'+I+'" contains an invalid string "::".'),w.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<
I.length)return a.xNa('SSO Resource "'+I+'" is '+I.length+" characters and exceeds the max length of 120 characters."),w.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+I.length+"."),"";M.startsWith("api://")&&(M="https://"+M.substring(6,M.length));return 8===M.length?"":OfficeExt.WACUtils.getHostSecure(M)||""};a.z5=function(I,U,M,T){var F=I.startTime,K=0;0<F&&(K=a.ew()-F);var J={};F=(J.callInstanceId=F.toString(),J.callDuration=K.toString(),J.errorCode=U.toString(),J);if(T)for(var O in T)F[O]=
T[O];w.ULS.sendTraceTag(51401116,344,50,"{0}",F);G.a.sendTelemetryEvent(Object.assign(new E.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:B.a.gl(F)}));I.callback(U,M)};a.ew=function(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(I){}return Date.now()};a.ZSe="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");a.Ma=null;Object(u.a)(a,
"AppsForOfficeSingleSignOnManager",null,[214])},1072:function(u,D,b){function a(){var d={};this.qQe=(d.tabhome="Ribbon.Home",d.tabinsert="Ribbon.Insert",d.tabdata="Ribbon.Data",d.tabreview="Ribbon.Review",d.tabview="Ribbon.View",d);d={};this.pQe=(d.tabpagelayoutexcel=["Ribbon.PageLayoutExcel",c.a.instance.ga(1613),c.a.instance.ga(1617)],d.tabformulas=["Ribbon.Formulas",c.a.instance.ga(1614),c.a.instance.ga(1618)],d.tabdeveloper=["Ribbon.Developer",c.a.instance.ga(1615),c.a.instance.ga(1619)],d.tabaddins=
["Ribbon.AddIns",c.a.instance.ga(1616),c.a.instance.ga(1620)],d);this.D8b=null}b.d(D,"a",function(){return a});u=b(0);var c=b(14);a.prototype.ERh=function(){if(!this.D8b){this.D8b={};for(var d=ak(Object.keys(this.qQe)),e=d.next();!e.done;e=d.next())e=e.value,this.D8b[e]=this.qQe[e];d=ak(Object.keys(this.pQe));for(e=d.next();!e.done;e=d.next())e=e.value,this.D8b[e]=this.pQe[e][0]}};Af.Object.defineProperties(a.prototype,{Rha:{configurable:!0,enumerable:!0,get:function(){return"SourceControlId"}},NM:{configurable:!0,
enumerable:!0,get:function(){return"Workbook"}},formFactor:{configurable:!0,enumerable:!0,get:function(){return"DesktopFormFactor"}}});Object(u.a)(a,"AddinCommandsStringProvider",null,[874])},1074:function(u,D,b){function a(){this.mLa=0;this.qha=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.Kdc=!1;this.z8e=this.hia=null}b.d(D,"a",function(){return a});u=b(0);Object(u.a)(a,"AddInCommandsNotificationParameters",null,[])},1145:function(u,D,b){function a(){}function c(){}
function d(F,K,J,O,N,H){F=e.call(this,F,K,J,O,N,void 0===H?null:H)||this;F.oUb=null;return F}function e(F,K,J,O,N,H){F=k.call(this,F,J,N.hX,void 0===H?null:H)||this;F.Aae=0;F.$0=F.JRh(O);F.BXa=K;F.Se=N;F.JJj=7;F.dl=F.BXa.ownerDocument.createElement("div");F.dl.className="ModalCalloutControlOverlay";F.dl.tabIndex=0;F.BXa.insertBefore(F.dl,F.BXa.firstChild);return F}function k(F,K,J,O){var N=z.call(this,document.createElement("div"))||this;N.Eqa=null;N.fpa=null;N.qG=null;N.lG=null;N.Uw=null;N.GS=null;
N.HS=null;N.Upa=!1;N.xib=!1;N.Ap=null;N.content=null;N.$0=0;N.Ese=null;N.RT=0;N.jCf=null;N.bhe=F;N.sce=K;N.hP=J;N.GY=O;N.og=K.ownerDocument;N.Qib=!1;N.Qu=!1;N.yid=!1;return N}u=b(0);var l=b(15),m=b(83),f=b(158),w=b(13),n=b(89),z=Sys.UI.Control;Rk(k,z);k.prototype.show=function(){this.Qib||(this.R5g(),this.Zn(),this.sce.appendChild(this.$V),this.$V.style.display="Block",this.Tsj(),this.Qib=!0,this.jCf&&this.jCf())};k.prototype.dismiss=function(){this.Qib&&(this.$0a(),this.sce.removeChild(this.$V),
this.Qib=!1,this.GY&&this.GY())};k.prototype.dispose=function(){this.dismiss();this.GS=this.Uw=this.lG=this.fpa=this.qG=this.Eqa=null;Sys.Component.prototype.dispose.call(this)};k.prototype.di=function(F){return this.get_element().id+F};k.prototype.R5g=function(){this.qG=this.og.createElement("div");this.qG.id=this.di("WACCalloutHeader");this.qG.className="WACCalloutHeader";this.Qu&&this.qke();this.yid&&this.Ile();this.lG=this.og.createElement("div");this.lG.id=this.di("WACCalloutContent");this.lG.className=
"WACCalloutContent";this.lG.style.width=190<this.$0?this.$0-26+"px":"164px";this.lG.appendChild(this.content);this.$V.appendChild(this.l0b);this.$V.appendChild(this.qG);this.$V.appendChild(this.lG)};k.prototype.qke=function(){this.Uw=this.og.createElement("a");this.Uw.className="WACCalloutCloseAnchor";this.Uw.id=this.di("WACCalloutCloseAnchor");this.Uw.href="#";this.qG.appendChild(this.Uw);var F=f.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);
this.Uw.appendChild(F)};k.prototype.Ile=function(){this.GS=this.og.createElement("div");this.GS.className="WACCalloutTitle UIFontBold";this.GS.style.width=190<this.$0?this.$0-30+"px":"160px";this.GS.id=this.di("WACCalloutTitle");this.GS.innerText=this.title;this.qG.contains(this.Uw)?this.qG.insertBefore(this.GS,this.Uw):this.qG.appendChild(this.GS)};k.prototype.Tsj=function(){var F=this.bhe;if(1===this.RT){var K=this.Ese.y+16;var J=-16}else 2===this.RT||3===this.RT||0===this.RT?(K=F.y+F.height+15,
J=-15):(K=F.y-this.$V.clientHeight-15-2,J=this.$V.clientHeight-1);this.$V.style.top=K+"px";this.l0b.style.top=J+"px";1===this.RT?(F=this.Ese.x-16,this.$V.style.left="50%",this.$V.style.marginLeft=-this.$0/2+"px",K=Sys.UI.DomElement.getBounds(this.$V),this.l0b.style.left=F-K.x+"px"):(K=F.x+this.bhe.width/2,2===this.RT||5===this.RT?(F=20,K-=36):0===this.RT||4===this.RT?(F=this.$0/2-16,K-=this.$0/2):(F=this.$0-20-32,K=K-this.$0+36),this.$V.style.left=K+"px",this.l0b.style.left=F+"px")};k.prototype.Zn=
function(){this.Qu&&!this.HS&&(this.HS=Object(m.a)(this,this.t$,"closeHandler"),this.hP.qa(w.a.click,this.Uw,this.HS,null))};k.prototype.$0a=function(){this.Qu&&this.HS&&(this.hP.Aa(w.a.click,this.Uw,this.HS),this.HS=null)};k.prototype.t$=function(){this.dismiss();return!0};Af.Object.defineProperties(k.prototype,{$V:{configurable:!0,enumerable:!0,get:function(){this.Eqa||(this.Eqa=this.og.createElement("div"),this.Eqa.id=this.di("WACCalloutOuter"),this.Eqa.className="WACCalloutOuter",this.Eqa.setAttribute(n.a.Hd,
n.a.cZa),this.Eqa.style.width=this.$0+"px");return this.Eqa}},l0b:{configurable:!0,enumerable:!0,get:function(){if(!this.fpa){this.fpa=this.og.createElement("div");this.fpa.id=this.di("WACCalloutBeakContainer");this.fpa.className="WACCalloutBeakContainer";var F="CalloutBeakTopFilled_32x16x32";if(5===this.RT||6===this.RT||4===this.RT)F="CalloutBeakBottomFilled_32x16x32";F=f.createClusteredImage(32,16,F,"WACCalloutBeak",!0,"");this.fpa.appendChild(F)}return this.fpa},set:function(F){this.fpa=F}},QLa:{configurable:!0,
enumerable:!0,get:function(){return this.Qib}},title:{configurable:!0,enumerable:!0,get:function(){return this.Ap},set:function(F){this.Ap!==F&&(this.Ap=F,this.GS&&(this.GS.innerText=this.Ap))}},Qu:{configurable:!0,enumerable:!0,get:function(){return this.Upa},set:function(F){this.Upa!==F&&(this.Upa=F,this.qG&&(this.qG.contains(this.Uw)&&!this.Upa?this.qG.removeChild(this.Uw):!this.qG.contains(this.Uw)&&this.Upa&&this.qke()))}},yid:{configurable:!0,enumerable:!0,get:function(){return this.xib},set:function(F){this.xib!==
F&&(this.xib=F,this.qG&&(this.qG.contains(this.GS)&&!this.xib?this.qG.removeChild(this.GS):!this.qG.contains(this.GS)&&this.xib&&this.Ile()))}}});Object(u.a)(k,"Callout",Sys.UI.Control,[289]);Rk(e,k);e.prototype.show=function(){this.QLa||(this.Se.$pc(),this.Se.yP(!1),this.dl.style.zIndex=String(this.Se.d2),k.prototype.show.call(this),this.Ti(),this.Aae=window.setTimeout(Object(m.a)(this,this.dismiss,"dismiss"),1E3*this.JJj))};e.prototype.dismiss=function(){this.QLa&&(this.Se.rM(!1),this.Uj(),this.BXa&&
this.BXa.contains(this.dl)&&this.BXa.removeChild(this.dl),k.prototype.dismiss.call(this),window.clearTimeout(this.Aae))};e.prototype.Ti=function(){this.Se.Fra(Object(m.a)(this,this.dismiss,"dismiss"));this.Se.yy.qa(w.a.click,this.dl,Object(m.a)(this,this.$c,"onClick"))};e.prototype.Uj=function(){this.Se.cbb(Object(m.a)(this,this.dismiss,"dismiss"));this.Se.yy.Aa(w.a.click,this.dl,Object(m.a)(this,this.$c,"onClick"))};e.prototype.$c=function(){this.dismiss();return!0};e.prototype.JRh=function(F){var K=
0;switch(F){case 0:K=190;break;case 1:K=250;break;case 2:K=300;break;case 3:K=360}return K};Object(u.a)(e,"ModalCallout",k,[]);var r=b(628),v=b(204);Rk(d,e);d.prototype.show=function(){var F=this;if(!this.QLa){var K=Object.assign(new r.a,{onShow:function(){e.prototype.show.call(F)}});v.UISurfaces.CQ().then(function(J){var O=J.externalNotification();F.oUb=J.addNotification(O,K);return null},function(J){l.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",J);return null})}};
d.prototype.dismiss=function(){var F=this;this.QLa&&this.oUb&&(v.UISurfaces.CQ().then(function(K){K.removeNotification(F.oUb);return F.oUb=null},function(K){l.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",K);return null}),e.prototype.dismiss.call(this))};Object(u.a)(d,"ReactManagedModalCallout",e,[]);var A=b(4);c.A7g=function(F,K,J){var O=void 0===O?null:O;return A.AFrameworkApplication.ta.Pa.ZQ?new d(F,K,J,3,A.AFrameworkApplication.ta,O):new e(F,K,J,3,A.AFrameworkApplication.ta,
O)};Object(u.a)(c,"ModalCalloutControlFactory",null,[]);var B=b(52),y=b(1070),x=b(643),C=b(1071),G=b(135),E=b(55),I=b(39),U=b(84),M=b(1020),T=b(906);b.d(D,"a",function(){return a});a.hCe=function(F,K,J,O){a.WI&&a.WI.QLa&&a.WI.dismiss();a.WI=c.A7g(K,F,F);a.WI.content=J;T.b(O)||(a.WI.title=O,a.WI.yid=!0);F=new Sys.UI.Bounds(0,0,E.a.jcc(),E.a.icc());a.WI.RT=a.HJh(F,K,a.WI.$0);a.WI.show();a.J_b&&a.J_b.sendNotification(J.innerText,!0)};a.C2c=function(F,K,J,O){O=void 0===O?null:O;v.UISurfaces.CQ().then(function(N){var H=
null;a.Jkb&&(N.removeNotification(a.Jkb),a.Jkb=null);var Q=N.callout(Object.assign(new y.a,{target:F,title:K,content:J,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new C.a,{onDismiss:function(){N.removeNotification(H)},directionalHint:null!=O?O:null})})),ca=Object.assign(new r.a,{expirationOptions:Object.assign(new x.a,{displayTimeoutSeconds:7,onExpire:function(){N.removeNotification(a.Jkb)}})});H=a.Jkb=N.addNotification(Q,ca);return null},function(N){l.ULS.sendTraceTag(593352342,
383,15,"Failed to GetNotificationsAPIAsync: {0}",N);return null})};a.SQd=function(F,K){K=void 0===K?null:K;a.WI&&a.WI.QLa&&a.WI.dismiss();var J=new G.StandardDialog;J.TRa=!1;J.Rb=0;J.Oz(B.a.Eqi,CommonUIStrings.l_DialogError,T.b(F)?a.KXe():F,K)};a.UQd=function(F){a.WI&&a.WI.QLa&&a.WI.dismiss();l.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",F.errorCode));var K=T.b(F.description)?a.KXe():F.description,J=new G.StandardDialog,O=null;F.qha?(J.Rb=1,J.mc(1,
F.buttonText),J.i7(1)):J.Rb=0;O=function(N){1===N?F.qha():F.hia&&F.hia()};J.TRa=!1;0===F.mLa?J.Oz(F.errorCode,F.title?F.title:CommonUIStrings.l_DialogError,K,O):1===F.mLa?J.dX(F.title?F.title:CommonUIStrings.l_DialogWarning,K,O):J.DAa(F.title?F.title:CommonUIStrings.l_DialogInfo,K,O)};a.HJh=function(F,K,J){var O=4,N=F.x+F.width-K.x-K.width;K.x-F.x+K.width/2<=J/2?O=5:N+K.width/2<=J/2&&(O=6);return O};a.Tyj=function(F,K,J,O){O=void 0===O?!1:O;(K=M.a.kub(K))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&
appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(K,function(N){N&&(O||a.C2c(N,J,F,5))})};a.Uyj=function(F,K,J){J=void 0===J?!1:J;a.Tyj(K.startedNode?K.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,F),K,K.startedNode?K.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,F),J)};a.Syj=function(F,K,J,O){if(a.Ydg)F=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,
J,O,CommonUIStrings.l_InsertionDialogRefresh)),a.C2c(K,F,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{K=I.a.So(K);var N=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),H=document.createElement("span");H.innerText=N[0];var Q=document.createElement("span");Q.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,J,O,CommonUIStrings.l_InsertionDialogRefresh);Q.className="UIFontBold";J=document.createElement("span");J.innerText=N[1];O=document.createElement("div");
Sys.UI.DomElement.addCssClass(O,"ModalCalloutControl");O.appendChild(H);O.appendChild(Q);O.appendChild(J);a.hCe(F,K,O,CommonUIStrings.l_ErrorLoadingAddInsTitle)}};a.jAj=function(F,K){var J=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,O=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;a.Ydg?a.C2c(K,J,O):(K=I.a.So(K),a.hCe(F,K,a.MRg(O),J))};a.MRg=function(F){var K=document.createElement("div");Sys.UI.DomElement.addCssClass(K,"ModalCalloutControl");K.innerText=F;return K};a.KXe=
function(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive};Af.Object.defineProperties(a,{J_b:{configurable:!0,enumerable:!0,get:function(){return a.Qea||(a.Qea=U.a.instance.nh("Common.Utils.IAriaNotifier"))}},Ydg:{configurable:!0,enumerable:!0,get:function(){return A.AFrameworkApplication.ta.Pa.yi&&A.AFrameworkApplication.ta.Pa.ZQ}}});a.WI=null;a.Jkb=null;a.Qea=null;Object(u.a)(a,"AddInCommandsNotificationFactory",null,[])},1155:function(u,D,b){function a(v,A,
B,y,x){this.ax=v;this.KI=B;this.o1=y;this.Jd=x;this.dhb=this.KI.ri;this.Ey=this.dhb.getOsfControl(A);this.isg=this.Ey.getManifest()}function c(v,A,B,y){this._id=v;this.ax=A;this.o1=B;this.Jd=y}function d(v,A,B,y){this.hA=!1;this._id=v;this.ax=A;this.o1=B;this.Jd=y}b.r(D);u=b(0);var e=b(15),k=b(1664),l=b(154),m=b(124),f=b(935),w=b(944),n=b(356);d.prototype.setEnabled=function(){};d.prototype._OnAccess=function(){};d.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.RibbonButton"};d.prototype.invokePropertyGet=
function(v){switch(v){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);};d.prototype.invokePropertyGetAsync=function(v){v=this.invokePropertyGet(v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)};d.prototype.invokePropertySet=function(v,A){switch(v){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(A,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);
};d.prototype.invokePropertySetAsync=function(v,A){this.invokePropertySet(v,A);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};d.prototype.invokeMethod=function(v,A){switch(v){case 5:return this.Epj(A);case 1:return this.gCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);};d.prototype.invokeMethodAsync=function(v,A){v=this.invokeMethod(v,A);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)};d.prototype.Epj=function(v){v=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,
0,"boolean");this.setEnabled(v);return null};d.prototype.gCa=function(){this._OnAccess();return null};Af.Object.defineProperties(d.prototype,{enabled:{configurable:!0,enumerable:!0,get:function(){return this.hA},set:function(v){var A=b(1155).DynamicRibbon,B=this.Jd.OwnerAddinStoreType,y=this.Jd.PrimaryMarketplace.MarketplaceRef,x=this.Jd.AssetMarketplace?this.Jd.AssetMarketplace.SolutionId:null,C=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ax,B,null,null,null,y),G={};B=(G.addinSolutionId=C,
G.ownerAddinSolutionId=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Jd.OwnerAddinSolutionId,B,x,null,null,y),G.ownerAddinStoreType=B,G.ribbonControlType="Button",G.toggle=v,G);l.a.sendTelemetryEvent(Object.assign(new n.a,{name:A.wzc+"ControlUpdate",dataFields:m.a.gl(B)}));this.hA=v;v={};C=(v.DynamicAddinCommandsMethodDispatchId=1,v.SolutionId=this.ax,v.PrivacyCompliantSolutionId=C,v.SourceControlId=this.id,v.MethodData=this.hA,v);this.o1.UJ(-1014260128,C)}},id:{configurable:!0,enumerable:!0,
get:function(){return this._id}},label:{configurable:!0,enumerable:!0,get:function(){return null}}});Object(u.a)(d,"RibbonButton",null,[]);c.prototype.setVisibility=function(v){var A=b(1155).DynamicRibbon,B=this.Jd.OwnerAddinStoreType,y=this.Jd.PrimaryMarketplace.MarketplaceRef,x=this.Jd.AssetMarketplace?this.Jd.AssetMarketplace.SolutionId:null,C=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ax,B,x,null,null,y),G={};y=(G.addinSolutionId=C,G.ownerAddinSolutionId=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Jd.OwnerAddinSolutionId,
B,x,null,null,y),G.ownerAddinStoreType=B,G.ribbonControlType="Tab",G.toggle=v,G);l.a.sendTelemetryEvent(Object.assign(new n.a,{name:A.wzc+"ControlUpdate",dataFields:m.a.gl(y)}));A={};v=(A.DynamicAddinCommandsMethodDispatchId=2,A.SolutionId=this.ax,A.PrivacyCompliantSolutionId=C,A.StoreType=B,A.SourceControlId=this.id,A.MethodData=v,A);this.o1.UJ(-1014260128,v)};c.prototype._OnAccess=function(){};c.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.RibbonTab"};c.prototype.invokePropertyGet=
function(v){switch(v){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);};c.prototype.invokePropertyGetAsync=function(v){v=this.invokePropertyGet(v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)};c.prototype.invokePropertySet=function(v){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);};c.prototype.invokePropertySetAsync=function(v,A){this.invokePropertySet(v,A);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
c.prototype.invokeMethod=function(v,A){switch(v){case 3:return this.xtj(A);case 1:return this.gCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);};c.prototype.invokeMethodAsync=function(v,A){v=this.invokeMethod(v,A);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)};c.prototype.xtj=function(v){v=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"boolean");this.setVisibility(v);return null};c.prototype.gCa=function(){this._OnAccess();return null};
Af.Object.defineProperties(c.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}}});Object(u.a)(c,"RibbonTab",null,[]);var z=b(1174),r=b(180);b.d(D,"DynamicRibbon",function(){return a});a.prototype.executeRequestCreate=function(v){try{var A=this.Jd.OwnerAddinStoreType,B=this.Jd.PrimaryMarketplace.MarketplaceRef,y=this.Jd.AssetMarketplace?this.Jd.AssetMarketplace.SolutionId:null,x=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ax,A,y,null,null,B),C={},G=(C.addinSolutionId=
x,C.ownerAddinSolutionId=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Jd.OwnerAddinSolutionId,A,y,null,null,B),C.ownerAddinStoreType=this.Jd.OwnerAddinStoreType,C.ribbonControlType="Ribbon",C);l.a.sendTelemetryEvent(Object.assign(new n.a,{name:a.wzc+"ExecuteRequestCreate",dataFields:m.a.gl(G)}));var E=r.a.Vh(v);v={};A={};A[f.a.sIa]=this.Ey;A[f.a.tIa]=E;A[f.a.H6c]=this.Jd;v[f.a.wsb]=3;v[f.a.D3]=this.ax;v[f.a.i7b]=x;v[f.a.C3]=A;this.o1.UJ(-1014260128,v);var I=a.B$b("ExecuteRequestCreate",!0,"");
e.ULS.sendTraceTag(538572826,0,50,I)}catch(U){x=a.B$b("ExecuteRequestCreate",!1,U.toString()),e.ULS.sendTraceTag(538572825,0,50,x)}return null};a.prototype.executeRequestUpdate=function(v){try{var A=this.Jd.OwnerAddinStoreType,B=this.Jd.PrimaryMarketplace.MarketplaceRef,y=this.Jd.AssetMarketplace?this.Jd.AssetMarketplace.SolutionId:null,x=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ax,A,y,null,null,B),C={},G=(C.addinSolutionId=x,C.ownerAddinSolutionId=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Jd.OwnerAddinSolutionId,
A,y,null,null,B),C.ownerAddinStoreType=this.Jd.OwnerAddinStoreType,C.ribbonControlType="Ribbon",C);l.a.sendTelemetryEvent(Object.assign(new n.a,{name:a.wzc+"ExecuteRequestUpdate",dataFields:m.a.gl(G)}));var E=r.a.Vh(v);v={};A={};A[f.a.sIa]=this.Ey;A[f.a.tIa]=E;A[f.a.H6c]=this.Jd;v[f.a.wsb]=3;v[f.a.D3]=this.ax;v[f.a.i7b]=x;v[f.a.C3]=A;this.o1.UJ(-1014260128,v);var I=a.B$b("ExecuteRequestUpdate",!0,"");e.ULS.sendTraceTag(538572824,0,50,I)}catch(U){x=a.B$b("ExecuteRequestUpdate",!1,U.toString()),e.ULS.sendTraceTag(538572823,
0,50,x)}return null};a.prototype.getButton=function(v){var A=null;if(!this.Vbf())return this.jCe();if(v&&0<v.length){if(!this.sxe(v))return this.CCe(v);A=new d(v,this.ax,this.o1,this.Jd)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(A)};a.prototype.getTab=function(v){var A=null;if(!this.Vbf())return this.jCe();if(this.Ey.getOwnerAddinControlRecreated())return this.P6g();if(v&&0<v.length){if(!this.sxe(v))return this.CCe(v);A=new c(v,this.ax,this.o1,this.Jd)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(A)};
a.prototype._OnAccess=function(){};a.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.DynamicRibbon"};a.prototype.invokePropertyGet=function(v){switch(v){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);};a.prototype.invokePropertyGetAsync=function(v){v=this.invokePropertyGet(v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)};a.prototype.invokePropertySet=function(v){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);
};a.prototype.invokePropertySetAsync=function(v,A){this.invokePropertySet(v,A);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};a.prototype.invokeMethod=function(v){switch(v){case 1:return this.gCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);};a.prototype.invokeMethodAsync=function(v,A){switch(v){case 7:return this.Zwh(A);case 6:return this.$wh(A);case 3:return this.mJh(A);case 5:return this.pYh(A)}v=this.invokeMethod(v,A);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)};
a.prototype.Zwh=function(v){v=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"string");return this.executeRequestCreate(v)};a.prototype.$wh=function(v){v=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"string");return this.executeRequestUpdate(v)};a.prototype.mJh=function(v){v=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"string");return this.getButton(v)};a.prototype.pYh=function(v){v=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"string");
return this.getTab(v)};a.prototype.gCa=function(){this._OnAccess();return null};a.prototype.CCe=function(v){return z.a(w.a.t2g,r.a.ga(1746)+v)};a.prototype.jCe=function(){return z.a(w.a.Dhj,r.a.ga(1742))};a.prototype.P6g=function(){return z.a(w.a.hostRestartNeeded,r.a.ga(1747))};a.prototype.Vbf=function(){var v=this.Ey.getSharedRuntimeId();v=!!v&&0<v.length;e.ULS.sendTraceTag(538572822,0,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",v));return v};a.prototype.sxe=function(v){var A=
this.isg.getRibbonExtensionControlMap();return v in A||this.DWg(v)};a.prototype.DWg=function(v){var A=this.HAh();if(A){A=ak(A.hJe.tabs);for(var B=A.next();!B.done;B=A.next()){B=B.value;if(B.id===v)return!0;B=ak(B.groups);for(var y=B.next();!y.done;y=B.next()){y=ak(y.value.controls);for(var x=y.next();!x.done;x=y.next()){x=x.value;if(x.id===v)return!0;if("Menu"===x.type){x=ak(x.items);for(var C=x.next();!C.done;C=x.next())if(C.value.id===v)return!0}}}}}return!1};a.prototype.HAh=function(){return k.a.getInstance().Kia(this.Jd.PrimaryMarketplace.MarketplaceType,
this.Jd.PrimaryMarketplace.SolutionId,1)};a.B$b=function(v,A,B){var y={};y.methodName="DynamicRibbon."+v;y.result=A?"Succeeded":"Failed";y.message=B;return r.a.xc(y)};Af.Object.defineProperties(a.prototype,{buttons:{configurable:!0,enumerable:!0,get:function(){return null}}});a.wzc="Office.Online.Extensibility.Ribbon.";Object(u.a)(a,"DynamicRibbon",null,[])},1164:function(u,D,b){function a(){Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=
c.a}b.d(D,"a",function(){return a});var c=b(1165)},1169:function(u,D,b){function a(){this.focusOnIframeWhenLoaded=!1;this.width=0;this.ceb=this.s4=this.Kk=null;this.isFirstPartyOptOutAppContextOptmization=!1}b.d(D,"a",function(){return a});u=b(0);a.key="InsertAgaveClientSideParametersKey";Object(u.a)(a,"InsertAgaveClientSideParameters",null,[])},1170:function(u,D,b){function a(){}b.d(D,"a",function(){return a});u=b(0);a.O8b="extId";a.nAe="ComponentType";a.bHa="ComponentId";a.vjd="HostProps";a.Iya=
"OptionalProps";Object(u.a)(a,"ActionPropertyNames",null,[])},1172:function(u,D,b){function a(c,d){var e=!1;c&&(c=d.osfControl,(d=c.getManifest())&&d.getSharedRuntimeForCustomFunctions("Workbook")&&!c.getIsUpgrading()&&(e=!0));return e}b.d(D,"a",function(){return a})},1173:function(u,D,b){function a(){this.token=null;this.errorCode=0;this.expiresOn=this.aha=this.PSa=this.Ydd=this.mgd=this.Wvb=this.BUd=null}b.d(D,"a",function(){return a});u=b(0);Object(u.a)(a,"AppsForOfficeOauthResult",null,[])},1174:function(u,
D,b){function a(c,d){return OfficeExtension.WacRuntime.Utility.createPromise(function(e,k){k(OfficeExtension.WacRuntime.Utility.createRichApiException(c,d))})}b.d(D,"a",function(){return a})},1352:function(u,D,b){function a(){Ya.a.Fa(function(kb){N.ka(kb);c.ka(kb)})}function c(kb){var lb=Aa.call(this)||this;lb.$=kb;lb.Eb();return lb}function d(kb,lb){var ac=e.call(this)||this;ac.$=kb;ac.p1a=new DOMParser;ac.cache=new qb.a;ac.indexedDB=lb;lb.Cf()&&ac.indexedDB.initialize("Scripts","OfficeScriptingCache");
ac.Cwb=!1;ac.Up=new A([],function(Dc){e.hDj(Dc)});ac.Gj=new A([],function(Dc){e.byc(Dc)});ac.yB=new A([],function(Dc){e.byc(Dc)});ac.ht=new A([],function(){});ac.HMb=new A([],function(Dc){e.byc(Dc)});return ac}function e(){this.ht=null;this.Cwb=this.TGb=this.uW=this.sab=this.hGd=this.wLf=this.fGd=this.uab=this.kdc=!1;this.HMb=this.yB=this.Gj=this.Up=null}function k(kb,lb,ac,Dc){var Zb=this;this.N6a=!1;this.Y8a=function(){Zb.u1f()?(Zb.ZGf(),Da.g(Zb.$).Ea.kId(Zb.Y8a)):Zb.N6a&&Da.g(Zb.$).Ea.kId(Zb.Y8a)};
this.sIi=function(mc,Lb){Object.getType(Lb)===String&&Lb.toString().endsWith(fa.a.Gvb(Zb.$))&&(Zb.N6a=!1)};this.$=kb;this.cha=lb;this.Cu=ac;this.businessBarManager=Dc;this.uuj()}function l(kb,lb,ac,Dc,Zb,mc,Lb,Sa,Cb){var ec=this;this.yA=null;this.cache=new qb.a;this.Bwa=!1;this.RFa={};this.$=kb;this.xPc=ac;this.indexedDB=Dc;this.rob=Zb;this.Cu=mc;this.cha=Lb;this.Je=Sa;this.cC=Cb;this.$Mg=new B(this,kb);this.dqg=wa.a.Ta.Jb;this.b6f="";Dc.Cf()&&(this.Bwa=!0,this.indexedDB.initialize("Scripts","OfficeScriptingCache"));
kb=!0;if(Db.a.Ite){this.cache.Cf()&&!fa.a.qta&&(lb=this.Je.AJh(fa.a.S$b(this.$)),lb.isSuccess&&(kb=ia.getElapsedSeconds(lb.timeStamp,wa.a.Ta.Jb),this.Cu.Yx=new n(!0,!0),this.yA=new n(lb.value,!0),kb=this.yA.value?604800<kb:86400<kb,this.Ewb=this.NRa(!0)));this.AHh();if("undefined"!==typeof makerstorage&&this.shf)if(this.b6f=E(this.$),T(this.$))I(this.$,"localstorageToken"),this.Cu.Yx=new n(!0,!0),this.yA=new n(!0,!0),this.Ewb=this.NRa(!0);else if((lb=fa.a.ted())&&makerstorage.setStorageEnvironmentOverride(lb),
kb||fa.a.qta)try{this.$.ycb("automateTab",!0),this.Ewb=fa.a.qta?this.Cu.C_c().then(function(){return ec.cha.ovb()}).then(function(){return ec.NRa(!1)}).catch(function(){return ec.NRa(!1)}):this.Cu.C_c().then(function(){return ec.cha.ovb()}).then(function(wb){return ec.q4h(wb)}).then(function(){return ec.NRa(!1)}).catch(function(){return ec.NRa(!1)})}catch(wb){Q.ULS.sendTraceTag(537170314,0,15,"AutomateCommandManager: Something went wrong while trying to check the tab state.  Exception: {0}",wb.message),
this.Ewb=Promise.resolve(!1),this.$.ycb("automateTab",!1)}W.EwaSettings.isChangeGateEnabled("OfficeVSO:5925531_useHasShownAutomateTabPromise")&&this.Ewb?this.Ewb.then(function(wb){ec.zJd(wb);ec.Je.CYh()}):this.zJd(!1)}else Q.ULS.sendTraceTag(537170315,0,15,"IsOfficeScriptingEnabled: Turning off office scripting since fetch api is not supported by current browser."),this.zJd(!1)}function m(kb,lb,ac,Dc,Zb,mc){this.actionName=kb;this.shapeId=lb;this.scriptLink=ac;this.clickId=Dc;this.Cba=Zb;this.buttonText=
mc}function f(kb,lb,ac,Dc){this.vjd=kb;this.vxh=lb;this.Iya=ac;this.bHa=Dc}function w(){this.Yx=null;return this}function n(kb,lb,ac,Dc,Zb){this.value=kb;this.isSuccess=lb;this.timeStamp=void 0===ac?null:ac;this.errorCode=void 0===Dc?"":Dc;this.errorMessage=void 0===Zb?"":Zb}function z(){this.Yx=null}function r(kb,lb){this.lW=null;this.$=kb;this.Je=lb;return this}function v(kb){this.E$=Ia.b(kb)||{};this.shareId=this.shareId||null}function A(kb,lb){this.scripts=kb;this.F4f=lb}function B(kb,lb){this.automateCommandManager=
kb;this.$=lb}function y(kb){return va.a.ud(kb)?la.a.lNe:la.a.kNe}function x(kb){return va.a.ud(kb)?kb.isChromeRtl?la.a.Hqh:la.a.Gqh:la.a.a2a}function C(kb){kb=kb.oa.xa.Na(1);kb.request={HttpMethod:"Get",PathAndQuery:"customXmlParts/byNamespace(namespaceUri=@v)/onlyItem/xml?@v='http://schemas.microsoft.com/office/extensibility/maker/v1.0'",RequestHeaders:null,RequestBody:"",RequestFlags:256};return kb}function G(kb,lb,ac,Dc,Zb){function mc(){function rc(Mc,Pc,Kc){return ya.g(Sa.xa,"ExecuteRichApiRequest",
Dc,La.b(Mc,lb),La.a(Pc,ac),Kc,null,0)}if(Lb.hHa()||0<Sa.xa.P3||0<Sa.Gk.P3)return!1;Cb&&Lb.wo(Cb);ec&&Sa.cs(ec);wb&&Sa.Hz(wb);W.EwaSettings.Zb()?Lb.St(new sa.a(507,0,rc,80)):Lb.St(new ba.a(507,0,rc,16));return!0}var Lb=kb.userOperationManager,Sa=kb.oa,Cb=null,ec=null,wb=null;mc()||(Cb=function(){mc()},ec=function(){mc()},wb=function(){mc()},Lb.Cr(Cb),Sa.Vq(ec),Sa.Ky(wb));return Zb.task}function E(kb){if(T(kb))return W.EwaSettings.getBooleanFeatureGate(fa.a.gCb,!1)?"makerservicelocal":"localstorage";
kb=fa.a.ted();return fa.a.V1e(kb)}function I(kb,lb){T(kb)&&(W.EwaSettings.getBooleanFeatureGate(fa.a.gCb,!1)||makerstorage.useLocalStorage(!0),makerstorage.setStorageEnvironmentOverride("local"));makerstorage.setSessionId(kb.ya.UserSessionId);makerstorage.setUserAccessInfo(new F(lb,null));makerstorage.setFlightValue(makerstorage.restApiVersionFlightKey,"1")}function U(){return W.EwaSettings.getBooleanFeatureGate(fa.a.bvj,!1)}function M(kb,lb){lb.WacTaskPaneInfra=va.a.ud(kb);lb.TaskpanelessRFB=W.EwaSettings.getBooleanFeatureGate(fa.a.U7f,
!1);lb.OfficeScriptsAutomateTask=fa.a.Dsf;lb.DeferAdminCheck=fa.a.qta;lb.SharedScriptsButton=U()}function T(kb){return"TestHost"===kb.ya.DocumentHostInfo.HostTier}function F(kb,lb){this.currentUserMlapiToken=this.currentUserToken=null;this.currentUserToken=kb;this.currentUserMlapiToken=lb}function K(){this.lW=null}function J(kb,lb,ac){var Dc,Zb;this.$=kb;this.oAuthManager=lb;this.Cu=ac;this.mob=new O;this.fse=null!==(Zb=null===(Dc=this.oAuthManager)||void 0===Dc?void 0:Dc.A5a())&&void 0!==Zb?Zb:!1}
function O(){this.token=null;this.timeStamp=0}function N(kb){return ka.call(this,kb)||this}function H(kb,lb){this.automateCommandManager=kb;this.$=lb}u=b(0);var Q=b(15),ca=b(905),X=b(76),Z=b(37);H.prototype.Lc=function(){return!1};H.prototype.executeCommand=function(kb,lb,ac){kb=Z.TaskExtensions.jk();lb=lb.command;switch(lb){case 1845457202:case -1342227603:case -45542983:case 1904816141:case 1606046412:case 1043696663:case 971811139:case -2126202430:case 1623358083:this.$.Fd(2045014907,-1,0,null),
this.automateCommandManager.mri(lb,1904816141===lb?ac[X.a.Nc].toString():null)}return kb};H.prototype.Ac=function(kb,lb){kb=!1;switch(lb.command){case 1845457202:case -45542983:case -1342227603:case 971811139:case -2126202430:case 1623358083:case 1904816141:case 1043696663:case 1606046412:kb=this.$.Aba}return kb};H.prototype.Qc=function(kb,lb,ac){return"PopulateAutomateGalleryMenu"===lb&&this.$.Aba?(this.automateCommandManager.Qc(lb,ac),!0):!1};Object(u.a)(H,"AutomateCommandHandler",null,[403]);var ea=
b(493),ka=ca.a;Rk(N,ka);N.prototype.zd=function(){var kb=this;ea.a(this.$,374,375,this.hb,function(){var lb=kb.$.da.za(352);lb?kb.jd([new H(lb,kb.$)]):Q.ULS.sendTraceTag(537170316,0,15,"AutomateCommandManager should already been initialized before AutomateCommandHandler.")})};N.ka=function(kb){kb.da.Ga(308,new N(kb))};Object(u.a)(N,"AutomateCommandHandlerFactory",ca.a,[]);ca=b(232);var Y=b(7),qa=b(4);Object(u.a)(O,"AuthContext",null,[]);var fa=b(931),ha=b(133),ia=b(111),wa=b(28),Qa=b(1024),S=b(187),
da=b(80);J.prototype.getAuthContext=function(){return this.mob};J.prototype.ovb=function(){function kb(mc,Lb){return(new Promise(function(Sa){window.setTimeout(function(){Sa(mc)},Lb)})).then(function(Sa){Dc.push(Object(Y.a)(new da.a,{name:"Error"+Zb,string:Sa.ErrorMessage}));Dc.push(Object(Y.a)(new da.a,{name:"ErrorCode"+Zb,string:Sa.ErrorCode}));Zb++;return lb.J$f()})}var lb=this,ac=wa.a.Ta.Jb,Dc=[];if(this.oAuthManager)Dc.push(Object(Y.a)(new da.a,{name:"IsAuthSupported",bool:this.fse}));else return this.W8b(Dc,
ac,"need_OAuthManager","No OAuthManager");if(!this.Cu.Yx||!this.Cu.Yx.value)return this.W8b(Dc,ac,"need_license","No License");if(qa.AFrameworkApplication.fa.ra("IsAnonymousUser"))return this.W8b(Dc,ac,"need_user","Anonymous User");if(33E5>Date.now()-this.mob.timeStamp)return Dc.push(Object(Y.a)(new da.a,{name:"UsedCachedToken",bool:!0})),S.a(ha.a.dyd,!0,0,Dc),Promise.resolve(Object(Y.a)(new Qa.a,{IsSuccess:!0,Token:this.mob.token}));Dc.push(Object(Y.a)(new da.a,{name:"UsedCachedToken",bool:!1}));
var Zb=1;return this.J$f().catch(function(mc){return kb(mc,200)}).catch(function(mc){return kb(mc,400)}).then(function(mc){mc.IsSuccess?(lb.mob.token=mc.Token,lb.mob.timeStamp=Date.now()):(Dc.push(Object(Y.a)(new da.a,{name:"Error"+Zb,string:mc.ErrorMessage})),Dc.push(Object(Y.a)(new da.a,{name:"ErrorCode"+Zb,string:mc.ErrorCode})));Dc.push(Object(Y.a)(new da.a,{name:"Attempts",int64:Zb}));Dc.push(Object(Y.a)(new da.a,{name:"Error",string:mc.ErrorMessage}));Dc.push(Object(Y.a)(new da.a,{name:"ErrorCode",
string:mc.ErrorCode}));S.a(ha.a.dyd,mc.IsSuccess,ia.getElapsedMilliseconds(ac,wa.a.Ta.Jb),Dc);return Promise.resolve(mc)}).catch(function(mc){Dc.push(Object(Y.a)(new da.a,{name:"Error"+Zb,string:mc.ErrorMessage}));Dc.push(Object(Y.a)(new da.a,{name:"ErrorCode"+Zb,string:mc.ErrorCode}));Dc.push(Object(Y.a)(new da.a,{name:"Attempts",int64:Zb}));return lb.W8b(Dc,ac,mc.ErrorCode,mc.ErrorMessage)})};J.prototype.W8b=function(kb,lb,ac,Dc){kb.push(Object(Y.a)(new da.a,{name:"Error",string:Dc}));kb.push(Object(Y.a)(new da.a,
{name:"ErrorCode",string:ac}));S.a(ha.a.dyd,!1,ia.getElapsedMilliseconds(lb,wa.a.Ta.Jb),kb);return Promise.resolve(Object(Y.a)(new Qa.a,{IsSuccess:!1,ErrorMessage:Dc,ErrorCode:ac}))};J.prototype.J$f=function(){var kb=this,lb=fa.a.$Yh(),ac=0;lb=this.oAuthManager.EO("Maker",lb).then(function(Dc){if(Dc)return!Dc.IsSuccess&&kb.nxj(Dc)?Promise.reject(Dc):Promise.resolve(Dc);Dc=Object(Y.a)(new Qa.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"});return Promise.reject(Dc)}).catch(function(Dc){var Zb=
new Qa.a;Object.getType(Dc)===Object.getType(Zb)?Zb=Dc:(Zb.ErrorMessage=Dc.toString(),Zb.ErrorCode="exception");return Promise.reject(Zb)});return Promise.race([lb,new Promise(function(Dc,Zb){ac=window.setTimeout(function(){Zb(Object(Y.a)(new Qa.a,{IsSuccess:!1,ErrorCode:"Timeout",ErrorMessage:"Timed out waiting auth token promise"}))},2E4)})]).then(function(Dc){window.clearTimeout(ac);return Dc})};J.prototype.nxj=function(kb){return"interaction_required"===kb.ErrorCode||"InitFailed"===kb.ErrorCode||
"invalid_resource"===kb.ErrorCode||"login_required"===kb.ErrorCode&&kb.ErrorMessage.startsWith("AADSTS500341")?!1:!0};Object(u.a)(J,"AutomateCommandAuth",null,[620]);var xa=b(1025);Object(u.a)(K,"AutomateCommandGalleryBase",null,[]);var ta=b(394),ab=b(30),Na=b(622),Ka=b(1594),la=b(18),Ea=b(53),ra=b(14);b(323);var na=b(653);Object(u.a)(F,"UserInfo",null,[]);var ba=b(564),sa=b(177),ya=b(61),va=b(36),W=b(1),La=b(295);B.prototype.lGh=function(kb){var lb=this.automateCommandManager.Va.mq().eE();if(!U()){var ac=
B.lU(kb,ra.a.instance.ga(2109));this.jUc(ac,fa.a.XSi,this.automateCommandManager.Gj,fa.a.CEi,ra.a.instance.ga(2105),this.automateCommandManager.Va);lb.MenuSectionList.push(ac)}ac=B.lU(kb,ra.a.instance.ga(2110));this.jUc(ac,fa.a.PBi,fa.a.N5?this.automateCommandManager.ht.JSe(this.automateCommandManager.Gj):this.automateCommandManager.Up.JSe(this.automateCommandManager.Gj),fa.a.$rf,ra.a.instance.ga(2106),this.automateCommandManager.Va);lb.MenuSectionList.push(ac);ac=B.lU(kb,ra.a.instance.ga(2111));
this.jUc(ac,fa.a.ijj,this.automateCommandManager.yB,fa.a.$rf,"",this.automateCommandManager.Va);lb.MenuSectionList.push(ac);ac=Object(Y.a)(new ta.a,{Id:fa.a.xoe,ExternalId:fa.a.xoe,Command:"1606046412",LabelText:ra.a.instance.ga(2102),Alt:ra.a.instance.ga(2103),Image16by16:Ea.a.Te(16),Image16by16Class:la.a.KNe,Visible:!0});kb=B.lU(kb,null);kb.ControlsId="myScriptsSection.Controls";if(U()){var Dc=Object(Y.a)(new ta.a,{Id:fa.a.m0f,ExternalId:fa.a.m0f,Command:"1043696663",LabelText:ra.a.instance.ga(2112),
Alt:ra.a.instance.ga(2112),ExternalImageId:"PeopleSharedIcon_16",Visible:!0});kb.ControlList.push(Dc)}kb.ControlList.push(ac);lb.MenuSectionList.push(kb);return lb};B.prototype.jUc=function(kb,lb,ac,Dc,Zb,mc){if(ac&&0<ac.length){lb=mc.qC(lb,1,"Size150by20").I0b();Zb={};mc={};mc.root=B.s0a(320,30);mc.flexContainer={display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"left",alignItems:"left",lineHeight:"normal"};mc.label={margin:"0px 3px"};Zb.galleryButtonInExpanded=mc;lb.GalleryStyle=Zb;
for(Zb=0;Zb<ac.length&&Zb<Dc;Zb++)mc=ac.g4(Zb),lb.GalleryItems.push(B.Y2c(mc.id,mc));kb.ControlList.push(lb)}else ac=Object(Y.a)(new na.a,{Id:lb,ExternalId:lb,LabelText:Zb}),kb.ControlsId=ac.Id+".Controls",kb.ControlList.push(ac)};B.hFh=function(kb){if(kb){var lb=String.format(fa.a.tbi,kb.isShared?fa.a.WLj:fa.a.zkj,Ea.a.Te(16));kb=String.format(fa.a.ubi,ab.a.Ag(kb.name));return String.format(fa.a.sbi,lb,kb)}return""};B.lU=function(kb,lb){return Object(Y.a)(new Na.a,{Id:kb,Title:lb,MenuSectionTitleFocusable:!0,
ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0,ControlList:[]})};B.Y2c=function(kb,lb){var ac=fa.a.ULj,Dc=fa.a.xkj,Zb=fa.a.VLj,mc=fa.a.ykj;return lb?B.aDe(lb.shareId||lb.id,lb.name,lb.isShared&&!U()?ac:Dc,kb,kb,lb.isShared&&!U()?Zb:mc):B.aDe("","","",kb,kb)};B.aDe=function(kb,lb,ac,Dc,Zb,mc){Dc=void 0===Dc?null:Dc;Zb=void 0===Zb?null:Zb;mc=void 0===mc?null:mc;var Lb=void 0===Lb?null:Lb;var Sa={},Cb={};Sa.root=B.s0a(20,20);Cb.root=B.s0a(20,20);return Object(Y.a)(new Ka.a,{Id:kb,ExternalId:Dc||
kb,MenuItemId:Zb||kb,Command:"1904816141",Icon:ac,Image:Ea.a.Te(16),ImageClass:mc,LabelText:lb,FullIconStyle:Sa,PreviewIconStyle:Cb,Alt:Lb||lb})};B.s0a=function(kb,lb){var ac={};ac.width=kb;ac["min-width"]=kb;ac.height=lb;return ac};Object(u.a)(B,"AutomateCommandRenderer",null,[]);A.prototype.jKa=function(kb){for(var lb=0;lb<this.scripts.length;lb++)if(this.scripts[lb].id===kb||this.scripts[lb].shareId===kb)return lb;return-1};A.prototype.sort=function(){this.F4f(this.scripts)};A.prototype.Es=function(kb){return-1===
this.jKa(kb.id)?(this.scripts.push(kb),!0):!1};A.prototype.iUc=function(kb){return-1===this.jKa(kb.id)?(this.scripts=[kb].concat(this.scripts),!0):!1};A.prototype.tBi=function(kb){kb=this.jKa(kb.id);if(-1!==kb){for(var lb=this.scripts[kb].F_a();0<kb;)this.scripts[kb]=this.scripts[kb-1],kb--;this.scripts[0]=lb}};A.prototype.Xeb=function(kb){var lb=this.jKa(kb.id);if(-1!==lb){var ac=this.scripts[lb].shareId;this.scripts[lb]=kb;this.scripts[lb].shareId=ac}};A.prototype.mef=function(kb){var lb=this.jKa(kb.id);
return-1!==lb?kb.name===this.scripts[lb].name:!1};A.prototype.W0a=function(kb){kb=this.jKa(kb);return-1!==kb?(this.scripts.splice(kb,1),!0):!1};A.prototype.clear=function(){this.scripts=[]};A.prototype.getScripts=function(){return this.scripts};A.prototype.jH=function(kb){kb=this.jKa(kb);return-1!==kb?this.scripts[kb]:null};A.prototype.g4=function(kb){return 0<=kb&&this.length>kb?this.scripts[kb]:null};A.prototype.JSe=function(kb){for(var lb=new A([],this.F4f),ac=0;ac<this.scripts.length;ac++){var Dc=
this.scripts[ac];kb.jH(Dc.id)||lb.Es(Dc)}return lb};A.prototype.deb=function(){for(var kb=[],lb=ak(this.scripts),ac=lb.next();!ac.done;ac=lb.next())kb.push(ac.value.jVd());return kb};Af.Object.defineProperties(A.prototype,{length:{configurable:!0,enumerable:!0,get:function(){return this.scripts.length}}});Object(u.a)(A,"ScriptCollection",null,[]);var Ia=b(198);v.prototype.F_a=function(){return new v(this.E$)};v.prototype.jVd=function(){return this.E$};Af.Object.defineProperties(v.prototype,{id:{configurable:!0,
enumerable:!0,get:function(){return this.E$.id}},shareId:{configurable:!0,enumerable:!0,get:function(){return this.E$.shareId},set:function(kb){this.E$.shareId=kb||null}},name:{configurable:!0,enumerable:!0,get:function(){return this.E$.name}},sFe:{configurable:!0,enumerable:!0,get:function(){return this.E$.dateLastPublished}},body:{configurable:!0,enumerable:!0,get:function(){return this.E$.body}},description:{configurable:!0,enumerable:!0,get:function(){return this.E$.description}},wbf:{configurable:!0,
enumerable:!0,get:function(){return this.E$.isCreator}},isShared:{configurable:!0,enumerable:!0,get:function(){return!!this.shareId&&0<this.shareId.length}}});Object(u.a)(v,"ScriptCore",null,[]);var mb=b(41);Rk(r,K);r.prototype.Bfd=function(kb){switch(kb){case "1":case "2":case "3":case "4":case "5":case "6":return this.lW.g4(parseInt(kb,10)-1);default:return this.Je.ht.jH(kb)||this.Je.Up.jH(kb)||this.Je.Gj.jH(kb)||this.Je.yB.jH(kb)}};r.prototype.Mdd=function(kb,lb){var ac=null;if(this.Je.I4a)switch(kb){case "1":case "2":case "3":case "4":case "5":case "6":ac=
this.lW.g4(parseInt(kb,10)-1);break;default:ac=this.lW.jH(kb)}va.a.isReactRibbonEnabled()?lb[xa.a.GalleryButtonProps]=B.Y2c(kb,ac):lb[xa.a.InnerHTML]=B.hFh(ac);lb[xa.a.Alt]=ac?ac.name:""};r.prototype.QN=function(kb){this.lW=this.rGd();this.$.jf();var lb=[];lb.push(Object(Y.a)(new da.a,{name:"Operation",string:kb}));lb.push(Object(Y.a)(new da.a,{name:"HasReadRecentCachedScripts",bool:this.Je.kdc}));lb.push(Object(Y.a)(new da.a,{name:"ReadScriptsDone",bool:this.Je.qid}));lb.push(Object(Y.a)(new da.a,
{name:"ReadSamplesScriptsDone",bool:this.Je.TGb}));lb.push(Object(Y.a)(new da.a,{name:"SamplesScriptCount",int64:this.Je.yB.length}));lb.push(Object(Y.a)(new da.a,{name:"ReadRecentScriptsDone",bool:this.Je.uab}));lb.push(Object(Y.a)(new da.a,{name:"RecentScriptCount",int64:this.Je.ht.length}));lb.push(Object(Y.a)(new da.a,{name:"ReadWorkbookScriptsDone",bool:this.Je.uW}));lb.push(Object(Y.a)(new da.a,{name:"WorkbookScriptCount",int64:this.Je.Gj.length}));S.a(ha.a.Csf,!0,0,lb)};r.prototype.Hhd=function(kb){var lb=
!1,ac="",Dc=new v(kb.scriptMetadata),Zb={Operation:"HandleRefreshRibbonGallery"};Zb.RefreshOperation=kb.operationName;switch(kb.operationName){case fa.a.XMf:kb=this.Ghd(Dc);ac=kb.message;lb=kb.returnValue;break;case fa.a.VMf:kb=this.Ehd(Dc);ac=kb.message;lb=kb.returnValue;break;case fa.a.UMf:kb=this.Dhd(Dc);ac=kb.message;lb=kb.returnValue;break;case fa.a.WMf:kb=this.Fhd(Dc);ac=kb.message;lb=kb.returnValue;break;case fa.a.i7i:kb=this.s3h(Dc),ac=kb.message,lb=kb.returnValue}(Zb.GalleryUpdated=lb)?(Q.ULS.sendTraceTag(537170322,
0,50,"AutomateCommandGallery: Calling UpdateToolbarsAndRibbons. Message: {0}",ac),this.QN("RefreshGallery")):Q.ULS.sendTraceTag(537170321,0,15,"AutomateCommandGallery: Something went wrong while trying to refresh ribbon gallery.  Message: {0}",ac);Zb.Message=ac;Q.ULS.sendTraceTag(537170320,0,50,mb.c(Zb))};r.prototype.rGd=function(){for(var kb=new A([],function(){}),lb=this.Je.Gj?this.Je.Gj.length:0,ac=this.Je.ht?this.Je.ht.length:0,Dc=this.Je.yB?this.Je.yB.length:0,Zb=0,mc=fa.a.NHf,Lb=0;Lb<mc;Lb++)if(Lb<
lb)kb.Es(this.Je.Gj.g4(Lb));else if(Lb-lb+Zb<ac){var Sa=this.Je.ht.g4(Lb-lb+Zb);this.Je.Gj.jH(Sa.id)?(Zb++,Lb--):kb.Es(Sa)}else Lb-lb-ac+Zb<Dc&&kb.Es(this.Je.yB.g4(Lb-lb+Zb-ac));return kb};r.prototype.Ghd=function(kb){if(this.Je.ht.iUc(kb))var lb="";else{lb="";var ac=kb.F_a();this.Je.Gj.Xeb(ac);this.Je.Gj.sort();this.Je.ht.Xeb(kb)}return{returnValue:!0,message:lb}};r.prototype.Ehd=function(kb){this.Je.Gj.W0a(kb.id);return this.Je.ht.W0a(kb.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in recent script collection."}};
r.prototype.Dhd=function(kb){var lb=kb.F_a();lb.shareId=null;this.Je.ht.iUc(lb);return this.Je.Gj.Es(kb)?(this.Je.Gj.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}};r.prototype.Fhd=function(kb){return this.Je.Gj.W0a(kb.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}};r.prototype.s3h=function(kb){var lb=kb.F_a(),ac=!1;this.Je.Gj.mef(lb)&&(this.Je.Gj.Xeb(lb),
this.Je.Gj.sort(),ac=!0);this.Je.ht.iUc(kb)?ac=!0:this.Je.ht.mef(kb)&&(this.Je.ht.Xeb(kb),this.Je.ht.tBi(kb),ac=!0);return{returnValue:ac,message:""}};Object(u.a)(r,"AutomateCommandGallery",K,[]);var fb=b(84);Object(u.a)(z,"AutomateCommandLicensingBase",null,[]);Object(u.a)(n,"BoolResultWrapper",null,[]);Rk(w,z);w.prototype.C_c=function(){var kb=this,lb=wa.a.Ta.Jb,ac=[];return new Promise(function(Dc){fb.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Zb){Zb.isFeatureEnabled("ExcelOfficeScripting",
!1).then(function(mc){ac.push(Object(Y.a)(new da.a,{name:"IsLicensed",bool:mc}));S.a(ha.a.ysf,!0,ia.getElapsedMilliseconds(lb,wa.a.Ta.Jb),ac);kb.Yx=new n(mc,!0);Dc(mc)}).catch(function(mc){ac.push(Object(Y.a)(new da.a,{name:"IsLicensed",bool:!1}));ac.push(Object(Y.a)(new da.a,{name:"Error",string:mc.toString()}));ac.push(Object(Y.a)(new da.a,{name:"ErrorCode",string:"exception"}));S.a(ha.a.ysf,!1,ia.getElapsedMilliseconds(lb,wa.a.Ta.Jb),ac);kb.Yx=new n(!1,!1,void 0,"exception",mc.toString());Dc(!1)})})})};
Object(u.a)(w,"AutomateCommandLicensing",z,[]);var Ma=b(1507),Hb=b(1505),Kb=b(1504),Ub=b(1506),gb=b(1595),Db=b(25),Va=b(178),yb=b(635),qb=b(324),dc=b(5);Object(u.a)(f,"LaunchSDXParams",null,[]);Object(u.a)(m,"RunfromButtonParameters",null,[]);var bb=b(168),db=b(54),wc=b(998),nb=b(50),zb=b(46),ma=b(167);l.prototype.NRa=function(kb){var lb=qa.AFrameworkApplication.fa.ra("IsO365CommercialHost"),ac="",Dc="",Zb=!1,mc,Lb=(mc=this.Cu.Yx&&this.Cu.Yx.isSuccess)&&this.Cu.Yx.value;mc=fa.a.qta?mc:!(Lb&&(!this.yA||
!this.yA.isSuccess));this.Cu.Yx&&!this.Cu.Yx.isSuccess?(Dc=this.Cu.Yx.errorCode,ac=this.Cu.Yx.errorMessage):this.yA&&!this.yA.isSuccess&&(Dc=this.yA.errorCode,ac=this.yA.errorMessage);Lb=[];Lb.push(Object(Y.a)(new da.a,{name:"IsScriptingEnabled",bool:this.Cba}));Lb.push(Object(Y.a)(new da.a,{name:"IsValidHost",bool:lb}));Lb.push(Object(Y.a)(new da.a,{name:"IsUserLicensed",bool:this.Cu.Yx?this.Cu.Yx.value:!1}));fa.a.qta||Lb.push(Object(Y.a)(new da.a,{name:"IsAdminSwitchOn",bool:this.yA?this.yA.value:
!1}));Lb.push(Object(Y.a)(new da.a,{name:"ShowTab",bool:this.Cba}));fa.a.qta||Lb.push(Object(Y.a)(new da.a,{name:"ServiceChecked",bool:!kb}));this.Cba?va.a.Qwa(this.$)&&(kb=bb.a(this.$),(null===kb||void 0===kb?0:kb.Ql)?(Lb.push(Object(Y.a)(new da.a,{name:"RibbonType",string:"React"})),kb.Ql.ZAj(dc.a.PGb),kb.Ql.AOd(["AutomateAutomateTask"],!fa.a.Dsf),W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",
!1)&&(Zb=!0)):(Dc="ribbon_manager_error",ac="The RibbonManager or RibbonUser is null")):this.f6h();Lb.push(Object(Y.a)(new da.a,{name:"Error",string:ac}));Lb.push(Object(Y.a)(new da.a,{name:"ErrorCode",string:Dc}));S.a(ha.a.qFi,mc,ia.getElapsedMilliseconds(this.initTime,wa.a.Ta.Jb),Lb);this.$.ycb("automateTab",!1);return Promise.resolve(Zb)};l.prototype.Qc=function(kb,lb){if(!lb)return!1;lb.MenuItems=this.$Mg.lGh(lb.MenuId);return!0};l.prototype.PYi=function(){var kb=this;this.Bwa&&(fa.a.N5?this.Je.xLf(this.cC).continueWith(function(lb){lb.result&&
kb.cC.QN(fa.a.FPa)}):this.Je.L5i(this.cC));T(this.$)?this.f1e(Object(Y.a)(new Qa.a,{IsSuccess:!0,Token:"FakeToken"})):this.cha.ovb().then(function(lb){kb.f1e(lb)})};l.prototype.Mdd=function(kb,lb,ac){if(fa.a.N5)this.cC.Mdd(kb,lb,ac);else{ac=null;if(this.Je.I4a)switch(kb){case "1":case "2":case "3":case "4":case "5":case "6":ac=this.cC.lW.g4(parseInt(kb,10)-1);break;default:ac=this.cC.lW.jH(kb)}lb[xa.a.GalleryButtonProps]=B.Y2c(kb,ac);lb[xa.a.Alt]=ac?ac.name:""}};l.prototype.Hhd=function(kb){if(fa.a.N5)this.cC.Hhd(kb);
else{var lb=!1,ac="",Dc=new v(kb.scriptMetadata),Zb={Operation:"HandleRefreshRibbonGallery"};Zb.RefreshOperation=kb.operationName;switch(kb.operationName){case fa.a.XMf:kb=this.Ghd(Dc);ac=kb.message;lb=kb.returnValue;break;case fa.a.VMf:kb=this.Ehd(Dc);ac=kb.message;lb=kb.returnValue;break;case fa.a.UMf:kb=this.Dhd(Dc);ac=kb.message;lb=kb.returnValue;break;case fa.a.WMf:kb=this.Fhd(Dc),ac=kb.message,lb=kb.returnValue}(Zb.GalleryUpdated=lb)?(Q.ULS.sendTraceTag(537170313,0,50,"AutomateCommandManager: Calling UpdateToolbarsAndRibbons. Message: {0}",
ac),this.QN("RefreshGallery")):Q.ULS.sendTraceTag(537170312,0,15,"AutomateCommandManager: Something went wrong while trying to refresh ribbon gallery.  Message: {0}",ac);Zb.Message=ac;Q.ULS.sendTraceTag(537170311,0,50,mb.c(Zb))}};l.prototype.N3h=function(kb,lb,ac,Dc){if(W.EwaSettings.isChangeGateEnabled("OfficeVSO:6254340_ExitCellEditModeOnRFBClick")||this.$.kq(null,!1,1023))kb=new m(fa.a.jUf,kb,lb,ac,this.Cba,Dc),this.rob.mwb(kb)};l.prototype.p5e=function(kb,lb,ac){kb=new m(fa.a.gWj,kb,lb,ac,this.Cba);
this.rob.mwb(kb)};l.prototype.u1h=function(kb){this.rob.fhd(fa.a.nBj,kb)};l.prototype.t1h=function(kb){this.rob.fhd(fa.a.z1g,kb)};l.prototype.v1h=function(kb){this.rob.fhd(fa.a.rFj,kb)};l.prototype.mri=function(kb,lb){var ac=nb.b().fi(kb),Dc=[];Dc.push(Object(Y.a)(new da.a,{name:"SessionId",string:this.$.ya.UserSessionId}));Dc.push(Object(Y.a)(new da.a,{name:"MenuItemId",string:lb}));Dc.push(Object(Y.a)(new da.a,{name:"WorkbookScriptCount",int64:this.Gj.length}));Dc.push(Object(Y.a)(new da.a,{name:"PublishedScriptCount",
int64:this.Up.length}));Dc.push(Object(Y.a)(new da.a,{name:"RecentScriptCount",int64:this.ht.length}));Dc.push(Object(Y.a)(new da.a,{name:"Command",string:ac}));lb=this.rWh(kb,lb);if(ac=this.QQh(kb,ac,lb))Dc.push(Object(Y.a)(new da.a,{name:fa.a.r$,string:ac.Iya.nq[fa.a.r$]})),Ma.a.instance.bNa(ac.vxh,"Taskpane",ac.bHa,ac.vjd,ac.Iya),1904816141===kb&&(Dc.push(Object(Y.a)(new da.a,{name:"ScriptId",string:lb.id})),Dc.push(Object(Y.a)(new da.a,{name:"ShareId",string:lb.shareId})),Dc.push(Object(Y.a)(new da.a,
{name:"IsPreviewGallery",bool:!!this.cC.lW.jH(lb.id)})),Dc.push(Object(Y.a)(new da.a,{name:"IsOwner",bool:lb.wbf||!!this.Up.jH(lb.id)})),this.$.jf());S.a(ha.a.nFi,void 0,void 0,Dc)};l.prototype.QQh=function(kb,lb,ac){var Dc=null,Zb=fa.a.mu,mc=new Hb.a(fa.a.M7e,fa.a.YTe,fa.a.locale),Lb=new Kb.a(fa.a.solutionId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,fa.a.kMd),Sa=new Ub.a;Sa.nq.AdminPolicyForFeedback=mb.c(this.RFa);Sa.nq.DocumentHostInfo=db.a.xc(this.$.ya.DocumentHostInfo);Sa.nq.CodeEditorUrl=fa.a.v3a(this.$);
Sa.nq.MakerTestService=W.EwaSettings.getBooleanFeatureGate(fa.a.gCb,!1);Sa.nq[fa.a.BTf]=fa.a.d3a(this.$);Sa.nq.StorageModePreference=this.b6f||"";Sa.nq.Source="Ribbon";Sa.nq[fa.a.T7f]=db.a.xc(Zb);Sa.nq[fa.a.Zse]=this.$.xsf?"true":"false";Sa.nq[fa.a.r$]=Va.a.create().toString();var Cb=x(this.$),ec=y(this.$);Sa.optionalProperties.HeaderCssClass=Cb;Sa.optionalProperties.TitleCssClass=ec;Sa.nq[fa.a.H6e]=Cb;Sa.nq[fa.a.a9f]=ec;Cb={};Cb.ribbonCommand=lb;Cb[fa.a.$5f]=this.cha.getAuthContext();Cb[fa.a.aab]=
this.Je.wLf?this.Up.deb():null;Cb[fa.a.ZOb]=this.Je.hGd?this.Gj.deb():null;fa.a.N5&&(Cb[fa.a.FPa]=this.Je.fGd?this.ht.deb():null);Sa.nq[fa.a.W$e]=db.a.xc(Cb);lb={};M(this.$,lb);Sa.nq[fa.a.mTe]=db.a.xc(lb);switch(kb){case -45542983:Sa.nq.Script="";Sa.nq.Destination="Editor";Sa.nq.IsOwner=!0;Sa.optionalProperties[gb.a.Rk]=ra.a.instance.ga(2098);Sa.optionalProperties[gb.a.taskPaneWidth]=Zb;Sa.optionalProperties[gb.a.sourceLocationOverrideResourceId]=fa.a.v3a(this.$);Dc=fa.a.D2b;break;case -1342227603:Sa.optionalProperties[gb.a.Rk]=
ra.a.instance.ga(2100);Sa.optionalProperties[gb.a.taskPaneWidth]=Zb;Sa.optionalProperties[gb.a.sourceLocationOverrideResourceId]=fa.a.o0e(this.$);break;case 971811139:case 1606046412:Sa.nq.Script="";Sa.nq.Destination="BackStage";Sa.nq.IsOwner=!0;Sa.optionalProperties[gb.a.Rk]=ra.a.instance.ga(2098);Sa.optionalProperties[gb.a.taskPaneWidth]=Zb;Sa.optionalProperties[gb.a.sourceLocationOverrideResourceId]=fa.a.v3a(this.$);Dc=fa.a.D2b;break;case 1043696663:Sa.nq.Script="";Sa.nq.Destination="BackStage_Workbook";
Sa.optionalProperties[gb.a.Rk]=ra.a.instance.ga(2098);Sa.optionalProperties[gb.a.taskPaneWidth]=Zb;Sa.optionalProperties[gb.a.sourceLocationOverrideResourceId]=fa.a.v3a(this.$);Dc=fa.a.D2b;break;case 1845457202:Sa.optionalProperties[gb.a.Rk]=ra.a.instance.ga(2099);Sa.optionalProperties[gb.a.taskPaneWidth]=Zb;Sa.optionalProperties[gb.a.sourceLocationOverrideResourceId]=fa.a.G0e(this.$);Dc=fa.a.Dkj;break;case -2126202430:case 1623358083:case 1904816141:if(ac)Sa.nq.Script=db.a.xc(ac.jVd()),Sa.nq.Destination=
"Details",Sa.nq.IsOwner=ac.wbf||!!this.Up.jH(ac.id),Sa.optionalProperties[gb.a.Rk]=ra.a.instance.ga(2098),Sa.optionalProperties[gb.a.taskPaneWidth]=Zb,Sa.optionalProperties[gb.a.sourceLocationOverrideResourceId]=fa.a.v3a(this.$),Dc=fa.a.D2b;else return null;break;default:return null}return new f(mc,Lb,Sa,Dc)};l.prototype.rWh=function(kb,lb){switch(kb){case -2126202430:kb=this.Je.HMb.jH(fa.a.f8f);break;case 1623358083:kb=this.Je.HMb.jH(fa.a.g8f);break;default:kb=lb?this.Bfd(lb):null}return kb};l.prototype.AHh=
function(){var kb=this;fb.a.instance.Tb("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(function(lb){kb.RFa.FeedbackEnabled=!0;kb.RFa.ScreenshotEnabled=!0;kb.RFa.EmailEnabled=!0;lb.NJ("Enabled").then(function(ac){kb.RFa.FeedbackEnabled=ac},function(){});lb.NJ("IncludeScreenshot").then(function(ac){kb.RFa.ScreenshotEnabled=ac},function(){});lb.NJ("IncludeEmail").then(function(ac){kb.RFa.EmailEnabled=ac},function(){})})};l.prototype.q4h=function(kb){var lb=this,ac=wa.a.Ta.Jb,
Dc=[];if(!kb||!kb.IsSuccess){var Zb=kb?kb.ErrorCode:"need_token";kb=kb?kb.ErrorMessage:"No Access Token";Dc.push(Object(Y.a)(new da.a,{name:"ServiceChecked",bool:!1}));Dc.push(Object(Y.a)(new da.a,{name:"Error",string:kb}));Dc.push(Object(Y.a)(new da.a,{name:"ErrorCode",string:Zb}));S.a(ha.a.byd,!1,ia.getElapsedMilliseconds(ac,wa.a.Ta.Jb),Dc);this.yA=new n(!1,!1,void 0,Zb,kb);return Promise.resolve(!1)}Dc.push(Object(Y.a)(new da.a,{name:"ServiceChecked",bool:!0}));I(this.$,kb.Token);return makerstorage.getUserPermissions(this.$.ya.UserSessionId).then(function(mc){lb.yA=
new n(mc.OfficeScriptingEnabled,!0);lb.Je.QSg(fa.a.S$b(lb.$),mc.OfficeScriptingEnabled);Dc.push(Object(Y.a)(new da.a,{name:"IsEnabled",bool:lb.yA.value}));S.a(ha.a.byd,!0,ia.getElapsedMilliseconds(ac,wa.a.Ta.Jb),Dc);return Promise.resolve(lb.yA.value)}).catch(function(mc){Object.getType(mc)===makerstorage.StorageServiceError?(Dc.push(Object(Y.a)(new da.a,{name:"Error",string:mc.message})),Dc.push(Object(Y.a)(new da.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",mc.errorCode.toString(),
mc.status.toString())}))):(Dc.push(Object(Y.a)(new da.a,{name:"Error",string:mc.toString()})),Dc.push(Object(Y.a)(new da.a,{name:"ErrorCode",string:"exception"})));S.a(ha.a.byd,!1,ia.getElapsedMilliseconds(ac,wa.a.Ta.Jb),Dc);lb.yA=new n(!1,!1,void 0,"exception",mc.toString());return Promise.resolve(!1)})};l.prototype.f1e=function(kb){var lb=this;this.Je.lWh(this.cC);fa.a.N5?this.Je.eVh(kb,this.cC,this.cache):this.CUh(kb);U()||this.Je.K5i(function(ac){lb.Je.$Wh(ac,kb,lb.cC)},this.cC)};l.prototype.CUh=
function(kb){var lb=this,ac=wa.a.Ta.Jb,Dc=[];if(kb&&kb.IsSuccess){I(this.$,kb.Token);var Zb=yb.a.create().toString();Dc.push(Object(Y.a)(new da.a,{name:"CorrelationId",string:Zb}));makerstorage.getScripts(Zb).then(function(mc){Dc.push(Object(Y.a)(new da.a,{name:"HasReadCachedScripts",bool:lb.Je.Cwb}));lb.Up.clear();mc=ak(mc);for(var Lb=mc.next();!Lb.done;Lb=mc.next())lb.Up.Es(new v(Lb.value));lb.Up.sort();lb.Je.wLf=!0;lb.Je.sab=!0;lb.Bwa&&(mc=db.a.xc(lb.Up.deb()),lb.indexedDB.Rbb(new wc.a(fa.a.aab,
mc)));Dc.push(Object(Y.a)(new da.a,{name:"ScriptCount",int64:lb.Up.length}));S.a(ha.a.xDb,!0,ia.getElapsedMilliseconds(ac,wa.a.Ta.Jb),Dc);lb.QN(fa.a.aab)}).catch(function(mc){Object.getType(mc)===makerstorage.StorageServiceError?(Dc.push(Object(Y.a)(new da.a,{name:"Error",string:mc.message})),Dc.push(Object(Y.a)(new da.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",mc.errorCode.toString(),mc.status.toString())})),17===mc.errorCode&&lb.cache.QHd(fa.a.S$b(lb.$))):(Dc.push(Object(Y.a)(new da.a,
{name:"Error",string:mc.toString()})),Dc.push(Object(Y.a)(new da.a,{name:"ErrorCode",string:"exception"})));S.a(ha.a.xDb,!1,ia.getElapsedMilliseconds(ac,wa.a.Ta.Jb),Dc);lb.Je.sab=!0;lb.QN(fa.a.aab)})}else Zb=kb?kb.ErrorCode:"need_token",kb=kb?kb.ErrorMessage:"No Access Token",Dc.push(Object(Y.a)(new da.a,{name:"ServiceChecked",bool:!1})),Dc.push(Object(Y.a)(new da.a,{name:"Error",string:kb})),Dc.push(Object(Y.a)(new da.a,{name:"ErrorCode",string:Zb})),S.a(ha.a.xDb,!1,ia.getElapsedMilliseconds(ac,
wa.a.Ta.Jb),Dc),this.Je.sab=!0,this.QN(fa.a.aab)};l.prototype.Bfd=function(kb){if(fa.a.N5)return this.cC.Bfd(kb);switch(kb){case "1":case "2":case "3":case "4":case "5":case "6":return this.cC.lW.g4(parseInt(kb,10)-1);default:return this.Up.jH(kb)||this.Gj.jH(kb)||this.yB.jH(kb)}};l.prototype.Ghd=function(kb){if(this.Up.Es(kb)){this.Up.sort();var lb=""}else{lb="";var ac=kb.F_a();this.Gj.Xeb(ac);this.Gj.sort();this.Up.Xeb(kb);this.Up.sort()}return{returnValue:!0,message:lb}};l.prototype.Ehd=function(kb){this.Gj.W0a(kb.id);
return this.Up.W0a(kb.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in published collection."}};l.prototype.Dhd=function(kb){var lb=kb.F_a();lb.shareId=null;this.Up.Es(lb)&&this.Up.sort();return this.Gj.Es(kb)?(this.Gj.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}};l.prototype.Fhd=function(kb){return this.Gj.W0a(kb.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}};
l.prototype.QN=function(kb){if(fa.a.N5)this.cC.QN(kb);else{this.rGd();this.$.jf();var lb=[];lb.push(Object(Y.a)(new da.a,{name:"Operation",string:kb}));lb.push(Object(Y.a)(new da.a,{name:"HasReadCachedScripts",bool:this.Je.Cwb}));lb.push(Object(Y.a)(new da.a,{name:"ReadScriptsDone",bool:this.Je.qid}));lb.push(Object(Y.a)(new da.a,{name:"ReadSamplesScriptsDone",bool:this.Je.TGb}));lb.push(Object(Y.a)(new da.a,{name:"SamplesScriptCount",int64:this.yB.length}));lb.push(Object(Y.a)(new da.a,{name:"ReadPublishedScriptsDone",
bool:this.Je.sab}));lb.push(Object(Y.a)(new da.a,{name:"PublishedScriptCount",int64:this.Up.length}));lb.push(Object(Y.a)(new da.a,{name:"ReadWorkbookScriptsDone",bool:this.Je.uW}));lb.push(Object(Y.a)(new da.a,{name:"WorkbookScriptCount",int64:this.Gj.length}));S.a(ha.a.Csf,!0,0,lb)}};l.prototype.rGd=function(){this.cC.lW=new A([],function(){});for(var kb=this.Gj?this.Gj.length:0,lb=this.Up?this.Up.length:0,ac=this.yB?this.yB.length:0,Dc=0,Zb=fa.a.NHf,mc=0;mc<Zb;mc++)if(mc<kb)this.cC.lW.Es(this.Gj.g4(mc));
else if(mc-kb+Dc<lb){var Lb=this.Up.g4(mc-kb+Dc);this.Gj.jH(Lb.id)?(Dc++,mc--):this.cC.lW.Es(Lb)}else mc-kb-lb+Dc<ac&&this.cC.lW.Es(this.yB.g4(mc-kb+Dc-lb))};l.prototype.zJd=function(kb){W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&(kb?(zb.PageLoadTrackingInfo.instance.S6(dc.a.YN,["automateTab"]),zb.PageLoadTrackingInfo.instance.EW(dc.a.YN,["automateTab"]),
zb.PageLoadTrackingInfo.instance.DW(dc.a.YN,["automateTab"])):zb.PageLoadTrackingInfo.instance.lda(dc.a.YN,["automateTab"]))};l.prototype.f6h=function(){W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CacheAutomateVisibility",!1)&&ma.c()&&appChrome.api.dispatch(appChrome.actions.deactivateRibbonTab(dc.a.PGb))};Af.Object.defineProperties(l.prototype,{Up:{configurable:!0,enumerable:!0,get:function(){return this.Je.Up}},Gj:{configurable:!0,enumerable:!0,get:function(){return U()?new A([],
function(){}):this.Je.Gj}},yB:{configurable:!0,enumerable:!0,get:function(){return this.Je.yB}},ht:{configurable:!0,enumerable:!0,get:function(){return this.Je.ht}},Va:{configurable:!0,enumerable:!0,get:function(){return this.xPc}},I4a:{configurable:!0,enumerable:!0,get:function(){return this.Je.I4a}},initTime:{configurable:!0,enumerable:!0,get:function(){return this.dqg}},Cba:{configurable:!0,enumerable:!0,get:function(){var kb=!!this.Cu.Yx&&this.Cu.Yx.isSuccess&&this.Cu.Yx.value,lb=!!this.yA&&!this.yA.isSuccess,
ac=!!this.yA&&this.Cu.Yx.isSuccess&&this.yA.value;lb=fa.a.qta||ac||lb&&!Db.a.Dka(11);return this.shf&&kb&&lb}},shf:{configurable:!0,enumerable:!0,get:function(){var kb="TestHost"===this.$.ya.DocumentHostInfo.HostTier,lb=qa.AFrameworkApplication.fa.Wa("UserPrincipalName");lb=!qa.AFrameworkApplication.fa.ra("IsAnonymousUser")&&!!lb&&!lb.includes("ext#")&&!lb.includes("guest#");return!Db.a.vka&&(kb||this.cha.fse&&lb)}}});Object(u.a)(l,"AutomateCommandManager",null,[618]);var P=b(1562),oa=b(1509),Ja=
b(246),$a=b(1169),Ta=b(51),pa=b(105),Da=b(21),rb=b(1171);k.prototype.mwb=function(kb){if(kb.Cba){var lb=[];lb.push(Object(Y.a)(new da.a,{name:"isSharedRuntimeInstanceInitialized",bool:this.N6a}));lb.push(Object(Y.a)(new da.a,{name:"actionName",string:kb.actionName}));lb.push(Object(Y.a)(new da.a,{name:fa.a.r$,string:kb.clickId.toString()}));this.N6a?this.FWf(kb):this.e2h(kb);S.a(ha.a.oFi,void 0,void 0,lb)}};k.prototype.fhd=function(kb,lb){var ac={};ac[fa.a.r$]=lb;this.UMd(kb,ac)};k.prototype.uuj=
function(){this.u1f()?this.ZGf():Da.g(this.$).Ea.$le(this.Y8a)};k.prototype.u1f=function(){if(this.N6a||T(this.$))return!1;var kb=pa.a(this.$);return Da.g(this.$).Ea.YZb&&kb.uei()};k.prototype.ZGf=function(){var kb=this;this.Cu.Yx?this.Cu.Yx.value&&this.cha.ovb():this.Cu.C_c().then(function(lb){lb&&kb.cha.ovb()});S.a(ha.a.jFi)};k.prototype.Imj=function(){var kb=Va.a.create().toString(),lb={};M(this.$,lb);var ac={};ac[fa.a.$5f]=this.cha.getAuthContext();var Dc={};Dc[fa.a.mTe]=db.a.xc(lb);Dc[fa.a.W$e]=
db.a.xc(ac);Dc[fa.a.chh]=db.a.xc(this.$.ya.DocumentHostInfo);Dc[fa.a.yFj]=E(this.$);Dc[fa.a.T7f]=db.a.xc(fa.a.mu);Dc[fa.a.Zse]=this.$.xsf?"true":"false";Dc[fa.a.BTf]=fa.a.d3a(this.$);Dc[fa.a.H6e]=x(this.$);Dc[fa.a.a9f]=y(this.$);Dc[fa.a.r$]=kb;lb=[];lb.push(Object(Y.a)(new da.a,{name:fa.a.r$,string:kb}));S.a(ha.a.mFi,void 0,void 0,lb);this.UMd(fa.a.Z9h,Dc)};k.prototype.e2h=function(kb){var lb=this;this.Pyj(kb);T(this.$)&&I(this.$,"localstorage");Z.TaskExtensions.Ba(Ta.GetServiceTaskFactory.Ra(this.$.da,
374,375,1),function(ac){lb.Vsi(ac.result).continueWith(function(){lb.Hmj(kb)});lb.N6a=!0},this.$.la,3)};k.prototype.Vsi=function(kb){var lb={};lb.SolutionId=fa.a.solutionId;lb.Version=fa.a.kMd;lb.StoreType=OSF.StoreType.Sdx;lb.StoreId=OSF.StoreType.Sdx;lb.AssetId=fa.a.solutionId;lb.AssetStoreId=OSF.StoreType.Sdx;lb.TargetType=1;lb.SharedRuntimeId=fa.a.Gvb(this.$);lb.SourceLocationOverrideResourceId=fa.a.Gvb(this.$);lb.IsToBePersisted=!1;var ac=new P.a;ac.Rk=ra.a.instance.ga(2122);ac.taskPaneWidth=
fa.a.mu;var Dc=new $a.a;Dc.ceb=y(this.$);Dc.s4=x(this.$);return kb.ULd(lb,ac,void 0,void 0,Dc)};k.prototype.Hmj=function(kb){this.Imj();Ja.a(this.$)&&Ja.a(this.$).qme(this.sIi);this.FWf(kb)};k.prototype.FWf=function(kb){var lb={};lb[fa.a.Uij]=kb.shapeId;lb[fa.a.Tij]=kb.scriptLink;lb[fa.a.r$]=kb.clickId.toString();lb[fa.a.Sij]=kb.buttonText;this.UMd(kb.actionName,lb)};k.prototype.UMd=function(kb,lb){var ac=new Kb.a(fa.a.solutionId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,fa.a.kMd),Dc=new Hb.a(fa.a.M7e,
fa.a.YTe,this.$.ya.UICultureTag),Zb=new Ub.a;Zb.optionalProperties[gb.a.Rk]=ra.a.instance.ga(2122);Zb.optionalProperties[gb.a.sourceLocationOverrideResourceId]=fa.a.Gvb(this.$);Zb.optionalProperties[gb.a.TSc]=lb;Zb.optionalProperties[gb.a.taskPaneWidth]=fa.a.mu;Ma.a.instance.bNa(ac,oa.a.action,kb,Dc,Zb)};k.prototype.Pyj=function(kb){W.EwaSettings.getBooleanFeatureGate(fa.a.U7f,!1)&&kb.actionName===fa.a.jUf&&(kb=new rb.a(kb.scriptLink,"initializing",kb.clickId.toString(),kb.buttonText),this.businessBarManager.ele(64,
kb))};Object(u.a)(k,"AutomateCommandRunFromButton",null,[617]);var Ab=b(162),ob=b(22);e.hDj=function(kb){kb.sort(function(lb,ac){return ac.sFe-lb.sFe})};e.byc=function(kb){kb.sort(function(lb,ac){return ob.a.compare(lb.name,ac.name,!0)})};e.PXh=function(kb){var lb;var ac=lb=null;if(kb){var Dc=kb.indexOf(":");if(-1!==Dc)return lb=kb.substr(0,Dc),ac=kb.substr(Dc+1),{returnValue:!0,a6f:lb,shareId:ac}}return{returnValue:!1,a6f:lb,shareId:ac}};e.LWh=function(kb,lb){var ac={};ac[fa.a.ngg]=encodeURIComponent(kb.workbookContext.WorkbookFileName);
ac[fa.a.LVf]=lb.deb();return mb.c(ac)};e.ALf=function(kb,lb){return Z.TaskExtensions.Qha(lb.E3a(fa.a.ZOb),function(ac){ac=ac.result;if(""!==ac){ac=mb.b(ac);var Dc=ac[fa.a.LVf];if(ac[fa.a.ngg]===encodeURIComponent(kb.workbookContext.WorkbookFileName)){ac=new A([],function(mc){e.byc(mc)});Dc=ak(Dc);for(var Zb=Dc.next();!Zb.done;Zb=Dc.next())ac.Es(new v(Zb.value));ac.sort();return ac}}},kb.la,3)};Af.Object.defineProperties(e.prototype,{I4a:{configurable:!0,enumerable:!0,get:function(){var kb=fa.a.N5?
this.kdc:this.Cwb;return this.TGb||kb||this.qid}},qid:{configurable:!0,enumerable:!0,get:function(){return(fa.a.N5?this.uab:this.sab)&&this.uW&&this.TGb}}});Object(u.a)(e,"AutomateCommandStorageBase",null,[]);var sb=b(121),Pb=b(100);Rk(d,e);d.prototype.QSg=function(kb,lb){if(this.cache.Cf()){var ac={};ac.TimeStamp=wa.a.Ta.Jb;ac.IsEnabled=lb;this.cache.fOd(kb,db.a.xc(ac))}};d.prototype.AJh=function(kb){var lb=!1,ac=!1,Dc=null;this.cache.Cf()&&(kb=mb.b(this.cache.jvb(kb)))&&(ac=kb.IsEnabled,Dc=new Date(kb.TimeStamp),
lb=!0);return new n(ac,lb,Dc)};d.prototype.xLf=function(kb){var lb=this,ac=wa.a.Ta.Jb,Dc=[];return Z.TaskExtensions.Qha(this.indexedDB.E3a(fa.a.FPa),function(Zb){var mc=!lb.uab||!lb.ht.length;Zb=Zb.result;Dc.push(Object(Y.a)(new da.a,{name:"ExistingScriptCount",int64:lb.ht.length}));if(""!==Zb&&(Zb=mb.b(Zb),Dc.push(Object(Y.a)(new da.a,{name:"CachedScriptCount",int64:Zb.length})),mc)){for(var Lb=ak(Zb),Sa=Lb.next();!Sa.done;Sa=Lb.next())lb.ht.Es(new v(Sa.value));lb.kdc=!0;lb.fGd=0<Zb.length;S.a(ha.a.Asf,
mc,ia.getElapsedMilliseconds(ac,wa.a.Ta.Jb),Dc);lb.PGd(kb);return!0}S.a(ha.a.Asf,mc,ia.getElapsedMilliseconds(ac,wa.a.Ta.Jb),Dc);return!1},this.$.la,3)};d.prototype.L5i=function(kb){W.EwaSettings.getBooleanFeatureGate(fa.a.jXc,!1)&&!U()&&this.R5i(kb);fa.a.N5?this.xLf(kb):this.J5i(kb)};d.prototype.eVh=function(kb,lb,ac){var Dc=this,Zb=wa.a.Ta.Jb,mc=[];if(kb&&kb.IsSuccess){I(this.$,kb.Token);var Lb=yb.a.create().toString();mc.push(Object(Y.a)(new da.a,{name:"CorrelationId",string:Lb}));makerstorage.getRecentScripts(Lb).then(function(Sa){mc.push(Object(Y.a)(new da.a,
{name:"HasReadCachedScripts",bool:Dc.kdc}));Dc.ht.clear();Sa=ak(Sa);for(var Cb=Sa.next();!Cb.done;Cb=Sa.next())Dc.ht.Es(new v(Cb.value));Dc.fGd=!0;Dc.uab=!0;Dc.indexedDB.Cf()&&(Sa=db.a.xc(Dc.ht.deb()),Dc.indexedDB.Rbb(new wc.a(fa.a.FPa,Sa)));mc.push(Object(Y.a)(new da.a,{name:"ScriptCount",int64:Dc.ht.length}));S.a(ha.a.xDb,!0,ia.getElapsedMilliseconds(Zb,wa.a.Ta.Jb),mc);lb.QN(fa.a.FPa)}).catch(function(Sa){Object.getType(Sa)===makerstorage.StorageServiceError?(mc.push(Object(Y.a)(new da.a,{name:"Error",
string:Sa.message})),mc.push(Object(Y.a)(new da.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",Sa.errorCode.toString(),Sa.status.toString())})),17===Sa.errorCode&&ac.QHd(fa.a.S$b(Dc.$))):(mc.push(Object(Y.a)(new da.a,{name:"Error",string:Sa.toString()})),mc.push(Object(Y.a)(new da.a,{name:"ErrorCode",string:"exception"})));S.a(ha.a.kFi,!1,ia.getElapsedMilliseconds(Zb,wa.a.Ta.Jb),mc);Dc.uab=!0;lb.QN(fa.a.FPa)})}else Lb=kb?kb.ErrorCode:"need_token",kb=kb?kb.ErrorMessage:"No Access Token",
mc.push(Object(Y.a)(new da.a,{name:"ServiceChecked",bool:!1})),mc.push(Object(Y.a)(new da.a,{name:"Error",string:kb})),mc.push(Object(Y.a)(new da.a,{name:"ErrorCode",string:Lb})),S.a(ha.a.xDb,!1,ia.getElapsedMilliseconds(Zb,wa.a.Ta.Jb),mc),this.uab=!0,lb.QN(fa.a.FPa)};d.prototype.K5i=function(kb,lb){var ac=this,Dc=new Ab.a,Zb=C(this.$);G(this.$,function(mc){if((mc=mc.Result)&&200===mc.ResponseStatusCode)mc=mc.ResponseBody.join(""),mc=JSON.parse(mc),kb(ac.SWi(mc.value)),Dc.setResult(!0);else{mc=mc?
"RichApi_"+mc.ResponseStatusCode:"RichApiError";var Lb=[];Lb.push(Object(Y.a)(new da.a,{name:"Error",string:"Failed to read shared script ids from document"}));Lb.push(Object(Y.a)(new da.a,{name:"ErrorCode",string:mc}));ac.uW=!0;ac.u_a(lb,wa.a.Ta.Jb,0,Lb);Dc.setResult(!1)}},function(mc){mc=sb.a.Of(mc.data);Q.ULS.sendTraceTag(537170309,0,15,"REST API failed to fetch the CustomXmlPart for Automate Gallery.");var Lb=[];Lb.push(Object(Y.a)(new da.a,{name:"Error",string:"Failure using rich api: "+mc}));
Lb.push(Object(Y.a)(new da.a,{name:"ErrorCode",string:"RichApiFailure"}));ac.uW=!0;ac.u_a(lb,wa.a.Ta.Jb,0,Lb);Dc.setResult(!1)},Zb,Dc)};d.prototype.$Wh=function(kb,lb,ac){var Dc=this,Zb=wa.a.Ta.Jb,mc=0,Lb=0;this.uW=mc===kb.count;var Sa=[];Sa.push(Object(Y.a)(new da.a,{name:"ScriptIds",int64:kb.count}));if(kb.count)if(lb&&lb.IsSuccess){I(this.$,lb.Token);var Cb={};lb=ak(kb);for(var ec=lb.next();!ec.done;Cb={Dfb:Cb.Dfb},ec=lb.next())ec=ec.value,Cb.Dfb=yb.a.create().toString(),makerstorage.getSharedScript(ec.value,
Cb.Dfb).then(function(wb){return function(rc){var Mc=[];Mc.push(Object(Y.a)(new da.a,{name:"BodySize",int64:rc.body.length}));Mc.push(Object(Y.a)(new da.a,{name:"CorrelationId",string:wb.Dfb}));S.a(ha.a.Bsf,!0,ia.getElapsedMilliseconds(Zb,wa.a.Ta.Jb),Mc);mc++;rc=new v(rc);rc.shareId=kb.na(rc.id);Dc.Gj.Es(rc);Dc.uW=mc===kb.count;Dc.hGd=!0;Dc.u_a(ac,Zb,Lb,Sa)}}(Cb)).catch(function(wb){return function(rc){var Mc=[];Object.getType(rc)===makerstorage.StorageServiceError?(Sa.push(Object(Y.a)(new da.a,{name:"Error",
string:rc.message})),Sa.push(Object(Y.a)(new da.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",rc.errorCode.toString(),rc.status.toString())}))):(Mc.push(Object(Y.a)(new da.a,{name:"Error",string:rc.toString()})),Mc.push(Object(Y.a)(new da.a,{name:"ErrorCode",string:"exception"})));Mc.push(Object(Y.a)(new da.a,{name:"CorrelationId",string:wb.Dfb}));S.a(ha.a.Bsf,!1,ia.getElapsedMilliseconds(Zb,wa.a.Ta.Jb),Mc);mc++;Lb++;Dc.uW=mc===kb.count;Dc.u_a(ac,Zb,Lb,Sa)}}(Cb)).finally(function(){if(W.EwaSettings.getBooleanFeatureGate(fa.a.jXc,
!1)&&Dc.indexedDB.Cf()&&Dc.uW){var wb=e.LWh(Dc.$,Dc.Gj);Dc.indexedDB.Rbb(new wc.a(fa.a.ZOb,wb))}})}else Cb=lb?lb.ErrorCode:"need_token",lb=lb?lb.ErrorMessage:"No Access Token",Sa.push(Object(Y.a)(new da.a,{name:"Error",string:lb})),Sa.push(Object(Y.a)(new da.a,{name:"ErrorCode",string:Cb})),this.uW=!0,this.u_a(ac,Zb,Lb,Sa);else this.uW=this.hGd=!0,this.u_a(ac,Zb,Lb,Sa),W.EwaSettings.getBooleanFeatureGate(fa.a.jXc,!1)&&Z.TaskExtensions.Qha(e.ALf(this.$,this.indexedDB),function(wb){wb.result&&(Dc.indexedDB.t5c(fa.a.ZOb),
Dc.Gj.clear(),ac.QN("CachedScripts"))},this.$.la,3)};d.prototype.lWh=function(kb){var lb={id:"samples-6"};lb.name=ra.a.instance.ga(2116);this.yB.Es(new v(lb));lb.id="samples-8";lb.name=ra.a.instance.ga(2117);this.yB.Es(new v(lb));lb.id="samples-2";lb.name=ra.a.instance.ga(2113);this.yB.Es(new v(lb));lb.id="samples-4";lb.name=ra.a.instance.ga(2114);this.yB.Es(new v(lb));lb.id="samples-5";lb.name=ra.a.instance.ga(2115);this.yB.Es(new v(lb));lb.id="samples-9";lb.name=ra.a.instance.ga(2118);this.yB.Es(new v(lb));
this.TGb=!0;kb.QN("SampleScripts")};d.prototype.CYh=function(){var kb={};kb.id=fa.a.f8f;kb.name=ra.a.instance.ga(2119);this.HMb.Es(new v(kb));kb.id=fa.a.g8f;kb.name=ra.a.instance.ga(2120);this.HMb.Es(new v(kb))};d.prototype.SWi=function(kb){var lb=new Pb.a;if(kb=this.p1a.parseFromString(kb,"text/xml").querySelector('[id="script-ids-node-id"]')){kb=kb.getElementsByTagName("scriptId");for(var ac={},Dc=0;Dc<kb.length;ac={JPb:ac.JPb,GPb:ac.GPb,BPb:ac.BPb},Dc++)ac.JPb=kb[Dc].getAttribute("id"),ac.JPb&&
(ac.GPb=void 0,ac.BPb=void 0,function(Zb){return function(){var mc=e.PXh(Zb.JPb);Zb.GPb=mc.a6f;Zb.BPb=mc.shareId;return mc}}(ac)().returnValue&&lb.ia(ac.GPb,ac.BPb))}return lb};d.prototype.R5i=function(kb){var lb=this,ac=wa.a.Ta.Jb,Dc=[];Z.TaskExtensions.Qha(e.ALf(this.$,this.indexedDB),function(Zb){var mc=Zb.result;Dc.push(Object(Y.a)(new da.a,{name:"ExistingScriptCount",int64:lb.Gj.length}));if(mc){Dc.push(Object(Y.a)(new da.a,{name:"CachedScriptCount",int64:mc.length}));if(Zb=!lb.uW||0===lb.Gj.length){mc=
ak(mc.getScripts());for(var Lb=mc.next();!Lb.done;Lb=mc.next())lb.Gj.Es(Lb.value);lb.Gj.sort();S.a(ha.a.cyd,Zb,ia.getElapsedMilliseconds(ac,wa.a.Ta.Jb),Dc);lb.PGd(kb);return!0}S.a(ha.a.cyd,Zb,ia.getElapsedMilliseconds(ac,wa.a.Ta.Jb),Dc)}else S.a(ha.a.cyd,!1,ia.getElapsedMilliseconds(ac,wa.a.Ta.Jb),Dc);return!1},this.$.la,3)};d.prototype.J5i=function(kb){var lb=this,ac=wa.a.Ta.Jb,Dc=[];Z.TaskExtensions.Qha(this.indexedDB.E3a(fa.a.aab),function(Zb){var mc=!lb.sab||!lb.Up.length;Zb=Zb.result;Dc.push(Object(Y.a)(new da.a,
{name:"ExistingScriptCount",int64:lb.Up.length}));if(""!==Zb&&(Zb=mb.b(Zb),Dc.push(Object(Y.a)(new da.a,{name:"CachedScriptCount",int64:Zb.length})),mc)){Zb=ak(Zb);for(var Lb=Zb.next();!Lb.done;Lb=Zb.next())lb.Up.Es(new v(Lb.value));lb.Up.sort();S.a(ha.a.zsf,mc,ia.getElapsedMilliseconds(ac,wa.a.Ta.Jb),Dc);lb.PGd(kb);return!0}S.a(ha.a.zsf,mc,ia.getElapsedMilliseconds(ac,wa.a.Ta.Jb),Dc);return!1},this.$.la,3)};d.prototype.u_a=function(kb,lb,ac,Dc){this.uW&&(Dc.push(Object(Y.a)(new da.a,{name:"ScriptCount",
int64:this.Gj.length})),Dc.push(Object(Y.a)(new da.a,{name:"ScriptErrorCount",int64:ac})),S.a(ha.a.lFi,!ac,ia.getElapsedMilliseconds(lb,wa.a.Ta.Jb),Dc),this.Gj.sort(),kb.QN(fa.a.ZOb))};d.prototype.PGd=function(kb){this.Cwb=!0;kb.QN("CachedScripts")};Object(u.a)(d,"AutomateCommandStorage",e,[]);var Aa=ca.a;Rk(c,Aa);c.prototype.create=function(){var kb=this,lb=Ta.GetServiceTaskFactory.Ra(this.$.da,349,350,this.hb),ac=Ea.a.loadScript(131,4,this.hb,void 0,void 0,351),Dc=Ta.GetServiceTaskFactory.create(this.$.da,
102,this.$.la,this.hb),Zb=Ta.GetServiceTaskFactory.create(this.$.da,396,this.$.la,this.hb),mc=Ta.GetServiceTaskFactory.Ra(this.$.da,5,4,this.hb);Z.TaskExtensions.Ba(Z.TaskExtensions.Wd([lb,ac,Dc,Zb,mc],this.la,3),function(){var Lb=lb.result,Sa=Zb.result,Cb=mc.result,ec=new w,wb=new J(kb.$,Lb,ec),rc=new d(kb.$,Sa),Mc=new r(kb.$,rc);Cb=new k(kb.$,wb,ec,Cb);kb.pb(kb.$.da.za(352)||new l(kb.$,Lb,Dc.result,Sa,Cb,ec,wb,rc,Mc))},this.la,3)};c.ka=function(kb){kb&&kb.da.Ga(351,new c(kb))};Object(u.a)(c,"AutomateCommandManagerFactory",
ca.a,[]);var Ya=b(11);b.d(D,"a",function(){return a})},1391:function(u,D,b){function a(){Type.registerNamespace("Common.App.WopiIdentity");c.main()}function c(){this.fb=null}function d(M){this._initialized=!1;this.e$a={};this.Cyc={};this.qO=z.AFrameworkApplication.ta.tD;this.ujd=M}function e(M,T,F){this.expiration=this.authority=this.accessToken=null;this.accessToken=M;this.authority=T;this.expiration=F}function k(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=
""}function l(){}function m(M,T){this.requestCallback=this.requestParameters=null;this.requestParameters=M;this.requestCallback=T}u=b(0);var f=b(15),w=b(83),n;(function(M){M[M.generalException=0]="generalException";M[M.invalidArgument=1]="invalidArgument";M[M.notAllowed=2]="notAllowed";M[M.apiNotAvailable=3]="apiNotAvailable";M[M.unresolvedPendingRequest=4]="unresolvedPendingRequest";M[M.timeout=5]="timeout";M[M.adalTimeout=6]="adalTimeout";M[M.userNotSignedIn=7]="userNotSignedIn";M[M.userAborted=
8]="userAborted";M[M.silentSignInFailed=9]="silentSignInFailed";M[M.invalidResourceUrl=10]="invalidResourceUrl";M[M.invalidGrant=11]="invalidGrant";M[M.connectionLost=12]="connectionLost";M[M.clientError=13]="clientError";M[M.serverError=14]="serverError"})(n||(n={}));Object(u.b)("ErrorCodes",n);b(1503);Object(u.a)(m,"OutstandingRequest",null,[]);l.sDi="AADSTS50058";l.invalidResourceUrl="AADSTS50001";l.nDi="AADSTS65001";l.DDi="AADSTS70011";l.userAborted="13002";l.CZi="Popup Window is null";l.BZi=
"Popup Window closed";l.adalTimeout="Token renewal operation failed due to timeout";l.xKj="tokenRevoked";Object(u.a)(l,"WopiHostErrorType",null,[]);var z=b(4),r=b(942),v=b(635),A=b(41),B=b(1502);Object(u.a)(k,"WopiIdentityInfo",null,[248]);Object(u.a)(e,"WopiIdentityToken",null,[247]);var y=b(25),x=b(154),C=b(392),G=b(170),E=b(80),I=b(356);d.prototype.M1a=function(M){this._initialized||(M.Wn(G.a.LGf),M.Ml(G.a.LGf,Object(w.a)(this,this.jQi,"onReceivedAccessToken")),this._initialized=!0)};d.prototype.getAccessToken=
function(M,T,F){var K=this;F=void 0===F?null:F;this.wNa(M,T);return new Promise(function(J,O){if(K.Pld(T))if(T in K.e$a)O("unresolvedPendingRequest");else{var N=window.setTimeout(function(){var Q={};f.ULS.sendTraceTag(37856032,344,10,A.c((Q.error="Request timeout.",Q.callerId=T,Q)));O("timeout")},12E4);K.Rbd(M,T,F,function(Q,ca){window.clearTimeout(N);Q?J(Q):(Q={},f.ULS.sendTraceTag(37856033,369,15,A.c((Q.error=n[ca],Q))),O(ca))})}else{var H={};f.ULS.sendTraceTag(37856034,344,10,A.c((H.error="Caller is not allowed.",
H)));O("notAllowed")}})};d.prototype.getPrimaryIdentityInfo=function(M){var T=this;return new Promise(function(F,K){if(T.Pld(M))T.jUh(function(O,N){O?F(O):(O={},f.ULS.sendTraceTag(37856064,369,10,A.c((O.error=N.toString(),O))),K(N))});else{var J={};f.ULS.sendTraceTag(37856065,344,10,A.c((J.error="Caller is not allowed.",J)));K("notAllowed")}})};d.prototype.getAuthContext=function(M){var T=this;return new Promise(function(F,K){var J=T.getAuthContextSync(M);J?F(J):K("notAllowed")})};d.prototype.getAuthContextSync=
function(M){if(this.Pld(M)){var T=new B.a;T.upn=z.AFrameworkApplication.fa.Wa("UserPrincipalName");T.userId=z.AFrameworkApplication.fa.Wa("LoggableUserId");T.authority=z.AFrameworkApplication.fa.Wa("HostAuthAuthority");T.tenantId=z.AFrameworkApplication.fa.Wa("TenantId");T.isAnonymous=z.AFrameworkApplication.fa.ra("IsAnonymousUser");T.supportsAuthToken=this.W6h(M);M=z.AFrameworkApplication.fa.Wa("HostAuthType");T.authorityType="aad"===M.toLowerCase()?2:"msa"===M.toLowerCase()?1:0;return T}T={};f.ULS.sendTraceTag(40751647,
344,10,A.c((T.error="Caller is not allowed.",T)));return null};d.prototype.W6h=function(M){var T=r.a.exb;return y.a.Zwa?T&&r.a.Z7f?Array.contains(r.a.Z7f,M.toLowerCase()):!1:T};d.prototype.Rbd=function(M,T,F,K){var J=this,O=[];Array.add(O,Object.assign(new E.a,{name:"CallerId",string:T}));Array.add(O,Object.assign(new E.a,{name:C.a.JSd,string:M.correlationId}));x.a.sendTelemetryEvent(Object.assign(new I.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:O}));O=v.a.create().toString();
var N="getAccessToken_"+O,H=this.qO.sc("ComponentAttach",N);this.Cyc[N]=H;var Q={};Q[C.a.KSd]=O;Q[C.a.QDj]=M.resource;Q[C.a.RDj]=M.scope;Q[C.a.W4f]=z.AFrameworkApplication.fa.Wa("HostAuthType");Q[C.a.UDj]=z.AFrameworkApplication.fa.Wa("UserPrincipalName");Q[C.a.SDj]=M.silentLogin;Q[C.a.NDj]=M.options;Q[C.a.JSd]=M.correlationId;Q[C.a.ODj]=T;F&&(Q[C.a.addinName]=F.AddinName,Q[C.a.MDj]=F.AddinTrustId);this.ujd.execute(function(ca){J.M1a(ca);ca.xj(G.a.getAuthToken,Q)});this.e$a[O]=new m(M,K)};d.prototype.jUh=
function(M){var T=z.AFrameworkApplication.fa.Wa("UserName"),F=z.AFrameworkApplication.fa.Wa("UserPrincipalName"),K=z.AFrameworkApplication.fa.Wa("LoggableUserIdSpace"),J=new k;J.email=F;J.displayName=T;switch(K){case "OrgIdPuid":J.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":J.authority="MicrosoftAccount";break;default:J.authority=K}M(J,null)};d.prototype.jQi=function(M){var T=null;try{var F=M.Values[C.a.KSd],K=M.Values[C.a.LDj],J=M.Values[C.a.W4f],O=M.Values[C.a.TDj],
N=null,H=null,Q=this.e$a[F];if("undefined"!==typeof Q&&Q){var ca=[];Array.add(ca,Object.assign(new E.a,{name:C.a.JSd,string:Q.requestParameters.correlationId}));x.a.sendTelemetryEvent(Object.assign(new I.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:ca}));T=Q.requestCallback;delete this.e$a[F];"undefined"!==typeof K&&K&&K.length?H=new e(K,J,O):N=n[this.syi(M)];F="getAccessToken_"+F;F in this.Cyc&&(this.Cyc[F].stop(),delete this.Cyc[F]);T(H,N)}else N={},f.ULS.sendTraceTag(37856066,
344,10,A.c((N.error="No matching outstanding request for request ID.",N.requestId=F,N)))}catch(X){M=M.Values[C.a.KSd],M in this.e$a&&delete this.e$a[M],this.Ojc(),M={},f.ULS.sendTraceTag(37856067,344,10,A.c((M.error=X.message,M.stack=X.stack,M))),T&&T(null,"generalException")}};d.prototype.Pld=function(M){var T=z.AFrameworkApplication.i0h();M=M.toLowerCase();T=ak(T);for(var F=T.next();!F.done;F=T.next())if(M===F.value.toLowerCase())return!0;T=r.a.TVc;for(var K in T)if(M===T[K].toLowerCase())return!0;
return!1};d.prototype.syi=function(M){M=M.Values[C.a.PDj];this.Ojc();var T={};f.ULS.sendTraceTag(39068821,344,15,A.c((T.error=M,T)));return M?-1<M.indexOf(l.sDi)?9:-1<M.indexOf(l.CZi)||-1<M.indexOf(l.BZi)?12:-1<M.indexOf(l.invalidResourceUrl)?10:-1<M.indexOf(l.userAborted)?8:-1<M.indexOf(l.DDi)||-1<M.indexOf(l.nDi)||M===l.xKj?11:-1<M.indexOf(l.adalTimeout)?6:0:13};d.prototype.wNa=function(M,T){M=this.S6i(M.resource);var F={};f.ULS.sendTraceTag(39921882,344,50,A.c((F.callerId=T,F.resource=M,F)))};
d.prototype.Ojc=function(){var M={};f.ULS.sendTraceTag(39068822,344,50,A.c((M.userAgent=window.navigator.userAgent,M)))};d.prototype.S6i=function(M){return(M?M:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")};Object(u.a)(d,"WopiIdentityManager",null,[221]);var U=b(257);c.prototype.Sh=function(M){this.fb=M;M.register(d,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").tc().Cc(function(){return new d(M.Tb("Postmessage.IHostPostmessenger"))})};
c.prototype.init=function(){z.AFrameworkApplication.fa&&z.AFrameworkApplication.fa.Tu(Object(w.a)(this,this.sB,"onFullAppSettingsReady"))};c.prototype.sB=function(){try{this.fb.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(M){f.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+M)}};c.prototype.dispose=function(){};c.main=function(){U.a.instance.Ui(new c)};Af.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.WopiIdentity"}}});
Object(u.a)(c,"WopiIdentityPackage",null,[3,4]);b.d(D,"a",function(){return a})},1397:function(u,D,b){function a(da,xa,ta){this.Bwa=!1;this.aF={};this.$=da;this.lj=xa;this.mld().Xma();this.indexedDB=ta;this.indexedDB.Cf()&&(this.Bwa=!0,this.indexedDB.initialize(a.tkd,a.ukd))}function c(da,xa){this.qQc=da;this._message=xa}function d(){}function e(){}function k(da){switch(da){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}}function l(da,xa){r(b(1397).CustomFunctionsInstaller.MZe("CustomFunctionsRuntimeLogging"),
function(ta){if(ta.result&&window.console)switch(ta=k(da.severity)+" "+da.message+xa,da.severity){case 2:window.console.log&&window.console.log(ta);break;case 0:window.console.info&&window.console.info(ta);break;case 1:window.console.error&&window.console.error(ta)}return!0},"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")}function m(da,xa,ta,ab,Na){ta=da.continueWith(function(){xa(da)},3,ta,ab);ta.continueWith(function(){E.ULS.sendTraceTag(537163459,
0,10,Na)},4);return ta}function f(da,xa,ta){return m(da,xa,X.a.none,Z.a.current,ta)}function w(da,xa,ta,ab,Na){ta=da.eo(function(){return xa(da)},3,ta,ab);ta.continueWith(function(){E.ULS.sendTraceTag(537163460,0,10,Na)},4);return N.TaskExtensions.XAc(ta)}function n(da,xa,ta){return w(da,xa,X.a.none,Z.a.current,ta)}function z(da,xa,ta,ab,Na){ta=da.eo(function(){return xa(da)},3,ta,ab);ta.continueWith(function(){E.ULS.sendTraceTag(537163461,0,10,Na)},4);return ta}function r(da,xa,ta){return z(da,xa,
X.a.none,Z.a.current,ta)}function v(da,xa,ta,ab,Na){ta=da.eo(function(){return xa(da)},3,ta,ab);ta.continueWith(function(){E.ULS.sendTraceTag(537163462,0,10,Na)},4);return N.TaskExtensions.XAc(ta)}function A(da,xa,ta){return v(da,xa,X.a.none,Z.a.current,ta)}function B(da,xa,ta,ab,Na){ta=da.continueWith(function(){xa(da)},3,ta,ab);ta.continueWith(function(){E.ULS.sendTraceTag(537163463,0,10,Na)},4);return ta}function y(da,xa,ta){return B(da,xa,X.a.none,Z.a.current,ta)}function x(){}function C(da){da=
da.split("|");this.ax=da[1];this.TQc=da[2];this.wTd=da[3]}b.r(D);u=b(0);var G=b(7),E=b(15),I=b(4),U=b(162),M=b(202),T=b(85),F=b(564),K=b(177),J=b(61),O=b(51),N=b(37),H=b(223),Q=b(121),ca=b(592);Af.Object.defineProperties(C.prototype,{solutionId:{configurable:!0,enumerable:!0,get:function(){return this.ax}},solutionVersion:{configurable:!0,enumerable:!0,get:function(){return this.TQc}},needToRestoreManifest:{configurable:!0,enumerable:!0,get:function(){return this.wTd===OSF.StoreTypeEnum.Registry.toString()}}});
Object(u.a)(C,"AddinStoreInfo",null,[]);Object(u.a)(x,"CustomFunctionRegistrationInfos",null,[]);var X=b(214),Z=b(63),ea=b(1172);Object(u.a)(e,"InstallationInfo",null,[]);Object(u.a)(d,"UninstallationInfo",null,[]);var ka=b(28),Y=b(92),qa=b(34),fa=b(29),ha=b(1),ia=b(22),wa=b(295),Qa=b(998),S=b(58);Af.Object.defineProperties(c.prototype,{severity:{configurable:!0,enumerable:!0,get:function(){return this.qQc}},message:{configurable:!0,enumerable:!0,get:function(){return this._message}}});Object(u.a)(c,
"CustomFunctionLog",null,[]);b.d(D,"CustomFunctionsInstaller",function(){return a});a.prototype.w$e=function(da,xa,ta,ab){var Na=this;if(ab.invariantNamespace)for(var Ka=0;Ka<ab.invariantNamespace.length;++Ka){var la=ab.invariantNamespace.charAt(Ka);if("."!==la&&"_"!==la&&"a">la&&"z"<la&&"A">la&&"Z"<la&&"0">la&&"9"<la)throw E.ULS.sendTraceTag(537163552,0,10,"CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='{0}', Position={1}.",la,Ka),Error.create("InvariantNamespace validation failed");
}return A(this.USg(ta,ab.manifest),function(){return A(Na.cGd(da),function(Ea){var ra=Ea.result;return(null===ra||void 0===ra?0:ra.isDynamicMetadata)?Na.eHd(da,xa,ra,!1,!1,!1):A(Na.VXj(da,xa,ab),function(na){var ba;ra=(ba=new e,ba.addinId=ta,ba.locale=ab.locale,ba.addinInvariantNamespace=ab.invariantNamespace,ba.addinNamespace=ab.namespace,ba.addinTitle=ab.title,ba.isXllCompatible=ab.isXllCompatible,ba.metadataContent=JSON.stringify(JSON.parse(na.result)),ba);return Na.eHd(da,xa,ra,!1,a.ayh(ab.osfControl.getStoreType()),
ea.a(Na.$,ab))},"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")};a.prototype.y$e=function(da,xa,ta,ab){var Na=this;if(!a.Gqd(ta))throw E.ULS.sendTraceTag(537163551,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),Error.create("Invalid Metadata JSON");return A(this.cGd(da),
function(Ka){Ka=Ka.result;if(!Ka&&(Ka=qa.a.zc(Na.oV,da),!Ka))throw E.ULS.sendTraceTag(537163550,0,10,String.format("CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId {0} hasn't been installed yet.",Telemetry.PrivacyRules.GetPrivacyCompliantId(da,xa,null))),Error.create("Customfunctions dynamic registration failed");Ka.metadataContent=JSON.stringify(JSON.parse(ta));Ka.isDynamicMetadata=!0;return Na.eHd(da,xa,Ka,!0,!0,ab)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")};
a.prototype.Jag=function(da,xa){var ta=this;this.lj.sia();var ab=Object(G.a)(new d,{solutionId:da}),Na=String.format("CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: {0}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(da,xa,null));return A(this.OHd(da),function(){return A(ta.VHd(da),function(){return ta.fXd(ta.lj,da,xa,ab)},"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed")},Na)};a.prototype.VXj=function(da,xa,ta){var ab=
new U.a;OSF.OUtil.xhrGet(ta.metadataUrl,function(Na){Na?ab.setResult(Na):ab.setException(Error.create("Invalid manifest"))},function(Na){E.ULS.sendTraceTag(537163548,0,10,"CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution {0}. ErrorCode: {1}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(da,xa,null),Na);ab.setException(Error.create("Failed to download manifest"))});return ab.task};a.prototype.mld=function(){var da=this;return A(this.$qc(),function(xa){var ta=
xa.result;if(!ta.length)return S.Task.Ua(!0);E.ULS.sendTraceTag(537163547,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");xa=new M.a;for(var ab=[],Na={},Ka=0;Ka<ta.length;Na={EPb:Na.EPb},Ka++)Na.EPb=Object(T.a)(String,ta[Ka]),xa.add(r(da.cGd(Na.EPb),function(la){return function(Ea){if(Ea=Ea.result){var ra=qa.a.zc(da.aF,Ea.addinId);ra&&ra===Ea.metadataContent||(da.aF[Ea.addinId]=Ea.metadataContent,da.oV[la.EPb]=Ea,ab.push(Ea))}return!0}}(Na),
"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"));return n(S.Task.WhenAllEnumerable(xa),function(){if(ab.length){var la,Ea=(la=new x,la.registrationInfos=ab,la);return da.k0b(da.lj,ta,Ea)}E.ULS.sendTraceTag(537163546,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache");return S.Task.Ua(!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},"CustomFunctionsInstaller::InstallFromCacheAsync failed")};
a.prototype.z$e=function(){var da=this,xa=new U.a;new M.a;var ta=[],ab=[];Object.keys(this.oV).forEach(function(Na){Na=Object(T.a)(String,Na);var Ka=qa.a.zc(da.oV,Na);ta.push(Ka);ab.push(Na)});if(!ab.length)return xa.setResult(!0),xa.task;xa=Object(G.a)(new x,{registrationInfos:ta});return this.k0b(this.lj,ab,xa)};a.prototype.$qc=function(){return r(this.qed(ca.a.EYa),function(da){da=da.result;return Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(da||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(da||
"[]"):null},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")};a.prototype.ugg=function(da){return this.lOd(ca.a.EYa,Sys.Serialization.JavaScriptSerializer.serialize(da))};a.prototype.cGd=function(da){return A(this.qed(ca.a.K3a(da)),function(xa){xa=xa.result||"";return 0<xa.length?S.Task.Ua(Sys.Serialization.JavaScriptSerializer.deserialize(xa,!0)):S.Task.Ua(null)},"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")};
a.prototype.OXj=function(da,xa){var ta=this;return A(this.PKe(da),function(){return A(ta.lOd(ca.a.K3a(da),Sys.Serialization.JavaScriptSerializer.serialize(xa)),function(){return a.mOd(ca.a.aid,"true")},"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed")},"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")};a.prototype.OHd=function(da){var xa=this;return A(this.dOf(da),function(){return A(xa.wOf(ca.a.K3a(da)),
function(){return A(xa.$qc(),function(ta){return ta.result.length?S.Task.Ua(!0):a.mOd(ca.a.aid,"false")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")};a.prototype.uLf=function(da){return this.qed(ca.a.J3a(da))};a.prototype.rgg=
function(da,xa){var ta=this;return A(this.PKe(da),function(){return ta.lOd(ca.a.J3a(da),xa)},"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")};a.prototype.VHd=function(da){var xa=this;return A(this.dOf(da),function(){return xa.wOf(ca.a.J3a(da))},"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")};a.prototype.PKe=function(da){var xa=this;return A(this.$qc(),function(ta){ta=ta.result;var ab=da.toLowerCase();
if(Array.contains(ta,ab))return S.Task.Ua(!0);ta.push(ab);return xa.ugg(ta)},"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")};a.prototype.dOf=function(da){var xa=this;return A(this.$qc(),function(ta){ta=ta.result;var ab=da.toLowerCase();return Array.contains(ta,ab)?(ta.splice(Array.indexOf(ta,ab),1),xa.ugg(ta)):S.Task.Ua(!0)},"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")};
a.prototype.USg=function(da,xa){if(ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix"))return da=new OSF.AddinIdInfo(da),da.needToRestoreManifest()?this.rgg(da.getSolutionId(),xa):S.Task.Ua(!0);da=new C(da);return da.needToRestoreManifest?this.rgg(da.solutionId,xa):S.Task.Ua(!0)};a.prototype.ehj=function(da){var xa=this;if(ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")){var ta=new OSF.AddinIdInfo(da);return ta.needToRestoreManifest()?
r(this.uLf(ta.getSolutionId()),function(Na){(Na=Na.result)&&OSF.OsfManifestManager.cacheManifestFromXml(ta.getSolutionId(),ta.getSolutionVersion(),Na,xa.$.ya.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):S.Task.Ua(!0)}var ab=new C(da);return ab.needToRestoreManifest?r(this.uLf(ab.solutionId),function(Na){(Na=Na.result)&&OSF.OsfManifestManager.cacheManifestFromXml(ab.solutionId,ab.solutionVersion,Na,xa.$.ya.UICultureTag);return!0},
"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):S.Task.Ua(!0)};a.prototype.wOf=function(da){return this.Bwa?this.indexedDB.t5c(da):a.w$i(da)};a.prototype.lOd=function(da,xa){return this.Bwa?this.indexedDB.Rbb(new Qa.a(da,xa)):a.mOd(da,xa)};a.prototype.qed=function(da){return this.Bwa?this.indexedDB.E3a(da):a.MZe(da)};a.prototype.eHd=function(da,xa,ta,ab,Na,Ka){var la=this,Ea=String.format("CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: {0}.",
Telemetry.PrivacyRules.GetPrivacyCompliantId(da,xa,null));return N.TaskExtensions.XAc(r(this.fHd(this.lj,da,xa,ta,!1,ab,Ka),function(){return Na?la.OXj(da,ta):S.Task.Ua(!0)},Ea))};a.prototype.fHd=function(da,xa,ta,ab,Na,Ka,la){var Ea=this;if(!Ka&&(Ka=qa.a.zc(this.aF,ab.addinId))&&Ka===ab.metadataContent)return S.Task.Ua(!0);this.aF[ab.addinId]=ab.metadataContent;this.oV[xa]=ab;la||da.wHb(xa);da.sia();return A(this.Z7i(xa,ta,ab),function(){return Ea.NEd(ab.addinId,Na)},"Failed to register functions for customfunction addin")};
a.prototype.Z7i=function(da,xa,ta){var ab=this,Na=new U.a,Ka=this.Vob(ta);return this.Cia(function(la){ha.EwaSettings.ma(257)&&l(a.Erb,da);(la=la.Result)&&204===la.ResponseStatusCode?Na.setResult(!0):(delete ab.aF[ta.addinId],delete ab.oV[da],y(ab.OHd(da),function(){y(ab.VHd(da),function(){ab.z2f()},"Failed to show customfunctions installation error info")},String.format("CustomFunctionsInstaller: Failed to register Custom Functions for solution: {0}. Received status code {1}.",da,la?la.ResponseStatusCode.toString():
"Unknown")),Na.setResult(!1))},function(la){la=Q.a.Of(la.data);E.ULS.sendTraceTag(537163544,0,10,"CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}. Errors: {1}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(da,xa,null),fa.a.Dc(la));ha.EwaSettings.ma(257)&&l(a.Drb,da);delete ab.aF[ta.addinId];delete ab.oV[da];Na.setResult(!1)},Ka,Na,!0)};a.prototype.k0b=function(da,xa,ta){var ab=this,Na=new U.a,Ka=ka.a.Ta.Xd.m;xa.forEach(function(Ea){Ea=
Object(T.a)(String,Ea);da.$we(Ea)});da.sia();var la=this.kYc(ta);return this.Cia(function(Ea){ha.EwaSettings.ma(257)&&l(a.Erb,Sys.Serialization.JavaScriptSerializer.serialize(xa));Ea=Ea.Result;var ra=!0,na=Sys.Serialization.JavaScriptSerializer.deserialize(Ea.ResponseBody.toString());na=Array.isArray(na.value)?na.value:null;for(var ba=new M.a,sa={Iea:0};sa.Iea<na.length;sa={Iea:sa.Iea},sa.Iea++)if(!na[sa.Iea]){ra=!1;var ya=String.format("CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Received status code {0}.",
Ea.ResponseStatusCode);ba.add(A(ab.OHd(xa[sa.Iea]),function(va){return function(){delete ab.aF[ta.registrationInfos[va.Iea].addinId];delete ab.oV[xa[va.Iea]];return ab.VHd(xa[va.Iea])}}(sa),ya))}f(S.Task.WhenAllEnumerable(ba),function(){y(ab.NEd("",!1),function(){E.ULS.sendTraceTag(537163542,0,50,"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes {0} Millisecond.",ka.a.Ta.Xd.m-Ka);ra?Na.setResult(ra):f(ab.z2f(),function(){Na.setResult(ra)},"Failed to show customfunctions installation error info")},
String.format("CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"))},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},function(Ea){Ea=Q.a.Of(Ea.data);E.ULS.sendTraceTag(537163541,0,10,"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Errors: {0}.",fa.a.Dc(Ea));ha.EwaSettings.ma(257)&&l(a.Drb,Sys.Serialization.JavaScriptSerializer.serialize(xa));
for(Ea=0;Ea<ta.registrationInfos.length;Ea++)delete ab.aF[ta.registrationInfos[Ea].addinId],delete ab.oV[xa[Ea]];Na.setResult(!1)},la,Na,!0)};a.prototype.fXd=function(da,xa,ta,ab){var Na=this;return A(this.ZOj(da,xa,ta,ab),function(){return Na.NEd(ab.solutionId,!1)},"Failed to unregister functions for customfunction addin")};a.prototype.ZOj=function(da,xa,ta,ab){var Na=new U.a;da.wHb(xa);(da=qa.a.zc(this.oV,xa))&&delete this.aF[da.addinId];delete this.oV[xa];ab=this.wYc(ab);return this.Cia(function(){ha.EwaSettings.ma(257)&&
l(a.t4c,xa);Na.setResult(!0)},function(Ka){Ka=Q.a.Of(Ka.data);E.ULS.sendTraceTag(537163539,0,10,"CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}. Errors: {1}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(xa,ta,null),fa.a.Dc(Ka));ha.EwaSettings.ma(257)&&l(a.s4c,xa);Na.setResult(!1)},ab,Na,!1)};a.prototype.Cia=function(da,xa,ta,ab,Na){function Ka(){function sa(W,La,Ia){ha.EwaSettings.ma(257)&&l(Na?a.r4c:a.u4c,ya.RequestBody);return J.g(Ea.xa,
"ExecuteRichApiRequest",ta,wa.b(W,da),wa.a(La,xa),Ia,null,0)}if(la.hHa()||0<Ea.xa.P3||0<Ea.Gk.P3)return!1;ra&&la.wo(ra);na&&Ea.cs(na);ba&&Ea.Hz(ba);var ya=ta.request,va=0;ha.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?ya.RequestFlags&1&&256!==(ya.RequestFlags&256)||(va=16):va=ya.RequestFlags&1?0:16;ha.EwaSettings.Zb()?la.St(new K.a(507,0,sa,va|64)):la.St(new F.a(507,0,sa,va));return!0}var la=this.$.userOperationManager,Ea=this.$.oa,ra=null,na=null,ba=null;
Ka()||(ra=function(){Ka()},na=function(){Ka()},ba=function(){Ka()},la.Cr(ra),Ea.Vq(na),Ea.Ky(ba));return ab.task};a.prototype.Vob=function(da){var xa={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};xa.RequestBody=JSON.stringify(da);xa.RequestFlags=1;ha.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(xa.RequestFlags|=256);da=this.$.oa.xa.Na(1);da.request=xa;return da};a.prototype.kYc=function(da){var xa={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",
RequestHeaders:null};xa.RequestBody=JSON.stringify(da);xa.RequestFlags=1;ha.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(xa.RequestFlags|=256);da=this.$.oa.xa.Na(1);da.request=xa;return da};a.prototype.wYc=function(da){var xa={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};xa.RequestBody=JSON.stringify(da);xa.RequestFlags=1;ha.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(xa.RequestFlags|=
256);da=this.$.oa.xa.Na(1);da.request=xa;return da};a.prototype.NEd=function(da,xa){var ta=this,ab=O.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1);return v(ab,function(){ab.result.gKd();return da&&xa?ta.ehj(da):S.Task.Ua(!0)},this.$.la,H.a.instance,"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")};a.prototype.z2f=function(){var da=new Y.a(1949669462,0,this.$.Jc,0,null);return this.$.Ka.Kb(da)};a.MZe=function(da){try{return S.Task.Ua(localStorage.getItem(da))}catch(xa){return E.ULS.sendTraceTag(537163537,
0,50,"CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: {0}",xa.message||"Unknown"),S.Task.Ua(null)}};a.mOd=function(da,xa){try{return localStorage.setItem(da,xa),S.Task.Ua(!0)}catch(ta){return E.ULS.sendTraceTag(537163536,0,50,"CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: {0}",ta.message||"Unknown"),S.Task.Ua(!1)}};a.w$i=function(da){try{return localStorage.removeItem(da),S.Task.Ua(!0)}catch(xa){return E.ULS.sendTraceTag(537163535,
0,50,"CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: {0}",xa.message||"Unknown"),S.Task.Ua(!1)}};a.ayh=function(da){return ia.a.equals(da,"registry",!0)||ia.a.equals(da,"uploadfiledevcatalog",!0)||I.AFrameworkApplication.userNameUnknown||I.AFrameworkApplication.limitedEdit};a.Gqd=function(da){if(!da)return!1;try{JSON.parse(da)}catch(xa){return!1}return!0};Af.Object.defineProperties(a.prototype,{oV:{configurable:!0,enumerable:!0,get:function(){return this.lj.oV}}});
a.tkd="CustomFunctionCache";a.ukd="CustomFunction";a.r4c=new c(2,"CustomFunctions [Registration] [Begin] SolutionId=");a.Erb=new c(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");a.Drb=new c(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");a.u4c=new c(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");a.t4c=new c(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");a.s4c=new c(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(u.a)(a,
"CustomFunctionsInstaller",null,[841])},1401:function(u,D,b){function a(H){this.aF={};this.$=H;this.mld().Xma()}function c(H,Q){this.qQc=H;this._message=Q}function d(){}function e(){}function k(H){switch(H){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}}function l(H,Q){if(b(1401).CustomFunctionsLegacyInstaller.nvb("CustomFunctionsRuntimeLogging")&&window.console)switch(Q=k(H.severity)+" "+H.message+Q,H.severity){case 2:window.console.log&&window.console.log(Q);
break;case 0:window.console.info&&window.console.info(Q);break;case 1:window.console.error&&window.console.error(Q)}}function m(){}function f(H){H=H.split("|");this.ax=H[1];this.TQc=H[2];this.wTd=H[3]}b.r(D);u=b(0);var w=b(7),n=b(15),z=b(1145),r=b(162),v=b(85),A=b(564),B=b(177),y=b(61),x=b(51),C=b(37),G=b(121),E=b(592),I=b(1172);Af.Object.defineProperties(f.prototype,{solutionId:{configurable:!0,enumerable:!0,get:function(){return this.ax}},solutionVersion:{configurable:!0,enumerable:!0,get:function(){return this.TQc}},
needToRestoreManifest:{configurable:!0,enumerable:!0,get:function(){return this.wTd===OSF.StoreTypeEnum.Registry.toString()}}});Object(u.a)(f,"AddinStoreInfo",null,[]);Object(u.a)(m,"CustomFunctionRegistrationInfos",null,[]);Object(u.a)(e,"InstallationInfo",null,[]);Object(u.a)(d,"UninstallationInfo",null,[]);var U=b(159),M=b(34),T=b(29),F=b(1),K=b(14),J=b(295),O=b(1074),N=b(58);Af.Object.defineProperties(c.prototype,{severity:{configurable:!0,enumerable:!0,get:function(){return this.qQc}},message:{configurable:!0,
enumerable:!0,get:function(){return this._message}}});Object(u.a)(c,"CustomFunctionLog",null,[]);b.d(D,"CustomFunctionsLegacyInstaller",function(){return a});a.prototype.w$e=function(H,Q,ca,X){var Z=this,ea=new r.a;if(X.invariantNamespace)for(Q=0;Q<X.invariantNamespace.length;++Q){var ka=X.invariantNamespace.charAt(Q);if("."!==ka&&"_"!==ka&&"a">ka&&"z"<ka&&"A">ka&&"Z"<ka&&"0">ka&&"9"<ka)return n.ULS.sendTraceTag(537163530,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='{0}', Position={1}.",
ka,Q),ea.setResult(!1),ea.task}a.cacheManifest(ca,X.manifest);var Y=a.dGd(H);(null===Y||void 0===Y?0:Y.isDynamicMetadata)?this.dHd(H,Y,ea,!1,!1):OSF.OUtil.xhrGet(X.metadataUrl,function(qa){Y=Object(w.a)(new e,{addinId:ca,locale:X.locale,addinInvariantNamespace:X.invariantNamespace,addinNamespace:X.namespace,addinTitle:X.title,isXllCompatible:X.isXllCompatible,metadataContent:JSON.stringify(JSON.parse(qa))});Z.dHd(H,Y,ea,!1,I.a(Z.$,X))},function(qa){n.ULS.sendTraceTag(537163528,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution {0}. ErrorCode: {1}.",
H,qa);ea.setResult(!1)});return ea.task};a.prototype.y$e=function(H,Q,ca,X){Q=new r.a;if(!a.Gqd(ca))return n.ULS.sendTraceTag(537163527,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),Q.setResult(!1),Q.task;var Z=a.dGd(H);if(!Z)return n.ULS.sendTraceTag(537163526,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),Q.setResult(!1),Q.task;Z.metadataContent=JSON.stringify(JSON.parse(ca));
Z.isDynamicMetadata=!0;this.dHd(H,Z,Q,!0,X);return Q.task};a.prototype.Jag=function(H){var Q=this,ca=new r.a,X=x.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);C.TaskExtensions.Ba(X,function(){var Z=X.result;Z.sia();var ea=Object(w.a)(new d,{solutionId:H});a.PHd(H);a.WHd(H);C.TaskExtensions.Ba(Q.fXd(Z,H,ea),function(ka){U.b(ka)?ca.setResult(ka.result):(ka.Yf?n.ULS.sendTraceTag(537163524,0,10,"CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: {0}.",
H):ka.Ch&&n.ULS.sendTraceTag(537163523,0,10,"CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: {0}.",H),ca.setResult(!1))},Q.$.la,0)},this.$.la,3);return ca.task};a.prototype.mld=function(){var H=this,Q=new r.a,ca=a.iGd();0<ca.length&&n.ULS.sendTraceTag(537163522,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");var X=[];ca.forEach(function(ea){ea=Object(v.a)(String,ea);if(ea=a.dGd(ea)){var ka=
M.a.zc(H.aF,ea.addinId);ka&&ka===ea.metadataContent||(H.aF[ea.addinId]=ea.metadataContent,X.push(ea))}});if(!X.length)return Q.setResult(!0),n.ULS.sendTraceTag(537163521,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),Q.task;var Z=x.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);C.TaskExtensions.Ba(Z,function(){var ea=Z.result,ka=Object(w.a)(new m,{registrationInfos:X});C.TaskExtensions.Ba(H.k0b(ea,ca,ka),function(Y){U.b(Y)?
Q.setResult(Y.result):(Y.Yf?n.ULS.sendTraceTag(537163491,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):Y.Ch&&n.ULS.sendTraceTag(537163490,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),Q.setResult(!1))},H.$.la,0)},this.$.la,3);return Q.task};a.prototype.dhj=function(H){H=new f(H);if(H.needToRestoreManifest){var Q=a.D5i(H.solutionId);OSF.OsfManifestManager.cacheManifestFromXml(H.solutionId,
H.solutionVersion,Q,this.$.ya.UICultureTag)}};a.prototype.dHd=function(H,Q,ca,X,Z){var ea=this,ka=x.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);C.TaskExtensions.Ba(ka,function(){C.TaskExtensions.Ba(ea.fHd(ka.result,H,Q,!1,X,Z),function(Y){U.b(Y)?((Y=Y.result)&&a.PXj(H,Q),ca.setResult(Y)):(Y.Yf?n.ULS.sendTraceTag(537163488,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: {0}.",H):Y.Ch&&n.ULS.sendTraceTag(537163487,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: {0}.",
H),ca.setResult(!1))},ea.$.la,0)},this.$.la,3)};a.prototype.fHd=function(H,Q,ca,X,Z,ea){var ka=this;if(!Z&&(Z=M.a.zc(this.aF,ca.addinId))&&Z===ca.metadataContent)return N.Task.Ua(!0);this.aF[ca.addinId]=ca.metadataContent;var Y=new r.a;ea||H.wHb(Q);H.sia();H=this.Vob(ca);return this.Cia(function(qa){F.EwaSettings.ma(257)&&l(a.Erb,Q);var fa=qa.Result;204===fa.ResponseStatusCode?C.TaskExtensions.Ba(ka.MEd(Y,ca.addinId,X),function(ha){ha.Yf?Q?n.ULS.sendTraceTag(537163485,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}.",
Q):n.ULS.sendTraceTag(537163484,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId {0}.",ca.addinId):ha.Ch&&(Q?n.ULS.sendTraceTag(537163483,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution {0}.",Q):n.ULS.sendTraceTag(537163482,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId {0}.",ca.addinId));
Y.setResult(!1)},ka.$.la,4):(qa=function(){delete ka.aF[ca.addinId];a.PHd(Q);a.WHd(Q);n.ULS.sendTraceTag(537163481,0,10,"CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: {0}. Received status code {1}.",Q,fa.ResponseStatusCode);Y.setResult(!1)},qa=Object(w.a)(new O.a,{mLa:OSF.InfoType.Error,title:ca.addinTitle,description:String.format(K.a.instance.lb(153),K.a.instance.ga(1867)),buttonText:K.a.instance.ga(4),qha:qa,Kdc:!1,hia:qa,errorCode:OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError}),
z.a.UQd(qa))},function(qa){qa=G.a.Of(qa.data);n.ULS.sendTraceTag(537163480,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}. Errors: {1}.",Q,T.a.Dc(qa));F.EwaSettings.ma(257)&&l(a.Drb,Q);delete ka.aF[ca.addinId];Y.setResult(!1)},H,Y,!0)};a.prototype.k0b=function(H,Q,ca){var X=this,Z=new r.a;Q.forEach(function(ka){ka=Object(v.a)(String,ka);H.$we(ka)});H.sia();var ea=this.kYc(ca);return this.Cia(function(ka){F.EwaSettings.ma(257)&&
l(a.Erb,Sys.Serialization.JavaScriptSerializer.serialize(Q));ka=ka.Result;var Y=!0,qa=Sys.Serialization.JavaScriptSerializer.deserialize(ka.ResponseBody.toString());qa=Array.isArray(qa.value)?qa.value:null;for(var fa=0;fa<qa.length;fa++)qa[fa]||(Y=!1,delete X.aF[ca.registrationInfos[fa].addinId],a.PHd(Q[fa]),a.WHd(Q[fa]),n.ULS.sendTraceTag(537163478,0,10,"CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: {0}. Received status code {1}.",Q[fa],ka.ResponseStatusCode));
C.TaskExtensions.Ba(X.MEd(Z,"",!1),function(ha){ha.Yf?n.ULS.sendTraceTag(537163477,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):ha.Ch&&n.ULS.sendTraceTag(537163476,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");Z.setResult(!1)},X.$.la,4);Z.setResult(Y)},function(ka){ka=G.a.Of(ka.data);n.ULS.sendTraceTag(537163475,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds {0}. Errors: {1}.",
Sys.Serialization.JavaScriptSerializer.serialize(Q),T.a.Dc(ka));F.EwaSettings.ma(257)&&l(a.Drb,Sys.Serialization.JavaScriptSerializer.serialize(Q));ka=ak(ca.registrationInfos);for(var Y=ka.next();!Y.done;Y=ka.next())delete X.aF[Y.value.addinId];Z.setResult(!1)},ea,Z,!0)};a.prototype.fXd=function(H,Q,ca){var X=this,Z=new r.a;H.wHb(Q);H=this.wYc(ca);return this.Cia(function(){F.EwaSettings.ma(257)&&l(a.t4c,Q);C.TaskExtensions.Ba(X.MEd(Z,ca.solutionId,!1),function(ea){ea.Yf?Q&&n.ULS.sendTraceTag(537163473,
0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}.",Q):ea.Ch&&Q&&n.ULS.sendTraceTag(537163472,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution {0}.",Q);Z.setResult(!1)},X.$.la,4)},function(ea){ea=G.a.Of(ea.data);n.ULS.sendTraceTag(537163471,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}. Errors: {1}.",
Q,T.a.Dc(ea));F.EwaSettings.ma(257)&&l(a.s4c,Q);Z.setResult(!1)},H,Z,!1)};a.prototype.Cia=function(H,Q,ca,X,Z){function ea(){function ia(S,da,xa){F.EwaSettings.ma(257)&&l(Z?a.r4c:a.u4c,wa.RequestBody);return y.g(Y.xa,"ExecuteRichApiRequest",ca,J.b(S,H),J.a(da,Q),xa,null,0)}if(ka.hHa()||0<Y.xa.P3||0<Y.Gk.P3)return!1;qa&&ka.wo(qa);fa&&Y.cs(fa);ha&&Y.Hz(ha);var wa=ca.request,Qa=wa.RequestFlags&1?0:16;F.EwaSettings.Zb()?ka.St(new B.a(507,0,ia,Qa|64)):ka.St(new A.a(507,0,ia,Qa));return!0}var ka=this.$.userOperationManager,
Y=this.$.oa,qa=null,fa=null,ha=null;ea()||(qa=function(){ea()},fa=function(){ea()},ha=function(){ea()},ka.Cr(qa),Y.Vq(fa),Y.Ky(ha));return X.task};a.prototype.Vob=function(H){var Q={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};Q.RequestBody=JSON.stringify(H);Q.RequestFlags=1;H=this.$.oa.xa.Na(1);H.request=Q;return H};a.prototype.kYc=function(H){var Q={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};Q.RequestBody=JSON.stringify(H);
Q.RequestFlags=1;H=this.$.oa.xa.Na(1);H.request=Q;return H};a.prototype.wYc=function(H){var Q={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};Q.RequestBody=JSON.stringify(H);Q.RequestFlags=1;H=this.$.oa.xa.Na(1);H.request=Q;return H};a.prototype.MEd=function(H,Q,ca){var X=this,Z=x.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1);C.TaskExtensions.Ba(Z,function(){Z.result.gKd();Q&&ca&&X.dhj(Q);H.setResult(!0)},this.$.la,3);return Z};a.prototype.z$e=function(){return N.Task.Ua(!0)};
a.iGd=function(){return(Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(a.nvb(E.a.EYa)||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(a.nvb(E.a.EYa)||"[]"):null)||[]};a.vgg=function(H){a.nOd(E.a.EYa,Sys.Serialization.JavaScriptSerializer.serialize(H))};a.dGd=function(H){H=a.nvb(E.a.K3a(H))||"";return 0<H.length?Sys.Serialization.JavaScriptSerializer.deserialize(H,!0):null};a.PXj=function(H,Q){a.OKe(H);a.nOd(E.a.K3a(H),Sys.Serialization.JavaScriptSerializer.serialize(Q))};
a.PHd=function(H){a.cOf(H);a.xOf(E.a.K3a(H))};a.D5i=function(H){return a.nvb(E.a.J3a(H))};a.QXj=function(H,Q){a.OKe(H);a.nOd(E.a.J3a(H),Q)};a.WHd=function(H){a.cOf(H);a.xOf(E.a.J3a(H))};a.OKe=function(H){var Q=a.iGd();H=H.toLowerCase();Array.contains(Q,H)||(Q.push(H),a.vgg(Q))};a.cOf=function(H){var Q=a.iGd();H=H.toLowerCase();Array.contains(Q,H)&&(Q.splice(Array.indexOf(Q,H),1),a.vgg(Q))};a.cacheManifest=function(H,Q){H=new f(H);H.needToRestoreManifest&&a.QXj(H.solutionId,Q)};a.nvb=function(H){try{return localStorage.getItem(H)}catch(Q){return n.ULS.sendTraceTag(537163469,
0,50,"CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: {0}",Q.message||"Unknown"),null}};a.nOd=function(H,Q){try{localStorage.setItem(H,Q)}catch(ca){n.ULS.sendTraceTag(537163468,0,50,"CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: {0}",ca.message||"Unknown")}};a.xOf=function(H){try{localStorage.removeItem(H)}catch(Q){n.ULS.sendTraceTag(537163467,0,50,"CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: {0}",
Q.message||"Unknown")}};a.Gqd=function(H){if(!H)return!1;try{JSON.parse(H)}catch(Q){return!1}return!0};a.r4c=new c(2,"CustomFunctions [Registration] [Begin] SolutionId=");a.Erb=new c(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");a.Drb=new c(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");a.u4c=new c(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");a.t4c=new c(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");a.s4c=new c(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");
Object(u.a)(a,"CustomFunctionsLegacyInstaller",null,[841])},1439:function(u,D,b){function a(I,U,M,T,F){this.$=I;this.te=U;this.ownerAddinInfo=M;this.Ed=void 0===F?null:F;this.rQa=(void 0===T?null:T)||G.Task.Ua(!0);return this}function c(I){var U=C.call(this)||this;U.QCa="AddInCommandsDialog";U.ze=U.QCa;U.Rb=5;U.dialogWidth=695;U.dialogHeight=438;U.G1g="100%";U.D1g="408px";U.E1g="15px";U.F1g="0";U.Wsg=I;return U}function d(I,U,M,T,F,K){var J=I.Na(9);J.sharedInfo=U;return n.g(I,"InsertAgaveTaskpane",
J,M,T,F,K,0)}function e(){}u=b(0);var k=b(214),l=b(15);Object(u.a)(e,"AddinCommandsHost",null,[]);var m=b(1518),f=b(1596),w=b(1072),n=b(61),z=b(564),r=b(389),v=b(177),A=b(37),B=b(1),y=b(295),x=b(150),C=x.a;Rk(c,C);c.prototype.dD=function(){C.prototype.dD.call(this);this.vp.style.width=this.G1g;this.vp.style.height=this.D1g;this.vp.style.marginTop=this.E1g;this.vp.style.padding=this.F1g};c.prototype.lO=function(){C.prototype.lO.call(this);this.Db.style.width=String.format("{0}px",this.dialogWidth);
this.Db.style.height=String.format("{0}px",this.dialogHeight)};c.prototype.dispose=function(){C.prototype.dispose.call(this);this.Wsg()};Af.Object.defineProperties(c.prototype,{containerDiv:{configurable:!0,enumerable:!0,get:function(){return this.vp}}});Object(u.a)(c,"AddInCommandsDialog",x.a,[]);var G=b(58),E=b(63);x=b(100);b.d(D,"a",function(){return a});Rk(a,e);a.prototype.y1g=function(){var I=this.rQa;this.rQa=G.Task.Ua(!0);return I};a.prototype.disposeHost=function(I){this.te.UPa(I)};a.prototype.setOwnerAddinEToken=
function(I){this.ownerAddinInfo.eToken=I};a.prototype.showTaskpane=function(I,U,M){var T=this;l.ULS.sendTraceTag(537170642,220,50,"ShowTaskpane action called.");var F=null,K=!1,J=(new m.a("m_excelWebRenderer_ewaCtl_",this.ownerAddinInfo.solutionId,new w.a,!0)).eFe(I.solutionId.substr(this.ownerAddinInfo.solutionId.length));F=U.getSharedRuntimeForTaskpane("Workbook",J);K=!!F&&1===F.LifeTime;this.te.cxe(K?this.ownerAddinInfo.solutionId:I.solutionId,K?F:null,null)||(this.Wlf(K,!0),this.rQa=this.kld(I,
F,function(O,N){O?(K&&(O.PrimaryMarketplace.SolutionId=T.ownerAddinInfo.solutionId,O.SharedRuntime=F),O.WebExtensionOsfControlType=3,T.te.r0a(O),M(O.InstanceId,N),T.Wlf(K,!1),B.EwaSettings.isChangeGateEnabled("OfficeVSO:6085876_TelemetryForActiveAddinSuccessOnExcelWacEnabled")&&l.ULS.sendTraceTag(524818146,220,50,"ShowTaskpane: succeed to call.")):(l.ULS.sendTraceTag(17306640,220,10,"ShowTaskpane: instance id is null."),M(null,N))}))};a.prototype.getSettings=function(I,U){var M=this.te.qaa(I.solutionId);
M?U(this.te.iZ(M).OsfPropertyBag):this.rQa=this.kld(I,null,function(T){T?U(T.OsfPropertyBag):l.ULS.sendTraceTag(537170641,220,10,"GetSettings: insertData is null.")})};a.prototype.showDialog=function(I,U,M){function T(N,H,Q){return d(J,O,y.b(N,F),H,Q,null)}function F(N){var H=N.Result,Q=H?H.AgaveData:null;Q?(K.te.YDe(Q,function(){var ca=new c(function(){K.disposeHost(Q.InstanceId)});ca.initializeAndShow("",null,null);return ca.containerDiv}),M(Q.InstanceId,0)):(l.ULS.sendTraceTag(537170638,220,10,
"ShowDialog: instance id is null."),M(null,N.Errors?N.Errors[0].ErrorCause:5001))}var K=this;l.ULS.sendTraceTag(537170640,220,50,"ShowDialog action called.");var J=this.$.oa.xa,O=a.krb(I,this.ownerAddinInfo);B.EwaSettings.Zb()?this.rQa=r.a(this.$.userOperationManager,T,function(N){return new v.a(500,0,N,64)},this.Ed):this.rQa=r.a(this.$.userOperationManager,T,function(N){return new z.a(500,0,N)},this.Ed)};a.prototype.createUILessSandbox=function(I,U,M){var T=this;l.ULS.sendTraceTag(537170637,220,
50,"UILess action called.");var F=U.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"),K=!!F&&1===F.LifeTime;(U=this.te.LAh(K?this.ownerAddinInfo.solutionId:I.solutionId,K?F:null))?M(U,0):this.rQa=this.kld(I,F,function(J,O){J?(K?(J.PrimaryMarketplace.SolutionId=T.ownerAddinInfo.solutionId,J.SharedRuntime=F,J.TaskpaneVisible=!1,J.WebExtensionOsfControlType=3,T.te.r0a(J)):(J.WebExtensionOsfControlType=4,T.te.YDe(J,function(){a.Ceb.ia(J.InstanceId,new f.a);return a.Ceb.na(J.InstanceId).c1a})),M(J.InstanceId,
O)):(l.ULS.sendTraceTag(537170636,220,10,"UILess: instance id is null."),M(null,O))})};a.prototype.kld=function(I,U,M){function T(X,Z,ea){return d(O,N,y.b(X,F),Z,ea,null)}function F(X){var Z=X.Result;(J=Z?Z.AgaveData:null)||M(null,X.Errors?X.Errors[0].ErrorCause:5001)}var K=this,J=null,O=this.$.oa.xa,N=a.krb(I,this.ownerAddinInfo);U&&(l.ULS.sendTraceTag(537170634,220,50,"Shared runtime agave is inserted."),N.SharedRuntimeId=U.Resid);var H=500,Q=0;void 0===N.IsToBePersisted||null===N.IsToBePersisted||
N.IsToBePersisted||(H=538,T=function(X,Z,ea){l.ULS.sendTraceTag(537170633,220,50,"Web Method ShowAgaveTaskpane is called, StoreType {0}, StoreId {1}, SolutionId {2}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(K.ownerAddinInfo.solutionId,K.ownerAddinInfo.storeType,K.ownerAddinInfo.assetId,null,null,K.ownerAddinInfo.storeId));X=y.b(X,F);var ka=O.Na(9,null);ka.sharedInfo=N;return n.g(O,"ShowAgaveTaskpane",ka,X,Z,ea,null,0)},Q=16);if(B.EwaSettings.Zb()){Q|=64;var ca=r.a(this.$.userOperationManager,
T,function(X){return new v.a(H,0,X,Q)},this.Ed)}else ca=r.a(this.$.userOperationManager,T,function(X){return new z.a(H,0,X,Q)},this.Ed);return A.TaskExtensions.ts(ca,function(){return J?K.Ssd(O,J.InstanceId,function(X,Z){if(X){U||(J.PrimaryMarketplace.MarketplaceType=I.storeType);J.OwnerAddinSolutionId=K.ownerAddinInfo.solutionId;J.OwnerAddinStoreType=K.ownerAddinInfo.storeType;J.OsfPropertyBag=[];for(Z=0;Z<X.Settings.length;Z++){var ea=[];ea[0]=X.Settings[Z].Name;ea[1]=X.Settings[Z].Value;J.OsfPropertyBag[Z]=
ea}M(J,0)}else M(null,Z.Errors?Z.Errors[0].ErrorCause:5001)}):G.Task.Ua(!1)},k.a.none,3,E.a.current)};a.prototype.Ssd=function(I,U,M){function T(K,J,O){K=y.b(K,F);var N=I.Na(1);N.controlId=U;return n.g(I,"DdaLoadSettings",N,K,J,O,null,0)}function F(K){M(K.Result,K)}return B.EwaSettings.Zb()?r.a(this.$.userOperationManager,T,function(K){return new v.a(501,0,K,80)},this.Ed):r.a(this.$.userOperationManager,T,function(K){return new z.a(501,0,K,16)},this.Ed)};a.prototype.Wlf=function(I,U){var M;I&&(null===
(M=window.performance)||void 0===M?0:M.memory)&&l.ULS.sendTraceTag(537170630,220,50,"Shared runtime memory usage: before={0}, jsHeapSizeLimit={1}, totalJSHeapSize={2}, usedJSHeapSize={3}",U,window.performance.memory.jsHeapSizeLimit,window.performance.memory.totalJSHeapSize,window.performance.memory.usedJSHeapSize)};a.showUILessDialog=function(I){a.Ceb.kb(I)&&a.Ceb.na(I).initializeAndShowWithTitle()};a.hideUILessDialog=function(I){a.Ceb.kb(I)&&a.Ceb.na(I).hide()};a.krb=function(I,U){var M={};M.SolutionId=
I.solutionId;M.Version=I.version;M.StoreType=U.storeType;M.StoreId=I.storeId;M.AssetId=I.solutionId;M.AssetStoreId="omex";M.TargetType=1;M.Width=350;M.OwnerAddinSolutionId=U.solutionId;M.OwnerAddinStoreType=U.storeType;M.SharedRuntimeId=null;M.Preload=!1;return M};a.Ceb=new x.a;Object(u.a)(a,"WACExcelAddinCommandsHost",e,[])},1445:function(u,D,b){function a(){e.a.Fa(function(y){c.ka(y)})}function c(y){return B.call(this,y)||this}function d(y,x,C){this.Hrb=null;this.$=y;x?(l.ULS.sendTraceTag(537163346,
0,50,"DataFromPictureCommandHandler.constructor - AugmentationLoopManager and UploaderCreator instantiated."),this.Hrb=new w.a(y,x,C)):l.ULS.sendTraceTag(537163347,0,10,"DataFromPictureCommandHandler.constructor - Failed to instantiate AugmentationLoopManager.")}var e=b(11);u=b(0);var k=b(905),l=b(15),m=b(104),f=b(4),w=b(1510),n=b(1),z=b(186),r=b(58);d.prototype.Lc=function(){return!1};d.prototype.executeCommand=function(y,x,C){y=!1;switch(x.command){case 73979048:this.Hrb&&this.Hrb.G_i(x,m.a.instance,
f.AFrameworkApplication.fa,C),y=!0}return y?r.Task.Ua(!0):z.a(x.command)};d.prototype.Ac=function(y,x){return 73979048===x.command&&n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)};d.prototype.Qc=function(){return!1};d.prototype.dispose=function(){this.Hrb&&this.Hrb.dispose()};Object(u.a)(d,"DataFromPictureCommandHandler",null,[403,10]);var v=b(37),A=b(51),B=k.a;Rk(c,B);c.prototype.zd=function(){var y=this,x=A.GetServiceTaskFactory.Ra(this.$.da,328,327,1),C=A.GetServiceTaskFactory.Ra(this.$.da,
484,485,1);v.TaskExtensions.Ba(v.TaskExtensions.Wd([x,C],this.$.la),function(){y.jd([new d(y.$,x.result,C.result)])},this.$.la,3)};c.ka=function(y){k.a.Qd(452,new c(y))};Object(u.a)(c,"DataFromPictureCommandHandlerFactory",k.a,[]);b.d(D,"a",function(){return a})},1502:function(u,D,b){function a(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=
!0;this.supportsAuthToken=!1}b.d(D,"a",function(){return a});u=b(0);a.rIh=function(c){switch(c){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}};Object(u.a)(a,"WopiAuthContext",null,[169])},1503:function(u,D,b){function a(){}b.d(D,"a",function(){return a});u=b(0);a.RDf="OneDriveWOPI";Object(u.a)(a,"HostApplicationType",null,[])},1504:function(u,D,b){function a(c,d,e,k){this._id=c;this.Fwg=d;this.Gge=e;this.xUa=k}b.d(D,"a",function(){return a});u=b(0);a.prototype.getId=
function(){return this._id};a.prototype.getStoreId=function(){return this.Fwg};a.prototype.getStoreType=function(){return this.Gge};Object(u.a)(a,"ExtensionIdentity",null,[309])},1505:function(u,D,b){function a(c,d,e){this.D$d=e}b.d(D,"a",function(){return a});u=b(0);Object(u.a)(a,"HostProperties",null,[])},1506:function(u,D,b){function a(){this.optionalProperties={};this.nq={}}b.d(D,"a",function(){return a});u=b(0);Object(u.a)(a,"ExtensionLaunchProperties",null,[])},1507:function(u,D,b){function a(){this.La=
m.AFrameworkApplication.ub}b.d(D,"a",function(){return a});u=b(0);var c=b(1504),d=b(1506),e=b(1170),k=b(1509),l=b(1505),m=b(4),f=b(635),w=b(27);a.prototype.bNa=function(n,z,r,v,A){this.Vqi(n,z,r,v,A)};a.prototype.Vqi=function(n,z,r,v,A){var B=b(1508).ExtensionComponentInstance,y={};y[e.a.O8b]=n;y[e.a.nAe]=z;y[e.a.bHa]=r;y[e.a.vjd]=v;y[e.a.Iya]=A;v=8;if(m.AFrameworkApplication.Kpd(n.getId()))switch(z){case k.a.action:v=this.La.ae(w.a.vQe,2,y);break;case k.a.taskpane:v=this.La.ae(w.a.H2f,2,y);break;
case k.a.Nkj:v=this.La.ae(w.a.nri,2,y);break;default:v=16}32===v?(v=f.a.create().toString(),A.optionalProperties.InstanceToken&&(v=A.optionalProperties.InstanceToken),n=new B(n,z,r,v),a.Cv[v]=n):n=new B(n,z,r,null);n.boj(y)};a.prototype.Uqi=function(n){var z=n.ExtId,r=n.ComponentType,v=n.ComponentId,A=n.HostProps;n=n.OptionalProps;z=new c.a(z.Id,z.StoreId,z.StoreType,z.AppVersion);A=new l.a(A.HostType,A.FormFactor,A.Locale);var B=new d.a;B.optionalProperties=n.OptionalProperties;B.nq=n.DevProperties;
a.instance.bNa(z,r,v,A,B)};a.prototype.getInstance=function(n){return a.Cv[n]};a.prototype.s$i=function(n){delete a.Cv[n]};Af.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){a.MHc||(a.MHc=new a);return a.MHc}}});a.MHc=null;a.Cv={};Object(u.a)(a,"ExtensionLifeCycleManager",null,[298])},1508:function(u,D,b){function a(k,l,m,f){this.xUa=this.hG=null;this._id=k;this.nmg=m;this.lqg=f;this.La=d.AFrameworkApplication.ub?d.AFrameworkApplication.ub:null}b.r(D);b.d(D,"ExtensionComponentInstance",
function(){return a});u=b(0);var c=b(1507),d=b(4),e=b(27);a.prototype.Hcd=function(){return this.nmg};a.prototype.boj=function(k){this.hG=k};a.prototype.stop=function(){var k=this.La.ae(e.a.gZg,2,this.hG);c.a.instance.s$i(this.lqg);return 32===k};a.prototype.Ctc=function(){this.La.ae(e.a.USf,2,this.hG)};Af.Object.defineProperties(a.prototype,{appVersion:{configurable:!0,enumerable:!0,get:function(){return this.xUa}}});Object(u.a)(a,"ExtensionComponentInstance",null,[321])},1509:function(u,D,b){function a(){}
b.d(D,"a",function(){return a});u=b(0);a.taskpane="Taskpane";a.action="Action";a.Nkj="SDXDialog";Object(u.a)(a,"ComponentTypeNames",null,[])},1510:function(u,D,b){(function(a){function c(E,I,U){var M=G.call(this)||this;M.K8e=m.a.getTypeName();M.Ed=null;M.eU=null;M.pxb=null;M.imageWidth=0;M.imageHeight=0;M.tableData=null;M.errorMessage=null;M.jLa=null;M.Cjd=0;M.SSc=!1;M.mFe=function(T){if(T){var F={};if(function(){var Q=x.d(M.Wbh(T.data));F=Q.Pt;return Q}().returnValue){var K=Object(l.a)(Object,F);
if("."===K.DataFromPictureWildcard)if(K.SessionId!==M.jLa)e.ULS.sendTraceTag(523805139,0,10,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(e.ULS.sendTraceTag(523805138,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane"),K.CmdType){case "ACK":M.SSc=!0;M.S7f.stop();e.ULS.sendTraceTag(523805137,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - SDX pane launched.");
M.Gmj();0<M.errorMessage.length?M.KWf():0<M.tableData.length&&M.aXf();break;case "insert_html":var J=M.$.oa.xa,O={},N=y.g(M.$).ha.sa.Vc.clone();O.PasteId=k.a.create().toString();O.DestinationRanges=n.s(n.v(N,M.$));N=K.Parameters.split("|",3);e.ULS.sendTraceTag(523805136,0,50,"DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - LCC:{0}|{1}|{2}.",N[0],N[1],N[2]);N=K.Parameters.indexOf("|");N=K.Parameters.indexOf("|",N+1);N=K.Parameters.indexOf("|",N+1);O.SourceHtml=K.Parameters.substring(N+
1);O.CopyOperationId=null;var H=J.Na(1,J.Pb());H.pasteHtmlParameters=O;z.a(M.$.userOperationManager,function(Q,ca,X){return v.g(J,"pasteHtmlContent",H,Q,ca,X,null,64)},function(Q){return new r.a(204,0,Q,1)},null);M.Cjd++;e.ULS.sendTraceTag(523805135,0,50,"DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - Number of pastes to workbook per Session ID:{0}",M.Cjd.toString())}}}};M.X7h=function(T,F){if(T=F.mJ)if(!F.parentPath||1>=F.parentPath.length||F.parentPath[1]!==M.jLa)e.ULS.sendTraceTag(523805124,
0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");else{e.ULS.sendTraceTag(523805123,0,50,"DataFromPictureManager.ImageToTableAnnotationHandler() - Annotation Received.");F=T.errorCode;switch(F){case null:case -1:M.errorMessage=B.a.instance.ga(2238);break;case 1:M.errorMessage=B.a.instance.ga(2239);break;case 2:M.errorMessage=B.a.instance.ga(2240)}0<M.errorMessage.length&&e.ULS.sendTraceTag(523805122,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - ErrorCode:{0}.",
F?F.toString():"null");M.fpe.stop();M.tableData=T.html;M.SSc&&(0<M.errorMessage.length?M.KWf():0<M.tableData.length&&M.aXf())}else e.ULS.sendTraceTag(523805125,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - Received annotation is null.")};M.$=E;M.augmentationLoopManager=I;M.uploaderCreator=U;M.initialize();return M}b.d(D,"a",function(){return c});var d=b(0),e=b(15),k=b(178),l=b(85),m=b(1515),f=b(38),w=b(246),n=b(45),z=b(389),r=b(177),v=b(61),A=b(92),B=b(14),y=b(21),x=b(41),C=b(1516),
G=f.a;Rk(c,G);c.prototype.dispose=function(){window.removeEventListener("message",this.mFe,!1);G.prototype.dispose.call(this)};c.prototype.zSi=function(E,I){var U=this;e.ULS.sendTraceTag(523805146,0,50,"DataFromPictureManager.onSuccessfulFileLoad - Start function.");var M=new Image;M.onload=function(){var T=document.createElement("canvas");T.width=M.width;T.height=M.height;var F=T.getContext("2d");try{F.drawImage(M,0,0,M.width,M.height)}catch(O){e.ULS.sendTraceTag(523805145,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't draw to canvas. ex.Message: {0}",
O.message);return}try{var K=T.toDataURL("image/jpeg")}catch(O){e.ULS.sendTraceTag(523805144,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg. ex.Message: {0}",O.message);return}T=K.split(",");if(2>T.length)e.ULS.sendTraceTag(523805143,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg.");else{T=T[1];try{var J=window.self.atob(T)}catch(O){e.ULS.sendTraceTag(523805142,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't convert image to byte string. ex.Message: {0}",
O.message);return}28E5<J.length?(e.ULS.sendTraceTag(523805141,0,15,"DataFromPictureManager.onSuccessfulFileLoad - Image exceeds max size limit."),I.yzj()):(U.Qij(U.Ed,U.eU,T,M.width,M.height),URL.revokeObjectURL(M.src),M=null,e.ULS.sendTraceTag(523805140,0,50,"DataFromPictureManager.onSuccessfulFileLoad - End function."))}};M.src=E};c.prototype.G_i=function(E,I,U,M){this.Ed=E;this.eU=M;this.uploaderCreator.E$h(this.$,I,U,M,this)};c.prototype.Qij=function(E,I,U,M,T){this.jLa=k.a.create().toString();
this.Cjd=0;this.pxb=U;this.imageWidth=M;this.imageHeight=T;this.errorMessage=this.tableData="";this.SSc=!1;this.S7f=this.$.Fb.Lg("LoadResource","DataFromPictureTaskpaneLaunch");this.S7f.start();this.cVi(E,I);this.fpe=this.$.Fb.Lg("LoadResource","DataFromPictureAnnotation");this.fpe.start();this.bUj()};c.prototype.bUj=function(){if(this.pxb.length){var E=window.self.atob(this.pxb);for(var I=new Uint8Array(E.length),U=0;U<E.length;U++)I[U]=E.charCodeAt(U);this.augmentationLoopManager.aUj(I,this.jLa,
this.imageWidth,this.imageHeight)}else e.ULS.sendTraceTag(523805134,0,10,"DataFromPictureManager.UploadImageToAugmentationLoop - imageDataBase64 is empty")};c.prototype.cVi=function(E,I){I.SessionID=this.jLa;I.DataFromPictureAssetId="FA000000050";I.LoadDataFromPictureTaskpane=!0;E=new A.a(-859308420,E.method,E.mode,E.Me,E.tabName);this.$.Ka.Kb(E,I)};c.prototype.l7c=function(E){try{var I=a.from(E,"utf16le").toString("base64");return C.a.oHa(this.jLa,I)}catch(U){return e.ULS.sendTraceTag(523805133,
0,10,"DataFromPictureManager.encodeAndEncrypt - Buffer can't encode message.",U.message),""}};c.prototype.Wbh=function(E){try{var I=C.a.oHa(this.jLa,E);return a.from(I,"base64").toString("utf16le")}catch(U){return e.ULS.sendTraceTag(523805132,0,50,"DataFromPictureManager.decryptAndDecode - Buffer can't decode message.",U.message),""}};c.prototype.Gmj=function(){if(this.pxb.length){var E=w.a(this.$).qaa("FA000000050"),I={};I=(I.DataFromPictureWildcard=".",I);I.imageData=this.l7c(this.pxb);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(E,
"onCustomMessage",I,function(U){U&&e.ULS.sendTraceTag(523805130,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})}else e.ULS.sendTraceTag(523805131,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.")};c.prototype.aXf=function(){if(this.tableData.length){var E=w.a(this.$).qaa("FA000000050"),I={};I=(I.DataFromPictureWildcard=".",I);I.tableHtml=this.l7c(this.tableData);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(E,
"onCustomMessage",I,function(U){U&&e.ULS.sendTraceTag(523805128,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})}else e.ULS.sendTraceTag(523805129,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.")};c.prototype.KWf=function(){if(this.errorMessage.length){var E=w.a(this.$).qaa("FA000000050"),I={};I=(I.DataFromPictureWildcard=".",I);I.errorMessage=this.l7c(this.errorMessage);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(E,
"onCustomMessage",I,function(U){U&&e.ULS.sendTraceTag(523805126,0,10,"DataFromPictureManager.sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})}else e.ULS.sendTraceTag(523805127,0,10,"DataFromPictureManager.sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.")};c.prototype.initialize=function(){window.addEventListener("message",this.mFe,!1);this.augmentationLoopManager.activateAnnotation(this.K8e);this.augmentationLoopManager.gJ(this.K8e,
this.X7h)};Object(d.a)(c,"DataFromPictureManager",f.a,[622])}).call(this,b(1511).ghg)},1511:function(u,D,b){(function(a){function c(){try{var T=new Uint8Array(1);T.__proto__={__proto__:Uint8Array.prototype,Kad:function(){return 42}};return 42===T.Kad()&&"function"===typeof T.subarray&&0===T.subarray(1,1).byteLength}catch(F){return!1}}function d(T,F){if((e.UO?2147483647:1073741823)<F)throw new RangeError("Invalid typed array length");e.UO?(T=new Uint8Array(F),T.__proto__=e.prototype):(null===T&&(T=
new e(F)),T.length=F);return T}function e(T,F,K){if(!(e.UO||this instanceof e))return new e(T,F,K);if("number"===typeof T){if("string"===typeof F)throw Error("If encoding is specified then the first argument must be a string");return m(this,T)}return k(this,T,F,K)}function k(T,F,K,J){if("number"===typeof F)throw new TypeError('"value" argument must not be a number');if("undefined"!==typeof ArrayBuffer&&F instanceof ArrayBuffer){F.byteLength;if(0>K||F.byteLength<K)throw new RangeError("'offset' is out of bounds");
if(F.byteLength<K+(J||0))throw new RangeError("'length' is out of bounds");F=void 0===K&&void 0===J?new Uint8Array(F):void 0===J?new Uint8Array(F,K):new Uint8Array(F,K,J);e.UO?(T=F,T.__proto__=e.prototype):T=f(T,F);F=T}else if("string"===typeof F){J=T;T=K;if("string"!==typeof T||""===T)T="utf8";if(!e.$bf(T))throw new TypeError('"encoding" must be a valid string encoding');K=z(F,T)|0;J=d(J,K);F=J.write(F,T);F!==K&&(J=J.slice(0,F));F=J}else F=w(T,F);return F}function l(T){if("number"!==typeof T)throw new TypeError('"size" argument must be a number');
if(0>T)throw new RangeError('"size" argument must not be negative');}function m(T,F){l(F);T=d(T,0>F?0:n(F)|0);if(!e.UO)for(var K=0;K<F;++K)T[K]=0;return T}function f(T,F){var K=0>F.length?0:n(F.length)|0;T=d(T,K);for(var J=0;J<K;J+=1)T[J]=F[J]&255;return T}function w(T,F){if(e.isBuffer(F)){var K=n(F.length)|0;T=d(T,K);if(0===T.length)return T;F.copy(T,0,0,K);return T}if(F){if("undefined"!==typeof ArrayBuffer&&F.buffer instanceof ArrayBuffer||"length"in F)return(K="number"!==typeof F.length)||(K=F.length,
K=K!==K),K?d(T,0):f(T,F);if("Buffer"===F.type&&I(F.data))return f(T,F.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}function n(T){if(T>=(e.UO?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(e.UO?2147483647:1073741823).toString(16)+" bytes");return T|0}function z(T,F){if(e.isBuffer(T))return T.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(T)||
T instanceof ArrayBuffer))return T.byteLength;"string"!==typeof T&&(T=""+T);var K=T.length;if(0===K)return 0;for(var J=!1;;)switch(F){case "ascii":case "latin1":case "binary":return K;case "utf8":case "utf-8":case void 0:return y(T).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*K;case "hex":return K>>>1;case "base64":return C(T).length;default:if(J)return y(T).length;F=(""+F).toLowerCase();J=!0}}function r(T,F,K){var J=!1;if(void 0===F||0>F)F=0;if(F>this.length)return"";
if(void 0===K||K>this.length)K=this.length;if(0>=K)return"";K>>>=0;F>>>=0;if(K<=F)return"";for(T||(T="utf8");;)switch(T){case "hex":T=F;F=K;K=this.length;if(!T||0>T)T=0;if(!F||0>F||F>K)F=K;J="";for(K=T;K<F;++K)T=J,J=this[K],J=16>J?"0"+J.toString(16):J.toString(16),J=T+J;return J;case "utf8":case "utf-8":return B(this,F,K);case "ascii":T="";for(K=Math.min(this.length,K);F<K;++F)T+=String.fromCharCode(this[F]&127);return T;case "latin1":case "binary":T="";for(K=Math.min(this.length,K);F<K;++F)T+=String.fromCharCode(this[F]);
return T;case "base64":return 0===F&&K===this.length?E.uUe(this):E.uUe(this.slice(F,K));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":F=this.slice(F,K);K="";for(T=0;T<F.length;T+=2)K+=String.fromCharCode(F[T]+256*F[T+1]);return K;default:if(J)throw new TypeError("Unknown encoding: "+T);T=(T+"").toLowerCase();J=!0}}function v(T,F,K,J,O){if(0===T.length)return-1;"string"===typeof K?(J=K,K=0):2147483647<K?K=2147483647:-2147483648>K&&(K=-2147483648);K=+K;isNaN(K)&&(K=O?0:T.length-1);0>K&&(K=
T.length+K);if(K>=T.length){if(O)return-1;K=T.length-1}else if(0>K)if(O)K=0;else return-1;"string"===typeof F&&(F=e.from(F,J));if(e.isBuffer(F))return 0===F.length?-1:A(T,F,K,J,O);if("number"===typeof F)return F&=255,e.UO&&"function"===typeof Uint8Array.prototype.indexOf?O?Uint8Array.prototype.indexOf.call(T,F,K):Uint8Array.prototype.lastIndexOf.call(T,F,K):A(T,[F],K,J,O);throw new TypeError("val must be string, number or Buffer");}function A(T,F,K,J,O){function N(X,Z){return 1===H?X[Z]:X.P5i(Z*H)}
var H=1,Q=T.length,ca=F.length;if(void 0!==J&&(J=String(J).toLowerCase(),"ucs2"===J||"ucs-2"===J||"utf16le"===J||"utf-16le"===J)){if(2>T.length||2>F.length)return-1;H=2;Q/=2;ca/=2;K/=2}if(O)for(J=-1;K<Q;K++)if(N(T,K)===N(F,-1===J?0:K-J)){if(-1===J&&(J=K),K-J+1===ca)return J*H}else-1!==J&&(K-=K-J),J=-1;else for(K+ca>Q&&(K=Q-ca);0<=K;K--){Q=!0;for(J=0;J<ca;J++)if(N(T,K+J)!==N(F,J)){Q=!1;break}if(Q)return K}return-1}function B(T,F,K){K=Math.min(T.length,K);for(var J=[];F<K;){var O=T[F],N=null,H=239<
O?4:223<O?3:191<O?2:1;if(F+H<=K)switch(H){case 1:128>O&&(N=O);break;case 2:var Q=T[F+1];128===(Q&192)&&(O=(O&31)<<6|Q&63,127<O&&(N=O));break;case 3:Q=T[F+1];var ca=T[F+2];128===(Q&192)&&128===(ca&192)&&(O=(O&15)<<12|(Q&63)<<6|ca&63,2047<O&&(55296>O||57343<O)&&(N=O));break;case 4:Q=T[F+1];ca=T[F+2];var X=T[F+3];128===(Q&192)&&128===(ca&192)&&128===(X&192)&&(O=(O&15)<<18|(Q&63)<<12|(ca&63)<<6|X&63,65535<O&&1114112>O&&(N=O))}null===N?(N=65533,H=1):65535<N&&(N-=65536,J.push(N>>>10&1023|55296),N=56320|
N&1023);J.push(N);F+=H}T=J.length;if(T<=U)J=String.fromCharCode.apply(String,J);else{K="";for(F=0;F<T;)K+=String.fromCharCode.apply(String,J.slice(F,F+=U));J=K}return J}function y(T,F){F=F||Infinity;for(var K,J=T.length,O=null,N=[],H=0;H<J;++H){K=T.charCodeAt(H);if(55295<K&&57344>K){if(!O){if(56319<K){-1<(F-=3)&&N.push(239,191,189);continue}else if(H+1===J){-1<(F-=3)&&N.push(239,191,189);continue}O=K;continue}if(56320>K){-1<(F-=3)&&N.push(239,191,189);O=K;continue}K=(O-55296<<10|K-56320)+65536}else O&&
-1<(F-=3)&&N.push(239,191,189);O=null;if(128>K){if(0>--F)break;N.push(K)}else if(2048>K){if(0>(F-=2))break;N.push(K>>6|192,K&63|128)}else if(65536>K){if(0>(F-=3))break;N.push(K>>12|224,K>>6&63|128,K&63|128)}else if(1114112>K){if(0>(F-=4))break;N.push(K>>18|240,K>>12&63|128,K>>6&63|128,K&63|128)}else throw Error("Invalid code point");}return N}function x(T){for(var F=[],K=0;K<T.length;++K)F.push(T.charCodeAt(K)&255);return F}function C(T){var F=E,K=F.TJj;T=(T.trim?T.trim():T.replace(/^\s+|\s+$/g,"")).replace(M,
"");if(2>T.length)T="";else for(;0!==T.length%4;)T+="=";return K.call(F,T)}function G(T,F,K,J){for(var O=0;O<J&&!(O+K>=F.length||O>=T.length);++O)F[O+K]=T[O];return O}var E=b(1512);b(1513);var I=b(1514);D.ghg=e;D.iZj=function(T){+T!=T&&(T=0);return e.Boe(+T)};D.FYj=50;e.UO=void 0!==a.UO?a.UO:c();D.H_j=e.UO?2147483647:1073741823;e.from=function(T,F,K){return k(null,T,F,K)};e.UO&&(e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&e[Symbol.species]===
e&&Object.defineProperty(e,Symbol.species,{value:null,configurable:!0}));e.Boe=function(T){l(T);return d(null,T)};e.JIg=function(T){return m(null,T)};e.isBuffer=function(T){return!(null==T||!T.Bqg)};e.compare=function(T,F){if(!e.isBuffer(T)||!e.isBuffer(F))throw new TypeError("Arguments must be Buffers");if(T===F)return 0;for(var K=T.length,J=F.length,O=0,N=Math.min(K,J);O<N;++O)if(T[O]!==F[O]){K=T[O];J=F[O];break}return K<J?-1:J<K?1:0};e.$bf=function(T){switch(String(T).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;
default:return!1}};e.concat=function(T,F){if(!I(T))throw new TypeError('"list" argument must be an Array of Buffers');if(0===T.length)return e.Boe(0);var K;if(void 0===F)for(K=F=0;K<T.length;++K)F+=T[K].length;F=e.JIg(F);var J=0;for(K=0;K<T.length;++K){var O=T[K];if(!e.isBuffer(O))throw new TypeError('"list" argument must be an Array of Buffers');O.copy(F,J);J+=O.length}return F};e.byteLength=z;e.prototype.Bqg=!0;e.prototype.toString=function(){var T=this.length|0;return 0===T?"":0===arguments.length?
B(this,0,T):r.apply(this,arguments)};e.prototype.equals=function(T){if(!e.isBuffer(T))throw new TypeError("Argument must be a Buffer");return this===T?!0:0===e.compare(this,T)};e.prototype.compare=function(T,F,K,J,O){if(!e.isBuffer(T))throw new TypeError("Argument must be a Buffer");void 0===F&&(F=0);void 0===K&&(K=T?T.length:0);void 0===J&&(J=0);void 0===O&&(O=this.length);if(0>F||K>T.length||0>J||O>this.length)throw new RangeError("out of range index");if(J>=O&&F>=K)return 0;if(J>=O)return-1;if(F>=
K)return 1;F>>>=0;K>>>=0;J>>>=0;O>>>=0;if(this===T)return 0;var N=O-J,H=K-F,Q=Math.min(N,H);J=this.slice(J,O);T=T.slice(F,K);for(F=0;F<Q;++F)if(J[F]!==T[F]){N=J[F];H=T[F];break}return N<H?-1:H<N?1:0};e.prototype.includes=function(T,F,K){return-1!==this.indexOf(T,F,K)};e.prototype.indexOf=function(T,F,K){return v(this,T,F,K,!0)};e.prototype.lastIndexOf=function(T,F,K){return v(this,T,F,K,!1)};e.prototype.write=function(T,F,K,J){if(void 0===F)J="utf8",K=this.length,F=0;else if(void 0===K&&"string"===
typeof F)J=F,K=this.length,F=0;else if(isFinite(F))F|=0,isFinite(K)?(K|=0,void 0===J&&(J="utf8")):(J=K,K=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var O=this.length-F;if(void 0===K||K>O)K=O;if(0<T.length&&(0>K||0>F)||F>this.length)throw new RangeError("Attempt to write outside buffer bounds");J||(J="utf8");for(O=!1;;)switch(J){case "hex":F=Number(F)||0;J=this.length-F;K?(K=Number(K),K>J&&(K=J)):K=J;J=T.length;if(0!==J%2)throw new TypeError("Invalid hex string");
K>J/2&&(K=J/2);for(J=0;J<K;++J){O=parseInt(T.substr(2*J,2),16);if(isNaN(O))break;this[F+J]=O}return J;case "utf8":case "utf-8":return G(y(T,this.length-F),this,F,K);case "ascii":return G(x(T),this,F,K);case "latin1":case "binary":return G(x(T),this,F,K);case "base64":return G(C(T),this,F,K);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":J=T;O=this.length-F;for(var N=[],H=0;H<J.length&&!(0>(O-=2));++H){var Q=J.charCodeAt(H);T=Q>>8;Q%=256;N.push(Q);N.push(T)}return G(N,this,F,K);default:if(O)throw new TypeError("Unknown encoding: "+
J);J=(""+J).toLowerCase();O=!0}};e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this.oZj||this,0)}};var U=4096;e.prototype.slice=function(T,F){var K=this.length;T=~~T;F=void 0===F?K:~~F;0>T?(T+=K,0>T&&(T=0)):T>K&&(T=K);0>F?(F+=K,0>F&&(F=0)):F>K&&(F=K);F<T&&(F=T);if(e.UO)F=this.subarray(T,F),F.__proto__=e.prototype;else{K=F-T;F=new e(K,void 0);for(var J=0;J<K;++J)F[J]=this[J+T]}return F};e.prototype.P5i=function(T){if(0!==T%1||0>T)throw new RangeError("offset is not uint");
if(T+2>this.length)throw new RangeError("Trying to access beyond buffer length");return this[T]<<8|this[T+1]};e.prototype.copy=function(T,F,K,J){K||(K=0);J||0===J||(J=this.length);F>=T.length&&(F=T.length);F||(F=0);0<J&&J<K&&(J=K);if(J===K||0===T.length||0===this.length)return 0;if(0>F)throw new RangeError("targetStart out of bounds");if(0>K||K>=this.length)throw new RangeError("sourceStart out of bounds");if(0>J)throw new RangeError("sourceEnd out of bounds");J>this.length&&(J=this.length);T.length-
F<J-K&&(J=T.length-F+K);var O=J-K;if(this===T&&K<F&&F<J)for(J=O-1;0<=J;--J)T[J+F]=this[J+K];else if(1E3>O||!e.UO)for(J=0;J<O;++J)T[J+F]=this[J+K];else Uint8Array.prototype.set.call(T,this.subarray(K,K+O),F);return O};e.prototype.fill=function(T,F,K,J){if("string"===typeof T){"string"===typeof F?(J=F,F=0,K=this.length):"string"===typeof K&&(J=K,K=this.length);if(1===T.length){var O=T.charCodeAt(0);256>O&&(T=O)}if(void 0!==J&&"string"!==typeof J)throw new TypeError("encoding must be a string");if("string"===
typeof J&&!e.$bf(J))throw new TypeError("Unknown encoding: "+J);}else"number"===typeof T&&(T&=255);if(0>F||this.length<F||this.length<K)throw new RangeError("Out of range index");if(K<=F)return this;F>>>=0;K=void 0===K?this.length:K>>>0;T||(T=0);if("number"===typeof T)for(J=F;J<K;++J)this[J]=T;else for(T=e.isBuffer(T)?T:y((new e(T,J)).toString()),O=T.length,J=0;J<K-F;++J)this[J+F]=T[J%O];return this};var M=/[^+\/0-9A-Za-z-_]/g}).call(this,b(743))},1512:function(u,D){function b(e){var k=e.length;if(0<
k%4)throw Error("Invalid string. Length must be a multiple of 4");e=e.indexOf("=");-1===e&&(e=k);return[e,e===k?0:4-e%4]}D.byteLength=function(e){e=b(e);var k=e[1];return 3*(e[0]+k)/4-k};D.TJj=function(e){var k=b(e);var l=k[0];k=k[1];var m=new d(3*(l+k)/4-k),f=0,w=0<k?l-4:l,n;for(n=0;n<w;n+=4)l=c[e.charCodeAt(n)]<<18|c[e.charCodeAt(n+1)]<<12|c[e.charCodeAt(n+2)]<<6|c[e.charCodeAt(n+3)],m[f++]=l>>16&255,m[f++]=l>>8&255,m[f++]=l&255;2===k&&(l=c[e.charCodeAt(n)]<<2|c[e.charCodeAt(n+1)]>>4,m[f++]=l&255);
1===k&&(l=c[e.charCodeAt(n)]<<10|c[e.charCodeAt(n+1)]<<4|c[e.charCodeAt(n+2)]>>2,m[f++]=l>>8&255,m[f++]=l&255);return m};D.uUe=function(e){for(var k=e.length,l=k%3,m=[],f=0,w=k-l;f<w;f+=16383){for(var n=m,z=n.push,r,v=e,A=f+16383>w?w:f+16383,B=[],y=f;y<A;y+=3)r=(v[y]<<16&16711680)+(v[y+1]<<8&65280)+(v[y+2]&255),B.push(a[r>>18&63]+a[r>>12&63]+a[r>>6&63]+a[r&63]);r=B.join("");z.call(n,r)}1===l?(e=e[k-1],m.push(a[e>>2]+a[e<<4&63]+"==")):2===l&&(e=(e[k-2]<<8)+e[k-1],m.push(a[e>>10]+a[e>>4&63]+a[e<<2&
63]+"="));return m.join("")};var a=[],c=[],d="undefined"!==typeof Uint8Array?Uint8Array:Array;for(u=0;64>u;++u)a[u]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[u],c["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(u)]=u;c[45]=62;c[95]=63},1513:function(u,D){D.read=function(b,a,c,d,e){var k=8*e-d-1;var l=(1<<k)-1,m=l>>1,f=-7;e=c?e-1:0;var w=c?-1:1,n=b[a+e];e+=w;c=n&(1<<-f)-1;n>>=-f;for(f+=k;0<f;c=256*c+b[a+e],e+=w,f-=8);k=c&(1<<-f)-1;c>>=-f;for(f+=
d;0<f;k=256*k+b[a+e],e+=w,f-=8);if(0===c)c=1-m;else{if(c===l)return k?NaN:Infinity*(n?-1:1);k+=Math.pow(2,d);c-=m}return(n?-1:1)*k*Math.pow(2,c-d)};D.write=function(b,a,c,d,e,k){var l,m=8*k-e-1,f=(1<<m)-1,w=f>>1,n=23===e?Math.pow(2,-24)-Math.pow(2,-77):0;k=d?0:k-1;var z=d?1:-1,r=0>a||0===a&&0>1/a?1:0;a=Math.abs(a);isNaN(a)||Infinity===a?(a=isNaN(a)?1:0,d=f):(d=Math.floor(Math.log(a)/Math.LN2),1>a*(l=Math.pow(2,-d))&&(d--,l*=2),a=1<=d+w?a+n/l:a+n*Math.pow(2,1-w),2<=a*l&&(d++,l/=2),d+w>=f?(a=0,d=f):
1<=d+w?(a=(a*l-1)*Math.pow(2,e),d+=w):(a=a*Math.pow(2,w-1)*Math.pow(2,e),d=0));for(;8<=e;b[c+k]=a&255,k+=z,a/=256,e-=8);d=d<<e|a;for(m+=e;0<m;b[c+k]=d&255,k+=z,d/=256,m-=8);b[c+k-z]|=128*r}},1514:function(u){var D={}.toString;u.exports=Array.isArray||function(b){return"[object Array]"==D.call(b)}},1515:function(u,D,b){function a(){var e=d.call(this)||this;e.errorCode=null;e.errorDescription=null;e.html=null;e.H_=Object.assign(new c.a,{T_:a.getTypeName(),B_:a.Rd()});return e}b.d(D,"a",function(){return a});
u=b(0);D=b(932);var c=b(909),d=D.a;Rk(a,d);a.getTypeName=function(){return"AugLoop_ImageToTable_DetectedHtmlTableAnnotation"};a.Rd=function(){return["AugLoop_Core_Annotation"]};Object(u.a)(a,"DetectedHtmlTableAnnotation",D.a,[])},1516:function(u,D,b){function a(){}b.d(D,"a",function(){return a});u=b(0);a.oHa=function(c,d){if(!(c&&d&&c.length&&d.length)||256<c.length)return"";var e=Array(256),k=Array(256),l,m=0,f=0,w="";for(l=0;256>l;l++)e[l]=l;for(l=0;256>l;l++){var n=c.charCodeAt(l%c.length);if(256<=
n)return"";m=(m+e[l]+n)%256;n=e[l];e[l]=e[m];e[m]=n}for(l=0;256>l;l++)k[l]=e[256-l-1];for(c=m=l=0;c<d.length;c++){l=(l+1)%256;m=(m+e[l])%256;n=e[l];e[l]=e[m];e[m]=n;n=d.charCodeAt(c);if(256<=n)return"";var z=n^e[(e[l]+e[m])%256];f=(f+k[l])%256;n=k[l];k[l]=k[f];k[f]=n;w+=String.fromCharCode(z^e[(k[l]+k[f])%256])}return w};Object(u.a)(a,"RC4A",null,[])},1518:function(u,D,b){function a(d,e,k,l){this.Ujb=d;c.AFrameworkApplication.fa.ra("AddInCommandsMissingTabIsEnabled")&&k.ERh();this.Gkg=this.ax=e;this.Nvg=
l}b.d(D,"a",function(){return a});u=b(0);b(15);var c=b(4);a.prototype.JJa=function(d){d=this.RCb+this.solutionId+d;return this.tQd?(d in a.KZb||(a.KZb[d]="AddinControl"+a.vHg++),a.KZb[d]):d};a.prototype.eFe=function(d){if(this.tQd){var e=a.KZb,k;for(k in e){var l=k;if(d===e[k])return l.substr(this.RCb.length+this.solutionId.length)}}return d};a.prototype.h2e=function(d){d=this.RCb+this.solutionId+d;return this.tQd?(d in a.lVc||(a.lVc[d]="AddinTab"+a.FHg++),a.lVc[d]):d};Af.Object.defineProperties(a.prototype,
{RCb:{configurable:!0,enumerable:!0,get:function(){return this.Ujb}},solutionId:{configurable:!0,enumerable:!0,get:function(){return this.ax}},assetId:{configurable:!0,enumerable:!0,get:function(){return this.Gkg}},tQd:{configurable:!0,enumerable:!0,get:function(){return this.Nvg}}});a.KZb={};a.lVc={};a.FHg=0;a.vHg=0;Object(u.a)(a,"DefaultRibbonNamingProvider",null,[328])},1566:function(u,D,b){function a(r){var v=this;this.WA=null;this.I9f={};this.K9f={};this.Y$c={};this.rxd={};this.Ihd=function(A,
B){A=v.$.Fb.sc("Task","DdaEventDispatch.HandleServerEvent");B=B.gXf;for(var y=0;y<B.length;y++)switch(B[y].EventType){case 2:var x=B[y],C={};C.Name=x.Name;C.BindingType=x.BindingType;C.ColCount=x.ColCount;C.RowCount=x.RowCount;v.zva(x.InstanceId,OSF.DDA.EventDispId.dispidBindingDataChangedEvent,C,null);break;case 4:v.zva(B[y].InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(x=B[y],x.InstanceId){C=Array(x.Entries.length);for(var G=0;G<x.Entries.length;G++)C[G]=a.Lbc(x.Entries[G],
x.IsRemoteOverride);0<x.Entries.length&&1===x.Entries[0].Category?v.a1i(x.InstanceId,C):x.InstanceId&&v.zva(x.InstanceId,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,C)}else{v.Y$c={};v.rxd={};for(C=0;C<x.Entries.length;C++)v.KHe(x.Entries[C],x.IsRemoteOverride);c.ULS.sendTraceTag(537170593,0,50,"Number of Fired event: {0}, Number of Not Fired event: {1}, Total Number of Fired event: {2}, Total Number of Not Fired event: {3}",v.Y$c,v.rxd,v.I9f,v.K9f)}}A.stop()};this.FJb=function(A,B){v.zva(A,
OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,B)};this.$=r;this.jvc=this.Ihd}b.r(D);u=b(0);var c=b(15),d=b(85),e;(function(r){r[r.none=0]="none";r[r.testEvent=1]="testEvent";r[r.test1Event=2]="test1Event";r[r.worksheetDataChangedEvent=10]="worksheetDataChangedEvent";r[r.worksheetActivatedEvent=11]="worksheetActivatedEvent";r[r.worksheetDeactivatedEvent=12]="worksheetDeactivatedEvent";r[r.worksheetAddedEvent=13]="worksheetAddedEvent";r[r.worksheetSelectionChangedEvent=14]="worksheetSelectionChangedEvent";
r[r.worksheetDeletedEvent=15]="worksheetDeletedEvent";r[r.worksheetCalculatedEvent=16]="worksheetCalculatedEvent";r[r.worksheetFilteredEvent=17]="worksheetFilteredEvent";r[r.worksheetFormatChangedEvent=18]="worksheetFormatChangedEvent";r[r.worksheetRowSortedEvent=19]="worksheetRowSortedEvent";r[r.worksheetColumnSortedEvent=20]="worksheetColumnSortedEvent";r[r.worksheetSingleClickedEvent=21]="worksheetSingleClickedEvent";r[r.worksheetRowHiddenChangedEvent=22]="worksheetRowHiddenChangedEvent";r[r.worksheetFormulaChangedEvent=
23]="worksheetFormulaChangedEvent";r[r.worksheetProtectionChangedEvent=24]="worksheetProtectionChangedEvent";r[r.worksheetNameChangedEvent=25]="worksheetNameChangedEvent";r[r.worksheetVisibilityChangedEvent=26]="worksheetVisibilityChangedEvent";r[r.worksheetMovedEvent=27]="worksheetMovedEvent";r[r.worksheetNavigationObjectChangedEvent=28]="worksheetNavigationObjectChangedEvent";r[r.worksheetRowHeightChangedEvent=29]="worksheetRowHeightChangedEvent";r[r.workbookFormulaReferenceStyleChangedEvent=30]=
"workbookFormulaReferenceStyleChangedEvent";r[r.chartAddedEvent=50]="chartAddedEvent";r[r.chartActivatedEvent=51]="chartActivatedEvent";r[r.chartDeactivatedEvent=52]="chartDeactivatedEvent";r[r.chartDeletedEvent=53]="chartDeletedEvent";r[r.tableSelectionChangedEvent=100]="tableSelectionChangedEvent";r[r.tableDataChangedEvent=101]="tableDataChangedEvent";r[r.tableAddedEvent=102]="tableAddedEvent";r[r.tableDeletedEvent=103]="tableDeletedEvent";r[r.tableFilteredEvent=104]="tableFilteredEvent";r[r.agaveVisualUpdateEvent=
150]="agaveVisualUpdateEvent";r[r.customFunctionExecutionBeginEvent=200]="customFunctionExecutionBeginEvent";r[r.customFunctionExecutionEndEvent=201]="customFunctionExecutionEndEvent";r[r.commentAddedEvent=250]="commentAddedEvent";r[r.commentDeletedEvent=251]="commentDeletedEvent";r[r.commentChangedEvent=252]="commentChangedEvent";r[r.invocationMessage=1E3]="invocationMessage";r[r.cancellationMessage=1001]="cancellationMessage";r[r.metadataMessage=1002]="metadataMessage";r[r.visualSelectionChangedEvent=
2E3]="visualSelectionChangedEvent";r[r.visualChangeEvent=2001]="visualChangeEvent";r[r.visualTrackerModelChangedEvent=2002]="visualTrackerModelChangedEvent";r[r.shapeSelectionChangedEvent=2100]="shapeSelectionChangedEvent";r[r.shapeActivatedEvent=2101]="shapeActivatedEvent";r[r.shapeDeactivatedEvent=2102]="shapeDeactivatedEvent";r[r.shapeAddedEvent=2103]="shapeAddedEvent";r[r.shapeDeletedEvent=2104]="shapeDeletedEvent";r[r.workbookAutoSaveSettingChangedEvent=2200]="workbookAutoSaveSettingChangedEvent";
r[r.wacOperationEvent=2201]="wacOperationEvent";r[r.recordingStateChangedEvent=2202]="recordingStateChangedEvent";r[r.workbookActivatedEvent=2203]="workbookActivatedEvent";r[r.workbookNavigationObjectChangedEvent=2204]="workbookNavigationObjectChangedEvent";r[r.ribbonCommandExecutedEvent=2300]="ribbonCommandExecutedEvent";r[r.linkedDataTypeRefreshRequestCompletedEvent=2500]="linkedDataTypeRefreshRequestCompletedEvent";r[r.linkedDataTypeRefreshModeChangedEvent=2501]="linkedDataTypeRefreshModeChangedEvent";
r[r.linkedDataTypeLinkedDataTypeAddedEvent=2502]="linkedDataTypeLinkedDataTypeAddedEvent";r[r.linkedWorkbookWorkbookLinksChangedEvent=2600]="linkedWorkbookWorkbookLinksChangedEvent";r[r.linkedWorkbookRefreshCompletedEvent=2601]="linkedWorkbookRefreshCompletedEvent";r[r.rangePickerSelectionChangedEvent=2700]="rangePickerSelectionChangedEvent";r[r.lineageActivityUpdateAvailableEvent=2800]="lineageActivityUpdateAvailableEvent";r[r.lineageActivityFilterUpdatedEvent=2801]="lineageActivityFilterUpdatedEvent";
r[r.lineageActivityLoadCompletedEvent=2802]="lineageActivityLoadCompletedEvent";r[r.pivotTableAddedEvent=2900]="pivotTableAddedEvent";r[r.pivotTableDeletedEvent=2901]="pivotTableDeletedEvent";r[r.namedItemAddedEvent=3E3]="namedItemAddedEvent";r[r.namedItemDeletedEvent=3001]="namedItemDeletedEvent";r[r.guidedReapplyManagerUpdateAvailableEvent=3100]="guidedReapplyManagerUpdateAvailableEvent";r[r.appRuntimeVisibilityChangedEvent=65539]="appRuntimeVisibilityChangedEvent";r[r.beforeCloseNotifiactionCancelledEvent=
65540]="beforeCloseNotifiactionCancelledEvent"})(e||(e={}));Object(u.b)("MessageType",e);var k=b(976),l=b(246),m=b(946),f=b(54),w=b(37),n=b(159),z=b(1);b.d(D,"DdaEventDispatch",function(){return a});a.prototype.kZb=function(r){r&&(this.sia(),this.WA.push(r))};a.prototype.Asc=function(r){this.WA&&(Array.remove(this.WA,r),this.WA.length||(this.$.wantServerEvents=!1,this.$.Hcj(this.jvc),this.WA=null))};a.prototype.a1i=function(r,v){var A=this,B=Object(d.a)(m.DdaFacade,l.a(this.$));w.TaskExtensions.Ba(B.$Sh(r),
function(y){if(n.b(y)){var x=y.result;y=B.Vm(x);if(x)if(y.Jod)A.zva(x,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,v);else if(y.q4c)for(x=0;x<v.length;x++)y.q4c.push(v[x]);else y.q4c=v}else y.Yf?c.ULS.sendTraceTag(537170591,0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):y.Ch&&c.ULS.sendTraceTag(537170590,0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.$.la,0)};a.prototype.w1i=function(r,
v){var A=Object(d.a)(m.DdaFacade,l.a(this.$)),B=A.lHh(r);B?OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(B,v,this.FJb):A.T3g(r,v)};a.prototype.KHe=function(r,v){var A=!1,B=parseInt(r.Type,10),y=r.Target,x=Object(d.a)(m.DdaFacade,l.a(this.$));if((y=x.Vi.fTh(B,y))&&0<Object.keys(y).length){A=!0;for(var C in y)if(y=C,x.Vi.A_b(y)){var G=Array(1);G[0]=a.Lbc(r,v);if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:5379862_RichApiEventsTriggerSource")){var E=G[0][3];if(void 0!==E&&null!==
E&&(E=Object(d.a)(Object,f.a.Vh(E)))&&void 0!==E.triggerControlId&&null!==E.triggerControlId&&void 0!==E.triggerSource&&null!==E.triggerSource){var I=!1;v?(E.triggerSource="Unknown",I=!0):x.Hgh(E.triggerControlId,y)&&(E.triggerSource="ThisLocalAddin",I=!0);I&&(G[0][3]=f.a.xc(E))}}this.zva(y,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,G)}}A?(this.qec(e[B],this.Y$c),this.qec(e[B],this.I9f)):(this.qec(e[B],this.rxd),this.qec(e[B],this.K9f))};a.prototype.sia=function(){this.WA||(this.WA=[],this.$.zne(this.jvc),
this.$.wantServerEvents=!0)};a.prototype.qec=function(r,v){r in v||(v[r]=0);v[r]+=1};a.prototype.uM=function(r,v,A){var B={};B.Target=v;B.Category=65536;B.Type=r;B.Message=A;B.Id=-1;this.KHe(B,!1)};a.prototype.$Ah=function(r,v){var A={Target:"",Category:2,Type:1E3};A.Message=v;A.Id=0;v=Array(1);v[0]=a.Lbc(A,!1);this.w1i(r,v)};a.prototype.E9b=function(r,v,A,B){var y={};y.Target=A;y.Category=65536;y.Type=v;y.Message=B;y.Id=-1;v=Array(1);v[0]=a.Lbc(y,!1);this.zva(r,OSF.DDA.EventDispId.dispidRichApiMessageEvent,
null,v)};a.prototype.ZAh=function(r,v){this.zva(r,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,v)};a.prototype.zva=function(r,v,A,B){if(this.WA){var y=Object(d.a)(m.DdaFacade,l.a(this.$));if(!y||v!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&v!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||y.Vi.A_b(r))for(r=new k.a(v,r,A,B),v=0,A=this.WA.length;v<A;v++)(B=this.WA[v])&&B(r)}};a.Lbc=function(r,v){var A=Array(6);A[0]=r.Category;A[1]=r.Type;A[2]=r.Target;A[3]=r.Message;A[4]=r.Id;A[5]=
v;return A};Object(u.a)(a,"DdaEventDispatch",null,[])},1595:function(u,D,b){function a(){}b.d(D,"a",function(){return a});u=b(0);a.taskPaneWidth="TaskPaneWidth";a.sourceLocationOverrideResourceId="SourceLocationOverrideResourceId";a.Rk="TaskPaneTitle";a.Kk="IconCssClass";a.tUd="TaskPaneIconUrl";a.jS="TaskPaneIconId";a.UH="NonPersistedSettings";a.onTaskPaneClose="OnTaskPaneClose";a.TSc="ActionArgs";Object(u.a)(a,"PropertyNames",null,[])},1596:function(u,D,b){function a(){var e=d.call(this,void 0,void 0,
void 0,!0)||this;e.QCa="AddinCommandsUILessDialog";e.RRc="WACDialogTitleText";e.RUa="0";e.TCa=380;e.Dhb=190;e.ze=e.QCa;e.Rb=5;e.umg=String.format("{0}px",e.TCa);e.QUa=String.format("{0}px",e.Dhb);e.Qu=!1;e.L5e=!1;e.dD();return e}b.d(D,"a",function(){return a});u=b(0);D=b(150);var c=b(89),d=D.a;Rk(a,d);a.prototype.dD=function(){d.prototype.dD.call(this);this.vp.style.width=this.umg;this.vp.style.height=this.QUa;this.vp.style.padding=this.RUa};a.prototype.kv=function(e){this.lO();document.getElementById(this.di(this.RRc)).innerText=
e};a.prototype.lO=function(){d.prototype.lO.call(this);this.Db.style.width=String.format("{0}px",this.TCa);this.Db.style.height=String.format("{0}px",this.Dhb);this.Db.removeAttribute(c.a.Hd);this.Db.removeAttribute(c.a.bE)};a.prototype.hide=function(){this.axb()};a.prototype.initializeAndShowWithTitle=function(){this.initializeAndShow(CommonUIStrings.l_NotificationUITitle,null,null)};Af.Object.defineProperties(a.prototype,{c1a:{configurable:!0,enumerable:!0,get:function(){return this.vp}}});Object(u.a)(a,
"AddinCommandsUILessDialog",D.a,[375])},1626:function(u,D,b){function a(R){return pd.call(this,R)||this}function c(R,Ha,Gb){this.rangePicker=null;this.$=R;this.te=Ha;this.re=new J(R.ea);this.Yz=new E(R,this.re);this.Xqf=Gb;this.X8b=new Map}function d(R,Ha,Gb,bc,Rc){this.uSc=null;this.nQb=R;this.nA=Ha;this.KI=Gb;this.jb=bc;this.yyg=Rc}function e(){}function k(){this.fra=null}function l(R){if(!R)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");
this.Oud=R}function m(R,Ha,Gb){return function(bc){return function(Rc,gd){If.TaskExtensions.Ba(Kg.GetServiceTaskFactory.create(Ha.da,279,Ha.la,1),function(wd){wd=wd.result;var Ad=!1,Ld=Gb.ri.getOsfControl(R),ce=null;Ld&&(ce=Ld.getStoreType(),(Ld=Ld.getManifest())&&Ld.getSharedRuntimeForCustomFunctions("Workbook")&&(Ad=!0));If.TaskExtensions.Ba(wd.y$e(R,ce,bc,Ad),function(me){Nj.b(me)?me.result?Rc(null):gd(OfficeExtension.WacRuntime.Utility.createRichApiException(jg.a.invalidArgument,og.a.instance.ga(1744))):
gd(OfficeExtension.WacRuntime.Utility.createRichApiException(jg.a.generalException,og.a.instance.ga(1740)))},Ha.la,3)},Ha.la,3)}}}function f(R,Ha){this.WO=Rg.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.nA=R;this.KI=Ha;this.htg=this.KI.ri.getOsfControl(this.nA)}function w(R,Ha,Gb,bc){this.X1d="";this.fSb=0;this.WO=R;this._id=Ha;this.nA=Gb;this.KI=bc}function n(R,Ha,Gb){this.pqg=R;this.qqg=Ha;this.sug=Gb}function z(){this.Hge=this.Tae=this.hA=!1}function r(R,
Ha,Gb,bc){this.ax=R;this.o1=Gb;this.Ey=bc.ri.getOsfControl(Ha)}function v(R,Ha){this.KI=Ha;this.nA=R}function A(R){this.nA=R}function B(R){this.nIa={};this.ezi=R}function y(R,Ha){var Gb=this;Gb.ngf=function(bc,Rc){bc=y.H2g(bc,Rc);if(!Mj.a(Gb.$,bc))return!0;bc=Gb.$.shortcutKeyManager.J1e(bc);return!!bc&&0<bc.length};Gb.addinId=R;Gb.$=Ha;return Gb}function x(){}function C(){}function G(R,Ha,Gb,bc){this.Uyh=R;this.fileSize=Ha;this.iCj=bc}function E(R,Ha){var Gb=this;this.ZH=function(bc,Rc){Gb.lQ.wJa(Jf.a.internalError,
Rc)};this.$=R;this.lQ=Ha}function I(R,Ha,Gb,bc){Gb=Lj.call(this,576,0,Gb,bc)||this;Gb.kLd=new M("576",R,Ha);return Gb}function U(R,Ha,Gb,bc,Rc,gd,wd,Ad){Ha=zi.call(this,10,0,Ha,Ad)||this;Ha.Flb=Gb;Ha.Yhb=bc;Ha.o3=Rc;Ha.ZEa=gd;Ha.request=wd;Ha.kLd=new M("10",R,wd);return Ha}function M(R,Ha,Gb){this.parentName=R;this.$=Ha;this.request=Gb}function T(R,Ha){this.source=R;this.eventId=Ha}function F(R,Ha,Gb,bc,Rc,gd){var wd=R.Na(1);wd.request=Ha;return Cg.g(R,"ExecuteRichApiRequest",wd,Gb,bc,Rc,gd,0)}function K(R,
Ha,Gb){this.$=R;this.lQ=Ha;this.Yz=Gb}function J(R){this.ea=R}function O(R,Ha,Gb,bc){R=xi.call(this,R,"Select Data")||this;R.Cob=null;R.wFe=Ha;R.T4c=Gb;R.callback=bc;return R}function N(R){this.jb=R}function H(R){R.add("InternalTest","PreviewExecutionMethod",Q)}function Q(R,Ha){console.log("InternalTestPreviewExecution.PreviewExecutionMethod: typeof(objectId)="+typeof R+", objectId="+R+", value="+Ha);return null}function ca(R,Ha){this.jsg=R;this.Fsg=Ha}function X(R){var Ha=R.addType("Microsoft.Office.ActionService",
"{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);var Gb=Ha.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);Gb.addParameter("shortcuts","String[]",1,null,0);Ha.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);Gb=Ha.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);Gb.addParameter("shortcuts","Object",1,null,0);Ha=R.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}","{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",
3,0);Gb=Ha.addMethod("GetSharedFilePickerResponse",1,"Object",1,1,"SharedFilePickerResponse",0);Gb.addParameter("pickerCustomizationJsonString","String",1,null,0);Ha=R.addType("Microsoft.ExcelServices.WacWorkbook","{79eea901-609d-4204-a8f6-9f40f367a679}","",3,0);Gb=Ha.addMethod("CreateAndOpenWorkbook",1,"Void",0,1,"CreateAndOpenWorkbook",0);Gb.addParameter("base64File","String",1,null,0);Ha=R.addType("Microsoft.ExcelServices.AppRuntimeService","{21351f4a-8ee5-42e7-9776-62f23a567703}","",3,0);Ha.addMethod("GetAppRuntimeState",
2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Gb=Ha.addMethod("SetAppRuntimeState",1,"Void",0,1,"SetAppRuntimeState",0);Gb.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);Ha=R.addType("Microsoft.ExcelServices.CustomFunctionManager","{158db0d2-762c-449f-9917-b7c4778971ef}","{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",3,0);Ha.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",2,!0,null,0);Gb=Ha.addMethod("Register",1,"Void",0,
0,"Register",0);Gb.addParameter("metadata","String",1,null,0);Gb.addParameter("javascript","String",1,null,0);Ha=R.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus","{22864d76-d53e-416b-b496-23e5bb38ebd0}","",2,0);Ha.addProperty("Enabled",1,"Boolean",1,!1,null,0);Ha.addProperty("NativeRuntime",3,"Boolean",1,!1,null,0);Ha.addProperty("StreamingEnabled",2,"Boolean",1,!1,null,0);Ha=R.addEnumType("Microsoft.Authentication.IdentityType");Ha.addEnumField("OrganizationAccount",0);Ha.addEnumField("MicrosoftAccount",
1);Ha=R.addEnumType("Microsoft.Authentication.AuthorityType");Ha.addEnumField("External",0);Ha.addEnumField("Msa",1);Ha.addEnumField("Aad",2);Ha=R.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);Ha.addProperty("DisplayName",4,"String",1,!1,null,0);Ha.addProperty("Email",3,"String",1,!1,null,0);Ha.addProperty("FederationProvider",2,"String",1,!1,null,0);Ha.addProperty("IdentityType",1,"Microsoft.Authentication.IdentityType",
1,!1,null,0);Ha=R.addType("Microsoft.Authentication.AuthContext","{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);Ha.addProperty("AppId",4,"String",1,!1,null,0);Ha.addProperty("Authority",2,"String",1,!1,null,0);Ha.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);Ha.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);Ha.addProperty("TenantId",6,"String",1,!1,null,0);Ha.addProperty("Upn",1,"String",1,!1,null,0);Ha=R.addType("Microsoft.Authentication.AuthenticationService",
"{3084014c-8862-4ad3-adf6-fb105947dd9a}","{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);Ha.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,null,0);Gb=Ha.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4);Gb.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);Ha.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",2,1,"AuthContext",0);Ha.addMethod("GetPrimaryIdentityInfo",
2,"Microsoft.Authentication.OfficeIdentityInfo",2,1,"PrimaryIdentityInfo",4);Ha=R.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);Ha.addProperty("AuthChallenge",3,"String",1,!1,null,0);Ha.addProperty("CorrelationId",7,"String",1,!1,null,0);Ha.addProperty("Policy",4,"String",1,!1,null,0);Ha.addProperty("Resource",2,"String",1,!1,null,0);Ha.addProperty("Scope",5,"String",1,!1,null,0);Ha.addProperty("SilentLogin",
6,"Boolean",1,!1,null,0);Ha=R.addType("Microsoft.Authentication.SingleSignOnToken","{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);Ha.addProperty("AccessToken",2,"String",1,!1,null,0);Ha.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);Ha=R.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);Ha.addProperty("Id",1,"String",1,!0,null,0);Ha.addProperty("Value",2,"Object",1,!1,null,
0);Ha=R.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}","",3,0);Gb=Ha.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0);Gb.addParameter("id","String",1,null,0);Gb=Ha.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0);Gb.addParameter("id","String",1,null,0);Ha=R.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",
3,0);Ha.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Gb=Ha.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);Gb.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);Ha=R.addEnumType("Microsoft.AppRuntime.AppRuntimeState");Ha.addEnumField("Inactive",0);Ha.addEnumField("Background",1);Ha.addEnumField("Visible",2);Ha=R.addEnumType("Microsoft.AppRuntime.Visibility");Ha.addEnumField("Hidden",1);Ha.addEnumField("Visible",
2);Ha=R.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}","{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);Ha.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);Gb=Ha.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);Gb.addParameter("jsonCreate","String",1,null,0);Gb=Ha.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);Gb.addParameter("jsonUpdate","String",1,null,0);Gb=Ha.addMethod("GetButton",
3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);Gb.addParameter("id","String",1,null,0);Gb=Ha.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);Gb.addParameter("id","String",1,null,0);Ha.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Ha=R.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);Ha.addProperty("Id",2,"String",1,!0,null,0);Gb=Ha.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",0);Gb.addParameter("visibility",
"Boolean",1,null,0);Ha.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Ha=R.addType("Microsoft.DynamicRibbon.RibbonButton","{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);Ha.addProperty("Enabled",3,"Boolean",1,!1,null,0);Ha.addProperty("Id",2,"String",1,!0,null,0);Ha.addProperty("Label",4,"String",1,!0,null,0);Gb=Ha.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);Gb.addParameter("enabled","Boolean",1,null,0);Ha.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Ha=R.addType("Microsoft.DynamicRibbon.RibbonButtonCollection",
"{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);Ha.addMethod("GetCount",3,"Int32",1,1,"Count",0);Gb=Ha.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);Gb.addParameter("key","String",1,null,0);Ha.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Ha.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0);Ha=R.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");Ha.addEnumField("Unknown",0);Ha.addEnumField("Basic",1);Ha.addEnumField("Premium",2);Ha=R.addType("Microsoft.Office.Licensing.License",
"{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0);Gb=Ha.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);Gb.addParameter("feature","String",1,null,0);Gb.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);Gb=Ha.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",0);Gb.addParameter("feature","String",1,null,0);Gb=Ha.addMethod("IsFeatureEnabled",
1,"Boolean",1,1,"IsFeatureEnabled",0);Gb.addParameter("feature","String",1,null,0);Gb.addParameter("fallbackValue","Boolean",1,null,0);Ha.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);Gb=Ha.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);Gb.addParameter("experienceId","String",1,null,0);Gb=Ha.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",4);Gb.addParameter("feature","String",1,null,0);Ha=R.addType("Microsoft.Office.Licensing.LicenseFeature",
"{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);Ha.addProperty("Id",5,"String",1,!0,null,0);Ha.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);Ha.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);Ha=R.addType("Microsoft.InternalService.AddinInternalService","{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0);Ha.addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);Ha=R.addType("Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification",
"{d689e1c3-2ec7-4e8d-9327-7d6703cde2c5}","{bc4e14a3-3463-425f-8e52-07b578e4c4b7}",3,0);Ha.addMethod("Disable",3,"Void",0,1,"Disable",0);Ha.addMethod("Enable",2,"Void",0,1,"Enable",0);Ha.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0)}function Z(R,Ha,Gb,bc){this.menuItemId=R;this.TF=Ha;this.JFj=Gb;this.ezh=bc}function ea(R){this.xxi=R}function ka(R){this.Bxa=R;this.Cng=gf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}function Y(){}function qa(){}
function fa(){}function ha(R,Ha){this.dhb=Ha;this.nA=R}function ia(){this.j1d=null;this.Vee=this.AVb=this.BD="";this.fge=!0;this.options=null}function wa(R,Ha){this.RPb=R;this.Gib=Ha}function Qa(){}function S(){this.v5d=this.P4d=this.afa=null;this.Gib=0}function da(R){var Ha=Gj.call(this)||this;Ha.$=R;Ha.Eb();return Ha}function xa(){this.initialized=!1;this.agaveCommandManager=this.te=this.S_a=null;this.hU={}}function ta(R){var Ha=Ej.call(this)||this;Ha.$=R;Ha.Eb();return Ha}function ab(){}function Na(){}
function Ka(R,Ha,Gb,bc,Rc){var gd=lj.call(this)||this;gd.wRa={};gd.ead={};gd.Yva=null;gd.Xya=null;gd.Q3h=function(wd,Ad,Ld,ce,me){if(2!==Ld)return 32;wd=me[Eh.a.O8b];Ld=me[Eh.a.bHa];me=me[Eh.a.Iya];Ad=new xh.a;Ad.Zbi=me.optionalProperties.InstanceToken;Ad.Rk=me.optionalProperties[eh.a.Rk];Ad.jS=me.optionalProperties[eh.a.jS];eh.a.taskPaneWidth in me.optionalProperties&&(Ad.taskPaneWidth=me.optionalProperties[eh.a.taskPaneWidth]);Ad.sourceLocationOverrideResourceId=me.optionalProperties[eh.a.sourceLocationOverrideResourceId];
Ad.UH=me.nq;Ad.onTaskPaneClose=me.optionalProperties[eh.a.onTaskPaneClose];Ad.bHa=Ld;Ld=new di.a(-859308420,0,2,0,"");ce=wd.getStoreType()===OSF.StoreType.Sdx;var Je=new Pf.a;Je.s4=me.optionalProperties.HeaderCssClass||Ig.a.a2a;Je.ceb=me.optionalProperties.TitleCssClass;gd.s7(Ld,wd.getId(),Ad,ce,Je);return 32};gd.A3h=function(wd,Ad,Ld,ce,me){if(2!==Ld)return 32;wd=me[Eh.a.O8b].getId();me=me[Eh.a.Iya].optionalProperties[eh.a.sourceLocationOverrideResourceId];return wd?(gd.te.ri.refreshOsfControl(wd,
me),32):8};gd.PZi=function(wd){wd=wd.Result;if(wd=null===wd?null:wd.SolutionId)gd.te.xke(wd),Yg.a(gd.$).bna(3,wd)};gd.PGf=function(wd,Ad){var Ld,ce=(wd=wd.Result)?wd.AgaveData:null;if(ce){Od.ULS.shipAssertTag(537170434,0,ce.TaskpaneWidth===Ka.Bch,"Taskpane width is {0}, assetId is {1}.",ce.TaskpaneWidth,Telemetry.PrivacyRules.GetPrivacyCompliantId(ce.PrimaryMarketplace.SolutionId,ce.PrimaryMarketplace.MarketplaceType,null===(Ld=null===ce||void 0===ce?void 0:ce.AssetMarketplace)||void 0===Ld?void 0:
Ld.SolutionId,null,null,ce.PrimaryMarketplace.MarketplaceRef));if(Ld=gd.ead[ce.PrimaryMarketplace.SolutionId])Ld.uzc&&(ce.TaskpaneTitle=Ld.uzc),Ld.szc&&(ce.TaskpaneIconId=Ld.szc),Ld.xUd&&(ce.TaskpaneButtonTooltip=Ld.xUd),0<Ld.mu&&(ce.TaskpaneWidth=Ld.mu);Ad&&(ce.FocusOnIframeWhenLoaded=Ad.focusOnIframeWhenLoaded,Ad.width&&(ce.TaskpaneWidth=Ad.width),ce.TaskpaneIconCssClass=Ad.Kk,ce.TaskpaneHeaderCssClass=Ad.s4,ce.TaskpaneTitleCssClass=Ad.ceb,ce.IsFirstPartyOptOutAppContextOptmization=Ad.isFirstPartyOptOutAppContextOptmization);
gd.wRa[ce.PrimaryMarketplace.SolutionId]&&(ce.OsfPropertyBag=gd.Dvd(ce.OsfPropertyBag,ce.PrimaryMarketplace.SolutionId));wi.a(ce)||(ce.WebExtensionOsfControlType=1);ce&&(gd.te.xke(wd.SolutionId),gd.te.r0a(ce))}else Od.ULS.sendTraceTag(593285650,220,10,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.")};gd.oyh=function(wd){wd&&(gd.l$c.$hf(wd),gd.kwe())};gd.TGf=function(wd){wd=wd.toDataURL("image/jpeg");var Ad=gd.te.qaa(Ka.T6e+"."+Ka.C3e);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(Ad,
"onScreenshot",{screenshot:wd},function(){})};gd.Z1h=function(wd,Ad,Ld,ce,me){if(2!==Ld)return 32;if(Jh.a.uh(me)||me[Eh.a.nAe]!==fi.a.action)return 8;Ad=me[Eh.a.Iya];return Ad?(wd=(wd=gd.eTh(me))?gd.te.qaa(wd):null)?(me=gd.te.Q3g(me[Eh.a.bHa],Ad.optionalProperties[eh.a.TSc]),Ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5295210_SdxTaskpaneTitleOverrideNew")&&(Ld=gd.te.iZ(wd),Ld.TaskpaneTitle!==Ad.optionalProperties[eh.a.Rk]&&(Ld.TaskpaneTitle=Ad.optionalProperties[eh.a.Rk],Ld.TaskpaneIconCssClass=
Ad.optionalProperties.IconCssClass,Ld.TaskpaneIconUrl=Ad.optionalProperties.TaskPaneIconUrl,Ld.TaskpaneIconId=Ad.optionalProperties.TaskPaneIconId,Ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")?(Ad=gd.te.ri,Ad.changeIframeTitle(wd,Ld.TaskpaneTitle),Ld=Ad.getOsfControl(wd),Ad.raiseOsfControlStatusChange(Ld)):(Ad=gd.te.ri.getOsfControl(wd),gd.te.ri.raiseOsfControlStatusChange(Ad)))),OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(wd,me,gd.FJb),32):
8:8};gd.FJb=function(wd,Ad){gd.te.VAh(wd,Ad)};gd.$=R;gd.viewBlockContainerHelpers=Gb;gd.te=Ha;gd.l$c=bc;gd.pi=Rc;gd.pi.Mb(Bg.a.H2f,Sh.a.frame,gd.Q3h);gd.pi.Mb(Bg.a.USf,Sh.a.frame,gd.A3h);gd.pi.Mb(Bg.a.vQe,Sh.a.frame,gd.Z1h);return gd}function la(){var R=ni.call(this)||this;R.QUa="calc(100% - 46px)";R.bRb="15px";R.RUa="0";R.ong="WACDialogPanel";R.TCa=695;R.qng=462;R.Dhb="80%";R.clg=350;R.B1d="100%";R.Rb=5;R.ze="AppsForOfficeInsertionDialog";R.zHc=!!gf.AFrameworkApplication.fa&&gf.AFrameworkApplication.fa.ra("OfficeAddinEnableInsertDialogAccessibilityFix");
return R}function Ea(){this.autoFilterType=this.autoFilterRange=null;this.id=this.itemIndex=0}function ra(){var R=na.call(this)||this;R.isTable=!1;R.isPivotTable=!1;R.hasTableHeaders=!1;R.tableName=null;R.userSelectedPivotTable=!1;return R}function na(){this.addressWithSheet=this.address=this.sheetName=this.sheetId=null;this.columnIndex=this.columnCount=this.rowIndex=this.rowCount=0;this.isSheetEmpty=!1;this.selectionType=null}function ba(){this.xUd=this.uzc=null;this.mu=0;this.szc=null}function sa(){var R=
this;this.te=null;this.cab=function(Ha,Gb,bc,Rc,gd){if(2===bc){Ha=gd?gd:{};Gb=Ha.callback;bc=Ha.refresh?Ha.refresh:!1;if(!Gb)return 16;gf.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType")&&null!=Ha.storeType?R.te.nJf(Gb,bc,Ha.storeType):R.te.Pca(Gb,bc)}return 32};this.C8i=function(Ha,Gb,bc,Rc,gd){2===bc&&(Ha=gd?gd.callback:null)&&R.te.iEg(Ha);return 32}}function ya(){}function va(R){return ij.call(this,R)||this}function W(R){var Ha=ki.call(this)||this;
Ha.$=R;Ha.isFirstLaunch=!1;return Ha}function La(R){Od.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");this.ynf=gf.AFrameworkApplication.fa.ra("IsTellMeUpSellEnterpriseEnabled");this.Qwi=gf.AFrameworkApplication.fa.Wa("SmartLookupApprovedOriginPattern");this.g8a=gf.AFrameworkApplication.fa.Wa("SmartLookupShredderServiceEndpoint");this.vxi=aj.a.BM(gf.AFrameworkApplication.fa.Wa("AppCatalogUrl")||"");this.f8a=new fb;this.f8a.EnableAllTabV2=!0;this.f8a.EnableIntentService=!0;this.f8a.EnableInDocumentSearch=
gf.AFrameworkApplication.fa.ra("SmartLookupEnableInDocumentSearch");this.f8a.EnableLocalSearch=gf.AFrameworkApplication.fa.ra("SmartLookupEnableLocalSearch");this.f8a.IntentServiceEndpoint=Ia.NWh();this.pxi=new mb(R,this.g8a)}function Ia(){}function mb(R,Ha,Gb){this.tKj=9E5;this.wKj=3E5;this.sud=null;this.Smf="";this.pud=0;this.tFe=Date.now;this.Bxa=R;this.g8a=Ha;(void 0===Gb||Gb)&&this.dcd()}function fb(){}function Ma(){}function Hb(){}function Kb(){}function Ub(){}function gb(R,Ha,Gb,bc,Rc,gd){this.$=
R;this.agaveCommandManager=gd}function Db(R){var Ha=jh.call(this)||this;Ha.ddaFacade=null;Ha.QLf=null;Ha.$=R;R.da.Ga(106,Ha);Ha.Eb();return Ha}function Va(){}function yb(){}function qb(R){this.eFa=R}function dc(R,Ha,Gb){this.iframe=R;this.onSuccess=Ha;this.onError=Gb;$addHandler(window,"message",Object(Hg.a)(this,this.j5e,"handleResponse"))}function bb(R,Ha){return Ji.a.Rsd(64,function(){return window.OfficeExtension&&window.OfficeExtension.WacRuntime},gf.AFrameworkApplication.fa.kd("MaxRetriesForLoadingScript",
0),R,Ha)}function db(R){var Ha=Ii.call(this)||this;Ha.$=R;Ha.Eb();return Ha}function wc(R,Ha){var Gb=this;this.APa=this.BPa=null;this.j$f=function(bc,Rc){var gd=null,wd=null,Ad=null;Rc?(Object(ig.a)(637,Rc)?(gd=Rc.SFa,Ad=Rc.instanceId):Object(ig.a)(412,Rc)&&(gd=Rc.get_element(),Ad=Rc.instanceId),gd)?(wd=Object(bg.a)(834,bc),wd)?Gb.RLf(Ad,gd,wd)||Ad in Gb.APa||(Gb.BPa[Ad]=0,Gb.APa[Ad]=Bj.a.instance.sE(function(){10<=Gb.BPa[Ad]||Gb.RLf(Ad,gd,wd)?(delete Gb.BPa[Ad],Gb.APa[Ad].dispose(),delete Gb.APa[Ad]):
Gb.BPa[Ad]+=1},500,Tj.a.nIg,!0,!1)):Od.ULS.sendTraceTag(537170624,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object."):Od.ULS.sendTraceTag(537170625,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."):Od.ULS.sendTraceTag(537170626,0,10,"Invalid parameter for ReadoutSelection")};this.ariaLiveNotifier=R;this.$=Ha;this.WWc=!1;this.$.da.Ga(224,this)}function nb(R){var Ha=Aj.call(this)||this;Ha.$=R;Ha.Eb();return Ha}function zb(R){var Ha=ej.call(this,R)||this;
Ha.handler=null;Ha.szg=function(){Od.ULS.sendTraceTag(38410434,0,50,"AddinUICommandHandlerFactory.ActivateFeature, isEditMode [{0}] ShowCommandUI [{1}]",Ha.$.isEditMode,!!(Ha.$.Bd&16384));var Gb=new vj.a;Ha.$.da.Za(53,function(me){Od.ULS.sendTraceTag(38410435,0,50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");Gb.setResult(me)});var bc=Gb.task,Rc=new pe,gd=uj.a.getInstance(),wd=new Ee(Ha.$,gd),Ad=Kg.GetServiceTaskFactory.create(Ha.$.da,203,Ha.la,Ha.hb),Ld=Ha.E7i(Rc),
ce=Kg.GetServiceTaskFactory.Ra(Ha.$.da,349,350,Ha.hb);return If.TaskExtensions.Ba(If.TaskExtensions.Wd([bc,Ad,Ld,ce],Ha.la),function(){Od.ULS.sendTraceTag(38942482,0,50,"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");If.TaskExtensions.Ba(Kg.GetServiceTaskFactory.create(Ha.$.da,106,Ha.la,Ha.hb),function(me){Ha.handler=new ma(Ha.$,me.result,Rc,new ef,gd,wd,Rg.a.instance.nh("Common.IExternalUICommandDefinitionMapping"));Od.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");
Ha.jd([Ha.handler]);Ha.$.da.Ga(198,Ha.handler)},Ha.la,3)},Ha.la,3)};Ha.Kbh=function(){void 0!==Ha.handler&&null!==Ha.handler?(Ha.$.Ka.Oab(Ha.handler),Ha.$.da.xU(198),Ha.handler=null):Od.ULS.sendTraceTag(42341715,0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated.");Ha.$.da.xU(204);dj.a(Sj.a,21,Ha.$.da,198)};return Ha}function ma(R,Ha,Gb,bc,Rc,gd,wd){var Ad=this;wd=void 0===wd?null:wd;this.disposed=!1;this.sGi=function(Ld,ce){if(ce)if(ce)if(Ld=
ce.$m){ce=ce.xo;var me=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();if(Ld.solutionId in me)ce=me[Ld.solutionId];else if(ce=Ad.kLh(ce),void 0===ce||null===ce){Od.ULS.sendTraceTag(528098434,220,15,"addinCommandControlId is NullOrUndefined");return}me=new di.a(Bg.a.m2,0,0,2,null);var Je={};Ad.executeCommand(0,me,(Je.SourceControlId=ce,Je),null);Ld.isAutoLaunched=!0}else Od.ULS.sendTraceTag(528098435,220,15,"insertionParam is null");else Od.ULS.sendTraceTag(528098436,220,
15,"agaveParams is null");else Od.ULS.sendTraceTag(528098437,220,15,"No args for OnAutoLaunchAddin event")};this.RNi=function(Ld,ce){Ld=null;ce&&(Ld=ce);(null===Ld||void 0===Ld?0:Ld.xo)&&Ad.fsj(Ld.xo);Ad.$.jf();Ve.EwaSettings.ma(88)&&Ld&&Ld.$m&&Ad.WMg(Ld.$m)};this.$=R;Od.ULS.shipAssertTag(537170659,0,!(void 0===Ha||null===Ha),"AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: {0}",ti.a.e3());this.te=Ha;this.ZAe=Gb;this.GZb=bc;this.Nga=Rc;this.mnb=gd;this.Fo=new Fi.a;
this.Lga=new ue;this.Y9c=wd;Yi.a.dxb=Yi.a.rQe;this.b5c=new $e.a;this.h1a=new $e.a}function P(R){var Ha=this;this.HFa=this.LFa=this.$m=this.xo=null;this.oOf=0;this.QNi=function(){if(Ha.$m&&Ha.HFa){var Gb=new di.a(Bg.a.m2,0,0,2,null),bc={};Ha.addinUICommandHandler.executeCommand(0,Gb,(bc.SourceControlId=Ha.HFa,bc),null);Od.ULS.sendTraceTag(537170697,220,50,"Launch addin command has been triggered")}};this.Vyj=function(Gb,bc){Gb=null;if(bc)if(Gb=bc,Ha.$m=Gb.$m,Ha.xo=Gb.xo,Ha.xo&&Ha.xo.XV&&Ha.xo.XV.Ds&&
(Ha.LFa=Ha.xo.XV.Ds.na(0)),Ha.LFa&&Ha.LFa.id)if(Ha.LFa.isOfficeTab)if(bc=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),Gb=Ha.$m.solutionId,Gb in bc?Ha.HFa=bc[Gb]:(Od.ULS.sendTraceTag(537170695,220,15,"Failed to get button id from controlIdMap for add-in: {0}",P.GetPrivacyCompliantId(Ha.$m)),Ha.HFa=Ha.vHh(Ha.xo)),Ha.HFa)if(Gi.a.contains(Ha.LFa.id,rh.a.tW,!0))appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(ai.a.kub(Ha.xo),function(){Ha.F3f(Ha.kfd(Ha.HFa))});else{if(bc=
Ha.$.Ka)bc.Hne(Ha.HCf),Od.ULS.sendTraceTag(537170693,220,50,"ShowCalloutOnAddin registered a tab switched event")}else Od.ULS.sendTraceTag(537170694,220,10,"Failed to get button id for addin"),bc={},bc=(bc.AppTeachingUICalloutAction="NoEnabledButtonFound",bc["SDX.Id"]=P.GetPrivacyCompliantId(Ha.$m),bc.AppTeachingUICalloutGoal="NewAdminDeployment",bc["SDX.AppInstallOrigin"]="Organization",bc),cg.a.sendTelemetryEvent(Object(Qg.a)(new pg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$f.a.gl(bc)})),
Ha.H5();else Ha.H3f(Ha.kfd(Ha.LFa.id),0);else Od.ULS.sendTraceTag(537170696,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),bc={},bc=(bc.AppTeachingUICalloutAction="NoTabFound",bc["SDX.Id"]=P.GetPrivacyCompliantId(Ha.$m),bc.AppTeachingUICalloutGoal="NewAdminDeployment",bc["SDX.AppInstallOrigin"]="Organization",bc),cg.a.sendTelemetryEvent(Object(Qg.a)(new pg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$f.a.gl(bc)})),Ha.H5();else Ha.H5()};this.HCf=
function(){if(Gi.a.contains(Ha.LFa.id,appChrome.selectors.getSelectedTabId(),!0)){var Gb=Ha.$.Ka;Gb&&Gb.lQf(Ha.HCf);Ha.F3f(Ha.kfd(Ha.HFa))}};this.$=R.$;this.addinUICommandHandler=R;this.appName=gf.AFrameworkApplication.fa.Wa("WebAppShortName")||"Excel";this.zHg=gf.AFrameworkApplication.fa.kd("AddinMaxDOMElementDetectionTimesForTeachingUI",10)}function oa(R,Ha){this.Ujb=R;this.mUa=new Ab;this.MUa=new rb(Ha)}function Ja(R,Ha,Gb,bc,Rc,gd){this.$Pb=new $e.a;this.lhb=this.Vea=this.$Ua=null;this.oNc=R;
this.mUa=Ha;this.MUa=Gb;this.ax=bc;this.cQb=Rc;this.j5d=gd}function $a(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}function Ta(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}function pa(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}function Da(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=
0;this.attributes=this.menuItems=null}function rb(R){this.ECa=R}function Ab(){}function ob(R){this.Ujb=R}function sb(R,Ha,Gb){this.JI=this.ZUa=null;this.oNc=R;this.MUa=Ha;this.mUa=Gb;this.psg=new $e.a}function Pb(R){this.qpa=null;if(ch.c(R))throw Od.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=R}function Aa(R){this.jae=null;if(ch.c(R))throw Od.ULS.sendTraceTag(9175313,220,
10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=R;this.jla[kb.id]=this._id}function Ya(R,Ha){this.WDa=this.j3d=null;if(ch.c(R)||ch.c(Ha))throw Od.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");this.Fmg=Ha;this._id=R;this.jU[kb.id]=this._id}function kb(){}function lb(R,Ha,Gb,bc,Rc,gd,
wd,Ad){Ad=void 0===Ad?null:Ad;this.$a=new $i.a;this.jEc=R;this.zmg=Ha;this.Mm=Gb;this.Ghe=bc;this.UWa=Rc;this.Sjg=gd;this.cQb=wd;this.Ssg=Ad;this.YSb=gf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinTelemetryEnabled",!1);this.Hqg=gf.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")}function ac(R,Ha,Gb,bc,Rc,gd,wd){this.qSa=new xj.a;this.Zs=R;this.ri=Ha;this.Fo=Gb;this.ribbonManager=bc;this.contextMenuManager=
Rc;this.KF=gd;this.Lga=wd;this.qO=gf.AFrameworkApplication.ta.tD}function Dc(R,Ha,Gb){this.H0d=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=R;this.eventBuilder=Ha;this.contextMenuBuilder=Gb}function Zb(R){this.Hng=R.entitlement}function mc(R,Ha,Gb){Ha=void 0===Ha?null:Ha;Gb=void 0===Gb?0:Gb;if(ch.c(R))throw Od.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");
this.$sg=R;this.xwg=Ha;this.Jog=Gb}function Lb(R){this.Bbe=null;if(ch.c(R))throw Od.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");this.dkg=R}function Sa(){}function Cb(R){this.E9d=null;this.y7d=R}function ec(R,Ha,Gb){this.Rtc=!1;this.Zoa=null;this.$a=R;this.Mib=Ha;this.fgb=Gb}function wb(R,Ha,Gb,bc,Rc,gd){this.Zs=R;this.$m=Ha;this.U6=Gb;this.displayName=Rc;this.wif=gd}function rc(){var R=qi.call(this)||
this;R.$m=null;R.xo=null;return R}function Mc(){new Pc(Rh.a.instance)}function Pc(R){this.PDa=R}function Kc(){this.Ver=1}function ub(){}function Fb(R){this.gtg=R}function pc(R,Ha,Gb){this.Qa=new $i.a;this.context=new se;this.e6f=this.ySd=this.IFa=this.Pza=this.Zoa=null;this.contextActivationMgr=R;this.wHg=Ha;this.HZb=Gb;this.appName=gf.AFrameworkApplication.fa.Wa("WebAppShortName")}function eb(R){var Ha=Ei.call(this)||this;Ha.solutionId=R.solutionId;Ha.assetId=R.assetId;Ha.storeType=R.storeType;Ha.storeId=
R.storeId;Ha.assetStoreId=R.assetStoreId;Ha.targetType=R.targetType;Ha.width=R.width;Ha.height=R.height;Ha.displayName=R.displayName;Ha.version=R.version;return Ha}function ic(){this.addinId=null;this.targetType=0;this.storeId=this.solutionId=null}function Ac(R,Ha,Gb,bc){this.OIb=gf.AFrameworkApplication.fa.Wa("RoamingServiceHandlerWebServiceBase");this.appName=R;this.uib=Ha;this.qib=Gb;this.zkb=void 0===bc?null:bc}function lc(R){var Ha=Di.call(this)||this;Ha.properties=R;return Ha}function Gc(){this.sA=
this.Yp=null;this._count=0}function ed(R,Ha,Gb){this.next=Gb;this.previous=Ha;this.data=R}function fd(R){this.zr=null;this.kA=R}function Bc(R){var Ha=-1;switch(R.toLowerCase()){case "omex":Ha=0;break;case "spcatalog":Ha=1;break;case "spapp":Ha=2;break;case "filesystem":Ha=3;break;case "exchange":Ha=4;break;case "registry":Ha=6;break;case "inmemory":Ha=7;break;case "uploadfiledevcatalog":Ha=8;break;case "hardcodedpreinstall":Ha=9;break;case "excatalog":Ha=10;break;case "wopicatalog":Ha=16}return Ha}
function ld(R){var Ha=null;switch(R){case 0:Ha="omex";break;case 1:Ha="spcatalog";break;case 2:Ha="spapp";break;case 3:Ha="filesystem";break;case 4:Ha="exchange";break;case 6:Ha="registry";break;case 7:Ha="inmemory";break;case 8:Ha="uploadfiledevcatalog";break;case 9:Ha="hardcodedpreinstall";break;case 10:Ha="excatalog";break;case 16:Ha="wopicatalog"}return Ha}function Bd(R){var Ha={};Ha.solutionId=R.solutionId;Ha.version=R.version;Ha.storeType=R.storeType;Ha.storeId=R.storeId;Ha.assetId=R.assetId;
Ha.assetStoreId=R.assetStoreId;Ha.targetType=R.targetType;Ha.requireConsent=R.requireConsent||!1;Ha.isAddinCommands=!0;Ha.addinCommandsActionType=0;return Ha}function xb(){return aj.a.d4(window.location.href.toLowerCase(),"wdtpl")}function Fd(){var R=aj.a.d4(window.location.href.toLowerCase(),"wdomexsrctype");return!!R&&"4"===R}function Vd(){}function se(){this.Zs=this.S_=0;this.hVc=null;this.yqc=this.fAc=0;this.u3b=this.$ia=this.G9=null}function ue(){this.CYa=null}function Ee(R,Ha){var Gb=oi.call(this)||
this;Gb.statusBarManager=null;Gb.agaveCommandManager=null;Gb.bye=function(){Gb.KF&&Gb.KF.Ixe()};Gb.e4e=function(){Gb.raiseEvent("LAC")};Gb.Uc=function(bc,Rc){!bc.dc&&wj.b(Rc)&&Gb.statusBarManager&&(Gb.statusBarManager.BF(Gb),Gb.statusBarManager=null)};Gb.KF=Ha;Gb.$=R;Gb.dFj=R.yb+"OfficeAddinLabel-Medium14";Gb.$.da.Za(29,function(bc){Gb.statusBarManager=bc;bc.jJ(Gb)});Gb.$.ea.Wj(Gb.Uc);Gb.KF.BDg(Gb.e4e);Gb.$.da.Za(206,function(bc){Gb.agaveCommandManager=bc;bc.bFg(Gb.bye)});return Gb}function qe(){}
function He(){this.ni=null;this.visible=!1}function Ie(R,Ha){this.Va=R;this.W1g=Ha}function ef(){this.m1d=this.SDc=null}function Ye(){}function pe(){this.zlg=new $e.a}function Qd(R){var Ha=bh.call(this)||this;Ha.$=R;Ha.Eb();return Ha}function fe(R){this.wb=null;this.$=R}function Hc(){return ua.call(this)||this}function ud(){return ua.call(this)||this}function Gd(){return ua.call(this)||this}function jd(){return ua.call(this)||this}function Sd(){return ua.call(this)||this}function Wd(){return ua.call(this)||
this}function Le(){return ua.call(this)||this}function Pd(){return ua.call(this)||this}function Re(){return ua.call(this)||this}function Qe(){return ua.call(this)||this}function jc(){return ua.call(this)||this}function Fa(){return ua.call(this)||this}function Qb(){return ua.call(this)||this}function cb(){return ua.call(this)||this}function Xb(){return ua.call(this)||this}function kc(){return ua.call(this)||this}function Wc(){return ua.call(this)||this}function id(){return ua.call(this)||this}function Vc(){return ua.call(this)||
this}function td(){return ua.call(this)||this}function rd(){return ua.call(this)||this}function za(){return ua.call(this)||this}function tb(){return ua.call(this)||this}function Wb(){return ua.call(this)||this}function fc(){return ua.call(this)||this}function xc(){return ua.call(this)||this}function Yb(){return ua.call(this)||this}function Ec(){return ua.call(this)||this}function bd(){return ua.call(this)||this}function Ic(){return ua.call(this)||this}function Md(){return ua.call(this)||this}function ne(){return ua.call(this)||
this}function le(){return ua.call(this)||this}function Ke(){return ua.call(this)||this}function oc(){return ua.call(this)||this}function Qc(){return ua.call(this)||this}function md(){return ua.call(this)||this}function dd(){return ua.call(this)||this}function Kd(){return ua.call(this)||this}function ke(){return ua.call(this)||this}function kd(){return ua.call(this)||this}function Nd(){return ua.call(this)||this}function ge(){return ua.call(this)||this}function Me(){return ua.call(this)||this}function Ze(){return ua.call(this)||
this}function lf(){return ua.call(this)||this}function he(){return ua.call(this)||this}function Se(){return ua.call(this)||this}function ve(){return ua.call(this)||this}function Xa(){return ua.call(this)||this}function h(){return ua.call(this)||this}function hb(){return ua.call(this)||this}function Tb(){return ua.call(this)||this}function yc(){return ua.call(this)||this}function vc(){return ua.call(this)||this}function yd(){return ua.call(this)||this}function Dd(){return ua.call(this)||this}function qd(){return Uc.call(this,
195,16)||this}function xe(){return Uc.call(this,194,8)||this}function Ge(){return ua.call(this)||this}function Xe(){return Uc.call(this,198,2)||this}function Bb(){return Uc.call(this,197,1)||this}function zc(){return Uc.call(this,196,32)||this}function Mb(){return ua.call(this)||this}function cc(){return Uc.call(this,193,4)||this}function Uc(R,Ha){var Gb=ua.call(this)||this;Gb.hfa=R;Gb.TYd=Ha;return Gb}function Rb(){return ua.call(this)||this}function qc(){return ua.call(this)||this}function Oc(){return ua.call(this)||
this}function jb(){return ua.call(this)||this}function Eb(){return ua.call(this)||this}function nc(){return ua.call(this)||this}function $c(){return Cf.call(this,11,16)||this}function od(){return Cf.call(this,10,128)||this}function de(){return ua.call(this)||this}function ae(){return ua.call(this)||this}function ze(){return ua.call(this)||this}function Xd(){return ua.call(this)||this}function te(){return ua.call(this)||this}function af(){return ua.call(this)||this}function cf(){return ua.call(this)||
this}function Pa(){return ua.call(this)||this}function Sb(){return ua.call(this)||this}function Jc(){return Cf.call(this,9,2)||this}function nd(){return Cf.call(this,8,1)||this}function zd(){return Cf.call(this,7,8)||this}function Zd(){return Cf.call(this,6,32)||this}function be(){return ua.call(this)||this}function Be(){return ua.call(this)||this}function Te(){return ua.call(this)||this}function Ua(){return ua.call(this)||this}function Jb(){return ua.call(this)||this}function gc(){return ua.call(this)||
this}function Sc(){return ua.call(this)||this}function cd(){return ua.call(this)||this}function xd(){return ua.call(this)||this}function Hd(){return ua.call(this)||this}function ee(){return ua.call(this)||this}function Yd(){return ua.call(this)||this}function we(){return ua.call(this)||this}function Rd(){return ua.call(this)||this}function sc(){return Cf.call(this,4,64)||this}function Yc(){return ua.call(this)||this}function oe(){return ua.call(this)||this}function Qf(){return ua.call(this)||this}
function Ae(){return ua.call(this)||this}function of(){return ua.call(this)||this}function De(){return ua.call(this)||this}function wf(){return ua.call(this)||this}function xf(){}function ag(){return ua.call(this)||this}function hf(){return Cf.call(this,3,4)||this}function Cf(R,Ha){var Gb=ua.call(this)||this;Gb.hfa=R;Gb.TYd=Ha;return Gb}function Dg(){return ua.call(this)||this}function wg(){return ua.call(this)||this}function rg(){return ua.call(this)||this}function Ef(){return ua.call(this)||this}
function yf(){return ie.call(this,185,18)||this}function Jg(){return ua.call(this)||this}function Vg(){return ie.call(this,181,14)||this}function Yf(){return ie.call(this,169,2)||this}function Wf(){return ie.call(this,168,1)||this}function xg(){return ua.call(this)||this}function Mg(){return ie.call(this,182,15)||this}function hg(){return ua.call(this)||this}function mg(){return ua.call(this)||this}function ih(){return ie.call(this,180,13)||this}function sg(){return ie.call(this,186,19)||this}function kg(){return ie.call(this,
175,8)||this}function Wg(){return ie.call(this,176,9)||this}function pf(){return ie.call(this,187,20)||this}function ah(){return ie.call(this,174,7)||this}function Ng(){return ie.call(this,179,12)||this}function Eg(){return ie.call(this,178,11)||this}function Fg(){return ie.call(this,177,10)||this}function Wa(){return ua.call(this)||this}function Vb(){return ie.call(this,170,3)||this}function uc(){return ie.call(this,172,5)||this}function Xc(){return ie.call(this,173,6)||this}function Cc(){return ie.call(this,
183,16)||this}function Ed(){return ie.call(this,184,17)||this}function Td(){return ie.call(this,171,4)||this}function ie(R,Ha){var Gb=ua.call(this)||this;Gb.hfa=R;Gb.opType=Ha;return Gb}function re(){return ua.call(this)||this}function Fe(){return ua.call(this)||this}function Oa(){return ua.call(this)||this}function Ba(){return ua.call(this)||this}function Nb(){return ua.call(this)||this}function sd(){return ua.call(this)||this}function Jd(){return ua.call(this)||this}function Ce(){return ua.call(this)||
this}function Oe(){return ua.call(this)||this}function mf(){return ua.call(this)||this}function ff(){return ua.call(this)||this}function nf(){return ua.call(this)||this}function Lf(){return ua.call(this)||this}function Zf(){return ua.call(this)||this}function Of(){return ua.call(this)||this}function tg(){return ua.call(this)||this}function Og(){return ua.call(this)||this}function sf(){return ua.call(this)||this}function ug(){return ua.call(this)||this}function mh(){return ua.call(this)||this}function fh(){return ua.call(this)||
this}function Ag(){return eg.call(this)||this}function Ug(){return ua.call(this)||this}function zg(){return ua.call(this)||this}function Tg(){return ua.call(this)||this}function Fh(){return ua.call(this)||this}function Gh(){return ua.call(this)||this}function gh(){return ua.call(this)||this}function vg(){return ua.call(this)||this}function Gg(){return ua.call(this)||this}function Vf(){return ua.call(this)||this}function th(){return Ca.call(this,78,[-105,-106,-107,-108,-109,-110,-111,-112,-113,-114,
-127,-116,-117,-118,-119,-120,-121,-122,-123,-125,-124,-126,-216,-217,-218,-219,-221,-222,-220,-129,-130,-131])||this}function Mh(){return Ca.call(this,79,[0,1,2,-102])||this}function lh(){return Ca.call(this,75,[-101])||this}function $g(){return Ca.call(this,81,[100,101,102,103,104,105,106])||this}function ng(){return ua.call(this)||this}function uh(){return Ca.call(this,85,[328,329,330,331,332,333,334,335])||this}function Pg(){return eg.call(this)||this}function yg(R,Ha,Gb){this.response=this.request=
this.eventId=this.source=null;R&&(this.source=R.source,this.eventId=R.eventId,this.request=Ha,this.response=Gb)}function eg(){return ua.call(this)||this}function qh(){return Ca.call(this,83,[500,501,502])||this}function sh(){return Ca.call(this,76,[-100])||this}function t(){return Ca.call(this,82,[200,201,202,203,204,205,206,207,208,209,210])||this}function L(){return Ca.call(this,80,[-104,-103,300,301,302,303,304,305,306,307,308,309,310,311])||this}function ja(){return Ca.call(this,84,[348,349,350,
351,352,353,354,355,356,357,372,373,374,375])||this}function Ca(R,Ha){var Gb=ua.call(this)||this;Gb.hfa=R;Gb.aVj=Ha;return Gb}function Ra(){return ua.call(this)||this}function ib(){return ua.call(this)||this}function tc(){return ua.call(this)||this}function V(){return ua.call(this)||this}function ua(){this.THc=this.UHc=this.PNc=this.nSc=null}function Ib(R,Ha,Gb){var bc=this;this.C9b=null;this.Bxi=function(Rc,gd){bc.v1f()&&bc.V$c(gd)};this.bof=Ha;this.aof=Gb;this.$=R;this.$.Aba&&this.$.SFg(this.Bxi);
R.da.Ga(297,this)}function $b(){}function Tc(){}function Id(){this.qgb=null}b.r(D);var Ud=b(559),je=b(1164),ye=b(1391),Pe=b(11),Cd=b(0),We=b(232),$e=b(202),vf=b(648);Id.prototype.Eei=function(R){return this.yNg.contains(R.operation)};Id.prototype.kOj=function(R){for(var Ha=[],Gb=ak(R.payload.batchedOperations),bc=Gb.next();!bc.done;bc=Gb.next())Ha.push(new vf.a(R.operation,bc.value));return Ha};Af.Object.defineProperties(Id.prototype,{yNg:{configurable:!0,enumerable:!0,get:function(){this.qgb||(this.qgb=
new $e.a,this.qgb.add(12),this.qgb.add(11));return this.qgb}}});Object(Cd.a)(Id,"MacroRecorderBatchedEventList",null,[]);var Od=b(15),kf=b(54),uf=b(128),Tf=b(737);Tc.prototype.equals=function(R,Ha){return R===Ha};Tc.prototype.getHashCode=function(R){return R};Tc.prototype.pja=function(R){return R};Object(Cd.a)(Tc,"UserOperationNameComparer",null,[24,25]);$b.g0h=function(){$b.Gc||($b.Gc=new Tf.a(new Tc),$b.Gc.add(507),$b.Gc.add(10),$b.Gc.add(576),$b.Gc.add(563),$b.Gc.add(564),$b.Gc.add(565),$b.Gc.add(566),
$b.Gc.add(567),$b.Gc.add(568),$b.Gc.add(569),$b.Gc.add(570),$b.Gc.add(571),$b.Gc.add(572),$b.Gc.add(573),$b.Gc.add(574),$b.Gc.add(575),$b.Gc.add(501),$b.Gc.add(520),$b.Gc.add(1),$b.Gc.add(1002),$b.Gc.add(129),$b.Gc.add(198),$b.Gc.add(500),$b.Gc.add(519),$b.Gc.add(538),$b.Gc.add(1E3),$b.Gc.add(1003),$b.Gc.add(144),$b.Gc.add(502),$b.Gc.add(505),$b.Gc.add(179),$b.Gc.add(205),$b.Gc.add(134),$b.Gc.add(230),$b.Gc.add(103),$b.Gc.add(110),$b.Gc.add(112),$b.Gc.add(113),$b.Gc.add(124),$b.Gc.add(133),$b.Gc.add(154),
$b.Gc.add(162),$b.Gc.add(168),$b.Gc.add(172),$b.Gc.add(201),$b.Gc.add(222),$b.Gc.add(227),$b.Gc.add(513),$b.Gc.add(534),$b.Gc.add(539),$b.Gc.add(545),$b.Gc.add(600),$b.Gc.add(547),$b.Gc.add(555),$b.Gc.add(558),$b.Gc.add(562),$b.Gc.add(585),$b.Gc.add(1001),$b.Gc.add(1005),$b.Gc.add(1008),$b.Gc.add(1010),$b.Gc.add(1011),$b.Gc.add(1012),$b.Gc.add(1018),$b.Gc.add(252),$b.Gc.add(253),$b.Gc.add(258),$b.Gc.add(101),$b.Gc.add(102),$b.Gc.add(108),$b.Gc.add(257),$b.Gc.add(119),$b.Gc.add(120),$b.Gc.add(123),
$b.Gc.add(126),$b.Gc.add(127),$b.Gc.add(130),$b.Gc.add(140),$b.Gc.add(159),$b.Gc.add(160),$b.Gc.add(165),$b.Gc.add(166),$b.Gc.add(167),$b.Gc.add(169),$b.Gc.add(189),$b.Gc.add(223),$b.Gc.add(214),$b.Gc.add(228),$b.Gc.add(233),$b.Gc.add(247),$b.Gc.add(504),$b.Gc.add(511),$b.Gc.add(512),$b.Gc.add(525),$b.Gc.add(533),$b.Gc.add(537),$b.Gc.add(542),$b.Gc.add(544),$b.Gc.add(548),$b.Gc.add(550),$b.Gc.add(551),$b.Gc.add(552),$b.Gc.add(554),$b.Gc.add(577),$b.Gc.add(584),$b.Gc.add(586),$b.Gc.add(587),$b.Gc.add(588),
$b.Gc.add(592),$b.Gc.add(1009),$b.Gc.add(1016),$b.Gc.add(1017));return $b.Gc};$b.Gc=null;Object(Cd.a)($b,"MacroRecorderUnrecognizedEventList",null,[]);Ib.prototype.init=function(R){this.$.Aba&&(R?this.C9b=R:Od.ULS.sendTraceTag(537155424,0,10,"MacroRecorderEventHandler.Init failed because the function passed in is null."))};Ib.prototype.V$c=function(R){if(this.v1f())try{if(this.aof.Eei(R))for(var Ha=this.aof.kOj(R),Gb=ak(Ha),bc=Gb.next();!bc.done;bc=Gb.next())this.SSe(bc.value);else this.SSe(R)}catch(Rc){R=
String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Error: {0}, Exception: {1}",uf.a(R.operation),Rc.stack),Od.ULS.sendTraceTag(537155423,0,10,R)}};Ib.prototype.SSe=function(R){var Ha=this.bof.SZe(R,!0);Ha?(this.C9b(Ha.eventId,kf.a.xc(R.payload)),R=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: {0}",Ha.eventId),Od.ULS.sendTraceTag(537155422,0,50,R)):(Ha=this.bof.SZe(R,!1))?(R=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: {0}, but failed to match filters",
Ha.eventId),Od.ULS.sendTraceTag(537155421,0,50,R)):$b.g0h().contains(R.operation)||(this.C9b(0,kf.a.xc(R.operation)),R=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: {0}",uf.a(R.operation)),Od.ULS.sendTraceTag(537155420,0,50,R))};Ib.prototype.v1f=function(){return this.$.xka&&this.C9b&&this.$.wba?!0:!1};Object(Cd.a)(Ib,"MacroRecorderEventHandler",null,[845]);var Ve=b(1);ua.prototype.jg=function(){};ua.prototype.Wva=function(){};ua.prototype.hd=function(R){this.rCc.add(R)};
ua.prototype.Nb=function(R){this.operations.contains(R)||this.operations.add(R)};ua.prototype.Jmb=function(){this.featureGates.add(677)};ua.prototype.Hke=function(R){this.wRe.add(R)};Af.Object.defineProperties(ua.prototype,{operations:{configurable:!0,enumerable:!0,get:function(){this.PNc||(this.PNc=new $e.a,this.Xb());return this.PNc}},rCc:{configurable:!0,enumerable:!0,get:function(){this.nSc||(this.nSc=new $e.a,this.jg());return this.nSc}},wRe:{configurable:!0,enumerable:!0,get:function(){this.THc||
(this.THc=new $e.a);return this.THc}},featureGates:{configurable:!0,enumerable:!0,get:function(){this.UHc||(this.UHc=new $e.a,this.Wva());return this.UHc}}});Object(Cd.a)(ua,"MacroRecorderEventBase",null,[]);Rk(V,ua);V.prototype.Xb=function(){this.Nb(100)};Af.Object.defineProperties(V.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 130}}});Object(Cd.a)(V,"AccessibilityCheckRunEvent",ua,[]);Rk(tc,ua);tc.prototype.Xb=function(){this.Nb(241)};tc.prototype.jg=function(){this.hd(function(R){return R.addToPrintArea})};
Af.Object.defineProperties(tc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 160}}});Object(Cd.a)(tc,"AddedToPrintAreaEvent",ua,[]);Rk(ib,ua);ib.prototype.Xb=function(){this.Nb(516)};Af.Object.defineProperties(ib.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 65}}});Object(Cd.a)(ib,"AutoFilterToggledEvent",ua,[]);Rk(Ra,ua);Ra.prototype.Xb=function(){this.Nb(502)};Ra.prototype.jg=function(){this.hd(function(R){return!(R.a4a().FirstColumn===R.a4a().LastColumn&&
R.a4a().FirstRow===R.a4a().LastRow)})};Af.Object.defineProperties(Ra.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 118}}});Object(Cd.a)(Ra,"AutoSumEvent",ua,[]);Rk(Ca,ua);Ca.prototype.Xb=function(){this.Nb(529);this.Nb(594)};Ca.prototype.jg=function(){var R=this;this.hd(function(Ha){return Array.contains(R.aVj,Ha.Ped())})};Af.Object.defineProperties(Ca.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.hfa}}});Object(Cd.a)(Ca,"ChartPropertyAppliedEventBase",
ua,[]);Rk(ja,Ca);Object(Cd.a)(ja,"ChartAxisChangedEvent",Ca,[]);Rk(L,Ca);Object(Cd.a)(L,"ChartAxisTitleChangedEvent",Ca,[]);Rk(t,Ca);Object(Cd.a)(t,"ChartDataLabelsChangedEvent",Ca,[]);Rk(sh,Ca);Object(Cd.a)(sh,"ChartDataSelectedEvent",Ca,[]);Rk(qh,Ca);Object(Cd.a)(qh,"ChartDataTableChangedEvent",Ca,[]);var fg=b(616),ig=b(440),bg=b(85);Rk(eg,ua);Object(Cd.a)(eg,"RichApiRequestExecutedEventBase",ua,[]);Af.Object.defineProperties(yg.prototype,{isValid:{configurable:!0,enumerable:!0,get:function(){return!(void 0===
this.source||null===this.source)&&!(void 0===this.eventId||null===this.eventId)&&!0}}});Object(Cd.a)(yg,"MacroRecorderRichApiRequestExecutedPayload",null,[409]);Rk(Pg,eg);Pg.prototype.eF=function(R){Pg.O6||(Pg.O6=new Tf.a(fg.a.Jk()),Pg.O6.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),Pg.O6.add("fa000000014"));return!!R&&Pg.O6.contains(R.toLowerCase())};Pg.prototype.Xb=function(){this.Nb(507);this.Nb(10);this.Nb(576)};Pg.prototype.jg=function(){var R=this;this.hd(function(Ha){return Object(ig.a)(yg,
Ha)&&(Ha=Object(bg.a)(yg,Ha),Ha.isValid&&R.eF(Ha.source))?(Od.ULS.sendTraceTag(537155427,0,50,"[RichApiRecorder]: A ChartFormatRichApiRequestExecutedEvent is matched! eventId: {0}",Ha.eventId),!0):!1})};Af.Object.defineProperties(Pg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 117}}});Pg.O6=null;Object(Cd.a)(Pg,"ChartFormatRichApiRequestExecutedEvent",eg,[]);Rk(uh,Ca);Object(Cd.a)(uh,"ChartGridlinesChangedEvent",Ca,[]);Rk(ng,ua);ng.prototype.Xb=function(){this.Nb(528)};
Af.Object.defineProperties(ng.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 66}}});Object(Cd.a)(ng,"ChartInsertedEvent",ua,[]);Rk($g,Ca);Object(Cd.a)($g,"ChartLegendChangedEvent",Ca,[]);Rk(lh,Ca);Object(Cd.a)(lh,"ChartRowColumnSwitchedEvent",Ca,[]);Rk(Mh,Ca);Object(Cd.a)(Mh,"ChartTitleChangedEvent",Ca,[]);Rk(th,Ca);Object(Cd.a)(th,"ChartTypeChangedEvent",Ca,[]);Rk(Vf,ua);Vf.prototype.Xb=function(){this.Nb(521)};Af.Object.defineProperties(Vf.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 131}}});Object(Cd.a)(Vf,"ConnectorFloatingObjectResizedEvent",ua,[]);Rk(Gg,ua);Gg.prototype.Xb=function(){this.Nb(109)};Af.Object.defineProperties(Gg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 129}}});Object(Cd.a)(Gg,"EntitySelectedEvent",ua,[]);Rk(vg,ua);vg.prototype.Xb=function(){this.Nb(149);this.Nb(147)};Af.Object.defineProperties(vg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 49}}});Object(Cd.a)(vg,"FindCellEvent",
ua,[]);Rk(gh,ua);gh.prototype.Xb=function(){this.Nb(122)};Af.Object.defineProperties(gh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 96}}});Object(Cd.a)(gh,"FloatingObjectAltTextAppliedEvent",ua,[]);Rk(Gh,ua);Gh.prototype.Xb=function(){this.Nb(522)};Af.Object.defineProperties(Gh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 93}}});Object(Cd.a)(Gh,"FloatingObjectDeletedEvent",ua,[]);Rk(Fh,ua);Fh.prototype.Xb=function(){this.Nb(524)};Af.Object.defineProperties(Fh.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 94}}});Object(Cd.a)(Fh,"FloatingObjectMovedAndResizedEvent",ua,[]);Rk(Tg,ua);Tg.prototype.Xb=function(){this.Nb(523)};Af.Object.defineProperties(Tg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 95}}});Object(Cd.a)(Tg,"FloatingObjectRotatedEvent",ua,[]);Rk(zg,ua);zg.prototype.Xb=function(){this.Nb(543)};Af.Object.defineProperties(zg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 100}}});
Object(Cd.a)(zg,"GroupDetailsShownOrHiddenEvent",ua,[]);Rk(Ug,ua);Ug.prototype.Xb=function(){this.Nb(125)};Af.Object.defineProperties(Ug.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 154}}});Object(Cd.a)(Ug,"HyperlinksRemovedFromRangeEvent",ua,[]);Rk(Ag,eg);Ag.prototype.eF=function(R){Ag.O6||(Ag.O6=new Tf.a(fg.a.Jk()),Ag.O6.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),Ag.O6.add("fa000000005"));return!!R&&Ag.O6.contains(R.toLowerCase())};Ag.prototype.Xb=function(){this.Nb(507);
this.Nb(10);this.Nb(576)};Ag.prototype.jg=function(){var R=this;this.hd(function(Ha){return Object(ig.a)(yg,Ha)?(Ha=Object(bg.a)(yg,Ha),Ha.isValid&&R.eF(Ha.source)):!1})};Af.Object.defineProperties(Ag.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 125}}});Ag.O6=null;Object(Cd.a)(Ag,"IdeasRichApiRequestExecutedEvent",eg,[]);Rk(fh,ua);fh.prototype.Xb=function(){this.Nb(115)};Af.Object.defineProperties(fh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 136}}});
Object(Cd.a)(fh,"LinkedEntityConvertedEvent",ua,[]);Rk(mh,ua);mh.prototype.Xb=function(){this.Nb(114)};Af.Object.defineProperties(mh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 148}}});Object(Cd.a)(mh,"LinkedEntityDisambiguationPaneToggledEvent",ua,[]);Rk(ug,ua);ug.prototype.Xb=function(){this.Nb(119)};Af.Object.defineProperties(ug.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 127}}});Object(Cd.a)(ug,"MovedToEdgeEvent",ua,[]);Rk(sf,ua);sf.prototype.Xb=
function(){this.Nb(191)};sf.prototype.Wva=function(){this.Jmb()};Af.Object.defineProperties(sf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 135}}});Object(Cd.a)(sf,"NamedSheetViewCreatedEvent",ua,[]);Rk(Og,ua);Og.prototype.Xb=function(){this.Nb(200)};Og.prototype.Wva=function(){this.Jmb()};Af.Object.defineProperties(Og.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 166}}});Object(Cd.a)(Og,"NamedSheetViewDeletedEvent",ua,[]);Rk(tg,ua);tg.prototype.Xb=
function(){this.Nb(192)};tg.prototype.Wva=function(){this.Jmb()};Af.Object.defineProperties(tg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 133}}});Object(Cd.a)(tg,"NamedSheetViewExitedEvent",ua,[]);Rk(Of,ua);Of.prototype.Xb=function(){this.Nb(199)};Of.prototype.Wva=function(){this.Jmb()};Af.Object.defineProperties(Of.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 162}}});Object(Cd.a)(Of,"NamedSheetViewRenamedEvent",ua,[]);Rk(Zf,ua);Zf.prototype.Xb=
function(){this.Nb(195)};Zf.prototype.Wva=function(){this.Jmb()};Af.Object.defineProperties(Zf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 167}}});Object(Cd.a)(Zf,"NamedSheetViewSwitchedEvent",ua,[]);Rk(Lf,ua);Lf.prototype.Xb=function(){this.Nb(174)};Af.Object.defineProperties(Lf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 99}}});Object(Cd.a)(Lf,"OutlineLevelSetEvent",ua,[]);Rk(nf,ua);nf.prototype.Xb=function(){this.Nb(244)};Af.Object.defineProperties(nf.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 156}}});Object(Cd.a)(nf,"PageBreakInsertedEvent",ua,[]);Rk(ff,ua);ff.prototype.Xb=function(){this.Nb(245)};Af.Object.defineProperties(ff.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 157}}});Object(Cd.a)(ff,"PageBreakRemovedEvent",ua,[]);Rk(mf,ua);mf.prototype.Xb=function(){this.Nb(246)};Af.Object.defineProperties(mf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 158}}});Object(Cd.a)(mf,
"PageBreaksAllResetEvent",ua,[]);Rk(Oe,ua);Oe.prototype.Xb=function(){this.Nb(503)};Oe.prototype.jg=function(){this.hd(function(R){return!!R.pasteParameters.ClientEstimationFloatingObjectId&&2===R.pasteParameters.CopyPasteTargetType&&!R.isFromCurrentSession})};Af.Object.defineProperties(Oe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 112}}});Object(Cd.a)(Oe,"PasteArtOtherWorkbookEvent",ua,[]);Rk(Ce,ua);Ce.prototype.Xb=function(){this.Nb(503)};Ce.prototype.jg=function(){this.hd(function(R){return!!R.pasteParameters.ClientEstimationFloatingObjectId&&
2===R.pasteParameters.CopyPasteTargetType&&R.isFromCurrentSession})};Af.Object.defineProperties(Ce.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 52}}});Object(Cd.a)(Ce,"PasteArtSameWorkbookEvent",ua,[]);Rk(Jd,ua);Jd.prototype.Xb=function(){this.Nb(204)};Af.Object.defineProperties(Jd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 110}}});Object(Cd.a)(Jd,"PasteHtmlEvent",ua,[]);Rk(sd,ua);sd.prototype.Xb=function(){this.Nb(506)};Af.Object.defineProperties(sd.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 35}}});Object(Cd.a)(sd,"PasteRangeEvent",ua,[]);Rk(Nb,ua);Nb.prototype.Xb=function(){this.Nb(503)};Nb.prototype.jg=function(){this.hd(function(R){return 1===R.pasteParameters.CopyPasteTargetType})};Af.Object.defineProperties(Nb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 111}}});Object(Cd.a)(Nb,"PasteShadowWorkbookRangeEvent",ua,[]);Rk(Ba,ua);Ba.prototype.Xb=function(){this.Nb(180)};Af.Object.defineProperties(Ba.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 42}}});Object(Cd.a)(Ba,"PasteStringEvent",ua,[]);Rk(Oa,ua);Oa.prototype.Xb=function(){this.Nb(220)};Af.Object.defineProperties(Oa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 134}}});Object(Cd.a)(Oa,"PendingMergeEvent",ua,[]);Rk(Fe,ua);Fe.prototype.Xb=function(){this.Nb(510)};Af.Object.defineProperties(Fe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 122}}});Object(Cd.a)(Fe,"PictureInsertedEvent",
ua,[]);Rk(re,ua);re.prototype.Xb=function(){this.Nb(161)};Af.Object.defineProperties(re.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 153}}});Object(Cd.a)(re,"PivotDrillToggledEvent",ua,[]);Rk(ie,ua);ie.prototype.Xb=function(){this.Nb(225)};ie.prototype.jg=function(){var R=this;this.hd(function(Ha){return Ha.opType===R.opType})};Af.Object.defineProperties(ie.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.hfa}}});Object(Cd.a)(ie,"PivotTableSettingsChangedEventBase",
ua,[]);Rk(Td,ie);Object(Cd.a)(Td,"PivotTableAllItemLabelsRepeatedEvent",ie,[]);Rk(Ed,ie);Object(Cd.a)(Ed,"PivotTableAltTextDescriptionChangedEvent",ie,[]);Rk(Cc,ie);Object(Cd.a)(Cc,"PivotTableAltTextTitleChangedEvent",ie,[]);Rk(Xc,ie);Object(Cd.a)(Xc,"PivotTableAutoFitColumnWidthsOnRefreshToggledEvent",ie,[]);Rk(uc,ie);Object(Cd.a)(uc,"PivotTableBlankLineAfterEachItemToggledEvent",ie,[]);Rk(Vb,ie);Object(Cd.a)(Vb,"PivotTableColumnGrandTotalShownEvent",ie,[]);Rk(Wa,ua);Wa.prototype.Xb=function(){this.Nb(132)};
Af.Object.defineProperties(Wa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 98}}});Object(Cd.a)(Wa,"PivotTableCreatedEvent",ua,[]);Rk(Fg,ie);Object(Cd.a)(Fg,"PivotTableDisplayErrorStringToggledEvent",ie,[]);Rk(Eg,ie);Object(Cd.a)(Eg,"PivotTableDisplayNullStringToggledEvent",ie,[]);Rk(Ng,ie);Object(Cd.a)(Ng,"PivotTableErrorStringChangedEvent",ie,[]);Rk(ah,ie);Object(Cd.a)(ah,"PivotTableExpandCollapseButtonsShownEvent",ie,[]);Rk(pf,ie);Object(Cd.a)(pf,"PivotTableIndentChangedEvent",
ie,[]);Rk(Wg,ie);Object(Cd.a)(Wg,"PivotTableItemsWithNoDataOnColumnsShownEvent",ie,[]);Rk(kg,ie);Object(Cd.a)(kg,"PivotTableItemsWithNoDataOnRowsShownEvent",ie,[]);Rk(sg,ie);Object(Cd.a)(sg,"PivotTableLayoutTypeSetEvent",ie,[]);Rk(ih,ie);Object(Cd.a)(ih,"PivotTableNullStringChangedEvent",ie,[]);Rk(mg,ua);mg.prototype.Xb=function(){this.Nb(219)};Af.Object.defineProperties(mg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 149}}});Object(Cd.a)(mg,"PivotTablePivotLocationChangedEvent",
ua,[]);Rk(hg,ua);hg.prototype.Xb=function(){this.Nb(145)};Af.Object.defineProperties(hg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 102}}});Object(Cd.a)(hg,"PivotTablePivotedEvent",ua,[]);Rk(Mg,ie);Object(Cd.a)(Mg,"PivotTableRefreshDataOnLoadToggledEvent",ie,[]);Rk(xg,ua);xg.prototype.Xb=function(){this.Nb(50)};xg.prototype.jg=function(){this.hd(function(R){return!!R.pivotTableId&&!!R.pivotTableName})};Af.Object.defineProperties(xg.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 104}}});Object(Cd.a)(xg,"PivotTableRefreshedEvent",ua,[]);Rk(Wf,ie);Object(Cd.a)(Wf,"PivotTableRenamedEvent",ie,[]);Rk(Yf,ie);Object(Cd.a)(Yf,"PivotTableRowGrandTotalShownEvent",ie,[]);Rk(Vg,ie);Object(Cd.a)(Vg,"PivotTableSaveSourceDataWithFileToggledEvent",ie,[]);var zh=b(703);Rk(Jg,ua);Jg.prototype.Xb=function(){this.Nb(131)};Jg.prototype.jg=function(){this.hd(function(R){R=Object(bg.a)(zh.a,R);return!!R&&!!R.NJa()&&!!R.hierarchyName})};Af.Object.defineProperties(Jg.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 155}}});Object(Cd.a)(Jg,"PivotTableSortedEvent",ua,[]);Rk(yf,ie);Object(Cd.a)(yf,"PivotTableSubTotalsVisibilitySettingSetEvent",ie,[]);Rk(Ef,ua);Ef.prototype.Xb=function(){this.Nb(560)};Af.Object.defineProperties(Ef.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 206}}});Object(Cd.a)(Ef,"PivotValueFieldSettingAppliedEvent",ua,[]);Rk(rg,ua);rg.prototype.Xb=function(){this.Nb(243)};Af.Object.defineProperties(rg.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 161}}});Object(Cd.a)(rg,"PrintAreaClearedEvent",ua,[]);Rk(wg,ua);wg.prototype.Xb=function(){this.Nb(241)};wg.prototype.jg=function(){this.hd(function(R){return!R.addToPrintArea})};Af.Object.defineProperties(wg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 159}}});Object(Cd.a)(wg,"PrintAreaSetEvent",ua,[]);Rk(Dg,ua);Dg.prototype.Xb=function(){this.Nb(517)};Af.Object.defineProperties(Dg.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 57}}});Object(Cd.a)(Dg,"RangeAutoFilterClearedEvent",ua,[]);Rk(Cf,ua);Cf.prototype.Xb=function(){this.Nb(11)};Cf.prototype.jg=function(){var R=this;this.hd(function(Ha){return 16===Ha.pZ().ValidMembers});this.hd(function(Ha){return Ha.pZ().Font.ValidMembers===R.TYd})};Af.Object.defineProperties(Cf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.hfa}}});Object(Cd.a)(Cf,"RangeFontFormattedEventBase",ua,[]);Rk(hf,Cf);Object(Cd.a)(hf,"RangeBoldedEvent",
Cf,[]);Rk(ag,ua);ag.prototype.Xb=function(){this.Nb(11)};ag.prototype.jg=function(){this.hd(function(R){return 128===R.pZ().ValidMembers})};Af.Object.defineProperties(ag.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 2}}});Object(Cd.a)(ag,"RangeBorderedEvent",ua,[]);xf.Z9a="Table";xf.Ioc="Sheet";Object(Cd.a)(xf,"MacroRecorderEventConstants",null,[]);Rk(wf,ua);wf.prototype.Xb=function(){this.Nb(208)};wf.prototype.jg=function(){this.hd(function(R){return R.getParameters().FilterType===
xf.Ioc})};Af.Object.defineProperties(wf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 113}}});Object(Cd.a)(wf,"RangeCheckedItemsFilteredEvent",ua,[]);Rk(De,ua);De.prototype.Xb=function(){this.Nb(105)};Af.Object.defineProperties(De.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 109}}});Object(Cd.a)(De,"RangeConditionalFormattingCreatedEvent",ua,[]);Rk(of,ua);of.prototype.Xb=function(){this.Nb(221)};Af.Object.defineProperties(of.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 124}}});Object(Cd.a)(of,"RangeConditionalFormattingRuleDeletedEvent",ua,[]);Rk(Ae,ua);Ae.prototype.Xb=function(){this.Nb(508)};Ae.prototype.jg=function(){this.hd(function(R){return 3===R.Ut()||1===R.Ut()||4===R.Ut()})};Af.Object.defineProperties(Ae.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 29}}});Object(Cd.a)(Ae,"RangeContentClearedEvent",ua,[]);Rk(Qf,ua);Qf.prototype.Xb=function(){this.Nb(104)};Af.Object.defineProperties(Qf.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 40}}});Object(Cd.a)(Qf,"RangeCopiedCutCellsInsertedEvent",ua,[]);Rk(oe,ua);oe.prototype.Xb=function(){this.Nb(209)};oe.prototype.jg=function(){this.hd(function(R){return R.getParameters().FilterType===xf.Ioc})};Af.Object.defineProperties(oe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 114}}});Object(Cd.a)(oe,"RangeCustomFilteredEvent",ua,[]);Rk(Yc,ua);Yc.prototype.Xb=function(){this.Nb(121)};Af.Object.defineProperties(Yc.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 106}}});Object(Cd.a)(Yc,"RangeDataValidationChangedEvent",ua,[]);Rk(sc,Cf);Object(Cd.a)(sc,"RangeDoubleUnderlinedEvent",Cf,[]);Rk(Rd,ua);Rd.prototype.Xb=function(){this.Nb(190)};Af.Object.defineProperties(Rd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 69}}});Object(Cd.a)(Rd,"RangeDuplicatesRemovedEvent",ua,[]);Rk(we,ua);we.prototype.Xb=function(){this.Nb(527);this.Nb(12)};Af.Object.defineProperties(we.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 1}}});Object(Cd.a)(we,"RangeEditedEvent",ua,[]);Rk(Yd,ua);Yd.prototype.Xb=function(){this.Nb(255)};Yd.prototype.jg=function(){this.hd(function(R){return 4===R.actionType})};Af.Object.defineProperties(Yd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 164}}});Object(Cd.a)(Yd,"RangeExternalLinksBrokeAllLinksEvent",ua,[]);Rk(ee,ua);ee.prototype.Xb=function(){this.Nb(255)};ee.prototype.jg=function(){this.hd(function(R){return 3===
R.actionType})};Af.Object.defineProperties(ee.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 119}}});Object(Cd.a)(ee,"RangeExternalLinksBrokeLinkEvent",ua,[]);Rk(Hd,ua);Hd.prototype.Xb=function(){this.Nb(256)};Hd.prototype.Wva=function(){this.Hke("Microsoft.Office.Excel.WebExternalLinksChangeSourceMacroRecorder")};Af.Object.defineProperties(Hd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 205}}});Object(Cd.a)(Hd,"RangeExternalLinksChangeSourceEvent",
ua,[]);Rk(xd,ua);xd.prototype.Xb=function(){this.Nb(553)};xd.prototype.jg=function(){this.hd(function(R){return 1===R.actionType})};Af.Object.defineProperties(xd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 163}}});Object(Cd.a)(xd,"RangeExternalLinksRefreshedAllEvent",ua,[]);Rk(cd,ua);cd.prototype.Xb=function(){this.Nb(553)};cd.prototype.jg=function(){this.hd(function(R){return 0===R.actionType})};Af.Object.defineProperties(cd.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 77}}});Object(Cd.a)(cd,"RangeExternalLinksRefreshedEvent",ua,[]);Rk(Sc,ua);Sc.prototype.Xb=function(){this.Nb(224)};Af.Object.defineProperties(Sc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 165}}});Object(Cd.a)(Sc,"RangeExternalLinksSetAutoRefreshEvent",ua,[]);Rk(gc,ua);gc.prototype.Xb=function(){this.Nb(11)};gc.prototype.jg=function(){this.hd(function(R){return 64===R.pZ().ValidMembers})};Af.Object.defineProperties(gc.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 5}}});Object(Cd.a)(gc,"RangeFillColoredEvent",ua,[]);Rk(Jb,ua);Jb.prototype.Xb=function(){this.Nb(155)};Af.Object.defineProperties(Jb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 59}}});Object(Cd.a)(Jb,"RangeFilledEvent",ua,[]);Rk(Ua,ua);Ua.prototype.Xb=function(){this.Nb(176)};Ua.prototype.jg=function(){this.hd(function(R){return R.XU().AutoFilterType===xf.Ioc&&!!R.XU().CriteriaType})};Af.Object.defineProperties(Ua.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 115}}});Object(Cd.a)(Ua,"RangeFilterAppliedEvent",ua,[]);Rk(Te,ua);Te.prototype.Xb=function(){this.Nb(176)};Te.prototype.jg=function(){this.hd(function(R){return R.XU().AutoFilterType===xf.Ioc&&!R.XU().CriteriaType})};Af.Object.defineProperties(Te.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 58}}});Object(Cd.a)(Te,"RangeFilterClearedEvent",ua,[]);Rk(Be,ua);Be.prototype.Xb=function(){this.Nb(518)};Af.Object.defineProperties(Be.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 41}}});Object(Cd.a)(Be,"RangeFilterReappliedEvent",ua,[]);Rk(be,ua);be.prototype.Xb=function(){this.Nb(150)};Af.Object.defineProperties(be.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 86}}});Object(Cd.a)(be,"RangeFlashFilledEvent",ua,[]);Rk(Zd,Cf);Object(Cd.a)(Zd,"RangeFontColoredEvent",Cf,[]);Rk(zd,Cf);Object(Cd.a)(zd,"RangeFontItalicizedEvent",Cf,[]);Rk(nd,Cf);Object(Cd.a)(nd,"RangeFontNamedEvent",Cf,[]);Rk(Jc,
Cf);Object(Cd.a)(Jc,"RangeFontSizedEvent",Cf,[]);Rk(Sb,ua);Sb.prototype.Xb=function(){this.Nb(215)};Af.Object.defineProperties(Sb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 74}}});Object(Cd.a)(Sb,"RangeFormattedAsTableEvent",ua,[]);Rk(Pa,ua);Pa.prototype.Xb=function(){this.Nb(188)};Af.Object.defineProperties(Pa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 97}}});Object(Cd.a)(Pa,"RangeGroupedOrUngroupedEvent",ua,[]);Rk(cf,ua);cf.prototype.Xb=
function(){this.Nb(11)};cf.prototype.jg=function(){this.hd(function(R){return 2===R.pZ().ValidMembers})};Af.Object.defineProperties(cf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 60}}});Object(Cd.a)(cf,"RangeHorizontallyAlignedEvent",ua,[]);Rk(af,ua);af.prototype.Xb=function(){this.Nb(526)};Af.Object.defineProperties(af.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 43}}});Object(Cd.a)(af,"RangeHyperlinkAppliedEvent",ua,[]);Rk(te,ua);te.prototype.Xb=
function(){this.Nb(11)};te.prototype.jg=function(){this.hd(function(R){return 256===R.pZ().ValidMembers})};Af.Object.defineProperties(te.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 63}}});Object(Cd.a)(te,"RangeIndentChangedEvent",ua,[]);Rk(Xd,ua);Xd.prototype.Xb=function(){this.Nb(156)};Xd.prototype.jg=function(){this.hd(function(R){return 2===R.Ut()||5===R.Ut()||6===R.Ut()||7===R.Ut()})};Af.Object.defineProperties(Xd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 53}}});
Object(Cd.a)(Xd,"RangeMergedEvent",ua,[]);Rk(ze,ua);ze.prototype.Xb=function(){this.Nb(216)};Af.Object.defineProperties(ze.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 107}}});Object(Cd.a)(ze,"RangeNamedCellStyleAppliedEvent",ua,[]);Rk(ae,ua);ae.prototype.Xb=function(){this.Nb(11)};ae.prototype.jg=function(){this.hd(function(R){return 32===R.pZ().ValidMembers})};Af.Object.defineProperties(ae.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 12}}});
Object(Cd.a)(ae,"RangeNumberFormattedEvent",ua,[]);var Uh=b(1166);Rk(de,ua);de.prototype.Xb=function(){this.Nb(141)};de.prototype.jg=function(){this.hd(function(R){return Object(ig.a)(Uh.a,R)})};Af.Object.defineProperties(de.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 108}}});Object(Cd.a)(de,"RangeSortedEvent",ua,[]);Rk(od,Cf);Object(Cd.a)(od,"RangeStrikedThroughEvent",Cf,[]);Rk($c,Cf);Object(Cd.a)($c,"RangeUnderlinedEvent",Cf,[]);Rk(nc,ua);nc.prototype.Xb=function(){this.Nb(11)};
nc.prototype.jg=function(){this.hd(function(R){return 1===R.pZ().ValidMembers})};Af.Object.defineProperties(nc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 61}}});Object(Cd.a)(nc,"RangeVerticallyAlignedEvent",ua,[]);Rk(Eb,ua);Eb.prototype.Xb=function(){this.Nb(11)};Eb.prototype.jg=function(){this.hd(function(R){return 8===R.pZ().ValidMembers})};Af.Object.defineProperties(Eb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 62}}});Object(Cd.a)(Eb,"RangeWrapTextToggledEvent",
ua,[]);Rk(jb,ua);jb.prototype.Xb=function(){this.Nb(51)};Af.Object.defineProperties(jb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 103}}});Object(Cd.a)(jb,"RefreshedAllEvent",ua,[]);Rk(Oc,ua);Oc.prototype.Xb=function(){this.Nb(148)};Af.Object.defineProperties(Oc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 47}}});Object(Cd.a)(Oc,"ReplaceAllEvent",ua,[]);Rk(qc,ua);qc.prototype.Xb=function(){this.Nb(532)};qc.prototype.jg=function(){this.hd(function(R){return 95!==
R.getShapeType()&&96!==R.getShapeType()&&97!==R.getShapeType()&&98!==R.getShapeType()&&100!==R.getShapeType()&&102!==R.getShapeType()&&103!==R.getShapeType()})};Af.Object.defineProperties(qc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 91}}});Object(Cd.a)(qc,"ShapeInsertedEvent",ua,[]);Rk(Rb,ua);Rb.prototype.Xb=function(){this.Nb(531)};Af.Object.defineProperties(Rb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 92}}});Object(Cd.a)(Rb,"ShapeStyleSetEvent",
ua,[]);var Ah=b(1023);Rk(Uc,ua);Uc.prototype.Xb=function(){this.Nb(581)};Uc.prototype.jg=function(){var R=this;this.hd(function(Ha){return Object(ig.a)(Ah.a,Ha)&&4===Ha.getShapeTextFormat().ValidMembers});this.hd(function(Ha){return Object(ig.a)(Ah.a,Ha)&&Ha.getShapeTextFormat().Font.ValidMembers===R.TYd})};Af.Object.defineProperties(Uc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.hfa}}});Object(Cd.a)(Uc,"ShapeTextFontFormattedEventBase",ua,[]);Rk(cc,Uc);Object(Cd.a)(cc,
"ShapeTextBoldedEvent",Uc,[]);var Bh=b(1168);Rk(Mb,ua);Mb.prototype.Xb=function(){this.Nb(581)};Mb.prototype.jg=function(){this.hd(function(R){return Object(ig.a)(Bh.a,R)})};Af.Object.defineProperties(Mb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 191}}});Object(Cd.a)(Mb,"ShapeTextChangedEvent",ua,[]);Rk(zc,Uc);Object(Cd.a)(zc,"ShapeTextFontColorChangedEvent",Uc,[]);Rk(Bb,Uc);Object(Cd.a)(Bb,"ShapeTextFontNameChangedEvent",Uc,[]);Rk(Xe,Uc);Object(Cd.a)(Xe,"ShapeTextFontSizeChangedEvent",
Uc,[]);Rk(Ge,ua);Ge.prototype.Xb=function(){this.Nb(581)};Ge.prototype.jg=function(){this.hd(function(R){return Object(ig.a)(Ah.a,R)&&2===R.getShapeTextFormat().ValidMembers})};Af.Object.defineProperties(Ge.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 199}}});Object(Cd.a)(Ge,"ShapeTextHorizontallyAlignedEvent",ua,[]);Rk(xe,Uc);Object(Cd.a)(xe,"ShapeTextItalicizedEvent",Uc,[]);Rk(qd,Uc);Object(Cd.a)(qd,"ShapeTextUnderlinedEvent",Uc,[]);Rk(Dd,ua);Dd.prototype.Xb=function(){this.Nb(581)};
Dd.prototype.jg=function(){this.hd(function(R){return Object(ig.a)(Ah.a,R)&&1===R.getShapeTextFormat().ValidMembers})};Af.Object.defineProperties(Dd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 200}}});Object(Cd.a)(Dd,"ShapeTextVerticallyAlignedEvent",ua,[]);Rk(yd,ua);yd.prototype.Xb=function(){this.Nb(138)};Af.Object.defineProperties(yd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 13}}});Object(Cd.a)(yd,"SheetAddedEvent",ua,[]);var nh=b(8);Rk(vc,
ua);vc.prototype.Xb=function(){this.Nb(237)};vc.prototype.jg=function(){this.hd(function(R){return!!R.insertDeleteMultiRangeParameters});this.hd(function(R){return!R.insertDeleteMultiRangeParameters.IsTableCommand});this.hd(function(R){R=R.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0>R.DeltaColumn&&!R.DeltaRow&&(!!R.InsertDeleteRange.FirstRow||R.InsertDeleteRange.LastRow!==nh.a.$x)||!R.DeltaColumn&&0>R.DeltaRow&&(!!R.InsertDeleteRange.FirstColumn||R.InsertDeleteRange.LastColumn!==
nh.a.Xu)})};Af.Object.defineProperties(vc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 142}}});Object(Cd.a)(vc,"SheetCellsDeletedEvent",ua,[]);Rk(yc,ua);yc.prototype.Xb=function(){this.Nb(237)};yc.prototype.jg=function(){this.hd(function(R){return!!R.insertDeleteMultiRangeParameters});this.hd(function(R){return!R.insertDeleteMultiRangeParameters.IsTableCommand});this.hd(function(R){R=R.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0<R.DeltaColumn&&!R.DeltaRow&&
(!!R.InsertDeleteRange.FirstRow||R.InsertDeleteRange.LastRow!==nh.a.$x)||!R.DeltaColumn&&0<R.DeltaRow&&(!!R.InsertDeleteRange.FirstColumn||R.InsertDeleteRange.LastColumn!==nh.a.Xu)})};Af.Object.defineProperties(yc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 143}}});Object(Cd.a)(yc,"SheetCellsInsertedEvent",ua,[]);Rk(Tb,ua);Tb.prototype.Xb=function(){this.Nb(237)};Tb.prototype.jg=function(){this.hd(function(R){return!!R.insertDeleteMultiRangeParameters});this.hd(function(R){return!R.insertDeleteMultiRangeParameters.IsTableCommand});
this.hd(function(R){return 0>R.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.hd(function(R){return!R.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.hd(function(R){return!R.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow});this.hd(function(R){return R.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===nh.a.$x})};Af.Object.defineProperties(Tb.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 139}}});Object(Cd.a)(Tb,"SheetColumnDeletedEvent",ua,[]);Rk(hb,ua);hb.prototype.Xb=function(){this.Nb(237)};hb.prototype.jg=function(){this.hd(function(R){return!!R.insertDeleteMultiRangeParameters});this.hd(function(R){return!R.insertDeleteMultiRangeParameters.IsTableCommand});this.hd(function(R){return 0<R.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.hd(function(R){return!R.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});
this.hd(function(R){return!R.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow});this.hd(function(R){return R.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===nh.a.$x})};Af.Object.defineProperties(hb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 138}}});Object(Cd.a)(hb,"SheetColumnInsertedEvent",ua,[]);Rk(h,ua);h.prototype.Xb=function(){this.Nb(137)};Af.Object.defineProperties(h.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 14}}});Object(Cd.a)(h,"SheetDeletedEvent",ua,[]);Rk(Xa,ua);Xa.prototype.Xb=function(){this.Nb(185)};Af.Object.defineProperties(Xa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 137}}});Object(Cd.a)(Xa,"SheetDirectionChangedEvent",ua,[]);Rk(ve,ua);ve.prototype.Xb=function(){this.Nb(139)};Af.Object.defineProperties(ve.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 54}}});Object(Cd.a)(ve,"SheetDuplicatedEvent",ua,[]);
Rk(Se,ua);Se.prototype.Xb=function(){this.Nb(207)};Af.Object.defineProperties(Se.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 15}}});Object(Cd.a)(Se,"SheetNameEditedEvent",ua,[]);Rk(he,ua);he.prototype.Xb=function(){this.Nb(151)};Af.Object.defineProperties(he.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 90}}});Object(Cd.a)(he,"SheetPaneFrozenEvent",ua,[]);Rk(lf,ua);lf.prototype.Xb=function(){this.Nb(226)};Af.Object.defineProperties(lf.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 120}}});Object(Cd.a)(lf,"SheetPrintSettingsSavedEvent",ua,[]);var Ci=b(1067);Rk(Ze,ua);Ze.prototype.Xb=function(){this.Nb(507)};Ze.prototype.Wva=function(){this.Hke("Microsoft.Office.Excel.SheetProtectionMacroRecording")};Ze.prototype.jg=function(){this.hd(function(R){return Object.getType(R)===Ci.a})};Af.Object.defineProperties(Ze.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 215}}});Object(Cd.a)(Ze,"SheetProtectionPausedResumedEvent",
ua,[]);Rk(Me,ua);Me.prototype.Xb=function(){this.Nb(557)};Af.Object.defineProperties(Me.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 64}}});Object(Cd.a)(Me,"SheetReorderedEvent",ua,[]);Rk(ge,ua);ge.prototype.Xb=function(){this.Nb(237)};ge.prototype.jg=function(){this.hd(function(R){return!!R.insertDeleteMultiRangeParameters});this.hd(function(R){return!R.insertDeleteMultiRangeParameters.IsTableCommand});this.hd(function(R){return!R.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});
this.hd(function(R){return 0>R.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.hd(function(R){return!R.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn});this.hd(function(R){return R.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===nh.a.Xu})};Af.Object.defineProperties(ge.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 141}}});Object(Cd.a)(ge,"SheetRowDeletedEvent",ua,
[]);Rk(Nd,ua);Nd.prototype.Xb=function(){this.Nb(237)};Nd.prototype.jg=function(){this.hd(function(R){return!!R.insertDeleteMultiRangeParameters});this.hd(function(R){return!R.insertDeleteMultiRangeParameters.IsTableCommand});this.hd(function(R){return!R.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.hd(function(R){return 0<R.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.hd(function(R){return!R.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn});
this.hd(function(R){return R.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===nh.a.Xu})};Af.Object.defineProperties(Nd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 140}}});Object(Cd.a)(Nd,"SheetRowInsertedEvent",ua,[]);Rk(kd,ua);kd.prototype.Xb=function(){this.Nb(135)};Af.Object.defineProperties(kd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 39}}});Object(Cd.a)(kd,"SheetRowsColumnsAutoFitEvent",ua,[]);
Rk(ke,ua);ke.prototype.Xb=function(){this.Nb(136)};Af.Object.defineProperties(ke.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 36}}});Object(Cd.a)(ke,"SheetRowsColumnsResizedEvent",ua,[]);Rk(Kd,ua);Kd.prototype.Xb=function(){this.Nb(183)};Af.Object.defineProperties(Kd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 68}}});Object(Cd.a)(Kd,"SheetShowGridlinesToggledEvent",ua,[]);Rk(dd,ua);dd.prototype.Xb=function(){this.Nb(184)};Af.Object.defineProperties(dd.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 67}}});Object(Cd.a)(dd,"SheetShowHeadingsToggledEvent",ua,[]);Rk(md,ua);md.prototype.Xb=function(){this.Nb(213)};Af.Object.defineProperties(md.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 89}}});Object(Cd.a)(md,"SheetSpellCheckedEvent",ua,[]);Rk(Qc,ua);Qc.prototype.Xb=function(){this.Nb(515)};Af.Object.defineProperties(Qc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 70}}});Object(Cd.a)(Qc,
"SheetTabColoredEvent",ua,[]);Rk(oc,ua);oc.prototype.Xb=function(){this.Nb(157)};Af.Object.defineProperties(oc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 71}}});Object(Cd.a)(oc,"SheetVisibilityChangedEvent",ua,[]);Rk(Ke,ua);Ke.prototype.Xb=function(){this.Nb(239)};Af.Object.defineProperties(Ke.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 126}}});Object(Cd.a)(Ke,"SheetsVisibilityChangedEvent",ua,[]);Rk(le,ua);le.prototype.Xb=function(){this.Nb(203)};
Af.Object.defineProperties(le.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 188}}});Object(Cd.a)(le,"SlicerInsertedEvent",ua,[]);Rk(ne,ua);ne.prototype.Xb=function(){this.Nb(173)};ne.prototype.jg=function(){this.hd(function(R){return!R.clearFilter})};Af.Object.defineProperties(ne.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 189}}});Object(Cd.a)(ne,"SlicerSelectionAppliedEvent",ua,[]);Rk(Md,ua);Md.prototype.Xb=function(){this.Nb(173)};Md.prototype.jg=
function(){this.hd(function(R){return R.clearFilter})};Af.Object.defineProperties(Md.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 190}}});Object(Cd.a)(Md,"SlicerSelectionClearedEvent",ua,[]);Rk(Ic,ua);Ic.prototype.Xb=function(){this.Nb(208)};Ic.prototype.jg=function(){this.hd(function(R){return R.getParameters().FilterType===xf.Z9a})};Af.Object.defineProperties(Ic.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 27}}});Object(Cd.a)(Ic,"TableCheckedItemsFilteredEvent",
ua,[]);Rk(bd,ua);bd.prototype.Xb=function(){this.Nb(237)};bd.prototype.jg=function(){this.hd(function(R){return!!R.insertDeleteMultiRangeParameters});this.hd(function(R){return R.insertDeleteMultiRangeParameters.IsTableCommand});this.hd(function(R){return 0>R.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.hd(function(R){return!R.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};Af.Object.defineProperties(bd.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 144}}});Object(Cd.a)(bd,"TableColumnDeletedEvent",ua,[]);Rk(Ec,ua);Ec.prototype.Xb=function(){this.Nb(237)};Ec.prototype.jg=function(){this.hd(function(R){return!!R.insertDeleteMultiRangeParameters});this.hd(function(R){return R.insertDeleteMultiRangeParameters.IsTableCommand});this.hd(function(R){return 0<R.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.hd(function(R){return!R.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};
Af.Object.defineProperties(Ec.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 145}}});Object(Cd.a)(Ec,"TableColumnInsertedEvent",ua,[]);var $h=b(1167);Rk(Yb,ua);Yb.prototype.Xb=function(){this.Nb(141)};Yb.prototype.jg=function(){this.hd(function(R){return Object(ig.a)($h.a,R)})};Af.Object.defineProperties(Yb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 121}}});Object(Cd.a)(Yb,"TableColumnSortedEvent",ua,[]);Rk(xc,ua);xc.prototype.Xb=function(){this.Nb(193)};
Af.Object.defineProperties(xc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 105}}});Object(Cd.a)(xc,"TableConvertedToRangeEvent",ua,[]);Rk(fc,ua);fc.prototype.Xb=function(){this.Nb(206)};Af.Object.defineProperties(fc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 16}}});Object(Cd.a)(fc,"TableCreatedEvent",ua,[]);Rk(Wb,ua);Wb.prototype.Xb=function(){this.Nb(209)};Wb.prototype.jg=function(){this.hd(function(R){return R.getParameters().FilterType===
xf.Z9a})};Af.Object.defineProperties(Wb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 30}}});Object(Cd.a)(Wb,"TableCustomFilteredEvent",ua,[]);Rk(tb,ua);tb.prototype.Xb=function(){this.Nb(187)};tb.prototype.jg=function(){this.hd(function(R){return 1===R.options.OperationType})};Af.Object.defineProperties(tb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 25}}});Object(Cd.a)(tb,"TableCustomSortedEvent",ua,[]);Rk(za,ua);za.prototype.Xb=function(){this.Nb(176)};
za.prototype.jg=function(){this.hd(function(R){return R.XU().AutoFilterType===xf.Z9a});this.hd(function(R){return 0===R.XU().CriteriaType})};Af.Object.defineProperties(za.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 28}}});Object(Cd.a)(za,"TableFilterClearedEvent",ua,[]);Rk(rd,ua);rd.prototype.Xb=function(){this.Nb(176)};rd.prototype.jg=function(){this.hd(function(R){return R.XU().AutoFilterType===xf.Z9a});this.hd(function(R){var Ha=new $e.a;Ha.add(1);Ha.add(2);Ha.add(8);
Ha.add(9);Ha.add(10);Ha.add(11);Ha.add(12);Ha.add(13);Ha.add(14);Ha.add(15);Ha.add(16);Ha.add(17);Ha.add(18);Ha.add(19);Ha.add(20);Ha.add(21);Ha.add(22);Ha.add(23);Ha.add(24);Ha.add(25);Ha.add(26);Ha.add(27);Ha.add(28);Ha.add(29);Ha.add(30);Ha.add(31);Ha.add(32);Ha.add(33);Ha.add(34);Ha.add(35);Ha.add(36);Ha.add(37);Ha.add(38);Ha.add(39);return Ha.contains(R.XU().CriteriaType)})};Af.Object.defineProperties(rd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 32}}});Object(Cd.a)(rd,
"TableItemFilteredEvent",ua,[]);Rk(td,ua);td.prototype.Xb=function(){this.Nb(217)};Af.Object.defineProperties(td.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 101}}});Object(Cd.a)(td,"TableRenamedEvent",ua,[]);Rk(Vc,ua);Vc.prototype.Xb=function(){this.Nb(211)};Af.Object.defineProperties(Vc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 73}}});Object(Cd.a)(Vc,"TableResizedEvent",ua,[]);Rk(id,ua);id.prototype.Xb=function(){this.Nb(514)};Af.Object.defineProperties(id.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 44}}});Object(Cd.a)(id,"TableRowColumnRearrangedEvent",ua,[]);Rk(Wc,ua);Wc.prototype.Xb=function(){this.Nb(237)};Wc.prototype.jg=function(){this.hd(function(R){return!!R.insertDeleteMultiRangeParameters});this.hd(function(R){return R.insertDeleteMultiRangeParameters.IsTableCommand});this.hd(function(R){return!R.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.hd(function(R){return 0>R.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};
Af.Object.defineProperties(Wc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 146}}});Object(Cd.a)(Wc,"TableRowDeletedEvent",ua,[]);Rk(kc,ua);kc.prototype.Xb=function(){this.Nb(237)};kc.prototype.jg=function(){this.hd(function(R){return!!R.insertDeleteMultiRangeParameters});this.hd(function(R){return R.insertDeleteMultiRangeParameters.IsTableCommand});this.hd(function(R){return!R.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.hd(function(R){return 0<
R.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};Af.Object.defineProperties(kc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 147}}});Object(Cd.a)(kc,"TableRowInsertedEvent",ua,[]);Rk(Xb,ua);Xb.prototype.Xb=function(){this.Nb(177)};Xb.prototype.jg=function(){this.hd(function(R){return R.XU().AutoFilterType===xf.Z9a})};Af.Object.defineProperties(Xb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 26}}});Object(Cd.a)(Xb,"TableSortedEvent",
ua,[]);Rk(cb,ua);cb.prototype.Xb=function(){this.Nb(212)};Af.Object.defineProperties(cb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 87}}});Object(Cd.a)(cb,"TableStyleAppliedEvent",ua,[]);Rk(Qb,ua);Qb.prototype.Xb=function(){this.Nb(196)};Af.Object.defineProperties(Qb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 88}}});Object(Cd.a)(Qb,"TableStyleOptionToggledEvent",ua,[]);Rk(Fa,ua);Fa.prototype.Xb=function(){this.Nb(210)};Fa.prototype.jg=function(){this.hd(function(R){return R.getParameters().FilterType===
xf.Z9a})};Af.Object.defineProperties(Fa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 31}}});Object(Cd.a)(Fa,"TableTop10FilteredEvent",ua,[]);Rk(jc,ua);jc.prototype.Xb=function(){this.Nb(238)};Af.Object.defineProperties(jc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 207}}});Object(Cd.a)(jc,"TextToColumnsEvent",ua,[]);Rk(Qe,ua);Qe.prototype.Xb=function(){this.Nb(559)};Af.Object.defineProperties(Qe.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 128}}});Object(Cd.a)(Qe,"ValuesSortedEvent",ua,[]);Rk(Re,ua);Re.prototype.Xb=function(){this.Nb(197)};Af.Object.defineProperties(Re.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 55}}});Object(Cd.a)(Re,"WorkbookCalculationModeSetEvent",ua,[]);Rk(Pd,ua);Pd.prototype.Xb=function(){this.Nb(181)};Pd.prototype.jg=function(){this.hd(function(R){return!!R.parentCommentId})};Af.Object.defineProperties(Pd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 34}}});
Object(Cd.a)(Pd,"WorkbookCommentRepliedEvent",ua,[]);Rk(Le,ua);Le.prototype.Xb=function(){this.Nb(181)};Le.prototype.jg=function(){this.hd(function(R){return!R.parentCommentId})};Af.Object.defineProperties(Le.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 33}}});Object(Cd.a)(Le,"WorkbookCommentedEvent",ua,[]);Rk(Wd,ua);Wd.prototype.Xb=function(){this.Nb(128)};Af.Object.defineProperties(Wd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 56}}});Object(Cd.a)(Wd,
"WorkbookRecalculatedEvent",ua,[]);Rk(Sd,ua);Sd.prototype.Xb=function(){this.Nb(171)};Af.Object.defineProperties(Sd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 46}}});Object(Cd.a)(Sd,"WorkbookRedoEvent",ua,[]);Rk(jd,ua);jd.prototype.Xb=function(){this.Nb(170)};Af.Object.defineProperties(jd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 45}}});Object(Cd.a)(jd,"WorkbookUndoEvent",ua,[]);Rk(Gd,ua);Gd.prototype.Xb=function(){this.Nb(507);this.Nb(576);
this.Nb(10)};Gd.prototype.jg=function(){this.hd(function(R){if(Object(ig.a)(yg,R)&&(R=Object(bg.a)(yg,R),void 0!==R.source&&null!==R.source&&void 0!==R.eventId&&null!==R.eventId))return Od.ULS.sendTraceTag(537155426,0,50,"[RichApiRecorder]: received a valid but unhandled event: source: {0}; eventId: {1}.",R.source,R.eventId),!0;Od.ULS.sendTraceTag(537155425,0,50,"[RichApiRecorder]: an invalid event was ignored.");return!1})};Af.Object.defineProperties(Gd.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 116}}});Object(Cd.a)(Gd,"DefaultRichApiRequestExecutedEvent",ua,[]);Rk(ud,ua);ud.prototype.Xb=function(){this.Nb(1022)};Af.Object.defineProperties(ud.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 216}}});Object(Cd.a)(ud,"TablelAltTextEditedEvent",ua,[]);Rk(Hc,ua);Hc.prototype.Xb=function(){this.Nb(263)};Af.Object.defineProperties(Hc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 217}}});Object(Cd.a)(Hc,"FloatingObjectZOrderChangedEvent",
ua,[]);fe.prototype.SZe=function(R,Ha){var Gb=this.TZe(R,this.macroRecorderEvents,Ha);Gb||(Gb=this.TZe(R,fe.a0h(),Ha),!Gb&&this.Udf(R,fe.YFe,Ha)&&(Gb=fe.YFe));return Gb};fe.prototype.TZe=function(R,Ha,Gb){var bc=new $e.a;Ha=ak(Ha);for(var Rc=Ha.next();!Rc.done;Rc=Ha.next())Rc=Rc.value,this.Udf(R,Rc,Gb)&&bc.add(Rc);return 1===bc.count?bc.na(0):1<bc.count?fe.HIh(bc):null};fe.prototype.Udf=function(R,Ha,Gb){var bc=fe.iVi(R,Ha);return Gb?bc&&fe.DVj(R,Ha):bc};fe.prototype.$9i=function(){for(var R=new $e.a,
Ha=ak(this.wb),Gb=Ha.next();!Gb.done;Gb=Ha.next()){Gb=Gb.value;for(var bc=!1,Rc=ak(Gb.featureGates),gd=Rc.next();!gd.done;gd=Rc.next())if(!Ve.EwaSettings.ma(gd.value)){R.add(Gb);bc=!0;break}if(!bc)for(bc=ak(Gb.wRe),Rc=bc.next();!Rc.done;Rc=bc.next())if(!Ve.EwaSettings.getBooleanFeatureGate(Rc.value,!1)){R.add(Gb);break}}R=ak(R);for(Ha=R.next();!Ha.done;Ha=R.next())this.wb.remove(Ha.value)};fe.a0h=function(){fe.eCb||(fe.eCb=new $e.a,fe.eCb.add(new Pg),fe.eCb.add(new Ag));return fe.eCb};fe.iVi=function(R,
Ha){return Ha.operations.contains(R.operation)};fe.DVj=function(R,Ha){var Gb=Ha.rCc;if(!Gb.count)return!0;Ha=!0;Gb=ak(Gb);for(var bc=Gb.next();!bc.done;bc=Gb.next())if(bc=bc.value,!bc(R.payload)){Ha=!1;break}return Ha};fe.HIh=function(R){var Ha=R.na(0);R=ak(R);for(var Gb=R.next();!Gb.done;Gb=R.next())Gb=Gb.value,Gb.rCc.count>Ha.rCc.count&&(Ha=Gb);return Ha};Af.Object.defineProperties(fe.prototype,{macroRecorderEvents:{configurable:!0,enumerable:!0,get:function(){this.wb||(this.wb=new $e.a,this.wb.add(new we),
this.wb.add(new ag),this.wb.add(new hf),this.wb.add(new sc),this.wb.add(new gc),this.wb.add(new Zd),this.wb.add(new zd),this.wb.add(new nd),this.wb.add(new Jc),this.wb.add(new od),this.wb.add(new $c),this.wb.add(new ae),this.wb.add(new yd),this.wb.add(new h),this.wb.add(new Se),this.wb.add(new fc),this.wb.add(new bd),this.wb.add(new Ec),this.wb.add(new Wc),this.wb.add(new kc),this.wb.add(new hb),this.wb.add(new Tb),this.wb.add(new Nd),this.wb.add(new ge),this.wb.add(new tb),this.wb.add(new Xb),this.wb.add(new Ic),
this.wb.add(new za),this.wb.add(new Ae),this.wb.add(new Wb),this.wb.add(new Fa),this.wb.add(new rd),this.wb.add(new Le),this.wb.add(new Pd),this.wb.add(new sd),this.wb.add(new ke),this.wb.add(new vc),this.wb.add(new yc),this.wb.add(new kd),this.wb.add(new Qf),this.wb.add(new Be),this.wb.add(new af),this.wb.add(new Ba),this.wb.add(new id),this.wb.add(new Sd),this.wb.add(new jd),this.wb.add(new Oc),this.wb.add(new vg),this.wb.add(new Ce),this.wb.add(new Xd),this.wb.add(new ve),this.wb.add(new Re),this.wb.add(new Wd),
this.wb.add(new Dg),this.wb.add(new Te),this.wb.add(new Jb),this.wb.add(new cf),this.wb.add(new nc),this.wb.add(new Eb),this.wb.add(new te),this.wb.add(new Me),this.wb.add(new ib),this.wb.add(new ng),this.wb.add(new dd),this.wb.add(new Kd),this.wb.add(new Rd),this.wb.add(new oc),this.wb.add(new Qc),this.wb.add(new Vc),this.wb.add(new Sb),this.wb.add(new lh),this.wb.add(new sh),this.wb.add(new cd),this.wb.add(new th),this.wb.add(new Mh),this.wb.add(new L),this.wb.add(new $g),this.wb.add(new t),this.wb.add(new qh),
this.wb.add(new ja),this.wb.add(new uh),this.wb.add(new be),this.wb.add(new cb),this.wb.add(new Qb),this.wb.add(new md),this.wb.add(new he),this.wb.add(new qc),this.wb.add(new Rb),this.wb.add(new Gh),this.wb.add(new Fh),this.wb.add(new Tg),this.wb.add(new gh),this.wb.add(new Pa),this.wb.add(new Wa),this.wb.add(new Lf),this.wb.add(new zg),this.wb.add(new td),this.wb.add(new hg),this.wb.add(new jb),this.wb.add(new xg),this.wb.add(new xc),this.wb.add(new Yc),this.wb.add(new ze),this.wb.add(new de),this.wb.add(new De),
this.wb.add(new Jd),this.wb.add(new Nb),this.wb.add(new Oe),this.wb.add(new wf),this.wb.add(new oe),this.wb.add(new Ua),this.wb.add(new Ra),this.wb.add(new Fe),this.wb.add(new ee),this.wb.add(new lf),this.wb.add(new Yb),this.wb.add(new of),this.wb.add(new Ke),this.wb.add(new ug),this.wb.add(new Qe),this.wb.add(new Gg),this.wb.add(new V),this.wb.add(new Vf),this.wb.add(new tg),this.wb.add(new Oa),this.wb.add(new sf),this.wb.add(new fh),this.wb.add(new Xa),this.wb.add(new mh),this.wb.add(new mg),this.wb.add(new re),
this.wb.add(new Ug),this.wb.add(new Jg),this.wb.add(new nf),this.wb.add(new ff),this.wb.add(new mf),this.wb.add(new wg),this.wb.add(new tc),this.wb.add(new rg),this.wb.add(new Of),this.wb.add(new xd),this.wb.add(new Yd),this.wb.add(new Sc),this.wb.add(new Og),this.wb.add(new Zf),this.wb.add(new Wf),this.wb.add(new Yf),this.wb.add(new Vb),this.wb.add(new Td),this.wb.add(new uc),this.wb.add(new Xc),this.wb.add(new ah),this.wb.add(new kg),this.wb.add(new Wg),this.wb.add(new Fg),this.wb.add(new Eg),this.wb.add(new Ng),
this.wb.add(new ih),this.wb.add(new Vg),this.wb.add(new Mg),this.wb.add(new Cc),this.wb.add(new Ed),this.wb.add(new yf),this.wb.add(new sg),this.wb.add(new pf),this.wb.add(new le),this.wb.add(new ne),this.wb.add(new Md),this.wb.add(new Mb),this.wb.add(new cc),this.wb.add(new xe),this.wb.add(new qd),this.wb.add(new zc),this.wb.add(new Bb),this.wb.add(new Xe),this.wb.add(new Ge),this.wb.add(new Dd),this.wb.add(new Hd),this.wb.add(new Ef),this.wb.add(new jc),this.wb.add(new Ze),this.wb.add(new ud),this.wb.add(new Hc),
Ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4825267_RemoveDisabledEvents")&&this.$9i());return this.wb}}});fe.eCb=null;fe.YFe=new Gd;Object(Cd.a)(fe,"MacroRecorderEventList",null,[]);var bh=We.a;Rk(Qd,bh);Qd.prototype.create=function(){this.pb(this.$.da.za(297)||new Ib(this.$,new fe(this.$),new Id))};Qd.ka=function(R){R.da.Ga(298,new Qd(R))};Object(Cd.a)(Qd,"MacroRecorderEventHandlerFactory",We.a,[]);var Qh=b(1352),Wi=b(1445),Qg=b(7);b(622);pe.prototype.QSh=function(R){Od.ULS.sendTraceTag(17306645,
220,50,"Context menu id: {0}",R);for(var Ha=new $e.a,Gb=ak(this.Y0b),bc=Gb.next();!bc.done;bc=Gb.next()){bc=ak(bc.value.uDb);for(var Rc=bc.next();!Rc.done;Rc=bc.next())Rc=Rc.value,Rc.id===R&&Ha.add(Rc)}return Ha};pe.prototype.uke=function(R){this.Y0b.add(R)};pe.prototype.V9i=function(R){for(var Ha=ak(this.Y0b),Gb=Ha.next();!Gb.done;Gb=Ha.next())if(Gb=Gb.value,Gb.toe===R.toe){this.Y0b.remove(Gb);break}};pe.hfh=function(R,Ha,Gb){Gb=void 0===Gb?null:Gb;R=pe.gLh(R);0<R.length&&(pe.Lvc(R,!1),Gb&&Gb(Ha,
R))};pe.gLh=function(R){var Ha=[];if(R&&R.uDb&&0<R.uDb.count){R=ak(R.uDb);for(var Gb=R.next();!Gb.done;Gb=R.next())if(Gb=Gb.value,Gb.controls&&0<Gb.controls.count){Gb=ak(Gb.controls);for(var bc=Gb.next();!bc.done;bc=Gb.next())if(bc=bc.value,bc.menuItems&&0<bc.menuItems.count){bc=ak(bc.menuItems);for(var Rc=bc.next();!Rc.done;Rc=bc.next())Array.add(Ha,Rc.value.id)}}}return Ha};pe.Lvc=function(R,Ha){if(R.length){var Gb=[];R=ak(R);for(var bc=R.next();!bc.done;bc=R.next())Gb.push(appChrome.actions.updateControlEnabledDisabledState(bc.value,
Ha));appChrome.api.dispatch(Gb)}};Af.Object.defineProperties(pe.prototype,{Y0b:{configurable:!0,enumerable:!0,get:function(){return this.zlg}}});Object(Cd.a)(pe,"ContextMenuExtensibilityCache",null,[336,337]);var uj=b(1664),Hg=b(83),gf=b(4),Xi=b(1074),ai=b(1020);Ye.prototype.hYa=function(R,Ha){Ha=void 0===Ha?null:Ha;if(R=ai.a.kub(R)){appChrome.addInApi.dispatchActionsToInstallAddIn(R,Ha);Ha=ak(R.tabs);for(var Gb=Ha.next();!Gb.done;Gb=Ha.next())if(Gb.value.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(R,
function(){});break}}};Ye.prototype.eId=function(R){(R=ai.a.kub(R))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(R)};Ye.pfh=function(R,Ha,Gb){Gb=void 0===Gb?null:Gb;R=Ye.QVh(R);0<R.length&&(Ye.Lvc(R,!1),Gb&&Gb(Ha,R))};Ye.QVh=function(R){var Ha=[];if(R&&(R=R.XV,R.Ds&&0<R.Ds.count)){R=ak(R.Ds);for(var Gb=R.next();!Gb.done;Gb=R.next())if(Gb=Gb.value,Gb.groups&&0<Gb.groups.length){Gb=ak(Gb.groups);for(var bc=Gb.next();!bc.done;bc=Gb.next())if(bc=bc.value,bc.controls&&0<bc.controls.length){bc=ak(bc.controls);
for(var Rc=bc.next();!Rc.done;Rc=bc.next())Array.add(Ha,Rc.value.id)}}}return Ha};Ye.Lvc=function(R){if(R.length){var Ha=[];R=ak(R);for(var Gb=R.next();!Gb.done;Gb=R.next())Ha.push(appChrome.actions.updateControlEnabledDisabledState(Gb.value,!0));appChrome.api.dispatch(Ha)}};Object(Cd.a)(Ye,"OneLineRibbonExtensibilityManager",null,[338]);var Vh=b(1145);ef.prototype.getTaskPaneControlIdFromAssetIdRuntimeId=function(R,Ha){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromAssetIdRuntimeId(R,
Ha)};ef.prototype.dhd=function(R,Ha,Gb,bc,Rc,gd,wd){gd=void 0===gd?null:gd;wd=void 0===wd?null:wd;Od.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",R);if((R=Ha.Kia(Rc.ownerAddinInfo.storeType,Rc.ownerAddinInfo.solutionId))&&R.uB&&!R.uB.getIsUpgrading())if(Ha=null,0<R.uB.getNotificationParams().length&&(Ha=this.Vte(R.uB.getNotificationParams()[0]))&&2147758681===Ha.errorCode&&(R.isUpgraded=!0),2!==R.uB.getStatus()&&(1!==R.uB.getStatus()||Ha&&2147758681===Ha.errorCode))Ha&&this.g2f(R,Ha,wd);else try{Gb.setOwnerAddinEToken(R.uB.getEToken()),
Rc.action(Gb,bc.ema),gd&&gd()}catch(Ad){Od.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",gf.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?Ad.stack:Ad.message)),Vh.a.SQd(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}};ef.prototype.g2f=function(R,Ha,Gb){var bc=this;Gb=void 0===Gb?null:Gb;var Rc=R.uB;if(1===Rc.getNotificationParams().length||Ha.Kdc){var gd=Ha.qha,wd=
Ha.hia;Ha.qha=function(){Rc.removeFirstNotification();if(0<Rc.getNotificationParams().length){var Ad=bc.Vte(Rc.getNotificationParams()[0]);bc.g2f(R,Ad)}2147758681===Ha.errorCode&&(Ye.pfh(R.xo,Rc,Object(Hg.a)(bc,bc.A9e,"initUpgradeStateDetectTask")),pe.hfh(R.Cqb,Rc,Object(Hg.a)(bc,bc.A9e,"initUpgradeStateDetectTask")));gd&&gd()};Ha.hia=function(){wd&&wd();Gb&&Gb()};Vh.a.UQd(Ha)}};ef.prototype.A9e=function(R,Ha){var Gb=null;Gb=function(){R.getIsUpgrading()?window.setTimeout(Gb,1E3):R.getUpgradingFailed()?
Ye.Lvc(Ha,!0):gf.AFrameworkApplication.ta.updateCommandUI()};window.setTimeout(Gb,1E3)};ef.prototype.Vte=function(R){var Ha=new Xi.a;Ha.mLa=R.infoType;Ha.id=R.id;Ha.title=R.title;Ha.description=R.description;Ha.buttonText=R.buttonTxt;Ha.qha=R.buttonCallback;Ha.Kdc=R.highPriority;Ha.hia=R.dismissCallback;Ha.errorCode=R.errorCode;Ha.z8e=R.iframeNotificationUrl;return Ha};Af.Object.defineProperties(ef.prototype,{gje:{configurable:!0,enumerable:!0,get:function(){return this.SDc||(this.SDc=OfficeExt.DefaultControlActionBinder.retrieveActionContext)},
set:function(R){this.SDc=R}},XMg:{configurable:!0,enumerable:!0,get:function(){return this.m1d||(this.m1d=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}}});Object(Cd.a)(ef,"AddinCommandsActionHandler",null,[313]);var Rg=b(84),vj=b(162),Hh=b(905),rh=b(5),Nh=b(947),ch=b(906);Ie.prototype.IFh=function(R){if(void 0!==R&&null!==R&&R===rh.a.$Ae)R="ContextMenuCell";else return null;var Ha=this.Va.Bc();this.aFh(Ha,R);return Ha};Ie.prototype.aFh=function(R,Ha){Ha=this.W1g.QSh(Ha);
Ha=ak(Ha);for(var Gb=Ha.next();!Gb.done;Gb=Ha.next()){Gb=ak(Gb.value.controls);for(var bc=Gb.next();!bc.done;bc=Gb.next())this.OEh(R,bc.value)}};Ie.prototype.OEh=function(R,Ha){var Gb=Ha.jU[Nh.a.id],bc=Ha.jU[Nh.a.gUa],Rc=Ha.jU[Nh.a.jUa],gd="Image16by16",wd=Ha.jU[Nh.a.hUa];ch.c(Rc)&&(gd="None");0<Ha.menuItems.count?(Gb=this.Va.Tv(Gb,Gb,bc,798637440),Gb.jKb(gd,Rc,null),this.GFh(Gb.menu,Ha),R.buttons.push(Gb)):R.buttons.push(this.Va.rHa(Gb,bc,wd,Rc,gd,null,!1))};Ie.prototype.GFh=function(R,Ha){var Gb,
bc=this.Va.Bc();Ha=ak(Ha.menuItems);for(Gb=Ha.next();!Gb.done;Gb=Ha.next()){var Rc=Gb.value;Gb=Rc.jla[Nh.a.id];var gd=Rc.jla[Nh.a.gUa],wd=Rc.jla[Nh.a.jUa],Ad="Image16by16";Rc=Rc.jla[Nh.a.hUa];ch.c(wd)&&(Ad="None");Gb=this.Va.rHa(Gb,gd,Rc,wd,Ad,null,!1);bc.buttons.push(Gb)}R.pc.push(bc)};Object(Cd.a)(Ie,"AddInCommandsContextMenuExtensibilityHandler",null,[913]);var Wh=b(1069);Object(Cd.a)(He,"AddinStatusCommandValues",null,[]);qe.r2i=function(R){var Ha=new He;Ha.ni=R.DYa;Ha.visible=Ha.ni?!0:!1;return Ha};
qe.yxc=function(R,Ha,Gb,bc,Rc){var gd=document.getElementById(Gb);gd?qe.eAj(R,Ha,gd,bc,Rc):Od.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",Gb))};qe.eAj=function(R,Ha,Gb,bc,Rc){Gb?R.DYa===CommonUIStrings.l_ErrorLoadingAddInsTitle?Vh.a.Syj(Ha,Gb,bc,Rc):R.DYa===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&Vh.a.jAj(Ha,Gb):Od.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))};Object(Cd.a)(qe,"AddinCommandsStatusHandler",
null,[]);var bi=b(38),wj=b(235),og=b(14),oi=bi.a;Rk(Ee,oi);Ee.prototype.jq=function(R){this.addHandler("LAC",R)};Ee.prototype.Hq=function(R){this.removeHandler("LAC",R)};Ee.prototype.Lr=function(R,Ha){var Gb=this;if("QueryAddinLabel"!==R)return!1;Ha[Wh.a.LabelText]!==this.KF.DYa&&(R=qe.r2i(this.KF),Ha[Wh.a.LabelText]=R.ni,Ha[Wh.a.Visible]=R.visible,window.setTimeout(function(){Gb.yxc()},0));return!0};Ee.prototype.dn=function(){return!0};Ee.prototype.yxc=function(){this.$&&qe.yxc(this.KF,this.$.domElement,
this.dFj,og.a.instance.ga(338),og.a.instance.ga(339))};Ee.prototype.dispose=function(){this.$.ea.xk(this.Uc);this.KF.caj(this.e4e);this.agaveCommandManager&&(this.agaveCommandManager.obj(this.bye),this.agaveCommandManager=null);this.statusBarManager&&(this.statusBarManager.BF(this),this.statusBarManager=null);this.KF=this.$=null;oi.prototype.dispose.call(this)};Object(Cd.a)(Ee,"AddinCommandsStatusBarManager",bi.a,[465,157]);var Yi=b(1517),bf=b(935),cg=b(154),$f=b(124),Pj=b(635),Zi=b(142);ue.prototype.setErrorMessageForAddin=
function(R,Ha){this.CYa||(this.CYa={});this.CYa[R]=Ha};ue.prototype.zNh=function(R){return this.CYa&&R in this.CYa?this.CYa[R]:null};Object(Cd.a)(ue,"AddinCommandsErrorManager",null,[]);var dg=b(346),$i=b(97);Object(Cd.a)(se,"AddinCommandsListLoaderContext",null,[]);var pi=b(1026);Object(Cd.a)(Vd,"AppsForOfficeEntitlementQueryInfo",null,[]);var Ih=b(41),aj=b(81),Qj=b(893);fd.prototype.get_current=function(){if(!this.zr)throw Error.argumentOutOfRange();return this.zr.data};fd.prototype.moveNext=function(){if(!this.zr)return this.zr=
this.kA,!!this.kA;if(!this.zr.next)return!1;this.zr=this.zr.next;return!0};fd.prototype.klc=function(){if(!this.zr)return this.zr=this.kA,!!this.kA;if(!this.zr.previous)return!1;this.zr=this.zr.previous;return!0};fd.prototype.reset=function(){this.zr=this.kA};Object(Cd.a)(fd,"ListEnumerator",null,[0]);Object(Cd.a)(ed,"ListNode",null,[]);Gc.prototype.add=function(R){this.Yp?this.sA=this.sA.next=new ed(R,this.sA,null):this.Yp=this.sA=new ed(R,null,null);this._count=this.count+1};Gc.prototype.insert=
function(R,Ha){if(R>this.count||0>R)throw Error.argumentOutOfRange("pos");if(R===this.count)this.add(Ha);else{for(var Gb=this.Yp;0!==R--;)Gb=Gb.next;R=new ed(Ha,Gb.previous,Gb);R.previous?R.previous.next=R:this.Yp=R;R.next?R.next.previous=R:this.sA=R;this._count=this.count+1}};Gc.prototype.remove=function(R){for(var Ha=this.Yp;Ha&&Ha.data!==R;)Ha=Ha.next;if(!Ha)return!1;Ha.previous?Ha.previous.next=Ha.next:this.Yp=Ha.next;Ha.next?Ha.next.previous=Ha.previous:this.sA=Ha.previous;this._count=this.count-
1;return!0};Gc.prototype.clear=function(){var R=this.Yp;for(this.sA=this.Yp=null;R;){var Ha=R.next;R.previous=null;R.next=null;R=Ha}this._count=0};Gc.prototype.indexOf=function(R){for(var Ha=this.Yp,Gb=0;Ha&&Ha.data!==R;)Ha=Ha.next,Gb++;return Ha?Gb:-1};Gc.prototype.na=function(R){return this.at(R).data};Gc.prototype.getEnumerator=function(){return new fd(this.Yp)};Gc.prototype[Symbol.iterator]=function(){return Object(Qj.a)(this.getEnumerator())};Gc.prototype.Iac=function(R){R=this.at(R);return new fd(R)};
Gc.prototype.toArray=function(){for(var R=Array(this.count),Ha=0,Gb=ak(this),bc=Gb.next();!bc.done;bc=Gb.next())R[Ha]=bc.value,Ha++;return R};Gc.prototype.at=function(R){for(var Ha=this.Yp,Gb=0;Gb!==R;){if(!Ha)throw Error.argumentOutOfRange("pos");Ha=Ha.next;Gb++}return Ha};Af.Object.defineProperties(Gc.prototype,{count:{configurable:!0,enumerable:!0,get:function(){return this._count}}});Object(Cd.a)(Gc,"List",null,[1]);var Di=Sys.EventArgs;Rk(lc,Di);Object(Cd.a)(lc,"AddinCommandsEntitlementsRetrievedEventArgs",
Sys.EventArgs,[]);Ac.prototype.C9c=function(R){var Ha=new Sys.StringBuilder(this.OIb);Ha.append("RoamingServiceHandler.ashx?action=");Ha.append("getAddinTeachingCalloutSettings");Ha.append("&");Ha.append(this.jfd(R));Ha.append("&");Ha.append(gf.AFrameworkApplication.aj);gf.AFrameworkApplication.qd.Yl(Ha.toString(),1,null,null,!0,2,Object(Hg.a)(this,this.hKa,"getRequestSuccessCallback"),Object(Hg.a)(this,this.yja,"getRequestFailureCallback"),null)};Ac.prototype.mtb=function(R){var Ha=new Sys.StringBuilder(this.OIb);
Ha.append("RoamingServiceHandler.ashx?action=");Ha.append("saveAddinTeachingCalloutSettings");Ha.append("&");Ha.append(gf.AFrameworkApplication.aj);Ha=Ha.toString();R=Ih.c(R);gf.AFrameworkApplication.qd.Yl(Ha,2,R,null,!0,4,null,Object(Hg.a)(this,this.x6,"postRequestFailureCallback"),null)};Ac.prototype.hKa=function(R){var Ha=!1,Gb=null;try{if(0<R.data.Ud.length){var bc=Object(bg.a)(Object,Ih.a(R.data.Ud)),Rc=bc?bc[this.appName]:null;Rc&&(Gb=Object(bg.a)(Object,Ih.a(Rc.toString())))}Ha=!0}catch(gd){this.yja(null)}Ha&&
this.uib&&this.uib(Gb)};Ac.prototype.yja=function(R){this.qib&&this.qib(R?R.data:null)};Ac.prototype.x6=function(R){this.zkb&&this.zkb(R?R.data:null)};Ac.prototype.jfd=function(R){for(var Ha=new Sys.StringBuilder("requestedsettings="),Gb=0;Gb<R.count;Gb++)Ha.append(R.na(Gb)),Gb<R.count-1&&Ha.append(";");return Ha.toString()};Object(Cd.a)(Ac,"AddinTeachingUIRoamingRequestHandler",null,[]);Object(Cd.a)(ic,"MiniAddinInfo",null,[]);var Ei=Sys.EventArgs;Rk(eb,Ei);Object(Cd.a)(eb,"ShowTeachingCalloutForContentAddinEventArgs",
Sys.EventArgs,[]);var pg=b(356);pc.prototype.zDg=function(R){this.Qa.addHandler(bf.a.IZb,R)};pc.prototype.TGg=function(R){this.Qa.addHandler(bf.a.m2f,R)};pc.prototype.GNj=function(R){var Ha=this;null!==R&&(this.context.S_=R[bf.a.Mga],this.context.Zs=R[bf.a.yT],this.context.fAc=this.context.yqc=0,R=bf.a.JFa in R?R[bf.a.JFa]:0,-1!==this.context.S_&&0!==this.context.Zs&&(this.context.G9=new Gc,this.context.$ia=new Gc,this.context.u3b=new Gc,this.context.hVc=this.wHg.createAddinDataProvider(ld(this.context.S_),
this.contextActivationMgr),this.context.hVc?this.context.hVc.getEntitlementsAsync(this.contextActivationMgr.ema,!0,R,function(Gb){Ha.cOi(Gb)}):Od.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.S_)))};pc.prototype.cOi=function(R){var Ha=this;if(R&&0<R.length){this.context.fAc=R.length;for(var Gb=0;Gb<R.length;Gb++){var bc=R[Gb];if(!bc||1!==bc.targetType&&-1!==bc.targetType)this.qyd();else{var Rc={};Rc.marketplaceId=bc.solutionId;Rc.marketplaceVersion=bc.version;
Rc.storeType=bc.storeType;Rc.storeId=bc.storeId;Rc.targetData=bc;this.contextActivationMgr.isAddinCommandsAsync(Rc,function(gd,wd,Ad){gd?(wd&&Ha.context.G9.add(Ad.targetData),10===Ha.context.S_&&(gd=Ad.targetData,wd=gd.targetType,gf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PropertiesForTeachingUIOfPrivateCatelogEnabled",!1)&&!ch.c(Ad.targetTypeForExp)&&(wd=Ad.targetTypeForExp,gd.targetType=wd),Ha.context.$ia.add(gd),0===wd&&Ha.context.u3b.add(gd))):(Ad=Ad.targetData,
Od.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Ad.solutionId,Ad.storeType,Ad.assetId,null,null,Ad.storeId),Ad.storeType));Ha.qyd()})}}}else this.qyd()};pc.prototype.qyd=function(){var R;(R=this.context).yqc=R.yqc+1;this.context.yqc>=this.context.fAc&&(this.HZb.uXf(this.context.S_,!1),0<this.context.fAc&&10===this.context.S_&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(R=!1,gf.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")&&
Fd()&&(R=this.nui()),this.Bti(),gf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&!R?this.wHh(this.context.G9):this.EYb(this.context.G9)):this.EYb(this.context.G9))};pc.prototype.EYb=function(R){var Ha=new $e.a;if(R){R=ak(this.context.G9);for(var Gb=R.next();!Gb.done;Gb=R.next())Ha.add(Bd(Gb.value))}this.context.G9&&1>this.context.G9.count&&pi.a.xNb(bf.a.JZb,"false",this.context.S_);R={};Ha=(R.ack2=Ha,R);Ha[bf.a.Mga]=this.context.S_;
Ha[bf.a.yT]=this.context.Zs;this.Qa.raiseEvent(bf.a.IZb,new lc(Ha),this)};pc.prototype.DQa=function(R){if(this.appName){var Ha={},Gb={};Gb.LastTeachingUIShowTime=(new Date).toUTCString();Gb.AddinHasShown=R;Ha[this.appName]=Ih.c(Gb);this.Zoa&&(this.Zoa.mtb(Ha),Od.ULS.sendTraceTag(539530527,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service"))}else Od.ULS.sendTraceTag(539530528,306,10,"Fail to save roaming service since AppName is null")};pc.prototype.wHh=
function(R){if(this.IFa=R)R=new $e.a,R.add(this.appName),this.Zoa=new Ac(this.appName,Object(Hg.a)(this,this.hKa,"getRequestSuccessCallback"),Object(Hg.a)(this,this.yja,"getRequestFailureCallback"),Object(Hg.a)(this,this.x6,"postRequestFailureCallback")),this.Zoa.C9c(R);else{R=new $e.a;var Ha={};R=(Ha.ack2=R,Ha);R[bf.a.Mga]=this.context.S_;R[bf.a.yT]=this.context.Zs;this.Qa.raiseEvent(bf.a.IZb,new lc(R),this)}};pc.prototype.hKa=function(R){R?this.Pxj(R)?(Od.ULS.sendTraceTag(527523845,306,50,"should show teaching UI"),
this.Pza="AddinHasShown"in R&&R.AddinHasShown?R.AddinHasShown.toString():null,this.oAe()):(Od.ULS.sendTraceTag(538248466,306,50,"Not Show TeachingUI this time"),this.EYb(this.IFa)):(Od.ULS.sendTraceTag(527523844,306,50,"userSettings is null"),this.Pza=null,this.oAe())};pc.prototype.yja=function(R){Od.ULS.sendTraceTag(539530529,306,10,"GET data from Roaming Settings Service with status: {0}, fallback",R?R.httpStatus:-1);this.EYb(this.IFa)};pc.prototype.x6=function(R){Od.ULS.sendTraceTag(539530530,
306,10,"failed to POST data to Roaming Settings Service with status: {0}",R?R.httpStatus:-1)};pc.prototype.oAe=function(){var R=this.ceh();if(0===R.targetType){R.solutionId?(this.ySd=R.solutionId,this.e6f=R.storeId,this.n2i()):this.Pkf("NoSolutionId");if(R.addinId){var Ha=this.Pza?this.Pza+","+R.addinId:R.addinId;gf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)?window.g_roamingAddinList=Ha:this.DQa(Ha)}this.Ske(null)}else this.Ske(R.addinId);
Od.ULS.sendTraceTag(528023563,306,50,"Show teaching callout for: {0}",R.addinId)};pc.prototype.n2i=function(){var R=this,Ha=new Vd;Ha.callbackFunc=function(Gb){if(Gb.errorCode)R.Pkf("FailToGetAppDetails"),gf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&(Gb=window.g_roamingAddinList)&&R.DQa(Gb);else if(Gb.value){var bc=ak(Gb.value);for(Gb=bc.next();!Gb.done;Gb=bc.next()){Gb=Gb.value;var Rc=Gb[1];if(Rc===R.ySd){bc={solutionId:Rc};bc.assetId=
Gb[5];Rc=gf.AFrameworkApplication.fa.isChangeGateEnabled("QueryEntitlementDetailsStoreTypeFixEnabled");bc.storeType=Rc?Gb[12]:Gb[6];gf.AFrameworkApplication.fa.isChangeGateEnabled("StoreIdFixEnabled")?bc.storeId=R.e6f:bc.storeId=Gb[11];bc.assetStoreId=Gb[6];bc.targetType=Gb[3];bc.width=Gb[7];bc.height=Gb[8];bc.displayName=Gb[0];bc.version=Gb[4];Gb=new eb(bc);R.Qa.raiseEvent(bf.a.m2f,Gb);break}}}};Ha.storeType=OSF.StoreTypeEnum.PrivateCatalog;Ha.fromInsertDialog=!1;Ha.refresh=!1;this.contextActivationMgr.queryEntitlementDetails(Ha)};
pc.prototype.Pxj=function(R){if("LastTeachingUIShowTime"in R){if(R=+new Date-+new Date(R.LastTeachingUIShowTime.toString()),R<gf.AFrameworkApplication.fa.dV("AddinShowTeachingUIIntervalInMS",864E5))return Od.ULS.sendTraceTag(538248467,306,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",R),!1}else Od.ULS.sendTraceTag(527523846,306,50,"userSetting has no date key");return!0};pc.prototype.ceh=function(){var R=new dg.a(new ic,0),Ha=new dg.a(new ic,0),Gb=0,bc=0,Rc=0,gd=new Gc;if(0<
this.context.G9.count)for(var wd=ak(this.context.G9),Ad=wd.next();!Ad.done;Ad=wd.next())gd.add(Ad.value);if(0<this.context.u3b.count)for(wd=ak(this.context.u3b),Ad=wd.next();!Ad.done;Ad=wd.next())gd.add(Ad.value);gd=ak(gd);for(Ad=gd.next();!Ad.done;Ad=gd.next())if(Ad=Ad.value,!("excatalog"!==Ad.storeType||ch.c(Ad.installTimeInMS)||!Ad.installTimeInMS||Ad.installTimeInMS<=gf.AFrameworkApplication.fa.dV("DateTimeInMSForNewAddin",16409664E5))){wd=pc.FVe(Ad);if(this.Pza){var Ld=this.Pza.split(",");if(0<
Ld.length&&Array.contains(Ld,wd)){Rc++;Od.ULS.sendTraceTag(528345032,306,50,"This addin has shown teaching UI before");continue}}wd.startsWith("private_")?(R.value<Ad.installTimeInMS&&(R=new dg.a(Object.assign(new ic,{addinId:wd,targetType:Ad.targetType,storeId:Ad.storeId,solutionId:Ad.solutionId}),Ad.installTimeInMS)),bc++):(Ha.value<Ad.installTimeInMS&&(Ha=new dg.a(Object.assign(new ic,{addinId:wd,targetType:Ad.targetType,storeId:Ad.storeId,solutionId:Ad.solutionId}),Ad.installTimeInMS)),Gb++)}Od.ULS.sendTraceTag(528345033,
306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",bc,Gb,Rc);return 0<Ha.value?Ha.key:0<R.value?R.key:Object.assign(new ic,{addinId:null,targetType:-1,solutionId:null,storeId:null})};pc.prototype.Ske=function(R){for(var Ha=new $e.a,Gb=ak(this.IFa),bc=Gb.next();!bc.done;bc=Gb.next()){var Rc=bc.value;bc=Bd(Rc);R&&(Rc=pc.FVe(Rc),R===Rc&&(bc.showCallout=!0,Rc=this.Pza?this.Pza+","+R:R,gf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)?window.g_roamingAddinList=Rc:this.DQa(Rc)));Ha.add(bc)}this.IFa&&1>this.IFa.count&&pi.a.xNb(bf.a.JZb,"false",this.context.S_);R={};Ha=(R.ack2=Ha,R);Ha[bf.a.Mga]=this.context.S_;Ha[bf.a.yT]=this.context.Zs;this.Qa.raiseEvent(bf.a.IZb,new lc(Ha),this)};pc.prototype.nui=function(){var R=!1;if(this.context.$ia&&1>this.context.$ia.count)return R;var Ha=xb();if(!Ha)return R;for(var Gb=ak(this.context.$ia),bc=Gb.next();!bc.done;bc=Gb.next())if(bc=bc.value,bc.storeId&&bc.storeId.toLowerCase()===Ha.toLowerCase()||
bc.assetId&&bc.assetId.toLowerCase()===Ha.toLowerCase()){R=pc.cKa(bc);var Rc={};bc=(Rc.SDX_Id=R,Rc.SDX_TargetType=ch.c(bc.targetType)?"":bc.targetType.toString(),Rc);cg.a.sendTelemetryEvent(Object.assign(new pg.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:$f.a.gl(bc)}));R=!0}return R};pc.prototype.Bti=function(){if(!(this.context.$ia&&1>this.context.$ia.count))if(this.HZb.jji()){var R=this.HZb.gUh();R?(R=this.tXe(this.context.$ia,R),Od.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):
(R=this.tXe(this.context.$ia,null),Od.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.HZb.Rrj(R)}else Od.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")};pc.prototype.tXe=function(R,Ha){var Gb={},bc=!1;R=ak(R);for(var Rc=R.next();!Rc.done;Rc=R.next()){Rc=Rc.value;var gd=pc.cKa(Rc);gd&&(!Ha||gd in Ha||(this.vxa(Rc,gd),Od.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===gd.toLowerCase()?bc||(bc=!0,Gb[gd]=null):Gb[gd]=null)}return Gb};
pc.prototype.vxa=function(R,Ha){var Gb=R.installTimeInMS?(new Date(R.installTimeInMS)).toISOString():"",bc={};Gb=(bc["SDX.Id"]=Ha,bc["SDX.AppInstallOrigin"]="Organization",bc["SDX.TargetType"]=ch.c(R.targetType)?"":R.targetType.toString(),bc["SDX.AdminDeploymentTime"]=Gb,bc);cg.a.sendTelemetryEvent(Object.assign(new pg.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:$f.a.gl(Gb)}));1===R.targetType&&(R={},Ha=(R["SDX.Id"]=Ha,R["SDX.AppInstallOrigin"]="Organization",R["SDX.CommandPlacement"]=
"Ribbon",R),cg.a.sendTelemetryEvent(Object.assign(new pg.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:$f.a.gl(Ha)})))};pc.prototype.Pkf=function(R){var Ha={};R=(Ha.AppTeachingUICalloutAction=R,Ha["SDX.Id"]=this.ySd,Ha.AppTeachingUICalloutGoal="NewAdminDeployment",Ha["SDX.AppInstallOrigin"]="Organization",Ha);cg.a.sendTelemetryEvent(Object.assign(new pg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$f.a.gl(R)}))};pc.cKa=function(R){return Telemetry.PrivacyRules.GetPrivacyCompliantId(R.solutionId,
R.storeType,R.assetId,null,null,R.storeId)};pc.FVe=function(R){return Telemetry.PrivacyRules.IsPrivateAddin(R.storeType,R.assetId,null,null,R.storeId)?"private_"+R.installTimeInMS:R.solutionId};Object(Cd.a)(pc,"AddInCommandsListLoader",null,[]);Fb.prototype.insertOsfControl=function(R){return this.ema.insertOsfControl(R)};Fb.prototype.getManifestInvaildErrorString=function(){return this.ema.getManifestInvaildErrorString()};Fb.prototype.isAddinCommandsAsync=function(R,Ha){this.ema.isAddinCommandsAsync(R,
Ha)};Fb.prototype.ownerAddinControlRecreated=function(R,Ha){this.ema.ownerAddinControlRecreated(R,Ha)};Fb.prototype.queryEntitlementDetails=function(R){this.ema.queryEntitlementDetails(R)};Af.Object.defineProperties(Fb.prototype,{ema:{configurable:!0,enumerable:!0,get:function(){return this.gtg}}});Object(Cd.a)(Fb,"ContextActivationMgrWrapper",null,[325]);ub.prototype.createAddinDataProvider=function(R,Ha){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(R,Ha.ema)};Af.Object.defineProperties(ub,
{instance:{configurable:!0,enumerable:!0,get:function(){ub.Ma||(ub.Ma=new ub);return ub.Ma}}});ub.Ma=null;Object(Cd.a)(ub,"OSFAddinDataProviderFactory",null,[327]);Object(Cd.a)(Kc,"CacheItem",null,[]);Pc.prototype.il=function(R){var Ha=this.PDa.getItem(R);if(Ha){var Gb=new Kc;try{Gb=Sys.Serialization.JavaScriptSerializer.deserialize(Ha,!0)}catch(bc){return this.PDa.removeItem(R),null}return Gb.Data?Gb.Data:Gb.data}return null};Pc.prototype.SPa=function(R){this.PDa.removeItem(R)};Object(Cd.a)(Pc,"AppsDataCacheManager",
null,[305]);var Rh=b(1027);Mc.prototype.uXf=function(R,Ha){R=bf.a.vYe()+R;Rh.a.instance.setItem(R,Ha.toString())};Mc.prototype.gUh=function(){var R=bf.a.s0e();Od.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",R);R=Rh.a.instance.getItem(R);return Ih.a(R)};Mc.prototype.Rrj=function(R){var Ha=bf.a.s0e();Od.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",Ha);Rh.a.instance.setItem(Ha,Ih.c(R))};Mc.prototype.jji=function(){return!!Rh.a.instance.localStorage};Af.Object.defineProperties(Mc,{instance:{configurable:!0,
enumerable:!0,get:function(){Mc.Ma||(Mc.Ma=new Mc);return Mc.Ma}}});Mc.Ma=null;Object(Cd.a)(Mc,"AddInCommandsCacheManager",null,[360]);var qi=Sys.EventArgs;Rk(rc,qi);Object(Cd.a)(rc,"InsertionParamEventArgs",Sys.EventArgs,[]);Object(Cd.a)(wb,"PostLaunchAddinCommandsParameters",null,[]);var vh=b(30);ec.prototype.OAg=function(){window.addEventListener?(window.addEventListener("LaunchAddinTaskpane",Object(Hg.a)(this,this.SNi,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",
Object(Hg.a)(this,this.bJi,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(Hg.a)(this,this.FHi,"onCloseButtonClickedEventHandler"),!0),gf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&window.addEventListener("FGWebSurfaceEvent",Object(Hg.a)(this,this.Utf,"onCampaignLaunchedHandler"),!0)):Od.ULS.sendTraceTag(525112601,306,15,"AddEventListenerForTeachingCallout failed to get Window")};ec.prototype.SNi=
function(){var R=this,Ha={};Ha=(Ha.AppTeachingUICalloutAction="ClickOnLaunch",Ha["SDX.Id"]=ec.cKa(this.Mib),Ha.AppTeachingUICalloutGoal="NewAdminDeployment",Ha["SDX.AppInstallOrigin"]="Organization",Ha);this.fgb&&this.fgb.tabs&&!this.fgb.tabs[0].isOfficeTab&&(Ha["SDX.FeatureFlags"]="NonOfficeTab");cg.a.sendTelemetryEvent(Object.assign(new pg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$f.a.gl(Ha)}));gf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)&&this.Ckc();this.fgb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.fgb,function(){var Gb=new rc;Gb.$m=R.Mib;R.$a.raiseEvent(bf.a.pjf,Gb)}):Od.ULS.sendTraceTag(525112602,306,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")};ec.prototype.FHi=function(){var R={};R=(R.AppTeachingUICalloutAction="ClickOnClose",R["SDX.Id"]=ec.cKa(this.Mib),R.AppTeachingUICalloutGoal="NewAdminDeployment",R["SDX.AppInstallOrigin"]="Organization",R);cg.a.sendTelemetryEvent(Object.assign(new pg.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$f.a.gl(R)}));gf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.Ckc()};ec.prototype.bJi=function(){var R={};R=(R.AppTeachingUICalloutAction="ClickOnDismiss",R["SDX.Id"]=ec.cKa(this.Mib),R.AppTeachingUICalloutGoal="NewAdminDeployment",R["SDX.AppInstallOrigin"]="Organization",R);cg.a.sendTelemetryEvent(Object.assign(new pg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:$f.a.gl(R)}));gf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.Ckc()};ec.prototype.Utf=function(R){if(R&&(R=R.detail)&&R.id&&this.Xei(R.id)){var Ha=(R.action||"").toLowerCase();if(R.success&&"opened"===Ha){var Gb={};Gb=(Gb.AppTeachingUICalloutAction="CampaignLaunched",Gb["SDX.Id"]=ec.cKa(this.Mib),Gb.AppTeachingUICalloutGoal="NewAdminDeployment",Gb["SDX.AppInstallOrigin"]="Organization",Gb);cg.a.sendTelemetryEvent(Object.assign(new pg.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$f.a.gl(Gb)}));Od.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming.");this.Ckc();window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",Object(Hg.a)(this,this.Utf,"onCampaignLaunchedHandler"),!0)}else try{Gb=JSON.stringify(R),Od.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+Gb)}catch(bc){Gb="id : "+R.id+" telemetryEventName: "+R.telemetryEventName,
Od.ULS.sendTraceTag(523321996,306,50,"Error serializing campaign event. "+Gb+" Error: "+(bc?bc.toString():""))}}};ec.prototype.Xei=function(R){R=vh.a.rl(R);return-1!==R.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==R.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==R.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==R.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==R.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==R.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")};ec.prototype.DQa=
function(R){var Ha=gf.AFrameworkApplication.fa.Wa("WebAppShortName");if(Ha){var Gb={},bc={};bc.LastTeachingUIShowTime=(new Date).toUTCString();bc.AddinHasShown=R;Gb[Ha]=Ih.c(bc);this.Zoa=new Ac(Ha,null,null,Object(Hg.a)(this,this.x6,"postRequestFailureCallback")),this.Zoa.mtb(Gb),Od.ULS.sendTraceTag(523535564,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else Od.ULS.sendTraceTag(523535565,306,10,"Fail to save roaming service since AppName is null")};
ec.prototype.Ckc=function(){if(!this.Rtc){var R=window.g_roamingAddinList;R&&(this.DQa(R),this.Rtc=!0)}};ec.prototype.x6=function(R){Od.ULS.sendTraceTag(523535566,306,10,"failed to POST data to Roaming Settings Service with status: {0}",R?R.httpStatus:-1)};ec.cKa=function(R){return Telemetry.PrivacyRules.GetPrivacyCompliantId(R.solutionId,R.storeType,R.assetId,null,null,R.storeId)};Object(Cd.a)(ec,"PrivateCatalogTeachingCalloutHandler",null,[]);Cb.prototype.hYa=function(R,Ha){this.y7d.hYa(R,void 0===
Ha?null:Ha);this.E9d=R};Cb.prototype.eId=function(R){this.y7d.eId(R)};Af.Object.defineProperties(Cb.prototype,{OMa:{configurable:!0,enumerable:!0,get:function(){return this.E9d}}});Object(Cd.a)(Cb,"RibbonExtensibilityManagerWithChangeDetection",null,[338]);var ci=b(1073),xj=b(100);Sa.eZe=function(R){var Ha=new $e.a;if(Sa.cAe)for(var Gb=ak(Sa.cAe),bc=Gb.next();!bc.done;bc=Gb.next())Ha.add(bc.value);bc=null;switch(R){case "Workbook":bc=Sa.AXj;break;case "Document":bc=Sa.bhh;break;case "Presentation":bc=
Sa.c0i}if(bc)for(R=ak(bc),bc=R.next();!bc.done;bc=R.next())Ha.add(bc.value);return Ha};Sa.cAe=["PrimaryCommandSurface","ContextMenu"];Sa.AXj=null;Sa.bhh=null;Sa.c0i=null;Object(Cd.a)(Sa,"ExtensionPointType",null,[]);Af.Object.defineProperties(Lb.prototype,{uDb:{configurable:!0,enumerable:!0,get:function(){return this.Bbe||(this.Bbe=new $e.a)}},toe:{configurable:!0,enumerable:!0,get:function(){return this.dkg}}});Object(Cd.a)(Lb,"ContextMenuExtensibility",null,[364]);Af.Object.defineProperties(mc.prototype,
{XV:{configurable:!0,enumerable:!0,get:function(){return this.$sg}},startedNode:{configurable:!0,enumerable:!0,get:function(){return this.xwg}},HGh:{configurable:!0,enumerable:!0,get:function(){return this.Jog}}});Object(Cd.a)(mc,"RibbonExtensibility",null,[411]);Zb.prototype.createActionContext=function(R,Ha){R={};R.ownerAddinInfo=this.entitlement;R.action=Ha;return R};Af.Object.defineProperties(Zb.prototype,{entitlement:{configurable:!0,enumerable:!0,get:function(){return this.Hng}}});Object(Cd.a)(Zb,
"AddInCommandsContextProvider",null,[]);Dc.prototype.p5g=function(R){return new Zb(R)};Dc.prototype.createActionBuilder=function(R,Ha){return OfficeExt.DefaultControlActionBinder.createActionBuilder(R,Ha.entitlement,Ha.manifest)};Dc.prototype.startApplyAddin=function(R){this.H0d=R;var Ha=this.p5g(R);this.actionBuilder=this.createActionBuilder(Ha,R)};Dc.prototype.endApplyAddin=function(){};Dc.prototype.Mbd=function(R,Ha,Gb){Gb=void 0===Gb?0:Gb;return this.ribbonBuilder.Ds&&0<this.ribbonBuilder.Ds.count?
new mc(this.WFh(R,Ha),this.Qne.startedNode,Gb):null};Dc.prototype.UUe=function(){var R=void 0===R?null:R;if(this.contextMenuBuilder.Rkc&&0<this.contextMenuBuilder.Rkc.count){R||(R=this.Qne.entitlement.solutionId);R=new Lb(R);for(var Ha=ak(this.contextMenuBuilder.Rkc),Gb=Ha.next();!Gb.done;Gb=Ha.next())R.uDb.add(Gb.value);return R}return null};Dc.prototype.WFh=function(R,Ha){return this.ribbonBuilder.Ds&&0<this.ribbonBuilder.Ds.count?new ai.a(this.ribbonBuilder.Ds,R,Ha):null};Af.Object.defineProperties(Dc.prototype,
{Qne:{configurable:!0,enumerable:!0,get:function(){return this.H0d}}});Object(Cd.a)(Dc,"AddinCommandsBuilder",null,[]);ac.prototype.gBb=function(R,Ha,Gb,bc,Rc,gd,wd){function Ad(Ue,df,zf,Ne){Rc(Ue,df,zf,Ne);Ue=ci.a[Ld.Zs]+df.assetId;zf=Ld.qSa.zc(Ue);df=zf.value;zf.returnValue&&(df.stop(),Ld.qSa.remove(Ue))}var Ld=this;if(0!==this.Zs&&R)for(Od.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",R.count),4===this.Zs&&(Od.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",
bc)),this.DXg(R,bc),gd()),R=ak(R),bc=R.next();!bc.done;bc=R.next())if(bc=bc.value,Od.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.Fo.NM,Telemetry.PrivacyRules.GetPrivacyCompliantId(bc.solutionId,bc.ownerAddinStoreType||bc.storeType,bc.assetId,null,null,bc.storeId))),this.Teg(bc))if(wd&&bc.requireConsent)wd(bc,function(Ue){try{if(Ld.qO){var df=ci.a[Ld.Zs]+Ue.solutionId,zf=Ld.qO.sc("ComponentAttach",df);Ld.qSa.ia(df,zf)}var Ne=Ld.KF.Kia(Ue.storeType,Ue.solutionId);6!==
Ld.Zs&&(Ne&&(Ld.d2b(Ne),Ne.uB.purge(!1)),Ld.ri.insertOsfControl(Ld.dGb(Ue,Ha,Gb,Ad)),Ne&&Ld.ri.ownerAddinControlRecreated(Ue.solutionId,Ue.storeType))}catch(jf){Od.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",Ld.Fo.NM,Telemetry.PrivacyRules.GetPrivacyCompliantId(Ue.solutionId,Ue.ownerAddinStoreType||Ue.storeType,Ue.assetId,null,null,Ue.storeId),Ue.version,Ue.storeType,Ue.storeId,jf.message)),
Ad(!1,Ue,null,null)}});else try{if(this.qO){var ce=ci.a[this.Zs]+bc.solutionId,me=this.qO.sc("ComponentAttach",ce);this.qSa.ia(ce,me)}var Je=this.KF.Kia(bc.storeType,bc.solutionId);6!==this.Zs&&(Je&&(this.d2b(Je),Je.uB.purge(!1)),this.ri.insertOsfControl(this.dGb(bc,Ha,Gb,Ad)),Je&&this.ri.ownerAddinControlRecreated(bc.solutionId,bc.storeType))}catch(Ue){Od.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",
this.Fo.NM,Telemetry.PrivacyRules.GetPrivacyCompliantId(bc.solutionId,bc.ownerAddinStoreType||bc.storeType,bc.assetId,null,null,bc.storeId),bc.version,bc.storeType,bc.storeId,Ue.message)),Ad(!1,bc,null,null)}else Ad(!1,bc,null,null)};ac.prototype.Rqi=function(R,Ha,Gb,bc,Rc,gd){function wd(Je,Ue,df,zf){gd(Je,Ue,df,zf);Je=ci.a[Ad.Zs]+Ue.solutionId;df=Ad.qSa.zc(Je);Ue=df.value;df.returnValue&&(Ue.stop(),Ad.qSa.remove(Je))}var Ad=this;if(6===this.Zs&&R)if(Od.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",
this.Fo.NM,Telemetry.PrivacyRules.GetPrivacyCompliantId(R.solutionId,R.ownerAddinStoreType||R.storeType,R.assetId,null,null,R.storeId))),this.Teg(R))try{if(this.qO){var Ld=ci.a[this.Zs]+R.solutionId,ce=this.qO.sc("ComponentAttach",Ld);this.qSa.ia(Ld,ce)}var me=this.KF.Kia(R.storeType,R.solutionId);me||wd(!1,R,null,null);gf.AFrameworkApplication.ta&&gf.AFrameworkApplication.ta.Pa.delayInstallAddInIsEnabled?this.rVe(R,Ha,bc,Rc,Gb,function(Je){wd(Je,R,Gb,me.displayName)}):(this.rVe(R,Ha,bc,Rc,Gb),wd(!0,
R,Gb,me.displayName))}catch(Je){Od.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",this.Fo.NM,Telemetry.PrivacyRules.GetPrivacyCompliantId(R.solutionId,R.ownerAddinStoreType||R.storeType,R.assetId,null,null,R.storeId),R.version,R.storeType,R.storeId,Je.message)),wd(!1,R,null,null)}else wd(!1,R,null,null)};ac.prototype.OFi=function(R,Ha,Gb,bc,Rc,gd){if(gd)if(gd._isAddinCommandsManifest(this.Fo.NM))try{gf.AFrameworkApplication.ta&&
gf.AFrameworkApplication.ta.Pa.delayInstallAddInIsEnabled?this.qVe(R,Ha,Gb,Rc,gd,function(wd){bc(wd,R,gd,gd.getDefaultDisplayName())}):(this.qVe(R,Ha,Gb,Rc,gd),bc(!0,R,gd,gd.getDefaultDisplayName()))}catch(wd){Od.ULS.sendTraceTag(17586257,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.Fo.NM,Telemetry.PrivacyRules.GetPrivacyCompliantId(R.solutionId,R.ownerAddinStoreType||R.storeType,R.assetId,
null,null,R.storeId),R.version,R.storeType,R.storeId,wd.message)),bc(!1,R,gd,gd.getDefaultDisplayName())}else Od.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",this.Fo.NM,Telemetry.PrivacyRules.GetPrivacyCompliantId(R.solutionId,R.ownerAddinStoreType||R.storeType,R.assetId,null,null,R.storeId),R.version,R.storeType,R.storeId)),bc(!1,R,null,null);else Od.ULS.sendTraceTag(17586259,
220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.Fo.NM,Telemetry.PrivacyRules.GetPrivacyCompliantId(R.solutionId,R.ownerAddinStoreType||R.storeType,R.assetId,null,null,R.storeId),R.version,R.storeType,R.storeId)),bc(!1,R,null,null)};ac.prototype.dGb=function(R,Ha,Gb,bc){var Rc=this,gd={},wd=document.createElement("div");wd.setAttribute("visible","false");gd.div=wd;gd.id=R.solutionId;gd.solutionId=R.solutionId;gd.version=R.version;
gd.storeType=R.storeType;gd.storeId=R.storeId;gd.assetId=R.assetId;gd.assetStoreId=R.assetStoreId;gd.isvirtualOsfControl=!0;gd.virtualOsfControlActivationCallback=function(Ad,Ld){var ce=Rc.KF.Kia(R.storeType,R.solutionId);ce&&(ce.isUpgraded&&(R.isUpgraded=!0),Rc.d2b(ce));Rc.OFi(R,Ha,Gb,bc,Ad,Ld)};gd.reason=3===this.Zs?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;return gd};ac.prototype.qVe=function(R,Ha,Gb,bc,Rc,gd){gd=
void 0===gd?null:gd;var wd={};wd.solutionId=bc.getSolutionId();wd.version=bc.getVersion();wd.storeType=bc.getStoreType();wd.storeId=bc.getStoreId();wd.assetId=bc.getSolutionId();wd.assetStoreId=bc.getAssetStoreId();wd.targetType=bc.getOsfControlType();var Ad=null,Ld=null;if(gf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1))Ad=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Fo.NM,this.Fo.formFactor)).parseExtensions(wd,
Rc,this.Lga),Ld=Sa.eZe(this.Fo.NM);else try{Ad=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Fo.NM,this.Fo.formFactor)).parseExtensions(wd,Rc,this.Lga),Ld=Sa.eZe(this.Fo.NM)}catch(Gf){throw Od.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+Gf.message),Gf;}if(Ld&&0<Ld.count){if(gf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1)){var ce=Ha(R);var me=Gb(R);Gb=!!gf.AFrameworkApplication.fa&&
gf.AFrameworkApplication.fa.ra("AddinCommandsMultipleCustomTabsEnabled");ce=new Dc(ce,null,me);Ld=ak(Ld);for(me=Ld.next();!me.done;me=Ld.next())ce.commandSurface=me.value,Ad.apply(ce,this.Lga,Gb)}else try{var Je=Ha(R),Ue=Gb(R),df=!!gf.AFrameworkApplication.fa&&gf.AFrameworkApplication.fa.ra("AddinCommandsMultipleCustomTabsEnabled");ce=new Dc(Je,null,Ue);var zf=ak(Ld);for(me=zf.next();!me.done;me=zf.next())ce.commandSurface=me.value,Ad.apply(ce,this.Lga,df)}catch(Gf){throw Od.ULS.sendTraceTag(538752132,
220,10,"Exception encounter while building ribbon. Exception: "+Gf.message),Gf;}if(OSF.OUtil.checkFlight(14))try{var Ne=ce.Mbd(R.solutionId,Rc.getDefaultDisplayName()),jf=ce.UUe();Ne&&this.ribbonManager.hYa(Ne,gd);jf&&this.contextMenuManager.uke(jf);this.KF.Yke(bc,Ne,jf,Rc.getDefaultDisplayName());Od.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",Rc.getDefaultDisplayName())}catch(Gf){throw OfficeExt.DevConsole.log(Gf),Od.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+
Gf.message),Gf;}else try{var qf=ce.Mbd(R.solutionId,Rc.getDefaultDisplayName()),Df=ce.UUe();qf&&this.ribbonManager.hYa(qf);Df&&this.contextMenuManager.uke(Df);this.KF.Yke(bc,qf,Df,Rc.getDefaultDisplayName());Od.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",Rc.getDefaultDisplayName())}catch(Gf){throw Od.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+Gf.message),Gf;}}};ac.prototype.rVe=function(R,Ha,Gb,bc,Rc,gd){gd=void 0===gd?null:gd;var wd={};wd.solutionId=
R.solutionId;wd.version=R.version;wd.storeType=R.storeType;wd.storeId=R.assetStoreId;wd.assetId=R.assetId;wd.assetStoreId=R.assetStoreId;wd.targetType=R.targetType;var Ad=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.Fo.NM,this.Fo.formFactor);try{var Ld=Ha.getManifest(),ce=Ad.parse(wd,Ld,Rc,this.Lga,Ha.getSharedRuntimeId()),me=Gb(R),Je=bc(R),Ue=new Dc(me,null,Je);Ue.commandSurface="PrimaryCommandSurface";ce.apply(Ue,this.Lga,!0);if(Ue.ribbonBuilder.Ds&&0<Ue.ribbonBuilder.Ds.count){var df=
Ue.Mbd(R.solutionId,Ha.getManifest().getDefaultDisplayName(),1);gf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",!1)?this.ribbonManager.hYa(df,gd):df&&this.ribbonManager.hYa(df,gd);this.KF.GBg(Ha,df,Rc,Ha.getManifest().getDefaultDisplayName());Od.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",Ha.getManifest().getDefaultDisplayName())}}catch(zf){Od.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",
Ha.getManifest().getDefaultDisplayName(),zf.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(zf)}};ac.prototype.d2b=function(R){R.xo&&this.ribbonManager.eId(R.xo);R.Cqb&&this.contextMenuManager.V9i(R.Cqb);this.KF.D9i(R.uB.getStoreType(),R.uB.getSolutionId())};ac.prototype.DXg=function(R,Ha){Ha=ld(Ha);for(var Gb=ak(this.KF.q5a),bc=Gb.next();!bc.done;bc=Gb.next())if(bc=bc.value,bc.uB.getStoreType()===Ha){for(var Rc=!0,gd=ak(R),wd=gd.next();!wd.done;wd=gd.next())if((wd=wd.value)&&bc.Lff(wd.storeType,
wd.solutionId)){Rc=!1;break}Rc&&(this.d2b(bc),bc.uB.purge(!1))}};ac.prototype.Teg=function(R){return!!R&&!!R.solutionId&&!!R.version&&!!R.storeType&&!!R.storeId};Object(Cd.a)(ac,"AddInCommandsIntegration",null,[]);lb.prototype.ADg=function(R){this.$a.addHandler(bf.a.Pne,R)};lb.prototype.qFg=function(R){this.$a.addHandler(bf.a.pjf,R)};lb.prototype.SGg=function(R){this.$a.addHandler(bf.a.o2f,R)};lb.prototype.GDg=function(R){this.$a.addHandler(bf.a.gXc,R)};lb.prototype.iri=function(R,Ha,Gb){var bc=this,
Rc=Gb[bf.a.lnb],gd=void 0===Gb[bf.a.yT]?0:Gb[bf.a.yT];if(Rc&&0!==gd)if(0>=Rc.count&&4!==gd)this.RGf(new wb(gd,null,null,Ha,null,!0));else{var wd=Rc.count,Ad=new Cb(new Ye),Ld=void 0===Gb[bf.a.Mga]?-1:Gb[bf.a.Mga],ce=new ac(gd,this.Mm,this.jEc,Ad,this.zmg,this.UWa,this.cQb),me=function(Ne){return bc.Ghe.SQg(Ne.solutionId,bc.cQb,bc.jEc,R)},Je=function(Ne){return bc.Ghe.cQg(Ne.solutionId)},Ue=function(Ne,jf,qf){wd--;qf=new wb(gd,jf,Ad,Ha,qf,0>=wd);Ne&&jf?bc.RGf(qf):(bc.YSb&&(3===gd||jf&&jf.isUpgraded)&&
(Ne="",jf&&(Ne=Telemetry.PrivacyRules.GetPrivacyCompliantId(jf.solutionId,jf.ownerAddinStoreType||jf.storeType,jf.assetId,null,null,jf.storeId)),jf={},jf=(jf.SDX_AppInstallOrigin="User",jf.SDX_AppInstallErrorCode="onAddinCompletedBase.fail",jf.SDX_Id=Ne,jf),cg.a.sendTelemetryEvent(Object.assign(new pg.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:$f.a.gl(jf)}))),bc.QGf(qf));wd||gf.AFrameworkApplication.ta.updateCommandUI()},df=function(Ne,jf,qf,Df){Ue(Ne,jf,Df)},zf=function(){bc.Exd();
0>=Rc.count&&4===gd&&bc.UWa.NNd()};6===gd?(Ld=Gb[bf.a.sIa],Gb=Gb[bf.a.tIa],ce.Rqi(Rc.na(0),Ld,Gb,me,Je,function(Ne,jf,qf,Df){Ue(Ne,jf,Df)})):ce.gBb(Rc,me,Je,Ld,df,zf,this.Ssg)}else this.YSb&&(ce={},ce=(ce.SDX_AppInstallOrigin="User",ce.SDX_AppInstallErrorCode="LaunchOneLineRibbonAddinCommands.fail",ce.SDX_Id="",ce),cg.a.sendTelemetryEvent(Object.assign(new pg.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:$f.a.gl(ce)}))),Od.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",
this.jEc.NM)),this.QGf(new wb(gd,null,null,Ha,null,!0))};lb.prototype.QGf=function(R){this.Exd(R);this.f3f(!1,R)};lb.prototype.RGf=function(R){var Ha=R.$m,Gb=null;null!==Ha&&(Gb=Ha.storeType,Gb=Gb.toLowerCase());if(this.YSb&&R&&"omex"===Gb&&(3===R.Zs||Ha.isUpgraded)){var bc={};bc=(bc.SDX_AppInstallOrigin="User",bc.SDX_AppInstallErrorCode="0",bc.SDX_Id=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ha.solutionId,Ha.ownerAddinStoreType||Ha.storeType,Ha.assetId,null,null,Ha.storeId),bc);cg.a.sendTelemetryEvent(Object.assign(new pg.a,
{name:"Office.Extensibility.Host.AppInstall",dataFields:$f.a.gl(bc)}))}this.Exd(R);"omex"===Gb&&R.U6&&(3===R.Zs||Ha.isUpgraded)&&(bc=new rc,bc.$m=Ha,bc.xo=R.U6.OMa,this.$a.raiseEvent(bf.a.gXc,bc));if(this.Hqg){bc=Fd();var Rc=xb();bc&&Ha&&"excatalog"===Ha.storeType&&R.U6&&5===R.Zs&&Rc&&(Ha.storeId&&Ha.storeId.toLowerCase()===Rc.toLowerCase()||Ha.assetId&&Ha.assetId.toLowerCase()===Rc.toLowerCase())&&(bc=new rc,bc.$m=Ha,bc.xo=R.U6.OMa,this.$a.raiseEvent(bf.a.gXc,bc),Od.ULS.sendTraceTag(525362254,220,
50,"Email alert triggers AutoLaunchAddin event."))}Ha&&(Mc.instance.uXf(Bc(Gb),!0),"uploadfiledevcatalog"===Gb&&(bc=this.Sjg.createAddinDataProvider(Gb,this.Mm))&&bc.localCacheAddinCommands(this.Mm.ema,Ha.solutionId,Ha.version,Ha.storeId),pi.a.xNb(bf.a.JZb,"true",Bc(Gb)));this.f3f(!0,R)};lb.prototype.f3f=function(R,Ha){R?gf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&Ha.U6&&5===Ha.Zs&&Ha.U6.OMa&&void 0!==Ha.$m.showCallout&&
null!==Ha.$m.showCallout&&Ha.$m.showCallout?((new ec(this.$a,Ha.$m,ai.a.kub(Ha.U6.OMa))).OAg(),R=new rc,R.xo=Ha.U6.OMa,R.$m=Ha.$m,this.$a.raiseEvent(bf.a.o2f,R)):3!==Ha.Zs?Ha.wif&&this.UWa.NNd():Ha.U6&&Ha.U6.OMa&&"hardcodedpreinstall"!==Ha.$m.storeType&&Vh.a.Uyj(Ha.displayName,Ha.U6.OMa,Ha.$m.isAutoLaunched):3===Ha.Zs?Ha.$m&&"uploadfiledevcatalog"===Ha.$m.storeType.toLowerCase()?(Ha=this.cQb.zNh(Ha.$m.solutionId),Vh.a.SQd(Ha?Ha:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):
this.UWa.AYf():Ha.wif&&this.UWa.NNd()};lb.prototype.Exd=function(R){var Ha=(R=void 0===R?null:R)?R.$m:null,Gb=new rc;if(Gb.$m=Ha){var bc=this.UWa.Kia(Ha.storeType,Ha.solutionId,6===R.Zs?1:0);bc&&bc.xo&&(Gb.xo=bc.xo,this.YSb&&3===R.Zs&&"hardcodedpreinstall"!==Ha.storeType)&&(R="",bc.xo.XV&&bc.xo.XV.Ds&&(bc=bc.xo.XV.Ds.na(0))&&(R=bc.id),bc={},Ha=(bc.SDX_CommandPlacement=R,bc.SDX_PinningAction="Pinning",bc.SDX_PinningActionErrorCode="0",bc.SDX_Id=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ha.solutionId,
Ha.ownerAddinStoreType||Ha.storeType,Ha.assetId,null,null,Ha.storeId),bc),cg.a.sendTelemetryEvent(Object.assign(new pg.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:$f.a.gl(Ha)})))}this.$a.raiseEvent(bf.a.Pne,Gb)};Object(Cd.a)(lb,"LaunchAddinCommandsHandler",null,[374]);kb.gUa="Alt";kb.hUa="Command";kb.id="Id";kb.jUa="Image16by16";kb.NPb="LabelText";kb.kUa="Title";kb.GROUP="Group";kb.P_d="Groups";kb.Wfb="Controls";kb.button="Button";kb.waa="FlyoutAnchor";kb.LARGE="Large";kb.SMALL="Small";
Object(Cd.a)(kb,"AddinDataNodeConstants",null,[]);b(394);b(631);b(625);b(167);Af.Object.defineProperties(Ya.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id||""}},jU:{configurable:!0,enumerable:!0,get:function(){return this.j3d||(this.j3d={})}},controlType:{configurable:!0,enumerable:!0,get:function(){return this.Fmg||""}},menuItems:{configurable:!0,enumerable:!0,get:function(){return this.WDa||(this.WDa=new $e.a)}}});Object(Cd.a)(Ya,"ControlDefinition",null,[363]);Af.Object.defineProperties(Aa.prototype,
{jla:{configurable:!0,enumerable:!0,get:function(){return this.jae||(this.jae={})}},id:{configurable:!0,enumerable:!0,get:function(){return this._id||""}}});Object(Cd.a)(Aa,"MenuItemDefinition",null,[370]);Af.Object.defineProperties(Pb.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}},controls:{configurable:!0,enumerable:!0,get:function(){return this.qpa||(this.qpa=new $e.a)}}});Object(Cd.a)(Pb,"OfficeMenuDefinition",null,[362]);var Bg=b(27);sb.prototype.addButton=function(R){Od.ULS.sendTraceTag(17085952,
220,50,"ContextMenu button actiontype: {0}.",R.actionType);this.JI=new Ya(this.hsa(R.id),kb.button);this.JI.jU[kb.NPb]=R.label;this.JI.jU[kb.gUa]=R.label;this.JI.jU[kb.jUa]=R.icon["16"];this.Bob(this.JI.jU[kb.id],R.action);this.tFa(this.JI.jU);this.ZUa.controls.add(this.JI);this.JI=null};sb.prototype.startBuildMenu=function(R){if(ch.c(this.ZUa))this.ZUa=new Pb(R.id);else{var Ha=this.hsa(R.id);this.JI=new Ya(Ha,kb.waa);this.MZa(this.JI.jU,R);this.JI.jU[kb.jUa]=R.icon["16"];this.JI.jU[kb.hUa]=Bg.a.alwaysEnabled}};
sb.prototype.addMenuItem=function(R){Od.ULS.sendTraceTag(17085953,220,50,"ContextMenu menu item actiontype: {0}.",R.actionType);var Ha=new Aa(this.hsa(R.id));this.MZa(Ha.jla,R);R.icon&&(Ha.jla[kb.jUa]=R.icon["16"]);this.Bob(Ha.jla[kb.id],R.action);this.tFa(Ha.jla);this.JI.menuItems.add(Ha)};sb.prototype.endBuildMenu=function(){ch.c(this.JI)?(this.Rkc.add(this.ZUa),this.ZUa=null):(this.ZUa.controls.add(this.JI),this.JI=null)};sb.prototype.Bob=function(R,Ha){this.USc.bindAction(R,Ha)};sb.prototype.tFa=
function(R){this.eqb.tFa(R)};sb.prototype.hsa=function(R){return this.ylc.JJa(R)};sb.prototype.MZa=function(R,Ha){R[kb.NPb]=Ha.label;R[kb.gUa]=Ha.label};Af.Object.defineProperties(sb.prototype,{ylc:{configurable:!0,enumerable:!0,get:function(){return this.oNc}},eqb:{configurable:!0,enumerable:!0,get:function(){return this.MUa}},USc:{configurable:!0,enumerable:!0,get:function(){return this.mUa}},Rkc:{configurable:!0,enumerable:!0,get:function(){return this.psg}}});Object(Cd.a)(sb,"ContextMenuExtensibilityCreator",
null,[355,351]);ob.prototype.JJa=function(R){return this.RCb+R};Af.Object.defineProperties(ob.prototype,{RCb:{configurable:!0,enumerable:!0,get:function(){return this.Ujb}}});Object(Cd.a)(ob,"DefaultContextMenuNamingProvider",null,[354]);var bj=b(1518);Ab.prototype.bindAction=function(R,Ha){OfficeExt.DefaultControlActionBinder.bindAction(R,Ha)};Object(Cd.a)(Ab,"DefaultUIControlActionBinder",null,[353]);rb.prototype.tFa=function(R){R[kb.hUa]=this.command};Af.Object.defineProperties(rb.prototype,{command:{configurable:!0,
enumerable:!0,get:function(){return this.ECa}}});Object(Cd.a)(rb,"DefaultUIControlCommandBinder",null,[352]);var ii=b(32);Object(Cd.a)(Da,"AddInControl",null,[]);Object(Cd.a)(pa,"AddInGroup",null,[]);Object(Cd.a)(Ta,"AddInMenuItem",null,[]);Object(Cd.a)($a,"AddInTab",null,[]);Ja.prototype.startBuildTab=function(R){var Ha=R.isOfficeTab?R.id:this.ylc.h2e(R.id),Gb=R.isOfficeTab?null:R.label;this.$Ua=Object.assign(new $a,{id:Ha,title:Gb,isOfficeTab:R.isOfficeTab,visible:R.visible,groups:[],tabType:R.tabType,
insertBefore:R.insertBefore,insertAfter:R.insertAfter,autoFocus:R.autoFocus})};Ja.prototype.startBuildGroup=function(R){var Ha=this.hsa(R.id);this.Vea=Object.assign(new pa,{id:Ha,mlrId:R.mlrId,title:R.label,controls:[],groupType:0})};Ja.prototype.addNativeGroup=function(R){this.Vea=Object.assign(new pa,{id:R.id,mlrId:R.mlrId,title:R.label,controls:[],groupType:1});this.$Ua.groups.push(this.Vea)};Ja.prototype.addButton=function(R){var Ha=this.hsa(R.id);Ha&&(this.Bob(Ha,R.action),Od.ULS.sendTraceTag(24786640,
220,50,"AddInDataTransferObject button actiontype: {0}.",R.actionType),R=Object.assign(new Da,{id:Ha,title:R.label,iconLocation:this.Zdd(R),enabled:R.enabled,controlType:0,attributes:this.MZa()}),this.j5d.ike(new ii.a(Ha,this.eqb.command.toString())),this.Vea.controls.push(R))};Ja.prototype.addNativeControl=function(R){R.id&&(Od.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",R.actionType),R=Object.assign(new Da,{id:R.id,title:"",iconLocation:"",enabled:R.enabled,
controlType:2,attributes:this.MZa()}),this.Vea.controls.push(R))};Ja.prototype.startBuildMenu=function(R){var Ha=this.hsa(R.id);Ha&&(this.lhb=Object.assign(new Da,{id:Ha,title:R.label,iconLocation:this.Zdd(R),controlType:1,attributes:{},menuItems:[]}))};Ja.prototype.addMenuItem=function(R){var Ha=this.hsa(R.id);Ha&&(this.Bob(Ha,R.action),Od.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",R.actionType),R=Object.assign(new Ta,{id:Ha,title:R.label,iconLocation:this.Zdd(R),
enabled:R.enabled,attributes:this.MZa()}),this.j5d.ike(new ii.a(Ha,this.eqb.command.toString())),this.lhb.menuItems.push(R))};Ja.prototype.endBuildMenu=function(){ch.c(this.lhb.id)||this.Vea.controls.push(this.lhb);this.lhb=null};Ja.prototype.endBuildGroup=function(){ch.c(this.Vea.id)||this.$Ua.groups.push(this.Vea);this.Vea=null};Ja.prototype.endBuildTab=function(){ch.c(this.$Ua.id)||this.$Pb.add(this.$Ua);this.$Ua=null};Ja.prototype.MZa=function(){var R={};this.tFa(R);return R};Ja.prototype.Zdd=
function(R){return R.icon["80"]?R.icon["80"]:R.icon["32"]};Ja.prototype.tFa=function(R){this.eqb.tFa(R)};Ja.prototype.hsa=function(R){return this.ylc.JJa(R)};Ja.prototype.Bob=function(R,Ha){this.USc.bindAction(R,Ha)};Af.Object.defineProperties(Ja.prototype,{ylc:{configurable:!0,enumerable:!0,get:function(){return this.oNc}},Ds:{configurable:!0,enumerable:!0,get:function(){return this.$Pb}},USc:{configurable:!0,enumerable:!0,get:function(){return this.mUa}},eqb:{configurable:!0,enumerable:!0,get:function(){return this.MUa}}});
Object(Cd.a)(Ja,"OneLineRibbonExtensibilityCreator",null,[350,351]);oa.prototype.cQg=function(R){R=new ob(R);return new sb(R,this.MUa,this.mUa)};oa.prototype.SQg=function(R,Ha,Gb,bc){Gb=new bj.a(this.Ujb,R,Gb,!0);return new Ja(Gb,this.mUa,this.MUa,R,Ha,bc)};Object(Cd.a)(oa,"UIExtensibilityFactory",null,[326]);var di=b(92),Fi=b(1072),Gi=b(22),If=b(37),dh=b(76),Kg=b(51);P.GetPrivacyCompliantId=function(R){return Telemetry.PrivacyRules.GetPrivacyCompliantId(R.solutionId,R.storeType,R.assetId,null,null,
R.storeId)};P.iUa=function(R){return Telemetry.PrivacyRules.GetPrivacyCompliantId(R.solutionId,R.storeType,R.assetId,null,null,R.storeId)};P.prototype.Y8i=function(R){this.mC=R;window.addEventListener&&(window.addEventListener("LaunchContentAddin",Object(Hg.a)(this,this.TNi,"onLaunchButtonClicked_ContentAddin"),!0),window.addEventListener("DismissCallout",Object(Hg.a)(this,this.cJi,"onDismissButtonClicked_ContentAddin"),!0),window.addEventListener("CloseCallout",Object(Hg.a)(this,this.GHi,"onCloseButtonClicked_ContentAddin"),
!0))};P.prototype.kfd=function(R){return"[id="+R+"]"};P.prototype.H3f=function(R,Ha){var Gb=this;Ha>this.zHg?(window.clearTimeout(this.oOf),this.G3f("[data-unique-id='pivotOverflowButton']"),Od.ULS.sendTraceTag(537170692,220,50,"ShowTeachingCalloutWithPoll did not find the DOM element in time")):document.querySelector("button"+R)?this.G3f(R):this.oOf=window.setTimeout(function(){Gb.H3f(R,Ha+1)},1E3)};P.prototype.F3f=function(R){var Ha=document.querySelector("button[data-unique-id='RightPaddle']");
if(Ha)R={},R=(R.AppTeachingUICalloutAction="RightPaddlePresent",R["SDX.Id"]=P.GetPrivacyCompliantId(this.$m),R.AppTeachingUICalloutGoal="NewAdminDeployment",R["SDX.AppInstallOrigin"]="Organization",R),cg.a.sendTelemetryEvent(Object(Qg.a)(new pg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$f.a.gl(R)}));else if(Ha=document.querySelector("button"+R),!Ha||"none"===window.getComputedStyle(Ha).display)if(Ha=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!Ha){Ha=
{};Ha=(Ha.AppTeachingUICalloutAction="NoAnchor",Ha["SDX.Id"]=P.GetPrivacyCompliantId(this.$m),Ha.AppTeachingUICalloutGoal="NewAdminDeployment",Ha["SDX.AppInstallOrigin"]="Organization",Ha);cg.a.sendTelemetryEvent(Object(Qg.a)(new pg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$f.a.gl(Ha)}));Od.ULS.sendTraceTag(537170691,220,15,"ShowTeachingCallout failed to get an anchorElement");this.H5();return}this.g$f(Ha,"ShowTeachingUIForAddinButton")};P.prototype.G3f=function(R){R=document.querySelector("button"+
R);if(!R&&(R=document.querySelector("button[data-unique-id='pivotOverflowButton']"),!R)){R={};R=(R.AppTeachingUICalloutAction="NoAnchor",R["SDX.Id"]=P.GetPrivacyCompliantId(this.$m),R.AppTeachingUICalloutGoal="NewAdminDeployment",R["SDX.AppInstallOrigin"]="Organization",R);cg.a.sendTelemetryEvent(Object(Qg.a)(new pg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$f.a.gl(R)}));Od.ULS.sendTraceTag(537170690,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");
this.H5();return}this.g$f(R,"ShowTeachingUIForAddinTab")};P.prototype.g$f=function(R,Ha){R.setAttribute("lpp-id","latestAddin");var Gb=Rg.a.instance.Tb("Common.ISystemInitiatedFeedback");Gb&&R?(Gb.execute(function(bc){bc.logActivity(Ha,null)}),R={},R=(R.AppTeachingUICalloutAction="Show",R["SDX.Id"]=P.GetPrivacyCompliantId(this.$m),R.AppTeachingUICalloutGoal="NewAdminDeployment",R["SDX.AppInstallOrigin"]="Organization",R),cg.a.sendTelemetryEvent(Object(Qg.a)(new pg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:$f.a.gl(R)})),Od.ULS.sendTraceTag(537170688,220,50,"ShowTeachingCalloutToAddinTab triggered an LPP activity")):(Od.ULS.sendTraceTag(537170689,220,15,"ShowTeachingCalloutToAddinTab failed to get a sifFuture"),R={},R=(R.AppTeachingUICalloutAction="NoSifFutureObject",R["SDX.Id"]=P.GetPrivacyCompliantId(this.$m),R.AppTeachingUICalloutGoal="NewAdminDeployment",R["SDX.AppInstallOrigin"]="Organization",R),cg.a.sendTelemetryEvent(Object(Qg.a)(new pg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:$f.a.gl(R)})),this.H5())};P.prototype.vHh=function(R){if(!R)return null;R=R.XV;if((null===R||void 0===R?0:R.Ds)&&0<R.Ds.count){R=ak(R.Ds);for(var Ha=R.next();!Ha.done;Ha=R.next())if(Ha=Ha.value,Ha.groups&&0<Ha.groups.length){Ha=ak(Ha.groups);for(var Gb=Ha.next();!Gb.done;Gb=Ha.next())if(Gb=Gb.value,Gb.controls&&0<Gb.controls.length){Gb=ak(Gb.controls);for(var bc=Gb.next();!bc.done;bc=Gb.next()){bc=bc.value;if(bc.attributes&&0===bc.controlType&&bc.enabled)return bc.id;if(bc.menuItems)for(var Rc=
ak(bc.menuItems),gd=Rc.next();!gd.done;gd=Rc.next())if(gd=gd.value,gd.attributes&&gd.enabled)return bc.id}}}}return null};P.prototype.pBj=function(){var R=document.querySelector("button[data-unique-id = 'Ribbon-InsertAppsForOffice']");if(R&&"none"!==window.getComputedStyle(R).display)Od.ULS.sendTraceTag(527286666,220,15,"Callout show on OfficeAddin Button");else{R=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']");if(null==R){R={};R=(R.AppTeachingUICalloutAction=
"NoAnchor",R["SDX.Id"]=P.iUa(this.mC),R.AppTeachingUICalloutGoal="NewAdminDeployment",R["SDX.AppInstallOrigin"]="Organization",R);cg.a.sendTelemetryEvent(Object(Qg.a)(new pg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$f.a.gl(R)}));Od.ULS.sendTraceTag(527286668,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");this.H5();return}Od.ULS.sendTraceTag(527286667,220,15,"Callout show on Overflow button")}var Ha=Rg.a.instance.Tb("Common.ISystemInitiatedFeedback");
null==Ha||null==R?(R={},R=(R.AppTeachingUICalloutAction="NoSifFutureObject",R["SDX.Id"]=P.iUa(this.mC),R.AppTeachingUICalloutGoal="NewAdminDeployment",R["SDX.AppInstallOrigin"]="Organization",R),cg.a.sendTelemetryEvent(Object(Qg.a)(new pg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$f.a.gl(R)})),Od.ULS.sendTraceTag(527286665,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"),this.H5()):(Ha.execute(function(Gb){Gb.logActivity("ShowTeachingUIForContentAddin",
null)}),R={},R=(R.AppTeachingUICalloutAction="Show",R["SDX.Id"]=P.iUa(this.mC),R.AppTeachingUICalloutGoal="NewAdminDeployment",R["SDX.AppInstallOrigin"]="Organization",R),cg.a.sendTelemetryEvent(Object(Qg.a)(new pg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$f.a.gl(R)})),Od.ULS.sendTraceTag(527286664,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity"))};P.prototype.TNi=function(){var R={};R=(R.AppTeachingUICalloutAction="ClickOnLaunch",R["SDX.Id"]=P.iUa(this.mC),
R.AppTeachingUICalloutGoal="NewAdminDeployment",R["SDX.AppInstallOrigin"]="Organization",R);cg.a.sendTelemetryEvent(Object(Qg.a)(new pg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$f.a.gl(R)}));this.H5();var Ha={};Ha[dh.a.Vf]=this.mC;R={};R.solutionId=this.mC.solutionId;R.assetId=this.mC.assetId;R.assetStoreId=this.mC.assetStoreId;R.height=0!=this.mC.height?this.mC.height:600;R.storeId=this.mC.storeId;R.storeType=this.mC.storeType;R.targetType=this.mC.targetType;R.width=0!=
this.mC.width?this.mC.width:600;R.displayName=this.mC.displayName;R.version=this.mC.version;R.isAddinCommands=!1;Ha[bf.a.Hra]=R;var Gb=new di.a(-741808261,0,0,2,null);If.TaskExtensions.Ba(Kg.GetServiceTaskFactory.Ra(this.$.da,374,375,1),function(bc){bc=bc.result;null!=bc&&bc.insertAgave(Ha,Gb)},this.$.la,3)};P.prototype.GHi=function(){var R={};R=(R.AppTeachingUICalloutAction="ClickOnClose",R["SDX.Id"]=P.iUa(this.mC),R.AppTeachingUICalloutGoal="NewAdminDeployment",R["SDX.AppInstallOrigin"]="Organization",
R);cg.a.sendTelemetryEvent(Object(Qg.a)(new pg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$f.a.gl(R)}));this.H5()};P.prototype.cJi=function(){var R={};R=(R.AppTeachingUICalloutAction="ClickOnDismiss",R["SDX.Id"]=P.iUa(this.mC),R.AppTeachingUICalloutGoal="NewAdminDeployment",R["SDX.AppInstallOrigin"]="Organization",R);cg.a.sendTelemetryEvent(Object(Qg.a)(new pg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$f.a.gl(R)}));this.H5()};P.prototype.DQa=function(R){var Ha=
{},Gb={};Gb.LastTeachingUIShowTime=(new Date).toUTCString();Gb.AddinHasShown=R;Ha[this.appName]=Ih.c(Gb);this.Sne=new Ac(this.appName,null,null,Object(Hg.a)(this,this.x6,"postRequestFailureCallback")),this.Sne.mtb(Ha),Od.ULS.sendTraceTag(522981592,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")};P.prototype.H5=function(){if(gf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&!this.Rtc){var R=
window.g_roamingAddinList;R&&(this.DQa(R),this.Rtc=!0)}};P.prototype.x6=function(R){Od.ULS.sendTraceTag(522981591,306,10,"failed to POST data to Roaming Settings Service with status: {0}",R?R.httpStatus:-1)};Object(Cd.a)(P,"AddinTeachingCalloutHandler",null,[]);var ri=b(1439),cj=b(395),si=b(10),Hi=b(186),ti=b(40),qg=b(21),wh=b(58);ma.prototype.dispose=function(){void 0!==this.mnb&&null!==this.mnb&&(this.mnb.dispose(),this.mnb=null);this.te=this.$=null;this.disposed=!0};ma.prototype.owj=function(R,
Ha){switch(R){case Bg.a.m2:R=this.awj(Ha);break;default:R=!1}return R};ma.prototype.Lc=function(){return!1};ma.prototype.executeCommand=function(R,Ha,Gb){var bc=this;R=If.TaskExtensions.jk();Ha=Ha.command;switch(Ha){case 843847158:break;case -2025863019:Vh.a.SQd(Gb[bf.a.iVc].toString(),function(){qg.g(bc.$).focus()});break;case -1777565636:ri.a.showUILessDialog(Gb[bf.a.nnb].toString());this.te.izj(Gb[bf.a.nnb].toString());break;case 1592314317:ri.a.hideUILessDialog(Gb[bf.a.nnb].toString());this.te.S5h(Gb[bf.a.nnb].toString());
break;case Bg.a.m2:R=this.dhd(Gb);break;case Bg.a.fBb:this.gBb(Gb);break;case Bg.a.Tma:this.Tma(Gb);break;case Bg.a.TQd:this.mnb.yxc();break;case Bg.a.refreshAddinCommands:this.U6i();break;case 1949669462:this.Nga.AYf(!0);break;case -1014260128:R=this.executeDynamicAddInCommandsAPI(Gb);break;default:R=Hi.a(Ha)}return R};ma.prototype.Ac=function(R,Ha){R=!1;switch(Ha.command){case 843847158:case -2025863019:case -1777565636:case 1592314317:case Bg.a.Tma:case Bg.a.TQd:case Bg.a.refreshAddinCommands:case 1949669462:case Bg.a.fBb:case -1014260128:R=
!0;break;case Bg.a.m2:R=!gf.AFrameworkApplication.protectedFile}return R};ma.prototype.Qc=function(){return!1};ma.prototype.kLh=function(R){if(!R)return Od.ULS.sendTraceTag(528098432,220,10,"Failed to get button id for addin"),null;if((R=R.XV)&&R.Ds&&0<R.Ds.count){R=ak(R.Ds);for(var Ha=R.next();!Ha.done;Ha=R.next()){Ha=Ha.value;if(Ha.groups&&1===Ha.groups.length){var Gb=Ha.groups[0];if(Gb.controls&&1===Gb.controls.length){var bc=Gb.controls[0];if(bc.attributes&&!bc.controlType&&bc.enabled)return bc.id}Gb.controls&&
Od.ULS.sendTraceTag(528098403,220,15,"It has multiple buttons")}Ha.groups&&Od.ULS.sendTraceTag(528098402,220,15,"It has multiple groups")}}return null};ma.prototype.U6i=function(){if(this.Nga.Vsd()){this.Nga.Ixe();var R=this.gcd();if(R&&0<R.count){R=ak(R);for(var Ha=R.next();!Ha.done;Ha=R.next()){var Gb={};Ha=(Gb[bf.a.Mga]=Ha.value,Gb[bf.a.yT]=4,Gb[bf.a.JFa]=(new Date).getTime(),Gb);this.Tma(Ha)}}}};ma.prototype.Tma=function(R){var Ha=this;Od.ULS.sendTraceTag(537170657,220,50,"Launch AddinCommands entitlements list, LaunchOperationType {0}, DataProvider {1}.",
R[bf.a.yT],R[bf.a.Mga]);this.Nga.woj();window.setTimeout(function(){if(void 0===Ha.te||null===Ha.te)Od.ULS.sendTraceTag(537170656,220,10,String.format("AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: {0}",ti.a.e3()));else{var Gb=new pc(new Fb(Ha.te.ri),ub.instance,Mc.instance);Gb.zDg(function(bc,Rc){Ha.gBb(Rc.properties)});gf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)&&gf.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5837059_TeachingUIForPrivateCatelogOnContentAddinEnabled")&&Gb.TGg(function(bc,Rc){null==Rc?(bc={},bc=(bc.AppTeachingUICalloutAction="InvalidEventArgs",bc.AppTeachingUICalloutGoal="NewAdminDeployment",bc["SDX.AppInstallOrigin"]="Organization",bc),cg.a.sendTelemetryEvent(Object(Qg.a)(new pg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:$f.a.gl(bc)}))):(Ha.V7f=new P(Ha),Ha.V7f.Y8i(Rc),bc=Ha.$.Ka,null!=bc&&(bc.Hne(Object(Hg.a)(Ha,
Ha.r$e,"onTabSwitched")),Od.ULS.sendTraceTag(527286663,220,50,"Register tab switched event")))});Gb.GNj(R)}},0)};ma.prototype.r$e=function(R,Ha){"Insert"==Ha.tabName&&(R=this.$.Ka,null!=R&&(R.lQf(Object(Hg.a)(this,this.r$e,"onTabSwitched")),Od.ULS.sendTraceTag(527286662,220,50,"Remove insertTabSwitched handler")),this.V7f.pBj())};ma.prototype.gBb=function(R){var Ha=this;if(!this.disposed){Od.ULS.sendTraceTag(537170655,220,50,"LaunchOperationType {0}.",R[bf.a.yT]);try{if(Ve.EwaSettings.ma(187)){var Gb=
R[bf.a.lnb];if(Gb&&0<Gb.count){for(var bc=Gb.count,Rc=bc-1;0<=Rc;Rc--){var gd=Gb.na(Rc);OSF.OsfControl.isFirstPartyStoreString(gd.storeType)||Gb.remove(Gb.na(Rc))}if(Gb.count<bc){var wd=Kg.GetServiceTaskFactory.Ra(this.$.da,5,4,0);If.TaskExtensions.Ba(wd,function(){wd.result.Jf(35,null)},this.$.la,3)}if(!Gb.count)return}}if(void 0===this.te||null===this.te)Od.ULS.sendTraceTag(537170654,220,10,String.format("LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: {0}",ti.a.e3()));
else{var Ad=null;Ad=gf.AFrameworkApplication.fa.ra("HostInstallAddInsIsEnabled")?new lb(this.Fo,this.ZAe,new Fb(this.te.ri),new oa(this.$.yb,Bg.a.m2),this.Nga,ub.instance,this.Lga,function(ce,me){var Je={};Je.InstanceId=Pj.a.create().toString();Je.PrimaryMarketplace={};Je.PrimaryMarketplace.SolutionId=ce.solutionId;Je.PrimaryMarketplace.SolutionVersion=ce.version;Je.PrimaryMarketplace.MarketplaceType=ce.storeType;Je.PrimaryMarketplace.MarketplaceRef=ce.storeId;Je.WebExtensionType=1;Ha.te.vBj(Je,function(){me(ce)})}):
new lb(this.Fo,this.ZAe,new Fb(this.te.ri),new oa(this.$.yb,Bg.a.m2),this.Nga,ub.instance,this.Lga);Ad.GDg(this.sGi);Ad.ADg(this.RNi);if(gf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)){var Ld=new P(this);Ad.qFg(Ld.QNi);Ad.SGg(Ld.Vyj)}this.$.da.za(53).Ql&&Zi.a.get_instance().ak(5,null).continueWith(function(){Ha.disposed||Ad.iri(Ha.Y9c,Ha.$.domElement,R)})}}catch(ce){Od.ULS.sendTraceTag(537170653,220,10,String.format("LaunchAddinCommands error message : {0}.",
ce.message))}}};ma.prototype.dhd=function(R){var Ha=If.TaskExtensions.jk();R=R[this.Fo.Rha];var Gb=this.GZb.gje(R),bc=new ri.a(this.$,this.te,Gb.ownerAddinInfo,Ha);return this.d4e(Ha,R,Gb,bc)};ma.prototype.d4e=function(R,Ha,Gb,bc){var Rc=this;this.GZb.dhd(Ha,this.Nga,bc,new Fb(this.te.ri),Gb,function(){R=bc.y1g()},function(){qg.g(Rc.$).focus()});return R};ma.prototype.WMg=function(R){var Ha=this,Gb=If.TaskExtensions.jk(),bc=this.te.qaa(R.solutionId);if(bc){var Rc=this.te.iZ(bc);if(si.HelperMethods.iw(Rc)&&
0!==Rc.SharedRuntime.State)return}Rc=this.GZb.XMg;var gd=R.solutionId in Rc?Rc[R.solutionId]:null;if(gd){var wd=this.GZb.gje(gd),Ad=new ri.a(this.$,this.te,wd.ownerAddinInfo,Gb);Rc=function(ce){if(ce){var me={};ce=ak(ce);for(var Je=ce.next();!Je.done;Je=ce.next())Je=Je.value,me[Je[0]]=Je[1];(me=bf.a.One in me?me[bf.a.One]:null)&&"true"===me.toLowerCase()&&(Od.ULS.sendTraceTag(537170652,220,50,"Auto-Show AddinCommands TaskPane, StoreType {0}, StoreId {1}, SolutionId {2}.",R.storeType,R.storeId,Telemetry.PrivacyRules.GetPrivacyCompliantId(R.solutionId,
null!==wd.ownerAddinInfo?wd.ownerAddinInfo.storeType:R.storeType,R.assetId,null,null,R.storeId)),Ha.d4e(Gb,gd,wd,Ad))}};Od.ULS.sendTraceTag(537170651,220,50,"Check Auto-Show AddinCommands TaskPane, StoreType {0}, StoreId {1}, SolutionId {2}.",R.storeType,R.storeId,Telemetry.PrivacyRules.GetPrivacyCompliantId(R.solutionId,null!==wd.ownerAddinInfo?wd.ownerAddinInfo.storeType:R.storeType,R.assetId,null,null,R.storeId));if(bc)Rc(this.te.iZ(bc).OsfPropertyBag);else if(bc=this.$.ea.workbookContext.WebExtensions){bc=
ak(bc);for(var Ld=bc.next();!Ld.done;Ld=bc.next())if(Ld=Ld.value,(1===Ld.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent)===R.targetType&&Ld.PrimaryMarketplace.MarketplaceType.toLowerCase()===R.storeType.toLowerCase()&&Ld.PrimaryMarketplace.MarketplaceRef.toLowerCase()===R.storeId.toLowerCase()&&Ld.PrimaryMarketplace.SolutionId.toLowerCase()===R.solutionId.toLowerCase()){Rc(Ld.OsfPropertyBag);break}}}};ma.prototype.iUd=function(R,Ha,Gb){R&&(void 0===Gb||!Gb||Ha||this.b5c.contains(R)||
this.b5c.add(R),(Gb=this.h1a.contains(R))&&Ha&&this.h1a.remove(R),Gb||Ha||this.h1a.add(R))};ma.prototype.fsj=function(R){if((R=R.XV)&&R.Ds){R=ak(R.Ds);for(var Ha=R.next();!Ha.done;Ha=R.next())if(Ha=Ha.value,Ha.groups){Ha=ak(Ha.groups);for(var Gb=Ha.next();!Gb.done;Gb=Ha.next())if(Gb=Gb.value,Gb.controls){Gb=ak(Gb.controls);for(var bc=Gb.next();!bc.done;bc=Gb.next())if(bc=bc.value,this.iUd(bc.id,bc.enabled,!0),1===bc.controlType&&bc.menuItems){bc=ak(bc.menuItems);for(var Rc=bc.next();!Rc.done;Rc=bc.next())Rc=
Rc.value,this.iUd(Rc.id,Rc.enabled,!0)}}}}};ma.prototype.gcd=function(){var R=new $e.a;Ve.EwaSettings.ma(54)&&(this.$.ea.Kg.get(27)&&(R.add(0),R.add(16)),this.$.ea.Kg.get(33)&&R.add(1),R.add(8));return R};ma.prototype.executeDynamicAddInCommandsAPI=function(R){var Ha=!0;if(void 0===R||null===R||void 0===R[bf.a.wsb]||null===R[bf.a.wsb])return wh.Task.Ua(!1);switch(R[bf.a.wsb]){case 1:Ha=this.LQj(R);break;case 2:Ha=this.jsj(R);break;case 4:this.h1a.clear();this.h1a.addRange(this.b5c);break;case 3:Ha=
this.installContextualTab(R);break;default:Ha=!1}return wh.Task.Ua(Ha)};ma.prototype.awj=function(R){return R&&this.Fo.Rha in R?(R=R[this.Fo.Rha])?this.h1a.contains(R):!1:!1};ma.prototype.LQj=function(R){var Ha=null,Gb=null,bc=null,Rc=!0;void 0!==R[bf.a.D3]&&null!==R[bf.a.D3]&&void 0!==R[this.Fo.Rha]&&null!==R[this.Fo.Rha]&&void 0!==R[bf.a.C3]&&null!==R[bf.a.C3]&&(Ha=R[bf.a.D3],Gb=R[bf.a.i7b],bc=R[this.Fo.Rha],Rc=R[bf.a.C3]);if(!Ha||!bc)return Od.ULS.sendTraceTag(537170649,220,15,"UpdateControlEnableState failed to get solutionId or controlId."),
!1;R=(new bj.a(this.$.yb,Ha,this.Fo,!0)).JJa(bc);Ha={DynamicAddinCommandsApiName:"UpdateControlEnableState"};Ha.AssetId=Gb;Ha.MaskedTabId=R;Ha.IsToEnable=Rc;Od.ULS.sendTraceTag(537170648,220,50,kf.a.xc(Ha));this.iUd(R,Rc);cj.a.Iy.updateCommandUI();return!0};ma.prototype.jsj=function(R){var Ha,Gb,bc=null,Rc=null,gd=null,wd=null,Ad=!0;void 0!==R[bf.a.G6c]&&null!==R[bf.a.G6c]&&void 0!==R[bf.a.D3]&&null!==R[bf.a.D3]&&void 0!==R[this.Fo.Rha]&&null!==R[this.Fo.Rha]&&void 0!==R[bf.a.C3]&&null!==R[bf.a.C3]&&
(bc=R[bf.a.G6c],Rc=R[bf.a.D3],gd=R[bf.a.i7b],wd=R[this.Fo.Rha],Ad=R[bf.a.C3]);if(!bc||!Rc||!wd)return Od.ULS.sendTraceTag(537170647,220,15,"SetRibbonTabVisible failed to get storeType or solutionId or tabId."),!1;R=(new bj.a(this.$.yb,Rc,this.Fo,!0)).h2e(wd);wd={DynamicAddinCommandsApiName:"SetRibbonTabVisible"};wd.StoreType=bc;wd.AssetId=gd;wd.MaskedTabId=R;wd.IsToShow=Ad;Od.ULS.sendTraceTag(537170646,220,15,kf.a.xc(wd));Rc=this.Nga.Kia(bc,Rc,1);bc=!1;if(null===(Gb=null===(Ha=null===Rc||void 0===
Rc?void 0:Rc.xo)||void 0===Ha?void 0:Ha.XV)||void 0===Gb?0:Gb.Ds)for(Ha=ak(Rc.xo.XV.Ds),Gb=Ha.next();!Gb.done;Gb=Ha.next())if(Gb.value.id===R){bc=!0;break}if(!bc)return Od.ULS.sendTraceTag(537170645,220,15,"SetRibbonTabVisible failed to get contextual tabs"),!1;Ha=[];Ad?appChrome.selectors.getSelectedTabId()!==R&&Ha.push(appChrome.actions.activateRibbonTab(R)):(appChrome.selectors.getSelectedTabId()===R&&Ha.push(appChrome.actions.setCurrentTab(rh.a.tW)),Ha.push(appChrome.actions.deactivateRibbonTab(R)));
appChrome.api.dispatch(Ha);return!0};ma.prototype.installContextualTab=function(R){var Ha=null,Gb=null,bc=null,Rc=null;if(void 0!==R[bf.a.D3]&&null!==R[bf.a.D3]&&void 0!==R[bf.a.C3]&&null!==R[bf.a.C3]){var gd=R[bf.a.C3];Ha=R[bf.a.D3];void 0!==gd[bf.a.sIa]&&null!==gd[bf.a.sIa]&&void 0!==gd[bf.a.tIa]&&null!==gd[bf.a.tIa]&&(Gb=gd[bf.a.sIa],bc=gd[bf.a.tIa],Rc=gd[bf.a.H6c])}if(!(Ha&&bc&&Gb&&Rc))return Od.ULS.sendTraceTag(537170644,220,15,"InstallContextualTab failed to invalid parameters"),!1;R=this.Nga.Kia(Rc.PrimaryMarketplace.MarketplaceType,
Rc.PrimaryMarketplace.SolutionId,1);if(null===R||void 0===R?0:R.xo)return Od.ULS.sendTraceTag(537170643,220,15,"InstallContextualTab was called multiple times"),!1;R={};R.solutionId=Rc.PrimaryMarketplace.SolutionId;R.version=Rc.PrimaryMarketplace.SolutionVersion;R.storeType=Rc.PrimaryMarketplace.MarketplaceType;R.storeId=Rc.PrimaryMarketplace.MarketplaceRef;R.assetId=Rc.PrimaryMarketplace.SolutionId;R.assetStoreId=Rc.PrimaryMarketplace.MarketplaceRef;R.targetType=Rc.WebExtensionOsfControlType;R.width=
Rc.TaskpaneWidth;R.height=0;R.isAddinCommands=!0;Rc=new $e.a;Rc.add(R);R={};R[bf.a.lnb]=Rc;R[bf.a.yT]=6;R[bf.a.sIa]=Gb;R[bf.a.tIa]=bc;this.gBb(R);return!0};Object(Cd.a)(ma,"AddinUICommandHandler",null,[843,403,10]);var Rf=b(68),Rj=b(696),Sj=b(19),dj=b(17),ej=Hh.a;Rk(zb,ej);zb.prototype.zd=function(){var R=this;Od.ULS.sendTraceTag(38410432,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");Rf.a(this.$).add(Object(Qg.a)(new Rj.a,{Cwc:function(){var Ha=R.$.ea.gF&&R.$.ea.dc&&!!(R.$.Bd&16384)&&
R.$.isEditMode;R.$.ea.dc&&Od.ULS.sendTraceTag(38410433,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate [{0}] IsSessionFullyLoaded [{1}] IsSessionActive [{2}] ShowCommandUI [{3}] IsEditMode [{4}]",Ha,R.$.ea.gF,R.$.ea.dc,!!(R.$.Bd&16384),R.$.isEditMode);return Ha},QXb:this.szg,B5b:this.Kbh,stb:2}))};zb.prototype.E7i=function(R){var Ha=this,Gb=Kg.GetServiceTaskFactory.create(this.$.da,102,this.la,this.hb);return If.TaskExtensions.Ba(Gb,function(){Od.ULS.sendTraceTag(38942483,
0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");Ha.$.da.Ga(204,new Ie(Gb.result,R))},this.la,3)};zb.ka=function(R){Hh.a.Qd(199,new zb(R))};Object(Cd.a)(zb,"AddinUICommandHandlerFactory",Hh.a,[]);var yj=b(1397),zj=b(1401),Aj=We.a;Rk(nb,Aj);nb.prototype.create=function(){var R=this,Ha;if(Ve.EwaSettings.ma(402)){var Gb=Kg.GetServiceTaskFactory.create(this.$.da,106,this.$.la,this.hb),bc=Kg.GetServiceTaskFactory.create(this.$.da,396,this.$.la,
this.hb);If.TaskExtensions.Ba(wh.Task.qL(Gb,bc),function(){R.pb(R.$.da.za(278)||new yj.CustomFunctionsInstaller(R.$,Gb.result,bc.result))},this.$.la,3)}else(Ha=this.$.da.za(278))||(Ha=this.$.da.Ga(278,new zj.CustomFunctionsLegacyInstaller(this.$))),this.pb(Ha)};nb.ka=function(R){R.da.Ga(279,new nb(R))};Object(Cd.a)(nb,"CustomFunctionsInstallerFactory",We.a,[]);var fj=b(90),Bj=b(47),Tj=b(44);wc.prototype.ka=function(R){this.WWc?Od.ULS.sendTraceTag(537170629,0,10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times."):
(this.WWc=!0,this.APa={},this.BPa={},R?R.jEg(this.j$f):Od.ULS.sendTraceTag(537170628,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object."))};wc.prototype.detach=function(R){if(R){R.Eaj(this.j$f);R=this.APa;for(var Ha in R)fj.a.Ia(R[Ha]);this.BPa=this.APa=null;this.WWc=!1}else Od.ULS.sendTraceTag(537170627,0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.")};wc.prototype.RLf=function(R,Ha,Gb){if(this.jei(Gb,R))return!1;R=Ha.querySelector("iframe");
if(!R)return Od.ULS.sendTraceTag(537170595,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;R=R.title;if(!R||!R.length)return Od.ULS.sendTraceTag(537170594,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;this.ariaLiveNotifier.readText(R);return!0};wc.prototype.jei=function(R,Ha){return(R=R.ri.getOsfControl(Ha))?R.getPageStatus()!==OSF.OsfControlPageStatus.Ready:!0};Object(Cd.a)(wc,"AgaveOnSelectedReadoutHandler",null,[835]);var Ii=
We.a;Rk(db,Ii);db.prototype.create=function(){var R=this,Ha=this.$.da;If.TaskExtensions.Ba(Kg.GetServiceTaskFactory.Ra(Ha,211,212,this.hb),function(Gb){Gb=Ha.za(224)||new wc(Gb.result,R.$);R.pb(Gb)},this.la,3)};db.ka=function(R){R.da.Ga(225,new db(R))};Object(Cd.a)(db,"AgaveOnSelectedReadoutHandlerFactory",We.a,[]);var Xg=b(946),Ji=b(53),Uj=b(247);dc.prototype.j5e=function(R){try{if(R&&R.rawEvent&&R.rawEvent.origin&&this.iframe&&this.iframe.id){var Ha=this.hFf(R.rawEvent.origin),Gb=this.hFf(document.domain);
if(fg.a.Jk().equals(Gb,Ha))if(R.rawEvent.source&&R.rawEvent.source.frameElement&&R.rawEvent.source.frameElement.id&&fg.a.Jk().equals(R.rawEvent.source.frameElement.id,this.iframe.id)){Ha=null;try{Ha=JSON.parse(R.rawEvent.data)}catch(bc){Od.ULS.sendTraceTag(39112971,344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",bc.message)}Ha?(Ha.statusCode!==Uj.a.TO||void 0!==Ha.error&&Ha.error?(Od.ULS.sendTraceTag(23707648,344,50,
"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",Ha.statusCode,Ha.error),this.onError()):(Od.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.onSuccess(Ha.authorizationCode?Ha.authorizationCode:Ha.signInUrl)),$removeHandler(window,"message",Object(Hg.a)(this,this.j5e,"handleResponse")),this.iframe?document.body.contains(this.iframe)?document.body.removeChild(this.iframe):Od.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):
Od.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):Od.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else Od.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");else Od.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else Od.ULS.sendTraceTag(51418200,
344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(bc){Od.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",bc.message)}};dc.prototype.hFf=function(R){var Ha="";try{R&&(Ha=-1<R.indexOf("//")?R.split("/")[2]:R.split("/")[0])&&(Ha=Ha.split(":")[0],Ha=Ha.split("?")[0])}catch(Gb){Od.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",Gb.message)}return Ha};dc.ka=function(R,Ha,Gb){new dc(R,Ha,Gb)};Object(Cd.a)(dc,
"ResponseHandler",null,[]);var gj=b(262);qb.prototype.tryAuthenticate=function(R,Ha){this.w$a(qb.Rpg,function(){R()},Ha)};qb.prototype.tryAuthorize=function(R,Ha){this.w$a(qb.Nkg,R,Ha)};qb.prototype.getSignInUrl=function(R,Ha){this.w$a(qb.dge,R,Ha)};qb.prototype.signOut=function(R,Ha){this.w$a(qb.iwg,R,Ha)};qb.prototype.w$a=function(R,Ha,Gb){var bc=new gj.QueryStringBuilder("AuthenticationProxyHandler.aspx");bc.Ii("responseType",R);gf.AFrameworkApplication.cYa(bc);bc=String.format("{0}{1}&{2}",this.eFa,
bc.toString(),gf.AFrameworkApplication.aj);var Rc=document.createElement("iframe");Rc.setAttribute("id","privateCatalogIframe");Rc.setAttribute("name","privateCatalogIframe");Rc.setAttribute("style","display: none");fg.a.Jk().equals(R,qb.dge)||Rc.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");dc.ka(Rc,Ha,Gb);Rc.setAttribute("src",bc);document.body.appendChild(Rc)};qb.Nkg="authcode";qb.Rpg="identitytoken";qb.dge="signinurl";qb.iwg="signout";Object(Cd.a)(qb,
"AuthenticationProxy",null,[]);yb.getUserId="getUserId";yb.getLastStoreUpdate="laststoreupdate";yb.getEntitlement="getEntitlements";yb.getEToken="getEToken";yb.getManifest="getManifest";yb.getAppState="getAppState";yb.getKilledApps="getRemovedAddins";yb.getAppDetails="getAppDetails";yb.removeApps="removeAddin";yb.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";yb.getPrivateCatalogAddIns="getAddIns";yb.getPrivateCatalogManifests="getAppManifests";yb.isStoreDisabled="isStoreDisabled";Object(Cd.a)(yb,
"S2SWebRequestActions",null,[]);var ji=b(640);Va.prototype.getUserId=function(R,Ha){var Gb=new $e.a;Gb.add(new dg.a("corr",R));this.XW(yb.getUserId,Gb,1,Ha)};Va.prototype.getLastStoreUpdate=function(R,Ha,Gb){var bc=new $e.a;bc.add(new dg.a("lc",R));bc.add(new dg.a("corr",Ha));this.XW(yb.getLastStoreUpdate,bc,1,Gb)};Va.prototype.getEntitlement=function(R,Ha,Gb,bc){R=new $e.a;R.add(new dg.a("av",Ha));R.add(new dg.a("corr",Gb));this.XW(yb.getEntitlement,R,1,bc)};Va.prototype.getEToken=function(R,Ha,
Gb,bc,Rc,gd){var wd=new $e.a;wd.add(new dg.a("cmu",R));wd.add(new dg.a("cmf",Ha));wd.add(new dg.a("assetid",Gb));wd.add(new dg.a("expver",bc));wd.add(new dg.a("corr",Rc));this.XW(yb.getEToken,wd,1,gd)};Va.prototype.getManifest=function(R,Ha,Gb,bc){var Rc=new $e.a;Rc.add(new dg.a("cmu",R));Rc.add(new dg.a("assetid",Ha));Rc.add(new dg.a("corr",Gb));this.XW(yb.getManifest,Rc,1,bc)};Va.prototype.getAppState=function(R,Ha,Gb){var bc=new $e.a;bc.add(new dg.a("ma",R));bc.add(new dg.a("corr",Ha));this.XW(yb.getAppState,
bc,1,Gb)};Va.prototype.getKilledApps=function(R,Ha){var Gb=new $e.a;Gb.add(new dg.a("corr",R));this.XW(yb.getKilledApps,Gb,1,Ha)};Va.prototype.getAppDetails=function(R,Ha,Gb,bc){var Rc=new $e.a;Rc.add(new dg.a("cmo",R));Rc.add(new dg.a("corr",Gb));this.sendWithBody(yb.getAppDetails,Rc,Ha,2,bc,!1)};Va.prototype.removeApps=function(R,Ha,Gb){var bc=new $e.a;bc.add(new dg.a("corr",Ha));this.sendWithBody(yb.removeApps,bc,R,2,Gb,!1)};Va.prototype.getLastPrivateCatalogUpdate=function(R,Ha,Gb,bc,Rc,gd){var wd=
new $e.a;wd.add(new dg.a("catalog","privatecatalog"));wd.add(new dg.a("clientCode",R));wd.add(new dg.a("clientVersion",Ha));wd.add(new dg.a("corr",Rc));R=String.format("authorizationCode={0}&refreshToken={1}",Gb?vh.a.$e(Gb):"",bc?vh.a.$e(bc):"");this.sendWithBody(yb.getLastPrivateCatalogUpdate,wd,R,2,gd,!0)};Va.prototype.getPrivateCatalogAddIns=function(R,Ha,Gb,bc,Rc,gd){var wd=new $e.a;wd.add(new dg.a("catalog","privatecatalog"));wd.add(new dg.a("clientCode",R));wd.add(new dg.a("clientVersion",Ha));
wd.add(new dg.a("corr",Rc));R=String.format("authorizationCode={0}&refreshToken={1}",Gb?vh.a.$e(Gb):"",bc?vh.a.$e(bc):"");this.sendWithBody(yb.getPrivateCatalogAddIns,wd,R,2,gd,!0)};Va.prototype.getPrivateCatalogManifests=function(R,Ha,Gb,bc,Rc){var gd=new $e.a;gd.add(new dg.a("catalog","privatecatalog"));gd.add(new dg.a("corr",bc));R=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",vh.a.$e(R),Ha?vh.a.$e(Ha):"",Gb?vh.a.$e(Gb):"");this.sendWithBody(yb.getPrivateCatalogManifests,
gd,R,2,Rc,!0)};Va.prototype.isStoreDisabled=function(R,Ha){var Gb=new $e.a;Gb.add(new dg.a("corr",R));this.XW(yb.isStoreDisabled,Gb,2,Ha)};Va.prototype.XW=function(R,Ha,Gb,bc){this.sendWithBody(R,Ha,null,Gb,bc,!1)};Va.prototype.sendWithBody=function(R,Ha,Gb,bc,Rc,gd){var wd=new gj.QueryStringBuilder("AddinServiceHandler.ashx");wd.Ii("action",R);wd.Ii("app",ji.a[gf.AFrameworkApplication.ta.Pa.Fj]);Ha=ak(Ha);for(var Ad=Ha.next();!Ad.done;Ad=Ha.next())Ad=Ad.value,wd.Ii(Ad.key,Ad.value);wd=String.format("{0}{1}&{2}",
gf.AFrameworkApplication.ta.Pa.QV,wd.toString(),gf.AFrameworkApplication.aj);gf.AFrameworkApplication.qd.Yl(wd,bc,Gb,null,!1,2,function(Ld){var ce=null,me=null;Ld&&Ld.data&&(Ld.data.responseHeaders["X-BlockedForMinor"]&&"1"===Ld.data.responseHeaders["X-BlockedForMinor"].toString()&&(Ld.data.httpStatus=451),ce=Ld.data.Ud,me=Ld.data.responseHeaders);Rc(Ld.data.httpStatus,ce,me)},function(Ld){var ce=null,me=null;gd&&Ld&&Ld.data&&Ld.data.Ud&&(ce=Ld.data.Ud,me=Ld.data.responseHeaders);Rc(Ld.data.httpStatus,
ce,me);if(gf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){ce={message:"AddinServiceHandler request failed"};ce.code=Ld.data.httpStatus;ce.action=R;if(Ld.data.request||Ld.data.request.get_headers())ce["X-UserSessionId"]=Ld.data.request.get_headers()["X-UserSessionId"];408===Ld.data.httpStatus||503===Ld.data.httpStatus?Od.ULS.sendTraceTag(538784582,220,10,JSON.stringify(ce)):Od.ULS.sendTraceTag(18392345,220,50,JSON.stringify(ce))}else Od.ULS.sendTraceTag(538736349,
220,50,"S2S web request failed with {0}.",Ld.data.httpStatus)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+R,void 0,void 0,void 0,void 0,["X-UserKey"])};Object(Cd.a)(Va,"S2SWebRequestManager",null,[]);var jh=We.a;Rk(Db,jh);Db.prototype.create=function(){var R=this;Od.ULS.sendTraceTag(537170507,0,50,"DdaFacadeServiceFactory:Create.");gf.AFrameworkApplication.disableWholeAppsForOfficeFeature?Od.ULS.sendTraceTag(537170506,0,50,"DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [{0}]",
gf.AFrameworkApplication.disableWholeAppsForOfficeFeature):Ve.EwaSettings.ma(406)?Rg.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Ha){Ha.isFeatureEnabled("mso_officeStore",!0).then(function(Gb){Xg.DdaFacade.X1c=Gb;R.hDe();return null})}):this.hDe()};Db.prototype.hDe=function(){var R=this,Ha=Kg.GetServiceTaskFactory.Ra(this.$.da,224,225,this.hb),Gb=Ji.a.Rsd(63,function(){return!(void 0===window.OSF||null===window.OSF)},this.$.ya.MaxRetriesForLoadingScript,
this.$.la,this.hb,106),bc=bb(this.la,this.hb);If.TaskExtensions.Ba(If.TaskExtensions.Wd([Ha,Gb,bc],this.$.la),function(){"undefined"===typeof OfficeExt||"undefined"===typeof OSF?Od.ULS.sendTraceTag(537170505,0,15,"DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: {0}",ti.a.e3()):R.y9h();Od.ULS.sendTraceTag(537170504,0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");R.QLf=Ha.result;R.pb(R.te);Od.ULS.sendTraceTag(537170503,
0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.la,3)};Db.prototype.y9h=function(){Ve.EwaSettings.ma(65)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new Va);this.$.Lf.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new Va,new qb(gf.AFrameworkApplication.fa.appSettings.WebServiceBase),Ve.EwaSettings.ma(72),Ve.EwaSettings.ma(433));OfficeExt.MosRequestHandler.init&&OfficeExt.MosRequestHandler.init(new Va)};Db.prototype.dispose=function(){fj.a.Ia(this.ddaFacade);this.$=
this.ddaFacade=null;jh.prototype.dispose.call(this)};Db.ka=function(R){new Db(R)};Af.Object.defineProperties(Db.prototype,{te:{configurable:!0,enumerable:!0,get:function(){return this.ddaFacade||(this.ddaFacade=new Xg.DdaFacade(this.$,this.QLf))}}});Object(Cd.a)(Db,"DdaFacadeServiceFactory",We.a,[]);var ei=b(493);gb.prototype.Qc=function(){return!1};gb.prototype.Lc=function(){return!1};gb.prototype.Ac=function(R,Ha,Gb,bc){var Rc=!1;switch(Ha.command){case -684355545:Rc=!0;break;case -741808261:Rc=
!!Gb;break;case -859308420:Rc=!!bc&&1===bc.tx;break;case 418618014:Rc=1===R&&!!bc&&1===bc.tx;break;case -515602470:Ha=Ve.EwaSettings.ma(235)&&2===R;Rc=(1===R||Ha)&&!!bc&&1===bc.tx;break;case 2086613372:Rc=Ve.EwaSettings.ma(235)&&2===R&&!!bc&&1===bc.tx;break;case -1336341324:Rc=Ve.EwaSettings.ma(481)&&1===R&&!!bc&&1===bc.tx;break;case 451940422:Rc=Ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AnalyzeDataInAutoFilter",!1)&&1===R&&!!bc&&1===bc.tx;break;case -1444574190:case -336193495:Rc=
1===R&&!!bc&&1===bc.tx;break;case 1296389134:Rc=1===R&&!!bc&&1===bc.tx;break;case -1473679467:Rc=Ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&1===R&&!!bc&&1===bc.tx;break;case 1221897806:Rc=Ve.EwaSettings.ma(167)&&2===R;break;case 1172793074:case 1930653487:Rc=Ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&2===R;break;case -1753056834:Rc=Ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",
!1);break;case 932597253:Rc=!0;break;case 301511274:Rc=Ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavigationPaneWeb",!1);break;case 515196233:Rc=Ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammer",!1)&&this.$.isEditMode;break;case 1723441034:Rc=this.$.isEditMode&&this.$.ea.PKb}return Rc};gb.prototype.executeCommand=function(R,Ha,Gb){var bc=If.TaskExtensions.jk(),Rc=Ha.command;switch(Ha.command){case -1473679467:ei.a(this.$,488,489,1,function(gd){bc=
gd.Abi(Gb.SourceControlId,Ha)});break;case 1296389134:this.agaveCommandManager.sEj(Gb.SourceControlId,Gb.LabelText);break;case -684355545:this.agaveCommandManager.rZc();break;case -741808261:bc=this.agaveCommandManager.insertAgave(Gb,Ha);ei.a(this.$,488,489,1,function(gd){gd.Tzg(Gb)});break;case -1336341324:Ve.EwaSettings.ma(481)&&(bc=this.agaveCommandManager.rhd(Gb,R,Ha));break;case 1172793074:Ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&(bc=this.agaveCommandManager.rhd(Gb,
R,Ha));break;case -859308420:case -515602470:case 2086613372:case -336193495:case -1444574190:case 451940422:case 418618014:case 1221897806:case 1930653487:case -1753056834:case 932597253:case 301511274:case 515196233:case 1723441034:bc=this.agaveCommandManager.rhd(Gb,R,Ha);break;default:bc=Hi.a(Rc)}return bc};Object(Cd.a)(gb,"AgaveCommandHandler",null,[403]);Object(Cd.a)(Ub,"Selection",null,[]);var Ki=b(1505),Ch=b(1504),Li=b(1506),eh=b(1595),vd=b(1507);Object(Cd.a)(Kb,"SmartLookupApplicationInterface",
null,[]);Object(Cd.a)(Hb,"ApplicationProperties",null,[]);Object(Cd.a)(Ma,"EnterpriseUserInfo",null,[]);Object(Cd.a)(fb,"FeatureGates",null,[]);mb.prototype.pXh=function(){var R=void 0===R?!0:R;var Ha=this.tFe();if(Ha<this.pud+this.tKj)return Ha>this.pud+this.wKj&&this.dcd(),this.Smf;R&&this.dcd();return""};mb.prototype.dcd=function(){var R=this;this.sud=this.sud||new Promise(function(Ha){R.qXh().then(function(Gb){R.Smf=Gb;R.pud=R.tFe();R.sud=null;Ha(Gb)})})};mb.prototype.qXh=function(){var R=this;
return this.g8a&&this.g8a.length?new Promise(function(Ha){R.Bxa.EO("SmartLookup",R.g8a).then(function(Gb){Gb.IsSuccess?Gb.Token||(Ha(""),Od.ULS.sendTraceTag(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):(Od.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+Gb.ErrorCode+": "+Gb.ErrorMessage),Ha(""));Ha(Gb.Token)}).catch(function(Gb){Gb=Ih.c(Gb);Od.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+
Gb);Ha("")})}):(Od.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve(""))};Object(Cd.a)(mb,"SmartLookupAuthenticationManager",null,[259]);Ia.tNh=function(){switch(Object(bg.a)(String,gf.AFrameworkApplication.Ob.AudienceGroup)||""){case "Dogfood":if(gf.AFrameworkApplication.fa){var R=gf.AFrameworkApplication.fa.Wa("UserPrincipalName");R=vh.a.rl(R);var Ha=gf.AFrameworkApplication.fa.co("SmartLookupINTEnabledForSKITeam")?gf.AFrameworkApplication.fa.gw("SmartLookupINTEnabledForSKITeam"):
[];return 0<=Array.indexOf(Ha,R)?"INT":"EDOG"}return"EDOG";default:return"PROD"}};Ia.NWh=function(){switch(gf.AFrameworkApplication.fa.ra("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":gf.AFrameworkApplication.fa.ra("IntentSvcEnableProdSourceLocationOverride")?"PROD":gf.AFrameworkApplication.fa.ra("IntentSvcEnableIntSourceLocationOverride")?"INT":Ia.tNh()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";
default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}};Object(Cd.a)(Ia,"Utils",null,[]);var $d=b(619),hj=b(178);La.prototype.ZHh=function(){return Promise.resolve(this.$Hh())};La.prototype.$Hh=function(){var R=new Hb;R.anid="";R.applicationVersion=gf.AFrameworkApplication.buildVersion;R.appCorrelationId=hj.a.create().toString();R.themePlatform=La.DWj;R.lcid=gf.AFrameworkApplication.lcid;R.launchUtcTime=(new Date).toUTCString();R.featureGates=this.f8a;var Ha=$d.a.cH(gf.AFrameworkApplication.lcid);
Ha=Ha?Ha.name:null;R.market=this.tac(Ha);R.uiLanguage=Ha;R.sessionId=gf.AFrameworkApplication.userSessionId;R.themeId=0;R.parentalControl=La.vWi;var Gb=new Ma;Gb.CountryCode=this.tac(Ha);Gb.ServiceEndpoint=this.g8a;Gb.IsGoLocal=!1;Gb.IsEnabled=this.ynf;Gb.IsEnterpriseEnabled=this.ynf;Gb.TenantRoot=this.vxi;R.enterpriseUserInfo=Gb;R.accessToken=this.pxi.pXh();return R};La.prototype.tac=function(R){R=R.split("-");return R[R.length-1]};Af.Object.defineProperties(La.prototype,{approvedOriginPattern:{configurable:!0,
enumerable:!0,get:function(){return this.Qwi}}});La.DWj="web";La.vWi="yes";Object(Cd.a)(La,"SmartLookupManager",null,[220]);var ki=bi.a;Rk(W,ki);W.prototype.Qc=function(){return!1};W.prototype.Lc=function(){return!1};W.prototype.Ac=function(R,Ha){R=Ve.EwaSettings.ma(135);return-983891024===Ha.command&&R};W.prototype.executeCommand=function(R,Ha){R=If.TaskExtensions.jk();-983891024===Ha.command&&this.Sqi();return R};W.prototype.Sqi=function(){var R=this,Ha=new La(null),Gb={},bc=qg.g(this.$).Ub(null).originalText;
bc=Object(Qg.a)(new Ub,{neighborhood:bc,mentionStart:0,mentionLength:bc?bc.length:0});var Rc=Object(Qg.a)(new Kb,{selection:bc,entryPoint:0});Ha.ZHh().then(function(wd){wd.applicationName=W.appName;wd.isFirstLaunch=R.isFirstLaunch;wd.themeId=5;Gb[W.smartLookupApplicationInterface]=JSON.stringify(Rc);Gb[W.CJg]=JSON.stringify(wd);R.isFirstLaunch=!1});Ha=new Ki.a("ExcelOnline","Web","en-Us");bc=new Ch.a("FA000000006",OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0");var gd=new Li.a;gd.optionalProperties[eh.a.Rk]=
og.a.instance.ga(1785);gd.optionalProperties[eh.a.taskPaneWidth]=350;gd.optionalProperties[eh.a.sourceLocationOverrideResourceId]="WAC.PROD.URL";gd.nq=Gb;vd.a.instance.bNa(bc,"Taskpane","SmartLookupSDXTaskpane",Ha,gd)};W.CJg="AppProperties";W.appName="Excel";W.smartLookupApplicationInterface="SmartLookupApplicationInterface";Object(Cd.a)(W,"SmartLookupCommandHandler",bi.a,[403]);var ij=Hh.a;Rk(va,ij);va.prototype.zd=function(){var R=this;ei.a(this.$,374,375,this.hb,function(Ha){R.jd([new gb(R.$,null,
null,null,null,Ha),new W(R.$)])})};va.ka=function(R){Hh.a.Qd(76,new va(R))};Object(Cd.a)(va,"AgaveCommandHandlerFactory",Hh.a,[]);Object(Cd.a)(ya,"AppsDataManager",null,[218]);var jj=b(1519),Sh=b(107);sa.prototype.initialize=function(R){sa.initialized||(this.te=R,this.Cg(),sa.initialized=!0)};sa.prototype.Cg=function(){gf.AFrameworkApplication.ub.Ie(Bg.a.cab,Sh.a.frame,this.cab,96);gf.AFrameworkApplication.ub.Mb(Bg.a.u7i,Sh.a.frame,this.C8i)};Af.Object.defineProperties(sa,{instance:{configurable:!0,
enumerable:!0,get:function(){sa.Ma||(sa.Ma=new sa);return sa.Ma}}});sa.Ma=null;sa.initialized=!1;Object(Cd.a)(sa,"AgaveCommandActor",null,[]);var xh=b(1562),fi=b(1509),Jh=b(113),Mi=b(370),Cj=b(367),Vj=b(1443),Ig=b(18),Ni=b(358);Object(Cd.a)(ba,"FirstPartyAddinTaskpaneOverrides",null,[]);Object(Cd.a)(na,"IdeasSelectionContext",null,[]);Rk(ra,na);Object(Cd.a)(ra,"IdeasTableSelectionContext",na,[]);Object(Cd.a)(function(){this.sheetName=null;this.lastRow=this.firstRow=this.lastColumn=this.firstColumn=
0},"AutoFilterRange",null,[]);Object(Cd.a)(Ea,"IdeasAutoFilterSource",null,[]);var Cg=b(61),Pf=b(1169),li=b(64),ui=b(133),Th=b(45),vi=b(564),Dh=b(389),gi=b(177),rf=b(169),wi=b(629),Mf=b(295),Yg=b(105),oh=b(134),Oi=b(50),mi=b(150),Xh=b(183),ni=mi.a;Rk(la,ni);la.prototype.dD=function(){ni.prototype.dD.call(this);this.vp.style.width=this.B1d;this.vp.style.height=this.QUa;this.vp.style.marginTop=this.bRb;this.vp.style.padding=this.RUa};la.prototype.wPa=function(){this.vp.style.width=this.B1d;this.vp.style.height=
this.QUa;this.vp.style.marginTop=this.bRb;this.vp.style.padding=this.RUa;this.TCa>Xh.a.j$a?(this.Db.style.width=String.format("{0}px",Xh.a.j$a),this.Db.style.overflowX="scroll",gf.AFrameworkApplication.isRtl?this.Db.style.right="0":this.Db.style.left="0"):(this.Db.style.width=String.format("{0}px",this.TCa),this.Db.style.overflowX="hidden");this.Db.offsetHeight>Xh.a.i$a||this.qng+50>Xh.a.i$a?(this.Db.style.height=String.format("{0}px",Xh.a.i$a),this.Db.style.overflowY="scroll",this.Db.style.top="0",
gf.AFrameworkApplication.isRtl?this.Db.style.right="0":this.Db.style.left="0",this.zHc||(this.Db.style.marginTop="-48px"),this.vp.style.minHeight=String.format("{0}px",this.clg)):(this.Db.style.overflowY="hidden",this.Db.style.top="10%",this.Db.style.height=this.Dhb);this.p_a()};la.prototype.p_a=function(){if(this.Db){var R=this.Db.style.zIndex;this.Db.style.zIndex="-9999";if(this.TCa>Xh.a.j$a)gf.AFrameworkApplication.isRtl?this.Db.style.marginRight="0":this.Db.style.marginLeft="0";else{var Ha=String.format("{0}px",
Math.floor(-this.Db.offsetWidth/2));gf.AFrameworkApplication.isRtl?this.Db.style.marginRight=Ha:this.Db.style.marginLeft=Ha;gf.AFrameworkApplication.isRtl?this.Db.style.right="50%":this.Db.style.left="50%"}this.Db.style.zIndex=String(R)}else Od.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")};la.prototype.lO=function(){ni.prototype.lO.call(this);var R=document.getElementById(this.di(this.ong));R.style.width=String.format("{0}px",this.TCa);R.style.height=this.Dhb};Af.Object.defineProperties(la.prototype,
{c1a:{configurable:!0,enumerable:!0,get:function(){return this.vp}}});Object(Cd.a)(la,"AppsForOfficeInsertionDialog",mi.a,[297]);var Eh=b(1170),Dj=b(187),kj=b(638),lj=bi.a;Rk(Ka,lj);Ka.prototype.bFg=function(R){this.addHandler(Ka.xBd,R)};Ka.prototype.obj=function(R){this.removeHandler(Ka.xBd,R)};Ka.prototype.dispose=function(){fj.a.Ia(this.Yva);this.Yva=null;lj.prototype.dispose.call(this)};Ka.prototype.rZc=function(){this.Yva.hide()};Ka.prototype.sEj=function(R,Ha){if(R){this.raiseEvent(Ka.xBd);
var Gb=R.split("|");this.Zui(R,Ha,Gb);this.Yva=new la;this.Yva.initializeAndShow("",null,null);this.te.kri(this.Yva.c1a,Gb)}};Ka.prototype.rhd=function(R,Ha,Gb){var bc=If.TaskExtensions.jk();if(-515602470===Gb.command||-336193495===Gb.command||2086613372===Gb.command||-1444574190===Gb.command||-1336341324===Gb.command||451940422===Gb.command)bc=this.t2h(R,Ha,Gb);418618014===Gb.command&&(Ha=new xh.a,Ha.Rk=og.a.instance.ga(1798),bc=this.s7(Gb,Ka.C5h,Ha,!0));if((Gb.tabName===this.$.yb+rh.a.rTf||Gb.tabName===
rh.a.sW)&&2===Gb.Me||-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback".split(" "),R[dh.a.Nc])||R[dh.a.Nc]===rh.a.JQ)return this.P4e(R,Gb);if(7===Gb.Me&&R.SourceControlId===this.$.yb+rh.a.wcc)return R.MenuItemId=rh.a.kGd,this.P4e(R,Gb);1221897806===Gb.command&&(bc=this.r2f(Gb,"Format"));if(1930653487===Gb.command||1172793074===Gb.command)bc=this.r2f(Gb,"Data");-1753056834===Gb.command&&(bc=this.cAj(Gb));932597253===Gb.command&&(Od.ULS.sendTraceTag(537170445,0,50,"InsertPowerBIPivotTable - addin launch requested"),
Dj.c(932597253,!0),Ha=new xh.a,Ha.Rk=og.a.instance.ga(2133),Ha.sourceLocationOverrideResourceId=Ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIUseDevURL",!1)?Ka.YZi:Ka.$Zi,Ha.focusOnIframeWhenLoaded=!0,Ha.taskPaneWidth=Ka.w8e,bc={},bc.LaunchSource=Object(bg.a)(String,R.SourceControlId),bc.LaunchMode="Default",Ha.UH=bc,bc=this.s7(Gb,Ka.ZZi,Ha,!0));301511274===Gb.command&&(bc=this.mAj(Gb));515196233===Gb.command&&((Ha=this.$.da.za(465))&&Ha.Z6e(),Ha=new xh.a,Ha.Rk=og.a.instance.ga(2203),
bc={},bc.SourceUILocation=Mi.a[Gb.Me],Ha.UH=bc,bc=new Pf.a,bc.s4=Ig.a.a2a,bc=this.s7(Gb,Ka.jVi,Ha,!0,bc,void 0,Ha.Rk));1723441034===Gb.command&&(Ha=new xh.a,Ha.Rk=og.a.instance.ga(2215),Ha.focusOnIframeWhenLoaded=!0,Ha.taskPaneWidth=Ka.T1i,bc=new Pf.a,bc.s4=Ig.a.Voh,bc=this.s7(Gb,kj.a,Ha,!0,bc));Ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)&&R.LoadDataFromPictureTaskpane&&(Ha={},bc=new xh.a,bc.Rk=og.a.instance.ga(2241),Ha.SessionID=R.SessionID,bc.UH=Ha,bc.focusOnIframeWhenLoaded=
!0,bc=this.s7(Gb,R.DataFromPictureAssetId,bc,!0));return bc};Ka.prototype.insertAgave=function(R,Ha){var Gb=this,bc=If.TaskExtensions.jk(),Rc=this.$,gd=R[bf.a.Hra];var wd=R[dh.a.Vf];var Ad=null;Pf.a.key in R&&(Ad=R[Pf.a.key]);this.Yva&&this.Yva.hide();if(!wd||!gd)return Od.ULS.sendTraceTag(537170444,220,10,"Inserting addin needs inserted agave parameters"),bc;this.$.f5&&rh.a.Zda in R&&(wd.EnabledInViewMode=R[rh.a.Zda]);R=this.IKh(Ha.command);if(!wd.EnabledInViewMode&&!Rc.kq(null,!1,R))return bc;var Ld=
void 0===wd.IsToBePersisted||null===wd.IsToBePersisted||wd.IsToBePersisted?0:16;if(1===wd.TargetType)bc=this.Vbi(wd,gd,Ha,Ad,Ld);else{gd=qg.g(Rc);bc=this.viewBlockContainerHelpers.ofb(gd);var ce=Rc.ea.isNamedObjectViewMode?Rc.pa.sheetName:Rc.pa.name;if(bc){gd=bc.Ge;var me=gd.kf.top;var Je=gd.kf.left;var Ue=bc.zI.x;var df=bc.zI.y}else me=Je=1,bc=this.viewBlockContainerHelpers.rKa(gd),Ue=bc.x,df=bc.y;var zf=this.$.oa.xa.Pb();bc=function(Ne,jf,qf){var Df=Rc.oa.xa,Gf=me,Ff=Je,Nf=Ue,Hf=df;Ne=Mf.b(Ne,Gb.PZi);
var Bf=Df.Na(9,zf);Bf.sharedInfo=wd;Bf.sheetName=ce;Bf.positionRow=Gf;Bf.positionCol=Ff;Bf.positionOffsetX=Nf;Bf.positionOffsetY=Hf;return Cg.g(Df,"InsertWebExtension",Bf,Ne,jf,qf,null,0)};Ve.EwaSettings.Zb()?(Ld|=64,bc=Dh.a(this.$.userOperationManager,bc,function(Ne){return new gi.a(534,0,Ne,Ld)},Ha)):bc=Dh.a(this.$.userOperationManager,bc,function(Ne){return new vi.a(534,0,Ne,Ld)},Ha)}return bc};Ka.prototype.r1g=function(){var R=Rg.a.instance.Tb("Common.App.ICustomerFeedbackUiWrapper"),Ha=Rg.a.instance.Tb("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager");
this.l$c?this.l$c.ejb?this.kwe():Ha.instance.p6c(this.oyh):Od.ULS.sendTraceTag(537170443,1302,15,"feedbackFormManager is undefined");Ha={};gf.AFrameworkApplication.fa.Qke(Ha);R=R.instance.getContext(Ha);Ha={};"telemetryGroup"in R&&(Ha=R.telemetryGroup);Ha.processSessionId=R.sessionId;Ha.officeBuild=R.build;R.telemetryGroup=Ha;R.feedbackType=-1;R.userVoiceEnabled=!1;"disableIncludeScreenshot"in R||(R.disableIncludeScreenshot=!1);"screenshot"in R||(R.screenshot=!1);R.disableScreenshotPreview=!1;R.includeScreenshotSelectedDefault=
!0;return R};Ka.prototype.m_i=function(R){if(!this.Xya&&Ve.EwaSettings.getBooleanFeatureGate(Ka.B7h,!1)){var Ha=Ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?"Insights.Https.PPE.Bundle":"Insights.Https.Bundle";Ha=this.Pte(Ha);var Gb=new Pf.a;Gb.Kk=Ig.a.u8b;Gb.s4=Ig.a.hNe;Gb.ceb=Ig.a.F8c;this.Xya=this.ULd(Ha,null,!1,null,Gb);Ha={};oh.b(this.$).Cd(ui.a.n_i,(Ha.Location=Mi.a[R.Me],Ha.InputMethod=Cj.a[R.method],Ha),void 0,!0)}};Ka.prototype.BYf=function(R){var Ha=this.$.ea.Kg.get(17);
Rg.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Gb){Gb.isFeatureEnabled("mso_sendASmile",Ha).then(function(bc){R.FeedbackEnabled=Ha&&bc;return null})})};Ka.prototype.r2f=function(R,Ha){var Gb=qg.g(this.$),bc=new xh.a,Rc={};Rc.ActiveTab=Ha;Rc.DatapaneFlighting=Ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1);Rc.RangePickerFlighting=Ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneDataRangePicker",
!1);Rc.AceFlighting=!0;Rc.ChartNewSDXRecording=Ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OfficeScriptingChartTaskPaneNewRecording",!1);Rc.ThemeColorsFlighting=Ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&Ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5732064_ThemeColorsInChartsTaskpaneEnabled");Rc.UOMirror=Ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UOMirror",!1);Rc.FormatTaskPaneAceButtonDark=Ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneAceButtonDark",
!1);Rc.FormatTaskPaneBetterFeedbackButton=Ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterFeedbackButton",!1);Rc.FormatTaskPaneBetterScrollbar=Ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterScrollbar",!1);this.BYf(Rc);Rc.startTimeMs=Date.now();Rc.UserSessionId=this.$.ya.UserSessionId;(Ha=Gb.ha.Oa.Bo)&&(Rc.SubSelection=Ha);Od.ULS.sendTraceTag(592524688,0,50,"Chart task pane launched. UserSessionId: {0}, UILocation: {1}, SubSelection: {2}",
Rc.UserSessionId,void 0===R.Me||null===R.Me?"Null":Mi.a[R.Me],Ha||"ChartRoot");bc.UH=Rc;bc.Rk=og.a.instance.ga(976);Rc=new Pf.a;Rc.s4=Ig.a.a2a;return this.s7(R,Ka.jWg,bc,!0,Rc)};Ka.prototype.cAj=function(R){var Ha=new xh.a;Ha.UH={};Ha.Rk=og.a.instance.ga(1784);Ha.jS=Ka.Yjf;var Gb=new Pf.a;Gb.s4=Ig.a.a2a;return this.s7(R,Ka.Yjf,Ha,!0,Gb,void 0,Ha.Rk)};Ka.prototype.mAj=function(R){var Ha=new xh.a;Ha.UH={};Ha.Rk=og.a.instance.ga(2157);var Gb=new Pf.a;Gb.s4=Ig.a.Iqh;Gb.ceb=Ig.a.mNe;return this.s7(R,Ka.ACi,
Ha,!0,Gb)};Ka.prototype.P4e=function(R,Ha){var Gb=Ka.T6e,bc=R[dh.a.Nc].toString(),Rc={},gd=new xh.a;gd.Rk=og.a.instance.ga(9);switch(bc){case "A0":Rc.query=(R[dh.a.Vf]||"").split("|").slice(2,Ni.a.yS).join("|");break;case "A1":Rc.query=R.CommandValueId;break;case "Help":Rc.gwdropdownflightinfo=Ve.EwaSettings.ma(240);Rc.query="";break;case rh.a.kGd:Ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?(gd.Rk=og.a.instance.ga(1750),gd.sourceLocationOverrideResourceId=
Ka.C3e,Rc.feedback=this.r1g()):Rc.query=bc;break;case "HelpArticle":Rc.query=R[dh.a.Vf];break;case "ContactSupport":case "ShowTraining":case "WhatsNew":Rc.query=bc;break;default:return wh.Task.Ua(!0)}gd.UH=Rc;bc=new Pf.a;bc.s4=Ig.a.a2a;return this.s7(Ha,Gb,gd,!1,bc,R[rh.a.Zda]||!1)};Ka.prototype.Pte=function(R){var Ha={Version:"0.0.0.0"};Ha.AssetId=Ka.fLa;Ha.SolutionId=Ka.fLa;Ha.AssetStoreId="";Ha.StoreType=OSF.StoreType.Sdx;Ha.Height=0;Ha.Width=0;Ha.StoreId=OSF.StoreType.Sdx;Ha.TargetType=OSF.OsfControlTarget.TaskPane;
Ha.IsToBePersisted=!1;Ha.SourceLocationOverrideResourceId=R;Ha.SharedRuntimeId=R;return Ha};Ka.prototype.t2h=function(R,Ha,Gb){function bc(){Ad.LaunchMode="Default";Ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?gd.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":gd.sourceLocationOverrideResourceId="Insights.Https.Bundle";gd.Rk=og.a.instance.ga(1797);gd.jS=Ka.KVc;gd.Kk=Ig.a.u8b;wd.Kk=Ig.a.u8b}var Rc=this,gd=new xh.a,wd=new Pf.a,Ad={};this.Xya&&this.BYf(Ad);
Ad.LaunchSource="";Ad.StartTimeMs=Date.now();Ad.CorrelationId=hj.a.create().toString();gd.UH=Ad;gd.focusOnIframeWhenLoaded=!0;gd.taskPaneWidth=Ka.w8e;wd.s4=Ig.a.hNe;wd.ceb=Ig.a.F8c;switch(Gb.command){case -1444574190:var Ld,ce;Ad.LaunchMode="RecommendedPivotTables";Ad.SelectionContext="";Ad.LaunchSource="PivotTableHandRaise"===Object(bg.a)(String,R.SourceControlId)?"PivotTableHandRaise":"InsertPivotTable";if(this.$&&Ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4618462_PassSourceSelectionToIdeas")&&
R.SourceSelection){var me=R.SourceSelection.split(",")[0];Ha=Ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4701499_IdeasSelectionIndexing")?-1:0;if(function(){var df=Th.Z(me,Rc.$.va);Ld=df.sheetName;ce=df.JGb;Je=df.range;return df}().returnValue&&!qg.g(this.$).Ab.c5(Je))R=this.$.va.getItemByName(Ld),Ad.SelectionContext=JSON.stringify(Object(Qg.a)(new na,{address:ce,addressWithSheet:Ld+"!"+Je.dB(!1),sheetId:li.d(R),sheetName:Ld,isSheetEmpty:!1,columnCount:Je.width,rowCount:Je.height,columnIndex:Je.left+
Ha,rowIndex:Je.top+Ha,selectionType:"Continuous"}));else if((R=this.$.vb.getItemByName(Object(bg.a)(String,R.SourceSelection)))&&li.n(R)){var Je=rf.a(R,!0);var Ue=this.$.va.getItemByName(R.sheetName);Ad.SelectionContext=JSON.stringify(Object(Qg.a)(new ra,{tableName:R.name,hasTableHeaders:rf.d(R),isPivotTable:!1,isTable:!0,userSelectedPivotTable:!1,address:Je.dB(!1),addressWithSheet:Ue.name+"!"+Je.dB(!1),sheetId:li.d(Ue),sheetName:Ue.name,isSheetEmpty:!1,columnCount:Je.width,rowCount:Je.height,columnIndex:Je.left+
Ha,rowIndex:Je.top+Ha,selectionType:"Continuous"}))}}Ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?gd.sourceLocationOverrideResourceId="RecommendPivotTables.PPE.Bundle":gd.sourceLocationOverrideResourceId="RecommendPivotTables.Bundle";gd.Rk=og.a.instance.ga(1796);gd.jS=Ka.mYi;gd.Kk=Ig.a.CPe;wd.Kk=Ig.a.CPe;break;case -336193495:Ad.LaunchMode="RecommendedCharts";Ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?gd.sourceLocationOverrideResourceId=
"RecommendCharts.PPE.Bundle":gd.sourceLocationOverrideResourceId="RecommendCharts.Bundle";gd.Rk=og.a.instance.ga(1795);gd.jS=Ka.g6i;gd.Kk=Ig.a.DPe;wd.Kk=Ig.a.DPe;break;case -1336341324:if(!Ve.EwaSettings.ma(481))return wh.Task.Ua(!1);Ad.LaunchMode="NL";gd.jS=Ka.KVc;Ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?gd.sourceLocationOverrideResourceId="IdeasNL.PPE.Bundle":gd.sourceLocationOverrideResourceId="IdeasNL.Bundle";switch(Ve.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",
0)){case 1:gd.Rk=og.a.instance.ga(1800);Ad.NLLaunchModeBrandingCandidatesIndex=1;break;case 2:gd.Rk=og.a.instance.ga(1801);Ad.NLLaunchModeBrandingCandidatesIndex=2;break;default:gd.Rk=og.a.instance.ga(1799),Ad.NLLaunchModeBrandingCandidatesIndex=0}break;case 2086613372:if(!Ve.EwaSettings.ma(235))return wh.Task.Ua(!1);Ad.LaunchMode="ChartDesigner";Ad.LaunchSelectionMode=Ha.toString();Ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?gd.sourceLocationOverrideResourceId=
"Insights.Https.PPE.Bundle":gd.sourceLocationOverrideResourceId="Insights.Https.Bundle";gd.Rk=og.a.instance.ga(1802);gd.jS=Ka.KVc;break;case 451940422:Ad.LaunchSource="AutoFilter";Ha=JSON.parse(R.CommandValueId);Ad.AutoFilterSource=JSON.stringify(Object.assign(new Ea,{autoFilterRange:{sheetName:Ha.AutoFilterRange.SheetName,firstColumn:Ha.AutoFilterRange.FirstColumn,lastColumn:Ha.AutoFilterRange.LastColumn,firstRow:Ha.AutoFilterRange.FirstRow,lastRow:Ha.AutoFilterRange.LastRow},autoFilterType:Ha.AutoFilterType,
itemIndex:Ha.ItemIndex,id:Ha.Id}));bc();break;default:Ve.EwaSettings.ma(235)&&(Ad.LaunchSelectionMode=Ha.toString()),bc()}Ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?gd.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":gd.sourceLocationOverrideResourceId="Insights.Https.Bundle";return this.Xya?this.Xya.eo(function(){return Rc.EWf(Ad,gd)}):this.$$h(Gb,gd,wd,Ad)};Ka.prototype.$$h=function(R,Ha,Gb,bc){var Rc=this;this.Xya=this.ULd(this.Pte(Ha.sourceLocationOverrideResourceId),
Ha,!1,R,Gb,!1);return Ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6256725_NoActionMsgOnFirstInstance")?(bc.NoActionMsgOnFirstInstance=!0,this.wRa[Ka.fLa]=bc,this.Xya):this.Xya.eo(function(){return Rc.EWf(bc,Ha)})};Ka.prototype.EWf=function(R,Ha){var Gb=this.te.qaa(this.te.X2a(Ka.fLa,Ha.sourceLocationOverrideResourceId));if(Gb){this.wRa[Ka.fLa]=R;var bc=this.Dvd(this.te.iZ(Gb).OsfPropertyBag,Ka.fLa);this.te.iZ(Gb).OsfPropertyBag=bc}this.bNa(Ka.fLa,"LaunchIdeasAction",R,Ha);return wh.Task.Ua(!0)};
Ka.prototype.s7=function(R,Ha,Gb,bc,Rc,gd,wd){Gb=void 0===Gb?null:Gb;bc=void 0===bc?!1:bc;Rc=void 0===Rc?null:Rc;gd=void 0===gd?!1:gd;wd=void 0===wd?null:wd;If.TaskExtensions.jk();Gb||(Gb=new xh.a);var Ad={Version:"0.0.0.0"};Ad.AssetId=Ha;Ad.SolutionId=Ha;Ad.AssetStoreId="";Ad.StoreType=bc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;Ad.Height=0;Ad.Width=0;Ad.StoreId=bc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;Ad.TargetType=OSF.OsfControlTarget.TaskPane;Ad.IsToBePersisted=!1;Ad.SourceLocationOverrideResourceId=
Gb.sourceLocationOverrideResourceId;if(Gb.Rk||wd)this.ead[Ha]=Object(Qg.a)(new ba,{uzc:Gb.Rk,xUd:wd,szc:Gb.jS});Ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)?(Gb.UH||(Gb.UH={}),Gb.UH.ShowFeedback=this.$.isFeedbackEnabled,this.wRa[Ha]=Gb.UH):Gb.UH&&(this.wRa[Ha]=Gb.UH);Ha={};Ha[dh.a.Vf]=Ad;wd={};wd.solutionId=Ad.SolutionId;wd.version=Ad.Version;wd.storeType=Ad.StoreType;wd.storeId=Ad.StoreId;wd.assetId=Ad.AssetId;wd.assetStoreId=
Ad.AssetStoreId;wd.height=Ad.Height;wd.targetType=Ad.TargetType;wd.width=Ad.Width;wd.isAddinCommands=!bc;Ha[bf.a.Hra]=wd;Rc||(Rc=new Pf.a);Rc.focusOnIframeWhenLoaded=Gb.focusOnIframeWhenLoaded;Rc.width=Gb.taskPaneWidth;Ha[Pf.a.key]=Rc;Ha[rh.a.Zda]=gd;return this.insertAgave(Ha,R)};Ka.prototype.Vbi=function(R,Ha,Gb,bc,Rc){function gd(me){Od.ULS.sendTraceTag(537170440,220,50,"Insert addincommands for {0} from {1}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(me.solutionId,me.storeType,me.assetId,null,
null,me.storeId),me.storeType);var Je={},Ue=new $e.a;Ue.add(me);Je[bf.a.lnb]=Ue;Je[bf.a.yT]=3;me=new di.a(Bg.a.fBb,0,Ad.$.Jc,0,null);return Ad.$.Ka.Kb(me,Je)}function wd(me,Je){var Ue=me.SolutionId;var df=OSF.OsfControl.isFirstPartyStoreString(me.StoreType);df&&me.SourceLocationOverrideResourceId&&(Ue=Ad.te.X2a(Ue,me.SourceLocationOverrideResourceId));var zf=Ad.te.cxe(Ue,null,me.SharedRuntimeId);df&&(Ve.EwaSettings.ma(296)&&zf&&(df=Ad.te.qaa(Ue))&&(Ue=null,Ue=Ad.Dvd(Ad.te.iZ(df).OsfPropertyBag,me.SolutionId),
(df=Ad.te.ri.getOsfControl(df))&&df.setSettings(Ue)),me.SharedRuntimeId&&zf||Ad.te.ri.refreshOsfControl(me.SolutionId,me.SourceLocationOverrideResourceId));if(!zf){var Ne=Ad.$.oa.xa.Pb(),jf=519;zf=function(qf,Df,Gf){var Ff=Ad.$.oa.xa;qf=Mf.b(qf,Ad.PGf);var Nf=Ff.Na(9,Ne);Nf.sharedInfo=me;return Cg.g(Ff,"InsertAgaveTaskpane",Nf,qf,Df,Gf,bc,0)};void 0===me.IsToBePersisted||null===me.IsToBePersisted||me.IsToBePersisted||(jf=538,zf=function(qf,Df,Gf){Od.ULS.sendTraceTag(537170442,220,50,"Web Method ShowAgaveTaskpane is called, StoreType {0}, StoreId {1}, SolutionId {2}.",
me.StoreType,me.StoreId,Telemetry.PrivacyRules.GetPrivacyCompliantId(me.SolutionId,me.StoreType,me.AssetId,null,null,me.StoreId));var Ff=Ad.$.oa.xa;qf=Mf.b(qf,Ad.PGf);var Nf=Ff.Na(9,void 0===Ne?null:Ne);Nf.sharedInfo=me;return Cg.g(Ff,"ShowAgaveTaskpane",Nf,qf,Df,Gf,bc,0)});return Ve.EwaSettings.Zb()?(Rc|=64,Dh.a(Ad.$.userOperationManager,zf,function(qf){return new gi.a(jf,0,qf,Rc)},Je)):Dh.a(Ad.$.userOperationManager,zf,function(qf){return new vi.a(jf,0,qf,Rc)},Je)}return If.TaskExtensions.Qaa()}
var Ad=this;if(!Ve.EwaSettings.ma(54)||R.StoreId===OSF.StoreType.FirstParty)return wd(R,Gb,bc);if(Ha.isAddinCommands)return gd(Ha);var Ld=new vj.a,ce={};ce.marketplaceId=R.SolutionId;ce.marketplaceVersion=R.Version;ce.storeType=R.StoreType;ce.storeId=R.StoreId;ce.targetData=R;Ve.EwaSettings.ma(94)&&(ce.clearCache=!0);this.te.ri.isAddinCommandsAsync(ce,function(me,Je,Ue){Ld.setResult(Je);me||(me=Ue.targetData,Od.ULS.sendTraceTag(537170438,220,10,"Judging AddinCommands failed for {0} from {1} during addin inserting",
Telemetry.PrivacyRules.GetPrivacyCompliantId(me.SolutionId,me.StoreType,me.AssetId,null,null,me.StoreId),me.StoreType))});return If.TaskExtensions.ts(Ld.task,function(me){return me.result?gd(Ha):wd(R,Gb,bc)},this.$.la)};Ka.prototype.Dvd=function(R,Ha){if(!this.wRa[Ha])return R;var Gb={};if(R){R=ak(R);for(var bc=R.next();!bc.done;bc=R.next())bc=bc.value,Gb[bc[0]]=bc[1]}R=this.wRa[Ha];bc=ak(Object.keys(R));for(Ha=bc.next();!Ha.done;Ha=bc.next())Ha=Ha.value,Ha===Ka.qyh&&Ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",
!1)?Gb[Ha]=Sys.Serialization.JavaScriptSerializer.serialize(R[Ha]):Gb[Ha]=Sys.Serialization.JavaScriptSerializer.serialize(R[Ha].toString());Ha=Object.keys(Gb).length;R=Array(Ha);bc=0;var Rc=ak(Object.keys(Gb));for(Ha=Rc.next();!Ha.done;Ha=Rc.next())Ha=Ha.value,R[bc]=[Ha,Gb[Ha].toString()],bc++;return R};Ka.prototype.Zui=function(R,Ha,Gb){var bc=this.$.ya.UserSessionId,Rc=this.$.ya.UICultureTag,gd=this.$.ya.UICultureTagLcid,wd=this.$.ya.WacHostId,Ad="",Ld="";5<=Gb.length&&(Ad=Gb[3],Ld=Gb[4]);this.$ui(Ad,
Ld,R,Ha,Rc,gd,bc,wd)};Ka.prototype.$ui=function(R,Ha,Gb,bc,Rc,gd,wd,Ad){var Ld={};Ld.a=wd;Ld.b=Gb;Ld.c=bc;Ld.d=R;Ld.e=Ha;Ld.f=Rc;Ld.g=gd;Ld.h=Ad;Oi.b().De(36,Ld)};Ka.prototype.kwe=function(){if(Vj.a.psf())Od.ULS.sendTraceTag(537170433,1302,15,"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(this.TGf);return}catch(R){Od.ULS.sendTraceTag(537170432,1302,15,"Failed to use createScreenshot "+(R?R.toString():null))}try{OfficeBrowserFeedback.html2canvas(document.body,
null)().then(this.TGf)}catch(R){Od.ULS.sendTraceTag(537170403,1302,15,"Failed to use html2canvas"+(R?R.toString():null))}}};Ka.prototype.ULd=function(R,Ha,Gb,bc,Rc,gd){Ha=void 0===Ha?null:Ha;Gb=void 0===Gb?!1:Gb;bc=void 0===bc?null:bc;Rc=void 0===Rc?null:Rc;gd=void 0===gd?!0:gd;var wd=R.SolutionId,Ad=wh.Task.Ua(!1);R&&wd&&R.SharedRuntimeId&&(bc=bc||new di.a(-859308420,0,2,0,""),wd={},wd.solutionId=R.SolutionId,wd.version=R.Version,wd.storeType=R.StoreType,wd.storeId=R.StoreId,wd.assetId=R.AssetId,
wd.assetStoreId=R.AssetStoreId,wd.height=R.Height,wd.targetType=R.TargetType,wd.width=0,wd.isAddinCommands=!1,wd.sharedRuntimeId=R.SharedRuntimeId,R.Preload=gd,Rc=Rc?Rc:new Pf.a,Rc.width=0,Ha&&(Rc.focusOnIframeWhenLoaded=Ha.focusOnIframeWhenLoaded,gd=new ba,Ha.Rk&&(gd.uzc=Ha.Rk),0<Ha.taskPaneWidth&&(gd.mu=Ha.taskPaneWidth),Ha.jS&&(gd.szc=Ha.jS),this.ead[R.SolutionId]=gd),Ha={},Ha[dh.a.Vf]=R,Ha[bf.a.Hra]=wd,Ha[Pf.a.key]=Rc,Ha[rh.a.Zda]=Gb,Ad=this.insertAgave(Ha,bc));return Ad};Ka.prototype.bNa=function(R,
Ha,Gb,bc){bc=void 0===bc?null:bc;if(R&&Ha){R=new Ch.a(R,OSF.StoreType.Sdx,OSF.StoreType.Sdx,"1.0.0.0");var Rc=new Ki.a("ExcelOnline","Web",this.$.ya.UICultureTag),gd=new Li.a;gd.optionalProperties[eh.a.TSc]=Gb;bc&&(Gb=bc,Gb.sourceLocationOverrideResourceId&&(gd.optionalProperties[eh.a.sourceLocationOverrideResourceId]=Gb.sourceLocationOverrideResourceId),Gb.Rk&&(gd.optionalProperties[eh.a.Rk]=Gb.Rk),Gb.Kk&&(gd.optionalProperties.IconCssClass=Gb.Kk),Gb.tUd&&(gd.optionalProperties.TaskPaneIconUrl=Gb.tUd),
Gb.jS&&(gd.optionalProperties.TaskPaneIconId=Gb.jS));vd.a.instance.bNa(R,fi.a.action,Ha,Rc,gd)}};Ka.prototype.eTh=function(R){if(!Jh.a.uh(R)){var Ha=R[Eh.a.O8b];if(Ha&&(Ha=Ha.getId(),R=R[Eh.a.Iya],Ha&&R))return this.X2a(Ha,R.optionalProperties[eh.a.sourceLocationOverrideResourceId])}return null};Ka.prototype.X2a=function(R,Ha){Ha=void 0===Ha?null:Ha;return R&&Ha?String.format("{0}.{1}",R,Ha):R};Ka.prototype.IKh=function(R){switch(R){case 1172793074:case 1221897806:case 1930653487:return 2;case -515602470:case 2086613372:return Ve.EwaSettings.ma(235)?
1023:1;case 1723441034:return 1023;case -859308420:return 1023;case 515196233:return 1023;default:return 1}};Ka.B7h="Microsoft.Office.Excel.IdeasXLOPreload";Ka.xBd="IDS";Ka.T6e="FA000000012";Ka.fLa="FA000000005";Ka.C5h="HelloWorld";Ka.jWg="FA000000014";Ka.C3e="Help.GiveFeedback.Url";Ka.qyh="feedback";Ka.Yjf="FA000000066";Ka.$Zi="PowerBi.Url";Ka.YZi="PowerBi.DevUrl";Ka.ZZi="FA000000054";Ka.ACi="FA000000064";Ka.jVi="FA000000075";Ka.KVc="AnalyzeDataTaskPane";Ka.g6i="RecommendedChartsTaskPane";Ka.mYi=
"PivotTableTaskPane";Ka.Bch=350;Ka.w8e=320;Ka.T1i=320;Object(Cd.a)(Ka,"AgaveCommandManager",bi.a,[914,915]);Af.Object.defineProperties(Na,{instance:{configurable:!0,enumerable:!0,get:function(){return Na.Ma}}});Na.Ma=new Na;Object(Cd.a)(Na,"AppsDataManagerFactory",null,[]);Object(Cd.a)(ab,"AppsDataProvider",null,[299]);var Wj=b(962),Ej=We.a;Rk(ta,Ej);ta.prototype.create=function(){var R=this,Ha=this.$.da,Gb=Kg.GetServiceTaskFactory.create(Ha,106,this.la,this.hb),bc=Kg.GetServiceTaskFactory.create(Ha,
104,this.la,this.hb),Rc=Ji.a.loadScript(36,0,this.hb,void 0,void 0,375);If.TaskExtensions.Ba(If.TaskExtensions.Wd([bc,Gb,Rc],this.la),function(){if(!Ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)){var gd=new Pc(Rh.a.instance),wd=new ab(gf.AFrameworkApplication.fa,gf.AFrameworkApplication.qd,"WAC_Excel");new ya(gd,wd,"PreinstalledAppsData_Excel")}var Ad=null;Ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",
!1)&&(Ad=Rg.a.instance.Tb("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").instance);Ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1);sa.instance.initialize(Gb.result);gd=Ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PreloadRaceCondition6395242",!0)?Object(Wj.a)(R.$.da,374,function(){return new Ka(R.$,Gb.result,bc.result,Ad,gf.AFrameworkApplication.ub)}):new Ka(R.$,Gb.result,bc.result,Ad,gf.AFrameworkApplication.ub);Ha.Ga(206,
gd);R.pb(Ha.za(374)||Ha.Ga(374,gd))},this.la,3);Rg.a.instance.register(jj.a,"Common.Utils.AriaNotifier").as("Common.Utils.IAriaNotifier").tc().Cc(function(){return new jj.a(R.$.Rv)})};ta.ka=function(R){R.da.Ga(375,new ta(R))};Object(Cd.a)(ta,"AgaveCommandManagerFactory",We.a,[]);var Fj=b(624);xa.prototype.initialize=function(R){Ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&!this.initialized&&this.Vij(R)};xa.prototype.Abi=function(R,
Ha){var Gb=If.TaskExtensions.jk();if(this.initialized&&R&&0<R.length){var bc=this.CHh(R);R in this.hU&&(Gb=this.agaveCommandManager.insertAgave(bc,Ha))}return Gb};xa.prototype.Tzg=function(R){var Ha=this;this.initialized&&(R=R[dh.a.Vf]||{},!R.SolutionId||R.SolutionId in this.hU||this.te.Pca(function(Gb){Ha.Pca(Gb)},!0))};xa.prototype.v3h=function(R){var Ha=this;this.initialized&&(R=R||"")&&0<R.length&&R in this.hU&&(delete this.hU[R],this.te.Pca(function(Gb){Ha.Pca(Gb)},!0))};xa.prototype.CHh=function(R){return R in
this.hU?this.hU[R]:{}};xa.prototype.Pca=function(R){var Ha=!1;if(R&&!R.errorCode){if(R.value){R=ak(R.value);for(var Gb=R.next();!Gb.done;Gb=R.next()){Gb=Gb.value;var bc=Gb[1];Gb[3]==OSF.OsfControlTarget.InContent&&bc&&0<bc.length&&!(bc in this.hU)&&(Ha={NoReporting:!1,IsSystemInitiated:!1},Ha.description=Gb[2],Ha.iconUrl=Gb[9],Ha[bf.a.Hra]={solutionId:Gb[1],version:Gb[4],storeType:Gb[12],storeId:Gb[11],assetId:Gb[5],assetStoreId:Gb[6],targetType:Gb[3],width:Gb[7],height:Gb[8],displayName:Gb[0],id:Gb[1]},
Ha[dh.a.Vf]={SolutionId:Gb[1],Version:Gb[4],StoreType:Gb[12],StoreId:Gb[11],AssetId:Gb[5],AssetStoreId:Gb[6],TargetType:Gb[3],Width:Gb[7],Height:Gb[8],Id:Gb[1]},this.hU[bc]=Ha,Ha=!0)}}Ha&&this.j5g()}};xa.prototype.j5g=function(){var R=[],Ha;for(Ha in this.hU)R.push({id:Ha,controlType:0,title:this.hU[Ha][bf.a.Hra].displayName});if(0<R.length){for(var Gb in this.hU)appChrome.addInApi.registerAddinIcon("AddinIcon_"+Gb,this.hU[Gb].iconUrl);this.uXg();appChrome.addInApi.dispatchActionsToInstallAddIn({tabs:[{id:xa.wsf,
isOfficeTab:!0,groups:[{id:xa.A$e,title:xa.B$e,controls:R}]}]});for(var bc in this.hU)this.S_a.addCommandToMaps(Object(Qg.a)(new ii.a(bc,"-1473679467"),{legacyControlId:bc}))}};xa.prototype.uXg=function(){appChrome.addInApi.dispatchActionsToRemoveAddIn({tabs:[{id:xa.wsf,isOfficeTab:!0,groups:[{id:xa.A$e,title:xa.B$e,controls:[]}]}]})};xa.prototype.Vij=function(R){var Ha=this,Gb=Kg.GetServiceTaskFactory.Ra(R.da,374,375,1),bc=Kg.GetServiceTaskFactory.create(R.da,106,R.la,1);If.TaskExtensions.Ba(If.TaskExtensions.Wd([Gb,
bc],R.la),function(){Ha.agaveCommandManager=Gb.result;Ha.S_a=Rg.a.instance.nh("Common.IExternalUICommandDefinitionMapping")||new Fj.a(R.yb,R);gf.AFrameworkApplication.ub.Mb(Bg.a.ZNf,Sh.a.frame,function(Rc,gd,wd,Ad,Ld){Ha.v3h(Ld)});Ha.te=bc.result;Ha.te.Pca(function(Rc){Ha.Pca(Rc)},!0);Ha.initialized=!0},R.la,3)};xa.wsf="tabinsert";xa.A$e="installedContentAddins";xa.B$e=og.a.instance.ga(2249);Object(Cd.a)(xa,"AgaveCommandRibbon",null,[842]);var Gj=We.a;Rk(da,Gj);da.prototype.create=function(){if(Ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",
!1)){var R=this.$.da,Ha=new xa;Ha.initialize(this.$);this.pb(R.za(488)||R.Ga(488,Ha))}};da.ka=function(R){R.da.Ga(489,new da(R))};Object(Cd.a)(da,"AgaveCommandRibbonFactory",We.a,[]);var Hj=b(1503),jg=b(944);S.prototype.getTypeName=function(){return"Microsoft.Authentication.OfficeIdentityInfo"};S.prototype.invokePropertyGet=function(R){switch(R){case 4:return this.displayName;case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);
};S.prototype.invokePropertyGetAsync=function(R){R=this.invokePropertyGet(R);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(R)};S.prototype.invokePropertySet=function(R,Ha){switch(R){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ha,0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ha,0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ha,0,"string");
return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ha,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);};S.prototype.invokePropertySetAsync=function(R,Ha){this.invokePropertySet(R,Ha);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};S.prototype.invokeMethod=function(R){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);};S.prototype.invokeMethodAsync=function(R,Ha){R=this.invokeMethod(R,
Ha);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(R)};S.v6g=function(R){var Ha=new S;Ha.displayName=R.displayName;Ha.email=R.email;switch(R.authority){case Hj.a.RDf:Ha.identityType=1;break;default:Ha.identityType=0}Ha.federationProvider="";return Ha};Af.Object.defineProperties(S.prototype,{displayName:{configurable:!0,enumerable:!0,get:function(){return this.afa},set:function(R){this.afa=R}},email:{configurable:!0,enumerable:!0,get:function(){return this.P4d},set:function(R){this.P4d=
R}},federationProvider:{configurable:!0,enumerable:!0,get:function(){return this.v5d},set:function(R){this.v5d=R}},identityType:{configurable:!0,enumerable:!0,get:function(){return this.Gib},set:function(R){this.Gib=R}}});Object(Cd.a)(S,"OfficeIdentityInfo",null,[]);Qa.Jac=function(R){return R in Qa.vLe?Qa.vLe[R].toString():R};Af.Object.defineProperties(Qa,{vLe:{configurable:!0,enumerable:!0,get:function(){return Qa.Lng}}});Qa.map=null;var Sg={};Qa.Lng=(Sg.GeneralException=jg.a.generalException,Sg.AccessDenied=
jg.a.PSc,Sg.ApiNotAvailable=jg.a.apiNotAvailable,Sg.UserNotSignedIn=jg.a.userNotSignedIn,Sg.UserAborted=jg.a.userAborted,Sg.UnsupportedUserIdentity=jg.a.MPj,Sg.InvalidResourceUrl=jg.a.invalidResourceUrl,Sg.InvalidGrant=jg.a.invalidGrant,Sg.AddinIsAlreadyRequestingToken=jg.a.yHg,Sg.ResourceNotAllowed=jg.a.Ogj,Sg.ClientError=jg.a.clientError,Sg.ServerError=jg.a.serverError,Sg);Object(Cd.a)(Qa,"SingleSignOnErrorCodeMap",null,[]);wa.prototype.getTypeName=function(){return"Microsoft.Authentication.SingleSignOnToken"};
wa.prototype.invokePropertyGet=function(R){switch(R){case 2:return this.accessToken;case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);};wa.prototype.invokePropertyGetAsync=function(R){R=this.invokePropertyGet(R);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(R)};wa.prototype.invokePropertySet=function(R,Ha){switch(R){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ha,0,"string");return;case 3:this.tokenIdenityType=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ha,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);};wa.prototype.invokePropertySetAsync=function(R,Ha){this.invokePropertySet(R,Ha);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};wa.prototype.invokeMethod=function(R){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);};wa.prototype.invokeMethodAsync=function(R,Ha){R=this.invokeMethod(R,Ha);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(R)};
Af.Object.defineProperties(wa.prototype,{accessToken:{configurable:!0,enumerable:!0,get:function(){return this.RPb},set:function(R){this.RPb=R}},tokenIdenityType:{configurable:!0,enumerable:!0,get:function(){return this.Gib},set:function(R){this.Gib=R}}});Object(Cd.a)(wa,"SingleSignOnToken",null,[]);ia.prototype.getTypeName=function(){return"Microsoft.Authentication.TokenParameters"};ia.prototype.invokePropertyGet=function(R){switch(R){case 3:return this.authChallenge;case 7:return this.correlationId;
case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);};ia.prototype.invokePropertyGetAsync=function(R){R=this.invokePropertyGet(R);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(R)};ia.prototype.invokePropertySet=function(R,Ha){switch(R){case 3:this.authChallenge=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ha,0,"string");return;case 7:this.correlationId=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ha,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ha,0,"string");return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ha,0,"string");return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ha,0,"string");return;case 6:this.silentLogin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ha,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);
};ia.prototype.invokePropertySetAsync=function(R,Ha){this.invokePropertySet(R,Ha);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};ia.prototype.invokeMethod=function(R){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);};ia.prototype.invokeMethodAsync=function(R,Ha){R=this.invokeMethod(R,Ha);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(R)};Af.Object.defineProperties(ia.prototype,{authChallenge:{configurable:!0,enumerable:!0,get:function(){return this.j1d},
set:function(R){this.j1d=R}},correlationId:{configurable:!0,enumerable:!0,get:function(){return this.BD},set:function(R){this.BD=R}},policy:{configurable:!0,enumerable:!0,get:function(){return null},set:function(){}},resource:{configurable:!0,enumerable:!0,get:function(){return this.AVb},set:function(R){this.AVb=R}},scope:{configurable:!0,enumerable:!0,get:function(){return this.Vee},set:function(R){this.Vee=R}},silentLogin:{configurable:!0,enumerable:!0,get:function(){return this.fge},set:function(R){this.fge=
R}}});Object(Cd.a)(ia,"TokenParameters",null,[798]);ha.prototype.getAccessToken=function(R){var Ha=this,Gb=this.dhb.getOsfControl(this.nA),bc=Gb.getManifest(),Rc=bc.getMarketplaceID();this.wNa(R,Rc);return OfficeExtension.WacRuntime.Utility.createPromise(function(gd,wd){Gb.isFirstParty()&&Ha.dhb._enableFirstPartySSO?Ha.zei(bc,R)?Rg.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(R,Rc).then(function(Ad){gd(Ad)},function(Ad){wd(Ad)}):wd(jg.a.PSc):wd(jg.a.apiNotAvailable)}).then(function(gd){switch(gd.authority){case Hj.a.RDf:var wd=
1;break;default:wd=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new wa(gd.accessToken,wd))},function(gd){Ha.logErrorResponse(R,Rc,gd);return gd?OfficeExtension.WacRuntime.Utility.createPromise(function(wd,Ad){Ad(OfficeExtension.WacRuntime.Utility.createRichApiException(gd,Qa.Jac(gd)))}):OfficeExtension.WacRuntime.Utility.createPromise(function(wd,Ad){Ad(OfficeExtension.WacRuntime.Utility.createRichApiException(jg.a.generalException,Qa.Jac(jg.a.generalException)))})})};ha.prototype.getAuthContext=
function(){return null};ha.prototype.getPrimaryIdentityInfo=function(){var R=this.dhb.getOsfControl(this.nA);R.getManifest();var Ha=R.getManifest().getMarketplaceID();return OfficeExtension.WacRuntime.Utility.createPromise(function(Gb,bc){Rg.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(Ha).then(function(Rc){Gb(Rc)},function(Rc){bc(Rc.toString())})}).then(function(Gb){Gb=S.v6g(Gb);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Gb)},function(Gb){return Gb?
OfficeExtension.WacRuntime.Utility.createPromise(function(bc,Rc){Rc(OfficeExtension.WacRuntime.Utility.createRichApiException(Gb,Qa.Jac(Gb)))}):OfficeExtension.WacRuntime.Utility.createPromise(function(bc,Rc){Rc(OfficeExtension.WacRuntime.Utility.createRichApiException(jg.a.generalException,Qa.Jac(jg.a.generalException)))})})};ha.prototype.getTypeName=function(){return"Microsoft.Authentication.AuthenticationService"};ha.prototype.invokePropertyGet=function(R){switch(R){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);
};ha.prototype.invokePropertyGetAsync=function(R){R=this.invokePropertyGet(R);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(R)};ha.prototype.invokePropertySet=function(R){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);};ha.prototype.invokePropertySetAsync=function(R,Ha){this.invokePropertySet(R,Ha);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};ha.prototype.invokeMethod=function(R){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);
};ha.prototype.invokeMethodAsync=function(R,Ha){switch(R){case 1:return this.TGh(Ha);case 3:return this.oIh();case 2:return this.iUh()}R=this.invokeMethod(R,Ha);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(R)};ha.prototype.TGh=function(R){R=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(R,0,ia);return this.getAccessToken(R)};ha.prototype.oIh=function(){return this.getAuthContext()};ha.prototype.iUh=function(){return this.getPrimaryIdentityInfo()};ha.prototype.zei=function(R,
Ha){var Gb=!1,bc=R.getWebApplicationAuthorizations();R=null;bc=ak(bc);for(var Rc=bc.next();!Rc.done;Rc=bc.next())if(Rc=Rc.value,Rc.getResource().toLowerCase()===Ha.resource.toLowerCase()){R=Rc;Gb=!0;break}if(!Gb)return!1;Ha=Ha.scope.split(" ,+");Ha=ak(Ha);for(Gb=Ha.next();!Gb.done;Gb=Ha.next())if((Gb=Gb.value)&&Gb.length){bc=!1;Rc=ak(R.getScopes());for(var gd=Rc.next();!gd.done;gd=Rc.next())Gb.toLowerCase()===gd.value.toLowerCase()&&(bc=!0);if(!bc)return!1}return!0};ha.prototype.wNa=function(R,Ha){R=
this.isf(R.resource);var Gb={};Od.ULS.sendTraceTag(538572831,369,50,"{0}",(Gb.manifestId=Ha,Gb.resource=R,Gb))};ha.prototype.logErrorResponse=function(R,Ha,Gb){R=this.isf(R.resource);var bc={};Od.ULS.sendTraceTag(538572830,369,10,"{0}",(bc.manifestId=Ha,bc.resource=R,bc.error=Gb,bc))};ha.prototype.isf=function(R){return R.replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")};Af.Object.defineProperties(ha.prototype,{roamingSettings:{configurable:!0,enumerable:!0,get:function(){return null}}});
Object(Cd.a)(ha,"AuthenticationService",null,[]);fa.prototype.create=function(R,Ha){return new ha(R,Ha)};Object(Cd.a)(fa,"AuthenticationServiceFactory",null,[]);var mj=b(1057),nj=b(1173),Ij=b(1156);qa.generalException="generalException";qa.invalidArgument="invalidArgument";qa.notAllowed="notAllowed";qa.apiNotAvailable="apiNotAvailable";qa.unresolvedPendingRequest="unresolvedPendingRequest";qa.timeout="timeout";qa.adalTimeout="adalTimeout";qa.userNotSignedIn="userNotSignedIn";qa.userAborted="userAborted";
qa.silentSignInFailed="silentSignInFailed";qa.invalidResourceUrl="invalidResourceUrl";qa.invalidGrant="invalidGrant";qa.connectionLost="connectionLost";qa.clientError="clientError";qa.serverError="serverError";Object(Cd.a)(qa,"WopiHostErrorCodes",null,[]);var Pi=b(942);Object(Cd.a)(Y,"OAuthCallerMetadata",null,[]);var Oh=b(25);ka.prototype.fzg=function(R,Ha,Gb,bc,Rc,gd){var wd=this;if(!this.Bxa)return bc=new nj.a,bc.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(bc);
var Ad=new Y;Ad.AddinName=Rc;Ad.AddinTrustId=gd;var Ld=-1;gd=null;if(bc&&this.vdf())gd=this.Bxa.O$f(bf.a.Izc,R,bc,ka.u0e(Rc),Ad);else{var ce=Date.now();gd=this.Bxa.EO(bf.a.Izc,R,Ad).then(function(me){Ld=Date.now()-ce;var Je=(Ha||Gb)&&"login_required"===me.ErrorCode;return(Ha&&("interaction_required"===me.ErrorCode||"consent_required"===me.ErrorCode||"invalid_grant"===me.ErrorCode)||Je)&&wd.vdf()?wd.Bxa.O$f(bf.a.Izc,R,null,ka.u0e(Rc),Ad):Promise.resolve(me)})}return gd.then(function(me){var Je=new nj.a;
me.IsSuccess?(Je.token=me.Token,me.Telemetry&&(Je.PSa=me.Telemetry.fromCache,Je.expiresOn=me.Telemetry.expiresOn)):(Je.errorCode=wd.ryi(me),Je.BUd=wd.xWi(me));return Je}).catch(function(){var me=new nj.a;me.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(me)}).then(function(me){me.aha="OauthManager";0<=Ld&&(me.Wvb=Ld);return me})};ka.prototype.Xgi=function(R){var Ha=(gf.AFrameworkApplication.fa.Wa(gf.AFrameworkApplication.kea)||"").toLowerCase();return(Oh.a.Zwa||
"teams"===Ha&&Pi.a.exb)&&!ka.Agi(R)||!this.Bxa||!this.Bxa.A5a()?!1:!0};ka.prototype.vdf=function(){return this.Cng||1!==Ij.a.N$b()};ka.prototype.ryi=function(R){switch(R.ErrorCode){case "UserCancelled":case "interaction_required":R=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "consent_required":case "invalid_grant":R=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":R=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":R=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":R=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":R=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:R=R.ErrorCode===qa.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:R.ErrorCode===qa.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:R.ErrorCode===qa.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:
R.ErrorCode===qa.invalidGrant?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:R.ErrorCode===qa.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return R};ka.prototype.xWi=function(R){var Ha="";(R=RegExp("AADSTS(\\d+)").exec(R.ErrorMessage))&&1<R.length&&(Ha=R[1]);return Ha};ka.u0e=function(R){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,R)};ka.Agi=function(R){if(!R)return!1;
R=R.toLowerCase();for(var Ha=ak(mj.AppsForOfficeSingleSignOnManager.ZSe),Gb=Ha.next();!Gb.done;Gb=Ha.next())if(Gb.value===R)return!0;return!1};Object(Cd.a)(ka,"AppsforOfficeTokenFromOauthManager",null,[222]);ea.noa=function(){if(gf.AFrameworkApplication.fa.ra("AppForOfficeSSOV2IsEnabled")){var R=null;try{R=Rg.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(Ha){Od.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+Ha)}R=new ka(R);ea.Ma=new ea(R)}};ea.getInstance=function(){ea.q7d||
(ea.noa(),ea.q7d=!0);return ea.Ma};ea.Ma=null;ea.q7d=!1;Object(Cd.a)(ea,"AppsForOfficeOauthManagerFactory",null,[204]);var Jj=b(1502),Qi=b(135);Object(Cd.a)(Z,"NewDocumentParameters",null,[]);var Ph=b(180);ca.prototype.createAndOpenWorkbook=function(R){var Ha=this;if(R&&R.length>this.jsg)throw Od.ULS.sendTraceTag(538572821,0,15,"Too large base64 stream size:{0}",R.length),OfficeExtension.WacRuntime.Utility.createRichApiException(jg.a.invalidArgument,Ph.a.ga(1744));var Gb=new Z("blank","agave",R?"streamBase64":
"streamEmpty",R),bc=null;return OfficeExtension.WacRuntime.Utility.createPromise(function(Rc,gd){var wd=new Qi.StandardDialog;wd.Rb=4;wd.nl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,function(Ad){2===Ad||0===Ad?gd("Cancelled"):(bc=window.open(""),Ha.Fsg.create(Rc,gd,Gb).q0a())})}).then(function(Rc){if(!Rc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(jg.a.generalException,Ph.a.ga(1740));try{bc.top.location.href=Rc}catch(gd){Od.ULS.sendTraceTag(538572820,
0,10,"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}",Oh.a.Xo,gd),Od.ULS.sendTraceTag(538572819,0,50,"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace"),bc.location.replace(Rc)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},function(Rc){if("Cancelled"===Rc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(jg.a.BBd,Ph.a.ga(1743));bc.close();Ha.QIj();return null})};
ca.prototype.getTypeName=function(){return"Microsoft.ExcelServices.WacWorkbook"};ca.prototype.invokePropertyGet=function(R){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);};ca.prototype.invokePropertyGetAsync=function(R){R=this.invokePropertyGet(R);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(R)};ca.prototype.invokePropertySet=function(R){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);};ca.prototype.invokePropertySetAsync=function(R,
Ha){this.invokePropertySet(R,Ha);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};ca.prototype.invokeMethod=function(R){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);};ca.prototype.invokeMethodAsync=function(R,Ha){switch(R){case 1:return this.i4g(Ha)}R=this.invokeMethod(R,Ha);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(R)};ca.prototype.i4g=function(R){R=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(R,0,"string");return this.createAndOpenWorkbook(R)};
ca.prototype.QIj=function(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(jg.a.generalException,Ph.a.ga(1740));};Object(Cd.a)(ca,"WacWorkbook",null,[]);var Xf=b(246),Jf=b(943),oj=b(949);Af.Object.defineProperties(N.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.jb}}});Object(Cd.a)(N,"RichApiPreviewExecutionContext",null,[]);var Kj=b(24),pj=b(1076),Yh=b(36),Xj=b(216),qj=b(218),rj=b(118),Ri=b(12),xi=qj.a;Rk(O,xi);O.prototype.start=function(R,Ha){var Gb="<div class='"+
rj.a.ynh+" "+Ig.a.No+"'><label for='{1}'>{0}</label></div>\r\n<div><input type='text' id='{1}' maxlength='388' class='"+rj.a.AC+"' /></div>";Gb=String.format(Gb,vh.a.Ag(this.T4c.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");this.Gb.innerHTML=Gb;this.Cob=Ri.DOMElementExtensions.getElementById(this.Gb,"bindingText");R=Ha?R.s2a(Ha,this.T4c.DdaBindingsMethod.BindingId):null;(null===R||void 0===R?0:R.IsValidRef)?(Ha=new Kj.Range(R.Reference.FirstRow+1,R.Reference.FirstColumn+1,R.Reference.LastRow+
1,R.Reference.LastColumn+1,!1,!1),this.Cob.value=R.Reference.SheetName+"!"+Ha):(R=qg.g(this.$).ha,this.Cob.value=li.f(this.$.pa)||!R.sa.tg?"":R.cia);this.initialize();this.hf()};O.prototype.pn=function(){this.M_c();this.addButton(0);this.addButton(1);xi.prototype.pn.call(this)};O.prototype.setFocus=function(){Ri.DOMElementExtensions.setFocus(this.Cob)};O.prototype.validate=function(){return!0};O.prototype.commit=function(){var R=this.Cob.value.trim(),Ha=R.indexOf("!");-1!==Ha&&(R=this.hXh(R.substring(0,
Ha))+R.substr(Ha));this.wFe.addBinding(this.T4c,R,0,this.callback);return!0};O.prototype.psa=function(){this.wFe.lQ.ef(Jf.a.internalError,this.callback);xi.prototype.psa.call(this)};O.prototype.hXh=function(R){R=Gi.a.trimStart(R.trim(),"=");return R.length?R.startsWith("'")&&R.endsWith("'")?R:si.HelperMethods.T7b(R):""};Af.Object.defineProperties(O.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"DdaBindingPrompt"}}});Object(Cd.a)(O,"DdaBindingPrompt",qj.a,[]);J.prototype.ef=function(R,
Ha){if(Ha){var Gb={};Gb.Error=R;Gb.Version=this.ea.Ve;Ha(Gb)}};J.prototype.wJa=function(R,Ha){this.ef(R,Ha)};J.prototype.aH=function(R,Ha){this.ef(Jf.a.vUe(R.Errors[0].MessageId),Ha)};J.prototype.Lu=function(R){R&&R(this.SP())};J.prototype.SP=function(){var R={Error:0};R.Version=this.ea.Ve;return R};Object(Cd.a)(J,"DdaErrorGenerator",null,[]);var Zg=b(296),Si=b(95);K.prototype.ywd=function(R,Ha){function Gb(Ad){var Ld=bc.$.va.getItemByName(Ad.SheetName);(null===Ld||void 0===Ld?0:Ld.visible)?(qg.g(bc.$).hg(Ad,
null,null,null,3,Si.a.Gbh,void 0,void 0,void 0,void 0,!0),bc.lQ.Lu(Ha)):bc.lQ.ef(Jf.a.OUg,Ha)}var bc=this,Rc=R.DdaGoToByIdMethod.GoToType,gd=R.DdaGoToByIdMethod.SelectionMode,wd=R.DdaGoToByIdMethod.Id.toString().trim();0===Rc?this.qCi(wd,gd,R.DdaMethod.ControlId,Gb,Ha):1===Rc?this.uCi(wd,gd,Gb,Ha):this.lQ.ef(Jf.a.JPj,Ha)};K.prototype.qCi=function(R,Ha,Gb,bc,Rc){var gd=this;this.Yz.ddaGetBinding(Gb,R,function(wd){if(!Zg.a(wd)&&wd.Result&&wd.Result.Reference){wd=wd.Result;var Ad={};Ad.SheetName=wd.Reference.SheetName;
Ad.FirstRow=wd.Reference.FirstRow;Ad.FirstColumn=wd.Reference.FirstColumn;Ad.LastRow=wd.Reference.LastRow;Ad.LastColumn=wd.Reference.LastColumn;K.wVc(Ad,Ha);1!==wd.BindingType?bc(Ad):gd.Yz.ddaGetBindingData(Gb,R,1,0,2,0,0,-1,-1,function(Ld){Zg.a(Ld)||!Ld.Result?gd.lQ.aH(Ld,Rc):(Ld=Ld.Result,2!==Ha&&(Ad.FirstRow-=Ld.Headers.length,0>Ad.FirstRow&&(Ad.FirstRow=0)),bc(Ad))},Rc)}else gd.lQ.wJa(Jf.a.M4f,Rc)},Rc)};K.prototype.uCi=function(R,Ha,Gb,bc){var Rc=this,gd=Th.z(R);gd?(gd=Th.v(gd,this.$),K.wVc(gd,
Ha),Gb(gd)):this.$.ea.isNamedObjectViewMode&&this.$.vb.Mj(R)?this.$.vb.pa=this.$.vb.getItemByName(R):(gd=function(wd){Zg.a(wd)||!wd.Result?Rc.$.va.contains(R)?(wd={},wd.SheetName=R,wd.FirstRow=0,wd.FirstColumn=0,wd.LastRow=0,wd.LastColumn=0,Gb(wd)):Rc.lQ.wJa(Jf.a.M4f,bc):(wd=wd.Result,K.wVc(wd,Ha),Gb(wd))},this.$.va.pa?this.Yz.parseRangeForGoto(R,this.$.va.pa.name,gd,bc):this.Yz.parseRange(R,gd,bc))};K.wVc=function(R,Ha){R.LastRow=2===Ha?R.FirstRow:R.LastRow;R.LastColumn=2===Ha?R.FirstColumn:R.LastColumn};
Object(Cd.a)(K,"DdaNavigator",null,[]);var Ti=b(309),yi;(function(R){R[R.unsupported=0]="unsupported";R[R.surface=1]="surface";R[R.combo=2]="combo";R[R.column=3]="column";R[R.column3D=4]="column3D";R[R.bar=5]="bar";R[R.bar3D=6]="bar3D";R[R.line=7]="line";R[R.line3D=8]="line3D";R[R.pie=9]="pie";R[R.pie3D=10]="pie3D";R[R.scatter=11]="scatter";R[R.bubble=12]="bubble";R[R.area=13]="area";R[R.area3D=14]="area3D";R[R.doughnut=15]="doughnut";R[R.radar=16]="radar";R[R.stock=17]="stock";R[R.waterfall=18]=
"waterfall";R[R.funnel=19]="funnel";R[R.treemap=20]="treemap";R[R.sunburst=21]="sunburst";R[R.boxWhisker=22]="boxWhisker";R[R.histogram=23]="histogram";R[R.pareto=24]="pareto";R[R.regionMap=25]="regionMap";R[R.noVisibleSeries=26]="noVisibleSeries";R[R.complexDataSource=27]="complexDataSource";R[R.pivotChart=28]="pivotChart"})(yi||(yi={}));Object(Cd.b)("ChartCategory",yi);Object(Cd.a)(T,"MacroRecorderEventData",null,[]);M.prototype.zVh=function(R){var Ha;if(void 0===R||null===R||void 0===R.RequestBody||
null===R.RequestBody)return null;var Gb=JSON.parse(R.RequestBody);if(void 0!==R.ActiveChartId&&null!==R.ActiveChartId){Gb.ActiveChartId=R.ActiveChartId;var bc=qg.g(this.$).ha.Oa.Yb;if(null===(Ha=null===bc||void 0===bc?void 0:bc.floatingObject)||void 0===Ha?0:Ha.Oc)Gb.ActiveChartType=yi[bc.floatingObject.Oc.ChartCategory]}void 0!==R.SheetMultiRange&&null!==R.SheetMultiRange&&(Gb.SheetName=R.SheetMultiRange.SheetName);return Gb};M.prototype.MVh=function(R){if(void 0===R||null===R||void 0===R.Result||
null===R.Result)return null;R=R.Result;return void 0===R.ResponseBody||null===R.ResponseBody||R.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(R.ResponseBody.join(""))};M.prototype.ili=function(R){return!!R&&!(void 0===R.eventId||null===R.eventId)&&0<R.eventId.length};M.prototype.dj=function(R){var Ha=this;return function(){if(Ha.$.wba){var Gb=Ha.aRg(Ha.request);if(Ha.ili(Gb)){var bc=Ha.zVh(Ha.request),Rc=Ha.MVh(R);if(bc&&!Jh.a.isEmpty(bc)&&Rc&&!Jh.a.isEmpty(Rc))return Od.ULS.sendTraceTag(537163164,
0,50,"[RichApiRecorder]: Creating a MacroRecorderRichApiRequestExecutedPayload object."),new yg(Gb,bc,Rc);Gb=String.format("requestInfo: {0}; responseInfo: {1}",bc?"(not null)":"(null)",Rc?"(not null)":"(null)");Od.ULS.sendTraceTag(537163163,0,50,"[RichApiRecorder]: Failed due to bad data: {0}",Gb)}}return new yg(null,null,null)}};M.prototype.aRg=function(R){var Ha=this.jli(R.SolutionId),Gb=M.gVh(R);if(Gb&&Ha)return Ha={},Od.ULS.sendTraceTag(537163162,0,50,"[RichApiRecorder][{0}]: {1}",this.parentName,
(Ha.recorderEventId=Gb,Ha["request.SolutionId"]=R.SolutionId,Ha)),new T(R.SolutionId,Gb);var bc={};Od.ULS.sendTraceTag(537163161,0,50,"[RichApiRecorder][{0}]: {1}",this.parentName,(bc.recorderEventId=Gb,bc.isRecorderAwareAddin=Ha,bc["request.SolutionId"]=R.SolutionId,bc));return null};M.prototype.jli=function(R){if(!R)return!1;R=R.toLowerCase();return M.d0h().contains(R)};M.d0h=function(){M.sza||(M.sza=new Tf.a(fg.a.Jk()),M.sza.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),M.sza.add("fa000000005"),
M.sza.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),M.sza.add("fa000000014"),M.sza.add("c5daabb3-e185-4e8c-adfc-1a7b7283fb6f"));return M.sza};M.gVh=function(R){var Ha=null,Gb=RegExp('"Name":"EnableOfficeScriptRecording".*?Arguments":\\[.*?"(.*?)"',"mi");if(Gb.test(R.RequestBody))Ha=Gb.exec(R.RequestBody)[1];else{R=R.RequestHeaders;if(!R)return Ha;Gb=nh.a.gFi.toLowerCase();for(var bc=0;bc<R.length;bc++)if(R[bc].Name.toLowerCase()===Gb){Ha=R[bc].Value;break}}return Ha};M.sza=null;Object(Cd.a)(M,"DdaRichApiRequestRecorder",
null,[]);var Ui=b(70),zi=Ti.a;Rk(U,zi);U.prototype.C2=function(R){return zi.prototype.C2.call(this,R)||this.KTg(R)};U.prototype.dj=function(){return this.kLd.dj(this.Xc)};U.prototype.eeb=function(){var R={OperationType:3};R.RichApiRequest=this.request;return R};U.prototype.KTg=function(R){var Ha=this;return function(Gb,bc,Rc){return F(R,Ha.request,Mf.b(Gb,Ha.Flb),Mf.a(bc,Ha.Yhb),Rc,Ha.o3)}};Af.Object.defineProperties(U.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return Ve.EwaSettings.Zb()?
Object(Ui.a)(U.prototype,this,"operationWorkingState"):2}},eCc:{configurable:!0,enumerable:!0,get:function(){return this.ZEa}},ot:{configurable:!0,enumerable:!0,get:function(){return this.Flb}},laa:{configurable:!0,enumerable:!0,get:function(){return this.Yhb}}});Object(Cd.a)(U,"DdaRichApiRequestBatchOperation",Ti.a,[]);var Lj=gi.a;Rk(I,Lj);I.prototype.dj=function(){return this.kLd.dj(this.Xc)};Af.Object.defineProperties(I.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return Ve.EwaSettings.Zb()?
Object(Ui.a)(I.prototype,this,"operationWorkingState"):0}}});Object(Cd.a)(I,"DdaRichApiRequestOperation",gi.a,[]);E.prototype.ddaAddBinding=function(R,Ha,Gb,bc,Rc,gd,wd){var Ad=this;this.GJ(function(Ld,ce,me){var Je=Ad.$.oa.xa,Ue=Ad.mja();Ld=Mf.b(Ld,gd);ce=Mf.a(ce,Ad.ZH);var df=Je.Na(9);df.controlId=R;df.bindingId=Ha;df.bindingType=Gb;df.currentSheetName=Ue;df.formula=bc;df.options=Rc;return Cg.g(Je,"DdaAddBinding",df,Ld,ce,me,wd,0)},wd,563)};E.prototype.ddaReleaseBinding=function(R,Ha,Gb,bc){var Rc=
this;this.GJ(function(gd,wd,Ad){var Ld=Rc.$.oa.xa;gd=Mf.b(gd,Gb);wd=Mf.a(wd,Rc.ZH);var ce=Ld.Na(9);ce.controlId=R;ce.bindingId=Ha;return Cg.g(Ld,"DdaReleaseBinding",ce,gd,wd,Ad,bc,0)},bc,564)};E.prototype.ddaGetBinding=function(R,Ha,Gb,bc){var Rc=this;this.GJ(function(gd,wd,Ad){var Ld=Rc.$.oa.xa;gd=Mf.b(gd,Gb);wd=Mf.a(wd,Rc.ZH);var ce=Ld.Na(1);ce.controlId=R;ce.bindingId=Ha;return Cg.g(Ld,"DdaGetBinding",ce,gd,wd,Ad,bc,0)},bc,565,16)};E.prototype.ddaGetAllBindings=function(R,Ha,Gb){var bc=this;this.GJ(function(Rc,
gd,wd){var Ad=bc.$.oa.xa;Rc=Mf.b(Rc,Ha);gd=Mf.a(gd,bc.ZH);var Ld=Ad.Na(1);Ld.controlId=R;return Cg.g(Ad,"DdaGetAllBindings",Ld,Rc,gd,wd,Gb,0)},Gb,566,16)};E.prototype.ddaGetBindingData=function(R,Ha,Gb,bc,Rc,gd,wd,Ad,Ld,ce,me){var Je=this;this.GJ(function(Ue,df,zf){var Ne=Je.$.oa.xa,jf=Je.mja();Ue=Mf.b(Ue,ce);df=Mf.a(df,Je.ZH);var qf=Ne.Na(1);qf.controlId=R;qf.bindingId=Ha;qf.coerceType=Gb;qf.valueFormat=bc;qf.filterType=Rc;qf.startRow=gd;qf.startCol=wd;qf.rowCount=Ad;qf.colCount=Ld;qf.currentSheetName=
jf;return Cg.g(Ne,"DdaGetBindingData",qf,Ue,df,zf,me,0)},me,567,16)};E.prototype.ddaSetBindingData=function(R,Ha,Gb,bc,Rc,gd,wd){var Ad=this;this.GJ(function(Ld,ce,me){var Je=Ad.$.oa.xa,Ue=Ad.mja();Ld=Mf.b(Ld,gd);ce=Mf.a(ce,Ad.ZH);var df=Je.Na(9);df.controlId=R;df.bindingId=Ha;df.startRow=Gb;df.startCol=bc;df.currentSheetName=Ue;df.bindingData=Rc;return Cg.g(Je,"DdaSetBindingData",df,Ld,ce,me,wd,0)},wd,568)};E.prototype.ddaGetSelectedData=function(R,Ha,Gb,bc,Rc,gd,wd){var Ad=this;this.GJ(function(Ld,
ce,me){var Je=Ad.$.oa.xa,Ue=Ad.mja();Ld=Mf.b(Ld,gd);ce=Mf.a(ce,Ad.ZH);var df=Je.Na(1);df.controlId=R;df.coerceType=Ha;df.valueFormat=Gb;df.filterType=bc;df.currentSheetName=Ue;df.formula=Rc;return Cg.g(Je,"DdaGetSelectedData",df,Ld,ce,me,wd,0)},wd,569,16)};E.prototype.ddaSetSelectedData=function(R,Ha,Gb,bc,Rc){var gd=this;this.GJ(function(wd,Ad,Ld){var ce=gd.$.oa.xa,me=gd.mja();wd=Mf.b(wd,bc);Ad=Mf.a(Ad,gd.ZH);var Je=ce.Na(9);Je.controlId=R;Je.currentSheetName=me;Je.formula=Ha;Je.bindingData=Gb;return Cg.g(ce,
"DdaSetSelectedData",Je,wd,Ad,Ld,Rc,0)},Rc,570)};E.prototype.ddaLoadSettings=function(R,Ha,Gb){var bc=this;this.GJ(function(Rc,gd,wd){var Ad=bc.$.oa.xa;Rc=Mf.b(Rc,Ha);gd=Mf.a(gd,bc.ZH);var Ld=Ad.Na(1);Ld.controlId=R;return Cg.g(Ad,"DdaLoadSettings",Ld,Rc,gd,wd,Gb,0)},Gb,501,16)};E.prototype.ddaSaveSettings=function(R,Ha,Gb,bc,Rc){var gd=this;this.GJ(function(wd,Ad,Ld){var ce=gd.$.oa.xa;wd=Mf.b(wd,bc);Ad=Mf.a(Ad,gd.ZH);var me=ce.Na(9);me.controlId=R;me.settings=Ha;me.overwriteIfStale=Gb;return Cg.g(ce,
"DdaSaveSettings",me,wd,Ad,Ld,Rc,0)},Rc,571)};E.prototype.ddaAddRowsColumns=function(R,Ha,Gb,bc,Rc,gd){var wd=this;this.GJ(function(Ad,Ld,ce){var me=wd.$.oa.xa,Je=wd.mja();Ad=Mf.b(Ad,Rc);Ld=Mf.a(Ld,wd.ZH);var Ue=me.Na(9);Ue.controlId=R;Ue.bindingId=Ha;Ue.isRow=Gb;Ue.currentSheetName=Je;Ue.bindingData=bc;return Cg.g(me,"DdaAddRowsColumns",Ue,Ad,Ld,ce,gd,0)},gd,572)};E.prototype.ddaDeleteAllDataValues=function(R,Ha,Gb,bc){var Rc=this;this.GJ(function(gd,wd,Ad){var Ld=Rc.$.oa.xa,ce=Rc.mja();gd=Mf.b(gd,
Gb);wd=Mf.a(wd,Rc.ZH);var me=Ld.Na(9);me.controlId=R;me.bindingId=Ha;me.currentSheetName=ce;return Cg.g(Ld,"DdaDeleteAllDataValues",me,gd,wd,Ad,bc,0)},bc,573)};E.prototype.ddaClearBindingFormats=function(R,Ha,Gb,bc){var Rc=this;this.GJ(function(gd,wd,Ad){var Ld=Rc.$.oa.xa,ce=Rc.mja();gd=Mf.b(gd,Gb);wd=Mf.a(wd,Rc.ZH);var me=Ld.Na(9);me.controlId=R;me.bindingId=Ha;me.currentSheetName=ce;return Cg.g(Ld,"DdaClearBindingFormats",me,gd,wd,Ad,bc,0)},bc,574)};E.prototype.ddaSetBindingFormats=function(R,Ha,
Gb,bc,Rc,gd){var wd=this;this.GJ(function(Ad,Ld,ce){var me=wd.$.oa.xa,Je=wd.mja();Ad=Mf.b(Ad,Rc);Ld=Mf.a(Ld,wd.ZH);var Ue=me.Na(9);Ue.controlId=R;Ue.bindingId=Ha;Ue.currentSheetName=Je;Ue.bindingData=Gb;Ue.isSetFormats=bc;return Cg.g(me,"DdaSetBindingFormats",Ue,Ad,Ld,ce,gd,0)},gd,575)};E.prototype.parseRange=function(R,Ha,Gb){var bc=this;this.GJ(function(Rc,gd,wd){var Ad=bc.$.oa.xa.Pb();return Cg.w(bc.$.oa.xa,R,-1,Mf.b(Rc,Ha),Mf.a(gd,bc.ZH),wd,Gb,Ad)},Gb,162,16)};E.prototype.parseRangeForGoto=function(R,
Ha,Gb,bc){var Rc=this;this.GJ(function(gd,wd,Ad){var Ld=Rc.$.oa.xa.Pb();return Cg.x(Rc.$.oa.xa,R,Ha,Mf.b(gd,Gb),Mf.a(wd,Rc.ZH),Ad,bc,Ld)},bc,562,16)};E.prototype.executeRichApiRequest=function(R,Ha,Gb){var bc=this;Ve.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(R.RequestFlags&=8191);if(Ve.EwaSettings.ma(259))this.exh(this.$.oa.xa.Pb(),Ha,function(){bc.lQ.wJa(Jf.a.internalError,Gb)},Gb,R);else{var Rc=Xg.DdaFacade.Oed(R);!Ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||
!this.$.ob.sz||Rc&16?(Ve.EwaSettings.Zb()&&(Rc|=64),this.$.userOperationManager.St(new I(this.$,R,function(gd,wd,Ad){return F(bc.$.oa.xa,R,Mf.b(gd,Ha),Mf.a(wd,bc.ZH),Ad,Gb)},Rc))):(this.lQ.wJa(Jf.a.cDc,Gb),Od.ULS.sendTraceTag(537163160,0,50,"Write operation is not allowed"))}};E.prototype.mja=function(){return this.$.ea.isNamedObjectViewMode?this.$.pa.sheetName:this.$.activeItemName};E.prototype.GJ=function(R,Ha,Gb,bc){bc=void 0===bc?0:bc;!Ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||
!this.$.ob.sz||bc&16?Ve.EwaSettings.Zb()?this.$.userOperationManager.St(new gi.a(Gb,0,R,bc|64)):this.$.userOperationManager.St(new vi.a(Gb,0,R,bc)):(this.lQ.wJa(Jf.a.cDc,Ha),Od.ULS.sendTraceTag(537163159,0,50,"Write operation is not allowed"))};E.prototype.exh=function(R,Ha,Gb,bc,Rc){var gd=Xg.DdaFacade.Oed(Rc);if(!Ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.ob.sz||gd&16){var wd=this.$.Fb.sc("UserAction","Rich Api request");Ve.EwaSettings.Zb()&&
(gd|=64);this.$.userOperationManager.Sb(new U(this.$,R,Ha,Gb,bc,wd,Rc,gd),null)}else this.lQ.wJa(Jf.a.cDc,bc),Od.ULS.sendTraceTag(537163158,0,50,"Write operation is not allowed")};Object(Cd.a)(E,"DdaWebServiceHelper",null,[]);Object(Cd.a)(G,"DocumentFile",null,[]);C.generalException="GeneralException";C.sJg="ApiNotFound";C.BBd="OperationCancelled";C.invalidArgument="InvalidArgument";Object(Cd.a)(C,"ErrorCodes",null,[]);x.prototype.replaceShortcuts=function(){return Promise.reject("ReplaceShortcuts method is not overridden")};
x.prototype.getShortcuts=function(){return Promise.reject("GetShortcuts method is not overridden")};x.prototype.checkShortcutsInUse=function(){return Promise.reject("CheckShortcutsInUse method is not overridden")};Object(Cd.a)(x,"WacApiDelegates",null,[]);var Mj=b(712);Rk(y,x);y.prototype.replaceShortcuts=function(R){return OfficeExt.ShortcutKeyDispatchManager.replaceShortcuts(this.addinId,R,this.ngf)};y.prototype.getShortcuts=function(){return OfficeExt.ShortcutKeyDispatchManager.getShortcuts(this.addinId)};
y.prototype.checkShortcutsInUse=function(R){return OfficeExt.ShortcutKeyDispatchManager.checkShortcutsInUse(R,this.ngf)};y.d7g=function(R,Ha){var Gb=document.createEvent("KeyboardEvent");if(Oh.a.hF)Gb.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,!!(R&8),!!(R&32),!!(R&4),!!(R&256));else{var bc=[];R&4&&bc.push("Shift");R&8&&bc.push("Control");R&32&&bc.push("Alt");Gb.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,bc.join(" "),!1,"en-US")}R=new Sys.UI.DomEvent(Gb);R.keyCode=Ha;return R};y.H2g=
function(R,Ha){if(Oh.a.xf)switch(Ha){case 189:Ha=173;break;case 187:Ha=61;break;case 186:Ha=59}return y.d7g(R,Ha)};Object(Cd.a)(y,"ExcelWacApiDelegates",x,[]);B.prototype.KAg=function(R,Ha){this.gdc(R)||(this.nIa[R]={});if(this.zgi(R))return Od.ULS.sendTraceTag(537163157,344,50,"App {0} has reach the limit of number of cached files.",R),Jf.a.Mzi;this.nIa[R][Ha.Uyh.toString()]=Ha;return Jf.a.success};B.prototype.UMh=function(R,Ha){var Gb=null;this.gdc(R)&&(Gb=this.nIa[R][Ha.toString()]);Gb||Od.ULS.sendTraceTag(537163156,
344,15,"File cache for [agave:{0}, fileHandler:{1}] doesn't exist",R,Ha);return Gb};B.prototype.gdc=function(R){return R in this.nIa};B.prototype.v9i=function(R,Ha){if(this.gdc(R)){var Gb=this.nIa[R];delete Gb[Ha.toString()];1>Object.keys(Gb).length&&delete this.nIa[R];return Ha.toString()in Gb?Jf.a.internalError:Jf.a.success}return Jf.a.internalError};B.prototype.zgi=function(R){return this.gdc(R)?Object.keys(this.nIa[R]).length>=this.ezi:!1};B.getInstance=function(R){return R.da.za(200)||R.da.Ga(200,
new B(B.fzi))};B.eDi=function(){return++B.YSg};B.Lyi=4194304;B.fzi=1;B.YSg=0;Object(Cd.a)(B,"GetFileApiHelper",null,[]);A.prototype.notifyActionHandlerReady=function(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.nA)};A.prototype.getTypeName=function(){return"Microsoft.InternalService.AddinInternalService"};A.prototype.invokePropertyGet=function(R){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);};A.prototype.invokePropertyGetAsync=function(R){R=this.invokePropertyGet(R);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(R)};A.prototype.invokePropertySet=function(R){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);};A.prototype.invokePropertySetAsync=function(R,Ha){this.invokePropertySet(R,Ha);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};A.prototype.invokeMethod=function(R){switch(R){case 1:return this.NDi()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);};A.prototype.invokeMethodAsync=
function(R,Ha){R=this.invokeMethod(R,Ha);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(R)};A.prototype.NDi=function(){this.notifyActionHandlerReady();return null};Object(Cd.a)(A,"AddinInternalService",null,[]);v.prototype.getAppRuntimeState=function(){return this.KI.getAppRuntimeState(this.nA)?2:1};v.prototype.setAppRuntimeState=function(R){switch(R){case 2:R=!0;break;case 1:R=!1;break;default:throw OfficeExtension.WacRuntime.Utility.createRichApiException(jg.a.invalidArgument,
Ph.a.ga(1744));}this.KI.setAppRuntimeState(this.nA,R)};v.prototype.getTypeName=function(){return"Microsoft.AppRuntime.AppRuntimeService"};v.prototype.invokePropertyGet=function(R){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);};v.prototype.invokePropertyGetAsync=function(R){R=this.invokePropertyGet(R);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(R)};v.prototype.invokePropertySet=function(R){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);
};v.prototype.invokePropertySetAsync=function(R,Ha){this.invokePropertySet(R,Ha);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};v.prototype.invokeMethod=function(R,Ha){switch(R){case 2:return this.aIh();case 1:return this.moj(Ha)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);};v.prototype.invokeMethodAsync=function(R,Ha){R=this.invokeMethod(R,Ha);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(R)};v.prototype.aIh=function(){return this.getAppRuntimeState()};
v.prototype.moj=function(R){R=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(R,0,"int");this.setAppRuntimeState(R);return null};Object(Cd.a)(v,"AppRuntimeService",null,[]);var Ai=b(1174);r.prototype.disable=function(){try{if(!Ph.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.kCe();if(!this.Kff())return this.lCe();this.o1.QOj(this.ax)}catch(R){return Od.ULS.sendTraceTag(538572829,0,15,"BeforeDocumentCloseNotification.Disable() Failed. reason: {0}",
R.message||"Unknown"),this.iCe()}return null};r.prototype.enable=function(){try{if(!Ph.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.kCe();if(!this.Kff())return this.lCe();this.o1.z7i(this.ax)}catch(R){return Od.ULS.sendTraceTag(538572828,0,15,"BeforeDocumentCloseNotification.Enable() Failed. reason: {0}",R.message||"Unknown"),this.iCe()}return null};r.prototype._OnAccess=function(){};r.prototype.getTypeName=function(){return"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification"};
r.prototype.invokePropertyGet=function(R){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);};r.prototype.invokePropertyGetAsync=function(R){R=this.invokePropertyGet(R);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(R)};r.prototype.invokePropertySet=function(R){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);};r.prototype.invokePropertySetAsync=function(R,Ha){this.invokePropertySet(R,Ha);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
r.prototype.invokeMethod=function(R){switch(R){case 1:return this.gCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);};r.prototype.invokeMethodAsync=function(R,Ha){switch(R){case 3:return this.lfh();case 2:return this.ekh()}R=this.invokeMethod(R,Ha);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(R)};r.prototype.lfh=function(){return this.disable()};r.prototype.ekh=function(){return this.enable()};r.prototype.gCa=function(){this._OnAccess();return null};
r.prototype.kCe=function(){return Ai.a(jg.a.notImplemented,Ph.a.ga(1745))};r.prototype.lCe=function(){return Ai.a(jg.a.sharedRuntimeNotAvailable,Ph.a.ga(1749))};r.prototype.iCe=function(){return Ai.a(jg.a.generalException,Ph.a.ga(1740))};r.prototype.Kff=function(){var R=this.Ey.getSharedRuntimeId();return!!R&&0<R.length};Object(Cd.a)(r,"BeforeDocumentCloseNotification",null,[]);z.prototype.getTypeName=function(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"};z.prototype.invokePropertyGet=
function(R){switch(R){case 1:return this.enabled;case 3:return this.nativeRuntime;case 2:return this.streamingEnabled}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);};z.prototype.invokePropertyGetAsync=function(R){R=this.invokePropertyGet(R);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(R)};z.prototype.invokePropertySet=function(R,Ha){switch(R){case 1:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ha,0,"boolean");return;case 3:this.nativeRuntime=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ha,0,"boolean");return;case 2:this.streamingEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ha,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);};z.prototype.invokePropertySetAsync=function(R,Ha){this.invokePropertySet(R,Ha);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};z.prototype.invokeMethod=function(R){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);
};z.prototype.invokeMethodAsync=function(R,Ha){R=this.invokeMethod(R,Ha);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(R)};Af.Object.defineProperties(z.prototype,{enabled:{configurable:!0,enumerable:!0,get:function(){return this.hA},set:function(R){this.hA=R}},nativeRuntime:{configurable:!0,enumerable:!0,get:function(){return this.Tae},set:function(R){this.Tae=R}},streamingEnabled:{configurable:!0,enumerable:!0,get:function(){return this.Hge},set:function(R){this.Hge=R}}});Object(Cd.a)(z,
"CustomFunctionEngineStatus",null,[]);n.prototype.register=function(R){return OfficeExtension.WacRuntime.Utility.createPromise(this.sug(R))};n.prototype.getTypeName=function(){return"Microsoft.ExcelServices.CustomFunctionManager"};n.prototype.invokePropertyGet=function(R){switch(R){case 2:return this.status}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);};n.prototype.invokePropertyGetAsync=function(R){R=this.invokePropertyGet(R);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(R)};
n.prototype.invokePropertySet=function(R){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);};n.prototype.invokePropertySetAsync=function(R,Ha){this.invokePropertySet(R,Ha);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};n.prototype.invokeMethod=function(R){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);};n.prototype.invokeMethodAsync=function(R,Ha){switch(R){case 1:return this.p8i(Ha)}R=this.invokeMethod(R,Ha);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(R)};
n.prototype.p8i=function(R){var Ha=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(R,0,"string");R=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(R,1,"string");return this.register(Ha,R)};Af.Object.defineProperties(n.prototype,{status:{configurable:!0,enumerable:!0,get:function(){var R=new z;R.enabled=this.pqg;R.streamingEnabled=this.qqg;R.nativeRuntime=!1;return R}}});Object(Cd.a)(n,"CustomFunctionManager",null,[]);var sj=b(1155);w.prototype._RegisterStateChange=function(){var R=
this;this.fSb||this.WO.execute(function(Ha){R.X1d=Ha.zma(R._id,function(Gb){R.KI.YAh(R.nA,R._id,JSON.stringify(Gb))})});this.fSb++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};w.prototype._UnregisterStateChange=function(){var R=this;this.fSb--;this.fSb||this.WO.execute(function(Ha){Ha.JHd(R._id,R.X1d)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};w.prototype.getTypeName=function(){return"Microsoft.Office.Licensing.LicenseFeature"};w.prototype.invokePropertyGet=
function(R){switch(R){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);};w.prototype.invokePropertyGetAsync=function(R){R=this.invokePropertyGet(R);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(R)};w.prototype.invokePropertySet=function(R){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);};w.prototype.invokePropertySetAsync=function(R,Ha){this.invokePropertySet(R,Ha);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
w.prototype.invokeMethod=function(R){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);};w.prototype.invokeMethodAsync=function(R,Ha){switch(R){case 6:return this.Gjg();case 7:return this.Ijg()}R=this.invokeMethod(R,Ha);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(R)};w.prototype.Gjg=function(){return this._RegisterStateChange()};w.prototype.Ijg=function(){return this._UnregisterStateChange()};Af.Object.defineProperties(w.prototype,{id:{configurable:!0,enumerable:!0,
get:function(){return this._id}}});Object(Cd.a)(w,"LicenseFeature",null,[]);f.prototype.getFeatureTier=function(R,Ha){var Gb=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(bc){var Rc=1===Ha?1:2===Ha?2:0;Gb.WO.execute(function(gd){gd.getFeatureTier(R,Rc).then(function(wd){bc(Gb.aRh(wd))},function(){bc(Ha)})})})};f.prototype.getLicenseFeature=function(R){R=new w(this.WO,R,this.nA,this.KI);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(R)};f.prototype.isFeatureEnabled=
function(R,Ha){var Gb=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(bc){Gb.WO.execute(function(Rc){Rc.isFeatureEnabled(R,Ha).then(function(gd){bc(gd)},function(){bc(Ha)})})})};f.prototype.isFreemiumUpsellEnabled=function(){var R=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Ha){R.WO.execute(function(Gb){Gb=Gb.isFreemiumUpsellEnabled();Ha(Gb)})})};f.prototype.launchUpsellExperience=function(R){var Ha=this;if(this.htg.isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(function(){Ha.WO.execute(function(Gb){Gb.launchUpsellExperience(R)})});
throw OfficeExtension.WacRuntime.Utility.createRichApiException(jg.a.PSc,"");};f.prototype._TestFireStateChangedEvent=function(){};f.prototype.getTypeName=function(){return"Microsoft.Office.Licensing.License"};f.prototype.invokePropertyGet=function(R){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);};f.prototype.invokePropertyGetAsync=function(R){R=this.invokePropertyGet(R);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(R)};f.prototype.invokePropertySet=function(R){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);
};f.prototype.invokePropertySetAsync=function(R,Ha){this.invokePropertySet(R,Ha);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};f.prototype.invokeMethod=function(R,Ha){switch(R){case 6:return this.Hjg(Ha)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);};f.prototype.invokeMethodAsync=function(R,Ha){switch(R){case 2:return this.ONh(Ha);case 5:return this.$Qh(Ha);case 1:return this.nhi(Ha);case 3:return this.Uhi();case 4:return this.tri(Ha)}R=this.invokeMethod(R,
Ha);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(R)};f.prototype.ONh=function(R){var Ha=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(R,0,"string");R=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(R,1,"int");return this.getFeatureTier(Ha,R)};f.prototype.$Qh=function(R){R=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(R,0,"string");return this.getLicenseFeature(R)};f.prototype.nhi=function(R){var Ha=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(R,
0,"string");R=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(R,1,"boolean");return this.isFeatureEnabled(Ha,R)};f.prototype.Uhi=function(){return this.isFreemiumUpsellEnabled()};f.prototype.tri=function(R){R=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(R,0,"string");return this.launchUpsellExperience(R)};f.prototype.Hjg=function(R){R=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(R,0,"string");this._TestFireStateChangedEvent(R);return null};f.prototype.aRh=function(R){switch(R){case 1:return 1;
case 2:return 2;default:return 0}};Object(Cd.a)(f,"License",null,[]);var Nj=b(159);l.prototype.areShortcutsInUse=function(R){var Ha=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Gb,bc){Ha.Oud.checkShortcutsInUse(R).then(function(Rc){Gb(Rc)}).catch(function(Rc){bc(Rc)})})};l.prototype.getShortcuts=function(){var R=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Ha,Gb){R.Oud.getShortcuts().then(function(bc){Ha(bc)}).catch(function(bc){Gb(bc)})})};l.prototype.replaceShortcuts=
function(R){var Ha=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Gb,bc){Ha.Oud.replaceShortcuts(R).then(function(){Gb(null)}).catch(function(Rc){bc(Rc)})})};l.prototype.getTypeName=function(){return"Microsoft.Office.ActionService"};l.prototype.invokePropertyGet=function(R){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);};l.prototype.invokePropertyGetAsync=function(R){R=this.invokePropertyGet(R);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(R)};
l.prototype.invokePropertySet=function(R){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);};l.prototype.invokePropertySetAsync=function(R,Ha){this.invokePropertySet(R,Ha);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};l.prototype.invokeMethod=function(R){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);};l.prototype.invokeMethodAsync=function(R,Ha){switch(R){case 3:return this.bLg(Ha);case 1:return this.mXh();case 2:return this.Tdj(Ha)}R=
this.invokeMethod(R,Ha);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(R)};l.prototype.bLg=function(R){R=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(R,0,"Array<string>");return this.areShortcutsInUse(R)};l.prototype.mXh=function(){return this.getShortcuts()};l.prototype.Tdj=function(R){R=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(R,0,"any");return this.replaceShortcuts(R)};Object(Cd.a)(l,"ActionService",null,[]);var tj=b(567);k.prototype.ZWh=function(){this.fra||
(this.fra=tj.a.Mq(Rg.a.instance.Tb("Common.App.SharedFilePicker.ISharedFilePicker")));return this.fra};k.prototype.getSharedFilePickerResponse=function(R){var Ha=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Gb,bc){try{var Rc=Ha.ZWh();wh.Task.WAA.call(null,Rc).continueWith(function(){var gd=Rc.result;if(gd){var wd={};(function(){var Ad=Ih.d(R);wd=Ad.Pt;return Ad})().returnValue?gd.sdd(wd).then(function(Ad){Ad&&0<Ad.length?Gb(Ad):bc(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",
"The picker returned null or an empty array."))}).catch(function(Ad){bc(Ad)}):bc(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else bc(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker is resolved as null."))})}catch(gd){bc(gd)}})};k.prototype.getTypeName=function(){return"Microsoft.Office.SharedFilePicker"};k.prototype.invokePropertyGet=function(R){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);
};k.prototype.invokePropertyGetAsync=function(R){R=this.invokePropertyGet(R);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(R)};k.prototype.invokePropertySet=function(R){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);};k.prototype.invokePropertySetAsync=function(R,Ha){this.invokePropertySet(R,Ha);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};k.prototype.invokeMethod=function(R){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(R);
};k.prototype.invokeMethodAsync=function(R,Ha){switch(R){case 1:return this.YWh(Ha)}R=this.invokeMethod(R,Ha);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(R)};k.prototype.YWh=function(R){R=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(R,0,"string");return this.getSharedFilePickerResponse(R)};Object(Cd.a)(k,"SharedFilePicker",null,[]);e.prototype.createInstance=function(R,Ha){switch(R){case "Microsoft.Office.ActionService":return new l(Ha);case "Microsoft.Office.SharedFilePicker":return new k}return null};
Object(Cd.a)(e,"WacApiHost",null,[]);d.prototype.hostName=function(){return"ExcelOnline"};d.prototype.appId=function(){return this.nQb};d.prototype.createInstance=function(R){switch(R){case "Microsoft.Authentication.AuthenticationService":return Rg.a.instance.resolve("Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").create(this.nA,this.KI.ri);case "Microsoft.Authentication.TokenParameters":return new ia;case "Microsoft.ExcelServices.CustomFunctionManager":R=this.jb.ma(122);
var Ha=this.jb.ma(123);return new n(R,Ha,m(this.nQb,this.jb,this.KI));case "Microsoft.AppRuntime.AppRuntimeService":return new v(this.nA,this.KI);case "Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification":return R=Xf.a(this.jb),new r(this.nQb,this.nA,R,this.KI);case "Microsoft.DynamicRibbon.DynamicRibbon":return R=Xf.a(this.jb),new sj.DynamicRibbon(this.nQb,this.nA,this.KI,R,R.Vm(this.nA).$k);case "Microsoft.Office.Licensing.License":return new f(this.nA,this.KI);case "Microsoft.InternalService.AddinInternalService":return new A(this.nA);
default:if(this.uSc||(this.uSc=new e),Ha=this.uSc.createInstance(R,this.yyg))return Ha}Od.ULS.sendTraceTag(537163155,0,10,"Typename: {0} is an invalid parameter for the RichApiHost.CreateInstance method.",R);throw OfficeExtension.WacRuntime.Utility.createRichApiException(jg.a.generalException,jg.a.generalException);};Object(Cd.a)(d,"RichApiHost",null,[]);var Vi=b(409),aa=b(28),Ga=b(119),vb=b(34),hc=b(101),Fc=b(297),ad=b(42),Zc=b(260),Nc=b(6),Lc=b(67),hd=b(205);c.prototype.dispose=function(){this.$=
this.X8b=null};c.prototype.Lc=function(){return!1};c.prototype.Qc=function(){return!1};c.prototype.executeCommand=function(R,Ha,Gb){R=Ha.command;switch(R){case 451041795:this.re.ef(Gb[dh.a.Vf],Gb[dh.a.o3]);break;case 974713501:this.J2h(Gb[dh.a.Vf],Gb[dh.a.o3]);break;case 1237877382:this.re.Lu(Gb[dh.a.o3]);break;default:return Hi.a(R)}return wh.Task.Ua(!0)};c.prototype.Ac=function(R,Ha,Gb){if(R=!!Gb)switch(Ha.command){case 974713501:case 1237877382:case 451041795:break;default:R=!1}return R};c.prototype.J2h=
function(R,Ha){var Gb,bc=R.DdaMethod;if("undefined"===typeof bc.DispatchId)this.re.ef(Jf.a.internalError,Ha);else if(c.sgi(R)||this.$.Bd&1){if(bc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(new O(this.$,this,R,Ha)).start(this.te,R.DdaMethod.ControlId):bc.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.yWh(R,Ha):bc.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.Isj(R,Ha):bc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?
this.addBinding(R,this.Rcd(R.DdaMethod.ControlId),0,Ha):bc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?this.JIh(R,Ha):bc.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.xoj(R,Ha):bc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.IIh(R,Ha):bc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?this.u9i(R,Ha):bc.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.FHh(R,Ha):bc.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?
this.Ssd(R,Ha):bc.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.saveSettings(R,Ha):bc.DispatchId===OSF.DDA.MethodDispId.dispidAddRowsMethod?(R.DdaAddRowsColumns.IsRow=!0,this.tle(R,Ha)):bc.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(R.DdaAddRowsColumns.IsRow=!1,this.tle(R,Ha)):bc.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?this.Vch(R,Ha):bc.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.IXg(R,Ha):bc.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?
(R.DdaSetBindingFormats.IsSetFormats=!0,this.JXf(R,Ha)):bc.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?(R.DdaSetBindingFormats.IsSetFormats=!1,this.JXf(R,Ha)):bc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?this.addBinding(R,R.DdaBindingsMethod.ItemName,R.DdaBindingsMethod.FailOnCollision?2:1,Ha):bc.DispatchId===OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.SNh(Ha):bc.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.ywd(R,Ha):bc.DispatchId===
OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.executeRichApiRequest(R,Ha):bc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?this.RMh(R,Ha):bc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.SMh(R,Ha):bc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.w9i(R,Ha):bc.DispatchId===OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(R.DdaMethod.ControlId,R),this.re.Lu(Ha)):
bc.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?Ve.EwaSettings.ma(24)?this.re.ef(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ha):this.hAi(R,Ha):bc.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?Ve.EwaSettings.ma(24)?this.re.ef(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ha):this.dAi(R,Ha):bc.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.getAccessToken(R,Ha):bc.DispatchId===OSF.DDA.MethodDispId.dispidGetAuthContextMethod?
this.getAuthContext(R,Ha):this.re.ef(Jf.a.FBd,Ha),Ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5649666_AddLogForExcelOnlineCommonAPIUsage")&&bc.DispatchId!==OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod){R=this.te.iZ(R.DdaMethod.ControlId);Ha="";if(R){Ha=Xg.DdaFacade.getSolutionId(R,this.$);var Rc=R.PrimaryMarketplace.MarketplaceType;Rc===OSF.StoreType.InMemory?R.OwnerAddinSolutionId&&R.AssetMarketplace&&(Rc=R.AssetMarketplace.MarketplaceType):Rc===OSF.StoreType.WopiCatalog&&(Rc=OSF.StoreType.OMEX);
Ha=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ha,Rc,null===(Gb=R.AssetMarketplace)||void 0===Gb?void 0:Gb.SolutionId,null,null,R.PrimaryMarketplace.MarketplaceRef)}Od.ULS.sendTraceTag(537163224,344,50,"DDA method Id: {0}, AppID: {1}",bc.DispatchId,Ha)}}else this.re.ef(Jf.a.mIe,Ha)};c.prototype.JIh=function(R,Ha){var Gb=this;R.DdaGetBindingData.CoerceType=c.F2b(R.DdaGetBindingData.CoerceType);R.DdaGetBindingData.FilterType=c.fSe(R.DdaGetBindingData.FilterType);R.DdaGetBindingData.ValueFormat=c.Neg(R.DdaGetBindingData.ValueFormat);
if(this.lic(R.DdaGetBindingData.CoerceType,Ha)){if(R.DdaGetBindingData){var bc=R.DdaGetBindingData;0===bc.FilterType&&(bc.FilterType=2);bc.StartCol|=0;bc.StartRow|=0;bc.ColCount=void 0===bc.ColCount?-1:bc.ColCount;bc.RowCount=void 0===bc.RowCount?-1:bc.RowCount}this.Yz.ddaGetBindingData(R.DdaMethod.ControlId,R.DdaGetBindingData.BindingId,R.DdaGetBindingData.CoerceType,R.DdaGetBindingData.ValueFormat,R.DdaGetBindingData.FilterType,R.DdaGetBindingData.StartRow,R.DdaGetBindingData.StartCol,R.DdaGetBindingData.RowCount,
R.DdaGetBindingData.ColCount,function(Rc){if(Zg.a(Rc)||!Rc.Result)Gb.re.aH(Rc,Ha);else{var gd=Gb.re.SP();gd.Data=c.Nte(Rc.Result);Ha(gd)}},Ha)}};c.prototype.xoj=function(R,Ha){var Gb=this;R.DdaSetBindingData.CoerceType=c.F2b(R.DdaSetBindingData.CoerceType);if(this.lic(R.DdaSetBindingData.CoerceType,Ha)){var bc=c.lYc(R.DdaSetBindingData.CoerceType,R.DdaSetBindingData.Data);c.mfc(bc)?this.re.ef(Jf.a.UAc,Ha):(1===bc.CoerceType&&(bc.CellFormat||(bc.CellFormat=R.DdaSetBindingData.CellFormat),bc.TableOptions||
(bc.TableOptions=R.DdaSetBindingData.TableOptions)),R.DdaSetBindingData&&(R.DdaSetBindingData.StartCol|=0,R.DdaSetBindingData.StartRow|=0),this.Yz.ddaSetBindingData(R.DdaMethod.ControlId,R.DdaSetBindingData.BindingId,R.DdaSetBindingData.StartRow,R.DdaSetBindingData.StartCol,bc,function(Rc){Zg.a(Rc)?Gb.re.aH(Rc,Ha):Gb.re.Lu(Ha)},Ha))}};c.prototype.yWh=function(R,Ha){var Gb=this;R.DdaGetBindingData.CoerceType=c.F2b(R.DdaGetBindingData.CoerceType);R.DdaGetBindingData.ValueFormat=c.Neg(R.DdaGetBindingData.ValueFormat);
R.DdaGetBindingData.FilterType=c.fSe(R.DdaGetBindingData.FilterType);if(this.lic(R.DdaGetBindingData.CoerceType,Ha)){var bc=this.Rcd(R.DdaMethod.ControlId);bc?this.Yz.ddaGetSelectedData(R.DdaMethod.ControlId,R.DdaGetBindingData.CoerceType,R.DdaGetBindingData.ValueFormat,R.DdaGetBindingData.FilterType,bc,function(Rc){if(Zg.a(Rc))Gb.re.aH(Rc,Ha);else{var gd=Gb.re.SP();gd.Data=c.Nte(Rc.Result);Ha(gd)}},Ha):this.re.ef(Jf.a.s1e,Ha)}};c.prototype.RMh=function(R,Ha){var Gb=this;if(Oh.a.eod)this.re.ef(Jf.a.ePg,
Ha);else{var bc=R[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],Rc=R[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],gd=R.DdaMethod.ControlId,wd=B.getInstance(this.$);if(0>=Rc)Od.ULS.sendTraceTag(537163221,344,15,"Invalid slice size. It should be greater than 0."),this.re.ef(Jf.a.Yci,Ha);else if(Rc>B.Lyi)Od.ULS.sendTraceTag(537163220,344,15,"Invalid slice size. It should be not greater than 4MB."),this.re.ef(Jf.a.FXe,Ha);else{var Ad=null;switch(bc){case 1:Ad="Compressed";
break;case 0:Ad="Text";break;case 2:Ad="Pdf";break;default:Od.ULS.sendTraceTag(537163219,344,15,"Requested file type {0} is not supported.",bc);this.re.ef(Jf.a.URe,Ha);return}if("Text"===Ad)Od.ULS.sendTraceTag(537163218,344,15,"Requested file type {0} is not supported.",Ad),this.re.ef(Jf.a.URe,Ha);else{Ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4182305_AddWholeWorkbookPrintOptionToGetFileAPI")?(R=new Sys.StringBuilder,R.append(pj.a(this.$,Ad)),"Pdf"===Ad&&Xj.a.Qg(R,nh.a.mFd,"WholeWorkbook"),R=
R.toString()):R=pj.a(this.$,Ad);var Ld=null,ce=new XMLHttpRequest;ce.onreadystatechange=function(){if(4===ce.readyState)if(200===ce.status){var me=ce.response;if(me){Ld=new Uint8Array(me);me=Gb.re.SP();for(var Je=Ld.length,Ue=B.eDi(),df={},zf=0,Ne=0;Ne<Je;Ne+=Rc){for(var jf=[],qf=Ne+Rc<Je?Ne+Rc:Je,Df=0,Gf=Ne;Gf<qf;Df++,Gf++)jf[Df]=Ld[Gf];df[(zf++).toString()]=jf}df=new G(Ue,Je,Rc,df);df=wd.KAg(gd,df);df!==Jf.a.success?Gb.re.ef(df,Ha):(me[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=
Ue,me[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=Je,Od.ULS.sendTraceTag(537163216,344,50,"GetFileAsync get file successfully for file type {0}, the file size is {1}",Ad,Je),Ha(me))}else Od.ULS.sendTraceTag(537163217,344,15,"Request is successful, but respone have no data for file type {0}.",Ad),Gb.re.ef(Jf.a.internalError,Ha)}else 500===ce.status?Gb.re.ef(Jf.a.vUe(parseInt(ce.statusText,10)),Ha):(Od.ULS.sendTraceTag(537163215,344,15,"Request failed to obtain the file for type {0}.",
Ad),Gb.re.ef(Jf.a.LCi,Ha))};ce.open("GET",R,!0);ce.responseType="arraybuffer";ce.setRequestHeader("If-Modified-Since","0");ce.send(null)}}}};c.prototype.SMh=function(R,Ha){var Gb=R[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],bc=R[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];R=R.DdaMethod.ControlId;(Gb=B.getInstance(this.$).UMh(R,Gb))?(Gb=Gb.iCj,0>bc||bc>=Object.keys(Gb).length?this.re.ef(Jf.a.B8h,Ha):(bc=Gb[bc.toString()],Gb=this.re.SP(),Gb[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=
bc,Gb[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=bc.length,Ha(Gb))):this.re.ef(Jf.a.internalError,Ha)};c.prototype.w9i=function(R,Ha){var Gb=R[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];R=R.DdaMethod.ControlId;Gb=B.getInstance(this.$).v9i(R,Gb);Gb===Jf.a.success?this.re.Lu(Ha):this.re.ef(Gb,Ha)};c.prototype.Isj=function(R,Ha){var Gb=this;R.DdaSetBindingData.CoerceType=c.F2b(R.DdaSetBindingData.CoerceType);if(this.lic(R.DdaSetBindingData.CoerceType,Ha)){var bc=
this.Rcd(R.DdaMethod.ControlId);if(bc){var Rc=c.lYc(R.DdaSetBindingData.CoerceType,R.DdaSetBindingData.Data),gd=qg.g(this.$).ha;1===Rc.CoerceType&&(!Rc.Data&&gd.sa.k5&&(Rc.Headers||(Rc.Headers=[]),Rc.Headers.length||Rc.Headers.push([]),Rc.Headers[0].length||Array.add(Rc.Headers[0],"")),c.mfc(Rc)||(Rc.CellFormat||(Rc.CellFormat=R.DdaSetBindingData.CellFormat),Rc.TableOptions||(Rc.TableOptions=R.DdaSetBindingData.TableOptions)));if(c.mfc(Rc))this.re.ef(Jf.a.UAc,Ha);else{var wd=gd.sa.Vc.clone(),Ad=gd.sa.activeCell.clone();
this.Yz.ddaSetSelectedData(R.DdaMethod.ControlId,bc,Rc,function(Ld){var ce;if(Zg.a(Ld))Gb.re.aH(Ld,Ha);else{Ld=wd.clone();var me=Rc.Headers?Rc.Headers[0].length:Rc.Data[0].length;1!==Rc.CoerceType||Rc.Data?1===Rc.CoerceType&&(null===(ce=Rc.TableOptions)||void 0===ce?0:ce.length)&&0==Rc.TableOptions[0]?(Ld.top+=1,Ld.bottom=Ld.top+Rc.Data.length-1):Ld.bottom=Ld.top+Rc.Data.length-(1===Rc.CoerceType?0:1):Ld.bottom=Ld.top+1;Ld.right=Ld.left+me-1;ce=Ld.contains(Ad)?Ad:Ld.topLeft;gd.updateSelection(Ld,
ce,0);Gb.re.Lu(Ha)}},Ha)}}else this.re.ef(Jf.a.hwe,Ha)}};c.prototype.addBinding=function(R,Ha,Gb,bc){var Rc=this;Ha?this.Yz.ddaAddBinding(R.DdaMethod.ControlId,R.DdaBindingsMethod.BindingId,R.DdaBindingsMethod.BindingType,Ha,Gb,function(gd){if(Zg.a(gd))Rc.re.aH(gd,bc);else{var wd=Rc.re.SP();wd.Bindings=Array(1);wd.Bindings[0]=Rc.te.o0b(gd.Result);bc(wd)}},bc):this.re.ef(Jf.a.Olj,bc)};c.prototype.IIh=function(R,Ha){var Gb=this;this.Yz.ddaGetBinding(R.DdaMethod.ControlId,R.DdaBindingsMethod.BindingId,
function(bc){if(Zg.a(bc)||!bc.Result)Gb.re.aH(bc,Ha);else{var Rc=Gb.re.SP();Rc.Bindings=Array(1);Rc.Bindings[0]=Gb.te.o0b(bc.Result);Ha(Rc)}},Ha)};c.prototype.SNh=function(R){var Ha=this.re.SP(),Gb={};Gb[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.$.workbookContext.ClientUrl;Ha[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=Gb;R(Ha)};c.prototype.u9i=function(R,Ha){var Gb=this;this.Yz.ddaReleaseBinding(R.DdaMethod.ControlId,R.DdaBindingsMethod.BindingId,function(bc){Zg.a(bc)?
Gb.re.aH(bc,Ha):Gb.re.Lu(Ha)},Ha)};c.prototype.FHh=function(R,Ha){var Gb=this;this.Yz.ddaGetAllBindings(R.DdaMethod.ControlId,function(bc){if(Zg.a(bc))Gb.re.aH(bc,Ha);else{var Rc=Gb.re.SP();if(bc.Result){bc=bc.Result;Rc.Bindings=Array(bc.length);for(var gd=0;gd<bc.length;gd++)Rc.Bindings[gd]=Gb.te.o0b(bc[gd])}else Rc.Bindings=null;Ha(Rc)}},Ha)};c.prototype.Ssd=function(R,Ha){var Gb=this;this.Yz.ddaLoadSettings(R.DdaMethod.ControlId,function(bc){if(Zg.a(bc))Gb.re.aH(bc,Ha);else{var Rc=Gb.re.SP();Rc.Properties=
bc.Result;Ha(Rc)}},Ha)};c.prototype.saveSettings=function(R,Ha){for(var Gb=this,bc={Settings:[]},Rc=0;Rc<R.DdaSettingsMethod.Properties.length;Rc++){var gd={};gd.Name=R.DdaSettingsMethod.Properties[Rc][0];gd.Value=R.DdaSettingsMethod.Properties[Rc][1];bc.Settings[Rc]=gd}this.Yz.ddaSaveSettings(R.DdaMethod.ControlId,bc,R.DdaSettingsMethod.OverwriteIfStale,function(wd){Zg.a(wd)?Gb.re.aH(wd,Ha):Gb.re.Lu(Ha)},Ha)};c.prototype.tle=function(R,Ha){var Gb=this,bc=c.lYc(1,R.DdaAddRowsColumns.Data);c.mfc(bc)?
this.re.ef(Jf.a.UAc,Ha):this.Yz.ddaAddRowsColumns(R.DdaMethod.ControlId,R.DdaAddRowsColumns.BindingId,R.DdaAddRowsColumns.IsRow,bc,function(Rc){Zg.a(Rc)?Gb.re.aH(Rc,Ha):Gb.re.Lu(Ha)},Ha)};c.prototype.Vch=function(R,Ha){var Gb=this;this.Yz.ddaDeleteAllDataValues(R.DdaMethod.ControlId,R.DdaBindingsMethod.BindingId,function(bc){Zg.a(bc)?Gb.re.aH(bc,Ha):Gb.re.Lu(Ha)},Ha)};c.prototype.IXg=function(R,Ha){var Gb=this;this.Yz.ddaClearBindingFormats(R.DdaMethod.ControlId,R.DdaClearBindingFormats.BindingId,
function(bc){Zg.a(bc)?Gb.re.aH(bc,Ha):Gb.re.Lu(Ha)},Ha)};c.prototype.JXf=function(R,Ha){var Gb=this,bc={},Rc=R.DdaSetBindingFormats.IsSetFormats;Rc?bc.CellFormat=R.DdaSetBindingFormats.CellFormat:bc.TableOptions=R.DdaSetBindingFormats.TableOptions;this.Yz.ddaSetBindingFormats(R.DdaMethod.ControlId,R.DdaSetBindingFormats.BindingId,bc,Rc,function(gd){Zg.a(gd)?Gb.re.aH(gd,Ha):Gb.re.Lu(Ha)},Ha)};c.prototype.executeRichApiRequest=function(R,Ha){var Gb=this,bc,Rc=R.ArrayData,gd={},wd=qg.g(this.$).ha;if(Rc){if("WacPartition"===
Rc[0]){this.Kwh(R,Ha);return}var Ad=Object(bg.a)(Xg.DdaFacade,Xf.a(this.$));if("SetOsfControlContainerReadyForCustomFunctions"===Rc[0]){var Ld=Ad.Vm(R.DdaMethod.ControlId);Ld&&(Ld.Jod=!0,Ld.MIf())}gd.HttpMethod=Rc[1];gd.PathAndQuery=Rc[2];gd.RequestHeaders=c.WYe(Rc[3]);gd.RequestBody=Rc[4];gd.AppPermission=Rc[5];Ld=Rc[6];gd.RequestFlags=Ld;var ce=0;if(li.i(this.$.pa))switch(wd.Qe){case 1:ce=2;break;case 2:ce=3;break;case 128:ce=4;break;default:ce=1}var me=null;wd.Oa.sC&&(me=wd.Oa.sC.Ei);gd.SheetMultiRange=
Th.r(wd.sa.selectedRanges,this.$);gd.ActiveCell=Th.v(wd.sa.activeCell,this.$);gd.ActiveChartId=me;gd.SelectionState=ce;ce=this.te.iZ(R.DdaMethod.ControlId);gd.InstanceId=ce?ce.InstanceId:"";if(ce&&ce.PrimaryMarketplace){me=Xg.DdaFacade.getSolutionId(ce,this.$);var Je=ce.PrimaryMarketplace.MarketplaceType;if(Je===OSF.StoreType.InMemory){if(!ce.OwnerAddinSolutionId){this.re.ef(Jf.a.Vxb,Ha);return}if(ce.AssetMarketplace)Je=ce.AssetMarketplace.MarketplaceType;else{this.re.ef(Jf.a.Vxb,Ha);return}}else Je===
OSF.StoreType.WopiCatalog&&(Je=OSF.StoreType.OMEX);var Ue=Telemetry.PrivacyRules.GetPrivacyCompliantId(me,Je,null===(bc=ce.AssetMarketplace)||void 0===bc?void 0:bc.SolutionId,null,null,ce.PrimaryMarketplace.MarketplaceRef);gd.CompliantSolutionId=Ue;gd.SolutionId=me;gd.MarketplaceType=Je;gd.SolutionVersion=ce.PrimaryMarketplace.SolutionVersion;gd.StoreLocation=ce.PrimaryMarketplace.MarketplaceRef}else gd.SolutionId=gd.MarketplaceType="",gd.CompliantSolutionId="";gd.IsEventsEnabled=void 0===Ad||null===
Ad||Ad.Vi.A_b(gd.InstanceId);gd.RequestGuid=hj.a.create().toString();bc=gd.RequestBody.length;if(Ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4444309_RichApiPayloadSizeLimit")&&bc>this.$.ya.ExcelRichApiMaxAllowedRequestPayloadSize){this.re.ef(Jf.a.mfj,Ha);Od.ULS.sendTraceTag(537163213,0,50,"Request payload size:{0} exceeded the limit",bc);return}Ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5079365_RichApiPreviewExecution")&&Ld&4096&&(bc=new N(this.$),OfficeExtension.WacRuntime.RichApi.previewExecute(bc,
H,Rc),gd.RequestBody=Rc[4])}var df=c.W0e(gd.RequestHeaders);c.zCd++;var zf=aa.a.Ta.Jb;Ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4316383_RichApiLogRequestBodySize")&&gd&&gd.RequestBody&&Od.ULS.sendTraceTag(537163212,0,50,String.format("Richapi json request body size is {0}",gd.RequestBody.length));this.Yz.executeRichApiRequest(gd,function(Ne){var jf;Gb.UWf(zf,!0,Ne.ServerCorrelationId);var qf=null,Df=null,Gf=Ne.ServerCorrelationId;if(null===(jf=null===Ne||void 0===Ne?void 0:Ne.Errors)||void 0===
jf?0:jf[0])qf=Ne.Errors[0].MessageIdName,Df=Ne.Errors[0].Description,Ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4513856_NotShowApiExceptionOnUI")&&Lc.a(Gb.$).fd.hJ(Ne.Errors[0].MessageId);if(Zg.a(Ne)||!Ne.Result)Gb.vNa(Gf,df,"Server error",qf,Df),Gb.re.aH(Ne,Ha);else{var Ff=null;if(Ve.EwaSettings.ma(259))if((jf=Ne.Result)&&jf.length){for(var Nf=0;Nf<jf.length;Nf++)if(jf[Nf].RequestGuid===gd.RequestGuid){Ff=jf[Nf];break}Ff||Gb.re.aH(Ne,Ha)}else Ff=Ne.Result;else Ff=Ne.Result;if(!qf&&Ff&&Ff.ResponseBody&&
Ff.ResponseBody[0])if(Ne=Ff.ResponseBody[0],Ne.startsWith('{"Error":')){1<Ff.ResponseBody.length&&(Ne=Ne.substring(0,Ne.indexOf("}")+1),Ne+="}");try{var Hf=kf.a.Vh(Ne);Hf.Error&&Gb.vNa(Gf,df,"Pipeline error",Hf.Error.Code,Hf.Error.Message)}catch(Kh){Gb.vNa(Gf,df,"Json deserialize error",null,"Error info cannot be deserialized.")}}else Gb.vNa(Gf,df);else Gb.vNa(Gf,df,"Server error",qf,Df);var Bf=(Hf=Ff.SheetMultiRange)?Hf.SheetName:null;Ne=Ff.ActiveChartId;var Kf=Ff.SelectionState;qf=5===Kf&&!!Hf||
6===Kf||7===Kf||8===Kf;if(Ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")&&Gb.$.ob.sz&&qf)Gb.re.ef(Jf.a.cDc,Ha),Od.ULS.sendTraceTag(537163211,0,50,String.format("{0} is not allowed",Kf.toString()));else if(5===Kf&&Hf){if(Gb.$.va&&Bf)if(Gb.$.va.Mj(Bf))Gb.nTc(Bf);else{var Uf=null;Uf=function(){Gb.$.va.Mj(Bf)&&(Od.ULS.sendTraceTag(537163210,0,50,"Sheets item add event handler called"),Gb.nTc(Bf),Gb.$.va.SHb(Uf))};Gb.$.va.anb(Uf);if(Ve.EwaSettings.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")){var Sf=
null;Sf=function(){Gb.$.va.Mj(Bf)&&(Gb.nTc(Bf),Gb.$.va.Jma(Sf))};Gb.$.va.Iga(Sf)}}}else if(6===Kf||7===Kf||8===Kf||9===Kf){if(Hf){var kh=Th.g(Hf.Ranges);if(Bf&&Th.cb(kh,!0))if(Ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4211161_RichApiUpdateSelectionWithoutExistsWorksheet")&&!Gb.$.va.Mj(Bf)){var tf=null;tf=function(){Gb.idg(wd,kh,Bf,Kf);Gb.$.va.Jma(tf)};Gb.$.va.Iga(tf)}else Gb.idg(wd,kh,Bf,Kf)}7===Kf?(Ne="38.{"+hd.e(Ne)+"}",Yg.a(Gb.$).bna(0,Ne,!0)):8===Kf&&Yg.a(Gb.$).bna(2,Ne,!0);9===Kf&&(Gb.$.ya.ApiCallToSetPageLayout=
!0)}Ff.PostProcessActions?Gb.$.dff?(Gf=kf.a.Vh(Ff.PostProcessActions),Gb.UZi(Gf).then(function(){Gb.bcb(Ff,Ha);Gb.W$c(R.DdaMethod.ControlId,gd);return Promise.resolve(null)},function(Kh){Gb.bcb(Ff,Ha,Kh);return Promise.reject(Kh)})):(Gb.vNa(Gf,df,"Promise not supported",null,"Promise is not supported on this browser."),Gb.re.ef(Jf.a.internalError,Ha)):Gb.bcb(Ff,Ha)}},function(Ne){Gb.UWf(zf,!1,null);Gb.vNa(null,df,"Web service error");Ha(Ne)})};c.prototype.W$c=function(R,Ha){var Gb=Object(bg.a)(Xg.DdaFacade,
Xf.a(this.$));(null===Gb||void 0===Gb?0:Gb.jLd)&&Gb.Vm(R)&&c.xwj(Ha.RequestHeaders)&&(Od.ULS.sendTraceTag(537163209,0,50,"ExecuteRichApiRequest(PostProcess): fire a RecordingStateChanged event to ControlId: {0}; SolutionId: {1}.",R,Ha.SolutionId),Gb.jLd.mlh(R))};c.prototype.Kwh=function(R,Ha){var Gb=this,bc=this.te.iZ(R.DdaMethod.ControlId),Rc=Xg.DdaFacade.getSolutionId(bc,this.$),gd=null;gd=Xg.DdaFacade.Gua(bc,this.$);gd=new y(gd,this.$);gd=new d(Rc,R.DdaMethod.ControlId,this.te,this.$,gd);var wd=
{ResponseHeaders:[]};wd.ResponseBody=Array(1);bc=c.WYe(R.ArrayData[3]);var Ad=c.W0e(bc);bc=new ca(this.$.ya.CreateWorkbookMaxAllowedBase64Size,this.Xqf);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(gd,X,bc,R.ArrayData).then(function(Ld){if(!Ld)return Gb.Htd(!1,"The rich api executor call failed",Ad),Od.ULS.sendTraceTag(537163208,0,10,"The rich api executor call failed"),wd.ResponseStatusCode=500,Gb.bcb(wd,Ha),null;Gb.Htd(!0,"The rich api executor call succeeded",Ad);wd.ResponseStatusCode=
Ld[0];wd.ResponseBody[0]=Ld[2];Gb.bcb(wd,Ha);return null},function(Ld){wd.ResponseStatusCode=400;wd.ResponseBody[0]=Ld.toString();Gb.Htd(!1,"The rich api executor call failed",Ad);Od.ULS.sendTraceTag(537163207,0,10,"A Excel Rich API batch execution was failed, AppId:{0}",Rc);Gb.bcb(wd,Ha);return null})};c.prototype.UWf=function(R,Ha,Gb){c.zCd--;R=Ga.a(aa.a.Ta,R);Od.ULS.sendTraceTag(36763356,0,50,"Rich Api perf log -- total milliseconds used:{0}, requests pending:{1}, request result:{2}, server correlationid: {3}.",
R,c.zCd,Ha?"success":"false",Gb)};c.prototype.bcb=function(R,Ha,Gb){Gb=void 0===Gb?null:Gb;var bc=Array(3);bc[0]=R.ResponseStatusCode;bc[1]=c.SXh(R.ResponseHeaders);var Rc=[],gd=!1;if(Gb&&R.ResponseBody){var wd=kf.a.Vh(R.ResponseBody.join(""));wd.Error||(gd={},gd.Error=Gb,gd.TraceIds=wd.TraceIds,gd.ProcessedResults={},gd.ProcessedResults.Results=wd.Results,Rc[0]=kf.a.xc(gd),gd=!0)}bc[2]=gd?Rc:R.ResponseBody;R=this.re.SP();R.Data=bc;Ha(R)};c.prototype.ywd=function(R,Ha){(new K(this.$,this.re,this.Yz)).ywd(R,
Ha)};c.prototype.hAi=function(R,Ha){Od.ULS.sendTraceTag(537163206,0,50,"MessageParent API called!");var Gb=R[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],bc=R[bf.a.jVc],Rc=R[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];R=this.$.da.za(232).d1a.iAi(R.DdaMethod.ControlId,Gb,bc,Rc);R===Jf.a.success?this.re.Lu(Ha):(Od.ULS.sendTraceTag(537163205,0,10,"MessageParent API Failed!"),this.re.ef(R,Ha))};c.prototype.dAi=function(R,Ha){Od.ULS.sendTraceTag(537163204,0,50,"MessageChild API called!");
var Gb=R[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],bc=R[bf.a.jVc],Rc=R[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];this.$.da.za(232).d1a.Mmj(R.DdaMethod.ControlId,Gb,bc,Rc);this.re.Lu(Ha)};c.prototype.getAccessToken=function(R,Ha){function Gb(gd,wd){var Ad;if(gd===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)gd=bc.re.SP(),gd[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=wd.accessToken,Ha(gd);else{wd=bc.te.iZ(R.DdaMethod.ControlId);var Ld=null!==wd.OwnerAddinStoreType?
wd.OwnerAddinStoreType:wd.PrimaryMarketplace.MarketplaceType,ce={};Od.ULS.sendTraceTag(537163202,0,10,"{0}.",(ce.errorCode=gd.toString(),ce.appId=Telemetry.PrivacyRules.GetPrivacyCompliantId(Xg.DdaFacade.getSolutionId(wd,bc.$),Ld,null===(Ad=wd.AssetMarketplace)||void 0===Ad?void 0:Ad.SolutionId,null,null,wd.PrimaryMarketplace.MarketplaceRef),ce.storeType=Ld,ce));bc.re.ef(gd,Ha)}}var bc=this;Od.ULS.sendTraceTag(537163203,0,50,"GetAccessToken API called!");var Rc=!Ve.EwaSettings.ma(24);If.TaskExtensions.Ba(Kg.GetServiceTaskFactory.create(this.$.da,
137,this.$.la,1),function(gd){var wd=bc.te.ri,Ad=ea.getInstance();mj.AppsForOfficeSingleSignOnManager.getInstance(wd,gd.result,Ad).getAccessToken(R.DdaMethod.ControlId,Rc,R,Gb)},this.$.la)};c.prototype.getAuthContext=function(R,Ha){var Gb=this;If.TaskExtensions.Ba(Kg.GetServiceTaskFactory.create(this.$.da,137,this.$.la,1),function(){var bc=Gb.te.ri.getOsfControl(R.DdaMethod.ControlId);if(!Ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.OEP.Block3PGetAuthContext",!0)||bc.isFirstParty()){bc=
bc.getManifest();var Rc=bc.getMarketplaceID(),gd=bc.getWebApplicationId(),wd=bc.getWebApplicationMsaId();Rg.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(Rc).then(function(Ad){var Ld=Gb.re.SP(),ce={};ce[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=gd;ce[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=wd||gd;ce[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Ad.upn;ce[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=
Ad.userId;ce[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Ad.authority;ce[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Jj.a.rIh(Ad.authorityType);ce[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=Ad.isAnonymous;ce[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Ad.tenantId;ce[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Ad.supportsAuthToken;Ld[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=
ce;Ha(Ld)},function(Ad){var Ld=Gb.re.SP(),ce={},me=new Jj.a;ce[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=gd;ce[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=wd||gd;ce[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=me.upn;ce[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=me.userId;ce[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=me.authority;ce[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=me.authorityType;
ce[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=me.isAnonymous;ce[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=me.tenantId;ce[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=Ad;ce[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=me.supportsAuthToken;Ld[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=ce;Ld.Error=1;Ha(Ld)})}},this.$.la)};c.prototype.ggi=function(R){var Ha=qg.g(this.$).ha;return 16===Ha.Qe&&!!Ha.Oa.Yb&&
!!Ha.Oa.Yb.floatingObject&&Gi.a.equals(Ha.Oa.Yb.floatingObject.id,R,!0)};c.prototype.Rcd=function(R){var Ha=qg.g(this.$).ha;return Ha.sa.tg?1===Ha.Qe||this.ggi(R)?Ha.cia:null:null};c.prototype.lic=function(R,Ha){return 1!==R&&2!==R&&3!==R?(this.re.ef(Jf.a.nze,Ha),!1):!0};c.prototype.Htd=function(R,Ha,Gb){var bc={};bc.a=this.$.ya.UserSessionId;bc.b=R;bc.c=Ha;bc.d=null;bc.e=Gb;Oi.b().De(37,bc)};c.prototype.vNa=function(R,Ha,Gb,bc,Rc){Gb=void 0===Gb?null:Gb;bc=void 0===bc?null:bc;Rc=void 0===Rc?null:
Rc;var gd={};R&&(gd.ServerCorrelationId=R);void 0!==Ha&&null!==Ha&&(gd.Source=Ha);Gb&&(gd.ErrorType=Gb);bc&&(gd.MessageId=bc);Rc&&(gd.StatusDescription=Rc);Ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6144055_EUIIDataInDbxheTag")&&bc&&"ExternalDataRefreshFailed"===bc&&(gd.StatusDescription="");Od.ULS.sendTraceTag(50688452,0,50,kf.a.xc(gd))};c.prototype.UZi=function(R){for(var Ha=new Promise(function(bc){bc(null)}),Gb=0;Gb<R.length;Gb++)Ha=this.TZi(Ha,R[Gb]);return Ha};c.prototype.TZi=function(R,
Ha){var Gb=this;if(!Ha)return Od.ULS.sendTraceTag(537163201,0,10,"Null PostProcessAction."),R.then(function(){return Promise.reject(c.Y2a(C.generalException,og.a.instance.ga(1740),null))});switch(Ha.actionType){case 1:case 2:R=R.then(function(){var bc=Object(bg.a)(Xg.DdaFacade,Xf.a(Gb.$));if(bc.Vm(Ha.controlId))switch(bc.Vi.Y1h(Ha),Ha.messageType){case 14:case 100:bc.iLd.X_b(Ha);break;case 11:case 12:bc.aij.iob(Ha);break;case 51:case 52:bc.Zhj.iob(Ha);break;case 2101:case 2102:bc.$hj.iob(Ha);break;
case 2E3:bc.bij.X_b(Ha);break;case 2201:Gb.$.xka&&bc.jLd.VLg(Ha);break;case 2203:bc.cij.WLg(Ha);break;case 2700:Ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&bc.hLd.X_b(Ha)}else Od.ULS.sendTraceTag(537163171,0,10,"OsfControl with instanceId[{0}] doesn't exist.",Ha.controlId);return Promise.resolve(null)});break;case 3:R=R.then(function(){Gb.K1h(Ha);return Promise.resolve(null)});break;case 15:Ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&(R=R.then(function(){Gb.p3h(Ha);
return Promise.resolve(null)}));break;case 4:R=R.then(function(){if(Ve.EwaSettings.ma(105)){var bc=qg.g(Gb.$).ha.sa.activeCell;bc.top!==Ha.row+1&&bc.left!==Ha.column+1&&(bc=Th.v(Kj.Range.Tc(Ha.row+1,Ha.column+1),Gb.$),qg.g(Gb.$).hg(bc,null,null,null,3,Si.a.Ebh));ei.a(Gb.$,243,242,0,function(Rc){Rc.fdb(Ha.row+1,Ha.column+1,1,!1,!1)})}return Promise.resolve(null)});break;case 7:R=R.then(function(){Object(bg.a)(Xg.DdaFacade,Xf.a(Gb.$)).Vi.mKe(Ha.controlId,Ha.isEnableEvents);return Promise.resolve(null)});
break;case 5:R=R.then(function(){return Gb.Z$g(Ha)});break;case 6:R=R.then(function(){return Gb.dVi(Ha)});break;case 8:R=R.then(function(){Ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5333368_ClearBeforeCloseRegistrationsInWorkbookCloseApi")&&Object(bg.a)(Xg.DdaFacade,Xf.a(Gb.$)).HXg();var bc=new Zc.a(Nc.a.Ek,5,null);ad.a(Gb.$).ft(bc);return Promise.resolve(null)});break;case 9:R=R.then(function(){return Gb.Boj(Ha)});break;case 10:R=R.then(function(){return Gb.HXj(Ha)});break;case 11:R=R.then(function(){return Gb.GXj()});
break;case 12:R=R.then(function(){return Gb.DXj()});break;case 13:R=R.then(function(){return Gb.EXj(Ha)});break;case 14:R=R.then(function(){return Gb.FXj(Ha)});break;case 16:R=R.then(function(){return Promise.resolve(Ha)});break;case 17:R=R.then(function(){return Gb.Okj(Ha,Object(bg.a)(Xg.DdaFacade,Xf.a(Gb.$)))});break;case 18:qg.g(this.$).focus();break;case 19:this.i4e(Ha.entryType,!1,Ha.options);break;case 20:this.i4e(Ha.entryType,!0,Ha.options);break;default:R=R.then(function(){return Promise.reject(c.Y2a(C.sJg,
og.a.instance.ga(1741),null))})}return R};c.prototype.p3h=function(R){var Ha=Object(bg.a)(Xg.DdaFacade,Xf.a(this.$)).Vm(R.controlId);if(Ha&&!(0===R.operationType^!Ha.tda)){qg.g(this.$).Dhc=!0;switch(R.operationType){case 0:var Gb=new Fc.a(document.createElement("input"));Gb.text=R.range;Ha.Iai(qg.g(this.$).ig.v9g(Gb,new Vi.a(this.$)));Ha.tda.startEdit(!0);break;case 1:Ha.NOf();this.rangePicker=null;break;case 2:Ha.tda.xdg(R.range);break;case 3:Ha.tda.xdg(R.startingRange);Ha=R.expandSelection;Gb=R.getNextDataRegionCell;
var bc=0;switch(R.keyboardDirectionValue){case 2:bc=38;R=Ha&&Gb?105288353:Ha?-31900117:Gb?542791952:137938150;break;case 3:bc=40;R=Ha&&Gb?-1297307319:Ha?-1603798598:Gb?1713663844:-798660877;break;case 0:bc=37;R=Ha&&Gb?-403586027:Ha?2039316657:Gb?-2012742350:-1470715894;break;case 1:bc=39;R=Ha&&Gb?784916030:Ha?589730764:Gb?1324884057:-1231471547;break;default:R=1461300262}Ha=this.r4b("keydown",bc,Ha,Gb);qg.g(this.$).QIb(Ha,new di.a(R,1,0,8,null))}qg.g(this.$).Dhc=!1}};c.prototype.r4b=function(R,Ha,
Gb,bc){var Rc=document.createEvent("KeyboardEvent");if(Oh.a.hF)Rc.initKeyboardEvent(R,!1,!1,window.self,"A",0,bc,!1,Gb,!1);else{var gd="";Gb&&(gd+="Shift");bc&&(gd+=0<gd.length?" Control":"Control");Rc.initKeyboardEvent(R,!1,!1,window.self,"A",0,gd,!1,"en-US")}R=new Sys.UI.DomEvent(Rc);R.keyCode=Ha;return R};c.prototype.K1h=function(R){switch(R.operationType){case 1:If.TaskExtensions.Ba(Kg.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1),function(Ha){Ha.result.gKd()},this.$.la,3);break;case 2:if(R=
Object(bg.a)(Xg.DdaFacade,Xf.a(this.$)).Vm(R.controlId))R.Jod=!0,R.MIf()}};c.prototype.Z$g=function(R){var Ha=this,Gb=R.fileBase64;return Gb&&Gb.length>this.$.ya.CreateWorkbookMaxAllowedBase64Size?Promise.reject(c.Y2a(C.invalidArgument,og.a.instance.ga(1744),"Application.CreateWorkbook")):(new Promise(function(bc,Rc){var gd=new Qi.StandardDialog;gd.Rb=4;gd.nl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,function(wd){2!==wd&&0!==wd||Rc(c.Y2a(C.BBd,og.a.instance.ga(1743),
"Application.CreateWorkbook"));wd=new Z("blank","agave",Gb?"streamBase64":"streamEmpty",Gb);Ha.Xqf.create(bc,Rc,wd).q0a()})})).then(function(bc){Ha.X8b.set(R.fakeFileId,bc);return Promise.resolve(null)},function(bc){return bc?Promise.reject(bc):Promise.reject(c.Y2a(C.generalException,og.a.instance.ga(1740),"Application.CreateWorkbook"))})};c.prototype.dVi=function(R){var Ha=this;return new Promise(function(Gb,bc){if(Ha.X8b.has(R.fakeFileId)){var Rc=Ha.X8b.get(R.fakeFileId);bc=new Qi.StandardDialog;
bc.Rb=4;bc.nl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,function(gd){1===gd&&si.HelperMethods.Ze(Rc,void 0,void 0,"DdaMethodHandler.fileUrl");Gb(null)})}else bc(c.Y2a(C.generalException,og.a.instance.ga(1740),"Document.Open"))})};c.prototype.Boj=function(R){var Ha=this;return new Promise(function(Gb){Object(bg.a)(Xg.DdaFacade,Xf.a(Ha.$)).xTf=R.runtimeCalculationMode;var bc=Ha.$.da.za(268);bc&&bc.yxd(3===R.runtimeCalculationMode);Gb(null)})};c.prototype.HXj=
function(R){Yh.a.hAb(this.$)&&this.$.da.za(331).ccb(0,R.urlStr,!0,!0,null);return Promise.resolve(null)};c.prototype.GXj=function(){Yh.a.hAb(this.$)&&this.$.da.za(331).ccb(1,null,!0,!0,null);return Promise.resolve(null)};c.prototype.DXj=function(){Yh.a.hAb(this.$)&&this.$.da.za(331).jKe();return Promise.resolve(null)};c.prototype.EXj=function(R){Yh.a.hAb(this.$)&&this.$.da.za(331).ccb(5,R.urlStr,!0,!0,null);return Promise.resolve(null)};c.prototype.FXj=function(R){if(Yh.a.hAb(this.$)){var Ha=this.$.da.za(331);
Ha=ak(Ha.iaa);for(var Gb=Ha.next();!Gb.done;Gb=Ha.next())Gb=Gb.value,Gb.IsActive&&Gb.HostEditUrl&&Gb.UrlStr===R.hostEditUrlStr&&si.HelperMethods.Ze(Gb.HostEditUrl,"_blank")}return Promise.resolve(null)};c.prototype.Okj=function(R,Ha){var Gb=oj.a.OW;R=kf.a.Vh(R.payload);var bc={};"eventId"in R&&"payload"in R&&(bc.eventId=R.eventId,bc.payload=R.payload);Ha.uM(2201,Gb,kf.a.xc(bc));return Promise.resolve(null)};c.prototype.i4e=function(R,Ha,Gb){var bc=this.$.da.za(5);bc&&(R=this.kJh(R))&&(Ha?bc.removeEntry(R):
bc.ele(R,Gb))};c.prototype.kJh=function(R){switch(R){case 0:return 64}};c.prototype.nTc=function(R){R=Object(bg.a)(hc.a,this.$.va.getItemByName(R));(null===R||void 0===R?0:R.visible)&&R.activate(!0)};c.prototype.idg=function(R,Ha,Gb,bc){var Rc=R.sa.Xs,gd=Rc<Ha.length&&Ha[Rc].contains(R.sa.activeCell);R=gd?R.sa.activeCell:Ha[0].topLeft;Rc=gd?Rc:0;qg.g(this.$).fV(Ha,Rc,Gb,null,R,null,null,3,Si.a.Fbh,void 0,void 0,void 0,6===bc)};c.WYe=function(R){if(!R||!R.length)return null;for(var Ha=Array(R.length/
2),Gb=0;Gb<R.length/2;Gb++)Ha[Gb]={},Ha[Gb].Name=R[2*Gb],Ha[Gb].Value=R[2*Gb+1];return Ha};c.SXh=function(R){if(!R||!R.length)return null;for(var Ha=Array(2*R.length),Gb=0;Gb<R.length;Gb++)Ha[2*Gb]=R[Gb].Name,Ha[2*Gb+1]=R[Gb].Value;return Ha};c.kad=function(R){if(!R||!R.length)return null;for(var Ha=Array(R.length),Gb=0,bc=R.length;Gb<bc;Gb++){var Rc=R[Gb].length;if(Rc){Ha[Gb]=Array(Rc);for(var gd=0;gd<Rc;gd++)Ha[Gb][gd]=null==R[Gb][gd]?null:R[Gb][gd].toString()}else return null}return Ha};c.F2b=
function(R){return"string"===typeof R?vb.a.Wp(c.Abh,R,0):R};c.fSe=function(R){return"string"===typeof R?vb.a.Wp(c.Dbh,R,0):R};c.Neg=function(R){return"string"===typeof R?vb.a.Wp(c.Hbh,R,0):R};c.sgi=function(R){switch(R.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1};c.lYc=function(R,Ha){var Gb={};Gb.CoerceType=R;1===Gb.CoerceType?(Gb.Data=c.kad(Ha.Rows),Gb.Headers=c.kad(Ha.Headers)):Gb.Data=c.kad(Ha);return Gb};c.Nte=function(R){if(1===R.CoerceType){var Ha=
{};return Ha.Headers=R.Headers,Ha.Rows=R.Data,Ha}return R.Data};c.mfc=function(R){return 1===R.CoerceType?!R.Data&&!R.Headers:!R.Data};c.W0e=function(R){var Ha="Unknown";if(!R)return Ha;for(var Gb=0;Gb<R.length;Gb++)if(R[Gb].Name.toLowerCase()===nh.a.dij){Ha=R[Gb].Value;break}return Ha};c.xwj=function(R){if(!R)return!1;for(var Ha=nh.a.hFi.toLowerCase(),Gb=0;Gb<R.length;Gb++)if(R[Gb].Name.toLowerCase()===Ha)return!0;return!1};c.Y2a=function(R,Ha,Gb){var bc={};bc.Code=R;bc.Message=Ha;bc.Location=Gb;
bc.ActionIndex=0;return bc};Af.Object.defineProperties(c.prototype,{lQ:{configurable:!0,enumerable:!0,get:function(){return this.re}}});Af.Object.defineProperties(c,{Abh:{configurable:!0,enumerable:!0,get:function(){c.zpa||(c.zpa={},c.zpa[Microsoft.Office.WebExtension.CoercionType.Table]=1,c.zpa[Microsoft.Office.WebExtension.CoercionType.Text]=2,c.zpa[Microsoft.Office.WebExtension.CoercionType.Matrix]=3,c.zpa[Microsoft.Office.WebExtension.CoercionType.Html]=4,c.zpa[Microsoft.Office.WebExtension.CoercionType.Ooxml]=
5);return c.zpa}},Dbh:{configurable:!0,enumerable:!0,get:function(){c.rhb||(c.rhb={},c.rhb[Microsoft.Office.WebExtension.FilterType.All]=1,c.rhb[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=2);return c.rhb}},Hbh:{configurable:!0,enumerable:!0,get:function(){c.shb||(c.shb={},c.shb[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=2,c.shb[Microsoft.Office.WebExtension.ValueFormat.Formatted]=1);return c.shb}}});c.zpa=null;c.rhb=null;c.shb=null;c.zCd=0;Object(Cd.a)(c,"DdaMethodHandler",
null,[403,10]);var pd=Hh.a;Rk(a,pd);a.prototype.zd=function(){var R=this,Ha=Kg.GetServiceTaskFactory.create(this.$.da,106,this.la,this.hb),Gb=Kg.GetServiceTaskFactory.create(this.$.da,165,this.la,this.hb),bc=bb(this.la,this.hb);If.TaskExtensions.Ba(If.TaskExtensions.Wd([Ha,Gb,bc],this.la),function(){var gd=Ha.result,wd=Rg.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");R.jd([new c(R.$,gd,wd)])},this.la,3);var Rc=Rg.a.instance;If.TaskExtensions.Ba(Kg.GetServiceTaskFactory.create(this.$.da,
137,this.$.la,this.hb),function(){Rc.register(fa,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").tc().Cc(function(){return new fa})},this.$.la)};a.ka=function(R){Hh.a.Qd(82,new a(R))};Object(Cd.a)(a,"DdaCommandHandlerFactory",Hh.a,[]);Type.registerNamespace("Microsoft.AppRuntime");Type.registerNamespace("Microsoft.InternalService");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Agave");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.WebExtension");
Type.registerNamespace("_Ewa");Ud.a.vi("");Ud.a.vi(".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}.ewa-ptp-nov2-flex .ewa-wx-container-div{flex:1}");Object(je.a)();Type.registerNamespace("Common.App.AppsForOfficeCommon");Object(ye.a)();(function(){Pe.a.Fa(function(R){Qd.ka(R)})})();Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");Object(Qh.a)();Object(Wi.a)();Type.registerNamespace("CommandUI.AddInCommands");
(function(){Pe.a.Fa(function(R){Ve.EwaSettings.ma(54)&&zb.ka(R)})})();(function(){Pe.a.Fa(function(R){Ve.EwaSettings.ma(122)&&nb.ka(R)})})();Pe.a.Fa(db.ka);Pe.a.Fa(Db.ka);Type.registerNamespace("Common.App.AppsForOfficeOauth");Type.registerNamespace("Common.App.SmartLookup");(function(){Pe.a.Fa(function(R){va.ka(R);ta.ka(R);da.ka(R)})})();Pe.a.Fa(a.ka)},1664:function(u,D,b){function a(){this.iEc=null;this.TIc=0;this.xKc=!1;this.$a=new e.a;this.jqg=new d.a}function c(){this.hJe=this.displayName=this.Cqb=
this.xo=this.uB=null;this.isUpgraded=!1}u=b(0);var d=b(202),e=b(97);c.prototype.Lff=function(k,l){return this.uB.getStoreType().toLowerCase()===k.toLowerCase()&&this.uB.getSolutionId().toLowerCase()===l.toLowerCase()};Object(u.a)(c,"AddinCommandsResourceItem",null,[]);b.d(D,"a",function(){return a});a.prototype.BDg=function(k){this.$a.addHandler("AddinCommandsLoadingMessageChanged",k)};a.prototype.caj=function(k){this.$a.removeHandler("AddinCommandsLoadingMessageChanged",k)};a.prototype.Ecb=function(k){k!==
this.iEc&&(this.iEc=k,this.$a.raiseEvent("AddinCommandsLoadingMessageChanged"))};a.prototype.woj=function(){this.TIc++;this.DYa||this.Ecb(CommonUIStrings.l_LoadingAddInsTitle)};a.prototype.NNd=function(){this.TIc--;this.Vsd()&&(this.xKc?this.DYa!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.Ecb(CommonUIStrings.l_ErrorLoadingAddInsTitle):this.Ecb(null))};a.prototype.AYf=function(k){this.xKc=!0;this.Ecb((void 0===k?0:k)?CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg:CommonUIStrings.l_ErrorLoadingAddInsTitle)};
a.prototype.Ixe=function(){this.xKc=!1;this.Vsd()?this.Ecb(null):this.Ecb(CommonUIStrings.l_LoadingAddInsTitle)};a.prototype.Vsd=function(){return 0>=this.TIc};a.prototype.Kia=function(k,l,m){m=void 0===m?0:m;for(var f=ak(this.q5a),w=f.next();!w.done;w=f.next())if(w=w.value,w.Lff(k,l)&&(!w.xo||w.xo.HGh===m))return w;return null};a.prototype.Yke=function(k,l,m,f){var w=new c;w.uB=k;w.xo=l;w.Cqb=m;w.displayName=f;this.q5a.add(w)};a.prototype.GBg=function(k,l,m,f){var w=new c;w.uB=k;w.xo=l;w.Cqb=null;
w.hJe=m;w.displayName=f;this.q5a.add(w)};a.prototype.D9i=function(k,l){for(var m=0,f=ak(this.q5a),w=f.next();!w.done;w=f.next())w=w.value,w.uB.getStoreType()===k&&w.uB.getSolutionId()===l?this.q5a.removeAt(m):m++};a.getInstance=function(){a.Ma||(a.Ma=new a);return a.Ma};Af.Object.defineProperties(a.prototype,{DYa:{configurable:!0,enumerable:!0,get:function(){return this.iEc}},q5a:{configurable:!0,enumerable:!0,get:function(){return this.jqg}}});a.Ma=null;Object(u.a)(a,"AddinCommandsResourceManager",
null,[])},943:function(u,D,b){function a(){}b.d(D,"a",function(){return a});u=b(0);var c=b(34);a.vUe=function(d){return c.a.Wp(a.fAi,d.toString(),a.internalError)};Af.Object.defineProperties(a,{fAi:{configurable:!0,enumerable:!0,get:function(){var d={};return a.rae||(a.rae=(d["-2002156328"]=a.nze,d["-1954750170"]=a.s1e,d["317650254"]=a.BZg,d["-1005263101"]=a.Rci,d["1353664579"]=a.emj,d["159671765"]=a.Sci,d["1446690022"]=a.FXe,d["1150069548"]=a.UAc,d["-1409306331"]=a.hwe,d["338507772"]=a.nFe,d["-457159301"]=
a.WVi,d["-1037701970"]=a.bbh,d["-1893322318"]=a.Xci,d["965579896"]=a.dbh,d["93287890"]=a.cbh,d["358088857"]=a.kpj,d["-1223650923"]=a.nFe,d["2007306190"]=a.sVg,d["1549955423"]=a.Vse,d["-1275974171"]=a.Wci,d["382101082"]=a.gVi,d["-898776235"]=a.VBi,d["335464256"]=a.KBi,d["1677378049"]=a.Vci,d["-261992848"]=a.HOj,d["-980820954"]=a.Vse,d["-931375837"]=a.fVi,d["929186550"]=a.Mih,d["-982144310"]=a.S1i,d["-785741187"]=a.Pci,d["2125217573"]=a.Zci,d["299124955"]=a.Qci,d["1669853884"]=a.sij,d["-1515932330"]=
a.CZg,d["314621024"]=a.$Ch,d["-300049690"]=a.wVg,d["14766835"]=a.luj,d["-1251992761"]=a.mIe,d["-2087635043"]=a.invalidOrTimedOutSession,d["2100961153"]=a.invalidOrTimedOutSession,d["-1218744139"]=a.invalidSheetName,d["-1468309555"]=5006,d["-315732528"]=a.invalidOrTimedOutSession,d["611268539"]=a.invalidOrTimedOutSession,d["1531005923"]=5006,d["1593924569"]=5006,d["299476328"]=a.oFa,d["49173765"]=a.oFa,d["-907155566"]=a.oFa,d["-1201603824"]=a.oFa,d["1541165282"]=a.oFa,d["-1347753427"]=a.oFa,d["134912532"]=
a.oFa,d["1780971550"]=a.responsePayloadSizeLimitExceeded,d))}}});a.success=0;a.nze=1E3;a.s1e=1001;a.BZg=1002;a.Rci=1003;a.emj=1004;a.Sci=1005;a.FXe=1008;a.URe=1009;a.invalidSheetName=1014;a.UAc=2E3;a.hwe=2001;a.nFe=2002;a.WVi=2003;a.bbh=2004;a.Xci=2005;a.dbh=2007;a.cbh=2008;a.kpj=2009;a.sVg=2014;a.Olj=3E3;a.Vse=3002;a.Wci=3004;a.gVi=3005;a.VBi=3006;a.KBi=3007;a.Vci=3008;a.HOj=3009;a.fVi=3010;a.luj=4002;a.FBd=5E3;a.internalError=5001;a.mIe=5002;a.Vxb=5004;a.JPj=5007;a.B8h=5008;a.ePg=5009;a.invalidOrTimedOutSession=
5012;a.cDc=5016;a.oFa=5102;a.mfj=5103;a.responsePayloadSizeLimitExceeded=5104;a.OUg=7001;a.M4f=7002;a.Mih=8E3;a.S1i=8001;a.Pci=8010;a.Zci=8011;a.Qci=8012;a.sij=8020;a.CZg=8021;a.$Ch=8022;a.wVg=8023;a.Mzi=11E3;a.LCi=11001;a.Yci=11002;a.rae=null;Object(u.a)(a,"DdaErrorIds",null,[])},944:function(u,D,b){function a(){}b.d(D,"a",function(){return a});u=b(0);a.generalException="GeneralException";a.invalidArgument="InvalidArgument";a.notImplemented="NotImplemented";a.PSc="AccessDenied";a.notSupported="NotSupported";
a.apiNotAvailable="ApiNotAvailable";a.notAllowed="NotAllowed";a.BBd="OperationCancelled";a.userNotSignedIn="UserNotSignedIn";a.userAborted="UserAborted";a.MPj="UnsupportedUserIdentity";a.invalidResourceUrl="InvalidResourceUrl";a.invalidGrant="InvalidGrant";a.yHg="AddinIsAlreadyRequestingToken";a.Ogj="ResourceNotAllowed";a.clientError="ClientError";a.serverError="ServerError";a.t2g="ControlIdNotFound";a.Dhj="RibbonApiNotAvailable";a.hostRestartNeeded="HostRestartNeeded";a.invalidRibbonDefinition="InvalidRibbonDefinition";
a.sharedRuntimeNotAvailable="SharedRuntimeNotAvailable";Object(u.a)(a,"ErrorCodes",null,[])},946:function(u,D,b){function a(za,tb){var Wb=rd.call(this)||this;Wb.ea=null;Wb.Mm=null;Wb.Uh=null;Wb.qf=[];Wb.yIa=null;Wb.SEe=!1;Wb.YOb=!1;Wb.initialized=!1;Wb.disposed=!1;Wb.QBa=null;Wb.Moc=[];Wb.NEe=[];Wb.XOa=[];Wb.R0a=null;Wb.MCd=new Ub.a(gb.a.Jk());Wb.FZb=new Db.a(gb.a.Jk());Wb.EFb=[];Wb.PFf=[];Wb.M5b=350;Wb.Qea=null;Wb.gxa=null;Wb.zSc=!1;Wb.qee=null;Wb.nee=null;Wb.ree=null;Wb.pee=null;Wb.uee=null;Wb.Wug=
null;Wb.oee=null;Wb.see=null;Wb.vee=null;Wb.wee=null;Wb.xee=null;Wb.Sf=function(){Wb.QBa=Wb.ea.lo.WebExtensions;for(var fc=Wb.qf.length-1;0<=fc;--fc){var xc=Wb.qf[fc],Yb;if(Yb=!Wb.RAh(xc.controlId))Yb=xc,Yb=pa.EwaSettings.ma(122)?!Yb.RHa:!0;Yb&&(xc.Hmc(),Array.removeAt(Wb.qf,fc))}if(Wb.QBa)for(fc=0,xc=Wb.QBa.length;fc<xc;fc++){Yb=Wb.QBa[fc];var Ec=Wb.Vm(Yb.WebExtensionId);Ec&&Ec.bAd(Yb)}};Wb.Gnc=function(fc){Wb.raiseEvent("csc",fc.getID())};Wb.Ezf=function(fc,xc,Yb){if(pa.EwaSettings.isChangeGateEnabled("OfficeVSO:4841553_AddinKeyboardShortcutsInTaskpane")&&
xc===OSF.AgaveHostAction.KeyboardShortcuts){var Ec=Object(Va.a)(Object,Yb);xc={};xc.keyCode=Ec.keyCode;xc.type="keydown";xc.ctrlKey=Ec.ctrlKey;xc.shiftKey=Ec.shiftKey;xc.altKey=Ec.altKey;xc.metaKey=Ec.metaKey;fc=Wb.Vm(fc);Ec=fc.Yga;xc.srcElement=Object(yb.a)(637,Ec)?Ec.SFa:Da.g(Wb.$).jc;xc=new Sys.UI.DomEvent(xc);fc={focusedAddinId:a.Gua(fc.$k,Wb.$)};Ec=new mc.a(1461300262,1,Wb.$.Jc,6,null);Da.g(Wb.$).QIb(xc,Ec,fc)}else if(xc===OSF.AgaveHostAction.Select)Wb.f4e(!0);else if(xc===OSF.AgaveHostAction.UnSelect)Wb.f4e(!1);
else if(xc===OSF.AgaveHostAction.CancelDialog)Wb.UJ(-684355545,null);else if(xc===OSF.AgaveHostAction.InsertAgave)fc={},Yb&&(fc[Ia.a.Hra]=Yb,fc[P.a.Vf]=a.krb(Yb),Wb.UJ(-741808261,fc));else if(xc===OSF.AgaveHostAction.InsertDevManifest)fc={},Yb&&(fc[Ia.a.Hra]=Yb,fc[P.a.Vf]=a.krb(Yb),Wb.UJ(-741808261,fc));else if(xc===OSF.AgaveHostAction.InsertDevManifestError)fc=Object(Va.a)(Object,Yb),xc={},fc=(xc[Ia.a.iVc]=Wb.Mm.getDevManifestInvalidUrlErrorString(fc.manifestUrl),xc),Wb.UJ(-2025863019,fc);else if(xc===
OSF.AgaveHostAction.NotifyHostError)fc={},fc=(fc[Ia.a.iVc]=Wb.Mm.getManifestInvaildErrorString(),fc),Wb.UJ(-2025863019,fc);else if(xc===OSF.AgaveHostAction.RefreshAddinCommands)pa.EwaSettings.ma(54)&&Wb.UJ(td.a.refreshAddinCommands,null);else if(xc===OSF.AgaveHostAction.CtrlF6Exit||xc===OSF.AgaveHostAction.CtrlF6ExitShift){if(Ec=Wb.$.da.za(15)){(fc=Wb.Vm(fc).Yga)&&fc.xyc();Na.a.xf&&document.activeElement.blur();var bd={keyCode:117,type:"keydown",ctrlKey:!0};bd.shiftKey=xc===OSF.AgaveHostAction.CtrlF6ExitShift;
bd.srcElement=Object(yb.a)(637,fc)?fc.SFa:Da.g(Wb.$).jc;fc=new Sys.UI.DomEvent(bd);Ec.Tla(fc)}}else if(xc===OSF.AgaveHostAction.PageIsReady){if((fc=Wb.Vm(fc).Yga)&&fc.MYa===OSF.OsfControlTarget.TaskPane&&(fc=Wb.$.da.za(183))&&Wb.qf)for(xc=kb.a.ud(Wb.$),Ec=ak(Wb.qf),bd=Ec.next();!bd.done;bd=Ec.next())a.JLa(bd.value.kU)&&(xc?fc.Uf(!0,!1):fc.setFocusOnToolbarFirstElement())}else if(xc===OSF.AgaveHostAction.TabExit){xc=Wb.Vm(fc);var Ic=xc.Yga;if(Ic)if(Ic.MYa===OSF.OsfControlTarget.InContent)Ic.kif();
else{if(Ic.MYa===OSF.OsfControlTarget.TaskPane)if(kb.a.ud(Wb.$))Na.a.xf&&document.activeElement.blur(),mb.UISurfaces.Pj().then(function(le){var Ke=Object(yb.a)(637,Ic)?Ic:null;Ke?Ke.isResizable?le.focusResizeHandle():le.focusTabbedTaskPaneArea():le.focusTabbedTaskPaneArea();return null});else if(fc=Wb.$.da.za(183))Na.a.xf&&document.activeElement.blur(),(xc=document.getElementById(Wb.$.yb+db.a.Rlc))&&Lb.DOMElementExtensions.isVisible(xc)?Lb.DOMElementExtensions.setFocus(xc):fc.setFocusOnToolbarFirstElement()}else xc&&
4===xc.osfControlType&&Wb.Mm.notifyAgave(fc,OSF.AgaveHostAction.TabIn)}else if(xc===OSF.AgaveHostAction.TabExitShift)(xc=Wb.Vm(fc),Ec=xc.Yga)?Ec.MYa===OSF.OsfControlTarget.InContent?Ec.lif():Ec.MYa===OSF.OsfControlTarget.TaskPane&&(fc=Object(yb.a)(637,Ec)?Ec:null)&&(Na.a.xf&&document.activeElement.blur(),fc.IYf()):xc&&4===xc.osfControlType&&Wb.Mm.notifyAgave(fc,OSF.AgaveHostAction.TabIn);else if(xc===OSF.AgaveHostAction.EscExit||xc===OSF.AgaveHostAction.ExitNoFocusable||xc===OSF.AgaveHostAction.ExitNoFocusableShift)if(Ec=
Wb.Vm(fc).Yga)Ec.xyc();else{if(xc===OSF.AgaveHostAction.EscExit){xc=null;Ec=ak(N.N_h());for(bd=Ec.next();!bd.done;bd=Ec.next())if(bd=bd.value,bd.value.ze===fc){bd.value.dialog.hide();xc=bd.key;break}xc&&(fc=Wb.Vm(xc))&&4!==fc.osfControlType&&Wb.ri.notifyAgave(xc,OSF.AgaveHostAction.TabIn)}}else if(xc===OSF.AgaveHostAction.InstallCustomFunctions)if(pa.EwaSettings.ma(122)){Le.a(Wb.$).TTe(function(){return!1});var Md=Wb.$.da;lb.TaskExtensions.Ba(Aa.GetServiceTaskFactory.Ra(Md,278,279,1),function(le){le=
le.result;Md.za(278)||Md.Ga(278,le);var Ke=Yb.osfControl.getStoreType();le.w$e(Yb.osfControl.getSolutionId(),Ke,a.ULh(Yb.osfControl),Yb).Xma()},Wb.la,3)}else wa.ULS.sendTraceTag(537170577,0,10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");else if(xc===OSF.AgaveHostAction.UninstallCustomFunctions)if(pa.EwaSettings.ma(122)){Le.a(Wb.$).TTe(function(){return!1});var ne=Wb.$.da;lb.TaskExtensions.Ba(Aa.GetServiceTaskFactory.Ra(ne,278,279,1),function(le){le=
le.result;ne.za(278)||ne.Ga(278,le);le.Jag(Yb.solutionId,Yb.storeType).Xma()},Wb.la,3)}else wa.ULS.sendTraceTag(537170574,0,10,"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");else xc===OSF.AgaveHostAction.SendTelemetryEvent?d(Yb):xc===OSF.AgaveHostAction.SendCustomerContent?c(Yb):xc===OSF.AgaveHostAction.LaunchExtensionComponent?Qa.a.instance.Uqi(Yb):xc===OSF.AgaveHostAction.RefreshRibbonGallery?(fc=Wb.$.da.za(352))&&fc.Hhd(Yb):xc===OSF.AgaveHostAction.RemoveAppCommandsAddin?
(Wb.F$i(Yb.solutionId),kb.a.ud(Wb.$)||(fc=Wb.$.da.za(183))&&fc.Pw(),pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&ta.AFrameworkApplication.ub.ae(td.a.ZNf,2,Yb.solutionId)):xc===OSF.AgaveHostAction.GetOriginalControlId&&(fc=new va.a(Wb.$.yb,Yb.ownerAddinSolutionId,new wc.a,!0),Yb.originalControlId=fc?fc.eFe(Yb.controlId):Yb.controlId)};Wb.$Ti=function(){Wb.$.pa&&Ee.o(Wb.$.pa)&&Wb.$.da.za(34).Qkd()};Wb.Yc=function(){Wb.kkf()};Wb.rR=
function(fc,xc){var Yb,Ec;1===xc.Fq&&(fc=xc.Ff)&&(xc=new k(Wd.toTimestamp(fc.enqueueUtcTime),Wd.toTimestamp(fc.processUtcTime),Wd.toTimestamp(fc.dequeueUtcTime),Wd.getElapsedMilliseconds(fc.enqueueUtcTime,fc.processUtcTime),Wd.getElapsedMilliseconds(fc.processUtcTime,fc.dequeueUtcTime),fc.operationCount,(null===(Ec=null===(Yb=fc.operation)||void 0===Yb?void 0:Yb.Xc)||void 0===Ec?0:Ec.ServerCorrelationId)?fc.operation.Xc.ServerCorrelationId:null,fc.operation?Enum.toString(Qd.a,fc.operation.operationName):
null,cb.a.gB(Wd.getElapsedMilliseconds(fc.enqueueUtcTime,Pd.a.Ta.Jb))),Yb=Sys.Serialization.JavaScriptSerializer.serialize(xc),wa.ULS.sendTraceTag(50872916,0,50,Yb))};Wb.Uc=function(fc,xc){!Wb.ea.dc&&ef.a(xc)?(Array.forEach(Wb.qf,Wb.ovf),Array.clear(Wb.qf),Wb.YOb=!1):(xc.wH&&(wa.ULS.sendTraceTag(537170516,0,50,"Silent Reload require reset osf controls."),Wb.xSf()),Wb.JK(),pa.EwaSettings.isChangeGateEnabled("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&(Wb.YOb=!1))};Wb.uo=function(){pa.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&
(wa.ULS.sendTraceTag(537170515,0,50,"Load on demand occurred require reset osf controls."),Wb.xSf());Wb.JK();pa.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(Wb.YOb=!1)};Wb.ovf=function(fc){fc.Hmc();Wb.raiseEvent("cd",fc.controlId)};Wb.jb=za;Wb.AVc=tb;Wb.initialize();T.ka(Wb);Wb.xTf=0;(za=(za=!(Na.a.Zo||Na.a.vka))&&(!pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5763473_DisableAddinKeyboardShortcutsInFirefox")||!Na.a.xf))&&OfficeExt.ShortcutKeyDispatchManager.init();
Wb.kqg={};return Wb}function c(za){kc.a.sendOtelCustomerContent(Object.assign(new Wc.a,{otelEvent:za}))}function d(za){kc.a.sendOtelEvent(Object.assign(new Wc.a,{otelEvent:za}))}function e(za,tb,Wb){var fc=Ie.call(this,Wb,za)||this;fc.hashCode=null;fc.sva=null;fc.w3b=!1;fc.Fm=function(xc,Yb){Yb.Zc.hash===fc.hashCode&&fc.sva&&Object(Va.a)(b(946).DdaFacade,fc.$.da.za(35)).Nzj(fc.sva.InstanceId)};fc.ff=function(xc,Yb){switch(Yb.Zc.block.state){case 1:case 3:case 5:fc.pna(Yb)}};fc.Ai=function(){fc.EGb(!0)};
fc.so=function(xc,Yb){fc.isVisible&&fc.lTa(Yb.wF);fc.clearCache()};fc.pe=function(xc,Yb){fc.mSa(Yb.pa,!!Yb.wF)};fc.tN=function(){fc.$.ea.ama()};fc.STa=tb;fc.domElement.classList.add(xb.a.v8b);fc.domElement.classList.add(Fd.a.No);Wb.tabIndex=0;fc.mSa(fc.$.pa,!1);fc.yc.ka("mousedown",fc.tN);fc.yc.ka("contextmenu",function(xc){He.g(xc)});fc.$.va.lJ(fc.so);fc.$.vb.lJ(fc.so);fc.$.vb.Kf(fc.pe);fc.$.va.Kf(fc.pe);fc.Ea.Fs(fc.ff);fc.Ea.xG(fc.Fm);fc.Ea.mx(fc.Ai);pa.EwaSettings.Zb()&&fc.Ft(fc.hya);return fc}
function k(za,tb,Wb,fc,xc,Yb,Ec,bd,Ic){this.dequeueUtcTime=this.processUtcTime=this.enqueueUtcTime=null;this.operationCount=this.executionDurationInMS=this.inQueueDurationInMS=0;this.UserOperationName=this.ServerCorrelationId=null;this.IsDocumentHidden=!1;this.enqueueUtcTime=za;this.processUtcTime=tb;this.dequeueUtcTime=Wb;this.inQueueDurationInMS=fc;this.executionDurationInMS=xc;this.operationCount=Yb;this.ServerCorrelationId=Ec;this.UserOperationName=bd;this.IsDocumentHidden=Ic}function l(za,tb,
Wb){this.$=za;this.Vi=tb;this.runtimeCalculationMode=Wb}function m(){}function f(za,tb,Wb){var fc=this;this.xEf=null;this.V$c=function(xc,Yb){var Ec=Pc.a.OW,bd={};bd.eventId=xc;bd.payload=Yb;fc.Vi.VZ(2201,Ec)&&fc.Uh.uM(2201,Ec,Mc.a.xc(bd))};this.$=za;this.Vi=tb;this.Uh=Wb;this.jai()}function w(za,tb,Wb){var fc=this;this.nHb=0;this.ogg=!0;this.W9b=0;this.xpd=!0;this.lxe=function(){var xc=document.hasFocus();if(fc.ogg!==xc){if(xc){var Yb=Mc.a.xc({});fc.Uh.uM(2203,Pc.a.OW,Yb)}fc.ogg=xc}};this.mxe=function(xc){(0<
xc.timeRemaining()||xc.didTimeout)&&fc.lxe();window.requestIdleCallback(fc.mxe)};this.$=za;this.Vi=tb;this.Uh=Wb;window.requestIdleCallback||(this.xpd=!1)}function n(za,tb,Wb){var fc=this;this.mHb=0;this.I$a=this.O$a=null;this.BDf=function(){var xc=Da.g(fc.$).ha.Oa.sC;if(xc)if(fc.whf(xc)){var Yb=fc.nja();fc.X$c(Yb);fc.O$a=xc.floatingObject.id;fc.I$a=Yb}else fc.O$a&&(fc.X$c(fc.I$a),fc.O$a=null,fc.I$a=null);else fc.O$a&&(fc.X$c(fc.I$a),fc.O$a=null,fc.I$a=null)};this.$=za;this.Vi=tb;this.Uh=Wb}function z(za,
tb,Wb){var fc=this;this.s2b=null;this.yqd=!1;this.onPointerDown=function(xc){if(3===xc.mb){var Yb=fc.gridView.X$b(xc.clientPoint).C_a;fc.yqd=!!Yb&&fc.gridView.ha.sa.nIe(Yb)}else fc.yqd=!1;fc.s2b=xc.clientPoint;return!1};this.$c=function(xc){if(fc.gridView.inRangePicker||fc.gridView.xi||fc.yqd||xc.shiftKey||xc.ctrlKey||xc.Ca.button!==Sys.UI.MouseButton.leftButton||!fc.s2b||!xc.clientPoint||xc.clientPoint.x!==fc.s2b.x||xc.clientPoint.y!==fc.s2b.y)return!1;var Yb=fc.gridView.X$b(xc.clientPoint);xc=Yb.C_a;
Yb=Yb.returnValue;var Ec=Object(Va.a)(Fb.a,fc.$.va.pa);if(Yb&&Ec&&0===Ec.QF){if(!fc.gridView.ha.sa.Y3.contains(xc))return!1;xc=new r(Ec,xc,Sa.HelperMethods.VCd(Yb.x),Sa.HelperMethods.VCd(Yb.y));fc.tUi(xc)}return!1};this.$=za;this.gridView=Da.g(za);this.Vi=tb;this.Uh=Wb;this.a9i()}function r(za,tb,Wb,fc){var xc=fd.call(this)||this;xc.sheet=za;xc.pVg=tb;xc.offsetX=Wb;xc.offsetY=fc;return xc}function v(za,tb,Wb){var fc=this;this.JNf=this.INf=this.KNf=this.HNf=0;this.pUi=function(xc,Yb){xc=Object(Va.a)(Fb.a,
Yb.pa);fc.d7a(xc)&&(Yb={},Yb.worksheetId=xc.sheetId,Yb=Mc.a.xc(Yb),fc.Nia(11,xc.sheetId,Yb))};this.sUi=function(xc,Yb){xc=Object(Va.a)(Fb.a,Yb.wF);fc.d7a(xc)&&(Yb={},Yb.worksheetId=xc.sheetId,Yb=Mc.a.xc(Yb),fc.Nia(12,xc.sheetId,Yb))};this.qUi=function(xc,Yb){xc=Object(Va.a)(Fb.a,Yb.pa);fc.d7a(xc)&&(Yb={},Yb.worksheetId=xc.sheetId,xc=Mc.a.xc(Yb),fc.Nia(11,null,xc,!0))};this.rUi=function(xc,Yb){xc=Object(Va.a)(Fb.a,Yb.wF);fc.d7a(xc)&&(Yb={},Yb.worksheetId=xc.sheetId,xc=Mc.a.xc(Yb),fc.Nia(12,null,xc,
!0))};this.$=za;this.Vi=tb;this.Uh=Wb}function A(za,tb,Wb){var fc=this;this.OPa=this.NPa=0;this.yGa=this.tha=null;this.xwf=function(){var xc=Da.g(fc.$).ha.Oa.sC;if(0<fc.OPa&&fc.tha&&fc.yGa){var Yb={};Yb.shapeId=fc.tha;Yb.worksheetId=fc.yGa;Yb=Mc.a.xc(Yb);fc.fireEvent(2102,fc.tha,Yb)}fc.smi(xc)?(fc.tha=fc.dNj(xc),fc.yGa=fc.nja(),fc.tha&&fc.yGa)?0<fc.NPa&&(xc={},xc.shapeId=fc.tha,xc.worksheetId=fc.yGa,xc=Mc.a.xc(xc),fc.fireEvent(2101,fc.tha,xc)):wa.ULS.sendTraceTag(537170458,344,10,"Something goes wrong, we got invalid shape id: '{0}', or worksheet id: '{1}' from a Floating object or gridview.",
fc.tha,fc.yGa):(fc.tha=null,fc.yGa=null)};this.$=za;this.Vi=tb;this.Uh=Wb}function B(za,tb,Wb){za=y.call(this,za,tb,Wb)||this;za.Gif=null;za.Fif=null;return za}function y(za,tb,Wb){var fc=ic.call(this)||this;fc.yza=0;fc.zU=0;fc.Rc=function(xc,Yb){if(fc.enabled&&!(fc.ydf()||null!==Yb&&void 0!==Yb&&Yb.Vgf)&&(xc=Object(Va.a)(Fb.a,fc.$.va.pa))&&0===xc.QF){var Ec=xc.sheetId,bd=fc.xXe(),Ic=null,Md=null;fc.Vi.Kgf()&&(Ic=fc.grid.Ab.dk(fc.grid.ha.sa.activeCell),Md=Ec in fc.Ric?fc.Ric[Ec]:null);fc.are(Ec,bd)&&
lb.TaskExtensions.Ba(eb.Task.Ua(!0),function(){fc.l4h(Ec,bd);fc.Y3h(Ec,bd,Ic,Md)},fc.la);fc.hIe(Ec,bd,Ic)}};fc.$=za;fc.Vi=tb;fc.Uh=Wb;fc.grid=Da.g(za);fc.VMa={};fc.Ric={};return fc}function x(za,tb,Wb){var fc=this;this.FNf=this.ENf=0;this.OKb=this.R$a=null;this.dHi=function(){var xc=Da.g(fc.$).ha.Oa.sC;if(fc.smd(xc)&&(xc=fc.$$b(xc))){var Yb={chartId:xc};Yb.worksheetId=fc.nja();Yb=Mc.a.xc(Yb);fc.Nia(51,xc,Yb);fc.Nia(51,fc.nja(),Yb)}};this.eHi=function(){if(fc.R$a){var xc={};xc.chartId=fc.R$a;xc.worksheetId=
fc.OKb;xc=Mc.a.xc(xc);fc.Nia(52,fc.R$a,xc);fc.Nia(52,fc.OKb,xc)}xc=Da.g(fc.$).ha.Oa.sC;fc.smd(xc)?(fc.R$a=fc.$$b(xc),fc.OKb=fc.nja()):(fc.R$a=null,fc.OKb=null)};this.$=za;this.Vi=tb;this.Uh=Wb}function C(){this.FYa={}}function G(za,tb,Wb,fc){fc=void 0===fc?!1:fc;var xc=rc.call(this)||this;xc.fcb=0;xc.yE=null;xc.Ova=!1;xc.nqc=null;xc.zU=0;xc.i1d=null;xc.OGc=null;xc.bVa=null;xc.r5b=null;xc.P8d=!1;xc.JZd=null;xc.tda=null;xc.QNc=null;xc.Rc=function(){xc.enabled&&(xc.Wmj(),xc.nqc=Pb.d(Da.g(xc.$).ha.sa.selectedRanges))};
xc.q4e=function(Yb){Yb.controlId===xc.Jd.InstanceId&&Array.forEach(xc.yE,function(Ec){Ec.Iyi(Yb)&&Ec.h1b(Yb)})};xc.dtf=function(Yb){if((Yb=Object(Va.a)(637,Yb))&&!Yb.Rr())if(!xc.Jd||OSF.OsfControl.isFirstPartyStoreString(xc.Jd.PrimaryMarketplace.MarketplaceType)||xc.$.Wga){Yb.wf=xc.Jd;Yb.lj=xc.Fg;xc.JZd=Yb;xc.Yvc(Yb.SFa);var Ec=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&kb.a.ud(xc.$)&&Sa.HelperMethods.iw(xc.Jd)&&xc.Jd.Preload&&!xc.Jd.TaskpaneVisible;Ec?Yb.Pzd():
pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5550690_FixHiddenStartupStateUnderReactPaneInfra")?(Yb.Pzd(),(xc.Jd.SharedRuntime&&1===xc.Jd.SharedRuntime.LifeTime||xc.Jd.SharedRuntimeId)&&!xc.Jd.TaskpaneVisible&&Yb.$f(!1)):((xc.Jd.SharedRuntime&&1===xc.Jd.SharedRuntime.LifeTime||xc.Jd.SharedRuntimeId)&&!xc.Jd.TaskpaneVisible&&Yb.$f(!1),Yb.Pzd());xc.z5a||(kb.a.ud(xc.$)?Ec||Yb.s6():Ya.a(xc.$).result.MF(Yb,!0));xc.$.da.za(77).fPf(xc.dtf);xc.Yga=Object(Va.a)(521,Yb)}else wa.ULS.sendTraceTag(537170464,
0,50,"Taskpane web add-in disabled by doc IRM")};xc.onFloatingObjectControlAdded=function(Yb,Ec){3===Ec.control.floatingObject.type&&Ec.control.floatingObject.$k.InstanceId===xc.Z0.WebExtensionId&&(xc.Yga=Object(Va.a)(521,Ec.control),xc.Yvc(Ec.control.Dd.firstChild),Cb.a(xc.$).ssc(xc.onFloatingObjectControlAdded))};xc.jb=za.$;xc.Fg=za;xc.Jd=Wb;xc.Jd.InstanceId=Wb.SrcLocationOverrideResourceId?za.X2a(Wb.InstanceId,Wb.SrcLocationOverrideResourceId):Wb.InstanceId;xc.Uh=tb;xc.Z0={};xc.Z0.WebExtensionId=
Wb.InstanceId;xc.wEf="osfControl_"+Wb.InstanceId;xc.P5c="disabled_"+Wb.InstanceId;xc.Z0.BindingData=Wb.BindingData;xc.z5a=xc.Fg.z5a(Wb.InstanceId);xc.ffc=xc.Fg.ffc(Wb.InstanceId);xc.fce=Wb.WebExtensionOsfControlType;xc.IHf=fc;return xc}function E(){}function I(za,tb,Wb,fc,xc,Yb,Ec,bd){za=Ab.call(this,za,tb,Wb)||this;za.startRow=0;za.startColumn=0;za.rowCount=0;za.columnCount=0;za.startColumn=Yb-fc.Reference.FirstColumn;za.columnCount=bd;Yb=Math.max(xc,fc.Reference.FirstRow);xc=Math.min(xc+Ec-1,fc.Reference.LastRow);
Yb>xc?za.startRow=za.rowCount=void 0:(za.startRow=Yb-fc.Reference.FirstRow,za.rowCount=xc-Yb+1);return za}function U(za){var tb=this;this.yE=null;this.Ova=!1;this.Rc=function(){tb.yE.forEach(function(Wb){Wb.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&Wb.h1b(new Ja.a(Wb.eventId,"",null))})};this.Fg=za}function M(za,tb){this.WA=null;this.hfa=za;this.$wg=tb}function T(za){var tb=this;this.ri=this.jWc=null;this.xOi=function(Wb,fc){tb.handlers.kb(fc.controlId)&&(Wb=new K(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,
fc.controlId,null,fc.messageType,fc.messageContent,fc.messageOrigin,fc.targetOrigin),tb.handlers.na(fc.controlId)(Wb),fc.messageType===OSF.DialogMessageType.DialogClosed&&tb.handlers.remove(fc.controlId))};this.wOi=function(Wb,fc){tb.Ukc.kb(fc.controlId)&&(Wb=new F(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,fc.controlId,null,fc.messageType,fc.messageContent,fc.messageOrigin,fc.targetOrigin),tb.Ukc.na(fc.controlId)(Wb))};this.handlers=new sa.a;this.Ukc=new sa.a;this.Fg=za;this.d1a.VFg(this.xOi);
this.d1a.UFg(this.wOi)}function F(za,tb,Wb,fc,xc,Yb,Ec){za=Ta.call(this,za,tb,Wb)||this;za.messageType=0;za.messageContent=null;za.messageOrigin=null;za.targetOrigin=null;za.messageType=fc;za.messageContent=xc;za.messageOrigin=Yb;za.targetOrigin=Ec;return za}function K(za,tb,Wb,fc,xc,Yb,Ec){za=$a.call(this,za,tb,Wb)||this;za.messageType=0;za.messageContent=null;za.messageOrigin=null;za.targetOrigin=null;za.messageType=fc;za.messageContent=xc;za.messageOrigin=Yb;za.targetOrigin=Ec;return za}function J(za,
tb){var Wb=oa.call(this)||this;Wb.requests=[];Wb.C1b=!1;Wb.disposed=!1;Wb.Df=function(){if(!Wb.disposed){Wb.grid.Wb.Nl(Wb.Df);Wb.C1b=!1;var fc=Wb.requests;Wb.requests=[];fc=ak(fc);for(var xc=fc.next();!xc.done;xc=fc.next())xc=xc.value,Wb.ddaFacade.UJ(xc.command,xc.properties)}};Wb.ddaFacade=za;Wb.grid=tb;return Wb}function O(){this.command=0;this.properties=null}function N(za){this.$a=new da.a;this.Mm=za}function H(za,tb,Wb,fc,xc){Wb=void 0===Wb?null:Wb;fc=void 0===fc?"":fc;xc=void 0===xc?"":xc;var Yb=
Ea.call(this)||this;Yb.controlId=za;Yb.messageType=tb;Yb.messageContent=Wb;Yb.messageOrigin=fc;Yb.targetOrigin=xc;return Yb}function Q(za,tb,Wb,fc,xc){Wb=void 0===Wb?null:Wb;fc=void 0===fc?"":fc;xc=void 0===xc?"":xc;var Yb=la.call(this)||this;Yb.controlId=za;Yb.messageType=tb;Yb.messageContent=Wb;Yb.messageOrigin=fc;Yb.targetOrigin=xc;return Yb}function ca(){this.height=this.width=0;this.ze=this.controlId=this.pageUrl=null;this.Jdc=this.X5c=!1}function X(){}function Z(){this.dialog=this.ze=null}function ea(za,
tb,Wb){var fc=Ka.call(this)||this;fc.p9=null;fc.RRc="WACDialogTitleText";fc.RUa="0";fc.bRb="15px";fc.tmg="0px";fc.QUa="calc(100% - 30px)";fc.smg="100%";fc.Sde=0;fc.$a=new da.a;fc.Wjg=new Y;fc.Rb=5;fc.QCa=Wb;fc.ze=Wb;fc.kHc=za;fc.e4d=tb;fc.zHc=!!ta.AFrameworkApplication.fa&&ta.AFrameworkApplication.fa.ra("OfficeAddinEnableInsertDialogAccessibilityFix");return fc}function ka(){}function Y(){}function qa(za,tb){za=fa.call(this,1,za,tb)||this;za.gaf=OfficeExt.CommandInvokeMode.ExclusiveForNew;return za}
function fa(za,tb,Wb){this._id=za;this.Ujg=tb;this.emg=Wb;this.gaf=OfficeExt.CommandInvokeMode.Default}b.r(D);var ha=b(0),ia=b(7),wa=b(15),Qa=b(1507),S=b(83),da=b(97);fa.prototype.execute=function(za,tb,Wb){var fc=this;Wb=Wb||{};Wb.commandMode=this.gaf;tb.invokeAppCommand(this.xHg,this.e_g,Wb,function(){za.IOi(fc.id)})};Af.Object.defineProperties(fa.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}},xHg:{configurable:!0,enumerable:!0,get:function(){return this.Ujg}},e_g:{configurable:!0,
enumerable:!0,get:function(){return this.emg}}});Object(ha.a)(fa,"AddinNativeActionBase",null,[273]);Rk(qa,fa);Object(ha.a)(qa,"AddinTakeSnapshotAction",fa,[]);Y.prototype.U3g=function(za){return new fa(3,za,this.oHh().getNativeActionName(3))};Y.prototype.oHh=function(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()};Object(ha.a)(Y,"AddinNativeActionManager",null,[253]);var xa=b(150);ka.prototype.invokeAppCommand=function(za,tb,Wb,fc){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(za,
tb,Wb,fc)};ka.getInstance=function(){ka.Ma||(ka.Ma=new ka);return ka.Ma};ka.Ma=null;Object(ha.a)(ka,"OSFAddinCommandsRuntimeManager",null,[251]);var ta=b(4),ab=b(183),Na=b(25),Ka=xa.a;Rk(ea,Ka);ea.prototype.NFg=function(za){this.$a.addHandler("OnDialogClosedEventKey",za)};ea.prototype.frj=function(){this.YDa=null};ea.prototype.dD=function(){Ka.prototype.dD.call(this);this.vp.style.width="100%";this.vp.style.height=this.mdc?this.QUa:this.smg;this.vp.style.marginTop=this.mdc?this.bRb:this.tmg;this.vp.style.padding=
this.RUa};ea.prototype.lO=function(){Ka.prototype.lO.call(this);this.Db.style.width=String.format("{0}px",this.kHc*window.innerWidth/100);this.Db.style.height=String.format("{0}px",this.e4d*window.innerHeight/100);this.Db.style.minWidth="0px";this.zHc&&ta.AFrameworkApplication.isRtl&&100===this.kHc&&(this.Db.style.right="0px",this.Db.style.marginRight="0px");this.p9=document.getElementById(this.di(this.RRc));this.p9.style.position="absolute";this.p9.style.whiteSpace="nowrap";this.p9.style.textOverflow=
"ellipsis";ta.AFrameworkApplication.isRtl?(this.p9.style.right="14px",this.p9.style.left="44px"):(this.p9.style.right="44px",this.p9.style.left="14px")};ea.prototype.kv=function(za){Ka.prototype.kv.call(this,za);this.p9&&this.p9.setAttribute("title",za)};ea.prototype.mKd=function(){this.Db.style.width=String.format("{0}px",this.kHc*window.innerWidth/100);this.Db.style.height=String.format("{0}px",this.e4d*window.innerHeight/100);this.Db.style.overflowY="hidden";this.Db.style.overflowX="hidden";this.Db.style.marginTop=
"";this.Db.style.top="";Na.a.WQ&&ta.AFrameworkApplication.isRtl?(this.Db.style.right="",this.Db.style.marginRight=""):(this.Db.style.left="",this.Db.style.marginLeft="")};ea.prototype.hide=function(){var za=this;this.Wjg.U3g(this.QCa).execute(this,ka.getInstance(),{});this.Sde=window.setTimeout(function(){za.$a.raiseEvent("OnDialogClosedEventKey",za.QCa);ab.a.prototype.hide.call(za)},500)};ea.prototype.IOi=function(za){3===za&&(window.clearTimeout(this.Sde),this.$a.raiseEvent("OnDialogClosedEventKey",
this.QCa),Ka.prototype.hide.call(this))};Af.Object.defineProperties(ea.prototype,{c1a:{configurable:!0,enumerable:!0,get:function(){return this.vp}}});Object(ha.a)(ea,"AppsForOfficeDialog",xa.a,[228,229]);Object(ha.a)(Z,"DialogInfo",null,[]);X.url="url";X.height="height";X.width="width";X.X5c="displayInIframe";X.Jdc="hideTitle";Object(ha.a)(X,"DialogSettings",null,[]);Object(ha.a)(ca,"DisplayDialogParams",null,[]);var la=Sys.EventArgs;Rk(Q,la);Object(ha.a)(Q,"OnMessageDialogEventArgs",Sys.EventArgs,
[]);var Ea=Sys.EventArgs;Rk(H,Ea);Object(ha.a)(H,"OnMessageParentEventArgs",Sys.EventArgs,[]);var ra=b(41),na=b(30),ba=b(178),sa=b(100);N.prototype.VFg=function(za){this.$a.addHandler("OnMessageParentEventKey",za)};N.prototype.UFg=function(za){this.$a.addHandler("OnMessageDialogEventKey",za)};N.prototype.showDialog=function(za,tb,Wb,fc){if(N.h8.kb(tb))wa.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),Wb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);
else try{var xc=ra.b(za),Yb=xc[X.url];if(this.Mm.getOsfControl(tb).checkAppDomains(Yb)){var Ec=new ca;Ec.width=xc[X.width];Ec.height=xc[X.height];Ec.pageUrl=Yb;Ec.X5c=xc[X.X5c];Ec.Jdc=xc[X.Jdc];Ec.controlId=tb;Ec.ze=ba.a.create().toString();var bd=new Z;bd.ze=Ec.ze;var Ic=this.Mm.getOsfControl(Ec.controlId).getManifest().getDefaultDisplayName(),Md=this.Mm.getOsfControl(Ec.controlId).getStoreType().toLowerCase();za=null;var ne=ta.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideDialogTitleOption",
!1);za=(4===ta.AFrameworkApplication.ta.Pa.Fj&&"hardcodedpreinstall"===Md||ne&&"sdxcatalog"===Md)&&Ec.Jdc?this.createAndShowAppsForOfficeDialog(Ec.width,Ec.height,Ec.ze,!0,Ic):this.createAndShowAppsForOfficeDialog(Ec.width,Ec.height,Ec.ze,!1,Ic);var le=this.Mm.getOsfControl(Ec.controlId),Ke=le.getManifest();ne={};ne.id=Ec.ze;ne.solutionId=le.getSolutionId();ne.version=le.getVersion();ne.storeType=Md;ne.storeId=le.getStoreId();ne.assetId=le.getAssetId();ne.assetStoreId=le.getAssetStoreId();ne.ownerAddinSolutionId=
le.getOwnerAddinSolutionId();ne.ownerAddinStoreType=le.getOwnerAddinStoreType();ne.appDomains=Ke.getAppDomains();ne.dialogUrl=Yb;ne.osfControlType=1;ne.agaveName=Ic;ne.div=za.c1a;wa.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(ne.solutionId,ne.ownerAddinStoreType||ne.storeType,ne.assetId,null,null,ne.storeId),na.a.Nv(Ec.pageUrl));this.Mm.insertDialogControl(ne);za.NFg(Object(S.a)(this,this.XIi,"onDialogClosed"));bd.dialog=
za;N.h8.ia(Ec.controlId,bd);fc&&fc(ne);Wb(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else wa.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),Wb(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(oc){wa.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",oc.message),Wb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}};N.prototype.iAi=function(za,tb,Wb,fc){ta.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",
!1)||""===fc&&(fc=Wb);try{var xc=this.JJa(za);xc&&this.$a.raiseEvent("OnMessageParentEventKey",new H(xc,OSF.DialogMessageType.DialogMessageReceived,tb,Wb,fc))}catch(Yb){return wa.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",Yb.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess};N.prototype.u0c=function(za,tb){if(N.h8.kb(za))try{var Wb=N.h8.na(za);Wb.dialog&&Wb.dialog.hide();this.Mm.purgeDialogControl(Wb.ze);
N.h8.remove(za);tb(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(fc){wa.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",fc.message),tb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else wa.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),tb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)};N.prototype.Mmj=function(za,tb,Wb,fc){ta.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",
!1)||""===fc&&(fc=Wb);if(N.h8.kb(za)&&(za=N.h8.na(za),za.dialog))try{this.$a.raiseEvent("OnMessageDialogEventKey",new Q(za.ze,OSF.DialogMessageType.DialogParentMessageReceived,tb,Wb,fc))}catch(xc){wa.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",xc.message)}};N.prototype.JJa=function(za){for(var tb=null,Wb=ak(N.h8),fc=Wb.next();!fc.done;fc=Wb.next())if(fc=fc.value,fc.value.ze===za){tb=fc.key;break}return tb};N.prototype.XIi=function(za,tb){if(za=this.JJa(tb))this.Mm.purgeDialogControl(tb),
N.h8.remove(za),this.$a.raiseEvent("OnMessageParentEventKey",new H(za,OSF.DialogMessageType.DialogClosed,null,null,"*"))};N.prototype.createAndShowAppsForOfficeDialog=function(za,tb,Wb,fc,xc){za=new ea(za,tb,Wb);xc=fc?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,xc);fc&&(za.mdc=!1,za.Qu=!1);za.initializeAndShow(xc,null,null);za.frj();return za};N.N_h=function(){return N.h8};N.getInstance=function(za){N.Ma||(N.Ma=new N(za));return N.Ma};N.Ma=null;N.h8=new sa.a;Object(ha.a)(N,"AppsForOfficeDialogManager",
null,[213]);var ya=b(1057),va=b(1518),W=b(1596),La=b(1145),Ia=b(935),mb=b(204),fb=b(1519),Ma=b(120),Hb=b(84),Kb=b(90),Ub=b(737),gb=b(616),Db=b(894),Va=b(85),yb=b(440),qb=b(162),dc=b(202),bb=b(38),db=b(5),wc=b(1072),nb=b(1439),zb=b(79);Object(ha.a)(O,"DdaRequestInfo",null,[]);var ma=b(943),P=b(76),oa=zb.a;Rk(J,oa);J.prototype.Mch=function(za,tb){this.disposed||(this.C1b||(this.grid.Wb.vm(this.Df),this.C1b=!0),this.requests.push(Object(ia.a)(new O,{command:za,properties:tb})))};J.prototype.dispose=
function(){if(!this.disposed){this.disposed=!0;this.C1b&&this.grid.Wb.Nl(this.Df);var za=this.requests;this.requests=null;za=ak(za);for(var tb=za.next();!tb.done;tb=za.next())tb=tb.value,(tb=tb.properties?tb.properties[P.a.o3]:null)&&this.ddaFacade.ef(ma.a.Vxb,tb);this.ddaFacade=this.grid=null;oa.prototype.dispose.call(this)}};J.h_g=function(za,tb){var Wb=!1;974713501===za&&(tb=(za=tb?tb[P.a.Vf]:null)?za.DdaMethod:null)&&tb.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(Wb=
za.ArrayData,Wb=!!Wb&&64===(Wb[6]&64));return Wb};Object(ha.a)(J,"DdaCellEditDelayRequestHandler",zb.a,[]);var Ja=b(976),$a=Ja.a;Rk(K,$a);Object(ha.a)(K,"DialogMessageReceivedEventArgs",Ja.a,[]);var Ta=Ja.a;Rk(F,Ta);Object(ha.a)(F,"DialogParentMessageReceivedEventArgs",Ja.a,[]);var pa=b(1),Da=b(21);T.prototype.addHandler=function(za,tb,Wb,fc){var xc=this;if(pa.EwaSettings.ma(24))this.Fg.ef(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Wb);else{wa.ULS.sendTraceTag(537170502,0,50,"DialogMessageReceivedEventManager.AddHandler called!");
var Yb=function(Ec){Ec===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(xc.handlers.ia(za,tb),xc.Fg.Lu(Wb)):(wa.ULS.sendTraceTag(537170501,0,10,"DialogMessageReceivedEventManager.AddHandler failed!"),xc.Fg.ef(Ec,Wb))};this.handlers.kb(za)?Yb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.showDialog(za,fc,Yb)}};T.prototype.xBg=function(za,tb,Wb){pa.EwaSettings.ma(24)?this.Fg.ef(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Wb):(wa.ULS.sendTraceTag(537170500,0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!"),
this.Ukc.ia(za,tb),this.Fg.Lu(Wb))};T.prototype.removeHandler=function(za,tb){var Wb=this;pa.EwaSettings.ma(24)?this.Fg.ef(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,tb):this.handlers.kb(za)?(wa.ULS.sendTraceTag(537170499,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.d1a.u0c(za,function(fc){Wb.handlers.remove(za);fc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?Wb.Fg.Lu(tb):(wa.ULS.sendTraceTag(537170498,0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),
Wb.Fg.ef(fc,tb))})):this.Fg.ef(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,tb)};T.prototype.y$i=function(za,tb){pa.EwaSettings.ma(24)?this.Fg.ef(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,tb):(wa.ULS.sendTraceTag(537170497,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.Ukc.remove(za),this.Fg.Lu(tb))};T.prototype.showDialog=function(za,tb,Wb){var fc=this;try{pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6254758_ExitCellEditModeDialogAPI")&&Da.g(this.Fg.$).isEditing&&
Da.g(this.Fg.$).Ao(!0),this.d1a.showDialog(tb,za,Wb,function(xc){fc.Fg.PBg(fc.URg(xc))})}catch(xc){wa.ULS.sendTraceTag(537170496,0,10,"DialogMessageReceivedEventManager: show dialog failed. Exception message: {0}",xc.message),Wb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}};T.prototype.URg=function(za){var tb={};tb.InstanceId=za.id;tb.WebExtensionType=za.osfControlType===OSF.OsfControlTarget.InContent?0:1;tb.PrimaryMarketplace={};tb.PrimaryMarketplace.SolutionId=za.solutionId;tb.PrimaryMarketplace.SolutionVersion=
za.version;tb.PrimaryMarketplace.MarketplaceRef=za.storeId;tb.PrimaryMarketplace.MarketplaceType=za.storeType;return tb};T.ka=function(za){if(!za.$.da.za(232)){var tb=new T(za);za.$.da.Ga(232,tb)}};Af.Object.defineProperties(T.prototype,{d1a:{configurable:!0,enumerable:!0,get:function(){this.jWc||(this.jWc=N.getInstance(this.contextActivationMgr));return this.jWc}},contextActivationMgr:{configurable:!0,enumerable:!0,get:function(){!this.ri&&this.Fg&&(this.ri=this.Fg.ri);return this.ri}}});Object(ha.a)(T,
"DialogMessageReceivedEventManager",null,[960]);M.prototype.kZb=function(za){za&&(this.WA||(this.WA=[]),this.WA.push(za))};M.prototype.Asc=function(za){this.WA&&Array.remove(this.WA,za)};M.prototype.Iyi=function(za){return this.eventId!==za.dispid?!1:this.eventId===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?this.targetId===za.ddaBinding.Name:!0};M.prototype.h1b=function(za){this.WA&&Array.forEach(this.WA,function(tb){tb(za)})};
M.prototype.Cma=function(){this.WA=[]};Af.Object.defineProperties(M.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.hfa}},targetId:{configurable:!0,enumerable:!0,get:function(){return this.$wg}},L4h:{configurable:!0,enumerable:!0,get:function(){return 0<this.WA.length}}});Object(ha.a)(M,"DdaEventRegistration",null,[]);U.prototype.invokeDdaMethod=function(za,tb){var Wb={};Wb[P.a.Vf]=za;Wb[P.a.o3]=tb;this.Fg.UJ(974713501,Wb)};U.prototype.registerDdaEventAsync=function(za,
tb,Wb,fc,xc){U.Gyb(za)?(U.Jmd(za)&&this.ljd(),this.yE||(this.yE=[]),tb=this.ztb(za,Wb),tb||(tb=new M(za,Wb),this.yE.push(tb)),tb.kZb(fc),this.Fg.Lu(xc)):this.Fg.ef(-1,xc)};U.prototype.unregisterDdaEventAsync=function(za,tb,Wb,fc,xc){U.Gyb(za)?((za=this.ztb(za,Wb))&&za.Asc(fc),this.Fg.Lu(xc)):this.Fg.ef(-1,xc)};U.prototype.ljd=function(){this.Ova||(Da.g(this.Fg.$).ha.ZD(this.Rc),this.Ova=!0)};U.prototype.ztb=function(za,tb){if(!this.yE)return null;for(var Wb=0;Wb<this.yE.length;Wb++){var fc=this.yE[Wb];
if(fc.eventId===za&&fc.targetId===tb)return fc}return null};U.Gyb=function(za){return za===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};U.Jmd=function(za){return za===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};Object(ha.a)(U,"EmbeddingPage",null,[918]);var rb=b(207),Ab=Ja.a;Rk(I,Ab);I.prototype.getStartRow=function(){return this.startRow};I.prototype.getStartColumn=function(){return this.startColumn};I.prototype.getRowCount=function(){return this.rowCount};I.prototype.getColumnCount=
function(){return this.columnCount};Object(ha.a)(I,"DdaBindingSelectionEventArgs",Ja.a,[]);var ob=b(191),sb=b(24),Pb=b(45),Aa=b(51),Ya=b(441),kb=b(36),lb=b(37),ac=b(629),Dc=b(110),Zb=b(53),mc=b(92),Lb=b(12),Sa=b(10),Cb=b(105);E.gsh="ewa-wx-disabled-div";E.fsh="ewa-wx-container-div";E.jNe="ewa-ptp-nov2-flex";Object(ha.a)(E,"CssClassNames",null,[]);var ec=E.gsh,wb=E.fsh,rc=rb.a;Rk(G,rc);G.prototype.Iai=function(za){this.tda||(this.tda=za)};G.prototype.NOf=function(){this.tda&&(this.tda.dispose(),this.tda=
null)};G.prototype.Dkd=function(){var za=this;if(!OSF.OsfControl.isFirstPartyStoreString(this.Jd.PrimaryMarketplace.MarketplaceType)&&pa.EwaSettings.ma(187)){var tb=Aa.GetServiceTaskFactory.Ra(this.$.da,5,4,0);lb.TaskExtensions.Ba(tb,function(){tb.result.Jf(35,null)},this.la,3);return this}if(1===this.Jd.WebExtensionType)lb.TaskExtensions.Ba(Ya.a(this.$),function(xc){xc.result.Wqb(za.$.da,77,6,za.dtf,1)},this.la,3);else{var Wb=this.nSe(),fc=Cb.a(this.$);Wb||(Wb={Type:3},Wb.Id=this.Z0.WebExtensionId,
Wb.WebExtensionData=this.Jd,Wb.ContentHtml="<div/>",Wb.Version=0,Wb.AbsoluteLeft=0,Wb.AbsoluteTop=0,Wb.AbsoluteRight=0,Wb.AbsoluteBottom=0,Wb.Width=0,Wb.Height=0,Wb.ZOrder=0,Wb.OriginDeltaX=0,Wb.OriginDeltaY=0,Wb=new ob.a(Wb),fc.a4b(Wb,null),Wb=fc.rq(Wb.Hg()));Wb?(this.Yvc(Wb.Dd.firstChild),this.Yga=Object(Va.a)(521,Wb)):fc.bZb(this.onFloatingObjectControlAdded)}return this};G.prototype.t9e=function(za){this.Yvc(za);return this};G.prototype.Hmc=function(){this.IHf||this.Fg.ri.purgeOsfControl(this.controlId,
!1);this.Gag(!0);var za=this.nSe();za&&Cb.a(this.$).deleteFloatingObject(za);this.Fg.Vi.h$i(this.controlId);this.Fg.Vi.mKe(this.controlId,!0);this.QNc=null};G.prototype.bAd=function(za){this.Z0=za};G.prototype.invokeDdaMethod=function(za,tb){if(pa.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled){var Wb={};Wb[P.a.Vf]=za;Wb[P.a.o3]=tb;this.Fg.UJ(974713501,Wb)}else this.Fg.ef(ma.a.Vxb,tb)};G.prototype.G7i=function(za,tb,Wb,fc){if(pa.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||
this.enabled)if(!G.lhh(za)||void 0!==tb&&null!==tb&&void 0!==this.s2a(tb)&&null!==this.s2a(tb))if(wa.ULS.sendTraceTag(36444195,0,50,"eventId: {0}, targetId: {1}",za,tb),G.Kbf(za)&&this.G6h(),G.Jmd(za)&&this.ljd(),G.Ibf(za))pa.EwaSettings.ma(24)?this.Fg.ef(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,fc):this.Fg.$.da.za(232).addHandler(this.controlId,Wb,fc,tb);else if(G.Jbf(za))pa.EwaSettings.ma(24)?this.Fg.ef(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,fc):this.Fg.$.da.za(232).xBg(this.controlId,
Wb,fc);else{G.Hbf(za)&&this.s4e(-1777565636,fc);this.yE||(this.yE=[]);var xc=this.ztb(za,tb);xc||(xc=new M(za,tb),this.yE.push(xc));xc.Cma();xc.kZb(Wb);this.Fg.Lu(fc);za===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.bVa&&(this.r5b=Wb)}else this.Fg.ef(3002,fc);else this.Fg.ef(-1,fc)};G.prototype.UOj=function(za,tb,Wb,fc){G.Ibf(za)?pa.EwaSettings.ma(24)?this.Fg.ef(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,fc):this.Fg.$.da.za(232).removeHandler(this.controlId,fc):G.Jbf(za)?
pa.EwaSettings.ma(24)?this.Fg.ef(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,fc):this.Fg.$.da.za(232).y$i(this.controlId,fc):(G.Hbf(za)&&this.s4e(1592314317,fc),tb=this.ztb(za,tb),this.enabled?(tb&&(tb.Asc(Wb),tb.L4h||Array.remove(this.yE,tb),this.yE.length?G.Kbf(za)&&this.Hag(!1):this.Gag(!1)),this.Fg.Lu(fc)):this.Fg.ef(-1,fc))};G.prototype.ka=function(za){Lb.DOMElementExtensions.getElementById(za,this.wEf)||za.appendChild(Lb.DOMElementExtensions.gf(this.ky))};G.prototype.showHide=
function(za){Lb.DOMElementExtensions.setVisible(this.ky,za)};G.prototype.resize=function(za,tb){Lb.DOMElementExtensions.vr(this.ky,za);Lb.DOMElementExtensions.xI(this.ky,tb)};G.prototype.iHe=function(za){if(!this.zU&&!Lb.DOMElementExtensions.getElementById(this.ky,this.P5c)&&this.ky){var tb=document.createElement("div");tb.id=this.P5c;tb.className=ec;tb.style.backgroundImage="url("+Zb.a.current.Uo(103)+")";tb.style.opacity=za?"1":"0";tb.style.backgroundRepeat="no-repeat";tb.style.backgroundPosition=
"center";this.ky.insertBefore(tb,this.ky.firstChild)}this.zU++};G.prototype.bkh=function(){0<this.zU&&this.zU--;this.zU||(Lb.DOMElementExtensions.gf(Lb.DOMElementExtensions.getElementById(this.ky,this.P5c)),this.Ova&&!Pb.Q(this.nqc,Da.g(this.$).ha.sa.selectedRanges)&&this.Rc(null,null))};G.prototype.s2a=function(za){if(!this.Z0||!this.Z0.BindingData)return null;for(var tb=0;tb<this.Z0.BindingData.length;tb++)if(this.Z0.BindingData[tb].Name===za)return this.Z0.BindingData[tb];return null};G.prototype.getDefaultIconUrl=
function(){var za=this.U_e();return za?za.getDefaultIconUrl():null};G.prototype.getDefaultDisplayName=function(){if(this.Jd.TaskpaneTitle)return this.Jd.TaskpaneTitle;var za=this.U_e();return za?za.getDefaultDisplayName():null};G.prototype.MIf=function(){if(this.bVa&&this.r5b){var za=new Ja.a(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.controlId,null,this.bVa);this.r5b(za);this.r5b=this.bVa=null}};G.prototype.$f=function(za){this.JZd&&this.JZd.$f(za)};G.prototype.Yoj=function(){var za=this;
this.$.ea.isNamedObjectViewMode&&this.Hki()&&(this.$.da.za(34).Xoj(this.ky),this.showHide(!1));if(this.Fg.SWj){if(!this.IHf){var tb={};tb.div=this.ky;tb.id=this.Jd.InstanceId;tb.solutionId=this.Jd.PrimaryMarketplace.SolutionId;tb.version=this.Jd.PrimaryMarketplace.SolutionVersion;tb.storeId=this.Jd.PrimaryMarketplace.MarketplaceRef;tb.storeType=this.Jd.PrimaryMarketplace.MarketplaceType;tb.ownerAddinSolutionId=this.Jd.OwnerAddinSolutionId;tb.ownerAddinStoreType=this.Jd.OwnerAddinStoreType;this.Jd.AssetMarketplace&&
(tb.assetId=this.Jd.AssetMarketplace.SolutionId,tb.assetStoreId=this.Jd.AssetMarketplace.MarketplaceRef);tb.settings=this.Jd.OsfPropertyBag;pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5022710_EnableAgaveInitReasonControlActivation")?tb.reason=this.z5a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:this.ffc?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.ControlActivation:tb.reason=this.z5a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:
Microsoft.Office.WebExtension.InitializationReason.Inserted;tb.osfControlType=0===this.Jd.WebExtensionType?OSF.OsfControlTarget.InContent:OSF.OsfControlTarget.TaskPane;tb.isForUILessAction=4===this.Jd.WebExtensionOsfControlType;tb.sourceLocationOverrideResourceId=this.Jd.SrcLocationOverrideResourceId;tb.focusOnIframeWhenLoaded=this.Jd.FocusOnIframeWhenLoaded;ac.a(this.Jd)&&(tb.featureGates=ta.AFrameworkApplication.fa.qOh(tb.solutionId));tb.hostInfoFlags=0;this.RHa&&(tb.hostInfoFlags|=2);Sa.HelperMethods.iw(this.Jd)&&
(tb.hostInfoFlags|=1);this.$.Wga||(wa.ULS.sendTraceTag(537170466,0,50,"Content web add-in disabled by doc IRM"),tb.hostInfoFlags|=4);pa.EwaSettings.ma(641)&&(tb.hostInfoFlags|=8);pa.EwaSettings.ma(54)&&pa.EwaSettings.ma(94)&&!this.OGc&&(tb.virtualOsfControlActivationCallback=function(){za.Fg.hBd(za.Jd)});tb.sharedRuntimeId=this.Jd.SharedRuntime?this.Jd.SharedRuntime.Resid:this.Jd.SharedRuntimeId;!Sa.HelperMethods.iw(this.Jd)||this.Jd.Preload||ac.a(this.Jd)||this.Fg.ri.getOsfControl(b(946).DdaFacade.getSolutionId(this.Jd,
this.$))||(pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5707326_FixBackgroundAppCrashInViewMode")?this.$.isEditMode&&this.Fg.hBd(this.Jd):this.Fg.hBd(this.Jd));tb.initialDisplayMode=this.Jd.TaskpaneVisible?2:1;pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")&&(tb.titleOverride=this.$k.TaskpaneTitle);this.Fg.ri.insertOsfControl(tb)}this.zU=0}else this.iHe(!0)};G.prototype.Gag=function(za){this.Hag(za);this.AOj()};G.prototype.G6h=function(){this.fcb||this.Uh.kZb(this.q4e);
this.fcb++};G.prototype.Hag=function(za){0<this.fcb&&(za?this.fcb=0:this.fcb--,this.fcb||this.Uh.Asc(this.q4e))};G.prototype.ljd=function(){if(!this.Ova){var za=Da.g(this.$).ha;this.nqc=Pb.d(Da.g(this.$).ha.sa.selectedRanges);za.ZD(this.Rc);this.Ova=!0}};G.prototype.AOj=function(){this.Ova&&(Da.g(this.$).ha.bI(this.Rc),this.Ova=!1)};G.prototype.Plj=function(za){var tb=new sb.Range(za.Reference.FirstRow+1,za.Reference.FirstColumn+1,za.Reference.LastRow+1,za.Reference.LastColumn+1,!1,!1);1===za.BindingType&&
(za.HasHeaders&&--tb.top,za.HasTotals&&(tb.bottom+=1));var Wb=Da.g(this.$).ha.sa.selectedRanges;za=tb.Uxb(this.nqc);Wb=tb.Uxb(Wb);return(tb=tb.Ae(Da.g(this.$).ha.sa.activeRange))&&(Dc.e(za)&&!Dc.e(Wb)||!Dc.e(za)&&!Dc.e(Wb)&&!Pb.Q(za,Wb))?tb:null};G.prototype.Wmj=function(){var za=this;Array.forEach(this.yE,function(tb){if(tb.eventId!==OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&tb.eventId!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||za.Fg.Vi.A_b(za.controlId))if(tb.eventId===
OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)tb.h1b(new Ja.a(tb.eventId,za.controlId,null));else if(tb.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent){var Wb=za.s2a(tb.targetId);if((null===Wb||void 0===Wb?0:Wb.IsValidRef)&&(za.$.ea.isNamedObjectViewMode?za.$.vb.pa.sheetName:za.$.va.pa.name)===Wb.Reference.SheetName){var fc=za.Plj(Wb);fc&&tb.h1b(new I(tb.eventId,za.controlId,za.Fg.o0b(Wb),Wb,fc.top-1,fc.left-1,fc.height,fc.width))}}})};G.prototype.ztb=function(za,tb){if(!this.yE)return null;
for(var Wb=0;Wb<this.yE.length;Wb++){var fc=this.yE[Wb];if(fc.eventId===za&&fc.targetId===tb)return fc}return null};G.prototype.nSe=function(){for(var za=Cb.a(this.$).TU,tb=za.length-1;0<=tb;--tb){var Wb=za[tb];if(3===Wb.floatingObject.type&&Wb.floatingObject.$k.InstanceId===this.Z0.WebExtensionId)return Wb}return null};G.prototype.Hki=function(){for(var za=0;za<this.$.vb.count;za++)if(this.$.vb.getItem(za).hLa===this.Z0.WebExtensionId)return!0;return!1};G.prototype.Yvc=function(za){this.QNc=za;this.ky.id=
this.wEf;this.ky.className=wb;this.ky.dir=this.$.isChromeRtl?"rtl":"ltr";this.Yoj()};G.prototype.U_e=function(){if(!this.enabled)return null;var za=ac.a(this.$k)?"":this.$k.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.$k.PrimaryMarketplace.SolutionId,za)};G.prototype.s4e=function(za,tb){if(pa.EwaSettings.ma(24))this.Fg.ef(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,tb);else try{if(wa.ULS.sendTraceTag(537170462,0,50,"HandleDialogNotificationShownInAddinEvent called!"),
4!==this.fce)this.Fg.ef(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,tb);else{var Wb={};Wb[Ia.a.nnb]=this.controlId;var fc=new mc.a(za,0,this.$.isEditMode?2:1,0,null);this.$.Ka.Kb(fc,Wb);this.Fg.Lu(tb)}}catch(xc){wa.ULS.sendTraceTag(537170461,0,10,"HandleDialogNotificationShownInAddinEvent called. Error message: {0}.",xc.message),this.Fg.ef(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,tb)}};G.lhh=function(za){return za===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||za===
OSF.DDA.EventDispId.dispidBindingDataChangedEvent};G.Kbf=function(za){return za===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||za===OSF.DDA.EventDispId.dispidSettingsChangedEvent||za===OSF.DDA.EventDispId.dispidRichApiMessageEvent};G.Jmd=function(za){return za===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||za===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};G.Ibf=function(za){return za===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent};G.Jbf=function(za){return za===
OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent};G.Hbf=function(za){return za===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent};Af.Object.defineProperties(G.prototype,{controlId:{configurable:!0,enumerable:!0,get:function(){return this.Jd.InstanceId}},controlType:{configurable:!0,enumerable:!0,get:function(){return this.Jd.WebExtensionType}},ownerAddinSolutionId:{configurable:!0,enumerable:!0,get:function(){return this.Jd.OwnerAddinSolutionId}},$:{configurable:!0,enumerable:!0,
get:function(){return this.jb}},enabled:{configurable:!0,enumerable:!0,get:function(){return!this.zU}},ky:{configurable:!0,enumerable:!0,get:function(){return this.QNc}},kU:{configurable:!0,enumerable:!0,get:function(){return this.Jd.SrcLocationOverrideResourceId?this.Fg.X2a(this.Jd.PrimaryMarketplace.SolutionId,this.Jd.SrcLocationOverrideResourceId):this.Jd.PrimaryMarketplace.SolutionId}},sourceLocationOverrideResourceId:{configurable:!0,enumerable:!0,get:function(){return this.Jd.SrcLocationOverrideResourceId}},
$k:{configurable:!0,enumerable:!0,get:function(){return this.Jd}},Yga:{configurable:!0,enumerable:!0,get:function(){return this.i1d},set:function(za){this.i1d=za}},osfControlType:{configurable:!0,enumerable:!0,get:function(){return this.fce}},RHa:{configurable:!0,enumerable:!0,get:function(){return this.OGc},set:function(za){this.OGc=za}},q4c:{configurable:!0,enumerable:!0,get:function(){return this.bVa},set:function(za){this.bVa=za}},focusOnIframeWhenLoaded:{configurable:!0,enumerable:!0,get:function(){return this.Jd.FocusOnIframeWhenLoaded}},
Jod:{configurable:!0,enumerable:!0,get:function(){return this.P8d},set:function(za){this.P8d=za}}});Object(ha.a)(G,"OsfControl",rb.a,[959]);C.prototype.add=function(za){this.FYa[za]=!0};C.prototype.remove=function(za){delete this.FYa[za]};C.prototype.clear=function(){for(var za=ak(Object.keys(this.FYa)),tb=za.next();!tb.done;tb=za.next())delete this.FYa[tb.value]};C.prototype.G5e=function(){return 0<Object.keys(this.FYa).length};C.prototype.nHh=function(){return Object.keys(this.FYa)};Object(ha.a)(C,
"RichApiBeforeDocumentCloseNotificationRegistrationManager",null,[]);var Mc=b(54);x.prototype.iob=function(za){51===za.messageType?this.ENf=this.eGa(za.actionType,this.ENf,this.dHi):52===za.messageType&&(this.FNf=this.eGa(za.actionType,this.FNf,this.eHi))};x.prototype.eGa=function(za,tb,Wb){if(1===za)tb||Da.g(this.$).ha.Oa.AUc(Wb),tb++,this.Hsj();else if(2===za){if(1>tb)return tb;1===tb&&Da.g(this.$).ha.Oa.vId(Wb);tb--}return tb};x.prototype.Nia=function(za,tb,Wb){tb&&this.Vi.VZ(za,tb)&&this.Uh.uM(za,
tb,Wb)};x.prototype.$$b=function(za){return za&&za.floatingObject?(za=za.floatingObject.id.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")))&&1===za.length?za[0]:null:null};x.prototype.nja=function(){var za=this.$.va.pa;return za&&0===za.QF?za.sheetId:null};x.prototype.Hsj=function(){var za=Da.g(this.$).ha.Oa.sC;this.smd(za)&&(this.R$a=this.$$b(za),this.OKb=this.nja())};x.prototype.smd=function(za){return!!za&&!!za.floatingObject&&0===za.floatingObject.type};Object(ha.a)(x,"RichApiEventChartActivatedDeactivatedHandler",
null,[]);var Pc=b(949),Kc=b(198),ub=b(708),Fb=b(101),pc=b(359),eb=b(58),ic=zb.a;Rk(y,ic);y.prototype.X_b=function(za){Object(Va.a)(pc.a,this.$.va);1===za.actionType?(this.yza||this.grid.ha.ZD(this.Rc),this.yza++):2!==za.actionType||1>this.yza||(1===this.yza&&this.grid.ha.bI(this.Rc),this.yza--)};y.prototype.Jvc=function(za){za?this.zU++:(0<this.zU&&this.zU--,this.zU||this.Rc(null,new ub.a(!1)))};y.prototype.xXe=function(){return this.grid.ha.sa.selectedRanges};y.prototype.are=function(za,tb){return pa.EwaSettings.isChangeGateEnabled("OfficeVSO:4233860_EnableSelectionChangedEventForFirstTimeOnOpenSheet")?
(!!za&&Kc.e(this.VMa)||za in this.VMa)&&!Pb.Q(this.VMa[za],tb):za in this.VMa&&!Pb.Q(this.VMa[za],tb)};y.prototype.hIe=function(za,tb,Wb){this.VMa[za]=Pb.d(tb);this.Ric[za]=Wb};y.prototype.ydf=function(){return this.grid.isEditing||this.grid.xi};y.prototype.OSe=function(za,tb){this.Vi.VZ(14,za)&&this.Uh.uM(14,za,tb);this.Vi.VZ(14,Pc.a.OW)&&this.Uh.uM(14,Pc.a.OW,tb)};y.prototype.l4h=function(za,tb){var Wb={};Wb.worksheetId=za;Wb.address=this.ofd(tb);tb=Mc.a.xc(Wb);this.OSe(za,tb)};y.prototype.Y3h=
function(za,tb,Wb,fc){if(this.Vi.Kgf()){var xc="",Yb="";fc&&(xc=fc.Ei);Wb&&(Yb=Wb.Ei);fc?Wb?(tb=Wb.usedRange.Uxb(tb),xc!==Yb&&this.F9b(xc,"",za),this.F9b(Yb,this.ofd(tb),za)):this.F9b(xc,"",za):Wb&&(xc=Wb.usedRange.Uxb(tb),this.F9b(Yb,this.ofd(xc),za))}};y.prototype.F9b=function(za,tb,Wb){if(this.Vi.VZ(100,za)){var fc={};fc.address=tb;fc.worksheetId=Wb;this.Uh.uM(100,za,Mc.a.xc(fc))}};y.prototype.ofd=function(za){return Pb.i(za,",",this.$,!1)};y.prototype.dispose=function(){0<this.yza&&this.grid.ha.bI(this.Rc);
this.Ric=this.VMa=null;this.yza=0;this.Uh=this.Vi=this.$=this.grid=null};Af.Object.defineProperties(y.prototype,{enabled:{configurable:!0,enumerable:!0,get:function(){return!this.zU&&0<this.yza}}});Object(ha.a)(y,"RichApiEventSelectionChangedHandler",zb.a,[]);var Ac=b(355);Rk(B,y);B.prototype.xXe=function(){return Ac.a.frb(this.grid.ha.rangePicker.zK)};B.prototype.are=function(za,tb){return this.Gif!==za||!Pb.Q(this.Fif,tb)};B.prototype.hIe=function(za,tb){this.Gif=za;this.Fif=Pb.d(tb)};B.prototype.ydf=
function(){return!this.grid.isEditing&&!this.grid.xi};B.prototype.OSe=function(za,tb){this.Vi.VZ(2700,Pc.a.OW)&&this.Uh.uM(2700,Pc.a.OW,tb)};Object(ha.a)(B,"RichApiEventPickedRangesChangedHandler",y,[]);A.prototype.iob=function(za){var tb=Da.g(this.$).ha;1===za.actionType?(this.NPa||this.OPa||tb.Oa.AUc(this.xwf),2101===za.messageType?this.NPa++:2102===za.messageType&&this.OPa++):2===za.actionType&&(2101===za.messageType?this.NPa=0<this.NPa?this.NPa-1:0:2102===za.messageType&&(this.OPa=0<this.OPa?
this.OPa-1:0),this.NPa||this.OPa||tb.Oa.vId(this.xwf))};A.prototype.smi=function(za){return!!za&&!!za.floatingObject&&(0===za.floatingObject.type||7===za.floatingObject.type||1===za.floatingObject.type||3===za.floatingObject.type||5===za.floatingObject.type)};A.prototype.dNj=function(za){if(!za||!za.floatingObject)return null;za=za.floatingObject.id;var tb=za.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));tb=tb&&1===tb.length?tb[0]:null;return tb?tb:(wa.ULS.sendTraceTag(537170457,344,
10,"Expect get the guid like shape id from the floating object id: '{0}', but we failed.",za),null)};A.prototype.nja=function(){var za=this.$.va.pa;return za&&0===za.QF?za.sheetId:null};A.prototype.fireEvent=function(za,tb,Wb){tb&&this.Vi.VZ(za,tb)&&this.Uh.uM(za,tb,Wb)};Object(ha.a)(A,"RichApiEventShapeActivatedDeactivatedHandler",null,[]);v.prototype.iob=function(za){11===za.messageType?za.targetId===Pc.a.OW?this.YLg(za.actionType):this.XLg(za.actionType):12===za.messageType&&(za.targetId===Pc.a.OW?
this.ZLg(za.actionType):this.$Lg(za.actionType))};v.prototype.XLg=function(za){this.HNf=this.eGa(za,this.HNf,this.pUi)};v.prototype.$Lg=function(za){this.KNf=this.eGa(za,this.KNf,this.sUi)};v.prototype.YLg=function(za){this.INf=this.eGa(za,this.INf,this.qUi)};v.prototype.ZLg=function(za){this.JNf=this.eGa(za,this.JNf,this.rUi)};v.prototype.eGa=function(za,tb,Wb){1===za?tb=this.UWc(tb,Wb):2===za&&(tb=this.B5c(tb,Wb));return tb};v.prototype.UWc=function(za,tb){za||this.$.va.Kf(tb);za++;return za};v.prototype.B5c=
function(za,tb){if(1>za)return za;1===za&&this.$.va.wg(tb);za--;return za};v.prototype.d7a=function(za){return!!za&&0===za.QF};v.prototype.Nia=function(za,tb,Wb,fc){tb=(void 0===fc?0:fc)?Pc.a.OW:tb;this.Vi.VZ(za,tb)&&this.Uh.uM(za,tb,Wb)};Object(ha.a)(v,"RichApiEventSheetActivatedDeactivatedHandler",null,[]);var lc=b(245),Gc=b(13),ed=b(233),fd=Sys.EventArgs;Rk(r,fd);Object(ha.a)(r,"ClickInActiveCellEventArgs",Sys.EventArgs,[]);z.prototype.dispose=function(){this.oPj()};z.prototype.a9i=function(){for(var za=
ak(this.gridView.hn),tb=za.next();!tb.done;tb=za.next())tb=tb.value.domElement,lc.a.instance.qa(Gc.a.pointerDown,tb,this.onPointerDown),ed.a.instance.qa(Gc.a.click,tb,this.$c)};z.prototype.oPj=function(){for(var za=ak(this.gridView.hn),tb=za.next();!tb.done;tb=za.next())tb=tb.value.domElement,lc.a.instance.Aa(Gc.a.pointerDown,tb,this.onPointerDown),ed.a.instance.Aa(Gc.a.click,tb,this.$c)};z.prototype.tUi=function(za){var tb=za.sheet;if(this.d7a(tb)){var Wb={};Wb.worksheetId=tb.sheetId;Wb.address=
za.pVg.toString();Wb.offsetX=za.offsetX;Wb.offsetY=za.offsetY;za=tb.sheetId;this.Vi.VZ(21,za)&&(tb=Mc.a.xc(Wb),this.Uh.uM(21,za,tb));za=Pc.a.OW;this.Vi.VZ(21,za)&&(Wb=Mc.a.xc(Wb),this.Uh.uM(21,za,Wb))}};z.prototype.d7a=function(za){return!!za&&0===za.QF};Object(ha.a)(z,"RichApiEventSingleClickedHandler",null,[]);n.prototype.X_b=function(za){2E3===za.messageType&&(1===za.actionType?(this.mHb||Da.g(this.$).ha.Oa.AUc(this.BDf),this.mHb++,this.epj()):2===za.actionType&&this.mHb&&(1===this.mHb&&Da.g(this.$).ha.Oa.vId(this.BDf),
this.mHb--))};n.prototype.X$c=function(za){var tb,Wb={};Wb.worksheetId=za;Wb.revisionLoad=!1;if(pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5509495_SelectedVisualIdVisualSelectionChangedEventArgs")&&(pa.EwaSettings.ma(719)||pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSChartPlayerManualPlacement",!1))){var fc=Da.g(this.$).ha.Oa.sC;(null===(tb=null===fc||void 0===fc?void 0:fc.floatingObject)||void 0===tb?0:tb.Oc)?Wb.selectedVisualId=fc.floatingObject.Oc.VisualID:Wb.selectedVisualId=
null}tb=Mc.a.xc(Wb);za&&this.Vi.VZ(2E3,za)&&this.Uh.uM(2E3,za,tb)};n.prototype.nja=function(){var za=this.$.va.pa;return za&&0===za.QF?za.sheetId:null};n.prototype.epj=function(){var za=Da.g(this.$).ha.Oa.sC;this.whf(za)&&(this.O$a=za.floatingObject.id,this.I$a=this.nja())};n.prototype.whf=function(za){return!!za&&za.Qqd()};Object(ha.a)(n,"RichApiEventVisualSelectionChangedHandler",null,[]);w.prototype.WLg=function(za){1===za.actionType?(this.nHb||this.qMg(),this.nHb++):2!==za.actionType||1>this.nHb||
(1===this.nHb&&this.Vdh(),this.nHb--)};w.prototype.qMg=function(){if(this.Vi.VZ(2203,Pc.a.OW))if(this.xpd){var za={};za.timeout=this.$.ya.CheckFocusTimeout;this.W9b=window.requestIdleCallback(this.mxe,za)}else this.W9b=window.setInterval(this.lxe,this.$.ya.CheckFocusTimeInterval)};w.prototype.Vdh=function(){this.xpd?window.cancelIdleCallback(this.W9b):window.clearInterval(this.W9b)};Object(ha.a)(w,"RichApiEventWorkbookActivatedHandler",null,[]);var Bc;(function(za){za[za.none=0]="none";za[za.registerEvent=
1]="registerEvent";za[za.unregisterEvent=2]="unregisterEvent";za[za.customFunction=3]="customFunction";za[za.showCard=4]="showCard";za[za.createWorkbook=5]="createWorkbook";za[za.openWorkbook=6]="openWorkbook";za[za.enableEvents=7]="enableEvents";za[za.closeWorkbook=8]="closeWorkbook";za[za.setCalculationMode=9]="setCalculationMode";za[za.workbookLinksRequestRefresh=10]="workbookLinksRequestRefresh";za[za.workbookLinksRequestRefreshAll=11]="workbookLinksRequestRefreshAll";za[za.workbookLinksEnableContent=
12]="workbookLinksEnableContent";za[za.workbookLinksFindNextLink=13]="workbookLinksFindNextLink";za[za.workbookLinksOpenWorkbook=14]="workbookLinksOpenWorkbook";za[za.rangePicker=15]="rangePicker";za[za.enableRichApiRecording=16]="enableRichApiRecording";za[za.recordAction=17]="recordAction";za[za.focus=18]="focus";za[za.businessBarShow=19]="businessBarShow";za[za.businessBarHide=20]="businessBarHide"})(Bc||(Bc={}));Object(ha.b)("PostProcessActionType",Bc);var ld=b(246);f.prototype.VLg=function(za){1===
za.actionType?(this.$.wba=!0,Object(Va.a)(b(946).DdaFacade,ld.a(this.$)).W$c(!0)):2===za.actionType&&(this.$.wba=!1);this.xEf=za.controlId;wa.ULS.sendTraceTag(537170456,0,50,"AttachOrDetachMacroRecorderEventHandler: actionType: {0}; controlId: {1}; this.ewaControl.IsMacroRecorderListening: {2}.",Bc[za.actionType],this.xEf,this.$.wba)};f.prototype.mlh=function(za){Object(Va.a)(b(946).DdaFacade,ld.a(this.$)).RSe(za,this.$.wba)};f.prototype.jai=function(){var za=this;this.$.Aba&&lb.TaskExtensions.Ba(Aa.GetServiceTaskFactory.Ra(this.$.da,
297,298,1),function(tb){(tb=tb.result)&&tb.init(za.V$c)},this.$.la,3)};Object(ha.a)(f,"RichApiMacroRecorderEventHandler",null,[]);Object(ha.a)(m,"SessionRecreationInfo",null,[]);l.prototype.DCi=function(){return pa.EwaSettings.ma(260)?this.Vi.U4h()||0!==this.runtimeCalculationMode:!1};l.prototype.fRg=function(){var za={};za.eventRegistrationInfos=this.Vi.ENh();za.runtimeCalculationMode=this.runtimeCalculationMode;za=Object(ia.a)(new m,{runtimeState:za});var tb={HttpMethod:"POST",PathAndQuery:"RestoreRuntimeState",
RequestHeaders:null};tb.RequestBody=JSON.stringify(za);tb.RequestFlags=1;return tb};Object(ha.a)(l,"RichApiRuntimeStateHandler",null,[]);Object(ha.a)(k,"UserOperationQueueItemsStatisticsData",null,[]);var Bd=b(342),xb=b(31),Fd=b(18),Vd=b(308),se=b(48),ue=b(657),Ee=b(64),qe=b(59),He=b(69),Ie=Bd.a;Rk(e,Ie);e.prototype.dispose=function(){this.$&&(this.$.va.FK(this.so),this.$.vb.FK(this.so),this.$.vb.wg(this.pe),this.$.va.wg(this.pe));this.STa&&(this.STa.Gq(this.ff),this.STa.aI(this.Fm),this.STa.fv(this.Ai));
pa.EwaSettings.Zb()&&this.Fw(this.hya);this.clearCache();Kb.a.Ia(this.STa);this.STa=null;Lb.DOMElementExtensions.gf(this.domElement);Ie.prototype.dispose.call(this)};e.prototype.Xoj=function(za){Lb.DOMElementExtensions.gf(Lb.DOMElementExtensions.getElementById(this.domElement,za.id));this.domElement.appendChild(za)};e.prototype.Qkd=function(){if(this.sva&&!this.w3b){var za=Object(Va.a)(b(946).DdaFacade,ld.a(this.$)).Vm(this.sva.InstanceId);za&&(za.resize(this.sva.Width,this.sva.Height),za.ka(this.domElement),
za.showHide(!0),this.w3b=!0)}};e.prototype.f7a=function(){return!0};e.prototype.pna=function(za){this.sva=za.Zc.block.me;this.w3b=!1;this.Qkd()};e.prototype.lTa=function(za){this.$.ea.TZ&&za&&(za.ru||(za.ru=new Vd.a),za.ru.Ih=new se.a(this.domElement.scrollLeft,this.domElement.scrollTop),za.ru.XFb=20)};e.prototype.clearCache=function(){this.Ea.SPa(this.hashCode);this.sva=this.hashCode=null;this.w3b=!1};e.prototype.mSa=function(za,tb){if(this.isVisible=!!za&&Ee.o(za))this.hashCode=this.Ea.Ara(za,qe.a.G5b,
this.hashCode),this.mwc(tb)};e.fGa=function(za){if(!za.da.za(34)){var tb=za.uf;za.da.Ga(34,new e(za,new ue.a(za,za.ea,za.oa.Gk,3,0),tb.appendChild(tb.ownerDocument.createElement("div"))))}};Af.Object.defineProperties(e.prototype,{Ea:{configurable:!0,enumerable:!0,get:function(){return this.STa}}});Object(ha.a)(e,"WebExtensionView",Bd.a,[953,421,10]);var ef=b(235),Ye=b(564),pe=b(389),Qd=b(470),fe=b(177),Hc=b(61),ud=b(121),Gd=b(47),jd=b(44),Sd=b(159),Wd=b(111),Le=b(68),Pd=b(28),Re=b(29),Qe=b(296),jc=
b(22),Fa=b(14),Qb=b(295),cb=b(948),Xb=b(50),kc=b(154),Wc=b(1075),id=b(205),Vc=b(1074),td=b(27);b.d(D,"DdaFacade",function(){return a});var rd=bb.a;Rk(a,rd);a.prototype.qme=function(za){this.addHandler("cd",za)};a.prototype.Daj=function(za){this.removeHandler("cd",za)};a.prototype.kEg=function(za){this.addHandler("csc",za)};a.prototype.Faj=function(za){this.removeHandler("csc",za)};a.prototype.hEg=function(za){this.addHandler("ca",za)};a.prototype.Caj=function(za){this.removeHandler("ca",za)};a.prototype.iEg=
function(za){this.addHandler("ci",za)};a.prototype.jEg=function(za){this.addHandler("ekros",za)};a.prototype.Eaj=function(za){this.removeHandler("ekros",za)};a.prototype.oCd=function(za,tb){try{return JSON.parse(za)[tb].toLowerCase()}catch(Wb){return""}};a.prototype.Avj=function(za){var tb=this.oCd(za,"AudienceGroup"),Wb=this.oCd(za,"SessionOrigin");try{var fc=parseInt(this.oCd(za,"Ring"),10);if("automation"!==tb&&"bluechicken"!==Wb&&-2<=fc)return!0}catch(xc){if("automation"!==tb&&"bluechicken"!==
Wb)return!0}return!1};a.prototype.o0b=function(za){var tb={};tb.Name=za.Name;tb.BindingType=za.BindingType;tb.HasHeaders=za.HasHeaders;za.IsValidRef&&(tb.ColCount=za.Reference.LastColumn-za.Reference.FirstColumn+1,tb.RowCount=za.Reference.LastRow-za.Reference.FirstRow+1);return tb};a.prototype.kri=function(za,tb){this.Mm.launchInsertDialog(za,null,this.jQg(tb))};a.prototype.Pca=function(za,tb){if(ta.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType"))this.nJf(za,
tb,OSF.StoreTypeEnum.MarketPlace);else{var Wb={};Wb.callbackFunc=za;Wb.storeType=OSF.StoreTypeEnum.MarketPlace;Wb.fromInsertDialog=!1;Wb.refresh=tb;this.Mm.queryEntitlementDetails(Wb)}};a.prototype.nJf=function(za,tb,Wb){var fc={};fc.callbackFunc=za;fc.storeType=Wb;fc.fromInsertDialog=!1;fc.refresh=tb;this.Mm.queryEntitlementDetails(fc)};a.prototype.invokeDdaMethod=function(za,tb){var Wb=this.Vm(za.DdaMethod.ControlId);Wb?Wb.invokeDdaMethod(za,tb):this.ef(ma.a.internalError,tb)};a.prototype.registerDdaEventAsync=
function(za,tb,Wb,fc,xc){(tb=this.Vm(tb))?a.Gyb(za)?tb.G7i(za,Wb,fc,xc):this.ef(ma.a.FBd,xc):this.ef(ma.a.internalError,xc)};a.prototype.unregisterDdaEventAsync=function(za,tb,Wb,fc,xc){(tb=this.Vm(tb))?a.Gyb(za)?tb.UOj(za,Wb,fc,xc):this.ef(ma.a.FBd,xc):this.ef(ma.a.internalError,xc)};a.prototype.dispose=function(){this.disposed||(this.$.ol(this.Yc),this.ea.xk(this.Uc),this.ea.GR(this.uo),this.ea.Gw(this.Sf),this.AVc.detach(this),this.$.userOperationManager.wo(this.rR),this.Moc=this.qf=this.Uh=this.AVc=
this.jb=null,this.yIa&&(this.yIa.dispose(),this.yIa=null),Kb.a.Ia(this.iLd),Kb.a.Ia(this.hLd),this.R0a&&(this.R0a.dispose(),this.R0a=null),rd.prototype.dispose.call(this),this.disposed=!0,wa.ULS.sendTraceTag(537170583,0,50,"DdaFacade is disposed"))};a.prototype.Ucd=function(za){return(za=this.Vm(za))?za.getDefaultIconUrl():null};a.prototype.Jvc=function(za){if(this.SEe!==za){this.SEe=za;for(var tb=0,Wb=this.qf.length;tb<Wb;tb++){var fc=this.qf[tb];za?fc.iHe(!1):fc.bkh()}this.iLd.Jvc(za);this.hLd.Jvc(za)}};
a.prototype.oMh=function(za){return(za=this.Vm(za))?za.getDefaultDisplayName():null};a.prototype.ef=function(za,tb,Wb){var fc={};fc[P.a.Vf]=za;fc[P.a.o3]=tb;this.UJ(451041795,fc,void 0===Wb?!0:Wb)};a.prototype.Lu=function(za){var tb={};tb[P.a.o3]=za;this.UJ(1237877382,tb)};a.prototype.UJ=function(za,tb,Wb){var fc=this;Wb=void 0===Wb?!0:Wb;var xc=new mc.a(za,0,this.$.Jc,0,null),Yb=tb?tb[P.a.o3]:null;this.R0a&&Da.g(this.$).isEditing&&J.h_g(za,tb)?this.R0a.Mch(za,tb):(za=this.$.Ka.Kb(xc,tb),Wb&&lb.TaskExtensions.Ba(za,
function(Ec){Sd.a(Ec)?fc.ef(ma.a.internalError,Yb,!1):Ec.result||(Da.g(fc.$).isEditing?fc.ef(ma.a.Vxb,Yb,!1):fc.ef(ma.a.internalError,Yb,!1))},this.la,8))};a.prototype.H1g=function(za){var tb=this;return!!this.Mia(function(Wb){return a.getSolutionId(Wb.$k,tb.$)===a.getSolutionId(za,tb.$)&&Wb.$k.PrimaryMarketplace.MarketplaceType===za.PrimaryMarketplace.MarketplaceType&&Wb.$k.PrimaryMarketplace.MarketplaceRef===za.PrimaryMarketplace.MarketplaceRef&&Wb.$k.PrimaryMarketplace.SolutionVersion===za.PrimaryMarketplace.SolutionVersion})};
a.prototype.Vm=function(za){return this.Mia(function(tb){return tb.controlId.startsWith(za)})};a.prototype.EAh=function(za){return this.Mia(function(tb){return tb.RHa===za})};a.prototype.oSe=function(za){return this.Mia(function(tb){return tb.kU===za&&!!tb.RHa})};a.prototype.GSe=function(za,tb,Wb,fc){return this.Mia(function(xc){return xc.kU===za&&xc.$k.PrimaryMarketplace.MarketplaceRef.toLowerCase()===tb.toLowerCase()&&xc.$k.PrimaryMarketplace.MarketplaceType.toLowerCase()===Wb.toLowerCase()&&!!xc.$k.SharedRuntime&&
!!xc.$k.SharedRuntime.Resid&&!!fc&&!!fc.Resid&&xc.$k.SharedRuntime.Resid.toLowerCase()===fc.Resid.toLowerCase()})};a.prototype.KLg=function(za,tb){if(za=this.Vm(za))za.ka(tb),za.showHide(!0)};a.prototype.Nzj=function(za){(za=this.Vm(za))&&za.showHide(!1)};a.prototype.r0a=function(za){var tb;if(1!==za.WebExtensionType||this.$.Bd&8388608&&za.TaskpaneVisible||this.$.Bd&8388608&&!za.TaskpaneVisible&&Sa.HelperMethods.iw(za)){var Wb=null;Sa.HelperMethods.iw(za)&&(Wb=a.Gua(za,this.$),za.TaskpaneWidth||(za.TaskpaneWidth=
this.M5b));var fc=(new G(this,this.Uh,za)).Dkd();wa.ULS.sendTraceTag(51263011,0,50,"DdaFacade::CreateOsfControl: SolutionId: {0}, StoreType: {1}, UseShareRuntime: {2}",Telemetry.PrivacyRules.GetPrivacyCompliantId(za.PrimaryMarketplace.SolutionId,za.PrimaryMarketplace.MarketplaceType,null===(tb=za.AssetMarketplace)||void 0===tb?void 0:tb.SolutionId,null,null,za.PrimaryMarketplace.MarketplaceRef),za.PrimaryMarketplace.MarketplaceType,Sa.HelperMethods.iw(za));Wb&&(fc.RHa=Wb);this.qf.push(fc);this.gxa=
null;this.z5a(za.InstanceId)||(za=String.format("{0}|{1}|{2}|{3}|{4}",za.PrimaryMarketplace.SolutionId,za.PrimaryMarketplace.SolutionVersion,za.PrimaryMarketplace.MarketplaceRef,za.PrimaryMarketplace.MarketplaceType,za.WebExtensionType),this.raiseEvent("ci",za))}};a.prototype.vBj=function(za,tb){function Wb(){fc.UPa(Yb.controlId);fc.ri.purgeOsfControl(Yb.controlId,!1);tb()}var fc=this;za.TaskpaneWidth=this.M5b;za.TaskpaneVisible=!0;var xc={};xc.SolutionId=za.PrimaryMarketplace.SolutionId;xc.TargetType=
za.WebExtensionType;xc.Version=za.PrimaryMarketplace.SolutionVersion;xc.StoreType=za.PrimaryMarketplace.MarketplaceType;xc.StoreId=za.PrimaryMarketplace.MarketplaceRef;xc.AssetId=za.PrimaryMarketplace.SolutionId;xc.AssetStoreId=za.PrimaryMarketplace.MarketplaceRef;xc.Width=za.TaskpaneWidth;var Yb=new G(this,this.Uh,za,!0);Yb.Dkd();this.qf.push(Yb);var Ec=null;Ec=Gd.a.instance.sE(function(){Yb.ky&&(Kb.a.Ia(Ec),Ec=null,fc.ri.insertBlankControlWithErrorUX(fc.dGb(Yb,xc),Wb))},100,jd.a.Cbh)};a.prototype.w5g=
function(za){var tb=this;if(za&&za.length){var Wb=[];za.forEach(function(fc){if(fc.ContainsCustomFunctions){var xc=a.Gua(fc,tb.$);tb.MCd.contains(xc)||(tb.MCd.add(xc),tb.PFf.push(fc));tb.H1g(fc)||Wb.push(fc)}});Wb.length&&this.aCe(Wb)}};a.prototype.YDe=function(za,tb){this.Vm(za.InstanceId)||(tb=tb(),za=(new G(this,this.Uh,za)).t9e(tb),this.qf.push(za),this.gxa=null)};a.prototype.izj=function(za){a.L0a.kb(za)&&a.L0a.na(za).initializeAndShowWithTitle()};a.prototype.S5h=function(za){a.L0a.kb(za)&&a.L0a.na(za).hide()};
a.prototype.$Sh=function(za){var tb=this,Wb=null,fc,xc=null;var Yb=a.Hgd(za,!0);if(!Yb)return wa.ULS.sendTraceTag(537170570,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),eb.Task.Ua(null);(fc=this.Mm.getOsfControl(a.getSolutionId(Yb,this.$)))&&(Wb=fc.getManifest())&&(xc=Wb.getSharedRuntimeForCustomFunctions("Workbook"));if(Wb=xc&&1===xc.LifeTime?this.GSe(Yb.PrimaryMarketplace.SolutionId,Yb.PrimaryMarketplace.MarketplaceRef,Yb.PrimaryMarketplace.MarketplaceType,
xc):this.EAh(za))return eb.Task.Ua(Wb.controlId);var Ec=new qb.a;Sa.HelperMethods.oic(xc)&&(Yb.SharedRuntime=xc);za=fc?fc.getNotificationParams():[];if(!za.length)return this.ECe(Yb);this.i2f(za,function(){lb.TaskExtensions.Ba(Ec.task,function(){tb.ECe(Yb)},tb.la,3)},function(){});return Ec.task};a.prototype.lHh=function(za){za=a.Hgd(za,!1);if(!za)return wa.ULS.sendTraceTag(537170569,0,10,"DdaFacade.GetAddinCommandSandbox: webextension data is null"),null;var tb=null,Wb=this.Mm.getOsfControl(a.getSolutionId(za,
this.$));Wb&&(Wb=Wb.getManifest())&&(tb=Wb.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));return Sa.HelperMethods.oic(tb)&&(za=this.GSe(za.PrimaryMarketplace.SolutionId,za.PrimaryMarketplace.MarketplaceRef,za.PrimaryMarketplace.MarketplaceType,tb))?za.controlId:null};a.prototype.T3g=function(za,tb){var Wb=this,fc=a.Hgd(za,!1);if(fc){var xc=null,Yb=this.Mm.getOsfControl(a.getSolutionId(fc,this.$));Yb&&(Yb=Yb.getManifest())&&(xc=Yb.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));if(Sa.HelperMethods.oic(xc)){fc.SharedRuntime=
xc;var Ec=fc.PrimaryMarketplace.SolutionId;Yb=fc.PrimaryMarketplace.SolutionVersion;var bd=OSF.OsfManifestManager.getCachedManifest(Ec,Yb);if(bd)if(this.FZb.kb(za))xc=this.FZb.na(za),lb.TaskExtensions.Ba(xc,function(ne){(ne=ne.result)&&OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(ne,tb,Wb.Uh.FJb)},this.la,3);else{var Ic={solutionId:Ec,version:Yb};Ic.storeType=fc.PrimaryMarketplace.MarketplaceType;Ic.storeId=fc.PrimaryMarketplace.MarketplaceRef;Ic.assetId=Ec;Ic.assetStoreId=
null;Ic.targetType=OSF.OsfControlTarget.TaskPane;var Md=new qb.a;fc=lb.TaskExtensions.jk();fc=new nb.a(this.$,this,Ic,fc);xc=OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(Ec,xc.Resid);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(bd,xc,Yb);fc.createUILessSandbox(Ic,bd,function(ne,le){ne&&!le?(OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(ne,tb,Wb.Uh.FJb),Md.setResult(ne)):Md.setResult(null);Wb.FZb.remove(za)});this.FZb.ia(za,Md.task)}}}else wa.ULS.sendTraceTag(537170568,
0,10,"DdaFacade.CreateAddinCommandSandboxAsync: webextension data is null")};a.prototype.$we=function(za){(za=this.oSe(za))&&(za.$k.SharedRuntime||this.wHb(za.controlId))};a.prototype.wHb=function(za){(za=this.oSe(za))&&this.UPa(za.controlId)};a.prototype.Hgh=function(za,tb){if(!this.qf||!za||!tb)return!1;if(za.toLowerCase()===tb.toLowerCase())return!0;for(var Wb=null,fc=null,xc=0,Yb=this.qf.length;xc<Yb;xc++){var Ec=this.qf[xc];if(Ec.ownerAddinSolutionId&&(Ec.controlId===za&&(Wb=Ec.ownerAddinSolutionId.toLowerCase()),
Ec.controlId===tb&&(fc=Ec.ownerAddinSolutionId.toLowerCase()),Wb&&fc))break}return Wb&&Wb===fc?!0:!1};a.prototype.PBg=function(za){this.Vm(za.InstanceId)||(za=new G(this,this.Uh,za),this.qf.push(za),this.gxa=null)};a.prototype.DOf=function(za){if(this.qf&&0<=za&&za<this.qf.length){var tb=this.qf[za],Wb=tb.ky;Array.removeAt(this.qf,za);this.ovf(tb);Lb.DOMElementExtensions.gf(Wb)}};a.prototype.UPa=function(za){if(this.qf)for(var tb=0,Wb=this.qf.length;tb<Wb;tb++)if(this.qf[tb].controlId===za){this.DOf(tb);
break}};a.prototype.F$i=function(za){if(this.qf){za=za.toLowerCase();for(var tb=0,Wb=this.qf.length;tb<Wb;tb++)if(za===this.qf[tb].ownerAddinSolutionId.toLowerCase()){this.DOf(tb);break}}};a.prototype.pMg=function(za){za.an&&(this.Vm(za.floatingObject.$k.InstanceId)||(this.ffc(za.floatingObject.$k.InstanceId)||this.Moc.push(za.floatingObject.$k.InstanceId),this.r0a(za.floatingObject.$k)),this.ea.isNamedObjectViewMode&&this.KLg(za.floatingObject.$k.InstanceId,za.Dd))};a.prototype.qaa=function(za){if(this.qf)for(var tb=
0,Wb=this.qf.length;tb<Wb;tb++)if(1===this.qf[tb].controlType&&jc.a.equals(this.qf[tb].kU,za,!0))return this.qf[tb].controlId;return null};a.prototype.fAh=function(za){var tb=[];if(this.qf)for(var Wb=0,fc=this.qf.length;Wb<fc;Wb++)jc.a.equals(this.qf[Wb].kU,za,!0)&&tb.push(this.qf[Wb].controlId);return tb};a.prototype.LAh=function(za,tb){if(!tb||!za)return null;if(this.qf)for(var Wb=0,fc=this.qf.length;Wb<fc;Wb++)if(1===this.qf[Wb].controlType&&jc.a.equals(this.qf[Wb].kU,za,!0)&&this.qf[Wb].$k.SharedRuntime&&
jc.a.equals(this.qf[Wb].$k.SharedRuntime.Resid,tb.Resid,!0))return this.qf[Wb].controlId;return null};a.prototype.X2a=function(za,tb){tb=void 0===tb?null:tb;return za?tb?String.format("{0}.{1}",za,tb):za:""};a.prototype.cxe=function(za,tb,Wb){if(this.gxa===za)return!0;this.gxa=za;var fc=null,xc=!1;if(!fc&&this.qf)for(var Yb=0,Ec=this.qf.length;Yb<Ec;Yb++)if(1===this.qf[Yb].controlType&&jc.a.equals(this.qf[Yb].kU,za,!0)){var bd=!1,Ic=!1;tb?(bd=!0,Ic=!!this.qf[Yb].$k.SharedRuntime&&jc.a.equals(this.qf[Yb].$k.SharedRuntime.Resid,
tb.Resid,!0)):Wb&&(bd=!0,Ic=jc.a.equals(this.qf[Yb].$k.SharedRuntimeId,Wb,!0));if(!bd||Ic){Ic&&this.qf[Yb].$f(!0);fc=this.qf[Yb].controlId;xc=!0;this.gxa=null;break}}fc&&this.raiseEvent("ca",fc);return xc};a.prototype.setAppRuntimeState=function(za,tb){var Wb;if(za){var fc=this.Vm(za);if(fc&&Sa.HelperMethods.iw(fc.$k))fc.$f(tb),tb&&(this.raiseEvent("ca",za),(null===(Wb=fc.ky)||void 0===Wb?0:Wb.firstChild)&&(za=fc.ky.firstChild.title)&&0<za.length&&this.J_b.Omj(za));else throw wa.ULS.sendTraceTag(537170565,
0,50,"SetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(Fa.a.instance.ga(2216));}else throw wa.ULS.sendTraceTag(537170564,0,15,"SetAppRuntimeState: Invalid controlId."),Error.invalidOperation(Fa.a.instance.ga(2217));};a.prototype.getAppRuntimeState=function(za){if(za)if((za=this.Vm(za))&&Sa.HelperMethods.iw(za.$k))za=za.$k.TaskpaneVisible;else throw wa.ULS.sendTraceTag(537170563,0,50,"GetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(Fa.a.instance.ga(2216));
else throw wa.ULS.sendTraceTag(537170562,0,15,"GetAppRuntimeState: Invalid controlId."),Error.invalidOperation(Fa.a.instance.ga(2217));return za};a.prototype.s2a=function(za,tb){return(za=this.Vm(za))?za.s2a(tb):null};a.prototype.z5a=function(za){return this.exe(this.Moc,za)};a.prototype.ffc=function(za){return this.exe(this.NEe,za)};a.prototype.xke=function(za){this.NEe.push(za)};a.prototype.iZ=function(za){return(za=this.Vm(za))?za.$k:null};a.prototype.Axd=function(za){this.raiseEvent("ekros",za,
this)};a.prototype.hBd=function(za){if(za){var tb=this.Vm(za.InstanceId);tb&&(za.SharedRuntime||za.SharedRuntimeId||(this.UPa(tb.controlId),this.ri.purgeOsfControl(tb.controlId,!1)),tb={},tb.SolutionId=za.PrimaryMarketplace.SolutionId,tb.TargetType=za.WebExtensionType,tb.Version=za.PrimaryMarketplace.SolutionVersion,tb.StoreType=za.PrimaryMarketplace.MarketplaceType,tb.StoreId=za.PrimaryMarketplace.MarketplaceRef,tb.AssetId=za.PrimaryMarketplace.SolutionId,tb.AssetStoreId=za.PrimaryMarketplace.MarketplaceRef,
tb.Width=za.TaskpaneWidth,tb.SharedRuntimeId=za.SharedRuntimeId,this.h$f(tb))}};a.prototype.sia=function(){this.Uh.sia()};a.prototype.uM=function(za,tb,Wb){this.Uh.uM(za,tb,Wb)};a.prototype.Xmj=function(za,tb){var Wb=Array(2);Wb[0]=tb;Wb[1]=null;this.Uh.$Ah(za,JSON.stringify(Wb))};a.prototype.RSe=function(za,tb){tb=a.e9g(tb);za=this.iZ(za);this.Uh.E9b(za.InstanceId,2202,Pc.a.OW,tb)};a.prototype.W$c=function(za){for(var tb=0,Wb=this.qf.length;tb<Wb;tb++)this.RSe(this.qf[tb].controlId,za)};a.prototype.WAh=
function(za,tb){tb=a.y4g(tb);this.Uh.E9b(za,65539,"",tb)};a.prototype.YAh=function(za,tb,Wb){this.Uh.E9b(za,1,tb,Wb)};a.prototype.VAh=function(za,tb){this.Uh.ZAh(za,tb)};a.prototype.Q3g=function(za,tb){return[[2,1E3,"",JSON.stringify([za,tb]),0,!1]]};a.prototype.Fei=function(){return!!this.Uma&&this.Uma.G5e()};a.prototype.HXg=function(){this.Uma&&this.Uma.clear()};a.prototype.XAh=function(){if(this.Uma&&this.Uma.G5e()){var za=this.Uma.nHh();za=ak(za);for(var tb=za.next();!tb.done;tb=za.next()){tb=
this.fAh(tb.value);tb=ak(tb);for(var Wb=tb.next();!Wb.done;Wb=tb.next())this.Uh.E9b(Wb.value,65540,"","{}")}}};a.prototype.z7i=function(za){this.Uma.add(za)};a.prototype.QOj=function(za){this.Uma.remove(za)};a.prototype.Mia=function(za){if(!this.qf)return null;for(var tb=ak(this.qf),Wb=tb.next();!Wb.done;Wb=tb.next())if(Wb=Wb.value,za(Wb))return Wb;return null};a.prototype.ECe=function(za){var tb=this,Wb=new qb.a,fc=a.Gua(za,this.$);if(Sa.HelperMethods.iw(za))wa.ULS.sendTraceTag(537170531,0,50,"Shared runtime custom function agave is started."),
this.MFf(za,function(Yb){Yb?(za.InstanceId=Yb.InstanceId,za.WebExtensionOsfControlType=3,za.TaskpaneVisible=!1,tb.r0a(za),Wb.setResult(za.InstanceId)):(wa.ULS.sendTraceTag(537170530,0,10,"InsertAgaveTaskPane for customfunction: {0} failed",Telemetry.PrivacyRules.GetPrivacyCompliantId(za.PrimaryMarketplace.SolutionId,za.PrimaryMarketplace.MarketplaceType,null,null,null,za.PrimaryMarketplace.MarketplaceRef)),Wb.setException(Error.create("Null insert data")))});else{a.L0a.ia(za.InstanceId,new W.a);var xc=
a.L0a.na(za.InstanceId).c1a;this.v5g(za,xc,fc);this.MFf(za,null);Wb.setResult(za.InstanceId)}return Wb.task};a.prototype.v5g=function(za,tb,Wb){this.Vm(za.InstanceId)||(za=new G(this,this.Uh,za),za.RHa=Wb,za.t9e(tb),this.qf.push(za),this.gxa=null)};a.prototype.MFf=function(za,tb){var Wb=a.Gua(za,this.$);if(!this.MCd.contains(Wb))this.EFb.push(za),1<=this.EFb.length&&this.NFf(za,tb);else if(tb){za=ak(this.PFf);for(var fc=za.next();!fc.done;fc=za.next())if(fc=fc.value,a.Gua(fc,this.$)===Wb){tb(fc,0);
break}}};a.prototype.NFf=function(za,tb){function Wb(ne){ne&&!Qe.a(ne)||wa.ULS.sendTraceTag(537170527,0,10,"InsertAgaveTaskPane for addin {0} finish with errors: {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Ec.SolutionId,Ec.StoreType,Ec.AssetId,null,null,Ec.StoreId),Re.a.Dc(ne.Errors));xc.EFb.shift();0<xc.EFb.length&&xc.NFf(xc.EFb[0],tb)}function fc(ne){ne=ud.a.Of(ne.data);wa.ULS.sendTraceTag(537170528,0,10,"DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: {0}",
Re.a.Dc(ne))}var xc=this,Yb=null,Ec={};Ec.SolutionId=a.getSolutionId(za,this.$);Ec.TargetType=za.WebExtensionType;Ec.Version=za.PrimaryMarketplace.SolutionVersion;Ec.StoreType=za.PrimaryMarketplace.MarketplaceType;Ec.StoreId=za.PrimaryMarketplace.MarketplaceRef;Ec.AssetId=za.PrimaryMarketplace.SolutionId;Ec.AssetStoreId=za.PrimaryMarketplace.MarketplaceRef;Ec.Width=za.TaskpaneWidth;Ec.ContainsCustomFunctions=!0;Sa.HelperMethods.iw(za)&&(Ec.SharedRuntimeId=za.SharedRuntime.Resid);var bd=this.$.oa.xa;
za=this.$.oa.xa.Pb();var Ic=bd.Na(9,za);Ic.sharedInfo=Ec;if(tb){var Md=function(ne){var le=ne.Result;(Yb=le?le.AgaveData:null)||tb(null,ne.Errors?ne.Errors[0].ErrorCause:5001);tb(Yb,0)};za=function(ne,le,Ke){return Hc.g(bd,"InsertAgaveTaskpane",Ic,Qb.b(ne,Wb,Md),Qb.a(le,fc),Ke,null,0)}}else za=function(ne,le,Ke){return Hc.g(bd,"InsertAgaveTaskpane",Ic,Qb.b(ne,Wb),Qb.a(le,fc),Ke,null,0)};pa.EwaSettings.Zb()?pe.a(this.$.userOperationManager,za,function(ne){return new fe.a(519,0,ne,64)},null):pe.a(this.$.userOperationManager,
za,function(ne){return new Ye.a(519,0,ne)},null)};a.prototype.qwj=function(){return this.$.Lf.get(35)};a.prototype.aId=function(za){za=this.Vm(za);(null===za||void 0===za?0:za.tda)&&za.NOf()};a.prototype.SDi=function(za){var tb=this.Mia(function(Wb){return a.JLa(Wb.kU)});tb&&(tb=this.ri.getOsfControl(tb.controlId))&&tb.notifyAgave(OSF.AgaveHostAction.SendMessage,za)};a.prototype.sfi=function(){return!!this.Mia(function(za){return 1===za.controlType&&a.JLa(za.kU)})};a.prototype.rfi=function(){var za=
this.Mia(function(tb){return a.JLa(tb.kU)});return za?za.ky?Lb.DOMElementExtensions.isVisible(za.ky):!1:!1};a.prototype.Ypj=function(){var za=this.Mia(function(tb){return a.JLa(tb.kU)});za&&(za.$f(!0),this.raiseEvent("ca",za.controlId))};a.prototype.initialize=function(){var za=b(1566).DdaEventDispatch,tb=void 0===this.$||null===this.$||pa.EwaSettings.ma(260);void 0!==this.$&&null!==this.$||wa.ULS.sendTraceTag(537170525,0,50,"VSO#2693929: Initialize is called. EwaControl is null");tb&&wa.ULS.sendTraceTag(537170524,
0,50,"VSO#2693929: Initialize is called. this.initialized is "+this.initialized);this.initialized||(e.fGa(this.$),this.ea=this.$.ea,this.Uh=new za(this.$),this.$.Tk(this.Yc),this.ea.Wj(this.Uc),this.ea.TL(this.uo),this.ea.Bu(this.Sf),this.$.userOperationManager.Cr(this.rR),this.kkf(),this.fOi(),this.w$h(),this.$.da.Ga(35,this),this.AVc.ka(this),tb&&wa.ULS.sendTraceTag(537170522,0,50,"VSO#2693929: SessionIdChanged event is registered"),this.qee=new Pc.a,tb&&wa.ULS.sendTraceTag(537170521,0,50,"VSO#2693929: RichApiEventRegistration is constructed"),
this.uee=new v(this.$,this.Vi,this.Uh),this.Wug=new z(this.$,this.Vi,this.Uh),this.ree=new y(this.$,this.Vi,this.Uh),this.pee=new B(this.$,this.Vi,this.Uh),this.oee=new x(this.$,this.Vi,this.Uh),this.see=new A(this.$,this.Vi,this.Uh),this.vee=new n(this.$,this.Vi,this.Uh),this.wee=new w(this.$,this.Vi,this.Uh),this.$.Aba&&(this.xee=new f(this.$,this.Vi,this.Uh)),pa.EwaSettings.ma(191)&&(this.R0a=new J(this,Da.g(this.$))),pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled")&&
(this.nee=new C),this.initialized=!0,wa.ULS.sendTraceTag(537170520,0,50,"DdaFacade is initialized"))};a.prototype.RAh=function(za){if(!this.QBa)return null;for(var tb=0,Wb=this.QBa.length;tb<Wb;tb++)if(za.startsWith(this.QBa[tb].WebExtensionId))return this.QBa[tb];return null};a.prototype.kkf=function(){var za,tb=this.ea;if(tb.dc&&!this.YOb){if(tb.workbookContext){if(this.zSc=this.$.ea.Kg.get(22),null===(za=tb.workbookContext.WebExtensions)||void 0===za?0:za.length){za=tb.workbookContext.WebExtensions;
tb=!1;for(var Wb={},fc=za.length-1;0<=fc;Wb={qPb:Wb.qPb},fc--){if(!this.ea.isNamedObjectViewMode){this.Moc.push(za[fc].InstanceId);if(1!==za[fc].WebExtensionType){Array.removeAt(za,fc);continue}if(Sa.HelperMethods.iw(za[fc])&&0!==za[fc].SharedRuntime.State)1===za[fc].SharedRuntime.State?za[fc].TaskpaneVisible=!1:2===za[fc].SharedRuntime.State?za[fc].TaskpaneVisible=!0:wa.ULS.sendTraceTag(537170519,0,10,"The sharedRuntime state is invalid");else if(!za[fc].ContainsCustomFunctions&&!za[fc].TaskpaneVisible&&
!ac.a(za[fc])){Array.removeAt(za,fc);continue}}var xc=OSF.OsfControl.isFirstPartyStoreString(za[fc].PrimaryMarketplace.MarketplaceType);pa.EwaSettings.ma(187)&&!xc&&(Array.removeAt(za,fc),tb||(tb=!0,Wb.qPb=Aa.GetServiceTaskFactory.Ra(this.$.da,5,4,3),lb.TaskExtensions.Ba(Wb.qPb,function(Yb){return function(){Yb.qPb.result.Jf(35,null)}}(Wb),this.la,3)));pa.EwaSettings.isChangeGateEnabled("OfficeVSO:3937070_RemoveChartTaskPaneExtensionDuringLoad")&&za[fc].PrimaryMarketplace&&a.JLa(za[fc].PrimaryMarketplace.SolutionId)&&
(wa.ULS.sendTraceTag(537170518,0,50,"chart task pane info stored in workbook context webextensions"),Array.removeAt(za,fc))}this.aCe(za)}}else this.zSc=!1;this.YOb=!0}};a.prototype.f4e=function(za){var tb=Da.g(this.$),Wb=tb.ha.Oa.Yb;if(Wb&&za){za=!1;if(this.qf)for(var fc=ak(this.qf),xc=fc.next();!xc.done;xc=fc.next())if(xc=xc.value,a.JLa(xc.kU)||a.zii(xc.kU)){za=!0;break}za||tb.ha.Oa.PG(Wb)}};a.prototype.fOi=function(){this.ri&&this.ea.isNamedObjectViewMode&&this.$.pa&&Ee.o(this.$.pa)&&(this.$.da.za(34).PQ?
this.$.da.za(34).Qkd():this.$.da.za(34).Ft(this.$Ti))};a.prototype.aCe=function(za){var tb=this,Wb=null;Wb=function(Yb){function Ec(){tb.XOa.shift();0<tb.XOa.length&&Wb(tb.XOa[0])}var bd=Yb.WebExtensionData,Ic=Yb.IsTaskPane,Md=Yb.RecordHandler;if(tb.qaa(bd.PrimaryMarketplace.SolutionId))Ec();else{Ic&&(bd.WebExtensionOsfControlType=1);var ne=ac.a(bd);if(!Ic||bd.TaskpaneVisible||ne||bd.SharedRuntime&&0!==bd.SharedRuntime.State||bd.ContainsCustomFunctions){var le=new G(tb,tb.Uh,bd,!Ic);wa.ULS.sendTraceTag(537170517,
0,50,"DdaFacade::CreateAllOsfControls: SolutionId: {0}, StoreType: {1}, UseShareRuntime: {2}",Telemetry.PrivacyRules.GetPrivacyCompliantId(bd.PrimaryMarketplace.SolutionId,bd.PrimaryMarketplace.MarketplaceType,null,null,null,bd.PrimaryMarketplace.MarketplaceRef),bd.PrimaryMarketplace.MarketplaceType,Sa.HelperMethods.iw(bd));le.Dkd();Sa.HelperMethods.iw(bd)&&(le.RHa=a.Gua(bd,tb.$),bd.TaskpaneWidth=tb.M5b);ne&&(bd.WebExtensionToolTip="");Ic&&bd.TaskpaneVisible&&!ne&&(bd.TaskpaneWidth=tb.M5b);tb.qf.push(le);
var Ke=tb.gxa=null;Ke=Gd.a.instance.sE(function(){le.ky&&(Kb.a.Ia(Ke),Ke=null,Md&&Md(Yb,le),Ec())},100,jd.a.Bbh)}else Ec()}};for(var fc={},xc=0;xc<za.length;fc={a1:fc.a1},xc++)if(!this.Vm(za[xc].InstanceId))if(1!==za[xc].WebExtensionType)this.r0a(za[xc]);else if(!pa.EwaSettings.ma(54))this.mmb(za[xc],Wb);else if(this.$.Bd&8388608||za[xc].TaskpaneVisible)fc.a1={},fc.a1.marketplaceId=za[xc].PrimaryMarketplace.SolutionId,fc.a1.marketplaceVersion=za[xc].PrimaryMarketplace.SolutionVersion,fc.a1.storeType=
za[xc].PrimaryMarketplace.MarketplaceType,fc.a1.storeId=za[xc].PrimaryMarketplace.MarketplaceRef,fc.a1.targetData=za[xc],this.ri.isAddinCommandsAsync(fc.a1,function(Yb){return function(Ec,bd,Ic){if(Ec){var Md=Ic.targetData;if(bd){if(pa.EwaSettings.ma(88))if(Yb.a1.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())Ec=Yb.a1.storeType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog.toLowerCase(),bd=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForPrivateCatalog")&&
Yb.a1.storeType.toLowerCase()===OSF.StoreType.PrivateCatalog.toLowerCase(),(Ec||bd)&&Sa.HelperMethods.iw(Md)&&tb.mmb(Md,Wb);else if(pa.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForUploadFileCatalog"))tb.V2h(Ic,Wb);else{var ne=!1;tb.Pca(function(le){if(!le.errorCode){if(le.value){le=ak(le.value);for(var Ke=le.next();!Ke.done&&!ne;Ke=le.next())ne=id.e(Ke.value[1])===id.e(Md.PrimaryMarketplace.SolutionId)}ne?Sa.HelperMethods.iw(Md)&&tb.mmb(Md,Wb):(le={},le.SolutionId=
Ic.marketplaceId,le.TargetType=Md.WebExtensionType,le.Version=Ic.marketplaceVersion,le.StoreType=Md.PrimaryMarketplace.MarketplaceType,le.StoreId=Ic.storeId,le.AssetId=Ic.marketplaceId,le.AssetStoreId=Ic.storeId,le.Width=Md.TaskpaneWidth,Md.TaskpaneVisible=!0,tb.jje(le,Md,Wb))}},!0)}}else tb.mmb(Md,Wb)}else Ec=Ic.targetData,wa.ULS.sendTraceTag(542185164,220,15,"Judging AddinCommands failed for {0} from {1} during document loading",Telemetry.PrivacyRules.GetPrivacyCompliantId(Ec.PrimaryMarketplace.SolutionId,
Ec.PrimaryMarketplace.MarketplaceType,null,null,null,Ec.PrimaryMarketplace.MarketplaceRef),Ec.PrimaryMarketplace.MarketplaceType)}}(fc))};a.prototype.V2h=function(za,tb){var Wb=this,fc=!1;this.Pca(function(xc){var Yb=za.targetData;if(!xc.errorCode){if(xc.value){xc=ak(xc.value);for(var Ec=xc.next();!Ec.done&&!fc;Ec=xc.next())fc=id.e(Ec.value[1])===id.e(Yb.PrimaryMarketplace.SolutionId)}fc?Sa.HelperMethods.iw(Yb)&&Wb.mmb(Yb,tb):(xc={},xc.SolutionId=za.marketplaceId,xc.TargetType=Yb.WebExtensionType,
xc.Version=za.marketplaceVersion,xc.StoreType=Yb.PrimaryMarketplace.MarketplaceType,xc.StoreId=za.storeId,xc.AssetId=za.marketplaceId,xc.AssetStoreId=za.storeId,xc.Width=Yb.TaskpaneWidth,Yb.TaskpaneVisible=!0,Wb.jje(xc,Yb,tb))}},!0)};a.prototype.mmb=function(za,tb){var Wb={};Wb.WebExtensionData=za;Wb.IsTaskPane=!0;this.XOa.push(Wb);1===this.XOa.length&&tb(Wb)};a.prototype.jje=function(za,tb,Wb){var fc=this,xc={};xc.ActivationInfo=za;xc.WebExtensionData=tb;xc.IsTaskPane=!1;xc.RecordHandler=function(Yb,
Ec){var bd=Yb.ActivationInfo;fc.ri.insertBlankControlWithErrorUX(fc.dGb(Ec,bd),function(){fc.UPa(Ec.controlId);fc.ri.purgeOsfControl(Ec.controlId,!1);fc.h$f(bd)})};this.XOa.push(xc);1===this.XOa.length&&Wb(xc)};a.prototype.h$f=function(za){var tb={};tb.solutionId=za.SolutionId;tb.version=za.Version;tb.storeType=za.StoreType;tb.storeId=za.StoreId;tb.assetId=za.AssetId;tb.assetStoreId=za.AssetStoreId;tb.targetType=za.TargetType;tb.sharedRuntimeId=za.SharedRuntimeId;za=new dc.a;za.add(tb);tb={};tb[Ia.a.lnb]=
za;tb[Ia.a.yT]=3;za=new mc.a(td.a.fBb,0,this.$.Jc,0,null);this.$.Ka.Kb(za,tb)};a.prototype.dGb=function(za,tb){var Wb={};Wb.div=za.ky;Wb.id=za.controlId;Wb.solutionId=tb.SolutionId;Wb.version=tb.Version;Wb.storeId=tb.StoreId;Wb.storeType=tb.StoreType;Wb.osfControlType=OSF.OsfControlTarget.TaskPane;return Wb};a.prototype.xSf=function(){var za=this;if(pa.EwaSettings.isChangeGateEnabled("OfficeVSO:3935411_RemoveOsfControlsAferSilentReload")){for(var tb=[],Wb=0;Wb<this.qf.length;Wb++){var fc=this.qf[Wb];
0!==fc.osfControlType&&3!==fc.osfControlType&&4!==fc.osfControlType||tb.push(fc)}Wb=!1;for(fc=0;fc<tb.length;fc++){var xc=tb[fc];this.UPa(xc.controlId);!Wb&&xc&&xc.$k&&(Wb=Sa.HelperMethods.iw(xc.$k))}Wb&&(tb={},tb=(tb.DynamicAddinCommandsMethodDispatchId=4,tb),this.UJ(-1014260128,tb))}pa.EwaSettings.ma(402)&&lb.TaskExtensions.Ba(Aa.GetServiceTaskFactory.Ra(this.$.da,278,279,3),function(Yb){Yb&&(Yb=Yb.result)&&(za.$.da.za(278)||za.$.da.Ga(278,Yb),Yb.z$e().Xma())},this.la,3)};a.prototype.JK=function(){var za=
this,tb=new l(this.$,this.Vi,this.xTf);void 0===this.$||null===this.$?wa.ULS.sendTraceTag(537170514,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):pa.EwaSettings.ma(260)&&wa.ULS.sendTraceTag(537170513,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+(void 0===this.Vi||null===this.Vi));if(tb.DCi()){var Wb=function(){},fc=function(Ec){Ec=ud.a.Of(Ec.data);wa.ULS.sendTraceTag(537170511,0,10,"ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: {0}.",
Re.a.Dc(Ec))},xc=tb.fRg();tb=function(Ec,bd,Ic){return Hc.g(za.$.oa.xa,"ExecuteRichApiRequest",za.gRg(xc),Qb.b(Ec,Wb),Qb.a(bd,fc),Ic,null,0)};var Yb=a.Oed(xc);pa.EwaSettings.Zb()?this.$.userOperationManager.St(new fe.a(507,0,tb,Yb|64)):this.$.userOperationManager.St(new Ye.a(507,0,tb,Yb))}};a.prototype.gRg=function(za){var tb=this.$.oa.xa.Na(1);tb.request=za;return tb};a.prototype.exe=function(za,tb){if(za)for(var Wb=0;Wb<za.length;Wb++)if(jc.a.equals(za[Wb],tb,!0))return!0;return!1};a.prototype.jQg=
function(za){var tb={};tb.navigationMode=OSF.OsfNavigationMode.DefaultMode;tb.assetId=null;tb.category=null;if(!za||3>za.length)return tb;if(za[0]){var Wb=parseInt(za[0],10);isNaN(parseInt(Wb,10))||(tb.navigationMode=Wb)}za[1]&&(tb.assetId=za[1]);za[2]&&(tb.category=za[2]);return tb};a.prototype.w$h=function(){if(pa.EwaSettings.ma(62)){var za=this.$.workbookContext.FullDocumentInfo.EmbeddingPageOrigin;if(za&&"*"!==za.trim()){this.yIa=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new U(this),
za,this.$.workbookContext.FullDocumentInfo.EmbeddingPageSessionInfo,this.$.Lf.get(2));try{this.yIa.init()}catch(tb){try{this.yIa.dispose()}catch(Wb){}this.yIa=null;wa.ULS.sendTraceTag(537170510,0,10,"EmbeddingEnpoint failed to initialize. Error message: "+tb.message)}za={};za.a=this.$.ya.UserSessionId;Xb.b().De(39,za)}}};a.prototype.i2f=function(za,tb,Wb){var fc=this,xc=a.wPg(za[0]),Yb=xc.qha,Ec=xc.hia;xc.qha=function(){Yb&&Yb();var bd=xc.mLa!==OSF.InfoType.Error?tb:null;za.shift();za.length?fc.i2f(za,
bd,Wb):bd&&bd()};xc.hia=function(){Ec&&Ec();Wb&&xc.mLa!==OSF.InfoType.Error&&Wb()};La.a.UQd(xc)};a.prototype.NPh=function(){var za={};za.AddinRibbonControlsOverriddenByApi=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:4373039_AddinRibbonControlsOverriddenByApi").toString();za.AddinActionDefinitionHybridMode=pa.EwaSettings.ma(644).toString();za.UseActionIdForUILessCommand=pa.EwaSettings.ma(647).toString();za.AllowStorageAccessByUserActivationOnIFrame=pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AllowStorageAccessByUserActivationOnIFrame",
!1).toString();za.RequirementSetRibbonApiOnePointTwo=pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.RequirementSetRibbonApiOnePointTwo",!1).toString();za.flightingTreatmentVariables=ta.AFrameworkApplication.fa.O9b;za.ShortcutInfoArrayInUserPreferenceData=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5232658_ShortcutInfoArrayInUserPreferenceData").toString();return za};a.getSolutionId=function(za){var tb=za.PrimaryMarketplace.SolutionId;pa.EwaSettings.ma(294)&&za.OwnerAddinSolutionId&&
(tb=za.OwnerAddinSolutionId);return tb};a.Oed=function(za){var tb=0;pa.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?za.RequestFlags&1&&256!==(za.RequestFlags&256)||(tb=16):tb=za.RequestFlags&1?0:16;return tb};a.Gua=function(za,tb){tb=a.getSolutionId(za,tb);return a.BXe(tb,za.PrimaryMarketplace.SolutionVersion,za.PrimaryMarketplace.MarketplaceType,za.PrimaryMarketplace.MarketplaceRef)};a.e9g=function(za){var tb={};za=(tb.recording=za,tb);return JSON.stringify(za)};
a.y4g=function(za){var tb={};tb.visibility=za?"Visible":"Hidden";return JSON.stringify(tb)};a.ULh=function(za){var tb=za.getSolutionId(),Wb=za.getVersion(),fc=za.getStoreType();za=za.getStoreId();return a.BXe(tb,Wb,fc,za)};a.BXe=function(za,tb,Wb,fc){return String.format("{0}|{1}|{2}|{3}|{4}|||","2",za,tb,a.QXh(Wb).toString(),fc)};a.Hgd=function(za,tb){var Wb=za.split("|");if(7>Wb.length)return wa.ULS.sendTraceTag(537170509,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected customFunctionAddinId."),
null;if("2"!==Wb[0])return wa.ULS.sendTraceTag(537170508,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected format='{0}'.",Wb[0]),null;var fc=Wb[1],xc=Wb[2],Yb=a.RXh(Wb[3]),Ec=Wb[4];Wb=Wb[5];fc&&fc.length||(fc=Wb);Wb={};Wb.InstanceId=String.format("{{{0}}}",ba.a.create().toString());Wb.WebExtensionOsfControlType=4;Wb.WebExtensionType=1;Wb.PrimaryMarketplace={};Wb.PrimaryMarketplace.SolutionId=fc;Wb.PrimaryMarketplace.SolutionVersion=xc;Wb.PrimaryMarketplace.MarketplaceRef=Ec;Wb.PrimaryMarketplace.MarketplaceType=
Yb;Wb.ContainsCustomFunctions=tb?!0:!1;tb&&(Wb.OsfPropertyBag=[["customFunctionAddinId",za]]);return Wb};a.RXh=function(za){za=parseInt(za,10);return za===OSF.StoreTypeEnum.MarketPlace?OSF.StoreType.OMEX:za===OSF.StoreTypeEnum.Catalog?OSF.StoreType.SPCatalog:za===OSF.StoreTypeEnum.SPApp?OSF.StoreType.SPApp:za===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:za===OSF.StoreTypeEnum.FileSystem?OSF.StoreType.FileSystem:za===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:za===OSF.StoreTypeEnum.PrivateCatalog?
OSF.StoreType.PrivateCatalog:za===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:za===OSF.StoreTypeEnum.FirstParty?OSF.StoreType.FirstParty:za===OSF.StoreTypeEnum.UploadFileDevCatalog?OSF.StoreType.UploadFileDevCatalog:za===OSF.StoreTypeEnum.WopiCatalog?OSF.StoreType.WopiCatalog:null};a.QXh=function(za){return za===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:za===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:za===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:za===OSF.StoreType.Exchange?
OSF.StoreTypeEnum.Exchange:za===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:za===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:za===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:za===OSF.StoreType.HardCodedPreinstall?OSF.StoreTypeEnum.HardCodedPreinstall:za===OSF.StoreType.FirstParty?OSF.StoreTypeEnum.FirstParty:za===OSF.StoreType.UploadFileDevCatalog?OSF.StoreTypeEnum.UploadFileDevCatalog:za===OSF.StoreType.WopiCatalog?OSF.StoreTypeEnum.WopiCatalog:-1};a.krb=function(za){var tb=
{};tb.Version=za.version;tb.AssetId=za.assetId;tb.AssetStoreId=null!==za.assetStoreId?za.assetStoreId.toString():null;tb.StoreType=za.storeType;tb.Height=za.height;tb.SolutionId=za.solutionId;tb.StoreId=za.storeId;tb.TargetType=za.targetType;tb.Width=1===tb.TargetType?0:za.width;tb.SharedRuntimeId=za.sharedRuntimeId;return tb};a.Gyb=function(za){return za===OSF.DDA.EventDispId.dispidSettingsChangedEvent||za===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||za===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||
za===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||za===OSF.DDA.EventDispId.dispidRichApiMessageEvent||za===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||za===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||za===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent};a.wPg=function(za){return Object(ia.a)(new Vc.a,{mLa:za.infoType,id:za.id,title:za.title,description:za.description,buttonText:za.buttonTxt,qha:za.buttonCallback,Kdc:za.highPriority,hia:za.dismissCallback,
errorCode:za.errorCode,z8e:za.iframeNotificationUrl})};a.JLa=function(za){var tb="FA000000014"===za;tb||(tb="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1"===za);return tb};a.zii=function(za){return"FA000000005"===za};Af.Object.defineProperties(a.prototype,{J_b:{configurable:!0,enumerable:!0,get:function(){return this.Qea||(this.Qea=new fb.a(this.$.Rv))}},ri:{configurable:!0,enumerable:!0,get:function(){if(!this.Mm){var za={},tb=!(this.$.Bd&1),Wb=Zb.a.current.IN,fc=this.$.workbookContext,xc=Ma.a.dL+
Ma.a.T2b,Yb=0;pa.EwaSettings.ma(488)&&(Yb|=2);za.pageBaseUrl=Wb.LayoutsContentUrlPrefix;za.appName=OSF.AppName.ExcelWebApp;za.appVersion="16";za.appSettings=this.NPh();za.singleSignOnSettings=ya.AppsForOfficeSingleSignOnManager.uXh();za.clientMode=tb?OSF.ClientMode.ReadOnly:OSF.ClientMode.ReadWrite;za.appUILocale=this.$.ya.UICultureTag;za.dataLocale=this.$.ya.DataCultureTag;za.docUrl=fc.ClientUrl;za.hostControl=this;za.formFactor=OSF.FormFactor.Default;za.lcid=this.$.eG.toString();za.localizedScriptsUrl=
Ma.a.dL+Ma.a.p1c;za.localizedImagesUrl=xc;za.localizedStylesUrl=Ma.a.dL+Ma.a.bAe;za.localizedResourcesUrl=xc;za.osfOmexBaseUrl=Wb.OsfOmexBaseUrl;za.firstPartyManifestCDNUrl=Wb.FirstPartyAddInManifestCDN;za.sdxAssetsToPrefetchMapping=ta.AFrameworkApplication.fa.Wa("SdxAssetsToPrefetchMapping");za.sdxCdnUrl=Wb.SdxCdnUrl;za.sdxDmsUrl=Wb.SdxDmsUrl;za.devCatalogUrl=Wb.DevCatalogUrl;za.controlStatusChanged=this.Gnc;za.notifyHost=this.Ezf;za.allowExternalMarketplace=this.$.ea.Kg.get(27)&&a.X1c;za.enableAddinCommands=
pa.EwaSettings.ma(54);za.enableBlackForestRedirect=pa.EwaSettings.ma(89);za.enableMyOrg=this.$.ea.Kg.get(33);za.enableMyApps=this.$.ea.Kg.get(34);za.enableDevCatalog=pa.EwaSettings.ma(45);za.enablePrivateCatalog=this.qwj();za.enableTaskpaneUpgradeToAppCommand=pa.EwaSettings.ma(94);za.showSignOutFromPrivateCatalogMessage=this.$.ea.Kg.get(36);za.enableUploadFileDevCatalog=pa.EwaSettings.ma(54)&&!pa.EwaSettings.ma(283);za.userNameHashCode=na.a.Nv(ta.AFrameworkApplication.userName);za.envCode=this.$.ya.OfficeAddinTelemetryDataSourceCode.toString();
za.enableSingleSignOnForAddin=!pa.EwaSettings.ma(24)&&ta.AFrameworkApplication.isAppsForOfficeSingleSignOnSupportedOnHost;za.enableDisplayBlockedMinorError=pa.EwaSettings.ma(184);za.hideAppsExtensionUrl=ta.AFrameworkApplication.hideAppsExtensionUrl;za.enableAnonymousUseLegacyCatalogService=pa.EwaSettings.ma(174);za.enableInsertDialogAccessibilityFix=pa.EwaSettings.ma(181);za.disableAppsForOfficeThirdParty=pa.EwaSettings.ma(187);za.enableFirstPartySSO=pa.EwaSettings.ma(199);za.wacSessionId=this.$.ya.UserSessionId;
za.disableLogging=!this.$.ya.AriaLoggingIsEnabled;za.enableFirstPartySDXErrorMessages=pa.EwaSettings.ma(212);za.enableRichApiCellEditDelay=pa.EwaSettings.ma(191);za.isHostDocumentDomain=pa.EwaSettings.ma(227);za.loggableUserId=ta.AFrameworkApplication.fa.Wa("LoggableUserId");za.sessionStartInfoJson=ta.AFrameworkApplication.fa.Wa("SessionStartInfoJson");za.wopiHostOriginFromPostMessage=ta.AFrameworkApplication.wopiHostOriginFromPostMessage;za.wopiHostOriginFromWacPropBag=ta.AFrameworkApplication.fa.Wa("PostMessageOrigin");
za.wacIsEmbedded=ta.AFrameworkApplication.fa.ra("IsEmbedded");za.accessibilityAllowFocusAddinTaskpane=ta.AFrameworkApplication.fa.ra("AccessibilityAllowFocusAddinTaskpane");za.enableRemoveAppCommandsAddin=ta.AFrameworkApplication.fa.ra("RemoveAppCommandsAddinIsEnabled");za.isHostFrameTrustCheckEnabledForAddIns=ta.AFrameworkApplication.fa.ra("HostFrameTrustCheckIsEnabledForAddIns");za.isHostFrameTrusted=ta.AFrameworkApplication.isHostFrameTrusted;za.agaveAddinUploadEnabled=pa.EwaSettings.ma(47);za.hostAllowedOfficeStore=
ta.AFrameworkApplication.fa.ra("HostAllowedOfficeStore");za.hostAllowedSdxEmbedding=ta.AFrameworkApplication.fa.ra("HostAllowedSdxEmbedding");za.hostInstallAddIns=ta.AFrameworkApplication.fa.Wa("HostInstallAddIns");za.hostInstallAddInsIsEnabled=ta.AFrameworkApplication.fa.ra("HostInstallAddInsIsEnabled");za.approvedAddIns=ta.AFrameworkApplication.fa.Wa("ApprovedAddIns");za.addinEnforceHttpsIsEnabled=this.Avj(za.sessionStartInfoJson);za.hostFeatureGateFlag=Yb;za.isUpnCheckEnabled=ta.AFrameworkApplication.fa.ra("IsUpnCheckEnabled");
za.wacUpn=ta.AFrameworkApplication.fa.Wa("UserPrincipalName");za.isReactRibbonEnabled=kb.a.isReactRibbonEnabled();za.enableSetFocusOnTaskpaneOnUserAction=pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);za.isSafariWithIndexedDBDisabled=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&Na.a.rMa;za.isIndexedDBDisabled=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&Na.a.rMa||pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5735286_IDBBuggedInFirefox")&&
Na.a.xf;za.enableCustomShortcuts=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5325526_EnableCustomShortcuts");za.changeGetModifierKeyStringOutputOrder=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5426302_ChangeGetModifierKeyStringOutputOrder");za.officeJsUrl=ta.AFrameworkApplication.QK("OfficeJs/excel.js",5);za.enableOfficeJsUrlParam=pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableOfficeJsUrlParam",!1);this.Mm=new OSF.ContextActivationManager(za);za={};this.Mm.setIframeAttributeBag((za.frameborder=
0,za.marginheight=0,za.marginwidth=0,za));this.Mm.setWSA(ta.AFrameworkApplication.Jm);this.Mm&&"undefined"!==typeof this.Mm.hostCheckReadyHandler&&ta.AFrameworkApplication.gFg(Object(S.a)(this.Mm,this.Mm.hostCheckReadyHandler,"hostCheckReadyHandler"));try{var Ec=Hb.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.Mm.setOAuthManager(Ec)}catch(bd){}}return this.Mm}},SWj:{configurable:!0,enumerable:!0,get:function(){return this.zSc}},Vi:{configurable:!0,enumerable:!0,get:function(){return this.qee}},
Uma:{configurable:!0,enumerable:!0,get:function(){return this.nee}},iLd:{configurable:!0,enumerable:!0,get:function(){return this.ree}},hLd:{configurable:!0,enumerable:!0,get:function(){return this.pee}},aij:{configurable:!0,enumerable:!0,get:function(){return this.uee}},Zhj:{configurable:!0,enumerable:!0,get:function(){return this.oee}},$hj:{configurable:!0,enumerable:!0,get:function(){return this.see}},bij:{configurable:!0,enumerable:!0,get:function(){return this.vee}},cij:{configurable:!0,enumerable:!0,
get:function(){return this.wee}},jLd:{configurable:!0,enumerable:!0,get:function(){return this.xee}},oV:{configurable:!0,enumerable:!0,get:function(){return this.kqg}},$:{configurable:!0,enumerable:!0,get:function(){return this.jb}}});Af.Object.defineProperties(a,{X1c:{configurable:!0,enumerable:!0,get:function(){return a.k3d},set:function(za){a.k3d=za}}});a.L0a=new sa.a;a.k3d=!0;Object(ha.a)(a,"DdaFacade",bb.a,[479,916,834,917,918,10])},949:function(u,D,b){function a(){this.wHd=0;this.xW={};this.Psa=
{}}b.d(D,"a",function(){return a});u=b(0);var c=b(15),d=b(113);a.prototype.fTh=function(e,k){return this.xW[a.nYc(e,k)]};a.prototype.mKe=function(e,k){k||void 0!==this.Psa[e]&&null!==this.Psa[e]?k&&void 0!==this.Psa[e]&&null!==this.Psa[e]&&delete this.Psa[e]:this.Psa[e]=1};a.prototype.A_b=function(e){return void 0===this.Psa[e]||null===this.Psa[e]};a.prototype.Y1h=function(e){var k=a.nYc(e.messageType,e.targetId);1===e.actionType?this.u3h(e.controlId,e.messageType,k):2===e.actionType&&this.e4h(e.controlId,
e.messageType,k)};a.prototype.h$i=function(e){if(e){var k=Object.keys(this.xW);if(!(void 0===k||null===k||0>=k.length)){k=ak(k);for(var l=k.next();!l.done;l=k.next()){l=l.value;var m=this.xW[l];m[e]&&(delete m[e],Object.keys(m).length||delete this.xW[l])}}}};a.prototype.VZ=function(e,k){e=a.nYc(e,k);e=this.xW[e];return!!e&&0<Object.keys(e).length};a.prototype.U4h=function(){return!d.a.isEmpty(this.xW)};a.prototype.Kgf=function(){return 0<this.wHd};a.prototype.ENh=function(){var e=[],k=this.xW,l;for(l in k){var m=
l,f=k[l],w;for(w in f){f=w;var n={};n.eventType=parseInt(m.split("#")[0],10);n.targetId=m.split("#")[1];n.addinId=f;e.push(n)}}return e};a.prototype.u3h=function(e,k,l){if(this.xW[l])l=this.xW[l],l[e]=l[e]?l[e]+1:1;else{var m={};m[e]=1;this.xW[l]=m}100===k&&this.wHd++};a.prototype.e4h=function(e,k,l){if(this.xW[l]){var m=this.xW[l];if(e){var f=m[e];1===f?(delete m[e],Object.keys(m).length||delete this.xW[l]):m[e]=f-1;100===k&&this.wHd--}else c.ULS.sendTraceTag(537170459,0,50,"The OsfControl[{0}] doesn't register event with key[{1}].",
e,l)}else c.ULS.sendTraceTag(537170460,0,50,"The event with key[{0}] that will be unregistered doesn't exist.",l)};a.nYc=function(e,k){return String.format("{0}#{1}",e,k)};a.OW="Workbook";Object(u.a)(a,"RichApiEventRegistration",null,[])},976:function(u,D,b){function a(c,d,e,k){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=c;this.controlId=d;this.ddaBinding=e;this.ArrayData=void 0===k?null:k}b.d(D,"a",function(){return a});u=b(0);a.prototype.getDispid=function(){return this.dispid};
a.prototype.getDdaBinding=function(){return this.ddaBinding};Object(u.a)(a,"DdaEventArgs",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.agave.js.map/37110f208d2073b76cd95efb316b665f/EwaDS.agave.js.map