(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[27],{1329:function(u,D,b){function a(){c.a.vi('.ewr-selection-draghandle,.ewr-selection-draghandle-grab{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto}.ewr-selection-draghandle-grab{cursor:grab}.ewr-selection-draghandle-top-ie,.ewr-selection-draghandle-top-ie-enhanced{top:-2px;left:-2px;right:-2px;height:5px}.ewr-selection-draghandle-top-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-top,.ewr-selection-draghandle-top-enhanced{top:-2px;left:-2px;right:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-top-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom-ie,.ewr-selection-draghandle-bottom-ie-enhanced{right:0;left:-2px;bottom:-2px;height:5px}.ewr-selection-draghandle-bottom-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom,.ewr-selection-draghandle-bottom-enhanced{right:0;left:-2px;bottom:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-left-ie,.ewr-selection-draghandle-left-ie-enhanced{top:0;left:-2px;bottom:0;width:5px}.ewr-selection-draghandle-left-ie-enhanced{border-top:1.5px solid transparent}.ewr-selection-draghandle-left,.ewr-selection-draghandle-left-enhanced{top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-enhanced{border-left:1.5px solid transparent}.ewr-selection-draghandle-right-ie,.ewr-selection-draghandle-right-ie-enhanced{top:0;right:-2px;bottom:0;width:5px}.ewr-selection-draghandle-right-ie-enhanced{border-right:1.5px solid transparent}.ewr-selection-draghandle-right,.ewr-selection-draghandle-right-enhanced{top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-enhanced{border-right:1.5px solid transparent}.ms-core-needIEFilter .ewr-selection-draghandle{filter:alpha(opacity=1);-ms-filter:"alpha(opacity=1)"}.ewr-selection-dragtooltip{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:18px;font-size:12px;padding-left:2px;padding-right:2px}.ewr-selection-dragtooltip-updated{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:fit-content;width:max-content;font-size:10px;padding-left:2px;padding-right:2px}.ewr_selection_rearrangeleft{border-left:3px solid #217346;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #217346;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #217346;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #217346;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr-cell-selection-highlight-all.selecting .ewr-selection-draghandle{cursor:unset}.ewr-selection-resizemarqueehandle{position:absolute;width:5px;height:5px;background-color:#217346;border:solid 1px #fff;z-index:16;pointer-events:auto}.ewr-selection-resizemarqueehandle-topleft,.ewr-selection-resizemarqueehandle-topright{top:-4px}.ewr-selection-resizemarqueehandle-bottomleft,.ewr-selection-resizemarqueehandle-bottomright{bottom:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{cursor:nwse-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{cursor:nesw-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright{cursor:nesw-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{cursor:nwse-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{left:-4px}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{right:-4px}.ms-core-needIEFilter .ewr-selection-resizemarqueehandle{filter:alpha(opacity=1);-ms-filter:"alpha(opacity=1)"}.ewr-marquee-thick{z-index:calc(10 + 1) !important;border-width:3px !important}.ewr-grdcontarea-ltr .ewr-marquee-thick{margin:-3px 0 0 -3px !important}.ewr-grdcontarea-rtl .ewr-marquee-thick{margin:-3px -3px 0 0 !important}.ewr-resizemarqueehandle-thick{height:6px !important;width:6px !important}')}
b.d(D,"a",function(){return a});var c=b(559)},1330:function(u,D,b){function a(){c.a.vi('.ewa-stb-uir{background-color:#f5f5f5;height:32px}.grid-visual-refresh .ewa-stb-ltr,.grid-visual-refresh .ewa-stb-rtl{background-color:#f5f5f5}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-uir .ewa-stb-navarea-dimensions{height:32px}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}a.ewa-stb-navbutton.cui-disabled:focus{outline:auto 1px}.ewa-stb-navareaextra a.ewa-stb-navbutton:focus-visible{outline-offset:-1px}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-uir .ewa-stb-navbutton{width:24px;height:24px;margin:4px;border-radius:2px}.ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#e1dfdd}.ewa-stb-uir .ewa-stb-navbutton:active{background-color:#bebbb8}.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-uir .ewa-stb-navbutton .clip12x12{display:inline-block;margin:6px}.ewa-stb-uir .cui-disabled svg{fill-opacity:.3}.ewa-stb-navbutton.cui-disabled .cui-img-container{opacity:.3}.ewa-stb-navareaextra{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-contentarea{position:relative;flex:0 1 auto;min-width:0%;top:0;left:0;right:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-uir .ewa-stb-contentarea{height:32px}.ewa-stb-uir .ewa-stb-left-scrollable.ewa-stb-contentarea::before{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-uir .ewa-stb-right-scrollable.ewa-stb-contentarea::after{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(-90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-tabarea{position:relative;top:0;height:27px;left:0;right:0}.ewa-stb-uir .ewa-stb-tabarea{height:32px}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;height:27px;list-style:none;left:0;right:0;margin:0;padding:0;overflow-x:scroll;overflow-y:hidden;white-space:nowrap}.ewa-stb-uir .ewa-stb-tabs{height:32px}.ewa-stb-tabs-smooth{scroll-behavior:smooth}@media(prefers-reduced-motion:reduce){.ewa-stb-tabs{scroll-behavior:auto}}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-left-width:1px;padding:0;height:22px;margin:2px 0 3px 0;display:inline-block;overflow:hidden;transform:translateX(0);transition:transform .2s}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6;transform:translateX(0);transition:transform .2s}.ewa-stb-uir .tab-active,.ewa-stb-uir .tab-inactive{background-color:#f5f5f5;border:0;margin:0;height:32px}.ewa-stb-uir .tab-hover{background-color:#e1dfdd}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active{background-color:Highlight;forced-color-adjust:none}}.ewa-stb-tabs .tab-active.ewa-stb-tabs-ghost,.ewa-stb-uir .ewa-stb-tabs-ghost{position:fixed;z-index:1000;border-right-width:1px;transition:none}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.tab-anchor-text:focus-visible{outline-offset:-1px}.ewa-stb-uir .tab-anchor-text{height:32px}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-uir .tab-active-text{color:#444;line-height:16px;padding-bottom:5px}.ewa-stb-uir .tab-active .tab-content-container::before{content:"";position:absolute;display:inline-block;top:0;bottom:0;left:0;right:0;color:rgba(0,0,0,0);border-bottom:3px solid #217346;padding-bottom:5px;width:calc(100% - 18px);margin:auto;transition:width 400ms cubic-bezier(.17,.17,0,1) 0s}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active .tab-content-container::before{border-bottom-color:HighlightText}.ewa-stb-uir .tab-active svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-stb-uir .tab-active.tab-hover .tab-content-container:hover::before{width:calc(100%)}.ewa-stb-tabs .tab-text,.ewa-stb-tabs .tab-content-container{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-uir .tab-content-container{padding:3px 6px 3px 6px;border-radius:2px;margin:2px 3px 2px 3px;font-size:14px}.ewa-stb-tabs .cui-img-container{top:1px}.ewa-stb-tabs .tab-content-container .clip12x12,.ewa-stb-tabs .tab-content-container .clip16x16,.ewa-stb-tabs .tab-content-container .clip24x16{display:inline-block}.ewa-stb-nsv-inactive{opacity:.7}.ewa-stb-nsv-inactive-svg{fill-opacity:.7}.ewa-stb-nsv-active{opacity:1}.ewa-stb-nsv-active-svg{fill-opacity:1}.ewa_nsv_margin{margin-left:4px !important;height:14px}.ewa-stb-rtl .ewa_nsv_margin{margin-left:0 !important;margin-right:4px !important}@media screen and (-ms-high-contrast:active){.ewa-stb-tabs .tab-active-text{color:ButtonText}}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active-text{color:HighlightText}}.ewa-stb-disable-scrollbar *::-webkit-scrollbar{display:none}.ewa-stb-disable-scrollbar *{scrollbar-width:none;-ms-overflow-style:none}.leave-size-fixed-on-tab-hover-old::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden}.leave-size-fixed-on-tab-hover::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden;height:0}.ewa-stb-locked-sheet{margin-right:4px !important;height:13px !important;width:12px !important}.ewa-stb-locked-sheet-svg{margin-right:4px !important;height:15px !important;width:12px !important}.ewa-stb-tabs .ewa-stb-locked-sheet-svg-16px{margin-right:4px}.ewa-stb-rtl .ewa-stb-locked-sheet{margin-right:0 !important;margin-left:4px !important}.ewa-stb-dropdown-menu-button{position:relative;display:inline-block;padding:0;margin:0;border:0}.ewa-active-sheet-menu-item{background-color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir,.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive,.ewr-presentMode-on .ewa-stb-uir .tab-active,.ewr-presentMode-on .ewa-stb-uir .tab-inactive,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-rtl{background-color:#3b3a39}.ewr-presentMode-on .ewa-stb-uir .tab-hover,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#484644}.ewr-presentMode-on .ewa-stb-tabs .tab-active :focus,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive :focus,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton.cui-disabled:focus{background-color:#3b3a39 !important;border:1px solid #e5e5e5 !important}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-active-text{border-bottom-color:#37a660}.ewr-presentMode-on .ewa-stb-uir .tab-active .tab-content-container::before{border-bottom:3px solid #37a660}.ewr-presentMode-on .ewa-stb-tabs .light{color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir .tab-active-text{color:#f3f2f1}.ewa-active-sheet-menu-item-present-mode{background-color:#605e5c}.ewr-presentMode-transition .ewa-stb-uir,.ewr-presentMode-transition .ewa-stb-tabs .tab-active,.ewr-presentMode-transition .ewa-stb-tabs .tab-inactive,.ewr-presentMode-transition .ewa-stb-uir .tab-active,.ewr-presentMode-transition .ewa-stb-uir .tab-inactive,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-rtl{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-stb-tabs .light,.ewr-presentMode-transition .ewa-stb-uir .tab-active-text{transition:color .4s linear}')}
b.d(D,"a",function(){return a});var c=b(559)},1331:function(u,D,b){function a(){c.a.vi(".ewa-svg-icon{height:100%;width:100%}")}b.d(D,"a",function(){return a});var c=b(559)},1332:function(u,D,b){function a(f,w){this.ID=f;this.type=w}function c(f,w){this.value=f;this.contextId=w}function d(f,w,n,z,r,v,A,B){this.type=f;this.startTime=null==n||void 0==n.value?new c(n,null):n;this.endTime=null==z||void 0==z.value?new c(z,null):z;null!=r&&void 0!=r.value||new c(r,null);null!=v&&void 0!=v.value||new c(v,
null);this.operationType=B}function e(f){this.ID=f}function k(){this.De=[];this.znb=[];this.NVc=0;this.duration=this.startTime=null;this.p7b={};this.mvd=this.Pvd=this.lXc=-1}function l(f){var w;return(null!=document.body.style.msTransform?w=f.style.msTransform:null!=document.body.style.webkitTransform?w=f.style.webkitTransform:null!=document.body.style.mozTransform?w=f.style.X_j:null!=document.body.style.oTransform?w=f.style.e0j:null!=document.body.style.transform&&(w=f.style.transform),w)?(w=w.replace("rotate(",
""),w=w.replace("deg)",""),parseFloat(w)):0}b.d(D,"a",function(){return l});new a(0,0,0,0,0,0);new a(1,1,0,0,0,0);new a(2,2,0,0,0,0);new a(3,3,0,0,0,1);new a(4,3,1,0,1,1);new a(5,3,0,0,.42,1);new a(6,3,.83,0,1,1);new a(7,3,0,0,.58,1);new a(8,3,.42,0,.58,1);new a(9,3,.1,.25,.75,.9);new a(10,3,.1,.9,.2,1);new a(11,3,.1,.9,.2,1);new a(12,3,.9,.1,.2,1);new a(13,3,.4,0,0,1);new a(14,3,.13,.21,.1,.7);new a(15,3,.02,.33,.38,.77);new a(16,3,.57,.17,.95,.75);new a(17,3,0,.19,.07,.72);new a(18,3,0,0,.95,.37);
new a(19,3,.66,0,.34,1);new a(20,3,.8,0,.2,1);new a(21,3,.8,0,.2,1);d.prototype={type:0,startTime:new c(0,null),endTime:new c(0,null),H0j:new c(0,null),k_j:new c(0,null),operationType:0};new e(0,[new d(5,0,0,0,null,1,1,0)]);new e(1,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,50,null,1,1,0)]);new e(2,[new d(1,3,0,167,null,0,1,1),new d(2,3,0,167,null,0,1,1)]);new e(3,[new d(3,3,0,167,null,0,1,1),new d(4,3,0,167,null,0,1,1)]);new e(4,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,167,null,1,1,0)]);new e(5,[new d(5,
2,0,167,null,0,1,0)]);new e(6,[new d(1,3,0,100,null,0,1,1),new d(2,3,0,100,null,0,1,1)]);new e(7,[new d(3,3,0,100,null,0,1,1),new d(4,3,0,100,null,0,1,1)]);new e(8,[new d(5,2,0,100,null,1,1,0)]);new e(9,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,100,null,1,1,0)]);new e(10,[new d(5,2,0,100,null,0,1,0)]);new e(11,[new d(1,3,0,267,null,0,1,1),new d(2,3,0,267,null,0,1,1)]);new e(12,[new d(3,3,0,267,null,0,1,1),new d(4,3,0,267,null,0,1,1)]);new e(13,[new d(5,2,0,267,null,1,1,0)]);new e(14,[new d(5,2,0,0,null,
0,2,0),new d(5,2,0,267,null,1,1,0)]);new e(15,[new d(5,2,0,267,null,0,1,0)]);new e(16,[new d(6,3,0,267,null,0,1,1),new d(7,3,0,267,null,0,1,1)]);new e(17,[new d(1,3,0,750,null,0,1,1),new d(2,3,0,750,null,0,1,1)]);new e(18,[new d(3,3,0,750,null,0,1,1),new d(4,3,0,750,null,0,1,1)]);new e(19,[new d(5,2,0,750,null,1,1,0)]);new e(20,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,750,null,1,1,0)]);new e(21,[new d(6,3,0,1E3,null,0,1,1),new d(7,3,0,1E3,null,0,1,1)]);new e(22,[new d(1,3,0,367,null,0,1,1),new d(2,
3,0,367,null,0,1,1)]);new e(23,[new d(3,3,0,367,null,0,1,1),new d(4,3,0,367,null,0,1,1)]);new e(24,[new d(5,2,0,367,null,1,1,0)]);new e(25,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,367,null,1,1,0)]);new e(26,[new d(5,2,0,367,null,0,1,0)]);new e(27,[new d(5,2,0,0,null,1,1,0),new d(5,2,0,50,null,0,1,0)]);new e(28,[new d(1,3,0,433,null,0,1,1),new d(2,3,0,433,null,0,1,1)]);new e(29,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,50,null,1,1,0),new d(2,3,0,0,null,40,1,1),new d(2,3,0,100,null,0,1,1)]);new e(30,[new d(2,
0,0,0,null,32,1,1),new d(2,0,0,100,null,32,1,1),new d(2,3,101,350,null,0,1,1),new d(3,0,0,0,null,0,2,1),new d(3,0,0,100,null,0,2,1),new d(3,3,101,350,null,0,1,1),new d(5,0,0,0,null,0,2,0),new d(5,0,0,100,null,1,1,0)]);new e(31,[new d(2,3,0,267,null,32,1,1),new d(3,3,0,267,null,0,2,1),new d(5,2,0,0,null,1,0,0),new d(5,2,0,267,null,0,2,0)]);new e(32,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,100,null,0,2,0),new d(5,2,101,267,null,1,1,0)]);new e(33,[new d(1,10,0,300,null,0,1,1),new d(2,10,0,300,null,0,1,
1)]);new e(34,[new d(3,10,0,300,null,0,1,1),new d(4,10,0,300,null,0,1,1)]);new e(35,[new d(1,8,0,750,null,0,1,1),new d(2,8,0,750,null,0,1,1)]);new e(36,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,200,null,0,2,0),new d(5,3,201,500,null,1,1,0)]);new e(37,[new d(1,2,0,0,null,0,2,1),new d(2,2,0,0,null,0,2,1),new d(1,2,0,200,null,0,2,1),new d(2,2,0,200,null,0,2,1),new d(1,3,201,267,null,0,1,1),new d(2,3,201,267,null,0,1,1)]);new e(38,[new d(1,3,0,267,null,0,1,1),new d(2,3,0,267,null,0,1,1)]);new e(39,[new d(5,
2,0,0,null,0,2,0),new d(5,2,0,267,null,1,1,0)]);new e(40,[new d(5,2,0,267,null,0,1,0)]);window.location.search.indexOf("AnimationLogging=1");window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(f){window.setTimeout(f,16)}}();k.prototype={De:null,nJg:5,znb:null,NVc:0,startTime:null,duration:null,p7b:null,lXc:-1,Pvd:-1,mvd:-1};k.prototype.Start=
function(){this.startTime=new Date;this.p7b={}};k.prototype.GetRecentAnimationStats=function(){var f,w=[],n=0;for(f=m.NVc;f<m.nJg;f++)null!=m.znb[f]&&(w[n]=m.znb[f],n++);for(f=0;f<m.NVc;f++)null!=m.znb[f]&&(w[n]=m.znb[f],n++);return w};k.prototype.GetAnimationSqmStats=function(){var f=[];return f[0]=0>m.lXc?0:m.lXc,f[1]=0>m.Pvd?0:m.Pvd,f[2]=0>m.mvd?0:m.mvd,f};var m=new k},1333:function(u,D,b){function a(w){var n=f.call(this)||this;n.dT=[];n.ff=function(y,x){var C,G=x.Zc.block;y=!1;if(G.tk&&G.state&
1&&(C=n.view.Ef(x.Zc.block.je.BlockCachePosition.PaneType).gG(x.Zc.hash))){G=n.HFd(G.me);if(C=C.kf)for(var E=n.dT.length-1;0<=E;E--)C.contains(n.dT[E].bottomRight)&&(Array.removeAt(n.dT,E),y=!0);if(G)for(C=0,E=G.length;C<E;C++)n.rangeList.push(e.a.vQ(G[C])),y=!0;y&&(x=(m.EwaSettings.isChangeGateEnabled("OfficeVSO:6336710_ApplyHeaderSnappingOnVerticalFreezePane")?n.view.apc(x.Zc.block.je.BlockCachePosition.PaneType):n.view.U2).gG(x.Zc.hash),n.raiseEvent(a.IFd,new l.a(x)))}};n.Fm=function(){n.rHb()};
n.so=function(){n.dT=[]};n.sie=w;var z=w.Ea;z.Fs(n.ff);z.Gga(n.ff);z.TYb(n.ff);z.xG(n.Fm);w.$.va.lJ(n.so);w.$.vb.lJ(n.so);z=ak(w.hn);for(var r=z.next();!r.done;r=z.next()){r=ak(r.value);for(var v=r.next();!v.done;v=r.next()){v=ak(v.value);for(var A=v.next();!A.done;A=v.next()){A=A.value;var B=w.Ea.il(A.hashCode);n.ff(n,new d.a(new c.a(B,A.hashCode),null))}}}return n}b.d(D,"a",function(){return a});u=b(0);D=b(38);var c=b(226),d=b(377),e=b(189),k=b(45),l=b(705),m=b(1),f=D.a;Rk(a,f);a.prototype.dispose=
function(){this.view&&(this.view.Ea.Gq(this.ff),this.view.Ea.aI(this.Fm),this.view.Ea.Sab(this.ff),this.view.Ea.JHb(this.ff),this.view.$.va.FK(this.so),this.view.$.vb.FK(this.so));this.dT=this.sie=null;f.prototype.dispose.call(this)};a.prototype.LYb=function(w){w=this.HFd(w);var n=m.EwaSettings.isChangeGateEnabled("OfficeVSO:6336710_ApplyHeaderSnappingOnVerticalFreezePane")?this.view.$G:this.view.Ug;if(w&&0<w.length&&n)for(var z=0,r=w.length;z<r;z++)n.contains(this.dT[z])||this.dT.push(e.a.vQ(w[z]))};
a.prototype.rHb=function(){var w=m.EwaSettings.isChangeGateEnabled("OfficeVSO:6336710_ApplyHeaderSnappingOnVerticalFreezePane")?this.view.$G:this.view.Ug;if(this.dT.length&&w)for(var n=this.dT.length-1;0<=n;n--)w.contains(this.dT[n])||Array.removeAt(this.dT,n)};a.prototype.B0e=function(w){return this.X_e(w)};a.prototype.X_e=function(w){w=k.I(w,this.dT,!0);return 0<w.length?w[0]:null};Af.Object.defineProperties(a.prototype,{rangeList:{configurable:!0,enumerable:!0,get:function(){return this.dT}},view:{configurable:!0,
enumerable:!0,get:function(){return this.sie}}});a.IFd="lrc";Object(u.a)(a,"LoadedRangeCollection",D.a,[])},1334:function(u,D,b){function a(){c.a.vi(".ewa-ttrd-buttonarea{position:absolute;z-index:31}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-grdcontarea-ltr .ewr-table-resize-fillhandle-higher{right:-6px}.ewr-grdcontarea-rtl .ewr-table-resize-fillhandle-higher{left:-6px}.ewr-grdcontarea-ltr .ewr-table-resize-handle{cursor:nwse-resize;right:6px;bottom:0}.ewr-grdcontarea-rtl .ewr-table-resize-handle{cursor:nesw-resize;left:6px;bottom:0}.ewr-grdcontarea-ltr .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-grdcontarea-rtl .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-cell-selection-highlight-all.Selecting .ewr-table-resize-handle{cursor:nesw-resize}@media screen and (-ms-high-contrast:active),(forced-colors:active){.ewr-table-resize-fillhandle-higher{forced-color-adjust:none;position:absolute;width:3px;height:6px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-broader{forced-color-adjust:none;position:absolute;width:6px;height:3px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}}@media screen and (-ms-high-contrast:black-on-white),(forced-colors:active) and (prefers-color-scheme:light){.ewr-table-resize-fillhandle-higher{background-color:#000}.ewr-table-resize-fillhandle-broader{background-color:#000}}")}
b.d(D,"a",function(){return a});var c=b(559)},1347:function(u,D,b){function a(){ea.a.Fa(c.ka);ea.a.Fa(X.ka)}function c(wb){var rc=ec.call(this)||this;rc.$=wb;rc.Eb();return rc}function d(wb,rc){var Mc=Cb.call(this)||this;Mc.fob=function(Pc,Kc){Pc=Kc.w4;var ub=Mc.gridView;Kc=Kc.B6h;var Fb=Kc.mf,pc=Kc.Z9;Qa.a.sh&&pc.push(new B(Fb,ub));switch(Pc){case 24:Kc.Z9.push(new v(Fb,Kc));break;case 0:Kc.Z9.push(new y(Fb,ub));Qa.a.Zo||(Db.EwaSettings.isChangeGateEnabled("OfficeVSO:6170982_UseDragSelectionClickBehaviorTableRange")?
(pc.push(new C(Fb,Mc.gridView.$,Kc.paneType,Mc.tableManager,Mc.$n)),Db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)&&Array.add(pc,new x(Fb,Mc.gridView.$,Kc.paneType,Mc.tableManager,Mc.$n))):pc.push(new E(Fb,Mc.gridView.$,Kc.paneType,Mc.tableManager,Mc.$n)));pc.push(new e(Kc,Fb,ub,Kc.paneType));break;case 3:pc.push(new K(Fb));Qa.a.Zo||(pc.push(new M(Fb,Mc.gridView.$,Kc.paneType,Mc.Zx,Mc.$n,Kc)),pc.push(new w(Fb,Mc.gridView,Mc.Zx,Mc.$n,Kc)),pc.push(new f(Fb,
Mc.gridView,Mc.Zx,Mc.$n,Kc)));break;case 4:case 5:pc.push(new m(Fb));break;case 30:pc.push(new l(Fb));break;case 16:pc.push(new k(Fb));pc.push(new r(Kc,Fb,ub,Kc.paneType));break;case 11:case 12:pc.push(new z(Fb,11===Pc));break;case 17:pc.push(new K(Fb));break;case 19:pc.push(new K(Fb)),pc.push(new J(Kc,Fb,ub,Kc.paneType))}Kc.m0b=!0};Mc.$=wb;Mc.gridView=db.g(wb);Mc.tableManager=rc;Mc.Zx=new A(Mc.gridView);Mc.$n=new Q(Mc.gridView);Mc.gridView.qb&&(Mc.gridView.qb.WEg(Mc.fob),Mc.gridView.qb.update(!1));
wb.da.Ga(64,Mc);return Mc}function e(wb,rc,Mc,Pc){return O.call(this,wb,rc,Mc,Pc)||this}function k(wb){var rc=H.call(this,wb)||this;k.grb(wb,W.a.zvh+" "+gb.a.fua);k.grb(wb,W.a.yvh+" "+gb.a.fua);k.grb(wb,W.a.vvh+" "+gb.a.fua);k.grb(wb,W.a.xvh+" "+gb.a.fua);k.grb(wb,gb.a.wvh);return rc}function l(wb){var rc=H.call(this,wb)||this;appChrome.renderSpinner(wb);return rc}function m(wb){var rc=H.call(this,wb)||this;m.Rqb(wb,W.a.Zuh+" "+gb.a.fua);m.Rqb(wb,W.a.Yuh+" "+gb.a.fua);m.Rqb(wb,W.a.Vuh+" "+gb.a.fua);
m.Rqb(wb,W.a.Xuh+" "+gb.a.fua);m.Rqb(wb,gb.a.Wuh);return rc}function f(wb,rc,Mc,Pc,Kc){var ub=n.call(this,wb,rc,Mc,Pc,Kc)||this;ub.kEb=function(){var Fb=3===Ia.a.Cb;ub.Ird&&!Fb?ub.$n.xKb(ub.aba,ub.LK,!1):!ub.Ird&&Fb&&ub.$n.xKb(ub.aba,ub.LK,!0);ub.Ird=Fb};ub.CQi=function(Fb,pc){pc.Axb===ub.aba.v$&&ub.$n.xKb(ub.aba,ub.LK,!pc.start&&ub.EQd())};Ia.a.Rme(ub.kEb);ub.Ird=3===Ia.a.Cb;ub.$n.yFg(ub.CQi);return ub}function w(wb,rc,Mc,Pc,Kc){return n.call(this,wb,rc,Mc,Pc,Kc)||this}function n(wb,rc,Mc,Pc,Kc){var ub=
H.call(this,wb)||this;ub.RK=null;ub.Ya=null;ub.i3=0;ub.sourceRange=null;ub.gb=null;ub.oSa=!1;ub.onPointerDown=function(Fb){Fb=Va.a(ub.$).Sd(Fb);if(ub.j1f(Fb)&&!ub.oSa){ub.Zlf();ub.Ya=ub.$n.Vbd();ub.RK=ub.$n.n1e(Fb);if(!ub.Ya||!ub.RK||!ub.RK.range)return da.ULS.shipAssertTag(537159361,0,!!ub.Ya,"ResizeMarqueeBehaviorBase.OnPointerDown: cellContentEditor is null"),da.ULS.shipAssertTag(537159360,0,!!ub.RK,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState is null"),da.ULS.shipAssertTag(537159331,
0,!!ub.RK.range,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState.Range is null"),!1;ub.gb=ub.RK.range.clone();ub.sourceRange=ub.gb.clone();ub.i3=ub.uYe(Fb);if(4===ub.i3)return da.ULS.shipAssertTag(537159330,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;var pc=ub.d_e(Fb,!0);if(!pc)return da.ULS.shipAssertTag(537159329,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: mouseSelection is null. Not expect when clicking on handler."),!1;if(!ub.vDe(pc))return da.ULS.shipAssertTag(537159328,
0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;ub.gridView.kLa=!0;ub.Ya.gE(!1);ub.Zx.PIe(Fb.zb);ub.$n.fKf(!0,ub.aba.v$);ub.Ya.textBox.removeSelection();ub.Ya.gZb(ub.U4e);ub.wNf();ub.oSa=!0;bb.b(ub.$,!0)}return!0};ub.U4e=function(){ub.A9b(!0)};ub.gridView=rc;ub.$=rc.$;ub.LK=[];ub.ha=ub.gridView.ha;ub.Zx=Mc;ub.$n=Pc;ub.aba=Kc;ub.coloredReferencesManager=ub.$.da.za(281);da.ULS.shipAssertTag(537159362,0,!!ub.coloredReferencesManager,"ResizeMarqueeBehaviorBase Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");
rc=ak(ub.DSf());for(Mc=rc.next();!Mc.done;Mc=rc.next())Mc=ub.$n.ICe(wb,Mc.value,ub.Une(),ub.onPointerDown),ub.LK.push(Mc);wb=ak(ub.LK);for(rc=wb.next();!rc.done;rc=wb.next())rc=rc.value,xa.a.instance.qa(ta.a.iW,rc,Object(qb.a)(ub.Zx,ub.Zx.d8e,"hoveringStarted")),xa.a.instance.qa(ta.a.my,rc,Object(qb.a)(ub.Zx,ub.Zx.e8e,"hoveringStopped"));ub.GYa(Kc);return ub}function z(wb,rc){var Mc=H.call(this,wb)||this;var Pc=document.createElement("div"),Kc=document.createElement("div");Pc.className=rc?F.Bvh:F.Dvh;
Kc.className=rc?F.Cvh:F.Avh;wb.appendChild(Pc);wb.appendChild(Kc);return Mc}function r(wb,rc,Mc,Pc){return O.call(this,wb,rc,Mc,Pc)||this}function v(wb,rc){var Mc=H.call(this,wb)||this;Mc.Zzf=function(){if(!Mc.Ru)return da.ULS.shipAssertTag(537159364,0,!1,"RangeCatchUpActivityHighlightBehavior.OnPointerEnter: highlightController is null"),!1;Mc.Ru.wKf(Mc.sH,!1);Mc.Ru.GKe(Mc.sH,!1);if(3===Mc.Ru.model.state)return!0;Mc.Ru.$7e(!0);return!0};Mc.sca=function(){if(!Mc.Ru)return!1;Mc.Ru.k3i();Mc.Ru.sKd(Mc.sH,
!1);if(3===Mc.Ru.model.state)return!0;Mc.Ru.$7e(!1);return!0};Mc.onPointerDown=function(Pc){return Mc.Ru?2===Pc.mb&&Pc.Hn===Sys.UI.MouseButton.leftButton?!0:!1:!1};Mc.oEb=function(){if(!Mc.Ru)return!1;Mc.Ru.sKd(Mc.sH,!0);Mc.Ru.wKf(Mc.sH,!0);Mc.Ru.GKe(Mc.sH,!0);Mc.Ru.zJb(!0);return!0};Mc.onDoubleClick=function(Pc){if(Pc.Ca)return Pc.Ca.stopPropagation(),!0;da.ULS.sendTraceTag(537159363,0,50,"CatchUpActivityHighlightBehavior::OnDoubleClick Double click event handled on Pill.");return!0};Mc.Ru=Object(Zb.a)(Lb.a,
rc.metadata);Mc.VJ=document.createElement("div");Mc.VJ.id=String.format("{0}-{1}",wb.id,Na.a.qwe);Mc.VJ.className=mc.a.gVg;Mc.sH=document.createElement("div");Mc.sH.id=String.format("{0}-{1}",wb.id,Na.a.SZc);Mc.sH.className=mc.a.SZc;Mc.VJ.appendChild(Mc.sH);wb.appendChild(Mc.VJ);da.ULS.sendTraceTag(537159365,0,50,"RangeCatchUpActivityHighlightBehavior::RangeCatchUpActivityHighlightBehavior: An activity indicator has been created.");xa.a.instance.qa(ta.a.iW,Mc.VJ,Mc.Zzf);xa.a.instance.qa(ta.a.my,Mc.VJ,
Mc.sca);xa.a.instance.qa(ta.a.pointerDown,Mc.VJ,Mc.onPointerDown);Dc.a.instance.qa(ta.a.click,Mc.VJ,Mc.oEb);Dc.a.instance.qa(ta.a.$j,Mc.VJ,Mc.onDoubleClick);return Mc}function A(wb){var rc=this;this.vg=function(){rc.$nd=!1};this.hp=function(){rc.$nd=!0};this.gridView=wb;this.X4a=0;this.$nd=this.rgc=!1;this.t5=Number.NaN;this.gridView.ha.t2(this.hp);this.gridView.ha.mY(this.vg);this.gridView.ha.wZb(this.vg)}function B(wb,rc){var Mc=H.call(this,wb)||this;Mc.wRi=function(Pc){var Kc=mb.HelperMethods.En(Pc),
ub=Mc.uva.qZd(Pc.clientPoint);if(!ub)return!1;var Fb=ub.Ge,pc=Mc.uva.Ea.bvb(Fb.hashCode).Nua(ub.zI);if(!pc)return!1;Pc=Fb.oj.domElement;ub=mb.HelperMethods.lle(mb.HelperMethods.wvb(Fb.domElement,Pc),ub.zI);Fb=0;pc=Mc.uva.Ub(pc.getRange());for(var eb=0,ic=B.Awe.length;eb<ic;++eb){var Ac=B.Awe[eb];if(128!==Ac&&64!==Ac||!Mc.uva.$.isEditMode){var lc=pc.WJa(Ac);if(lc&&lc.s5a&&"none"!==lc.s5a.style.display){lc=lc.s5a;var Gc=mb.HelperMethods.wvb(lc,Pc);lc=new Sys.UI.Bounds(Gc.x,Gc.y,lc.offsetWidth,lc.offsetHeight);
if(sa.a.UM(lc,ub)){Fb=Ac;break}}}}return 0!==Fb?(pc.invoke(Fb,Kc),!0):!1};Mc.opg=rc;Ma.a.instance.qa(ta.a.click,wb,Mc.wRi);return Mc}function y(wb,rc){var Mc=K.call(this,wb)||this;Mc.vg=function(){Mc.domElement.classList.remove(F.selecting);lb.c(Mc.gridView.$,!0,"FillHandleClickBehavior:OnSelectionEnded")};Mc.hp=function(){Mc.domElement.classList.add(F.selecting)};Mc.onPointerDown=function(Pc){2===Pc.mb&&Pc.Hn===Sys.UI.MouseButton.leftButton&&(Mc.gridView.ha.selectionType=4,Mc.gridView.ha.sourceRange=
Mc.gridView.ha.sa.Vc,lb.c(Mc.gridView.$,!1,"FillHandleClickBehavior:OnSelectionStarted"));return!1};Mc.oca=function(){Mc.gridView.$.Fd(1983983164,2,30,null);return!0};Mc.Yc=function(){la.DOMElementExtensions.setVisible(Mc.oaa,Mc.gridView.$.isEditMode)};Mc.q6=function(){la.DOMElementExtensions.setVisible(Mc.oaa,!1)};Mc.p6=function(){la.DOMElementExtensions.setVisible(Mc.oaa,!0)};Mc.nxf=function(){la.DOMElementExtensions.setVisible(Mc.oaa,!1)};Mc.mxf=function(){la.DOMElementExtensions.setVisible(Mc.oaa,
!0)};Mc.RDb=function(Pc,Kc){la.DOMElementExtensions.setVisible(Mc.oaa,!Kc.Eje)};Mc.gridView=rc;rc=document.createElement("div");rc.className=gb.a.tvh;Mc.oaa=rc;Mc.Yc(null,null);wb.appendChild(rc);xa.a.instance.qa(ta.a.pointerDown,Mc.oaa,Mc.onPointerDown);Ma.a.instance.qa(ta.a.$j,Mc.oaa,Mc.oca);Mc.gridView.ha.t2(Mc.hp);Mc.gridView.ha.mY(Mc.vg);Mc.gridView.$.Tk(Mc.Yc);Mc.gridView.$.ob.EZb(Mc.q6);Mc.gridView.$.ob.DZb(Mc.p6);Mc.gridView.jme(Mc.RDb);Mc.gridView.$b.Bk(Mc.nxf);Mc.gridView.$b.vm(Mc.mxf);
return Mc}function x(wb,rc,Mc,Pc,Kc){var ub=G.call(this,wb,rc,Mc,Kc)||this;ub.zOa=function(){ub.Np&&ub.o$(!0);5==ub.Th&&ub.QA(!0)};ub.zN=function(Fb){Va.a(ub.$).Sd(Fb);ub.Np=!1;ub.qb.eh(ub.Bh);ub.ha.sourceRange=ub.sourceRange.clone();ub.k1i();ub.o$(!0);return!0};ub.xN=function(Fb){Fb=Va.a(ub.$).Sd(Fb);var pc=Fb.clientPoint;ub.xw=Fb;var eb=ub.ha.Kn(pc,Fb.zb,5,void 0,void 0,!0);if(eb){if(!ub.kpd(eb))return ub.O1h(Fb),!0;ub.Mcg(eb,ub.isRow,pc);if(ub.isRow||ub.Ue)ub.gb=ub.G2(eb);ub.ha.sourceRange=ub.gb;
ub.qb.Wi(ub.gb,ub.Bh);ub.qb.qn(ub.Bh);ub.qb.eh(ub.bB());ub.xy()}return!0};ub.ezf=function(Fb){Fb.Errors&&0<Fb.Errors.length?(da.ULS.sendTraceTag(521410185,0,10,"DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsSuccess: Errors: [{0}]",ob.a.Dc(Fb.Errors)),ub.gb.left=ub.sourceRange.left,ub.gb.right=ub.sourceRange.right,ub.gb.top=ub.sourceRange.top,ub.gb.bottom=ub.sourceRange.bottom):ub.isRow?ub.sourceRange.top<=ub.gb.top&&ub.sourceRange.bottom>=ub.gb.top-1?(ub.gb.top=ub.sourceRange.top,ub.gb.bottom=
ub.sourceRange.bottom):(ub.sourceRange.top>ub.gb.top||(ub.gb.top-=ub.sourceRange.height),ub.gb.bottom=ub.gb.top+ub.sourceRange.height-1):ub.sourceRange.left<=ub.gb.left&&ub.sourceRange.right>=ub.gb.left-1?(ub.gb.left=ub.sourceRange.left,ub.gb.right=ub.sourceRange.right):(ub.sourceRange.left>ub.gb.left||(ub.gb.left-=ub.sourceRange.width),ub.gb.right=ub.gb.left+ub.sourceRange.width-1);ub.ZK();ub.Th=-1};ub.dzf=function(Fb){Fb=Ab.a.Of(Fb.data);da.ULS.sendTraceTag(521410184,0,10,"DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsFail: Errors: [{0}]",
ob.a.Dc(Fb))};ub.tableManager=Pc;ub.ha.wZb(ub.zOa);return ub}function C(wb,rc,Mc,Pc,Kc){var ub=G.call(this,wb,rc,Mc,Kc)||this;ub.Pz=null;ub.zq=!1;ub.yq=!1;ub.wAb=0;ub.oM=null;ub.jO=null;ub.An=0;ub.jia=P.a.instance.ga(2234);ub.psb=P.a.instance.ga(2235);ub.zna=P.a.instance.ga(2236);ub.TKb=P.a.instance.ga(2237);ub.itd=Db.EwaSettings.isChangeGateEnabled("OfficeVSO:6287205_LogDragDropActivity");ub.onKeyDown=function(Fb){if(ub.Lh){if(ub.mka(Fb)||Fb.Ca.keyCode===wc.a.vea)return ub.dMa||(nb.KeyInputManager.instance.qa(ta.a.Gd,
ub.domElement.ownerDocument.body,ub.onKeyUp),ub.dMa=!0),!ub.Zt&&ub.mka(Fb)&&(db.g(ub.$).ig.zo(C.Fqb),ub.Zt=!0),ub.$t||Fb.Ca.keyCode!==wc.a.vea||(db.g(ub.$).ig.zo(T.w1a),ub.$t=!0,2===ub.An?(ub.QA(!1),ub.oE=0,ub.Bh=ub.yq?[11]:[12],ub.zq=ub.yq,ub.LPa(),ub.yI()):3===ub.An?(ub.R2(!1),ub.oE=ub.isRow?1:2,ub.RN(),ub.Ay()):1===ub.An&&(ub.o$(!1),ub.RN(),ub.Ay())),!0}else if(!ub.Zt&&(Fb.Ca.keyCode===wc.a.Z7||Qa.a.isMac&&Fb.Ca.keyCode===wc.a.Boa))return nb.KeyInputManager.instance.qa(ta.a.Gd,ub.domElement.ownerDocument.body,
ub.onKeyUp),db.g(ub.$).ig.zo(C.Fqb),ub.Zt=!0;return!1};ub.onKeyUp=function(Fb){if(ub.Lh){if(ub.mka(Fb)||Fb.Ca.keyCode===wc.a.vea)return ub.wAb=ub.mka(Fb)?0:1,ub.Np&&db.g(ub.$).ig.zo(T.w1a),Fb.Ca.keyCode===wc.a.vea&&(2===ub.An?(ub.R2(!1),ub.oE=0,ub.RN(!0),ub.Ay(!0)):3===ub.An?(ub.QA(!1),ub.oE=ub.isRow?1:2,ub.Bh=ub.isRow?[11]:[12],ub.LPa(!0),ub.yI(!0)):1===ub.An&&(ub.QA(!1),ub.Bh=ub.yq?[11]:[12],ub.wza(!0),ub.yI(!0))),ub.soa(ub.wAb),!0}else if(Fb.Ca.keyCode===wc.a.Z7||Qa.a.isMac&&Fb.Ca.keyCode===wc.a.Boa)return ub.soa(),
ub.Np&&db.g(ub.$).ig.zo(T.s6c),!0;return!1};ub.zN=function(Fb){Fb=Va.a(ub.$).Sd(Fb);5===ub.Th?ub.vAd(Fb):(ub.Np=!1,ub.qb.eh(ub.Bh),!ub.$.kq([ub.gb],!1)||ub.oGd()||ub.kzb()||(ub.ha.sourceRange=ub.sourceRange.clone(),ub.Lh?ub.PEd():ub.ntb(),ub.Xx()?ub.gb.top>ub.sourceRange.top&&(Fb=ub.gb.height,ub.gb.top-=Fb,ub.gb.bottom-=Fb):ub.gb.left>ub.sourceRange.left&&(Fb=ub.gb.width,ub.gb.left-=Fb,ub.gb.right-=Fb),ub.ZK()),ub.itd&&ub.htd());ub.Lt(ub.xN,ub.zN);ub.tableRange=null;ub.Th=-1;ub.Lh&&(ub.Pz=null,ub.An=
0);return!0};ub.k6=function(){ub.Np=!1;ub.An=0;ub.qb.eh(ub.Bh);if(!ub.$.kq([ub.gb],!1))return ub.Lt(ub.j6,ub.k6),ub.Th=-1,!0;if(!(ub.ha.sa.Vc.equals(ub.gb)||ub.gka(ub.gb)||ub.gka(ub.sourceRange)||ub.kzb())){ub.ZK();ub.ha.sourceRange=ub.sourceRange.clone();var Fb=ub.ha.sourceRange,pc=ub.ha.sa.Vc,eb={};ub.$.Fd(-694765314,2,30,(eb[Na.a.Kta]=ub.Zt,eb[Na.a.Z6b]=!0,eb[Na.a.$6b]=ub.zq,eb[Na.a.y3]=Fb,eb[Na.a.x3]=pc,eb[Na.a.nsb]=ub.$t,eb));ub.Zt||(ub.gb.top>ub.sourceRange.top&&(ub.isRow||ub.gb.left===ub.sourceRange.left&&
ub.zq)?(Fb=ub.gb.height,ub.gb.top-=Fb,ub.gb.bottom-=Fb):ub.gb.left>ub.sourceRange.left&&(ub.Ue||ub.gb.top===ub.sourceRange.top&&!ub.zq)&&(Fb=ub.gb.width,ub.gb.left-=Fb,ub.gb.right-=Fb),ub.ZK())}ub.Lt(ub.j6,ub.k6);ub.tableRange=null;ub.Pz=null;ub.Th=-1;ub.zq=!1;ub.itd&&ub.htd();return!0};ub.xN=function(Fb){var pc=Db.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");pc&&(Fb=Va.a(ub.$).Sd(Fb));var eb=Fb.clientPoint;pc||(Fb=Va.a(ub.$).Sd(Fb));ub.Lh&&(ub.xw=Fb);if(Fb=
ub.ha.Kn(eb,Fb.zb,5,void 0,void 0,!0)){if(ub.tableRange.contains(Fb.topLeft)){if(ub.Mcg(Fb,ub.Xx(),eb),ub.gb=ub.G2(Fb),ub.ha.sourceRange=ub.gb,ub.qb.Wi(ub.gb,ub.Bh),ub.qb.qn(ub.Bh),ub.qb.eh(ub.bB()),6!==ub.Th){for(eb=1;4>=eb;eb++)Fb=ub.Hh[eb.toString()],Fb.parentNode.removeChild(Fb),ub.qb.fw(ub.Xx()?11:12,eb).mf.appendChild(Fb);ub.Th=6}}else if(ub.gb=ub.vha(Fb),ub.Lh)ub.gwb(!1);else if(ub.qb.Wi(ub.gb,ub.bB()),ub.qb.qn(ub.bB()),ub.qb.eh(ub.Bh),5!==ub.Th){for(eb=1;4>=eb;eb++)Fb=ub.Hh[eb.toString()],
Fb.parentNode.removeChild(Fb),ub.qb.fw(ub.Gaa(),eb).mf.appendChild(Fb);ub.Th=5}ub.xy()}return!0};ub.j6=function(Fb){var pc=Db.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");pc&&(Fb=Va.a(ub.$).Sd(Fb));var eb=Fb.clientPoint;pc||(Fb=Va.a(ub.$).Sd(Fb));ub.xw=Fb;if(pc=ub.ha.Kn(eb,Fb.zb,5,void 0,void 0,!0)){if(ub.vwb(pc))return ub.gb=ub.vha(pc),ub.fwb(!1),!0;var ic=db.g(ub.$),Ac=ic.gg(pc),lc=ic.Ef(ub.paneType);eb=rb.a.ls(lc.view.Ih,ub.domElement.parentNode,eb,ic.rtl);
lc=!1;var Gc=2;ub.zq=!1;if(ub.isRow||ub.Ue){ub.isRow&&eb.y-Ac.topLeft.y>Ac.height/2?(lc=!0,Gc=1):ub.Ue&&eb.x-Ac.topLeft.x>Ac.width/2&&(lc=!0);if(lc){Fb=ic.pk("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",ic.$G,Gc);try{Fb.Vr(pc),Fb.$$mn(),pc=Fb.$$cu().range}finally{Fb&&Fb.dispose()}}ub.gb=ub.vha(pc)}else{eb.x-Ac.topLeft.x===Ac.width?(ub.zq=!1,lc=!0):eb.y-Ac.topLeft.y>Ac.height/2&&(lc=!0,ub.zq=!0,Gc=1);ub.Pz&&(ub.zq=ub.yq);if(lc){ic=ic.pk("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",
ic.$G,Gc);try{ic.Vr(pc),ic.$$mn(),pc=ic.$$cu().range}finally{ic&&ic.dispose()}}ub.qb.eh(ub.Bh);ub.Bh=ub.zq?[11]:[12];for(ic=1;4>=ic;ic++)(Ac=ub.Hh[ic.toString()])&&Ac.parentNode.removeChild(Ac),ub.Hh[ic.toString()]=null;ub.Mz(Fb.clientPoint,Fb.zb,ub.zq?11:12,!0);ub.gb=ub.G2(pc)}ub.ha.sourceRange=ub.gb;ub.qb.Wi(ub.gb,ub.Bh);ub.qb.qn(ub.Bh);ub.qb.eh(ub.bB());if(6!==ub.Th){for(Fb=1;4>=Fb;Fb++)pc=ub.Hh[Fb.toString()],pc.parentNode.removeChild(pc),ub.qb.fw(ub.isRow||ub.zq?11:12,Fb).mf.appendChild(pc);
ub.Th=6}ub.xy()}return!0};ub.zOa=function(){ub.Lh?ub.Np&&5<=ub.Th&&(ub.tableRange?ub.$t?ub.QA(!0):ub.o$(!0):ub.$t?ub.isRow||ub.Ue?ub.QA(!0):ub.R2(!0):ub.isRow||ub.Ue?ub.R2(!0):ub.QA(!0)):ub.Np&&5<=ub.Th&&(ub.tableRange?(ub.qb.eh(ub.Bh),ub.Lt(ub.xN,ub.zN)):(ub.qb.eh(ub.bB()),ub.Lt(Object(qb.a)(ub,ub.xh,"onPointerMove"),Object(qb.a)(ub,ub.pf,"onPointerUp"))))};ub.tableManager=Pc;ub.tableRange=null;ub.$t=!1;ub.Zt=!1;ub.dMa=!1;ub.ha.wZb(ub.zOa);return ub}function G(wb,rc,Mc,Pc){var Kc=T.call(this,wb,
rc,Mc,Pc)||this;Kc.Bh=null;Kc.isRow=!1;Kc.Ue=!1;Kc.vg=function(){Kc.domElement.classList.remove(F.selecting)};Kc.hp=function(){Kc.domElement.classList.add(F.selecting)};Kc.Rc=function(){if(Kc.$.isEditMode){var ub=Kc.bxc();Kc.Ivc(ub)}};Kc.Hh={};Kc.Np=!1;Kc.ha.t2(Kc.hp);Kc.ha.mY(Kc.vg);Kc.ha.ZD(Kc.Rc);return Kc}function E(wb,rc,Mc,Pc,Kc){var ub=T.call(this,wb,rc,Mc,Kc)||this;ub.jia=P.a.instance.ga(2234);ub.psb=P.a.instance.ga(2235);ub.zna=P.a.instance.ga(2236);ub.TKb=P.a.instance.ga(2237);ub.Bh=null;
ub.Pz=null;ub.zq=!1;ub.isRow=!1;ub.Ue=!1;ub.yq=!1;ub.oM=null;ub.jO=null;ub.wAb=0;ub.An=0;ub.onKeyDown=function(Fb){if(ub.Lh){if(ub.mka(Fb)||Fb.Ca.keyCode===wc.a.vea)return ub.dMa||(nb.KeyInputManager.instance.qa(ta.a.Gd,ub.domElement.ownerDocument.body,ub.onKeyUp),ub.dMa=!0),!ub.Zt&&ub.mka(Fb)&&(db.g(ub.$).ig.zo(E.Fqb),ub.Zt=!0),ub.$t||Fb.Ca.keyCode!==wc.a.vea||(db.g(ub.$).ig.zo(T.w1a),ub.$t=!0,2===ub.An?(ub.QA(!1),ub.oE=0,ub.Bh=ub.yq?[11]:[12],ub.zq=ub.yq,ub.LPa(),ub.yI()):3===ub.An?(ub.R2(!1),ub.oE=
ub.isRow?1:2,ub.RN(),ub.Ay()):1===ub.An&&(ub.o$(!1),ub.RN(),ub.Ay())),!0}else if(!ub.Zt&&(Fb.Ca.keyCode===wc.a.Z7||Qa.a.isMac&&Fb.Ca.keyCode===wc.a.Boa))return nb.KeyInputManager.instance.qa(ta.a.Gd,ub.domElement.ownerDocument.body,ub.onKeyUp),db.g(ub.$).ig.zo(E.Fqb),ub.Zt=!0;return!1};ub.onKeyUp=function(Fb){if(ub.Lh){if(ub.mka(Fb)||Fb.Ca.keyCode===wc.a.vea)return ub.wAb=ub.mka(Fb)?0:1,ub.Np&&db.g(ub.$).ig.zo(T.w1a),Fb.Ca.keyCode===wc.a.vea&&(2===ub.An?(ub.R2(!1),ub.oE=0,ub.RN(!0),ub.Ay(!0)):3===
ub.An?(ub.QA(!1),ub.oE=ub.isRow?1:2,ub.Bh=ub.isRow?[11]:[12],ub.LPa(!0),ub.yI(!0)):1===ub.An&&(ub.QA(!1),ub.Bh=ub.yq?[11]:[12],ub.wza(!0),ub.yI(!0))),ub.soa(ub.wAb),!0}else if(Fb.Ca.keyCode===wc.a.Z7||Qa.a.isMac&&Fb.Ca.keyCode===wc.a.Boa)return ub.soa(),ub.Np&&db.g(ub.$).ig.zo(T.s6c),!0;return!1};ub.zN=function(Fb){Fb=Va.a(ub.$).Sd(Fb);5===ub.Th?ub.vAd(Fb):(ub.Np=!1,ub.qb.eh(ub.Bh),!ub.$.kq([ub.gb],!1)||ub.oGd()||ub.kzb()||(ub.ha.sourceRange=ub.sourceRange.clone(),ub.Lh?ub.PEd():ub.ntb(),ub.Xx()?
ub.gb.top>ub.sourceRange.top&&(Fb=ub.gb.height,ub.gb.top-=Fb,ub.gb.bottom-=Fb):ub.gb.left>ub.sourceRange.left&&(Fb=ub.gb.width,ub.gb.left-=Fb,ub.gb.right-=Fb),ub.ZK()));ub.Lt(ub.xN,ub.zN);ub.tableRange=null;ub.Th=-1;ub.Lh&&(ub.Pz=null,ub.An=0);return!0};ub.k6=function(){ub.Np=!1;ub.An=0;ub.qb.eh(ub.Bh);if(!ub.$.kq([ub.gb],!1))return ub.Lt(ub.j6,ub.k6),ub.Th=-1,!0;if(!(ub.ha.sa.Vc.equals(ub.gb)||ub.gka(ub.gb)||ub.gka(ub.sourceRange)||ub.kzb())){ub.ZK();ub.ha.sourceRange=ub.sourceRange.clone();var Fb=
ub.ha.sourceRange,pc=ub.ha.sa.Vc,eb={};ub.$.Fd(-694765314,2,30,(eb[Na.a.Kta]=ub.Zt,eb[Na.a.Z6b]=!0,eb[Na.a.$6b]=ub.zq,eb[Na.a.y3]=Fb,eb[Na.a.x3]=pc,eb[Na.a.nsb]=ub.$t,eb));ub.Zt||(ub.gb.top>ub.sourceRange.top&&(ub.isRow||ub.gb.left===ub.sourceRange.left&&ub.zq)?(Fb=ub.gb.height,ub.gb.top-=Fb,ub.gb.bottom-=Fb):ub.gb.left>ub.sourceRange.left&&(ub.Ue||ub.gb.top===ub.sourceRange.top&&!ub.zq)&&(Fb=ub.gb.width,ub.gb.left-=Fb,ub.gb.right-=Fb),ub.ZK())}ub.Lt(ub.j6,ub.k6);ub.tableRange=null;ub.Pz=null;ub.Th=
-1;ub.zq=!1;return!0};ub.xN=function(Fb){var pc=Db.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");pc&&(Fb=Va.a(ub.$).Sd(Fb));var eb=Fb.clientPoint;pc||(Fb=Va.a(ub.$).Sd(Fb));ub.Lh&&(ub.xw=Fb);if(Fb=ub.ha.Kn(eb,Fb.zb,5,void 0,void 0,!0)){if(ub.tableRange.contains(Fb.topLeft)){pc=db.g(ub.$);var ic=pc.gg(Fb),Ac=pc.Ef(ub.paneType);eb=rb.a.ls(Ac.view.Ih,ub.domElement.parentNode,eb,pc.rtl);Ac=!1;var lc=2;ub.Xx()&&eb.y-ic.topLeft.y>ic.height/2?(Ac=!0,lc=1):!ub.Xx()&&
eb.x-ic.topLeft.x>ic.width/2&&(Ac=!0);if(Ac){pc=pc.pk("DragSelectionClickBehavior.OnPointerMoveRearrange",pc.$G,lc);try{pc.Vr(Fb),pc.$$mn(),Fb=pc.$$cu().range}finally{pc&&pc.dispose()}}ub.gb=ub.G2(Fb);ub.ha.sourceRange=ub.gb;ub.qb.Wi(ub.gb,ub.Bh);ub.qb.qn(ub.Bh);ub.qb.eh(ub.bB());if(6!==ub.Th){for(Fb=1;4>=Fb;Fb++)pc=ub.Hh[Fb.toString()],pc.parentNode.removeChild(pc),ub.qb.fw(ub.Xx()?11:12,Fb).mf.appendChild(pc);ub.Th=6}}else if(ub.gb=ub.vha(Fb),ub.Lh)ub.gwb(!1);else if(ub.qb.Wi(ub.gb,ub.bB()),ub.qb.qn(ub.bB()),
ub.qb.eh(ub.Bh),5!==ub.Th){for(Fb=1;4>=Fb;Fb++)pc=ub.Hh[Fb.toString()],pc.parentNode.removeChild(pc),ub.qb.fw(ub.Gaa(),Fb).mf.appendChild(pc);ub.Th=5}ub.xy()}return!0};ub.j6=function(Fb){var pc=Db.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");pc&&(Fb=Va.a(ub.$).Sd(Fb));var eb=Fb.clientPoint;pc||(Fb=Va.a(ub.$).Sd(Fb));ub.xw=Fb;if(pc=ub.ha.Kn(eb,Fb.zb,5,void 0,void 0,!0)){if(ub.vwb(pc))return ub.gb=ub.vha(pc),ub.fwb(!1),!0;var ic=db.g(ub.$),Ac=ic.gg(pc),lc=ic.Ef(ub.paneType);
eb=rb.a.ls(lc.view.Ih,ub.domElement.parentNode,eb,ic.rtl);lc=!1;var Gc=2;ub.zq=!1;if(ub.isRow||ub.Ue){ub.isRow&&eb.y-Ac.topLeft.y>Ac.height/2?(lc=!0,Gc=1):ub.Ue&&eb.x-Ac.topLeft.x>Ac.width/2&&(lc=!0);if(lc){Fb=ic.pk("DragSelectionClickBehavior.OnPointerMoveDragInsert",ic.$G,Gc);try{Fb.Vr(pc),Fb.$$mn(),pc=Fb.$$cu().range}finally{Fb&&Fb.dispose()}}ub.gb=ub.vha(pc)}else{eb.x-Ac.topLeft.x===Ac.width?(ub.zq=!1,lc=!0):eb.y-Ac.topLeft.y>Ac.height/2&&(lc=!0,ub.zq=!0,Gc=1);ub.Pz&&(ub.zq=ub.yq);if(lc){ic=ic.pk("DragSelectionClickBehavior.OnPointerMoveDragInsert",
ic.$G,Gc);try{ic.Vr(pc),ic.$$mn(),pc=ic.$$cu().range}finally{ic&&ic.dispose()}}ub.qb.eh(ub.Bh);ub.Bh=ub.zq?[11]:[12];for(ic=1;4>=ic;ic++)(Ac=ub.Hh[ic.toString()])&&Ac.parentNode.removeChild(Ac),ub.Hh[ic.toString()]=null;ub.Mz(Fb.clientPoint,Fb.zb,ub.zq?11:12,!0);ub.gb=ub.G2(pc)}ub.ha.sourceRange=ub.gb;ub.qb.Wi(ub.gb,ub.Bh);ub.qb.qn(ub.Bh);ub.qb.eh(ub.bB());if(6!==ub.Th){for(Fb=1;4>=Fb;Fb++)pc=ub.Hh[Fb.toString()],pc.parentNode.removeChild(pc),ub.qb.fw(ub.isRow||ub.zq?11:12,Fb).mf.appendChild(pc);
ub.Th=6}ub.xy()}return!0};ub.vg=function(){ub.domElement.classList.remove(F.selecting)};ub.hp=function(){ub.domElement.classList.add(F.selecting)};ub.Rc=function(){if(ub.$.isEditMode){var Fb=ub.bxc();ub.Ivc(Fb)}};ub.zOa=function(){ub.Lh?ub.Np&&5<=ub.Th&&(ub.tableRange?ub.$t?ub.QA(!0):ub.o$(!0):ub.$t?ub.isRow||ub.Ue?ub.QA(!0):ub.R2(!0):ub.isRow||ub.Ue?ub.R2(!0):ub.QA(!0)):ub.Np&&5<=ub.Th&&(ub.tableRange?(ub.qb.eh(ub.Bh),ub.Lt(ub.xN,ub.zN)):(ub.qb.eh(ub.bB()),ub.Lt(Object(qb.a)(ub,ub.xh,"onPointerMove"),
Object(qb.a)(ub,ub.pf,"onPointerUp"))))};ub.tableManager=Pc;ub.tableRange=null;ub.Hh={};ub.Np=!1;ub.Zt=!1;ub.$t=!1;ub.dMa=!1;ub.ha.t2(ub.hp);ub.ha.mY(ub.vg);ub.ha.wZb(ub.zOa);ub.ha.ZD(ub.Rc);return ub}function I(wb,rc){this.destinationRange=this.sourceRange=null;this.sourceRange=wb;this.destinationRange=rc}function U(wb,rc,Mc,Pc,Kc,ub,Fb,pc){pc=wb.Na(41,void 0===pc?null:pc);pc.sourceRange=rc;pc.destinationRange=Mc;return Pb.g(wb,"RearrangeRowColumn",pc,Pc,Kc,ub,Fb,0)}function M(wb,rc,Mc,Pc,Kc,ub){var Fb=
T.call(this,wb,rc,Mc,Kc)||this;Fb.RK=null;Fb.Ya=null;Fb.T4e=function(){Fb.rtb(!0)};Fb.gridView=db.g(Fb.$);Fb.Zx=Pc;Fb.coloredReferencesManager=Fb.$.da.za(281);da.ULS.shipAssertTag(537159391,0,!!Fb.coloredReferencesManager,"DragMarqueeClickBehavior Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");wb=ak(Fb.Jr);for(rc=wb.next();!rc.done;rc=wb.next())rc=rc.value,xa.a.instance.qa(ta.a.iW,rc,Object(qb.a)(Fb.Zx,Fb.Zx.d8e,"hoveringStarted")),xa.a.instance.qa(ta.a.my,
rc,Object(qb.a)(Fb.Zx,Fb.Zx.e8e,"hoveringStopped"));Fb.GYa(ub);return Fb}function T(wb,rc,Mc,Pc){var Kc=K.call(this,wb)||this;Kc.oSa=!1;Kc.Bje=null;Kc.Aje=null;Kc.vra=0;Kc.Lh=Db.EwaSettings.getBooleanFeatureGate(dc.a.Y6b,!1);Kc.Dgi=Db.EwaSettings.getBooleanFeatureGate(dc.a.Ehh,!1);Kc.oE=0;Kc.Rdc=0;Kc.wCc=0;Kc.rma=null;Kc.sourceRange=null;Kc.gb=null;Kc.xw=null;Kc.onPointerDown=function(ub){ub=Va.a(Kc.$).Sd(ub);if(2===ub.mb&&ub.Hn===Sys.UI.MouseButton.leftButton&&!Kc.oSa){var Fb=Kc.Pbc(ub);if(!Fb)return da.ULS.shipAssertTag(537159379,
0,!1,"DragSelectionClickBehaviorBase.OnPointerDown: GetSelectedRange failed"),!1;Kc.gb=Fb.clone();Kc.sourceRange=Kc.gb.clone();Kc.rma=Kc.gb;if(Fb=Kc.VRh(ub))Kc.Th=5,Kc.wCc=Fb.top-Kc.sourceRange.top,Kc.Rdc=Fb.left-Kc.sourceRange.left,db.g(Kc.$).ig.zo(Kc.Lh?T.w1a:T.s6c),Kc.Nnc(ub),Kc.oSa=!0,bb.b(Kc.$,!0)}return!1};Kc.Yc=function(ub,Fb){Fb.XM||Kc.Ivc(Kc.$.isEditMode)};Kc.Jr=[];Kc.$=rc;Kc.ha=db.g(Kc.$).ha;Kc.paneType=Mc;Kc.$n=Pc;rc=Db.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");
Mc=Qa.a.yf;rc=ak(Kc.Dgi?rc&&!Mc?[F.ovh,F.bvh,F.gvh,F.kvh]:[F.qvh,F.dvh,F.ivh,F.mvh]:rc&&!Mc?[F.nvh,F.avh,F.fvh,F.jvh]:[F.pvh,F.cvh,F.hvh,F.lvh]);for(Mc=rc.next();!Mc.done;Mc=rc.next())Mc=Kc.$n.ICe(wb,Mc.value,Kc.Lh?[F.evh]:[F.$uh],Kc.onPointerDown),Kc.Jr.push(Mc);Kc.$.Tk(Kc.Yc);Kc.Ivc(Kc.$.isEditMode);return Kc}function F(){}function K(wb){var rc=H.call(this,wb)||this;var Mc=document.createElement("div");Mc.className=gb.a.uvh;wb.appendChild(Mc);return rc}function J(wb,rc,Mc,Pc){return O.call(this,
wb,rc,Mc,Pc)||this}function O(wb,rc,Mc,Pc){var Kc=H.call(this,rc)||this;Kc.Knb=!1;Kc.nWc=!1;Kc.Aqd=!1;Kc.ipb=null;Kc.xqd=!1;Kc.uba=!1;Kc.uw=function(){Kc.Knb&&Kc.xqd?Kc.Ena():Kc.t4()};Kc.sxf=function(Fb){3===Fb.mb&&(Kc.xqd=!0,Kc.Ena());return!1};Kc.txf=function(Fb){if(3===Fb.mb){if(!Fb.zb||Kc.ghi(Fb))return!1;Kc.xqd=!1;Kc.t4()}return!1};Kc.vg=function(){Kc.uba&&Kc.lXd();Kc.Ena();Kc.Aqd=!1};Kc.hp=function(){Kc.t4();Kc.Aqd=!0};Kc.xya=function(Fb,pc){pc.w4===Kc.w4&&(pc.visible?Kc.Aqd||Kc.Ena():Kc.t4())};
Kc.dDf=function(){Kc.uxf(Kc.DO.domElement,!1)};Kc.Ntf=function(){Kc.uxf(Kc.ZL.domElement,!0)};Kc.bnc=function(Fb,pc){Kc.ha.lza(pc)};Kc.cnc=function(Fb,pc){Kc.ha.lza(La.b(pc))};Kc.kEb=function(){3===Ia.a.Cb?Kc.Ena():Kc.t4();Kc.uba&&1===Ia.a.Cb&&Kc.lXd()};Kc.eDf=function(){Kc.soj()};Kc.lJe=function(){Kc.t4()};Kc.fp=function(){Kc.ha.Oa.Yb&&Kc.t4()};Kc.Btf=function(){Kc.t4()};Kc.lxf=function(Fb,pc){Kc.lXd();3===pc.mb?Kc.Ena():Kc.t4()};Kc.Uqc=function(){Kc.Knb&&(Kc.t4(),Kc.Ena())};var ub=Mc.$;Kc.Pq=Mc;
Kc.ha=Mc.ha;Kc.aba=wb;Kc.Rlj=rc;Kc.paneType=Pc;wb=Kc.domElement.currentStyle;rc="#000000";wb&&(rc=wb.borderTopColor);Kc.DO=new N(Kc.P$c(),rc,ub);Kc.ZL=new N(Kc.P$c(),rc,ub);Kc.vef=ub.ea.isNamedObjectViewMode&&1===ub.workbookContext.NovMode;Kc.DO.Hme(Kc.dDf);Kc.DO.Gme(Kc.bnc);Kc.DO.Ime(Kc.cnc);Kc.ZL.Hme(Kc.Ntf);Kc.ZL.Gme(Kc.bnc);Kc.ZL.Ime(Kc.cnc);wb=ak(Kc.gridView.hn);for(rc=wb.next();!rc.done;rc=wb.next())rc=rc.value,ab.a.instance.qa(ta.a.sf,rc.domElement,Kc.txf),ab.a.instance.qa(ta.a.qe,rc.domElement,
Kc.sxf);Mc.view.Gs(Kc.uw);Mc.Wb.Bk(Kc.lJe);Mc.qb.gnb(Kc.xya);Mc.tUc(Kc.Btf);ub.xA(Kc.Uqc);Mc.Ft(Kc.Uqc);Kc.ha.mY(Kc.vg);Kc.ha.t2(Kc.hp);Mc.XD(Kc.fp);Kc.ha.WYb(Kc.lxf);Ia.a.Rme(Kc.kEb);wa.TaskExtensions.Ba(ia.GetServiceTaskFactory.Ra(ub.da,376,377,0),function(Fb){Fb.result.ZGg(Kc.eDf)},ub.la,3);return Kc}function N(wb,rc,Mc){var Pc=yb.call(this,document.createElement("div"))||this;Pc.d5b=null;Pc.NOb=!1;Pc.onPointerDown=function(ub){ub=Va.a(Pc.$)?Va.a(Pc.$).Sd(ub):ub;Pc.NOb=!1;if(3===(Ia.a.Cb=ub.mb)){var Fb=
ub.Ca.rawEvent,pc=Fb.srcElement||Fb.target;la.DOMElementExtensions.nf(Pc.domElement,pc)&&la.DOMElementExtensions.nf(Fb.currentTarget,pc)&&(Pc.NOb=!0,Pc.d5b=ub.clientPoint)}return!1};Pc.pf=function(ub){ub=Va.a(Pc.$)?Va.a(Pc.$).Sd(ub):ub;Pc.raiseEvent("GrPointerUp",ub);return Pc.NOb=!1};Pc.xh=function(ub){ub=Va.a(Pc.$)?Va.a(Pc.$).Sd(ub):ub;3===ub.mb&&Pc.NOb&&Pc.Q4h(ub.clientPoint)&&(Pc.raiseEvent("GrDrag"),Pc.NOb=!1);return!1};Pc.$c=function(ub){Va.a(Pc.$)&&Va.a(Pc.$).Sd(ub);return!0};Pc.$=Mc;Mc=Db.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");
var Kc=Qa.a.yf;Pc.domElement.classList.add(!Mc||Kc?gb.a.PPe:gb.a.OPe);Pc.domElement.classList.add(gb.a.z8b);wb.appendChild(Pc.domElement);la.DOMElementExtensions.setVisible(Pc.domElement,!1);Pc.AKa=document.createElement("div");Pc.AKa.classList.add(gb.a.y8b);Pc.AKa.style.borderColor=rc;Pc.domElement.appendChild(Pc.AKa);xa.a.instance.qa(ta.a.pointerDown,Pc.domElement,Pc.onPointerDown);xa.a.instance.qa(ta.a.Nd,Pc.domElement,Pc.pf);ab.a.instance.qa(ta.a.qe,Pc.domElement,Pc.pf);xa.a.instance.qa(ta.a.hh,
Pc.domElement,Pc.xh);ab.a.instance.qa(ta.a.mg,Pc.domElement,Pc.xh);Ma.a.instance.qa(ta.a.click,Pc.domElement,Pc.$c);return Pc}function H(wb,rc){return va.call(this,wb,void 0===rc?null:rc)||this}function Q(wb){var rc=na.call(this)||this;rc.sof=[3];rc.gridView=wb;rc.RWd=ra.a.pba(rc.gridView.$);return rc}function ca(wb,rc){var Mc=Ea.call(this)||this;Mc.start=wb;Mc.Axb=rc;return Mc}function X(wb){var rc=ha.call(this)||this;rc.$=wb;rc.Eb();return rc}function Z(wb){var rc=fa.call(this)||this;wb.da.Ga(376,
rc);return rc}var ea=b(11),ka=b(0),Y=b(232),qa=b(38),fa=qa.a;Rk(Z,fa);Z.prototype.ZGg=function(wb){this.addHandler("TAF",wb)};Z.prototype.Tcj=function(wb){this.removeHandler("TAF",wb)};Z.prototype.q3i=function(){this.raiseEvent("TAF")};Object(ka.a)(Z,"GridHighlightBehaviorEventManager",qa.a,[595,10]);var ha=Y.a;Rk(X,ha);X.prototype.create=function(){this.pb(this.$.da.za(376)||new Z(this.$))};X.ka=function(wb){wb.da.Ga(377,new X(wb))};Object(ka.a)(X,"GridHighlightBehaviorEventManagerFactory",Y.a,[]);
var ia=b(51),wa=b(37),Qa=b(25),S=b(79),da=b(15),xa=b(245),ta=b(13),ab=b(161),Na=b(5),Ka=b(114),la=b(12),Ea=Sys.EventArgs;Rk(ca,Ea);Object(ka.a)(ca,"MarqueeResizeStartedOrEndedEventArgs",Sys.EventArgs,[]);var ra=b(36),na=qa.a;Rk(Q,na);Q.prototype.yFg=function(wb){this.addHandler("mrek",wb)};Q.prototype.Ew=function(wb,rc,Mc){for(var Pc=ak(this.gridView.hn),Kc=Pc.next();!Kc.done;Kc=Pc.next())xa.a.instance.qa(ta.a.hh,Kc.value.domElement,wb);xa.a.instance.qa(ta.a.Nd,document.documentElement,rc);this.gridView.$b.w7b(!0);
Mc&&xa.a.instance.qa(ta.a.my,this.gridView.Bj,rc)};Q.prototype.hXd=function(wb,rc,Mc){for(var Pc=ak(this.gridView.hn),Kc=Pc.next();!Kc.done;Kc=Pc.next())xa.a.instance.Aa(ta.a.hh,Kc.value.domElement,wb);xa.a.instance.Aa(ta.a.Nd,document.documentElement,rc);this.gridView.$b.w7b(!1);Mc&&xa.a.instance.Aa(ta.a.my,this.gridView.Bj,rc)};Q.prototype.g8i=function(wb,rc){for(var Mc=ak(this.gridView.hn),Pc=Mc.next();!Pc.done;Pc=Mc.next())ab.a.instance.qa(ta.a.mg,Pc.value.domElement,wb);ab.a.instance.qa(ta.a.qe,
document.documentElement,rc)};Q.prototype.bPj=function(wb,rc){for(var Mc=ak(this.gridView.hn),Pc=Mc.next();!Pc.done;Pc=Mc.next())ab.a.instance.Aa(ta.a.mg,Pc.value.domElement,wb);ab.a.instance.Aa(ta.a.qe,document.documentElement,rc)};Q.prototype.ICe=function(wb,rc,Mc,Pc){var Kc=document.createElement("div");Kc.className=rc;rc=ak(Mc);for(Mc=rc.next();!Mc.done;Mc=rc.next())Kc.classList.add(Mc.value);wb.appendChild(Kc);xa.a.instance.qa(ta.a.pointerDown,Kc,Pc);return Kc};Q.prototype.n1e=function(wb){wb=
wb.zb.parentNode;if(!wb)return da.ULS.shipAssertTag(537159394,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: selectedHighlightElement is null."),null;wb=parseInt(wb.getAttribute(Na.a.Axb),10);return isNaN(wb)?(da.ULS.shipAssertTag(537159393,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: indexInMarqueeCollection is not a valid number."),null):this.gridView.qb.fw(3,1,wb)};Q.prototype.xKb=function(wb,rc,Mc){wb=(void 0===Mc?!0:Mc)&&!!this.coloredReferencesManager&&this.coloredReferencesManager.pji(wb);
rc=ak(rc);for(Mc=rc.next();!Mc.done;Mc=rc.next())la.DOMElementExtensions.setVisible(Mc.value,wb)};Q.prototype.Vbd=function(){return this.gridView.sj?Ka.a(this.gridView.$):this.gridView.Wb};Q.prototype.WLf=function(){var wb=this.Vbd();wb&&this.coloredReferencesManager?this.RWd?wb.vI(null):this.coloredReferencesManager.vI(wb,null):(da.ULS.sendTraceTag(537159392,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.qb.eh(this.sof),
this.gridView.qb.Wi(null,this.sof))};Q.prototype.fKf=function(wb,rc){this.raiseEvent("mrek",new ca(wb,rc))};Af.Object.defineProperties(Q.prototype,{coloredReferencesManager:{configurable:!0,enumerable:!0,get:function(){var wb=this.gridView.$.da.za(281);wb||da.ULS.sendTraceTag(537159395,0,50,"BehaviorHelperMethods.ColoredReferencesManager: coloredReferencesManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");
return wb}}});Object(ka.a)(Q,"BehaviorHelperMethods",qa.a,[]);var ba=b(90),sa=b(39),ya=b(87),va=ya.a;Rk(H,va);H.prototype.GYa=function(){};Object(ka.a)(H,"HighlightFlyweightBehavior",ya.a,[]);var W=b(18),La=b(495),Ia=b(76),mb=b(10),fb=b(117),Ma=b(233),Hb=b(43),Kb=b(244),Ub=b(8),gb=b(71),Db=b(1),Va=b(33),yb=Kb.a;Rk(N,yb);N.prototype.Hme=function(wb){this.addHandler("GrDrag",wb)};N.prototype.HPf=function(wb){this.removeHandler("GrDrag",wb)};N.prototype.Gme=function(wb){this.addHandler("GrContxt",wb)};
N.prototype.GPf=function(wb){this.removeHandler("GrContxt",wb)};N.prototype.Ime=function(wb){this.addHandler("GrPointerUp",wb)};N.prototype.IPf=function(wb){this.removeHandler("GrPointerUp",wb)};N.prototype.dispose=function(){Hb.a.Cma(this.domElement);yb.prototype.dispose.call(this)};N.prototype.Tcg=function(wb){this.domElement.parentNode.removeChild(this.domElement);wb.appendChild(this.domElement)};N.prototype.EXf=function(){this.domElement.classList.remove(gb.a.z8b);this.AKa.classList.remove(gb.a.y8b);
this.AKa.classList.add(gb.a.QPe)};N.prototype.lbg=function(){this.AKa.classList.remove(gb.a.QPe);this.AKa.classList.add(gb.a.y8b);this.domElement.classList.add(gb.a.z8b)};N.prototype.Q4h=function(wb){return!!this.d5b&&(3<Math.abs(wb.x-this.d5b.x)||3<Math.abs(wb.y-this.d5b.y))};N.Gub=function(wb){var rc=Db.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest"),Mc=Qa.a.yf;return rc&&!Mc?(wb=Va.a(wb.$)?Va.a(wb.$).zoom:Ub.a.A_,Math.round(9/Math.max(wb,1))):9};N.Yud=0;Object(ka.a)(N,"TouchGrippie",
Kb.a,[]);Rk(O,H);O.prototype.dispose=function(){ba.a.oc([this.DO,this.ZL]);this.DO.HPf(this.dDf);this.DO.GPf(this.bnc);this.DO.IPf(this.cnc);this.ZL.HPf(this.Ntf);this.ZL.GPf(this.bnc);this.ZL.IPf(this.cnc);for(var wb=ak(this.gridView.hn),rc=wb.next();!rc.done;rc=wb.next())rc=rc.value,ab.a.instance.Aa(ta.a.sf,rc.domElement,this.txf),ab.a.instance.Aa(ta.a.qe,rc.domElement,this.sxf);this.gridView.view.Iq(this.uw);this.gridView.Wb.wk(this.lJe);this.gridView.qb.ZHb(this.xya);this.gridView.lId(this.Btf);
this.gridView.$.kD(this.Uqc);this.gridView.Fw(this.Uqc);this.ha.yW(this.vg);this.ha.Q6(this.hp);this.gridView.DF(this.fp);this.ha.nsc(this.lxf);Ia.a.QPf(this.kEb);this.uba&&da.ULS.sendTraceTag(537159314,0,15,"SelectionTouchGrippiesBehaviorBase.Dispose during autofill mode");(wb=this.gridView.$.da.za(376))&&wb.Tcj(this.eDf);H.prototype.dispose.call(this)};O.prototype.JRa=function(){if(!this.aba.range||!this.aba.range.equals(this.Ybb))return!1;var wb=!this.gridView.gMa();return this.gridView.isEditing&&
wb&&(this.Ybb.isRow||this.Ybb.Ue)?!1:this.uba?!0:3===Ia.a.Cb};O.prototype.t4=function(){this.Knb&&(this.DO.set_visible(!1),this.ZL.set_visible(!1),this.Knb=!1)};O.prototype.Ena=function(){if(this.JRa()){this.zSj();var wb=la.DOMElementExtensions.getBoundingClientRect(this.ipb);wb||da.ULS.shipAssertTag(537159313,0,!1,"grippiesParentBounds is null. IsNamedObjectViewMode: {0}, isNov15: {1}, areGrippiesAttachedToNovFocusPane: {2}GridView.ContainerElement: {3}, Freezepanes: {4}",this.gridView.$.ea.isNamedObjectViewMode,
this.vef,this.nWc,this.gridView.Bj,this.gridView.eb.Ni);var rc=la.DOMElementExtensions.getBoundingClientRect(this.Rlj),Mc=new Sys.UI.Bounds(rc.x-wb.x,rc.y-wb.y,rc.width,rc.height),Pc=this.Ybb,Kc=Pc.topLeft,ub=Pc.bottomRight,Fb=Pc.isRow||Pc.Ue;if(Pc.Ue){var pc=this.rAh();Pc=Mc.x-2*N.Gub(this.gridView);var eb=pc;var ic=Mc.x+rc.width}else Pc.isRow?(Pc=ic=this.qAh(),eb=Mc.y-2*N.Gub(this.gridView),pc=Mc.y+rc.height):(eb=Mc.y,pc=Mc.y+rc.height,this.gridView.rtl?(Pc=Mc.x+rc.width,ic=Mc.x):(Pc=Mc.x,ic=Mc.x+
rc.width));rc=N.Yud+(Fb?0:N.Gub(this.gridView));this.DO.style.left=mb.HelperMethods.hc(Pc-rc);this.DO.style.top=mb.HelperMethods.hc(eb-rc);this.ZL.style.left=mb.HelperMethods.hc(ic-rc);this.ZL.style.top=mb.HelperMethods.hc(pc-rc);this.DO.set_visible(this.Vcf(eb,Pc,Kc,Fb,wb));this.ZL.set_visible(this.Vcf(pc,ic,ub,Fb,wb));this.Knb=!0}};O.prototype.Vcf=function(wb,rc,Mc,Pc,Kc){var ub=la.DOMElementExtensions.getBoundingClientRect(this.gridView.Ef(this.paneType).domElement);Kc=new Sys.UI.Bounds(ub.x-Kc.x-
3,ub.y-Kc.y-3,ub.width+6,ub.height+6);return(this.gridView.eb.gj(Mc)===this.paneType||Pc)&&sa.a.UM(Kc,new Sys.UI.Point(rc,wb))};O.prototype.zSj=function(){if(this.vef!==this.nWc){this.ipb=null;var wb=this.P$c();this.DO.Tcg(wb);this.ZL.Tcg(wb)}};O.prototype.rAh=function(){return(this.gridView.view.visibleArea.height+this.gridView.eb.height+N.Yud-N.Gub(this.gridView))/2};O.prototype.qAh=function(){return(this.gridView.view.visibleArea.width+this.gridView.eb.width+N.Yud-N.Gub(this.gridView))/2};O.prototype.qBf=
function(){this.Ena()};O.prototype.ghi=function(wb){return la.DOMElementExtensions.Obb(wb.zb,W.a.No)&&(this.hii(wb)||this.iii(wb))};O.prototype.iii=function(wb){if(this.gridView.rtl)wb=wb.clientPoint.x;else{var rc=la.DOMElementExtensions.getBoundingClientRect(wb.zb);wb=wb.clientPoint.x-(rc.x+rc.width-fb.a.gv)}return 0<wb&&wb<=fb.a.gv};O.prototype.hii=function(wb){var rc=la.DOMElementExtensions.getBoundingClientRect(wb.zb);wb=wb.clientPoint.y-(rc.y+rc.height-fb.a.gv);return 0<wb&&wb<=fb.a.gv};O.prototype.uxf=
function(wb,rc){this.uba&&da.ULS.sendTraceTag(537159312,0,50,"SelectionTouchGrippiesBehaviorBase: Performing Touch Autofill");this.ha.FZc(wb,rc,this.uba);this.t4()};O.prototype.soj=function(){this.uba||(da.ULS.sendTraceTag(537159311,0,50,"SelectionTouchGrippiesBehaviorBase.SetAutoFillMode"),this.uba=!0,this.DO.EXf(),this.ZL.EXf(),this.gridView.ha.sourceRange=this.gridView.ha.sa.Vc,this.Ena())};O.prototype.lXd=function(){this.uba&&(da.ULS.sendTraceTag(537159310,0,50,"SelectionTouchGrippiesBehaviorBase.UnsetAutoFillMode"),
this.uba=!1,this.DO.lbg(),this.ZL.lbg())};O.prototype.P$c=function(){this.ipb||(this.nWc=!1,this.ipb=this.gridView.Bj);return this.ipb};Af.Object.defineProperties(O.prototype,{gridView:{configurable:!0,enumerable:!0,get:function(){return this.Pq}}});Object(ka.a)(O,"SelectionTouchGrippiesBehaviorBase",H,[]);Rk(J,O);J.prototype.JRa=function(){var wb=this.gridView.xi||this.gridView.isEditing;return!this.gridView.ha.sa.tg&&!wb&&O.prototype.JRa.call(this)};Af.Object.defineProperties(J.prototype,{w4:{configurable:!0,
enumerable:!0,get:function(){return 19}},Ybb:{configurable:!0,enumerable:!0,get:function(){return this.gridView.ha.sa.activeRange}}});Object(ka.a)(J,"DiscontinuousSelectionTouchGrippiesBehavior",O,[]);var qb=b(83),dc=b(328);Rk(K,H);Object(ka.a)(K,"SelectionBorderBehavior",H,[]);F.$uh="ewr-selection-draghandle";F.evh="ewr-selection-draghandle-grab";F.pvh="ewr-selection-draghandle-top-ie";F.qvh="ewr-selection-draghandle-top-ie-enhanced";F.nvh="ewr-selection-draghandle-top";F.ovh="ewr-selection-draghandle-top-enhanced";
F.cvh="ewr-selection-draghandle-bottom-ie";F.dvh="ewr-selection-draghandle-bottom-ie-enhanced";F.avh="ewr-selection-draghandle-bottom";F.bvh="ewr-selection-draghandle-bottom-enhanced";F.hvh="ewr-selection-draghandle-left-ie";F.ivh="ewr-selection-draghandle-left-ie-enhanced";F.fvh="ewr-selection-draghandle-left";F.gvh="ewr-selection-draghandle-left-enhanced";F.lvh="ewr-selection-draghandle-right-ie";F.mvh="ewr-selection-draghandle-right-ie-enhanced";F.jvh="ewr-selection-draghandle-right";F.kvh="ewr-selection-draghandle-right-enhanced";
F.XPe="ewr-selection-dragtooltip";F.YPe="ewr-selection-dragtooltip-updated";F.Bvh="ewr_selection_rearrangeleft";F.Cvh="ewr_selection_rearrangeright";F.Dvh="ewr_selection_rearrangetop";F.Avh="ewr_selection_rearrangebottom";F.selecting="selecting";F.Evh="ewr-selection-resizemarqueehandle";F.Hvh="ewr-selection-resizemarqueehandle-topleft";F.Ivh="ewr-selection-resizemarqueehandle-topright";F.Fvh="ewr-selection-resizemarqueehandle-bottomleft";F.Gvh="ewr-selection-resizemarqueehandle-bottomright";F.Quh=
"ewr-marquee-thick";F.Uuh="ewr-resizemarqueehandle-thick";Object(ka.a)(F,"CssClassNames",null,[]);var bb=b(246),db=b(21);Rk(T,K);T.prototype.dispose=function(){var wb=this;this.Jr.forEach(function(rc){xa.a.instance.Aa(ta.a.pointerDown,rc,wb.onPointerDown)});Array.clear(this.Jr);this.rma=this.sourceRange=this.gb=null;da.ULS.sendTraceTag(537159381,0,50,"DragSelectionClickBehaviorBase.Dispose: ActiveRegistrationCount = {0}, EwaControl is null : {1}",this.vra,!this.$);this.$&&(this.$.ol(this.Yc),1===
this.vra&&(da.ULS.sendTraceTag(537159380,0,15,"DragSelectionClickBehaviorBase.Dispose: Some handlers are still registered"),this.Lt(this.Aje,this.Bje,!1)));K.prototype.dispose.call(this)};T.prototype.pf=function(wb){wb=Va.a(this.$).Sd(wb);return this.vAd(wb)};T.prototype.vAd=function(wb){if(5!==this.Th)return!1;(wb=this.uya(wb))||this.rtb(!1);bb.b(this.$,!1);return wb};T.prototype.xh=function(wb){wb=Va.a(this.$).Sd(wb);if(this.Lh&&this.Pnc(wb))return!0;if(wb=this.ha.Kn(wb.clientPoint,wb.zb,5,void 0,
void 0,!0)){wb=this.vha(wb);if(this.gb.equals(wb))return!0;this.gb=wb;if(!this.Ay())return da.ULS.shipAssertTag(537159378,0,!1,"DragSelectionClickBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.rtb(!0),!1}return!0};T.prototype.Ew=function(wb,rc){da.ULS.shipAssertTag(537159377,0,!this.vra,"DragSelectionClickBehaviorBase.RegisterHandlersForMouse: More than one active registration is not expected");this.vra+=1;this.Aje=wb;this.Bje=rc;this.$n.Ew(wb,rc,this.oAc())};T.prototype.vha=function(wb){if(!wb||
!this.gb)return da.ULS.shipAssertTag(537159376,0,!!wb,"DragSelectionClickBehaviorBase.CalculateDragRange: mouseSelectionRange is null"),da.ULS.shipAssertTag(537159375,0,!!this.gb,"DragSelectionClickBehaviorBase.CalculateDragRange: CurrentRange is null"),null;var rc=this.gb.clone();1!==this.oE&&(rc.left=Math.max(wb.left-this.Rdc,1),rc.right=rc.left+this.sourceRange.width-1);2!==this.oE&&(rc.top=Math.max(wb.top-this.wCc,1),rc.bottom=rc.top+this.sourceRange.height-1);return this.HYa(rc)};T.prototype.Lt=
function(wb,rc,Mc,Pc){Mc=void 0===Mc?!0:Mc;Pc=void 0===Pc?!0:Pc;da.ULS.shipAssertTag(537159374,0,1===this.vra,"DragSelectionClickBehaviorBase.CleanUp: Expected exactly one active registration");--this.vra;this.Lh||db.g(this.$).ig.zo(Na.a.m4);this.$n.hXd(wb,rc,this.oAc());Mc&&this.Kpb(Pc);this.oE=0;this.oSa=!1};T.prototype.HYa=function(wb){var rc=db.g(this.$),Mc=wb;if(rc.eb.p4){if(!rc.Ub(wb.topLeft)){rc=rc.pk("DragSelectionClickBehaviorBase.AdjustHiddenRowColumns",rc.$G,this.rma.top!==wb.top?1:2);
try{rc.Vk=this.rma.top<wb.top||this.rma.left<wb.left,rc.Vr(wb.topLeft),Mc=rc.$$cu().range}finally{rc&&rc.dispose()}}Mc.right=Mc.left+wb.width-1;Mc.bottom=Mc.top+wb.height-1}return this.rma=Mc};T.prototype.Ivc=function(wb){this.Jr.forEach(function(rc){la.DOMElementExtensions.setVisible(rc,wb)})};T.prototype.VRh=function(wb){var rc=wb.zb;wb=wb.clientPoint;if(!rc||!wb)return da.ULS.shipAssertTag(537159373,0,!!rc,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: source is null"),da.ULS.shipAssertTag(537159372,
0,!!wb,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: point is null"),null;wb.y+=rc===this.Jr[T.rIa]?2:rc===this.Jr[T.w6c]?-2:0;wb.x+=rc===this.Jr[T.x6c]?2:rc===this.Jr[T.qIa]?-2:0;return this.ha.Kn(wb,rc,5,void 0,void 0,!0)};Af.Object.defineProperties(T.prototype,{qb:{configurable:!0,enumerable:!0,get:function(){return db.g(this.$).qb}},Th:{configurable:!0,enumerable:!0,get:function(){return this.ha.selectionType},set:function(wb){this.ha.selectionType=wb}}});T.s6c="move";T.w1a="grabbing";
T.rIa=0;T.w6c=1;T.x6c=2;T.qIa=3;Object(ka.a)(T,"DragSelectionClickBehaviorBase",K,[]);Rk(M,T);M.prototype.GYa=function(wb){this.$n.xKb(wb,this.Jr);this.Zx.Lza()};M.prototype.Nnc=function(wb){da.ULS.sendTraceTag(537159390,0,50,"DragMarqueeClickBehavior.OnPointerDownInternal: Starting drag marquee operation.");this.gridView.kLa=!0;this.Ya.gE(!1);this.Th=5;this.Zx.PIe(wb.zb);this.Ya.textBox.removeSelection();this.Ya.gZb(this.T4e);this.Ew(Object(qb.a)(this,this.xh,"onPointerMove"),Object(qb.a)(this,this.pf,
"onPointerUp"));this.oE=this.sourceRange.isRow?1:this.sourceRange.Ue?2:0};M.prototype.uya=function(){var wb=this.ZK();this.Th=-1;this.Lt(Object(qb.a)(this,this.xh,"onPointerMove"),Object(qb.a)(this,this.pf,"onPointerUp"));return wb};M.prototype.Kpb=function(){this.gridView.kLa=!1;this.Zx.QIe(this.Jr[0]);this.Ya.textBox.setCaretPositionToEnd();this.Ya.ysc(this.T4e);this.$n.WLf()};M.prototype.rtb=function(wb){da.ULS.sendTraceTag(537159389,0,10,"DragMarqueeClickBehavior.FailureFallback: Operation failed, will try to recalculate colored references as a fallback in CleanUp.");
wb&&this.Lt(Object(qb.a)(this,this.xh,"onPointerMove"),Object(qb.a)(this,this.pf,"onPointerUp"))};M.prototype.Pbc=function(wb){this.Ya=this.$n.Vbd();this.RK=this.$n.n1e(wb);return this.Ya&&this.RK&&this.RK.range?this.RK.range:(da.ULS.shipAssertTag(537159388,0,!!this.Ya,"DragMarqueeClickBehavior.GetSelectedRange: cellContentEditor is null"),da.ULS.shipAssertTag(537159387,0,!!this.RK,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState is null"),da.ULS.shipAssertTag(537159386,0,!!this.RK.range,
"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState.Range is null"),null)};M.prototype.ZK=function(){return this.RK?this.coloredReferencesManager.bqf(this.Ya,this.RK,this.gb):(da.ULS.shipAssertTag(537159385,0,!1,"DragMarqueeClickBehavior.SetSelectedRange called when selectedHighlightState is null. It shouldn't be null while dragging a marquee highlight."),!1)};M.prototype.Ay=function(){return this.ZK()};M.prototype.oAc=function(){return!0};M.prototype.Pnc=function(){return!1};Object(ka.a)(M,
"DragMarqueeClickBehavior",T,[]);var wc=b(86),nb=b(109),zb=b(178),ma=b(440),P=b(14),oa=b(234),Ja=b(24),$a=b(974),Ta=b(45),pa=b(564),Da=b(177),rb=b(917),Ab=b(121),ob=b(29),sb=b(295),Pb=b(61);Object(ka.a)(I,"MacroRecorderTableRowColumnRearrangedPayload",null,[409]);var Aa=b(42);Rk(E,T);E.prototype.dispose=function(){this.ha&&(this.ha.Q6(this.hp),this.ha.yW(this.vg),this.ha.RId(this.zOa),this.ha.bI(this.Rc));if(this.Hh)for(var wb=1;4>=wb;wb++)la.DOMElementExtensions.gf(this.Hh[wb.toString()]);this.Hh=
this.Bh=null;this.Zt&&this.soa();this.Lh&&this.$t&&this.soa(1);T.prototype.dispose.call(this)};E.prototype.Nnc=function(wb){this.Lh&&(this.xw=wb,this.Pz=null,this.yq=this.isRow=this.Ue=this.zq=!1,nb.KeyInputManager.instance.qa(ta.a.Lb,this.domElement.ownerDocument.body,this.onKeyDown));this.Np=!0;this.tableRange=this.ZYc(this.tableManager.Xm(this.sourceRange.topLeft));db.g(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.Lh?(this.Pz=this.tableRange,this.An=1,this.Bh=(this.yq=
this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.Th=6,this.Ew(this.xN,this.zN),this.oM=this.jia,this.jO=this.zna,this.Mz(wb.clientPoint,wb.zb,this.yq?11:12,!0,!0),this.yI(!0)):(this.Bh=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.Th=6,this.Ew(this.xN,this.zN),this.Mz(wb.clientPoint,wb.zb,this.isRow?11:12,!0)):(this.tableRange=null,this.Lh?(this.isRow=this.sourceRange.isRow,
this.Ue=this.sourceRange.Ue,this.isRow||this.Ue?(this.An=3,this.oE=this.isRow?1:2,this.Th=6,this.Bh=this.isRow?[11]:[12],this.Ew(this.j6,this.k6),this.oM=this.jia,this.jO=this.zna,this.Mz(wb.clientPoint,wb.zb,this.isRow?11:12,!0,!0),this.yI(!0)):(this.An=2,this.oE=0,this.Ew(Object(qb.a)(this,this.xh,"onPointerMove"),Object(qb.a)(this,this.pf,"onPointerUp")),this.oM=this.psb,this.jO=this.TKb,this.Mz(wb.clientPoint,wb.zb,this.Gaa(),!1,!0),this.Ay(!0))):(this.Ew(Object(qb.a)(this,this.xh,"onPointerMove"),
Object(qb.a)(this,this.pf,"onPointerUp")),nb.KeyInputManager.instance.qa(ta.a.Lb,this.domElement.ownerDocument.body,this.onKeyDown),this.oE=this.sourceRange.isRow?1:this.sourceRange.Ue?2:0,this.Mz(wb.clientPoint,wb.zb,this.Gaa(),!1),this.Ay()))};E.prototype.uya=function(){this.Np=!1;this.Lh&&(this.An=0);this.qb.eh(this.bB());if(!this.$.kq([this.gb],!1))return this.Lt(Object(qb.a)(this,this.xh,"onPointerMove"),Object(qb.a)(this,this.pf,"onPointerUp")),this.Th=-1,!0;if(this.ha.sa.Vc.equals(this.gb)||
this.gka(this.gb)||this.gka(this.sourceRange))this.Th=-1;else{this.ZK();this.ha.sourceRange=this.sourceRange.clone();var wb=this.ha.sourceRange,rc=this.ha.sa.Vc;if(this.Lh){var Mc={};this.$.Fd(-694765314,2,30,(Mc[Na.a.Kta]=this.Zt,Mc[Na.a.y3]=wb,Mc[Na.a.x3]=rc,Mc[Na.a.nsb]=this.$t,Mc))}else Mc={},this.$.Fd(-694765314,2,30,(Mc[Na.a.Kta]=this.Zt,Mc[Na.a.y3]=wb,Mc[Na.a.x3]=rc,Mc))}!this.Lh&&this.tableRange||this.Lt(Object(qb.a)(this,this.xh,"onPointerMove"),Object(qb.a)(this,this.pf,"onPointerUp"));
return!0};E.prototype.Kpb=function(wb){wb&&(nb.KeyInputManager.instance.Aa(ta.a.Lb,this.domElement.ownerDocument.body,this.onKeyDown),this.Lh&&db.g(this.$).ig.zo(Na.a.m4),this.Np=!1);for(wb=1;4>=wb;wb++){var rc=this.Hh[wb.toString()];rc&&rc.parentNode.removeChild(rc);this.Hh[wb.toString()]=null}this.Bh=null};E.prototype.Pnc=function(wb){var rc=this.ha.Kn(wb.clientPoint,wb.zb,5,void 0,void 0,!0);this.xw=wb;return this.vwb(rc)?(this.gb=this.G2(rc),this.fwb(!0),!0):this.bid(rc)?(this.gb=this.vha(rc),
this.gwb(!0),!0):!1};E.prototype.vwb=function(wb){return!!this.Pz&&1!==this.An&&!!wb&&this.Pz.contains(wb.topLeft)};E.prototype.bid=function(wb){return!!this.Pz&&1===this.An&&!!wb&&!this.Pz.contains(wb.topLeft)};E.prototype.fwb=function(wb){this.tableRange=this.Pz;this.An=1;var rc=!this.$t;wb?(this.QA(!1),this.Bh=this.yq?[11]:[12],this.wza(rc),this.yI(rc)):(this.R2(!1),this.RN(rc),this.Ay(rc))};E.prototype.gwb=function(wb){this.tableRange=null;this.An=2;var rc=!this.$t;wb?(this.QA(!1),this.Bh=this.yq?
[11]:[12],this.zq=this.yq,this.LPa(rc),this.yI(rc)):(this.o$(!1),this.RN(rc),this.Ay(rc))};E.prototype.Pbc=function(){return this.ha.sa.Vc};E.prototype.ZK=function(){this.ha.updateSelection(this.gb,this.gb.topLeft,0);return!0};E.prototype.Ay=function(wb){wb=void 0===wb?!1:wb;this.qb.Wi(this.gb,this.bB());this.qb.qn(this.bB());this.xy(wb);return!0};E.prototype.yI=function(wb){wb=void 0===wb?!1:wb;this.qb.Wi(this.gb,this.Bh);this.qb.qn(this.Bh);this.xy(wb)};E.prototype.rtb=function(){da.ULS.sendTraceTag(537159384,
0,15,"DragSelectionClickBehavior.FailureFallback: this function was not implemented for dragging selection")};E.prototype.oAc=function(){return!1};E.prototype.bxc=function(){if(!db.g(this.$).ha.sa.tg)return!1;var wb=db.g(this.$).getRangeInformation(this.ha.sa.Vc);wb=ak(wb);for(var rc=wb.next();!rc.done;rc=wb.next())if(Object(ma.a)(oa.PivotTableRange,rc.value))return!1;return!0};E.prototype.ZYc=function(wb){if(wb&&wb.contains(this.sourceRange)&&!wb.equals(this.sourceRange)){if(wb.Yaa&&this.sourceRange.bottom===
this.sourceRange.top&&this.sourceRange.top===wb.top){var rc=new Ja.Range(this.sourceRange.top,this.sourceRange.left,wb.bottom,this.sourceRange.right,!1,!1);if(!rc.equals(wb))return this.sourceRange=rc,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),wb}this.Lh?this.yq=wb.left===this.sourceRange.left&&wb.right===this.sourceRange.right:this.isRow=wb.left===this.sourceRange.left&&wb.right===this.sourceRange.right;if(wb.top===this.sourceRange.top&&wb.bottom===this.sourceRange.bottom||
this.Xx())return wb}return null};E.prototype.G2=function(wb){var rc=wb.clone();this.Xx()?rc.left=Math.max(wb.left-this.Rdc,1):rc.top=Math.max(wb.top-this.wCc,1);rc.right=rc.left+this.sourceRange.width-1;rc.bottom=rc.top+this.sourceRange.height-1;return this.HYa(rc)};E.prototype.kzb=function(){var wb=this.gb.topLeft.xd(this.sourceRange);return wb||this.Lh&&!this.tableRange?wb:this.Xx()?this.gb.top===this.sourceRange.bottom+1:this.gb.left===this.sourceRange.right+1};E.prototype.oGd=function(){if(this.Xx()&&
this.gb.left!==this.tableRange.left||!this.Xx()&&this.gb.top!==this.tableRange.top){var wb=ob.a.Wc(1,1,0,910,0,2065438552,"RearrangeInvalidDest");Aa.a(this.$).qr([wb]);return!0}return!1};E.prototype.PEd=function(){var wb=this,rc=this.$.Fb.sc("UserAction","RearrangeRowColumnClientSide"),Mc={},Pc=(Mc.CopyPasteTargetType=1,Mc.OperationId=zb.a.create().toString(),Mc.Stopwatch=rc,Mc.DragDropIsShiftKeyDown=this.$t,Mc.EncounteredDeploymentErrors=!1,Mc),Kc=this.Zt?2:1,ub=this.$.da.za(254);(new Promise(function(Fb,
pc){wb.ntb(function(eb){eb.Errors&&0<eb.Errors.length?pc(new $a.a(22,eb.Errors)):Fb(!0)},function(eb){eb=Ab.a.Of(eb.data);pc(new $a.a(22,eb))})})).then(function(){da.ULS.sendTraceTag(537159383,0,50,'DragSelectionClickBehavior.RearrangeRowColumn: success. copyPasteTargetType="{0}"',1);ub&&ub.Jlf(Pc,Kc,wb.sourceRange,wb.gb);return Promise.resolve(!0)},function(Fb){da.ULS.sendTraceTag(537159382,0,10,'DragSelectionClickBehavior.RearrangeRowColumn: {0}, copyPasteTargetType="{1}"',Fb?copyPasteInfra.getStringifiedError(Fb):
"null",1);return ub?ub.AAf(Fb,Pc,Kc,wb.sourceRange,wb.gb):Promise.reject(Fb)})};E.prototype.ntb=function(wb,rc){function Mc(){return new I(Fb,ub)}function Pc(pc,eb,ic){return U(Kc.$.oa.xa,Fb,ub,wb?sb.b(pc,wb):pc,rc?sb.a(eb,rc):eb,ic,null)}var Kc=this;wb=void 0===wb?null:wb;rc=void 0===rc?null:rc;var ub={};this.Xx()?(ub.FirstRow=this.gb.top-1,ub.FirstColumn=0,ub.DeltaColumn=0,ub.DeltaRow=this.gb.bottom-this.gb.top+1):(ub.FirstRow=0,ub.FirstColumn=this.gb.left-1,ub.DeltaColumn=this.gb.right-this.gb.left+
1,ub.DeltaRow=0);ub.LastRow=Ub.a.$x;ub.LastColumn=Ub.a.Xu;ub.SheetName=this.$.va.pa?this.$.va.pa.name:this.$.vb.getItemByName(this.$.vb.pa.name).sheetName;var Fb=Ta.v(this.sourceRange,this.$);Db.EwaSettings.Zb()?this.$.userOperationManager.Sb(new Da.a(514,0,Pc,64,Mc),null):this.$.userOperationManager.Sb(new pa.a(514,0,Pc,void 0,Mc),null)};E.prototype.gka=function(wb){wb=db.g(this.$).getRangeInformation(wb);for(var rc=0,Mc=wb.length;rc<Mc;++rc)if(Object(ma.a)(oa.PivotTableRange,wb[rc]))return wb=ob.a.Wc(1,
0,0,898,0,2105176604,"InsDelCellsPivotTable"),Aa.a(this.$).qr([wb]),!0;return!1};E.prototype.Mz=function(wb,rc,Mc,Pc,Kc){Kc=void 0===Kc?!1:Kc;var ub=la.DOMElementExtensions.getBoundingClientRect(rc),Fb=rc===this.Jr[T.rIa]||rc===this.Jr[T.w6c];if(this.Lh){var pc=rc===this.Jr[T.x6c]||rc===this.Jr[T.qIa];this.isRow&&pc||this.Ue&&Fb?pc="100px":(Fb=this.isRow||Fb,pc=(Fb?Kc?E.DVd:E.JVd:Kc?E.CVd:E.GVd)+"px");rc=Fb?rc===this.Jr[T.rIa]?"top":"bottom":rc===this.Jr[T.qIa]?"right":"left";wb=100*(Fb?wb.x-ub.x:
wb.y-ub.y)/(Fb?ub.width:ub.height);for(ub=1;4>=ub;ub++){Pc=document.createElement("div");var eb=document.createElement("div"),ic=document.createElement("div");Pc.appendChild(eb);Pc.appendChild(ic);Kc&&(eb=document.createElement("div"),Pc.appendChild(eb),ic.style.fontWeight="bold");Pc.className=F.YPe;this.Hh[ub.toString()]=Pc;this.qb.fw(Mc,ub).mf.appendChild(Pc);Pc=this.Hh[ub.toString()];Pc.style[rc]=pc;Pc.style[Fb?"left":"top"]=wb+"%"}}else for(Kc=(Fb?-E.IVd:-E.FVd)+"px",pc=Fb?rc===this.Jr[T.rIa]?
"top":"bottom":rc===this.Jr[T.qIa]||Pc?"right":"left",rc=100*(Fb?Pc?0:wb.x-ub.x:wb.y-ub.y)/(Fb?ub.width:ub.height),wb=1;4>=wb;wb++)ub=document.createElement("div"),ub.className=F.XPe,this.Hh[wb.toString()]=ub,this.qb.fw(Mc,wb).mf.appendChild(ub),ub=this.Hh[wb.toString()],ub.style[pc]=Kc,ub.style[Fb?"left":"top"]=rc+"%"};E.prototype.xy=function(wb){wb=void 0===wb?!1:wb;var rc=this.gb.toString();if(this.Lh)for(var Mc=1;4>=Mc;Mc++)this.Hh[Mc.toString()].childNodes[0].innerText=rc,this.Hh[Mc.toString()].childNodes[1].innerText=
this.oM,wb&&(this.Hh[Mc.toString()].childNodes[2].innerText=this.jO);else for(wb=1;4>=wb;wb++)this.Hh[wb.toString()].innerText=rc};E.prototype.soa=function(wb){wb=void 0===wb?0:wb;0===wb?this.Zt=!1:1===wb&&(this.$t=!1);this.Lh&&(this.Zt||this.$t)||(nb.KeyInputManager.instance.Aa(ta.a.Gd,this.domElement.ownerDocument.body,this.onKeyUp),this.dMa=!1)};E.prototype.QA=function(wb){this.qb.eh(this.bB());this.Lt(Object(qb.a)(this,this.xh,"onPointerMove"),Object(qb.a)(this,this.pf,"onPointerUp"),void 0,wb)};
E.prototype.R2=function(wb){this.qb.eh(this.Bh);this.Lt(this.j6,this.k6,void 0,wb)};E.prototype.o$=function(wb){this.qb.eh(this.Bh);this.Lt(this.xN,this.zN,void 0,wb)};E.prototype.RN=function(wb){wb=void 0===wb?!1:wb;this.Th=5;this.Ew(Object(qb.a)(this,this.xh,"onPointerMove"),Object(qb.a)(this,this.pf,"onPointerUp"));this.oM=this.psb;this.jO=this.TKb;this.Mz(this.xw.clientPoint,this.xw.zb,this.Gaa(),!1,wb)};E.prototype.LPa=function(wb){wb=void 0===wb?!1:wb;this.Th=6;this.Ew(this.j6,this.k6);this.oM=
this.jia;this.jO=this.zna;this.Mz(this.xw.clientPoint,this.xw.zb,this.isRow||this.yq?11:12,!0,wb)};E.prototype.wza=function(wb){wb=void 0===wb?!1:wb;this.Th=6;this.Ew(this.xN,this.zN);this.oM=this.jia;this.jO=this.zna;this.Mz(this.xw.clientPoint,this.xw.zb,this.Xx()?11:12,!0,wb)};E.prototype.mka=function(wb){return wb.Ca.keyCode===wc.a.Z7||Qa.a.isMac&&wb.Ca.keyCode===wc.a.Boa};E.prototype.Xx=function(){return!this.Lh&&this.isRow||this.Lh&&this.yq};E.prototype.Gaa=function(){return this.Lh?47:6};E.prototype.bB=
function(){return this.Lh?E.u6c:E.y6c};E.FVd=50;E.IVd=25;E.GVd=-85;E.JVd=-40;E.CVd=-120;E.DVd=-50;E.Fqb="copy";E.y6c=[6];E.u6c=[47];Object(ka.a)(E,"DragSelectionClickBehavior",T,[]);var Ya=b(84);Rk(G,T);G.prototype.dispose=function(){this.ha&&(this.ha.Q6(this.hp),this.ha.yW(this.vg),this.ha.RId(this.zOa),this.ha.bI(this.Rc));if(this.Hh)for(var wb=1;4>=wb;wb++)la.DOMElementExtensions.gf(this.Hh[wb.toString()]);this.Hh=this.Bh=null;T.prototype.dispose.call(this)};G.prototype.Kpb=function(wb){wb&&(this.Lh&&
db.g(this.$).ig.zo(Na.a.m4),this.Np=!1);for(wb=1;4>=wb;wb++){var rc=this.Hh[wb.toString()];rc&&rc.parentNode.removeChild(rc);this.Hh[wb.toString()]=null}this.Bh=null};G.prototype.Pbc=function(){return this.ha.sa.Vc};G.prototype.ZK=function(){this.ha.updateSelection(this.gb,this.gb.topLeft,0);return!0};G.prototype.Ay=function(wb){wb=void 0===wb?!1:wb;this.qb.Wi(this.gb,this.bB());this.qb.qn(this.bB());this.xy(wb);return!0};G.prototype.yI=function(wb){wb=void 0===wb?!1:wb;this.qb.Wi(this.gb,this.Bh);
this.qb.qn(this.Bh);this.xy(wb)};G.prototype.rtb=function(){da.ULS.sendTraceTag(523638490,0,15,"DragSelectionClickBehaviorTemporary.FailureFallback: this function was not implemented for dragging selection")};G.prototype.oAc=function(){return!1};G.prototype.Mz=function(wb,rc,Mc,Pc,Kc){Kc=void 0===Kc?!1:Kc;var ub=la.DOMElementExtensions.getBoundingClientRect(rc),Fb=rc===this.Jr[T.rIa]||rc===this.Jr[T.w6c];if(this.Lh){var pc=rc===this.Jr[T.x6c]||rc===this.Jr[T.qIa];this.isRow&&pc||this.Ue&&Fb?pc="100px":
(Fb=this.isRow||Fb,pc=(Fb?Kc?G.DVd:G.JVd:Kc?G.CVd:G.GVd)+"px");rc=Fb?rc===this.Jr[T.rIa]?"top":"bottom":rc===this.Jr[T.qIa]?"right":"left";wb=100*(Fb?wb.x-ub.x:wb.y-ub.y)/(Fb?ub.width:ub.height);for(ub=1;4>=ub;ub++){Pc=document.createElement("div");var eb=document.createElement("div"),ic=document.createElement("div");Pc.appendChild(eb);Pc.appendChild(ic);Kc&&(eb=document.createElement("div"),Pc.appendChild(eb),ic.style.fontWeight="bold");Pc.className=F.YPe;this.Hh[ub.toString()]=Pc;this.qb.fw(Mc,
ub).mf.appendChild(Pc);Pc=this.Hh[ub.toString()];Pc.style[rc]=pc;Pc.style[Fb?"left":"top"]=wb+"%"}}else for(Kc=(Fb?-G.IVd:-G.FVd)+"px",pc=Fb?rc===this.Jr[T.rIa]?"top":"bottom":rc===this.Jr[T.qIa]||Pc?"right":"left",rc=100*(Fb?Pc?0:wb.x-ub.x:wb.y-ub.y)/(Fb?ub.width:ub.height),wb=1;4>=wb;wb++)ub=document.createElement("div"),ub.className=F.XPe,this.Hh[wb.toString()]=ub,this.qb.fw(Mc,wb).mf.appendChild(ub),ub=this.Hh[wb.toString()],ub.style[pc]=Kc,ub.style[Fb?"left":"top"]=rc+"%"};G.prototype.Mcg=function(wb,
rc,Mc){var Pc=db.g(this.$),Kc=Pc.gg(wb),ub=Pc.Ef(this.paneType);Mc=rb.a.ls(ub.view.Ih,this.domElement.parentNode,Mc,Pc.rtl);ub=!1;var Fb=2;rc&&Mc.y-Kc.topLeft.y>Kc.height/2?(ub=!0,Fb=1):!rc&&Mc.x-Kc.topLeft.x>Kc.width/2&&(ub=!0);if(ub){rc=Pc.pk("DragSelectionClickBehaviorTemporary.updateMouseSelectionRange",Pc.$G,Fb);try{rc.Vr(wb),rc.$$mn(),rc.$$cu()}finally{rc&&rc.dispose()}}};G.prototype.o$=function(wb){this.qb.eh(this.Bh);this.Lt(this.xN,this.zN,void 0,wb)};G.prototype.QA=function(wb){this.qb.eh(this.bB());
this.Lt(Object(qb.a)(this,this.xh,"onPointerMove"),Object(qb.a)(this,this.pf,"onPointerUp"),void 0,wb)};G.prototype.Gaa=function(){return this.Lh?47:6};G.prototype.bB=function(){return this.Lh?G.u6c:G.y6c};G.FVd=50;G.IVd=25;G.GVd=-85;G.JVd=-40;G.CVd=-120;G.DVd=-50;G.y6c=[6];G.u6c=[47];Object(ka.a)(G,"DragSelectionClickBehaviorTemporary",T,[]);Rk(C,G);C.prototype.dispose=function(){this.Zt&&this.soa();this.Lh&&this.$t&&this.soa(1);G.prototype.dispose.call(this)};C.prototype.Nnc=function(wb){this.Lh&&
(this.xw=wb,this.Pz=null,this.yq=this.isRow=this.Ue=this.zq=!1,nb.KeyInputManager.instance.qa(ta.a.Lb,this.domElement.ownerDocument.body,this.onKeyDown));this.Np=!0;this.tableRange=this.ZYc(this.tableManager.Xm(this.sourceRange.topLeft));db.g(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.Lh?(this.Pz=this.tableRange,this.An=1,this.Bh=(this.yq=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.Th=6,this.Ew(this.xN,this.zN),
this.oM=this.jia,this.jO=this.zna,this.Mz(wb.clientPoint,wb.zb,this.yq?11:12,!0,!0),this.yI(!0)):(this.Bh=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.Th=6,this.Ew(this.xN,this.zN),this.Mz(wb.clientPoint,wb.zb,this.isRow?11:12,!0)):(this.tableRange=null,this.Lh?(this.isRow=this.sourceRange.isRow,this.Ue=this.sourceRange.Ue,this.isRow||this.Ue?(this.An=3,this.oE=this.isRow?1:2,this.Th=6,this.Bh=this.isRow?[11]:[12],this.Ew(this.j6,
this.k6),this.oM=this.jia,this.jO=this.zna,this.Mz(wb.clientPoint,wb.zb,this.isRow?11:12,!0,!0),this.yI(!0)):(this.An=2,this.oE=0,this.Ew(Object(qb.a)(this,this.xh,"onPointerMove"),Object(qb.a)(this,this.pf,"onPointerUp")),this.oM=this.psb,this.jO=this.TKb,this.Mz(wb.clientPoint,wb.zb,this.Gaa(),!1,!0),this.Ay(!0))):(this.Ew(Object(qb.a)(this,this.xh,"onPointerMove"),Object(qb.a)(this,this.pf,"onPointerUp")),nb.KeyInputManager.instance.qa(ta.a.Lb,this.domElement.ownerDocument.body,this.onKeyDown),
this.oE=this.sourceRange.isRow?1:this.sourceRange.Ue?2:0,this.Mz(wb.clientPoint,wb.zb,this.Gaa(),!1),this.Ay()))};C.prototype.uya=function(){this.Np=!1;this.Lh&&(this.An=0);this.qb.eh(this.bB());if(!this.$.kq([this.gb],!1))return this.Lt(Object(qb.a)(this,this.xh,"onPointerMove"),Object(qb.a)(this,this.pf,"onPointerUp")),this.Th=-1,!0;if(this.ha.sa.Vc.equals(this.gb)||this.gka(this.gb)||this.gka(this.sourceRange))this.Th=-1;else{this.ZK();this.ha.sourceRange=this.sourceRange.clone();var wb=this.ha.sourceRange,
rc=this.ha.sa.Vc;if(this.Lh){var Mc={};this.$.Fd(-694765314,2,30,(Mc[Na.a.Kta]=this.Zt,Mc[Na.a.y3]=wb,Mc[Na.a.x3]=rc,Mc[Na.a.nsb]=this.$t,Mc))}else Mc={},this.$.Fd(-694765314,2,30,(Mc[Na.a.Kta]=this.Zt,Mc[Na.a.y3]=wb,Mc[Na.a.x3]=rc,Mc))}!this.Lh&&this.tableRange||this.Lt(Object(qb.a)(this,this.xh,"onPointerMove"),Object(qb.a)(this,this.pf,"onPointerUp"));this.itd&&this.htd();return!0};C.prototype.Kpb=function(wb){wb&&nb.KeyInputManager.instance.Aa(ta.a.Lb,this.domElement.ownerDocument.body,this.onKeyDown);
G.prototype.Kpb.call(this,wb)};C.prototype.Pnc=function(wb){var rc=this.ha.Kn(wb.clientPoint,wb.zb,5,void 0,void 0,!0);this.xw=wb;return this.vwb(rc)?(this.gb=this.G2(rc),this.fwb(!0),!0):this.bid(rc)?(this.gb=this.vha(rc),this.gwb(!0),!0):!1};C.prototype.xy=function(wb){wb=void 0===wb?!1:wb;var rc=this.gb.toString();if(this.Lh)for(var Mc=1;4>=Mc;Mc++)this.Hh[Mc.toString()].childNodes[0].innerText=rc,this.Hh[Mc.toString()].childNodes[1].innerText=this.oM,wb&&(this.Hh[Mc.toString()].childNodes[2].innerText=
this.jO);else for(wb=1;4>=wb;wb++)this.Hh[wb.toString()].innerText=rc};C.prototype.vwb=function(wb){return!!this.Pz&&1!==this.An&&!!wb&&this.Pz.contains(wb.topLeft)};C.prototype.bid=function(wb){return!!this.Pz&&1===this.An&&!!wb&&!this.Pz.contains(wb.topLeft)};C.prototype.fwb=function(wb){this.tableRange=this.Pz;this.An=1;var rc=!this.$t;wb?(this.QA(!1),this.Bh=this.yq?[11]:[12],this.wza(rc),this.yI(rc)):(this.R2(!1),this.RN(rc),this.Ay(rc))};C.prototype.gwb=function(wb){this.tableRange=null;this.An=
2;var rc=!this.$t;wb?(this.QA(!1),this.Bh=this.yq?[11]:[12],this.zq=this.yq,this.LPa(rc),this.yI(rc)):(this.o$(!1),this.RN(rc),this.Ay(rc))};C.prototype.bxc=function(){if(!db.g(this.$).ha.sa.tg)return!1;var wb=db.g(this.$).getRangeInformation(this.ha.sa.Vc);wb=ak(wb);for(var rc=wb.next();!rc.done;rc=wb.next())if(Object(ma.a)(oa.PivotTableRange,rc.value))return!1;return!0};C.prototype.ZYc=function(wb){if(wb&&wb.contains(this.sourceRange)&&!wb.equals(this.sourceRange)){if(wb.Yaa&&this.sourceRange.bottom===
this.sourceRange.top&&this.sourceRange.top===wb.top){var rc=new Ja.Range(this.sourceRange.top,this.sourceRange.left,wb.bottom,this.sourceRange.right,!1,!1);if(!rc.equals(wb))return this.sourceRange=rc,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),wb}this.Lh?this.yq=wb.left===this.sourceRange.left&&wb.right===this.sourceRange.right:this.isRow=wb.left===this.sourceRange.left&&wb.right===this.sourceRange.right;if(wb.top===this.sourceRange.top&&wb.bottom===this.sourceRange.bottom||
this.Xx())return wb}return null};C.prototype.G2=function(wb){var rc=wb.clone();this.Xx()?rc.left=Math.max(wb.left-this.Rdc,1):rc.top=Math.max(wb.top-this.wCc,1);rc.right=rc.left+this.sourceRange.width-1;rc.bottom=rc.top+this.sourceRange.height-1;return this.HYa(rc)};C.prototype.kzb=function(){var wb=this.gb.topLeft.xd(this.sourceRange);return wb||this.Lh&&!this.tableRange?wb:this.Xx()?this.gb.top===this.sourceRange.bottom+1:this.gb.left===this.sourceRange.right+1};C.prototype.oGd=function(){if(this.Xx()&&
this.gb.left!==this.tableRange.left||!this.Xx()&&this.gb.top!==this.tableRange.top){var wb=ob.a.Wc(1,1,0,910,0,2065438552,"RearrangeInvalidDest");Aa.a(this.$).qr([wb]);return!0}return!1};C.prototype.PEd=function(){var wb=this,rc=this.$.Fb.sc("UserAction","RearrangeRowColumnClientSide"),Mc={},Pc=(Mc.CopyPasteTargetType=1,Mc.OperationId=zb.a.create().toString(),Mc.Stopwatch=rc,Mc.DragDropIsShiftKeyDown=this.$t,Mc.EncounteredDeploymentErrors=!1,Mc),Kc=this.Zt?2:1,ub=this.$.da.za(254);(new Promise(function(Fb,
pc){wb.ntb(function(eb){eb.Errors&&0<eb.Errors.length?pc(new $a.a(22,eb.Errors)):Fb(!0)},function(eb){eb=Ab.a.Of(eb.data);pc(new $a.a(22,eb))})})).then(function(){da.ULS.sendTraceTag(520747156,0,50,'DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: success. copyPasteTargetType="{0}"',1);ub&&ub.Jlf(Pc,Kc,wb.sourceRange,wb.gb);return Promise.resolve(!0)},function(Fb){da.ULS.sendTraceTag(520747155,0,10,'DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: {0}, copyPasteTargetType="{1}"',
Fb?copyPasteInfra.getStringifiedError(Fb):"null",1);return ub?ub.AAf(Fb,Pc,Kc,wb.sourceRange,wb.gb):Promise.reject(Fb)})};C.prototype.ntb=function(wb,rc){function Mc(){return new I(Fb,ub)}function Pc(pc,eb,ic){return U(Kc.$.oa.xa,Fb,ub,wb?sb.b(pc,wb):pc,rc?sb.a(eb,rc):eb,ic,null)}var Kc=this;wb=void 0===wb?null:wb;rc=void 0===rc?null:rc;var ub={};this.Xx()?(ub.FirstRow=this.gb.top-1,ub.FirstColumn=0,ub.DeltaColumn=0,ub.DeltaRow=this.gb.bottom-this.gb.top+1):(ub.FirstRow=0,ub.FirstColumn=this.gb.left-
1,ub.DeltaColumn=this.gb.right-this.gb.left+1,ub.DeltaRow=0);ub.LastRow=Ub.a.$x;ub.LastColumn=Ub.a.Xu;ub.SheetName=this.$.va.pa?this.$.va.pa.name:this.$.vb.getItemByName(this.$.vb.pa.name).sheetName;var Fb=Ta.v(this.sourceRange,this.$);Db.EwaSettings.Zb()?this.$.userOperationManager.Sb(new Da.a(514,0,Pc,64,Mc),null):this.$.userOperationManager.Sb(new pa.a(514,0,Pc,void 0,Mc),null)};C.prototype.gka=function(wb){wb=db.g(this.$).getRangeInformation(wb);for(var rc=0,Mc=wb.length;rc<Mc;++rc)if(Object(ma.a)(oa.PivotTableRange,
wb[rc]))return wb=ob.a.Wc(1,0,0,898,0,2105176604,"InsDelCellsPivotTable"),Aa.a(this.$).qr([wb]),!0;return!1};C.prototype.soa=function(wb){wb=void 0===wb?0:wb;0===wb?this.Zt=!1:1===wb&&(this.$t=!1);this.Lh&&(this.Zt||this.$t)||(nb.KeyInputManager.instance.Aa(ta.a.Gd,this.domElement.ownerDocument.body,this.onKeyUp),this.dMa=!1)};C.prototype.RN=function(wb){wb=void 0===wb?!1:wb;this.Th=5;this.Ew(Object(qb.a)(this,this.xh,"onPointerMove"),Object(qb.a)(this,this.pf,"onPointerUp"));this.oM=this.psb;this.jO=
this.TKb;this.Mz(this.xw.clientPoint,this.xw.zb,this.Gaa(),!1,wb)};C.prototype.LPa=function(wb){wb=void 0===wb?!1:wb;this.Th=6;this.Ew(this.j6,this.k6);this.oM=this.jia;this.jO=this.zna;this.Mz(this.xw.clientPoint,this.xw.zb,this.isRow||this.yq?11:12,!0,wb)};C.prototype.wza=function(wb){wb=void 0===wb?!1:wb;this.Th=6;this.Ew(this.xN,this.zN);this.oM=this.jia;this.jO=this.zna;this.Mz(this.xw.clientPoint,this.xw.zb,this.Xx()?11:12,!0,wb)};C.prototype.mka=function(wb){return wb.Ca.keyCode===wc.a.Z7||
Qa.a.isMac&&wb.Ca.keyCode===wc.a.Boa};C.prototype.Xx=function(){return!this.Lh&&this.isRow||this.Lh&&this.yq};C.prototype.R2=function(wb){this.qb.eh(this.Bh);this.Lt(this.j6,this.k6,void 0,wb)};C.prototype.htd=function(){var wb=Ya.a.instance.Tb("Common.ISystemInitiatedFeedback");wb&&wb.execute(function(rc){rc.logActivity("DragDrop",null)})};C.Fqb="copy";Object(ka.a)(C,"DragSelectionClickBehaviorCellRangeAndTable",G,[]);var kb=b(331);Rk(x,G);x.prototype.Nnc=function(wb){this.xw=wb;this.isRow=this.Ue=
!1;this.Np=!0;this.rc=this.tableManager.iva(this.sourceRange);db.g(this.$);db.g(this.$).ig.zo(T.w1a);this.kpd(this.gb)?(this.isRow=this.Mli(),this.Ue=this.Lfi(),this.isRow||this.Ue?(this.Xgc=!1,this.wza(wb),this.gb=this.G2(this.gb),this.yI()):(this.Xgc=!0,this.RN(wb),this.Ay())):(this.Xgc=!0,this.RN(wb),this.Ay())};x.prototype.uya=function(){return 5==this.Th?(this.QA(!0),this.Xgc=!1,this.pzj(),this.Th=-1,!0):!1};x.prototype.Pnc=function(wb){var rc=this.ha.Kn(wb.clientPoint,wb.zb,5,void 0,void 0,
!0);this.xw=wb;return this.Xgc?!1:this.kpd(rc)?(this.P1h(wb),!0):!1};x.prototype.xy=function(){var wb=new Ja.Range(this.gb.top,this.gb.left,this.gb.bottom,this.gb.right,!1,!0);6==this.Th&&(this.isRow?(--wb.top,wb.bottom=wb.top+this.gb.height-1):(--wb.left,wb.right=wb.left+this.gb.width-1));for(var rc=1;4>=rc;rc++)this.Hh[rc.toString()].childNodes[0].innerText=wb.toString()};x.prototype.bxc=function(){if(!db.g(this.$).ha.sa.tg)return!1;var wb=db.g(this.$).getRangeInformation(this.ha.sa.Vc);wb=ak(wb);
for(var rc=wb.next();!rc.done;rc=wb.next())if(Object(ma.a)(oa.PivotTableRange,rc.value))return!0;return!1};x.prototype.G2=function(wb){wb=wb.clone();this.isRow?(wb.left=this.sourceRange.left,wb.right=this.rc.right,wb.bottom=wb.top+this.sourceRange.height-1):this.Ue&&(wb.top=this.sourceRange.top,wb.bottom=this.rc.PW.bottom,wb.right=wb.left+this.sourceRange.width-1);return this.HYa(wb)};x.prototype.k1i=function(){var wb={},rc=Ta.v(this.sourceRange,this.$);db.g(this.$).getRangeInformation(this.gb);if(this.isRow){wb.FirstColumn=
this.gb.left-1;wb.LastColumn=this.gb.right-1;if(this.sourceRange.top<=this.gb.top&&this.sourceRange.bottom>=this.gb.top-1)return;wb.FirstRow=this.sourceRange.top>this.gb.top?this.gb.top-1:this.gb.top-this.sourceRange.height-1;wb.LastRow=wb.FirstRow+this.sourceRange.height-1}else{wb.FirstRow=this.gb.top;wb.LastRow=this.gb.bottom;if(this.sourceRange.left<=this.gb.left&&this.sourceRange.right>=this.gb.left-1)return;wb.FirstColumn=this.sourceRange.left>this.gb.left?this.gb.left-1:this.gb.left-this.sourceRange.width-
1;wb.LastColumn=wb.FirstColumn+this.sourceRange.width-1}var Mc={};Mc.SheetName=this.$.va.pa?this.$.va.pa.name:this.$.vb.getItemByName(this.$.vb.pa.name).sheetName;Mc.Ranges=Array(2);Mc.Ranges[0]=rc;Mc.Ranges[1]=wb;this.Wwh(Mc)};x.prototype.Wwh=function(wb){function rc(Pc,Kc,ub){var Fb=Mc.$.oa.xa;Pc=Mc.ezf?sb.b(Pc,Mc.ezf):Pc;Kc=Mc.dzf?sb.a(Kc,Mc.dzf):Kc;var pc=Fb.Na(1,null);pc.moveRange=wb;return Pb.g(Fb,"MoveLineItems",pc,Pc,Kc,ub,null,0)}var Mc=this;Db.EwaSettings.Zb()?this.$.userOperationManager.Sb(new Da.a(265,
0,rc,64),null):this.$.userOperationManager.Sb(new pa.a(265,0,rc,void 0),null)};x.prototype.kpd=function(wb){return wb.left>=this.rc.PW.left&&wb.right<=this.rc.iM.right&&wb.top>=this.rc.iM.top&&wb.bottom<=this.rc.PW.bottom};x.prototype.Mli=function(){return this.rc.PW.top<=this.gb.top&&this.rc.PW.left<=this.gb.left&&this.rc.PW.right>=this.gb.left};x.prototype.Lfi=function(){return this.rc.iM.top==this.gb.top&&this.rc.iM.left<=this.gb.left&&this.rc.iM.right>=this.gb.right};x.prototype.wza=function(wb){this.Th=
6;this.Bh=this.isRow?[11]:[12];this.Ew(this.xN,this.zN);this.Mz(wb.clientPoint,wb.zb,this.isRow?11:12,!0,!1)};x.prototype.RN=function(wb){this.Th=5;this.Ew(Object(qb.a)(this,this.xh,"onPointerMove"),Object(qb.a)(this,this.pf,"onPointerUp"));this.Mz(wb.clientPoint,wb.zb,this.Gaa(),!1,!1)};x.prototype.P1h=function(wb){this.QA(!0);this.wza(wb);this.gb=this.G2(this.gb);this.yI()};x.prototype.O1h=function(wb){this.o$(!0);this.RN(wb);this.Ay()};x.prototype.pzj=function(){var wb=ob.a.Wc(1,0,900,899,0,2069074184,
"PivotTableInvalidMove");wb.HelpTopicId=kb.a.ZCj;wb.HelpDescription=P.a.instance.ga(905);Aa.a(this.$).qr([wb])};Object(ka.a)(x,"DragSelectionClickBehaviorPivotTableRange",G,[]);var lb=b(391);Rk(y,K);y.prototype.dispose=function(){xa.a.instance.Aa(ta.a.pointerDown,this.oaa,this.onPointerDown);Ma.a.instance.Aa(ta.a.$j,this.oaa,this.oca);this.gridView.$&&(this.gridView.ha.Q6(this.hp),this.gridView.ha.yW(this.vg),this.gridView.$.ol(this.Yc),this.gridView.$.ob.Osc(this.q6),this.gridView.$.ob.Nsc(this.p6),
this.gridView.oPf(this.RDb),this.gridView.$b.wk(this.nxf),this.gridView.$b.Nl(this.mxf));K.prototype.dispose.call(this)};Object(ka.a)(y,"FillHandleClickBehavior",K,[]);Rk(B,H);Af.Object.defineProperties(B.prototype,{uva:{configurable:!0,enumerable:!0,get:function(){return this.opg}}});B.Awe=[1,2,32,256,128,64];Object(ka.a)(B,"IPadSelectionClickThroughBehavior",H,[]);var ac=b(22);A.prototype.dispose=function(){this.gridView.ha.Q6(this.hp);this.gridView.ha.yW(this.vg);this.gridView.ha.RId(this.vg)};
A.prototype.Lza=function(){this.X4a=0;this.rgc=!1;this.t5=Number.NaN};A.prototype.d8e=function(wb){this.mBc(wb.zb,1);return!0};A.prototype.e8e=function(wb){this.mBc(wb.zb,-1);return!0};A.prototype.PIe=function(wb){this.rgc=!0;this.mBc(wb,1)};A.prototype.QIe=function(wb){this.rgc=!1;this.mBc(wb,-1)};A.prototype.mBc=function(wb,rc){if(wb)if(wb.parentNode)if(this.$nd)isNaN(this.t5)||(this.zBc(this.t5,!1),this.t5=Number.NaN);else if(wb=parseInt(wb.parentNode.getAttribute(Na.a.Axb),10),isNaN(wb))da.ULS.shipAssertTag(537159366,
0,!1,"MarqueeHoveringManager.UpdateMarqueeStyle: indexInMarqueeCollection is not a valid number.");else{if(!isNaN(this.t5)&&wb!==this.t5){if(this.rgc)return;this.zBc(this.t5,!1)}if(isNaN(this.t5)||wb!==this.t5)this.t5=wb,this.X4a=0;!this.X4a&&0<rc&&this.zBc(wb,!0);this.X4a=Math.max(this.X4a+rc,0);!this.X4a&&0>rc&&(this.zBc(wb,!1),this.t5=Number.NaN)}else da.ULS.shipAssertTag(537159367,0,!!wb.parentNode,"MarqueeHoveringManager.UpdateMarqueeStyle: handle.ParentNode is null.");else da.ULS.shipAssertTag(537159368,
0,!!wb,"MarqueeHoveringManager.UpdateMarqueeStyle: handle is null.")};A.prototype.zBc=function(wb,rc){for(var Mc=1;4>=Mc;Mc++){var Pc=this.gridView.qb.fw(3,Mc,wb).mf;la.DOMElementExtensions.toggleCssClass(Pc,F.Quh,rc);for(Pc=Pc.firstChild;Pc;Pc=Pc.nextSibling)ac.a.contains(Pc.className,"resizemarqueehandle",!0)&&la.DOMElementExtensions.toggleCssClass(Pc,F.Uuh,rc)}};Object(ka.a)(A,"MarqueeHoveringManager",null,[]);var Dc=b(195),Zb=b(85),mc=b(1031),Lb=b(1441);Rk(v,H);v.prototype.dispose=function(){xa.a.instance.Aa(ta.a.iW,
this.VJ,this.Zzf);xa.a.instance.Aa(ta.a.my,this.VJ,this.sca);xa.a.instance.Aa(ta.a.pointerDown,this.VJ,this.onPointerDown);Dc.a.instance.Aa(ta.a.click,this.VJ,this.oEb);Dc.a.instance.Aa(ta.a.$j,this.VJ,this.onDoubleClick);la.DOMElementExtensions.gf(this.sH);this.sH=null;la.DOMElementExtensions.gf(this.VJ);this.Ru=this.VJ=null;H.prototype.dispose.call(this)};v.prototype.GYa=function(wb){this.Ru=Object(Zb.a)(Lb.a,wb.metadata)};Object(ka.a)(v,"RangeCatchUpActivityHighlightBehavior",H,[]);Rk(r,O);r.prototype.JRa=
function(){return(this.gridView.inRangePicker||this.gridView.xi)&&O.prototype.JRa.call(this)};Af.Object.defineProperties(r.prototype,{w4:{configurable:!0,enumerable:!0,get:function(){return 16}},Ybb:{configurable:!0,enumerable:!0,get:function(){return this.gridView.ha.rangePicker.Ybd(!1)}}});Object(ka.a)(r,"RangePickerTouchGrippiesBehavior",O,[]);Rk(z,H);Object(ka.a)(z,"RearrangeHighlightBehavior",H,[]);var Sa;(function(wb){wb[wb.topLeft=0]="topLeft";wb[wb.topRight=1]="topRight";wb[wb.bottomLeft=
2]="bottomLeft";wb[wb.bottomRight=3]="bottomRight";wb[wb.error=4]="error"})(Sa||(Sa={}));Object(ka.b)("Corner",Sa);Rk(n,H);n.prototype.dispose=function(){var wb=this;this.LK.forEach(function(rc){xa.a.instance.Aa(ta.a.pointerDown,rc,wb.onPointerDown)});Array.clear(this.LK);H.prototype.dispose.call(this)};n.prototype.GYa=function(wb){this.aba=wb;this.coe(wb);this.$n.xKb(wb,this.LK,this.EQd());this.Zx.Lza()};n.prototype.xh=function(wb){wb=Va.a(this.$).Sd(wb);wb=this.d_e(wb,!1);if(!wb)return!0;wb=this.vDe(wb);
if(!wb)return da.ULS.shipAssertTag(537159327,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: newMarqueeRange is null"),this.A9b(!0),!1;if(this.gb.equals(wb))return!0;this.gb=wb;wb=this.Ay();wb||(da.ULS.shipAssertTag(537159326,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.A9b(!0));return wb};n.prototype.pf=function(wb){var rc=this;wb=Va.a(this.$).Sd(wb);wb=this.ZK();da.ULS.shipAssertTag(537159325,0,wb,"ResizeMarqueeBehaviorBase.OnPointerUp: SetSelectedRange failed");
Qa.a.iB&&(this.ha.dec(!0),window.setTimeout(function(){rc.ha.dec(!1)},100));this.A9b(!wb);return wb};n.prototype.d_e=function(wb,rc){var Mc=wb.zb;wb=wb.clientPoint;if(!Mc||!wb)return da.ULS.shipAssertTag(537159324,0,!!Mc,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: source is null"),da.ULS.shipAssertTag(537159323,0,!!wb,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: point is null"),null;rc&&(wb=this.cqf(wb));rc=this.ha.Kn(wb,Mc,0,!0,!1,!0);rc||(wb=this.cqf(wb),rc=this.ha.Kn(wb,Mc,0,!0,!1,
!0));return rc};n.prototype.cqf=function(wb){wb.y+=0===this.i3||1===this.i3?2:-2;wb.x+=0===this.i3||2===this.i3?2:-2;return wb};n.prototype.vDe=function(wb){if(!wb||!this.sourceRange)return da.ULS.shipAssertTag(537159322,0,!!wb,"ResizeMarqueeBehaviorBase.CreateNewRange: newCorner is null"),da.ULS.shipAssertTag(537159321,0,!!this.sourceRange,"ResizeMarqueeBehaviorBase.CreateNewRange: sourceRange is null"),null;if(0===this.i3)return new Ja.Range(wb.top,wb.left,this.sourceRange.bottom,this.sourceRange.right,
!0,!1);if(1===this.i3)return new Ja.Range(wb.top,this.sourceRange.left,this.sourceRange.bottom,wb.right,!0,!1);if(2===this.i3)return new Ja.Range(this.sourceRange.top,wb.left,wb.bottom,this.sourceRange.right,!0,!1);if(3===this.i3)return new Ja.Range(this.sourceRange.top,this.sourceRange.left,wb.bottom,wb.right,!0,!1);da.ULS.shipAssertTag(537159320,0,!1,"ResizeMarqueeBehaviorBase.CreateNewRange: currentFixedCorner is not valid: {0}",Sa[this.i3]);return null};n.prototype.ZK=function(){return this.coloredReferencesManager.bqf(this.Ya,
this.RK,this.gb)};n.prototype.Ay=function(){return this.ZK()};n.prototype.A9b=function(wb){wb&&da.ULS.sendTraceTag(537159319,0,10,"ResizeMarqueeBehaviorBase.FinishOrAbortOperation: Aborting operation, will try to recalculate colored references as a fallback.");this.Zx.QIe(this.LK[0]);this.$n.fKf(!1,this.aba.v$);this.Ya.textBox.setCaretPositionToEnd();this.Ya.ysc(this.U4e);this.fbg();this.oSa=this.gridView.kLa=!1;bb.b(this.$,!1);this.$n.WLf()};Object(ka.a)(n,"ResizeMarqueeBehaviorBase",H,[]);Rk(w,
n);w.prototype.DSf=function(){return[F.Hvh,F.Ivh,F.Fvh,F.Gvh]};w.prototype.Une=function(){return[F.Evh]};w.prototype.uYe=function(wb){wb=wb.zb;if(wb===this.LK[0])return 0;if(wb===this.LK[1])return 1;if(wb===this.LK[2])return 2;if(wb===this.LK[3])return 3;da.ULS.shipAssertTag(537159318,0,!1,"ResizeMarqueeMouseBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4};w.prototype.wNf=function(){this.$n.Ew(Object(qb.a)(this,this.xh,"onPointerMove"),Object(qb.a)(this,this.pf,"onPointerUp"),
!0)};w.prototype.fbg=function(){this.$n.hXd(Object(qb.a)(this,this.xh,"onPointerMove"),Object(qb.a)(this,this.pf,"onPointerUp"),!0)};w.prototype.j1f=function(wb){return 2===(Ia.a.Cb=wb.mb)&&wb.Hn===Sys.UI.MouseButton.leftButton};w.prototype.EQd=function(){return!0};w.prototype.Zlf=function(){da.ULS.sendTraceTag(537159317,0,50,"ResizeMarqueeMouseBehavior.LogStartOperation: Starting resize marquee operation with mouse.")};w.prototype.coe=function(wb){for(var rc=ak(this.LK),Mc=rc.next();!Mc.done;Mc=
rc.next())Mc.value.style.backgroundColor=wb.mf.style.borderColor};Object(ka.a)(w,"ResizeMarqueeMouseBehavior",n,[]);Rk(f,n);f.prototype.dispose=function(){Ia.a.QPf(this.kEb);n.prototype.dispose.call(this)};f.prototype.DSf=function(){return[gb.a.Iuh,gb.a.Huh]};f.prototype.Une=function(){var wb=Db.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest"),rc=Qa.a.yf;wb=!wb||rc;return[wb?gb.a.PPe:gb.a.OPe,gb.a.z8b,wb?gb.a.Guh:gb.a.y8b]};f.prototype.uYe=function(wb){wb=wb.zb;if(wb===this.LK[0])return 0;
if(wb===this.LK[1])return 3;da.ULS.shipAssertTag(537159316,0,!1,"ResizeMarqueeTouchBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4};f.prototype.wNf=function(){Qa.a.Vu?this.$n.Ew(Object(qb.a)(this,this.xh,"onPointerMove"),Object(qb.a)(this,this.pf,"onPointerUp"),!1):this.$n.g8i(Object(qb.a)(this,this.xh,"onPointerMove"),Object(qb.a)(this,this.pf,"onPointerUp"))};f.prototype.fbg=function(){Qa.a.Vu?this.$n.hXd(Object(qb.a)(this,this.xh,"onPointerMove"),Object(qb.a)(this,this.pf,
"onPointerUp"),!1):this.$n.bPj(Object(qb.a)(this,this.xh,"onPointerMove"),Object(qb.a)(this,this.pf,"onPointerUp"))};f.prototype.j1f=function(wb){return 3===(Ia.a.Cb=wb.mb)};f.prototype.EQd=function(){return 3===Ia.a.Cb};f.prototype.Zlf=function(){da.ULS.sendTraceTag(537159315,0,50,"ResizeMarqueeTouchBehavior.LogStartOperation: Starting resize marquee operation with touch.")};f.prototype.coe=function(){};Object(ka.a)(f,"ResizeMarqueeTouchBehavior",n,[]);Rk(m,H);m.Rqb=function(wb,rc){var Mc=document.createElement("div");
Mc.className=rc;wb.appendChild(Mc)};Object(ka.a)(m,"SelectionCutCopyBehavior",H,[]);Rk(l,H);Object(ka.a)(l,"SelectionPasteBehavior",H,[]);Rk(k,H);k.grb=function(wb,rc){var Mc=document.createElement("div");Mc.className=rc;wb.appendChild(Mc)};Object(ka.a)(k,"SelectionRangePickerBehavior",H,[]);Rk(e,O);e.prototype.JRa=function(){var wb=this.gridView.xi||this.gridView.isEditing;return this.gridView.ha.sa.tg&&!wb&&O.prototype.JRa.call(this)};Af.Object.defineProperties(e.prototype,{w4:{configurable:!0,
enumerable:!0,get:function(){return 0}},Ybb:{configurable:!0,enumerable:!0,get:function(){return this.gridView.ha.sa.Vc}}});Object(ka.a)(e,"SelectionTouchGrippiesBehavior",O,[]);var Cb=S.a;Rk(d,Cb);d.prototype.dispose=function(){this.gridView.qb.ibj(this.fob);this.Zx&&(this.Zx.dispose(),this.Zx=null);Cb.prototype.dispose.call(this)};Object(ka.a)(d,"GridHighlightsBehaviorManager",S.a,[]);var ec=Y.a;Rk(c,ec);c.prototype.create=function(){var wb=this;wa.TaskExtensions.Ba(ia.GetServiceTaskFactory.create(this.$.da,
134,this.la,this.hb),function(rc){wb.pb(wb.$.da.za(64)||new d(wb.$,rc.result))},this.la,3)};c.ka=function(wb){wb.da.Ga(149,new c(wb))};Object(ka.a)(c,"GridHighlightsBehaviorManagerFactory",Y.a,[]);b.d(D,"a",function(){return a})},1354:function(u,D,b){function a(){I.a.Fa(function(Lb){c.ka(Lb);G.ka(Lb)})}function c(Lb){var Sa=mc.call(this)||this;Sa.$=Lb;Sa.Eb();return Sa}function d(Lb,Sa,Cb){Cb=void 0===Cb?null:Cb;var ec=Zb.call(this,Sa)||this;ec.sheetTabActivatePreviousHidden=xa.a.instance.ga(725);
ec.sheetTabActivateNextHidden=xa.a.instance.ga(727);ec.svgIconProvider=null;ec.mh=[];ec.qK=Array(6);ec.Gwd=Array(6);ec.Qk=null;ec.QPd=null;ec.Bwc=null;ec.Ocb=null;ec.zwc=null;ec.vH=null;ec.Qxb=null;ec.zRa=null;ec.isRtl=!1;ec.Iu=0;ec.fK=0;ec.Wsc=!1;ec.U6b=!1;ec.$ma=0;ec.Ipc=0;ec.b7b=null;ec.W$=null;ec.B3=null;ec.pM=null;ec.GC=0;ec.vcc=0;ec.wMb=null;ec.EAb=-1;ec.TY=null;ec.Poc=0;ec.pyc=-1;ec.vma=0;ec.zta=new C;ec.WKc=!1;ec.w_=null;ec.Ife=null;ec.RPd=null;ec.SPd=null;ec.Xsc=null;ec.$8d=!1;ec.vkd=null;
ec.Yvd=!1;ec.Hfe=null;ec.XC=function(wb,rc){ec.bCf(rc.item)};ec.Bya=function(wb,rc){wb=ec.$.va.pa.index;for(var Mc=0,Pc=ec.mh.length;Mc<Pc;Mc++){var Kc=ec.DQ(Mc);if(Kc.name===rc.oldName){Kc.name=rc.newName;ec.a0();Mc===wb&&ec.l0(6);break}}};ec.gCf=function(wb,rc){(wb=ec.t2a(rc.item))&&wb.afb()};ec.hCf=function(wb,rc){rc.visible?(ec.qRa(!1),ec.dCf(rc.item)):ec.bCf(rc.item)};ec.pN=function(wb){ec.fF?(ec.TY=wb,ec.SNb()):(ec.TY&&(ec.Ipc+=ec.TY.clientPoint.x-wb.clientPoint.x),ec.TY=wb,Math.abs(ec.Ipc)>=
ec.Khh&&ec.SNb());return!0};ec.BN=function(wb){wb.Ca.preventDefault();return!1};ec.WVf=function(wb){ec.SVf(wb,!0)};ec.VVf=function(wb){ec.SVf(wb,!1)};ec.b6=function(wb){if(ec.fF&&(ec.oz||ec.mgf(wb)))if(ec.U6b=ec.icf(wb),ec.oz){var rc;wb=(rc=ec.DQ(ec.GC+1))?rc.sheet:null;ec.reorderSheets(wb,ec.GC+1===ec.OPd,!0)}else wb=ec.Yvd?null:ec.vkd,ec.reorderSheets(wb,ec.Yvd,!0);ec.kQ();return!0};ec.wh=function(wb,rc){rc.wF&&ec.qYd(rc.wF);ec.Hvc(!1);ec.a0();rc.pa&&(ec.qYd(rc.pa),ec.l0(6),ec.ea.ama())};ec.Tsf=
function(wb,rc){ec.RBc(rc.item)};ec.Usf=function(wb,rc){ec.RBc(rc.item)};ec.Vsf=function(wb,rc){ec.RBc(rc.item)};ec.rOa=function(wb,rc){ec.RBc(rc.item)};ec.fya=function(){ec.d0c()};ec.Yc=function(){ec.isVisible=!ec.ea.isNamedObjectViewMode;ec.d0c();ec.N3c();X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&(Dc.d(ec.$)||Dc.e(ec.$))&&(ac.PageLoadTrackingInfo.instance.EW(H.a.vAa,["sheetTabBar"]),ac.PageLoadTrackingInfo.instance.DW(H.a.vAa,["sheetTabBar"]));ec.v3c();ec.a0();
ec.qRa(!0);ec.l0(6)};ec.Ri=function(){ec.isVisible&&(ec.a0(),ec.l0(6))};ec.Sf=function(){Object(S.a)(B,ec.vH)===ra.k(ec.$.ng)&&ec.v3c();for(var wb=ak(ec.mh),rc=wb.next();!rc.done;rc=wb.next())rc.value.ioj(!ra.k(ec.$.ng))};ec.fCf=function(wb,rc){ec.ydj(rc.item,rc.isUserOperation)};ec.JEb=function(wb,rc){ec.dCf(rc.item)};ec.onKeyDown=function(wb){switch(wb.keyCode){case 9:var rc=ec.domElement.querySelectorAll(La.DOMElementExtensions.gr),Mc=La.DOMElementExtensions.Dl(rc);rc=La.DOMElementExtensions.hz(rc);
La.DOMElementExtensions.lna(wb,Mc,rc);break;case 39:case 37:La.DOMElementExtensions.RYf(wb,ec.domElement.querySelectorAll(La.DOMElementExtensions.gr),39===wb.keyCode?!ec.isRtl:ec.isRtl)}Z.ULS.sendTraceTag(537153691,0,50,"SheetTabBarControl.OnKeyDown: Press on {0}",wb.keyCode)};ec.onScroll=function(){ec.Qk.scrollLeft!==ec.$ma&&ec.LIj()};ec.g6=function(wb){if(wb.ctrlKey||wb.W2)return!1;ec.Qk.scrollLeft+=Math.floor(30*wb.UBa);if(ec.oz&&ec.fF){var rc=ec.LYe("OnMouseWheel");rc&&ec.cUd(0<wb.UBa,rc.x+rc.width/
2)}return!0};ec.sF=function(wb,rc){if(ec.zta)ec.h5e("PartialInteractivity",rc.LL?3:0);else{ec.kQ(!1);ec.rOd(rc.LL);wb=ak(ec.Cse);for(var Mc=wb.next();!Mc.done;Mc=wb.next())(Mc=Mc.value)&&Mc.kX(rc.LL);wb=ak(ec.mh);for(Mc=wb.next();!Mc.done;Mc=wb.next())(Mc=Mc.value)&&Mc.kX(rc.LL)}};ec.RDb=function(wb,rc){wb=0;rc.Eje&&(wb=2|(rc.hvj?1:0));ec.h5e("ComponentRangePicker",wb)};ec.$=Lb;ec.ea=ec.$.ea;ec.oz=ca.a.def();ec.j7b=ec.oz&&!X.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2");
ec.fm=X.EwaSettings.ma(503);ec.kw=ca.a.Cpd();ec.kgf=ec.fm&&!(X.EwaSettings.isChangeGateEnabled("OfficeVSO:6179307_hideSheetDropDownMenuForMobileMeetings")&&ec.$.MC);ec.oz&&(ec.$8d=ec.fm&&!ea.a.Vu);ec.mCi=ec.$.ya.SheetTabNavigateButtonLongKeyPressPeriodMS;ec.lCi=ec.$.ya.SheetTabNavigateButtonIntervalPeriodMS;ec.Khh=ec.$.ya.SheetTabDragStartPixelThreshold;ec.cPa=-1;ec.bPa=-1;ec.V1c=!1;ec.kw&&(ec.svgIconProvider=Cb);ec.dC=new va.a(ec.domElement,3);ec.fm&&ec.domElement.classList.add(x.Qrh);ec.J7g();ec.k5g();
ec.K7g();ec.M8g();ec.Hvc(!0);ec.Yc(null,null);Lb=ec.$.va;Lb.Kf(ec.wh);Lb.wUc(ec.fya);Lb.lY(ec.XC);Lb.Iga(ec.JEb);Lb.zFa(ec.Bya);Lb.Ome(ec.fCf);Lb.uYa(ec.hCf);Lb.hFg(ec.gCf);Lb.GUc(ec.Tsf);Lb.Lme(ec.Usf);Lb.Mme(ec.Vsf);Lb.Nme(ec.rOa);ec.$.Tk(ec.Yc);ec.$.xA(ec.Ri);Ea.a(ec.$).Oh(ec);ec.$.da.Ga(32,ec);X.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport")&&ec.$.ea.Bu(ec.Sf);ec.Awc=ec.ke.Td(ec.domElement);ec.Awc.ka("keydown",ec.onKeyDown);Va.a(ec.$).Pp()&&ec.sF(null,new Db.a(!0));
Va.a(ec.$).Tf.E9(ec.sF);Kb.g(ec.$).jme(ec.RDb);X.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&ec.Awc.ka("mousedown",function(wb){wb.preventDefault()});ka.a.instance.qa(Y.a.RC,ec.domElement,ec.g6);ec.PPd=ec.ke.Td(ec.Qk);ec.PPd.ka("scroll",ec.onScroll);ec.LIj=mb.a(function(){ec.a0()},200,ec.$.la,ya.a.mvj,!0);ec.$.IC(H.a.UBj);ec.kgf&&(ec.Hfe=new r(ec.$,ec.zRa.domElement));X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&ac.PageLoadTrackingInfo.instance.S6(H.a.vAa,
["sheetTabBar"]);return ec}function e(Lb,Sa,Cb){Sa=y.call(this,document.createElement("a"),Sa)||this;Sa.rha=X.EwaSettings.ma(503)?la.a.I8c:la.a.Nsh;Cb.nb(Sa.domElement,xa.a.instance.ga(716),0,Sa.rha,xa.a.instance.ga(716),bb.a.m1c,!0);Lb.appendChild(Sa.domElement);Sa.yc.ka("contextmenu",function(ec){Ia.g(ec)});return Sa}function k(Lb,Sa,Cb,ec,wb,rc,Mc){var Pc=y.call(this,document.createElement("li"),Lb)||this;Pc.D0f=0;Pc.E0f=0;Pc.M0c=0;Pc.N0c=0;Pc.a4c=.5;Pc.JPd=!1;Pc.PU=!1;Pc.yO=null;Pc.QCb=null;Pc.pE=
null;Pc.YGc=null;Pc.color=null;Pc.Ldf=!1;Pc.jhc=!1;Pc.i5b="#BEBBB8";Pc.wEc=null;Pc.onKeyDown=function(Kc){return 13!==Kc.Ca.keyCode||Pc.disabled?!1:(Pc.activateSheet(1),!0)};Pc.zz=function(Kc){return 32!==Kc.Ca.charCode||Pc.disabled?!1:(Pc.activateSheet(1),!0)};Pc.vN=function(){Pc.disabled||(Pc.cS.WRi(Pc),Pc.cS.fF||Pc.rna(!0,void 0,"OnMouseOver"))};Pc.uN=function(){Pc.disabled||Pc.rna(!1,void 0,"OnMouseOut")};Pc.rya=function(){Pc.cS.fF||(Pc.oEj(),Pc.sheet.n7||Kb.g(Pc.$).uIb(Pc.sheet.sheetName));return!1};
Pc.f6=function(){Pc.vKe(!1);return!1};Pc.$c=function(Kc){if(Pc.disabled)return!0;var ub=Kb.g(Pc.$);Pc.sheet.active||3!==Kc.mb?Pc.fm?Pc.activateSheet(Kc.mb):ca.a.nqd()&&ub.focus():(!ca.a.DMa(Pc.$)&&!Pc.fAb||ub.isEditing||ub.xi||ub.Zrb(),Pc.activateSheet(Kc.mb));return 3!==Kc.mb};Pc.onPointerDown=function(Kc){if(Pc.disabled)return!0;Pc.vKe(!0);Kb.g(Pc.$).inRangePicker&&Z.ULS.sendTraceTag(35985038,0,15,"SheetTabButton:OnPointerDown() - Tried clicking different sheet while in range picker (e.g editing a formula).");
var ub=3===Kc.mb;if(2===Kc.mb||ub&&Pc.Rwa)Pc.fm?(Pc.rna(!0,!ub,"OnPointerDown"),ub=J.Task.delay(ub?Pc.E0f:Pc.D0f).eo(function(){return!0})):ub=Pc.activateSheet(Kc.mb),Pc.Dzb&&(Pc.jhc=!0,Pc.cS.Xsc=F.TaskExtensions.Ba(ub,function(){Pc.jhc&&Pc.cS.YRi(Pc,Kc)},Pc.la,11));return!1};Pc.pf=function(Kc){if(Pc.disabled||!Pc.Dzb&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))return!0;var ub=Pc.cS.fF&&!ca.a.def();Pc.jhc=!1;Pc.fm&&Pc.rna(2===Kc.mb,void 0,"OnPointerUp");
Pc.cS.Xsc&&(F.TaskExtensions.Ba(Pc.cS.Xsc,function(){Pc.cS.XRi(Pc)},Pc.la,11),Pc.cS.Xsc=null);return ub};Pc.BN=function(){Pc.jhc=!1;Pc.JPd||Pc.rna(!1,void 0,"OnTouchMove");return!1};Pc.pye=new l(Pc,Lb);Pc.fm=rc;Pc.kw=Mc;Pc.fAb=ca.a.fAb(Lb);Pc.Kmd=X.EwaSettings.isChangeGateEnabled("OfficeVSO:3843903_DelayLoadSheetViewIcon")&&!Pc.kw;Pc.fm?(Pc.D0f=Lb.ya.SheetDragReorderDelayInMilliseconds,Pc.E0f=Lb.ya.SheetDragReorderDelayInMillisecondsForTouch,Pc.M0c=18,Pc.N0c=20):(Pc.M0c=19,Pc.N0c=22);Pc.$=Lb;Pc.jWb=
ec;Pc.cS=wb;Pc.Dzb=wb.Hoe();Pc.$9g();Pc.Y3g();Pc.zjd=Lb.Fb.Lg("UserAction",Pc.name);Pc.Tnd=!1;La.DOMElementExtensions.ju(Pc.domElement,H.a.Is,null,null);Pc.domElement.appendChild(Pc.anchor);Pc.anchor.appendChild(Pc.pE);Pc.wna=new oa.a;Lb=new w(Pc.sheet,Pc.fm,Pc.kw);Pc.wna.add(new m(Pc.$,Lb));Pc.$.ea.PKb&&(Lb=new n(Pc.sheet,Pc.fm,Pc.kw),Pc.wna.add(new m(Pc.$,Lb)));Pc.Kmd||(Lb=new f(Pc.sheet,Pc.cS.wwc,function(){return Pc.color?k.QQd(Pc.color):!1},Pc.kw),Pc.QCb=new m(Pc.$,Lb),Pc.wna.add(Pc.QCb));Pc.Rwa=
Pc.cS.Rwa;Pc.afb();Pc.$8i();Pc.Cte=new va.a(Pc.domElement,1);Sa.insertBefore(Pc.domElement,Cb);gb.a(Pc.$)&&Pc.odg(!0);return Pc}function l(Lb,Sa){var Cb=Ya.call(this,Lb.domElement)||this;Cb.onKeyDown=function(ec){121===ec.keyCode&&ec.shiftKey&&!Cb.yna.disabled&&(Cb.showContextMenu(new Sys.UI.Point(0,0),1,Cb.yna.anchor),Ia.g(ec))};Cb.oca=function(ec){if(!Cb.$.isEditMode||Cb.yna.disabled)return!0;Cb.rename(!1,ec.mb);return!0};Cb.Jl=function(ec){return Cb.yna.disabled?!0:Cb.showContextMenu(ec.clientPoint,
ec.mb,ec.zb)};Cb.Mfe=Lb;Cb.$=Sa;yb.a.instance.qa(Y.a.$j,Lb.domElement,Cb.oca);sb.a.instance.qa(Lb.domElement,Cb.Jl);Cb.yc.ka("keydown",Cb.onKeyDown);return Cb}function m(Lb,Sa){var Cb=this;this.nqa=this.q1=this.SAa=this.ll=null;this.Zef=!1;this.UQc=this.Wna=this.Bsa=this.Bha=this.Asa=null;this.vN=function(){Cb.dataSource.WM()&&F.TaskExtensions.Ba(Cb.zBb,function(){dialogControls.renderToolTip(Cb.dataSource.ks(),"SheetIconTooltip",Cb.dataSource.AVd(),Cb.pI,10,!1,!1,1)},Cb.$.la,3)};this.uN=function(){Cb.dataSource.WM()&&
Cb.clearToolTip()};this.$=Lb;this.dataSource=Sa;this.kw=ca.a.Cpd()}function f(Lb,Sa,Cb,ec){this.sheet=Lb;this.altText=xa.a.instance.ga(1883);this.FKj=Sa;this.d2f=Cb;this.kw=ec}function w(Lb,Sa,Cb){this.fm=Sa;this.kw=Cb;this.sheet=Lb;this.altText=xa.a.instance.ga(1963)}function n(Lb,Sa,Cb){this.fm=Sa;this.kw=Cb;this.sheet=Lb;this.altText=xa.a.instance.ga(1964)}function z(Lb,Sa,Cb){var ec=y.call(this,document.createElement("a"),Lb,!0)||this;ec.ug=function(){ec.kX(!1);ec.$.ea.Ln(ec.ug)};ec.$c=function(wb){ec.s9f(wb.mb);
return!0};ec.onKeyDown=function(wb){return 13===wb.Ca.keyCode||32===wb.Ca.keyCode?(ec.s9f(wb.mb),!0):!1};ec.ksa=Sa.nb(ec.domElement,xa.a.instance.ga(516),0,la.a.wrh,xa.a.instance.ga(516),bb.a.l1h,ec.disabled);ec.domElement.classList.add(x.zrh);Cb.appendChild(ec.domElement);ec.$.ea.wl(ec.ug);ec.P7i();return ec}function r(Lb,Sa){var Cb=wc.call(this,document.createElement("div"))||this;Cb.sR=function(){Z.ULS.sendTraceTag(537153794,0,50,"SheetDropdownMenu.OnSheetsChanges");Cb.LQf(!1,"OnSheetsChanged")};
Cb.qJi=function(){Cb.Ti()};Cb.pJi=function(){Cb.Uj()};Cb.$=Lb;Cb.HHj=Sa;Cb.PU=!1;Cb.eNb=0;return Cb}function v(Lb,Sa){this.sheetName=null;this.newSheetIndex=0;this.sheetName=Lb;this.newSheetIndex=Sa}function A(Lb,Sa,Cb){var ec=y.call(this,document.createElement("a"),Sa)||this;ec.$c=function(wb){ec.$.Fd(-684145703,wb.mb,0,null);return!0};ec.pEb=function(wb){fb.HelperMethods.qVd(ec.tue,ec.rha,ec.rha+H.a.Ydc,("mouseover"===wb.type||"focus"===wb.type)&&!Kb.g(ec.$).inRangePicker)};ec.$=Sa;ec.rha=X.EwaSettings.ma(503)?
la.a.I8c:la.a.oOe;ec.tue=Cb.nb(ec.domElement,xa.a.instance.ga(514),0,ec.rha,xa.a.instance.ga(515),bb.a.m1c);Lb.appendChild(ec.domElement);ec.yc.ka("contextmenu",function(wb){Ia.g(wb)});ec.yc.ka("mouseover",ec.pEb);ec.yc.ka("mouseout",ec.pEb);yb.a.instance.qa(Y.a.click,ec.domElement,ec.$c);ec.KMa=wa.KeyInputManager.instance.Zr(ec.domElement,ec.$c,qb.a.Rh,qb.a.X0);return ec}function B(Lb,Sa,Cb,ec){ec=void 0===ec?!1:ec;var wb=y.call(this,document.createElement("a"),Sa,ec)||this;wb.$c=function(rc){wb.disabled||
wb.$.Fd(-1935155518,rc.mb,30,null);return!0};wb.pEb=function(rc){rc="mouseover"===rc.type||"focus"===rc.type;var Mc=gb.a(wb.$)?wb.L$a:wb.ksa;fb.HelperMethods.qVd(Mc,wb.rha,wb.rha+H.a.Ydc,rc&&!Kb.g(wb.$).inRangePicker)};wb.Gh=function(){wb.kX(!0)};wb.Df=function(){wb.kX(!1)};wb.rha=X.EwaSettings.ma(503)?la.a.I8c:la.a.oOe;wb.ksa=Cb.nb(wb.domElement,xa.a.instance.ga(512),0,wb.rha,xa.a.instance.ga(513),bb.a.m1c,ec);Lb.appendChild(wb.domElement);wb.yc.ka("contextmenu",function(rc){Ia.g(rc)});X.EwaSettings.ma(503)||
(wb.yc.ka("mouseover",wb.pEb),wb.yc.ka("mouseout",wb.pEb));yb.a.instance.qa(Y.a.click,wb.domElement,wb.$c);wb.KMa=wa.KeyInputManager.instance.Zr(wb.domElement,wb.$c,qb.a.Rh,qb.a.X0);X.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&(Kb.g(wb.$).$b.Bk(wb.Gh),Kb.g(wb.$).$b.vm(wb.Df));return wb}function y(Lb,Sa,Cb){Cb=void 0===Cb?!1:Cb;Lb=dc.call(this,Lb)||this;Lb.ksa=null;Lb.L$a=null;Lb.$=Sa;Lb.FX=Cb;return Lb}function x(){}function C(){this.vHe=new ta.a(!0);this.lHc=
0}function G(Lb){return O.call(this,Lb)||this}function E(Lb){this.Yhh=Lb}var I=b(11),U=b(0),M=b(905),T=b(51),F=b(37),K=b(186),J=b(58);E.prototype.Lc=function(){return!1};E.prototype.executeCommand=function(Lb,Sa){Lb=Sa.command;Sa=null;switch(Lb){case 1243860697:this.Yhh.pKj();break;default:Sa=K.a(Lb)}return Sa||J.Task.Ua(!0)};E.prototype.Ac=function(Lb,Sa){return 1243860697===Sa.command};E.prototype.Qc=function(){return!1};Object(U.a)(E,"SheetDropdownMenuCommandHandler",null,[403]);var O=M.a;Rk(G,
O);G.prototype.zd=function(){var Lb=this;this.$.eB(function(Sa){Sa.uec().then(function(){F.TaskExtensions.Ba(T.GetServiceTaskFactory.Ra(Lb.$.da,32,33,Lb.hb),function(Cb){Lb.jd([new E(Cb.result.fvj)])},Lb.$.la)})})};G.ka=function(Lb){M.a.Qd(392,new G(Lb))};Object(U.a)(G,"SheetDropdownMenuCommandHandlerFactory",M.a,[]);var N=b(232),H=b(5),Q=b(78),ca=b(36),X=b(1),Z=b(15),ea=b(25),ka=b(195),Y=b(13),qa=b(90),fa=b(43),ha=b(245),ia=b(161),wa=b(109),Qa=b(39),S=b(440),da=b(85),xa=b(14),ta=b(34);C.prototype.mKg=
function(Lb,Sa){this.vHe.add(Lb,Sa);this.rS()};C.prototype.rS=function(){var Lb=this;this.lHc=0;ta.a.forEach(this.vHe.cu,function(Sa){Lb.lHc=Lb.Q5c|Sa.value})};Af.Object.defineProperties(C.prototype,{Q5c:{configurable:!0,enumerable:!0,get:function(){return this.lHc}},navigationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!(this.Q5c&1)}},operationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!(this.Q5c&2)}}});Object(U.a)(C,"SheetTabBarDisabledStateManager",
null,[]);var ab=b(244),Na=b(31);x.Qrh="ewa-stb-uir";x.sNe="ewa-stb-drag";x.Arh="ewa-stb-navarea";x.Brh="ewa-stb-navarea-dimensions";x.Drh="ewa-stb-navbutton";x.nU="cui-disabled";x.Crh="ewa-stb-navareaextra";x.$ha="cui-img-container";x.xrh="ewa-stb-contentarea";x.tNe="ewa-stb-left-scrollable";x.FNe="ewa-stb-right-scrollable";x.Orh="ewa-stb-tabarea";x.Nrh="ewa-stb-sheettabmoveindicator";x.HNe="ewa-stb-tabs";x.$Gj="tab-active";x.hHj="tab-inactive";x.gHj="tab-hover";x.Prh="ewa-stb-tabs-ghost";x.bHj="tab-anchor-text";
x.dark="dark";x.light="light";x.aHj="tab-active-text";x.eHj="tab-content-container";x.jHj="tab-text";x.Grh="ewa-stb-nsv-inactive";x.Hrh="ewa-stb-nsv-inactive-svg";x.Erh="ewa-stb-nsv-active";x.Frh="ewa-stb-nsv-active-svg";x.mqh="ewa_nsv_margin";x.yrh="ewa-stb-disable-scrollbar";x.Cri="leave-size-fixed-on-tab-hover-old";x.Bri="leave-size-fixed-on-tab-hover";x.xNe="ewa-stb-locked-sheet";x.yNe="ewa-stb-locked-sheet-svg";x.zNe="ewa-stb-locked-sheet-svg-16px";x.zrh="ewa-stb-dropdown-menu-button";x.imh=
"ewa-active-sheet-menu-item";Object(U.a)(x,"CssClassNames",null,[]);var Ka=b(618),la=b(18),Ea=b(273),ra=b(103),na=b(564),ba=b(177),sa=b(256),ya=b(44),va=b(298),W=b(53),La=b(12),Ia=b(69),mb=b(330),fb=b(10),Ma=b(101),Hb=b(359),Kb=b(21),Ub=b(196),gb=b(391),Db=b(387),Va=b(42),yb=b(233),qb=b(86),dc=ab.a;Rk(y,dc);y.prototype.dispose=function(){this.L$a=this.ksa=this.$=null;dc.prototype.dispose.call(this)};y.prototype.kX=function(Lb){this.FX=Lb;this.domElement.setAttribute(H.a.Tra,Lb.toString());La.DOMElementExtensions.toggleCssClass(this.domElement,
Ka.a.nU,Lb)};Af.Object.defineProperties(y.prototype,{disabled:{configurable:!0,enumerable:!0,get:function(){return this.FX}}});Object(U.a)(y,"SheetBarButton",ab.a,[]);var bb=b(920);Rk(B,y);B.prototype.dispose=function(){yb.a.instance.Aa(Y.a.click,this.domElement,this.$c);wa.KeyInputManager.instance.sv(this.domElement,this.KMa);X.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&Kb.g(this.$)&&Kb.g(this.$).$b&&(Kb.g(this.$).$b.wk(this.Gh),Kb.g(this.$).$b.Nl(this.Df));
y.prototype.dispose.call(this)};B.prototype.kX=function(Lb){var Sa=B.h1f(this.$);y.prototype.kX.call(this,Lb||Sa)};B.h1f=function(Lb){return!Lb.isEditMode||!Lb.va.count};Object(U.a)(B,"InsertSheetButton",y,[]);Rk(A,y);A.prototype.dispose=function(){yb.a.instance.Aa(Y.a.click,this.domElement,this.$c);wa.KeyInputManager.instance.sv(this.domElement,this.KMa);this.tue=null;y.prototype.dispose.call(this)};Object(U.a)(A,"InsertTemplateButton",y,[]);v.prototype.getSheetName=function(){return this.sheetName};
Object(U.a)(v,"MacroRecorderSheetReorderedPayload",null,[409]);var db=b(92),wc=ab.a;Rk(r,wc);r.prototype.dispose=function(){this.Uj();wc.prototype.dispose.call(this)};r.prototype.pKj=function(){this.LQf(!0,"TogglerSheetDropdownMenu")};r.prototype.LQf=function(Lb,Sa){Z.ULS.sendTraceTag(537153795,0,50,"SheetDropdownMenu.RenderSheetMenuInternal: render start. caller: {0}, toggle: {1}, toggleStateId: {2}",Sa,Lb,this.eNb);Lb&&(this.eNb+=1);var Cb=this.$.Fb.sc("UserAction",String.format("SheetDropdownMenu.RenderSheetMenuInternal: caller: {0}, toggle: {1}, toggleStateId: {2}, sheetCount: {3}",
Sa,Lb,this.eNb,this.$.va.count));Lb=this.P9g();appChrome.renderSheetDropdownMenu(this.domElement,this.HHj,Lb,this.eNb,this.qJi,this.pJi,function(){Cb.stop()},gb.a(this.$))};r.prototype.P9g=function(){for(var Lb=this.$.va,Sa=[],Cb=0;Cb<Lb.count;Cb++){var ec=Object(da.a)(Ma.a,Lb.getItem(Cb));0===ec.wy&&(ec=this.O9g(ec),Sa.push(ec))}return Sa};r.prototype.O9g=function(Lb){var Sa={};Sa.key=Lb.name;Sa.text=Lb.name;Sa.onClick=this.Q9g(Lb);Lb.active&&(Sa.className=gb.a(this.$)?"ewa-active-sheet-menu-item-present-mode":
x.imh);return Sa};r.prototype.Q9g=function(Lb){var Sa=this;return function(){var Cb=new db.a(-1876836819,0,Sa.$.Jc,30,null),ec={};Sa.$.Ka.Kb(Cb,(ec[H.a.LPd]=Lb.name,ec))}};r.prototype.Ti=function(){if(!this.PU){var Lb=this.$.va;Lb.Kf(this.sR);Lb.wUc(this.sR);Lb.lY(this.sR);Lb.Iga(this.sR);Lb.zFa(this.sR);Lb.Ome(this.sR);Lb.uYa(this.sR);this.PU=!0}};r.prototype.Uj=function(){if(this.PU){var Lb=this.$.va;Lb.wg(this.sR);Lb.nId(this.sR);Lb.P6(this.sR);Lb.Jma(this.sR);Lb.XPa(this.sR);Lb.OPf(this.sR);Lb.RHb(this.sR);
this.PU=!1}};Object(U.a)(r,"SheetDropdownMenu",ab.a,[690,10]);var nb=b(367);Rk(z,y);z.prototype.dispose=function(){this.YOj();y.prototype.dispose.call(this)};z.prototype.kX=function(Lb){y.prototype.kX.call(this,Lb||!this.$.ea.nwa)};z.prototype.s9f=function(Lb){this.disabled||(Z.ULS.sendTraceTag(537153793,0,50,"SheetDropdownMenuAnchor.ToggleMenu: inputMethod: {0}",nb.a[Lb]),this.$.Ka.Kb(new db.a(1243860697,Lb,this.$.Jc,30,null)))};z.prototype.P7i=function(){yb.a.instance.qa(Y.a.click,this.domElement,
this.$c);wa.KeyInputManager.instance.qa(Y.a.Lb,this.domElement,this.onKeyDown)};z.prototype.YOj=function(){yb.a.instance.Aa(Y.a.click,this.domElement,this.$c);wa.KeyInputManager.instance.Aa(Y.a.Lb,this.domElement,this.onKeyDown)};Object(U.a)(z,"SheetDropdownMenuAnchor",y,[]);var zb=b(61),ma=b(204),P=b(127),oa=b(202),Ja=b(133),$a=b(59),Ta=b(217),pa=b(203),Da=b(173),rb=b(134);n.prototype.WM=function(){return this.sheet.active};n.prototype.Und=function(){return this.sheet.isLockPausedInSession};n.prototype.Asa=
function(){return this.fm?la.a.wNe:this.WM()?la.a.vNe:la.a.uNe};n.prototype.Wna=function(){return this.sheet.ij?bb.a.cJf:X.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?bb.a.JOj:bb.a.IOj};n.prototype.ZTd=function(){return X.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?16:13};n.prototype.aUd=function(){return X.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?16:12};n.prototype.Bha=function(){return null};
n.prototype.Bsa=function(){return this.fm?this.kw?X.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?x.zNe:x.yNe:x.xNe:null};n.prototype.AVd=function(){return null};n.prototype.ks=function(){return null};n.prototype.Zjd=function(){return 0};n.prototype.WVc=function(){return!0};Object(U.a)(n,"LockPausedSheetIconDataSource",null,[655]);w.prototype.WM=function(){return this.sheet.active};w.prototype.Und=function(){return this.sheet.ij};w.prototype.Asa=function(){return this.fm?
la.a.wNe:this.WM()?la.a.vNe:la.a.uNe};w.prototype.Wna=function(){return bb.a.cJf};w.prototype.ZTd=function(){return X.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?16:13};w.prototype.aUd=function(){return X.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?16:12};w.prototype.Bha=function(){return null};w.prototype.Bsa=function(){return this.fm?this.kw?X.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?
x.zNe:x.yNe:x.xNe:null};w.prototype.AVd=function(){return null};w.prototype.ks=function(){return null};w.prototype.Zjd=function(){return 0};w.prototype.WVc=function(){return!0};Object(U.a)(w,"LockedSheetIconDataSource",null,[655]);f.prototype.WM=function(){return this.sheet.active};f.prototype.Und=function(){return this.sheet.Md.Wx};f.prototype.Bha=function(){return this.kw?this.WM()?x.Frh:x.Hrh:this.WM()?x.Erh:x.Grh};f.prototype.Asa=function(){return!this.WM()&&this.d2f()?la.a.wth:la.a.vth};f.prototype.Wna=
function(){return!this.WM()&&this.d2f()?bb.a.pvj:bb.a.ovj};f.prototype.ZTd=function(){return 14};f.prototype.aUd=function(){return 16};f.prototype.Bsa=function(){return x.mqh};f.prototype.AVd=function(){return this.sheet.Md.vmb};f.prototype.ks=function(){return this.FKj};f.prototype.Zjd=function(){return 8};f.prototype.WVc=function(){return!1};Object(U.a)(f,"NamedSeetViewSheetIconDataSource",null,[655]);var Ab=b(162),ob=b(130);m.prototype.zcg=function(){if(this.pI&&(this.ll||this.SAa)){if(this.kw){var Lb=
this.dataSource.Wna();this.Wna!==Lb&&(this.SAa&&this.SAa.parentNode.removeChild(this.SAa),this.l$e(),this.Wna=Lb)}else Lb=this.dataSource.Asa(),this.Asa!==Lb&&(this.uJd(this.ll,this.Asa,Lb),this.Asa=Lb);Lb=this.dataSource.Bha();this.Bha!==Lb&&(this.kw?this.Hdj(this.SAa,this.Bha,Lb):this.uJd(this.ll,this.Bha,Lb),this.Bha=Lb);Lb=this.dataSource.Bsa();this.Bsa!==Lb&&(this.uJd(this.pI,this.Bsa,Lb),this.Bsa=Lb);this.dataSource.ks()&&!this.dataSource.WM()&&this.clearToolTip()}};m.prototype.Ozj=function(Lb,
Sa,Cb){this.Qai(Lb,Sa,Cb);La.DOMElementExtensions.setVisible(this.pI,this.dataSource.Und())};m.prototype.clearToolTip=function(){var Lb=this;F.TaskExtensions.Ba(this.zBb,function(){dialogControls.clearToolTip(Lb.dataSource.ks())},this.$.la,3)};m.prototype.Qai=function(Lb,Sa,Cb){this.pI&&this.Zef!==Lb&&(this.pI.parentNode.removeChild(this.pI),this.Bsa=this.Bha=this.Wna=this.Asa=this.UQc=null,this.dataSource.ks()&&(this.yc.detach("mouseover",!0),this.yc.detach("mouseout",!0)));this.pI||(this.UQc=document.createElement("span"),
Sys.UI.DomElement.addCssClass(this.pI,Ka.a.$ha),Sys.UI.DomElement.addCssClass(this.pI,la.a.RA),X.EwaSettings.ma(503)?Lb===this.dataSource.WVc()?Sa.appendChild(this.pI):Sa.insertBefore(this.pI,Cb):Lb?Sa.insertBefore(this.pI,Cb):Sa.appendChild(this.pI),this.kw?this.l$e():(this.ll=document.createElement("img"),this.ll.tabIndex=-1,this.ll.alt=this.dataSource.altText,this.pI.appendChild(this.ll),this.ll.src=W.a.Te(this.dataSource.Zjd())),this.dataSource.ks()&&(this.yc.ka("mouseover",this.vN,!0),this.yc.ka("mouseout",
this.uN,!0)),this.Zef=Lb)};m.prototype.Hdj=function(Lb,Sa,Cb){Lb&&(Sys.UI.DomElement.removeCssClass(Lb,Sa),Sys.UI.DomElement.addCssClass(Lb,Cb))};m.prototype.uJd=function(Lb,Sa,Cb){Sa&&Sys.UI.DomElement.removeCssClass(Lb,Sa);Cb&&Sys.UI.DomElement.addCssClass(Lb,Cb)};m.prototype.dispose=function(){qa.a.Ia(this.q1)};m.prototype.l$e=function(){var Lb=this.$.da.za(388);Lb?(this.SAa=Lb.ova(this.dataSource.Wna(),this.dataSource.ZTd(),this.dataSource.aUd()))?this.pI.appendChild(this.SAa):Z.ULS.shipAssertTag(537153763,
0,!1,"Sheeticon.InsertCurrentSvgIcon: Svg with id {0} was not found.",this.dataSource.Wna()):Z.ULS.shipAssertTag(537153792,0,!1,"Sheeticon.InsertCurrentSvgIcon: Unable to recieve SvgIconProvider service.")};Af.Object.defineProperties(m.prototype,{yc:{configurable:!0,enumerable:!0,get:function(){return this.q1||(this.q1=ob.a.instance.Td(this.pI))}},zBb:{configurable:!0,enumerable:!0,get:function(){var Lb=this;if(this.nqa)return this.nqa;var Sa=new Ab.a;this.$.eB(function(Cb){F.TaskExtensions.Ba(Cb.Lsd(),
function(){Sa.setResult(!0)},Lb.$.la,3)});return this.nqa=Sa.task}},pI:{configurable:!0,enumerable:!0,get:function(){return this.UQc}}});Object(U.a)(m,"SheetIcon",null,[10]);var sb=b(368),Pb=b(87),Aa=b(159),Ya=Pb.a;Rk(l,Ya);l.prototype.dispose=function(){this.yna&&(yb.a.instance.Aa(Y.a.$j,this.yna.domElement,this.oca),sb.a.instance.Aa(this.yna.domElement,this.Jl),this.Mfe=null);this.$=null;Ya.prototype.dispose.call(this)};l.prototype.showContextMenu=function(Lb,Sa,Cb){this.yna.activate(Sa,ca.a.nqd());
Sa=new db.a(-1075099431,Sa,this.$.Jc,30,null);var ec,wb={};return!Aa.a(ec=this.$.Ka.Kb(Sa,(wb[H.a.H0f]=Lb,wb[l.gvj]=this.yna.sheet,wb[H.a.I0f]=Cb,wb)))&&(6!==ec.status||ec.result)};l.prototype.rename=function(Lb,Sa){this.$.Fd(817296323,Sa,Lb?19:0,null)};Af.Object.defineProperties(l.prototype,{yna:{configurable:!0,enumerable:!0,get:function(){return this.Mfe}}});l.gvj="Sheet";Object(U.a)(l,"SheetOpsSheetClickHelper",Pb.a,[]);var kb=b(41);Rk(k,y);k.prototype.COh=function(){return La.DOMElementExtensions.canReceiveFocus(this.anchor)?
this.anchor:null};k.prototype.dispose=function(){if(this.PU){ha.a.instance.Aa(Y.a.pointerDown,this.domElement,this.onPointerDown);wa.KeyInputManager.instance.Aa(Y.a.Lb,this.domElement,this.onKeyDown);wa.KeyInputManager.instance.Aa(Y.a.ap,this.domElement,this.zz);yb.a.instance.Aa(Y.a.click,this.domElement,this.$c);ha.a.instance.Aa(Y.a.iW,this.domElement,this.rya);ha.a.instance.Aa(Y.a.my,this.domElement,this.f6);if(this.Dzb||X.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))ha.a.instance.Aa(Y.a.Nd,
this.domElement,this.pf),this.Rwa&&(ia.a.instance.Aa(Y.a.qe,this.domElement,this.pf),ia.a.instance.Aa(Y.a.mg,this.domElement,this.BN));this.PU=!1;this.i5b="#BEBBB8"}qa.a.oc([this.pye,this.Cte]);this.yO=this.pE=this.wEc=this.cS=this.Cte=this.pye=null;if(this.wna){for(var Lb=ak(this.wna),Sa=Lb.next();!Sa.done;Sa=Lb.next())Sa.value.dispose();this.wna=null}this.color=this.jWb=null;y.prototype.dispose.call(this)};k.prototype.kX=function(Lb){Lb&&this.rna(!1,!1);y.prototype.kX.call(this,Lb)};k.prototype.vRd=
function(Lb){if($a.a.rg.ZQ){this.DHe();var Sa=T.GetServiceTaskFactory.Ra(this.$.da,322,323,1);F.TaskExtensions.Ba(Sa,function(Cb){ma.UISurfaces.CQ().then(function(ec){var wb=Cb.result;wb.nrj(ec);wb.show(Lb);return null},function(ec){Z.ULS.sendTraceTag(537153688,0,15,"SheetTabButton.ShowNamedSheetViewTeachingUI: Failed to GetNotificationsAPIAsync: {0}",ec);return null})},this.la,3)}};k.prototype.ple=function(){var Lb=this;if(this.sheet.active&&this.$.Wq){var Sa=this.$.Wq,Cb=Kb.g(this.$),ec=Cb.Rj;if(this.sheet.Md.Wx){if(!this.QCb){var wb=
new f(this.sheet,this.cS.wwc,function(){return Lb.color?k.QQd(Lb.color):!1},this.kw);this.QCb=new m(this.$,wb);this.wna.add(this.QCb)}ec?Cb.Qeb(1):Sa.classList.add(la.a.TPe);Sa=k.Ced(H.a.Gqf);Cb=k.Ced(H.a.wwd);ec=k.Ced(H.a.xqf);wb=this.sheet.Md.CQd;this.sheet.Md.CQd=!1;"true"===ec&&wb&&this.$.ea.FQd?(P.a.mv(H.a.xqf,"false",P.a.OV),this.$.ea.FQd=!1,this.vRd(3)):"true"===Sa&&"true"===Cb&&"true"===ec?this.$.ea.GQd&&this.$.ea.jLb&&(this.sheet.Md.dK?(Sa=1,P.a.mv(H.a.wwd,"false",P.a.OV),this.$.ea.jLb=!1):
Sa=0,P.a.mv(H.a.Gqf,"false",P.a.OV),this.$.ea.GQd=!1,this.vRd(Sa)):this.sheet.Md.dK&&"true"===Cb&&"true"===ec&&this.$.ea.jLb&&(P.a.mv(H.a.wwd,"false",P.a.OV),this.$.ea.jLb=!1,this.vRd(2))}else this.DHe(),ec?Cb.Qeb(0):Sa.classList.remove(la.a.TPe)}};k.prototype.DHe=function(){if(X.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC")){var Lb=this.$.da.za(322);Lb&&Lb.dismiss()}else this.$.Zpd&&(Lb=T.GetServiceTaskFactory.Ra(this.$.da,322,323,0),F.TaskExtensions.Ba(Lb,function(Sa){Sa.result.dismiss()},
this.$.la,3))};k.prototype.afb=function(){this.name=this.sheet.name;this.domElement.className=this.sheet.active||this.r6a()?x.$Gj:x.hHj;X.EwaSettings.isChangeGateEnabled("OfficeVSO:5262355_SheetTabFocusBugFix")?this.yO.parentNode.classList.add(x.Bri):this.yO.parentNode.classList.add(x.Cri);this.pdg();this.Kmd&&this.ple();this.Pzj();this.vdg();this.aBc();this.Kmd||this.ple()};k.prototype.URi=function(){this.JPd=!0;this.rna(!0,!0,"OnSheetReorderStarted")};k.prototype.TRi=function(){this.JPd=!1;this.rna(!1,
void 0,"OnSheetReorderEnded")};k.prototype.activate=function(Lb,Sa){Lb=void 0===Lb?0:Lb;Sa=void 0===Sa?!1:Sa;this.V1b()||(this.sheet.activate(),Sa&&Kb.g(this.$).focus(),Sa={},Lb=(Sa.InputMethod=nb.a[Lb],Sa.AppMode=this.$.Jc,Sa.Location="canvas",Sa),rb.b(this.$).Cd(Ja.a.cvj,Lb))};k.prototype.odg=function(Lb){this.i5b=Lb?"#797775":"#BEBBB8";this.a4c=Lb?-.5:.5;this.YGc=Lb?pa.a.Qo("#3B3A39"):pa.a.Qo("#F5F5F5");this.vdg()};k.prototype.ioj=function(Lb){this.Dzb=Lb};k.prototype.Yyd=function(Lb){Lb.A1c();
this.Kwe(Lb)};k.prototype.Kwe=function(Lb){Lb.X_a();this.sheet.activate()};k.prototype.yzg=function(Lb){Lb=new db.a(-1876836819,Lb,this.$.Jc,30,null);var Sa={};return this.$.Ka.Kb(Lb,(Sa[H.a.LPd]=this.sheet.name,Sa))};k.prototype.pdg=function(){this.yO.parentNode.setAttribute("sheet-title",this.yO.innerText)};k.prototype.aBc=function(){var Lb=this.gIh();this.anchor.setAttribute(H.a.Gt,Lb);this.anchor.setAttribute(H.a.Xga,this.sheet.active.toString())};k.prototype.gIh=function(){var Lb=this.sheet.Md.Wx,
Sa=this.sheet.Md.vmb,Cb=this.sheet.ij,ec=this.sheet.isLockPausedInSession;return Lb&&Cb?String.format(xa.a.instance.lb(20),this.name,Sa):Lb&&ec?String.format(xa.a.instance.lb(22),this.name,Sa):Lb?String.format(xa.a.instance.lb(19),this.name,Sa):Cb?String.format(xa.a.instance.lb(18),this.name):ec?String.format(xa.a.instance.lb(21),this.name):this.name};k.prototype.activateSheet=function(Lb){Lb=void 0===Lb?0:Lb;if(ca.a.nqd()){if(X.EwaSettings.isChangeGateEnabled("OfficeVSO:4099273_PromptForCommentsOnSheetChange")&&
this.V1b())return J.Task.Ua(!1);Da.a.current.QW="ActivateSheet";this.sheet.activate();return J.Task.Ua(!0)}return this.yzg(Lb)};k.prototype.vdg=function(){var Lb=this.sheet.tabColor;this.color=Lb?pa.a.Qo(Lb):this.Ach;this.Ldf=k.QQd(this.color);this.rna(!1,void 0,"UpdateTabColor")};k.prototype.rna=function(Lb,Sa,Cb){Sa=void 0===Sa?!1:Sa;Cb=void 0===Cb?null:Cb;if(this.sheet){Cb=this.sheet.active;var ec=this.r6a(),wb=!!this.sheet.tabColor,rc=pa.a.$F(Cb||ec?Ta.a.white:this.color);this.pE.style.background=
"";Cb||ec?(wb?X.EwaSettings.isChangeGateEnabled("OfficeVSO:5293663_SheetTabHighContrastBackgroundBug")&&this.$.UKa?this.ftj():this.fm?this.etj():this.dtj():this.fm||(this.pE.style.backgroundColor=rc),this.pE.style.height=this.M0c.toString()+"px"):(this.pE.style.filter="",this.pE.style.backgroundColor=rc,this.pE.style.height=this.N0c.toString()+"px");this.yO.className=Cb?x.aHj:ec?x.dark:this.Ldf?x.light:x.dark;rc=ak(this.wna);for(var Mc=rc.next();!Mc.done;Mc=rc.next())Mc.value.zcg();this.fm&&(Lb&&
!wb&&(this.pE.style.backgroundColor="#E1DFDD"),La.DOMElementExtensions.toggleCssClass(this.domElement,x.gHj,Lb),Sa?(wb||(this.pE.style.backgroundColor=this.i5b),this.domElement.style.backgroundColor=this.i5b):(wb||(this.pE.style.backgroundColor=""),this.domElement.style.backgroundColor=""));this.yO.style.fontWeight=Cb||ec||!this.fm&&Lb?this.fm?"600":"bold":""}else Z.ULS.sendTraceTag(537153687,0,15,"SheetTabButton.SetTabColors: can't change colors to a sheet tab without sheet, whihc means its not rendered. caller: {0}",
Cb)};k.prototype.etj=function(){var Lb=this.pE.style,Sa=pa.a.$F(k.e_c(this.color,this.a4c));Lb.background=Sa};k.prototype.dtj=function(){var Lb=this.pE.style,Sa=pa.a.$F(k.e_c(this.color,1)),Cb=pa.a.$F(k.e_c(this.color,this.a4c)),ec="";if(ea.a.dxa)ec="-webkit-";else if(ea.a.xf)ec="-moz-";else if(ea.a.yf){if(ec="-ms-",!ea.a.e6a){Lb.filter=String.format("progid:DXImageTransform.Microsoft.gradient(startColorstr={0}, endColorstr={1})",Sa,Cb);return}}else ea.a.Bef&&(ec="-o-");Lb.background=String.format("{0}linear-gradient({1}, {2})",
ec,Sa,Cb)};k.prototype.ftj=function(){this.pE.style.background="transparent"};k.prototype.Y3g=function(){this.wEc=document.createElement("a");this.anchor.removeAttribute("Href");this.anchor.className=x.bHj;La.DOMElementExtensions.ju(this.anchor,H.a.Tnb,null,null);this.tabIndex=-1};k.prototype.$9g=function(){this.pE=document.createElement("span");this.pE.className=x.eHj;this.yO=document.createElement("span");this.yO.className=x.jHj;this.yO.dir=this.sheet.rtlName?"rtl":"ltr";this.pE.appendChild(this.yO)};
k.prototype.Pzj=function(){for(var Lb=this.$.fJ,Sa=ak(this.wna),Cb=Sa.next();!Cb.done;Cb=Sa.next())Cb.value.Ozj(Lb,this.pE,this.yO)};k.prototype.r6a=function(){return Kb.g(this.$).r6a(this.sheet)};k.prototype.oEj=function(){this.zjd.start();this.Tnd=!0};k.prototype.vKe=function(Lb){if(this.Tnd){this.zjd.stop();var Sa={};Lb=(Sa["Sheet index"]=this.sheet.index,Sa["Active Sheet"]=this.sheet.active,Sa["Hovering time"]=this.zjd.qc,Sa["Has been clicked"]=Lb,Sa);Z.ULS.sendTraceTag(537153686,0,50,kb.c(Lb));
this.Tnd=!1}};k.prototype.$8i=function(){ha.a.instance.qa(Y.a.pointerDown,this.domElement,this.onPointerDown);wa.KeyInputManager.instance.qa(Y.a.Lb,this.domElement,this.onKeyDown);wa.KeyInputManager.instance.qa(Y.a.ap,this.domElement,this.zz);this.yc.ka("mouseover",this.vN);this.yc.ka("mouseout",this.uN);ha.a.instance.qa(Y.a.iW,this.domElement,this.rya);ha.a.instance.qa(Y.a.my,this.domElement,this.f6);if(this.Dzb||X.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))ha.a.instance.qa(Y.a.Nd,
this.domElement,this.pf),this.Rwa&&(ia.a.instance.qa(Y.a.qe,this.domElement,this.pf),ia.a.instance.qa(Y.a.mg,this.domElement,this.BN));yb.a.instance.qa(Y.a.click,this.domElement,this.$c);this.PU=!0};k.prototype.V1b=function(){var Lb=this.$.da.za(65);return Lb&&Lb.mba()?(Lb.fJb(),this.Kwe(Lb),!0):!1};k.Ced=function(Lb){var Sa=P.a.get(Lb);Sa||(P.a.mv(Lb,"true",P.a.OV),Sa=P.a.get(Lb));return Sa};k.e_c=function(Lb,Sa){if(1<Sa||-1>Sa)return Lb;var Cb=Lb.r,ec=Lb.g;Lb=Lb.b;0<Sa?(Cb=Cb*(1-Sa)+255*Sa,ec=ec*
(1-Sa)+255*Sa,Lb=Lb*(1-Sa)+255*Sa):(Cb*=1+Sa,ec*=1+Sa,Lb*=1+Sa);return Ta.a.eub(Math.round(Cb),Math.round(ec),Math.round(Lb))};k.QQd=function(Lb){return 128>=(222*Lb.r+707*Lb.g+71*Lb.b)/1E3};Af.Object.defineProperties(k.prototype,{Ach:{configurable:!0,enumerable:!0,get:function(){return this.YGc||(this.YGc=pa.a.Qo("#F5F5F5"))}},name:{configurable:!0,enumerable:!0,get:function(){return this.yO.innerText},set:function(Lb){this.yO&&(this.yO.innerText=Lb,this.aBc(),this.pdg())}},sheet:{configurable:!0,
enumerable:!0,get:function(){return this.jWb}},anchor:{configurable:!0,enumerable:!0,get:function(){return this.wEc}},tabIndex:{configurable:!0,enumerable:!0,get:function(){return this.anchor.tabIndex},set:function(Lb){this.anchor.tabIndex=Lb}}});Object(U.a)(k,"SheetTabButton",y,[]);Rk(e,y);Object(U.a)(e,"WorkbookProtectionButton",y,[]);var lb=b(50),ac=b(46),Dc=b(56),Zb=ab.a;Rk(d,Zb);d.prototype.nb=function(Lb,Sa,Cb,ec,wb,rc,Mc){Mc=void 0===Mc?!1:Mc;Lb.removeAttribute("Href");Lb.setAttribute(H.a.Hd,
H.a.Hs);Lb.className=x.Drh;Lb.title=Sa;Lb.tabIndex=0;this.kw&&rc?Cb=this.svgIconProvider.hba(rc,12,12,Lb,24,24):(Sa=document.createElement("span"),Sa.className=this.fm?la.a.LYg:la.a.RA,Sa.classList.add(Ka.a.$ha),Sa.tabIndex=-1,Lb.appendChild(Sa),rc=document.createElement("img"),rc.src=W.a.Te(Cb),rc.className=ec,rc.alt=wb,rc.tabIndex=-1,Sa.appendChild(rc),Cb=rc);Mc&&Lb.classList.add(Ka.a.nU);return Cb};d.prototype.dispose=function(){if(this.$){var Lb=this.$.va;Lb.wg(this.wh);Lb.nId(this.fya);Lb.P6(this.XC);
Lb.Jma(this.JEb);Lb.XPa(this.Bya);Lb.OPf(this.fCf);Lb.RHb(this.hCf);Lb.pbj(this.gCf);Lb.AId(this.Tsf);Lb.LPf(this.Usf);Lb.MPf(this.Vsf);Lb.NPf(this.rOa);this.$.ol(this.Yc);this.$.kD(this.Ri);Va.a(this.$)&&Va.a(this.$).Tf.hda(this.sF);this.zta&&Kb.g(this.$).oPf(this.RDb);ka.a.instance.Aa(Y.a.RC,this.domElement,this.g6)}qa.a.oc(this.Gwd);this.Gwd=null;if(this.qK)for(Lb=0;Lb<this.qK.length;Lb++){var Sa=La.DOMElementExtensions.QJ(this.qK[Lb],this.domElement,!1,"a");Sa&&fa.a.Cma(Sa)}qa.a.Ia(this.dC);qa.a.Ia(this.Awc);
qa.a.Ia(this.PPd);this.PPd=this.Awc=this.Qxb=this.vH=this.dC=null;this.$&&this.oz&&this.kQ(!1);this.W$=null;this.KNd(null,"Dispose");this.wMb=this.pM=this.b7b=null;this.d0c();this.Ocb=this.Bwc=this.QPd=this.Qk=this.qK=this.$=this.ea=null;Zb.prototype.dispose.call(this)};d.prototype.Uf=function(Lb,Sa){if(!Sa){Z.ULS.shipAssertTag(537153760,0,0<this.mh.length,"There is no sheet tab button.");if(!this.mh.length)return!1;Lb=null;for(var Cb=ak(this.mh),ec=Cb.next();!ec.done&&!(Lb=ec.value.COh());ec=Cb.next());
if(!Lb)return Z.ULS.shipAssertTag(537153759,0,!1,"There is no focusable tab element."),!1;La.DOMElementExtensions.setFocus(Lb)}return!Sa};d.prototype.$g=function(Lb){return La.DOMElementExtensions.nf(this.jc,Lb)};d.prototype.hj=function(){};d.prototype.Dj=function(){};d.prototype.reorderSheets=function(Lb,Sa,Cb){if(this.w_&&this.w_!==Lb){var ec=this.w_.index;this.xdj(this.w_,Lb,Sa);Lb=Lb?Lb.index-1:Sa?this.$.va.count-1:0;ec!==Lb&&(this.Nvi(ec,Lb,Cb),this.Fkh(this.w_.name,Lb))}};d.prototype.t_h=function(Lb){Lb=
this.Lia(Lb);return-1!==Lb&&this.Iu<=Lb&&Lb<=this.fK?this.mh[Lb].domElement:null};d.prototype.iTj=function(Lb){if(this.kw){for(var Sa=0;Sa<this.qK.length;Sa++){var Cb=this.qK[Sa];if(Cb&&this.svgIconProvider){var ec=Cb.parentNode;this.QOf(Cb);ec&&(this.qK[Sa]=this.svgIconProvider.hba(Lb?this.AHf[Sa]:this.Hwd[Sa],12,12,ec,24,24))}}for(Sa=0;Sa<this.mh.length;Sa++)this.mh[Sa].odg(Lb);this.zRa&&this.zRa.ksa&&this.ndg(bb.a.m1h,this.zRa,Lb);this.vH&&this.vH.ksa&&this.ndg(bb.a.U_g,this.vH,Lb)}};d.prototype.ndg=
function(Lb,Sa,Cb){Sa.L$a||(Sa.L$a=this.svgIconProvider.hba(Lb,12,12,Sa.ksa.parentNode,24,24));Sa.L$a&&(La.DOMElementExtensions.setVisible(Sa.ksa,!Cb),La.DOMElementExtensions.setVisible(Sa.L$a,Cb))};d.prototype.YRi=function(Lb,Sa){var Cb=Kb.g(this.$),ec=Cb.inRangePicker,wb=fb.HelperMethods.En(Sa);if(Cb.isEditing&&!ec){var rc=Cb.sj?"formulaBar_end_edit_sheet_changed":"cell_text_end_edit_sheet_changed",Mc=void 0;X.EwaSettings.t6a&&(Mc=[Object(Ub.a)(Cb.$b.textBox.$Aa)]);Ub.b(this.$).WSa(wb.rawEvent,
rc,Mc);Cb.endEdit(!0,"SheetTabBar.OnSheetTabMouseDown")}Cb=this.Rwa&&3===Sa.mb;!(2===Sa.mb&&wb.button===Sys.UI.MouseButton.leftButton||Cb)||ec||this.fF||Va.a(this.$).Pp()||(Cb&&Lb.URi(),this.EAb=Sa.clientPoint.x,this.TY=Sa,this.LNg(Lb))};d.prototype.WRi=function(Lb){!this.oz&&this.fF&&this.ERd(Lb.sheet,!1)};d.prototype.XRi=function(Lb){this.oz||(this.fF&&this.reorderSheets(Lb.sheet,!1,!0),this.kQ());this.a0()};d.prototype.Hoe=function(){return this.$.isEditMode&&!ra.k(this.$.ng)};d.prototype.a0=function(){var Lb=
this,Sa=fb.HelperMethods.dca(function(){Lb.iRj();Lb.fm&&Lb.Fsj();Lb.rOd()});Z.ULS.sendTraceTag(537153757,0,50,"SheetTabBarControl.RearrangeContentAreaAndNavAreaExtra: duration = {0}",Sa)};d.prototype.Fsj=function(){var Lb=this.fK===this.mh.length-1;La.DOMElementExtensions.toggleCssClass(this.Ocb,this.$.fJ?x.FNe:x.tNe,!!this.Iu);La.DOMElementExtensions.toggleCssClass(this.Ocb,this.$.fJ?x.tNe:x.FNe,!Lb)};d.prototype.rOd=function(Lb){Lb=void 0===Lb?!1:Lb;var Sa=!this.Iu,Cb=this.fK===this.mh.length-1;
this.xZf(4,this.sheetTabActivatePreviousHidden,!Sa);this.xZf(5,this.sheetTabActivateNextHidden,!Cb);this.Vvc(0,Sa||Lb);this.Vvc(1,Sa||Lb);this.Vvc(2,Cb||Lb);this.Vvc(3,Cb||Lb)};d.prototype.xZf=function(Lb,Sa,Cb){if(Lb=this.qK[Lb]){La.DOMElementExtensions.setVisible(Lb,Cb);var ec=this.n_e(Lb);ec.title="img"===Lb.nodeName?Lb.alt=0<this.mh.length&&Cb?Sa:"":Lb.title=0<this.mh.length&&Cb?Sa:"";ec.tabIndex=Cb?0:-1}};d.prototype.n_e=function(Lb){return this.kw?Lb.parentNode:Lb.parentNode.parentNode};d.prototype.Vvc=
function(Lb,Sa){if(Lb=this.qK[Lb])Lb=this.n_e(Lb),void 0!==Lb&&null!==Lb&&(!this.mh.length||Sa?(Lb.classList.add(Ka.a.nU),Lb.setAttribute(H.a.Tra,"true")):(Lb.classList.remove(Ka.a.nU),Lb.setAttribute(H.a.Tra,"false")))};d.prototype.qRa=function(Lb){var Sa=this.$.fJ?this.mh.length-1:0,Cb=this.E1e(this.$.fJ?0:this.mh.length-1);Cb&&(Cb.borderRightWidth=Lb?"1px":"0");this.Iu!==this.fK&&(Cb=this.E1e(Sa))&&(Cb.borderRightWidth="0")};d.prototype.Cle=function(Lb,Sa){this.mh||(this.mh=[]);-1===Sa?Array.add(this.mh,
Lb):Array.insert(this.mh,Sa,Lb)};d.prototype.A4b=function(Lb,Sa){var Cb=-1,ec=null;Sa||(Cb=this.xSh(Lb.index),-1!==Cb&&(ec=this.mKa(Cb)));Lb=new k(this.$,this.Qk,ec,Lb,this,this.fm,this.kw);this.Cle(Lb,Cb);La.DOMElementExtensions.setVisible(Lb.domElement,!0)};d.prototype.ERd=function(Lb,Sa){var Cb=this.t2a(Lb);if(Cb){this.vkd=Lb;this.Yvd=Sa;Lb=Cb.domElement;Cb=this.isRtl?Lb.offsetLeft+(this.Qk.scrollWidth-this.Qk.clientWidth-this.Qk.scrollLeft):Lb.offsetLeft-this.Qk.scrollLeft;if(!this.isRtl&&Sa||
this.isRtl&&!Sa)Cb+=Lb.offsetWidth;this.zwc.style.left=fb.HelperMethods.hc(Cb-4);La.DOMElementExtensions.setVisible(this.zwc,!0)}};d.prototype.n7e=function(){La.DOMElementExtensions.setVisible(this.zwc,!1)};d.prototype.l0=function(Lb){var Sa=this,Cb=fb.HelperMethods.dca(function(){switch(Lb){case 0:Sa.Cuc(0);break;case 1:Sa.Cuc(Sa.Iu-1);break;case 2:Sa.Cuc(Sa.Iu+1);break;case 3:Sa.scrollIntoView(Sa.mh.length-1);break;case 4:Sa.Iu&&1<=Sa.mh.length&&(Sa.pje(Sa.Iu-1),Sa.iMd());break;case 5:Sa.fK!==Sa.mh.length-
1&&1<=Sa.mh.length&&(Sa.pje(Sa.fK+1),Sa.iMd());break;case 6:Sa.iMd()}});this.j7b&&this.fF&&this.SNb();Z.ULS.sendTraceTag(537153755,0,50,"SheetTabBarControl.ScrollSheetTabs: operation = {0}, duration = {1}",Lb,Cb)};d.prototype.pje=function(Lb){(Lb=this.DQ(Lb))&&Lb.activate()};d.prototype.QAh=function(Lb){if(0===Lb.wy)for(var Sa=this.$.va,Cb=0,ec=0,wb=Sa.count;ec<wb;ec++){var rc=Object(da.a)(Ma.a,Sa.getItem(ec));if(rc===Lb)return Cb;0===rc.wy&&Cb++}return-1};d.prototype.DAh=function(Lb){var Sa=this.$.va;
Lb=Lb.index+1;for(var Cb=Sa.count;Lb<Cb;Lb++){var ec=Object(da.a)(Ma.a,Sa.getItem(Lb));if(0===ec.wy)return ec}return null};d.prototype.Lia=function(Lb){for(var Sa=0;Sa<this.mh.length;Sa++){var Cb=this.DQ(Sa);if(!Cb)Z.ULS.sendTraceTag(537153754,0,15,"SheetTabBarControl.FindMatchingSheetTabIndex: sheetTabButton[{0}] is null even though index is not out of bounds!",Sa);else if(Cb.sheet===Lb)return Sa}return-1};d.prototype.t2a=function(Lb){Lb=this.Lia(Lb);return this.DQ(Lb)};d.prototype.Nvi=function(Lb,
Sa,Cb){var ec={};ec.a=this.$.ya.UserSessionId;ec.b=Cb;ec.c=this.U6b;ec.d=Lb;ec.e=Sa;ec.f=this.$.va.count;lb.b().De(2,ec,Cb)};d.prototype.xdj=function(Lb,Sa,Cb){var ec=Object(da.a)(Hb.a,this.$.va);Sa?(Sa=Sa.index,Sa=Lb.index<Sa?Sa-1:Sa):Sa=Cb?ec.count-1:0;ec.reorderSheet(Lb,Sa,!0)};d.prototype.VYf=function(Lb){Kb.g(this.$).ig.zo(Lb)};d.prototype.LNg=function(Lb){if(!this.Wsc){var Sa=this.domElement.ownerDocument.body;this.oz?(ha.a.instance.qa(Y.a.hh,document.documentElement,this.pN),this.Rwa&&(ia.a.instance.qa(Y.a.mg,
document.documentElement,this.pN),ia.a.instance.qa(Y.a.mg,this.domElement,this.BN))):(ha.a.instance.qa(Y.a.hh,Sa,this.pN),ia.a.instance.qa(Y.a.mg,Sa,this.pN));ha.a.instance.qa(Y.a.Nd,document.documentElement,this.b6);ia.a.instance.qa(Y.a.qe,Sa,this.b6);this.Wsc=!0}this.w_=Lb.sheet;this.U6b=!1;this.oz?(this.pM=null,this.b7b=Lb,this.W$=Lb.domElement,this.KNd(La.DOMElementExtensions.getBoundingClientRect(this.W$),"BeginSheetTabButtonDrag")):(Z.ULS.sendTraceTag(537153752,0,50,"SheetTabBarControl.BeginSheetTabButtonDrag: Starting legacy sheet tab drag and drop."),
this.domElement.classList.add(x.sNe),this.domElement.style.cursor="",this.VYf("pointer"))};d.prototype.kQ=function(Lb){Lb=void 0===Lb?!0:Lb;if(this.Wsc){this.VYf(H.a.m4);var Sa=this.domElement.ownerDocument.body;this.oz?(ha.a.instance.Aa(Y.a.hh,document.documentElement,this.pN),this.Rwa&&(ia.a.instance.Aa(Y.a.mg,document.documentElement,this.pN),ia.a.instance.Aa(Y.a.mg,this.domElement,this.BN))):(ha.a.instance.Aa(Y.a.hh,Sa,this.pN),ia.a.instance.Aa(Y.a.mg,Sa,this.pN));ha.a.instance.Aa(Y.a.Nd,document.documentElement,
this.b6);ia.a.instance.Aa(Y.a.qe,Sa,this.b6);this.WKc=this.Wsc=!1}this.Ipc=0;this.U6b=!1;this.vkd=this.w_=null;this.oz?(this.W$&&(this.W$.style.visibility="visible",this.W$=null),this.b7b=null,this.KNd(null,"EndSheetTabButtonDrag"),this.pM&&(this.pM.parentNode&&this.pM.parentNode.removeChild(this.pM),this.pM=null),this.Jfj(Lb)):(this.domElement.classList.remove(x.sNe),this.n7e())};d.prototype.Jfj=function(Lb){this.qTd(Lb);this.GC=this.EAb=-1};d.prototype.Fkh=function(Lb,Sa){function Cb(Mc,Pc,Kc){var ub=
rc.Na(9,null);ub.sheetName=Lb;ub.newSheetIndex=Sa;return zb.g(rc,"ReorderSheets",ub,Mc,Pc,Kc,null,0)}function ec(){return new v(Lb,Sa)}var wb=this.$.oa,rc=wb?wb.xa:null;X.EwaSettings.Zb()?this.$.userOperationManager.Sb(new ba.a(557,0,Cb,64,ec),null):this.$.userOperationManager.Sb(new na.a(557,0,Cb,void 0,ec),null)};d.prototype.DQ=function(Lb){return 0<=Lb&&Lb<this.mh.length?this.mh[Lb]:null};d.prototype.D1e=function(Lb){return(Lb=this.DQ(Lb))?Lb.sheet:null};d.prototype.mKa=function(Lb){return(Lb=
this.DQ(Lb))?Lb.domElement:null};d.prototype.E1e=function(Lb){return(Lb=this.mKa(Lb))?Lb.style:null};d.prototype.xSh=function(Lb){var Sa=this.$.va;Lb+=1;for(var Cb=-1,ec=this.mh?this.mh.length:0;Lb<Sa.count;){var wb=Object(da.a)(Ma.a,Sa.getItem(Lb));if(0===wb.wy){for(Cb=0;Cb<ec&&this.D1e(Cb)!==wb;Cb++);break}Lb++}return-1===Cb||Cb===ec?-1:Cb};d.prototype.bCf=function(Lb){var Sa=this.t2a(Lb);Sa&&(this.oz&&this.fF&&(Z.ULS.sendTraceTag(537153751,0,50,"SheetTabBarControl.OnSheetDeletedOrHidden: A sheet has been deleted while re-order operation is midway."),
X.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.kQ()),this.Qk.removeChild(Sa.domElement),Sa=Array.indexOf(this.mh,Sa),Array.removeAt(this.mh,Sa),this.a0(),(!this.isRtl&&Sa===this.mh.length||this.isRtl&&!Sa)&&this.qRa(!0),this.j7b&&this.fF?Lb===this.w_?(this.kQ(),this.l0(6)):this.SNb():this.l0(6))};d.prototype.dCf=function(Lb){var Sa=Object(da.a)(Ma.a,Lb);this.oz&&this.fF&&(Z.ULS.sendTraceTag(537153750,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: A sheet has been added to the sheet tab bar while re-order operation is midway."),
X.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.kQ());if(0===Sa.wy){this.qRa(!1);var Cb=this.Lia(Lb);-1===Cb&&(Z.ULS.sendTraceTag(537153749,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: could not find matching sheet tab index. Creating sheet tab..."),this.A4b(Sa,!1),Cb=this.Lia(Lb));this.q5e(Cb,!0)}};d.prototype.ydj=function(Lb,Sa){var Cb=this.t2a(Lb);Cb&&(this.oz&&this.fF&&!Sa&&(Z.ULS.sendTraceTag(537153748,0,50,"SheetTabBarControl.ReorderSheetTab: A sheet has been re-ordered while re-order operation is midway."),
X.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.kQ()),Lb=this.WGj(Lb,Cb),!X.EwaSettings.isChangeGateEnabled("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")&&this.oz&&Lb&&Sa&&Lb.TRi())};d.prototype.WGj=function(Lb,Sa){var Cb=Array.indexOf(this.mh,Sa),ec=this.QAh(Object(da.a)(Ma.a,Lb));if(-1===ec||-1===Cb)return null;Cb!==ec||this.oz?(this.qRa(!1),ec=d.udj(Cb,ec,this.Iu,this.fK),this.Iu=ec.pBh,this.fK=ec.zqi,Sa&&Sa.domElement.parentNode===
this.Qk&&(this.Qk.removeChild(Sa.domElement),Array.removeAt(this.mh,Cb)),Sa=this.DAh(Lb),Cb=this.Lia(Sa),Sa=new k(this.$,this.Qk,this.mKa(Cb),Object(da.a)(Ma.a,Lb),this,this.fm,this.kw),this.Cle(Sa,Cb),Cb=this.Lia(Lb),this.q5e(Cb,!1,!this.fm)):Sa=null;return Sa};d.prototype.rlh=function(){for(var Lb=this.mh?this.mh.length:0,Sa=this.Iu,Cb=this.fK,ec=0;ec<Lb;ec++){var wb=this.DQ(ec),rc=ec>=Sa;wb&&(wb.tabIndex=rc&&ec<=Cb?0:-1)}};d.prototype.UPj=function(){for(var Lb=this.mh?this.mh.length:0,Sa=0;Sa<
Lb;Sa++){var Cb=this.DQ(Sa);Cb&&Cb.afb()}};d.prototype.q5e=function(Lb,Sa,Cb){Cb=void 0===Cb?!0:Cb;Sa&&Lb<=this.Iu&&this.Iu++;this.rlh();this.qRa(!0);this.a0();this.j7b&&this.fF?this.SNb():Cb&&this.l0(6)};d.prototype.Hvc=function(Lb){var Sa=this.$.fJ;if(Lb||this.isRtl!==Sa)this.isRtl=Sa,this.domElement.classList.remove(this.isRtl?la.a.ANe:la.a.GNe),this.domElement.classList.add(this.isRtl?la.a.GNe:la.a.ANe),this.domElement.dir=this.isRtl?"rtl":"ltr",this.UPj();Lb||this.qRa(!0);for(Lb=0;Lb<this.qK.length;Lb++)0!==
Lb&&3!==Lb&&(!this.fm||4!==Lb&&5!==Lb)&&this.yZf(Lb)};d.prototype.J7g=function(){var Lb=this.QPd=document.createElement("div");Lb.className=x.Arh;this.fm&&Lb.classList.add(x.Brh);this.domElement.appendChild(Lb);this.u4b(Lb,1,720,719);this.u4b(Lb,2,722,721);this.kgf&&(this.zRa=new z(this.$,this,Lb));this.fm||this.u4b(Lb,4,726,725)};d.prototype.K7g=function(){var Lb=this.Bwc=document.createElement("div");Lb.className=x.Crh;this.domElement.appendChild(Lb);this.fm||this.u4b(Lb,5,728,727);this.v3c()};
d.prototype.M8g=function(){var Lb=document.getElementById(H.a.dvj),Sa=document.getElementById(H.a.evj);Lb&&!Sa&&Z.ULS.sendTraceTag(537153746,0,50,"CreateProgressBarArea - progressBar div is not null, separator div is null. progressBarDiv parent ID: {0}. progressBar div has child: {1}. ProgressBarMessage div exists: {2}",Lb.parentNode.id,!!Lb.firstChild,!!document.getElementById(H.a.GPd));if(ca.a.qgf(this.$)&&Lb&&Sa)this.domElement.appendChild(Lb),this.RPd=Lb.firstChild,this.SPd=document.getElementById(H.a.GPd),
Sa.style.visibility="visible";else{Lb=document.createElement("div");Sa=document.createElement("div");Lb.className=la.a.Lrh;Sa.className=la.a.Jrh;Sa.style.display="none";var Cb=document.createElement("div");Cb.className=la.a.Mrh;var ec=document.createElement("div");ec.className=la.a.Krh;var wb=document.createElement("div");wb.className=la.a.Irh;Sa.appendChild(Cb);Sa.appendChild(ec);Sa.appendChild(wb);Lb.appendChild(Sa);this.domElement.appendChild(Lb);this.RPd=Sa;this.SPd=ec}};d.prototype.yZf=function(Lb){var Sa=
this.qK[Lb];if(Sa)if(this.kw){var Cb=Sa.parentNode;this.QOf(Sa);Sa=gb.a(this.$)?this.AHf[Lb]:this.Hwd[Lb];this.qK[Lb]=this.svgIconProvider.hba(Sa,12,12,Cb,24,24)}else Sa.className=this.Fwd[Lb]};d.prototype.QOf=function(Lb){(null===Lb||void 0===Lb?0:Lb.parentNode)&&Lb.parentNode.removeChild(Lb)};d.prototype.k5g=function(){var Lb=this.Ocb=document.createElement("div");Lb.className=x.xrh;this.domElement.appendChild(Lb);this.R9g(Lb)};d.prototype.R9g=function(Lb){var Sa=document.createElement("div");Sa.className=
x.Orh;Sa.classList.add(x.yrh);this.$.printingEnabled||Sa.classList.add(Na.a.NPe);Lb.appendChild(Sa);this.Qk=document.createElement("ul");La.DOMElementExtensions.ju(this.Qk,H.a.BWc,null,null);this.Qk.className=Na.a.HNe;Sa.appendChild(this.Qk);this.C7g();this.Ife=document.createElement("div");this.wwc.id="SheetIconTooltipContainer";Sa.appendChild(this.wwc)};d.prototype.C7g=function(){var Lb=document.createElement("div"),Sa="<div class='"+la.a.PYg+"'>{0}</div>",Cb=W.a.ycd(la.a.Msh,0,"55_16_N","");Lb.innerHTML=
String.format(Sa,Cb);Lb.className=x.Nrh;La.DOMElementExtensions.setVisible(Lb,!1);this.zwc=Lb;this.Qk.appendChild(Lb)};d.prototype.N3c=function(){for(var Lb=this.$.va,Sa=0,Cb=Lb.count;Sa<Cb;Sa++){var ec=Object(da.a)(Ma.a,Lb.getItem(Sa));0===ec.wy&&(this.A4b(ec,!0),ec.active&&ec.activate())}};d.prototype.d0c=function(){qa.a.oc(this.mh);this.mh=[];this.fK=this.Iu=0};d.prototype.u4b=function(Lb,Sa,Cb,ec){function wb(Kc){"mouseup"===Kc.type&&rc.oz&&rc.fF||Ia.g(Kc);Mc.classList.contains(Ka.a.nU)||(Pc?
rc.JOi(Kc,Sa):rc.fm||rc.nzf(Kc,Sa))}var rc=this,Mc=document.createElement("a");Lb.appendChild(Mc);Lb=this.Hwd[Sa];this.qK[Sa]=this.nb(Mc,xa.a.instance.ga(ec),0,this.Fwd[Sa],xa.a.instance.ga(Cb),Lb);if(5===Sa||4===Sa)La.DOMElementExtensions.QJ(this.qK[Sa],Mc,!1,"span").style.marginTop="10px";this.yZf(Sa);Cb=this.Gwd[Sa]=this.ke.Td(Mc);ha.a.instance.qa(Y.a.pointerDown,Mc,function(Kc){return Kc.ctrlKey&&rc.GIi(Sa)?!0:rc.lzf(Sa)});ha.a.instance.qa(Y.a.Nd,Mc,function(){return rc.mzf()});ia.a.instance.qa(Y.a.qe,
Mc,function(){return rc.mzf()});ha.a.instance.qa(Y.a.pointerOut,Mc,function(){return rc.W_c()});wa.KeyInputManager.instance.qa(Y.a.Lb,Mc,function(Kc){return 13!==Kc.Ca.keyCode&&32!==Kc.Ca.keyCode||rc.V1c?!1:(rc.V1c=!0,rc.lzf(Sa))});wa.KeyInputManager.instance.qa(Y.a.Gd,Mc,function(Kc){return 13===Kc.Ca.keyCode||32===Kc.Ca.keyCode?(rc.V1c=!1,rc.W_c()):!1});var Pc=this.Hoe();Cb.ka("mouseover",wb);Cb.ka("mouseout",wb);Cb.ka("focus",wb);Cb.ka("blur",wb);Pc&&Cb.ka("mouseup",wb)};d.prototype.icf=function(Lb){var Sa=
!1,Cb=this.$.uf;Cb&&(Sa=Qa.a.UM(La.DOMElementExtensions.getBoundingClientRect(Cb),Lb.clientPoint));return Sa};d.prototype.mgf=function(Lb){return Qa.a.UM(La.DOMElementExtensions.getBoundingClientRect(this.domElement),Lb.clientPoint)||this.icf(Lb)};d.prototype.MAh=function(Lb){var Sa=null,Cb=Lb.clientPoint,ec=this.Iu;if(this.mgf(Lb))for(ec=this.Iu;ec<=this.fK;ec++)if(Sa=this.DQ(ec))if(Lb=La.DOMElementExtensions.getBoundingClientRect(Sa.domElement),!this.isRtl&&Cb.x<Lb.x+Lb.width||this.isRtl&&Cb.x>
Lb.x)break;return{returnValue:Sa,Fyj:ec>this.fK}};d.prototype.SNb=function(){if(this.oz){if(!this.pM){Z.ULS.sendTraceTag(537153743,0,50,"SheetTabBarControl.UpdateDragAndDropState: Starting modern sheet tab drag and drop.");this.pM=this.W$.cloneNode(!0);if(!this.qUf(this.pM,this.W$,!0,"UpdateDragAndDropState"))return;this.W$.style.visibility="hidden";this.pM.classList.add(x.Prh);this.pM.style.borderRightWidth="";this.vcc=this.TY.clientPoint.x-this.B3.width/2;this.pM.style.left=this.vcc+"px";this.GC=
this.Lia(this.w_);0>this.GC&&Z.ULS.sendTraceTag(537153742,0,15,"SheetTabBarControl.UpdateDragAndDropState: ghostIndex < 0!")}this.j7b&&(this.GC=this.Lia(this.w_));var Lb=La.DOMElementExtensions.getBoundingClientRect(this.Qk),Sa=Lb.x;Lb=Lb.x+Lb.width;var Cb=this.TY.clientPoint.x-this.B3.width/2;Cb=Math.min(Cb,Lb-this.B3.width);Cb=Math.max(Cb,Sa);this.pM.style.transform="translateX("+Math.abs(Cb-this.vcc)*(this.vcc<Cb?1:-1)+"px)";var ec=this.TY.clientPoint.x>this.EAb,wb=this.TY.clientPoint.x;Cb>=Lb-
this.B3.width?(wb=Lb-this.B3.width/2,this.fMd()||this.vma||(Z.ULS.sendTraceTag(537153741,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the right."),this.Poc=this.Qk.scrollLeft,this.vma=window.requestAnimationFrame(this.WVf))):Cb<=Sa?(wb=Sa+this.B3.width/2,this.eMd()||this.vma||(Z.ULS.sendTraceTag(537153740,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the left."),this.Poc=this.Qk.scrollLeft,
this.vma=window.requestAnimationFrame(this.VVf))):this.vma&&(Z.ULS.sendTraceTag(537153739,0,50,"SheetTabBarControl.UpdateDragAndDropState: Ending scroll as dragged sheet left renderd edge of stb."),this.qTd());this.TY.clientPoint.x!==this.EAb&&(this.cUd(ec,wb),this.EAb=this.TY.clientPoint.x)}else Lb=this.MAh(this.TY),Sa=Lb.Fyj,(Lb=Lb.returnValue)?this.ERd(Lb.sheet,Sa):this.n7e();this.WKc=!0};d.prototype.cUd=function(Lb,Sa){for(var Cb=this,ec;function(){var wb=Cb.Lhh(Sa,Lb);ec=wb.u1b;return wb}().returnValue;)this.wMb=
ec,this.hJg(Lb)};d.prototype.hJg=function(Lb){if(this.wMb){var Sa=(Lb?1:-1)*this.B3.width;if(Lb&&!this.$.fJ||!Lb&&this.$.fJ){var Cb=this.W$;var ec=this.GC+1;var wb=!0}else Cb=(ec=this.DQ(this.GC+1))?ec.domElement:null,ec=this.GC-1,wb=!1;if(this.qUf(this.wMb,Cb,wb,"AnimateSheetSwap")){Z.ULS.sendTraceTag(537153738,0,50,"SheetTabBarControl.AnimateSheetSwap: Sheet swap between ghost-index {0} and other sheet-index {1}. amount of sheets in the bar: {2} isMovingRight: {3}",this.GC,ec,this.OPd,Lb);0<=this.GC&&
this.GC<this.mh.length&&0<=ec&&ec<this.mh.length?(Lb=this.mh[ec],this.mh[ec]=this.mh[this.GC],this.mh[this.GC]=Lb):(Z.ULS.sendTraceTag(537153737,0,15,"SheetTabBarControl.AnimateSheetSwap: indices are out of range! length: {0}, ghostIndex: {1}, swappedSheetIndex: {2}",this.mh.length,this.GC,ec),this.kQ());this.GC=ec;var rc=this.wMb;rc.style.transform="translateX("+Sa+"px)";window.requestAnimationFrame(function(){rc.style.transform="translateX(0px)"})}}};d.prototype.qUf=function(Lb,Sa,Cb,ec){function wb(rc){return rc?
String.format("Node ID: {0} , Node class: {1}, Node name: {2},",rc.id,rc.className,rc.nodeName):null}try{return this.Qk.insertBefore(Lb,Sa),!0}catch(rc){return Lb=this.t2a(this.w_),Z.ULS.sendTraceTag(537153736,0,15,"SheetTabBarControl.SafeInsertSheetBefore: Reference node is not a descendant of the sheet tab bar. sheetTabButonState: [{0}], Caller: [{1}], Node to insert before [{2}], That node's parent: [{3}],SheetTabListElement: [{4}], isReferenceSheetTheDraggedSheet:[{5}], ghostIndex:[{6}], sheetTabButtons length:[{7}], Exception: [{8}]",
Lb?Lb!==this.b7b?"Changed":"NoChange":"Removed",ec,wb(Sa),wb(Sa.parentNode),wb(this.Qk),Cb,this.GC,this.OPd,rc),this.kQ(),!1}};d.prototype.Lhh=function(Lb,Sa){var Cb=this.$.fJ===Sa?this.DQ(this.GC-1):this.DQ(this.GC+1);if(!Cb)return{returnValue:!1,u1b:null};Cb=Cb.domElement;var ec=La.DOMElementExtensions.getBoundingClientRect(Cb);return this.B3?Sa?{returnValue:Lb+this.B3.width/2>=ec.x+.5*ec.width,u1b:Cb}:{returnValue:Lb-this.B3.width/2<=ec.x+.5*ec.width,u1b:Cb}:(Z.ULS.sendTraceTag(537153735,0,50,
"SheetTabBarControl.DraggedSheetCrossesSiblingSheet: Avoding JS crash and ending drag and drop due to client bounds of dragged sheet being null."),this.kQ(),{returnValue:!1,u1b:Cb})};d.prototype.SVf=function(Lb,Sa){var Cb=Sa?this.WVf:this.VVf;if(-1===this.pyc)this.pyc=Lb,this.vma=window.requestAnimationFrame(Cb);else{Lb=Math.floor((Lb-this.pyc)/1E3*300);var ec=this.MIb>this.lBb?1:-1;this.scrollLeft(Math.abs(this.Qk.scrollLeft-(Sa?this.Poc+Lb*ec:this.Poc-Lb*ec))*(Sa?-1:1));if(Lb=this.LYe("ScrollStep"))this.cUd(Sa,
Lb.x+Lb.width/2),Sa&&!this.fMd()||!Sa&&!this.eMd()?this.vma=window.requestAnimationFrame(Cb):(Z.ULS.sendTraceTag(537153734,0,50,"SheetTabBarControl.ScrollStep: Ending scroll as dragged sheet reached first/last sheet."),this.qTd())}};d.prototype.fMd=function(){var Lb=this.MIb>this.lBb;return Lb&&this.$ma>=this.MIb||!Lb&&this.$ma<=this.MIb};d.prototype.eMd=function(){var Lb=this.MIb>this.lBb;return Lb&&this.$ma<=this.lBb||!Lb&&this.$ma>=this.lBb};d.prototype.qTd=function(Lb){Lb=void 0===Lb?!0:Lb;this.Qk&&
(this.$ma=this.Qk.scrollLeft);window.cancelAnimationFrame(this.vma);this.vma=0;this.pyc=-1;Lb&&this.a0()};d.prototype.KNd=function(Lb,Sa){Lb||Z.ULS.sendTraceTag(537153733,0,50,"SheetTabBarControl.SetDraggedSheetTabButtonRect: DraggedSheetTabButtonRect set to null by {0}",Sa);this.B3=Lb};d.prototype.GIi=function(Lb){return 2===Lb?(this.l0(3),!0):1===Lb?(this.l0(0),!0):!1};d.prototype.lzf=function(Lb){var Sa=this;Z.ULS.shipAssertTag(537153732,0,-1===this.cPa&&-1===this.bPa,"SheetTabBarControl.OnNavigateButtonDown: PeriodicNavigateSetTimeoutID and PeriodicNavigateSetIntervalID should be -1 on button down!");
-1!==this.cPa&&(window.clearTimeout(this.cPa),this.cPa=-1);-1!==this.bPa&&(window.clearInterval(this.bPa),this.bPa=-1);this.l0(Lb);this.cPa=window.setTimeout(function(){Sa.EEj(Lb)},this.mCi);return!0};d.prototype.EEj=function(Lb){var Sa=this;this.bPa=window.setInterval(function(){Sa.l0(Lb)},this.lCi)};d.prototype.mzf=function(){this.W_c();return!this.oz||!this.fF};d.prototype.W_c=function(){window.clearTimeout(this.cPa);window.clearInterval(this.bPa);this.bPa=this.cPa=-1;return!0};d.prototype.nzf=
function(Lb,Sa){var Cb=this.Fwd[Sa];fb.HelperMethods.qVd(this.qK[Sa],Cb,Cb+H.a.Ydc,"mouseover"===Lb.type||"focus"===Lb.type)};d.prototype.JOi=function(Lb,Sa){var Cb=this.pgc(Sa),ec=5===Sa;if("mouseup"===Lb.type){if(ec||4===Sa)Cb||this.reorderSheets(null,ec,!1),this.kQ()}else!this.oz&&this.fF?(Cb||this.ERd(this.D1e(ec?this.fK:this.Iu),ec),this.l0(ec?2:1)):this.fm||this.nzf(Lb,Sa)};d.prototype.pgc=function(Lb){return!!La.DOMElementExtensions.udd(this.qK[Lb],"a").title};d.prototype.RBc=function(Lb){this.qYd(Lb);
this.a0()};d.prototype.qYd=function(Lb){(Lb=this.t2a(Lb))&&Lb.afb()};d.prototype.iMd=function(){var Lb=this.$.va;if(Lb.pa&&(!Dc.e(this.$)||Lb.count))if(Lb=this.Lia(Lb.pa),-1===Lb)Z.ULS.sendTraceTag(537153729,0,50,"SheetTabBarControl.ScrollToActiveIndex: shouldn't have an invisible, active sheet");else{var Sa=this.mKa(Lb);Lb<this.Iu?this.Cuc(Lb):Lb>this.Iu&&!this.oqd(Sa)&&this.scrollIntoView(Lb)}};d.prototype.iRj=function(){this.Iu=0;this.fK=this.mh.length-1;for(var Lb=!1,Sa=0;Sa<this.mh.length;Sa++){var Cb=
this.DQ(Sa);if(!Cb)break;var ec=this.oqd(Cb.domElement);Cb.tabIndex=ec?0:-1;if(!Lb&&ec)this.Iu=Sa,Lb=!0;else if(Lb&&!ec){this.fK=Sa-1;break}}};d.prototype.Cuc=function(Lb){this.$.va.count&&(this.mh.length||this.N3c(),this.IXf(this.mKa(Math.max(0,Math.min(Lb,this.mh.length-1)))),this.a0())};d.prototype.scrollIntoView=function(Lb){Z.ULS.shipAssertTag(537153697,0,Lb>=this.Iu,"SheetTabBarControl.ScrollIntoView: sheetTabIndex must be greater than the first visisble sheet tab index!");if(this.$.va.count){this.mh.length||
this.N3c();var Sa=this.mKa(Math.max(0,Math.min(Lb,this.mh.length-1))),Cb=this.mKa(this.Iu);if(!this.oqd(Sa)){Sa=La.DOMElementExtensions.getBoundingClientRect(Sa);var ec=La.DOMElementExtensions.getBoundingClientRect(this.Ocb);Sa=this.isRtl?ec.x-Sa.x:Sa.x+Sa.width-(ec.x+ec.width);for(ec=0;Cb&&ec<Sa;){var wb=La.DOMElementExtensions.getBoundingClientRect(Cb);ec+=wb.width;Cb=Cb.nextSibling}Cb?this.IXf(Cb):Z.ULS.sendTraceTag(537153696,0,15,"SheetTabBarControl.ScrollIntoView: new firstVisible is null. firstVisibleSheetTabIndex = {0}, lastVisibleSheetTabIndex = {1}, scroll to index: {2}",
this.Iu,this.fK,Lb)}this.a0()}};d.prototype.IXf=function(Lb){var Sa=La.DOMElementExtensions.getBoundingClientRect(this.Qk);Lb=La.DOMElementExtensions.getBoundingClientRect(Lb);this.isRtl?this.scrollLeft(Math.floor(Sa.x+Sa.width-(Lb.x+Lb.width+.5))):this.scrollLeft(Math.ceil(Sa.x-Lb.x-.5))};d.prototype.scrollLeft=function(Lb){(0>Lb&&this.fMd()||0<Lb&&this.eMd())&&Z.ULS.sendTraceTag(537153695,0,50,"SheetTabBarControl.Scrollleft: attempt to scroll after the edge (overflow) in sheet tab bar.");var Sa=
this.Qk.scrollLeft;if(this.isRtl){if(ea.a.hF||ea.a.xf){this.Qk.scrollLeft=this.$ma=Sa-Lb;return}if(ea.a.iB||ea.a.BH){this.Qk.scrollLeft=this.$ma=Sa+Lb;return}Z.ULS.sendTraceTag(537153694,0,15,"SheetTabBarControl.ScrollLeft: unknown browser")}this.Qk.scrollLeft=this.$ma=Sa-Lb};d.prototype.oqd=function(Lb){Lb=La.DOMElementExtensions.getBoundingClientRect(Lb);var Sa=La.DOMElementExtensions.getBoundingClientRect(this.Ocb);return Lb&&Sa?Lb.x>=Sa.x-1&&Lb.x+Lb.width<=Sa.x+Sa.width+1:(Z.ULS.sendTraceTag(537153693,
0,15,"SheetTabBarControl.IsTabCompletelyVisible: sheetTabRect is null or contentAreaRect is null"),!1)};d.prototype.d8g=function(){var Lb=this.Bwc;if(B.h1f(this.$))this.fm?(qa.a.Ia(this.vH),this.vH=new B(Lb,this.$,this,!0)):(qa.a.Ia(this.vH),this.vH=null);else if(!this.vH||this.fm)qa.a.Ia(this.vH),ra.k(this.$.ng)?this.vH=new e(Lb,this.$,this):this.vH=new B(Lb,this.$,this)};d.prototype.BDe=function(Lb,Sa){var Cb=this.$.va;if(!this.$.isEditMode||!Cb.count)qa.a.Ia(Sa),Sa=null;else if(!Sa)if(Cb=this.fm?
this.QPd:this.Bwc,ra.k(this.$.ng))Sa=new e(Cb,this.$,this);else switch(Lb){case 0:Sa=new B(Cb,this.$,this);break;case 1:Sa=new A(Cb,this.$,this);break;default:Z.ULS.sendTraceTag(537153692,0,10,"Unsupported SheetTabBarButtonType. Are you trying to create a new button? Make sure to update the SheetTabBarButtonType enum and add a case here to support creation of your new button.")}return Sa};d.prototype.v3c=function(){X.EwaSettings.ma(426)?(this.vH=this.BDe(0,this.vH),this.Qxb=this.BDe(1,this.Qxb)):
this.d8g()};d.prototype.LYe=function(Lb){var Sa=La.DOMElementExtensions.getBoundingClientRect(this.pM);Sa||(Z.ULS.sendTraceTag(537153689,0,50,"SheetTabBarControl.{0}: GetBoundingClientRect returned null for the dragged sheet.",Lb),this.kQ());return Sa};d.prototype.h5e=function(Lb,Sa){this.zta.mKg(Lb,Sa);this.kQ(!1);this.rOd(this.navigationButtonsDisabled);Lb=ak(this.iHj);for(Sa=Lb.next();!Sa.done;Sa=Lb.next())(Sa=Sa.value)&&Sa.kX(this.navigationButtonsDisabled);Lb=ak(this.Cse);for(Sa=Lb.next();!Sa.done;Sa=
Lb.next())(Sa=Sa.value)&&Sa.kX(this.operationButtonsDisabled)};d.udj=function(Lb,Sa,Cb,ec){Lb<Cb?(Sa>Cb&&Cb--,Sa>ec&&ec--):Lb>ec?(Sa<Cb&&Cb++,Sa<ec&&ec++):Sa<Cb&&Cb++;return{pBh:Cb,zqi:ec}};Af.Object.defineProperties(d.prototype,{jc:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},Zd:{configurable:!0,enumerable:!0,get:function(){return sa.a.NPd}},fF:{configurable:!0,enumerable:!0,get:function(){return this.WKc}},
OPd:{configurable:!0,enumerable:!0,get:function(){return this.mh.length}},wwc:{configurable:!0,enumerable:!0,get:function(){return this.Ife}},Rwa:{configurable:!0,enumerable:!0,get:function(){return this.$8d}},navigationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!this.zta&&this.zta.navigationButtonsDisabled}},operationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!this.zta&&this.zta.operationButtonsDisabled}},Fwd:{configurable:!0,enumerable:!0,get:function(){return this.fm?
this.$.fJ?[la.a.h8b,la.a.CNe,la.a.ENe,la.a.g8b,la.a.cua,la.a.cua]:[la.a.g8b,la.a.ENe,la.a.CNe,la.a.h8b,la.a.cua,la.a.cua]:this.$.fJ?[la.a.h8b,la.a.BNe,la.a.DNe,la.a.g8b,la.a.cua,la.a.cua]:[la.a.g8b,la.a.DNe,la.a.BNe,la.a.h8b,la.a.cua,la.a.cua]}},Hwd:{configurable:!0,enumerable:!0,get:function(){return this.$.fJ?[null,bb.a.$ze,bb.a.Yze]:[null,bb.a.Yze,bb.a.$ze]}},AHf:{configurable:!0,enumerable:!0,get:function(){return this.$.fJ?[null,bb.a.aAe,bb.a.Zze]:[null,bb.a.Zze,bb.a.aAe]}},lBb:{configurable:!0,
enumerable:!0,get:function(){if(this.isRtl){if(ea.a.hF)return 0;if(ea.a.xf)return-1*(this.Qk.scrollWidth-this.Qk.clientWidth);if(ea.a.Vu)return this.Qk.scrollWidth-this.Qk.clientWidth;Z.ULS.sendTraceTag(537153762,0,15,"SheetTabBarControl.ScrollLeftEdgeValue: unknown browser")}return 0}},MIb:{configurable:!0,enumerable:!0,get:function(){if(this.isRtl){if(ea.a.hF)return this.Qk.scrollWidth-this.Qk.clientWidth;if(ea.a.xf||ea.a.Vu)return 0;Z.ULS.sendTraceTag(537153761,0,15,"SheetTabBarControl.ScrollRightEdgeValue: unknown browser")}return this.Qk.scrollWidth-
this.Qk.clientWidth}},Cse:{configurable:!0,enumerable:!0,get:function(){return this.zta?[this.vH,this.Qxb]:[this.vH,this.Qxb,this.zRa]}},iHj:{configurable:!0,enumerable:!0,get:function(){return this.mh.concat(this.zRa)}},fvj:{configurable:!0,enumerable:!0,get:function(){return this.Hfe}}});Object(U.a)(d,"SheetTabBarControl",ab.a,[615,10,422]);var mc=N.a;Rk(c,mc);c.prototype.create=function(){var Lb=this,Sa=this.$.yb;if(Q.a(this.$.ya,1))ac.PageLoadTrackingInfo.instance.lda(H.a.vAa,["sheetTabBar"]);
else{var Cb=document.getElementById(Sa+H.a.Q4c);Cb?(X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&ac.PageLoadTrackingInfo.instance.jAa(H.a.vAa),ca.a.Cpd()?F.TaskExtensions.Ba(T.GetServiceTaskFactory.Ra(this.$.da,388,387,this.hb),function(ec){Lb.pb(Lb.$.da.za(32)||new d(Lb.$,Cb,ec.result))},this.$.la,3):this.pb(this.$.da.za(32)||new d(this.$,Cb))):ac.PageLoadTrackingInfo.instance.lda(H.a.vAa,["sheetTabBar"])}};c.ka=function(Lb){Lb.da.Ga(33,new c(Lb))};Object(U.a)(c,
"SheetTabBarFactory",N.a,[]);b.d(D,"a",function(){return a})},1363:function(u,D,b){function a(){x.a.Fa(function(la){v.ka(la);C.EwaSettings.tb()?z.ka(la):r.ka(la);l.ka(la);c.ka(la)})}function c(la){var Ea=Ka.call(this)||this;Ea.$=la;Ea.Eb();return Ea}function d(la,Ea){var ra=this;this.WV=function(){ra.Ad||ra.jpe()};this.Ad=!1;this.VY=Ea.oU;this.ariaLiveNotifier=la;this.b_d=new k(la,Ea);this.VY&&this.VY.PQ?this.jpe():this.Ti()}function e(la,Ea,ra){var na=this;this.hyf=function(){na.b_d.zLf();na.ariaLiveNotifier.setEnabled(!0)};
this.$=Ea;this.ariaLiveNotifier=la;this.b_d=new k(la,Ea);this.X9b=ra.Ted(this.$);this.X9b.nFg(this.hyf)}function k(la,Ea){this.$=Ea;this.ariaLiveNotifier=la}function l(la){var Ea=Na.call(this)||this;Ea.$=la;Ea.Eb();return Ea}function m(la,Ea,ra,na,ba){var sa=this;this.gridReadoutNotifier=null;this.mab=!1;this.nsa=this.$nb=null;this.Rca=function(){C.EwaSettings.isChangeGateEnabled("OfficeVSO:5963256_DoNotReadActiveItemIfDisposed")&&!sa.$?E.ULS.sendTraceTag(526235470,0,15,"calling readActiveItemDescription after dispose, ignoring."):
J.g(sa.$).isEditing||sa.O_b.Kq()};this.JFi=function(){if(!J.g(sa.$).ha.Oa.Ood){var ya=sa.bHh();sa.readText(ya.returnValue,ya.activeCell)}};this.gp=function(){var ya=sa.activeCell;sa.readText("Editing",ya);C.EwaSettings.isChangeGateEnabled("OfficeVSO:5190952_removePhoneticErrorDialog2")||ya&&ya.jdc&&!J.g(sa.$).P5e||sa.O_b.cancel()};this.Rc=function(){C.EwaSettings.isChangeGateEnabled("OfficeVSO:6053639_DoNotHandleSelectionChangedIfDisposed")&&!sa.$?E.ULS.sendTraceTag(525366409,0,15,"calling onSelectionChanged after dispose, ignoring."):
(sa.Rca(),sa.mab&&J.g(sa.$).inRangePicker&&1===ta.a.Cb&&(null===sa.$nb?sa.$nb=Qa.a.instance.create(sa.gGd,m.eTc,"readSelectedRanges"):sa.$nb.Kq()))};this.$=Ea;this.ariaLiveNotifier=la;this.sparklineManager=na;this.tableManager=ra;this.gD=new f;this.X5a=r.X5a();this.mab=C.EwaSettings.isChangeGateEnabled("OfficeVSO:5888244_FixCellReadoutInRangePicking");this.X5a&&(C.EwaSettings.tb()?this.gridReadoutNotifier=ba:this.gridReadoutNotifier=Ea.da.za(244),E.ULS.shipAssertTag(537153937,0,!!this.gridReadoutNotifier,
"SelectionReadoutHandler.ctor: gridReadoutNotifier shouldn't be null"),m.eTc=700);this.O_b=Qa.a.instance.create(this.JFi,m.eTc,S.a.fmj,!1);this.Ti()}function f(){this.activeItemName=null;this.Wff=!1;this.tableName=null;this.O_a=0;this.dzc=!1}function w(){}function n(la){switch(la){case 1:return 1437;case 2:return 1438;case 3:return 1439;case 4:return 1440;case 5:return 1441;case 6:return 1442;case 7:return 1443;case 8:return 1444;case 9:return 1445;case 10:return 1446;case 11:return 1447;case 12:return 1448;
case 13:return 1449;case 14:return 1450;case 15:return 1451;case 16:return 1452;case 17:return 1453;case 18:return 1454;case 19:return 1455;case 20:return 1456;case 21:return 1457;case 22:return 1460;case 23:return 1458;case 24:return 1459;case 25:return 1461;case 26:return 1462;case 27:return 1463;case 28:return 1464;default:return 1465}}function z(la){var Ea=Z.call(this)||this;Ea.$=la;Ea.Eb();return Ea}function r(la,Ea){this.$_=this.vW=this.PN=null;this.Uia=Ea;this.d9g(la);this.z_i();C.EwaSettings.tb()&&
la.da.Ga(244,this)}function v(la){var Ea=N.call(this)||this;Ea.$=la;Ea.Eb();return Ea}function A(la,Ea,ra){var na=this;this.Huf=function(ba,sa){na.qLf(sa.Ed.command)};this.$=la;this.Oea=document.createElement("div");this.Oea.setAttribute(U.a.vP,U.a.Xj);this.Oea.className=I.a.A8c;Ea.insertBefore(this.Oea,ra);this.Zfa=document.createElement("div");this.Zfa.setAttribute(U.a.vP,U.a.Xj);this.Zfa.className=I.a.A8c;Ea.insertBefore(this.Zfa,this.Oea);this.dsg=F.a.instance.Xa(2);this.dha=document.createElement("div");
this.dha.setAttribute(U.a.Hd,U.a.Sra);this.dha.setAttribute(U.a.Ura,U.a.Qnb);this.dha.className=I.a.A8c;Ea.insertBefore(this.dha,this.Zfa);this.register();this.$.da.Ga(211,this)}function B(la,Ea){Ea&&(la.append(Ea),la.append(y.Ytd))}function y(la){this.kuc=la||""}var x=b(11),C=b(1);u=b(0);var G=b(232),E=b(15),I=b(31),U=b(5),M=b(12),T=b(22),F=b(14),K=b(250),J=b(21),O=b(30);y.P2a=function(la){la=O.a.Ag(la||"");return new y(la)};y.n$b=function(la){return y.P2a(F.a.instance.ga(la))};y.mbd=function(la){return new y(F.a.instance.Xa(la))};
y.VDh=function(la,Ea){for(var ra=[],na=1;na<arguments.length;++na)ra[na-1]=arguments[na];return y.UDh.apply(y,[F.a.instance.lb(la)].concat(yk(ra)))};y.UDh=function(la,Ea){for(var ra=[],na=1;na<arguments.length;++na)ra[na-1]=arguments[na];na=ra.length;for(var ba=Array(na),sa=0;sa<na;sa++)ba[sa]=(ra[sa]||y.fKe).kuc;return new y(String.format(la,ba))};Af.Object.defineProperties(y,{fKe:{configurable:!0,enumerable:!0,get:function(){return y.V4d||(y.V4d=new y(""))}},Ytd:{configurable:!0,enumerable:!0,get:function(){return y.T$d||
(y.T$d=y.mbd(2).kuc)}}});y.V4d=null;y.T$d=null;Object(u.a)(y,"SafeHtml",null,[635]);A.prototype.dispose=function(){this.$&&this.unregister();M.DOMElementExtensions.gf(this.dha);M.DOMElementExtensions.gf(this.Oea);M.DOMElementExtensions.gf(this.Zfa);this.Zfa=this.Oea=this.dha=this.$=null};A.prototype.setEnabled=function(la){this.uYf(this.Zfa,la)};A.prototype.Cpj=function(){this.uYf(this.Oea,!0)};A.prototype.readText=function(la){this.SGb(y.P2a(la),!0)};A.prototype.zPa=function(la){this.SGb(y.P2a(la),
!1)};A.prototype.tLf=function(la,Ea){if(1>Ea||!la)E.ULS.shipAssertTag(537153954,0,!1,"Skiping listbox description readout");else{var ra=new Sys.StringBuilder;la=String.format(F.a.instance.lb(34),Ea,la);B(ra,la);B(ra,F.a.instance.ga(855));this.SGb(y.P2a(ra.toString()),!1)}};A.prototype.B5i=function(la,Ea,ra){if(1>ra||1>Ea||Ea>ra||!la)E.ULS.shipAssertTag(537153952,0,!1,"Skipping listbox item readout");else{var na=new Sys.StringBuilder;B(na,la);na.append(String.format(F.a.instance.lb(55),Ea,ra));this.SGb(y.P2a(na.toString()),
!1)}};A.prototype.qLf=function(la){la=this.RVh(la);this.SGb(la,!1)};A.prototype.SGb=function(la,Ea){if(la=la?la.kuc:null)Ea=Ea?this.Zfa:this.Oea,T.a.equals(Ea.innerHTML,la,!1)&&(la+=y.Ytd),Ea.innerHTML=la};A.prototype.rab=function(la,Ea){this.dha.getAttribute(U.a.Ura)!==Ea&&this.dha.setAttribute(U.a.Ura,Ea);la=la?y.P2a(la).kuc:"";this.dha.innerHTML=la};A.prototype.C5i=function(la,Ea,ra,na){var ba=!0;ba=void 0===ba?!1:ba;var sa=F.a.instance.lb(54);E.ULS.shipAssertTag(537153949,0,!(void 0===la||null===
la));E.ULS.shipAssertTag(537153948,0,!(void 0===Ea||null===Ea));E.ULS.shipAssertTag(537153947,0,!(void 0===ra||null===ra));E.ULS.shipAssertTag(537153946,0,!(void 0===na||null===na));E.ULS.shipAssertTag(537153945,0,!(void 0===sa||null===sa));la=String.format(sa,la||"",Ea||"",ra||"",na||"");ba?this.rab(la,U.a.eZa):this.readText(la)};A.prototype.YPj=function(la){var Ea=this.Zfa.style;la?(la=K.a.M0b(la.cell,Ea),Ea=la.FB,Ea.top=Ea.left=Ea.bottom=Ea.right=null,la.w2()):Ea.cssText=""};A.prototype.RVh=function(la){switch(la){case -1985798686:return y.n$b(12);
case -911352779:return y.n$b(11);case 237279923:return y.n$b(13);case -1502853784:return y.mbd(81);case -111689794:return y.mbd(78);case -287251124:return this.vfd(1314,function(Ea){return Ea.bold});case -1925065947:return this.vfd(1315,function(Ea){return Ea.italic});case 1764140053:return this.vfd(1316,function(Ea){return Ea.underline})}return null};A.prototype.register=function(){E.ULS.shipAssertTag(537153944,0,!!this.$,"Can't register to ewaControl's events");this.$&&(E.ULS.shipAssertTag(537153943,
0,!!this.$.Ka,"Can't register to CommandHandlerManager's event"),this.$.Ka&&this.$.Ka.yFa(this.Huf))};A.prototype.unregister=function(){this.$&&this.$.Ka.Cza(this.Huf)};A.prototype.uYf=function(la,Ea){var ra=la===this.Oea;Ea?(la.setAttribute(U.a.Ura,U.a.eZa),ra&&la.setAttribute(U.a.Hd,U.a.Sra),la.setAttribute(U.a.vP,U.a.Yq),la.removeAttribute(U.a.vP),la.innerHTML+=" "):(la.removeAttribute(U.a.Ura),ra&&la.removeAttribute(U.a.Hd),la.setAttribute(U.a.vP,U.a.Xj))};A.prototype.vfd=function(la,Ea){var ra=
this.activeCell;if(!ra)return null;Ea=Ea(ra)?7:8;return y.VDh(Ea,y.n$b(la))};Af.Object.defineProperties(A.prototype,{wxa:{configurable:!0,enumerable:!0,get:function(){return this.dsg}},isActive:{configurable:!0,enumerable:!0,get:function(){return!0}},activeCell:{configurable:!0,enumerable:!0,get:function(){return J.g(this.$).Ub(null)}}});Object(u.a)(A,"AriaLiveNotifier",null,[596,584,10]);var N=G.a;Rk(v,N);v.prototype.create=function(){this.pb(this.$.da.za(211)||new A(this.$,this.$.Rv,this.$.uf))};
v.ka=function(la){la.da.Ga(212,new v(la))};Object(u.a)(v,"AriaLiveNotifierFactory",G.a,[]);var H=b(25),Q=b(224),ca=b(143),X=b(66);r.prototype.readText=function(la){la=String.format(F.a.instance.lb(30),la);this.PN.setAttribute(U.a.Gt,la);this.vW.setAttribute(U.a.Gt,la);this.TGj()};r.prototype.dispose=function(){this.$_&&this.$_.parentNode&&this.$_.parentNode.removeChild(this.$_);this.vW=this.PN=this.$_=this.Uia=null};r.prototype.d9g=function(la){var Ea=la.yb+"readoutElementWrapper",ra=la.yb+"readoutElement1",
na=la.yb+"readoutElement2";this.$_=document.getElementById(Ea);this.$_||(this.$_=document.createElement(Q.a.div),this.$_.id=Ea,this.PN=document.createElement(Q.a.label),this.PN.id=ra,this.PN.setAttribute(ca.a.contentEditable,X.a.EOb),this.PN.setAttribute(U.a.Hd,U.a.fZa),this.vW=document.createElement(Q.a.label),this.vW.id=na,this.vW.setAttribute(ca.a.contentEditable,X.a.EOb),this.vW.setAttribute(U.a.Hd,U.a.fZa),this.PN.style.width="0px",this.PN.style.height="0px",this.vW.style.width="0px",this.vW.style.height=
"0px",this.PN.tabIndex=-1,this.vW.tabIndex=-1,this.$_.appendChild(this.PN),this.$_.appendChild(this.vW),la=la.yb+U.a.O1c,Ea=document.getElementById(la),E.ULS.shipAssertTag(537153942,3,!!Ea,"FocusBasedReadout.CreateReadoutElementsIfNeeded: expected to find contentAreaDiv with id: {0}",la),Ea&&Ea.appendChild(this.$_))};r.prototype.z_i=function(){this.Uia&&this.PN&&this.vW&&(this.Uia.setAttribute(U.a.z2,this.PN.id),this.Uia.setAttribute(U.a.yWc,String.format("{0} {1}",this.PN.id,this.vW.id)))};r.prototype.TGj=
function(){if(this.isActive){var la="";M.DOMElementExtensions.hasAttribute(this.Uia,U.a.z2)&&(la=this.Uia.getAttribute(U.a.z2).toString());this.Uia.setAttribute(U.a.z2,la===this.PN.id?this.vW.id:this.PN.id)}else E.ULS.shipAssertTag(537153941,0,!1,"FocusBasedReadout.SwitchVirtualFocus: called when is not active.")};r.X5a=function(){if(null==r.Stb)if(C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ActiveDescendantGridReadout",!1)&&!H.a.rMa)r.Stb=!0,E.ULS.sendTraceTag(537153940,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: ActiveDescendantGridReadout Flight is enabled");
else if(r.Stb=!1,H.a.BH||H.a.xf)r.Stb=!0,E.ULS.sendTraceTag(537153939,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: The FocusBasedCellReadout BRS is on");return r.Stb};r.ka=function(la){r.X5a()&&la.da.Ga(244,new r(la,J.g(la).$b.textBox.Ne))};Af.Object.defineProperties(r.prototype,{isActive:{configurable:!0,enumerable:!0,get:function(){return!!this.Uia&&document.activeElement===this.Uia}}});r.Stb=null;Object(u.a)(r,"FocusBasedReadout",null,[584,10]);var Z=G.a;Rk(z,Z);z.prototype.create=function(){var la=
this;r.X5a()?J.g(this.$).$b.textBox.$T(function(){var Ea=la.$.da.za(244)||new r(la.$,J.g(la.$).$b.textBox.Ne);la.pb(Ea)}):this.pb(null)};z.ka=function(la){la.da.Ga(315,new z(la))};Object(u.a)(z,"FocusBasedReadoutFactory",G.a,[]);var ea=b(51),ka=b(37),Y=b(7),qa=b(90),fa=b(85),ha=b(24),ia=b(45),wa=b(249),Qa=b(47),S=b(44),da=b(122);w.lfd=function(la){return w.y0e(la.toString())};w.y0e=function(la){return w.OWg.test(la)?la.replace(w.r4i,"$1 ").replace(w.q4i,' "$1"').trim():la};w.Rdj=function(la){var Ea=
la.lastIndexOf("!");return la.substring(0,-1<Ea?Ea+1:0)+w.y0e(la.substring(-1<Ea?Ea+1:0,la.length))};Af.Object.defineProperties(w,{r4i:{configurable:!0,enumerable:!0,get:function(){return w.zde||(w.zde=RegExp("([A-Z]+)","g"))}},q4i:{configurable:!0,enumerable:!0,get:function(){return w.yde||(w.yde=RegExp("([A-Z])","g"))}},OWg:{configurable:!0,enumerable:!0,get:function(){return w.s2d||(w.s2d=RegExp("^\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+\\$?[0-9]+:\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+:\\$?[A-Z]+$|^\\$?[0-9]+:\\$?[0-9]+$"))}}});
w.zde=null;w.yde=null;w.s2d=null;Object(u.a)(w,"RangeAriaExtensions",null,[]);Object(u.a)(f,"SelectionReadoutState",null,[]);var xa=b(64),ta=b(76);m.prototype.dispose=function(){this.$&&this.Uj();qa.a.Ia(this.O_b);this.sparklineManager=this.$=this.O_b=null};m.prototype.yWe=function(la,Ea,ra){ra=void 0===ra?!0:ra;if(!la)return"";var na=this.$.da,ba=new Sys.StringBuilder;this.bKg(ba,la,Ea);if(C.EwaSettings.isChangeGateEnabled("OfficeVSO:4124702_ColumnHeaderReadout")){var sa=this.tableManager.iva(la.range);
(null===sa||void 0===sa?0:sa.$Qd)&&this.Jpe(ba,sa);sa=this.tableManager.Xm(la.range);(null===sa||void 0===sa?0:sa.Yaa)&&this.Jpe(ba,sa)}sa=la.Xaa?this.gZe(la):la.text;B(ba,sa);sa=this.$.activeItemName;this.gD.activeItemName!==sa&&(B(ba,sa),this.gD.activeItemName=sa);sa=1===Ea.length?ia.K(Ea).isSingle?"":F.a.instance.ga(851):String.format(F.a.instance.lb(31),Ea.length);B(ba,sa);sa=ak(Ea);for(var ya=sa.next();!ya.done;ya=sa.next())ya=ya.value,B(ba,w.lfd(ya)),1===Ea.length&&m.Kni(ya)&&(ya=J.g(this.$).Ea.Mr(ya.bottomRight),
void 0!==ya&&null!==ya&&ya.text&&(ya=ya.Xaa?this.fZe(ya,ya.text):ya.text,B(ba,ya)));sa=la.cell;sa=this.mTh(sa.vij,sa.UZg);B(ba,sa);this.LJg(ba,la);ra&&(la.x6a?B(ba,F.a.instance.ga(839)):la.Nwa&&B(ba,F.a.instance.ga(840)));if(la.hasAutoFilter||la.q4)this.cKg(ba,la.hasAutoFilter?la.cell.autoFilterType:la.cell.bYi),ra&&B(ba,F.a.instance.ga(842));wa.c(this.$,la.range)&&B(ba,F.a.instance.ga(846));this.IJg(ba,la);ra=(ra=na.za(14))?ra.fIh():"";B(ba,ra);la.pH&&(ra=J.g(this.$).Ea.Mr(la.range),ra=!!ra&&ra.d6e,
m.Dvj(la)?m.JJg(ba,la):C.EwaSettings.isChangeGateEnabled("OfficeVSO:3286994_NarratorForFormulaErrors")&&ra?B(ba,F.a.instance.ga(844)):B(ba,F.a.instance.ga(843)));la.Waa&&(B(ba,F.a.instance.ga(845)),la.uwb&&B(ba,String.format(F.a.instance.lb(16),la.pbh)),B(ba,la.iconName));la.hasRichValueIcon&&(sa=this.$.da.za(271),ra="",sa&&la.cell.Tjf&&(sa=sa.fQ(la.cell.Tjf))&&sa.DomainId.Id!==m.jXj&&(ra=sa.Name),la.cell.sei?(B(ba,String.format(F.a.instance.lb(182),ra)),B(ba,F.a.instance.ga(1787))):(B(ba,String.format(F.a.instance.lb(180),
ra)),B(ba,F.a.instance.ga(1786))));this.G4h(la)&&B(ba,m.WOh(la));(na=na.za(231))&&B(ba,na.uZe(Ea,!0));1===Ea.length&&Ea[0].isSingle&&m.Cvj(la,Ea[0],this.$)&&(Ea=this.$.da.za(271))&&B(ba,Ea.sIh());la.hNb&&la.iNb&&B(ba,la.iNb);(Ea=la.cell.AVg)&&B(ba,Ea);la.Mwa&&la.MFb&&(la=la.OCd)&&(B(ba,F.a.instance.ga(1955)),B(ba,la));return ba.toString()};m.prototype.Jue=function(la){this.nsa=this.gD;this.gD=Object(Y.a)(new f,{activeItemName:this.nsa.activeItemName,dzc:la?this.nsa.dzc:!1,tableName:la?this.nsa.tableName:
"",O_a:la?this.nsa.O_a:-1})};m.prototype.XSf=function(){this.nsa&&(this.gD=this.nsa,this.nsa=null)};m.prototype.mTh=function(la,Ea){return 2===la||2===Ea?F.a.instance.ga(872):1===la||1===Ea?F.a.instance.ga(873):""};m.prototype.gZe=function(la){return this.fZe(la.cell,la.text)};m.prototype.bKg=function(la,Ea,ra){if(ra&&1===ra.length&&ra[0].isSingle){ra="";var na=this.tableManager.iva(Ea.range);if(na){ra=na.pivotTableName;this.XVc(la,ra);var ba=na.Yfc?F.a.instance.ga(834):"";C.EwaSettings.isChangeGateEnabled("OfficeVSO:6154754_NarratorReadoutForPivotTableAltText")&&
(ba+=(na.altText?na.altText+" . ":"")+(na.altTextSummary?na.altTextSummary:""));this.Lpe(la,!0,ra,ba);B(la,this.tableManager.Kli(na,Ea.range)?F.a.instance.ga(836):"");B(la,this.tableManager.Kfi(na,Ea.range)?F.a.instance.ga(835):"")}else if(na=this.tableManager.Xm(Ea.range)){ra=(ba=J.g(this.$).Ab.dk(Ea.range))?ba.name:"";this.XVc(la,ra);var sa="";ba&&C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableMissingContextMenuOptions",!1)&&(sa=(ba.ASa?ba.ASa+" . ":"")+(ba.BSa?ba.BSa:""));this.Lpe(la,
!1,ra,sa);B(la,this.tableManager.Xcf(na,Ea.range)?F.a.instance.ga(835):"")}else this.XVc(la,ra),this.gD.tableName="",this.gD.O_a=-1}};m.prototype.XVc=function(la,Ea){Ea!==this.gD.tableName&&this.gD.tableName&&(la.append(F.a.instance.ga(this.gD.dzc?833:832)),B(la," "+this.gD.tableName))};m.prototype.Lpe=function(la,Ea,ra,na){ra!==this.gD.tableName&&(la.append(F.a.instance.ga(Ea?831:830)),B(la," "+ra),B(la,na),this.gD.tableName=ra,this.gD.dzc=Ea,this.gD.O_a=-1)};m.prototype.Jpe=function(la,Ea){var ra=
J.g(this.$).ha.sa.activeCell;if(ra.top!==Ea.top&&ra.left!==this.gD.O_a){la.append(F.a.instance.ga(835));Ea=new ha.Range(Ea.top,ra.left,Ea.top,ra.left,!0,!0);B(la,w.lfd(Ea));if(Ea=J.g(this.$).Ub(Ea))Ea=Ea.Xaa?this.gZe(Ea):Ea.text,B(la,Ea);this.gD.O_a=ra.left}};m.prototype.fZe=function(la,Ea){var ra=la.Z4a;return la.xwb?String.format(F.a.instance.lb(14),Ea,ra):String.format(F.a.instance.lb(13),Ea,w.Rdj(ra))};m.prototype.Ti=function(){E.ULS.shipAssertTag(537153930,0,!!this.$,"Can't register to ewaControl's events");
if(this.$){var la=J.g(this.$);E.ULS.shipAssertTag(537153929,0,!!la,"Can't register to grid's events");la&&(la.Wb.Bk(this.gp),la.Ea.mx(this.Rca),la.XD(this.Rca),this.mab&&la.Wb.vm(this.Df.bind(this)),la=la.ha,E.ULS.shipAssertTag(537153928,0,!!la,"Can't register to selectionManager's events"),la&&(la.yG(this.Rc),la.kJ(this.Rca),la.Oa.r2(this.Rca),this.mab&&(this.gGd=this.gGd.bind(this))))}};m.prototype.Uj=function(){if(this.$){var la=J.g(this.$);la&&(la.Wb.wk(this.gp),la.Ea.fv(this.Rca),la.DF(this.Rca),
this.mab&&la.Wb.Nl(this.Df),la=la.ha)&&(la.EF(this.Rca),la.UN(this.Rca),la.Oa.Ima(this.Rca))}};m.prototype.readText=function(la,Ea){this.X5a&&this.gridReadoutNotifier&&this.gridReadoutNotifier.isActive?this.gridReadoutNotifier.readText(la):(C.EwaSettings.isChangeGateEnabled("OfficeVSO:5033038_Embed_Mode_Grid_Narrator_Fix")&&this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(la),this.mab&&!Ea||this.ariaLiveNotifier.YPj(Ea))};m.prototype.Df=function(){this.$nb&&this.$nb.cancel()};m.prototype.gGd=
function(){this.readText(this.CWh())};m.prototype.CWh=function(){var la=this,Ea="";J.g(this.$).ha.rangePicker.zK.forEach(function(ra){Ea+=la.tXh(ra)});return Ea+=" selected"};m.prototype.tXh=function(la){return" "+(la.sheetId!==xa.d(this.$.pa)?this.$.va.Lfd(la.sheetId).name:"")+" "+la.range.topLeft+" "+(la.range.isSingle?"":la.range.bottomRight)};m.prototype.bHh=function(){var la=null;var Ea=J.g(this.$).ha;if(1!==Ea.Qe&&!Ea.Oa.Yb)return E.ULS.sendTraceTag(537153927,0,15,"selectionManager.CommandSelectionMode={0} and selectionManager.SelectedFloatingObjectControl is null",
Ea.Qe),{returnValue:"",activeCell:la};switch(Ea.Qe){case 2:return{returnValue:this.cKh(Ea),activeCell:la};case 64:var ra=Ea.Oa.Yb.floatingObject,na="";if(Ea=Ea.Oa.Yb.ns||Ea.Oa.Yb.Dd)na=(na=Ea.firstChild)?M.DOMElementExtensions.getTextContent(na):"";return{returnValue:String.format(F.a.instance.lb(53),m.C$b(ra.altText,ra.altTextDescription,ra.name),na,ra.altTextDescription),activeCell:la};case 4:return{returnValue:m.VIg(Ea.Oa.Yb.floatingObject),activeCell:la};case 512:return{returnValue:da.a.VXe(Ea.Oa.Yb.floatingObject.J6c),
activeCell:la};case 8:return ra=(ra=Ea.Oa.Yb.floatingObject)?ra.name:"",{returnValue:String.format(F.a.instance.lb(51),ra),activeCell:la};case 1:return la=this.activeCell,{returnValue:this.yWe(la,Ea.sa.selectedRanges),activeCell:la}}return{returnValue:"",activeCell:la}};m.prototype.cKh=function(la){var Ea=new Sys.StringBuilder;Ea.append(m.fWg(la));var ra=this.$.da.za(231);ra&&B(Ea,ra.uZe(la.Oa.Yb.floatingObject,!1));return Ea.toString()};m.prototype.G4h=function(la){la=la.bbf();var Ea=!1;this.gD.Wff!==
la&&(this.gD.Wff=la,Ea=!0);return Ea};m.prototype.LJg=function(la,Ea){if(Ea.Hwb)if(Ea=this.sparklineManager.BXh(Ea)){var ra=F.a.instance,na=ra.ga;a:switch(Ea.type){case 0:var ba=827;break a;case 1:ba=828;break a;default:ba=829}ra=na.call(ra,ba);B(la,String.format(F.a.instance.lb(25),ra));Ea=String.format(F.a.instance.lb(24),w.lfd(Ea.rDj));B(la,Ea)}else E.ULS.sendTraceTag(537153925,0,15,"No sparkline range was found on a cell with sparkline."),B(la,String.format(F.a.instance.lb(25),""))};m.prototype.cKg=
function(la,Ea){switch(Ea){case 1:case 11:B(la,F.a.instance.ga(847));break;case 6:B(la,F.a.instance.ga(847));B(la,F.a.instance.ga(849));break;case 7:B(la,F.a.instance.ga(847));B(la,F.a.instance.ga(850));break;case 2:B(la,F.a.instance.ga(848));B(la,F.a.instance.ga(849));break;case 3:B(la,F.a.instance.ga(848));B(la,F.a.instance.ga(850));break;default:B(la,F.a.instance.ga(848))}};m.prototype.IJg=function(la,Ea){var ra,na=this.$.da.za(65);Ea=na?na.HJa(Ea.range):null;var ba="",sa=Object(fa.a)(593,Ea);
if(Ea)ba=!Ea.g6a&&sa&&sa.lni?String.format(F.a.instance.lb(29),sa.JHj):String.format(F.a.instance.lb(23),Ea.author);else if(null===(ra=null===na||void 0===na?void 0:na.Em)||void 0===ra?0:ra.WE)ba=String.format(F.a.instance.lb(28),na.Em.jN.author);B(la,ba)};m.VIg=function(la){return String.format(F.a.instance.lb(52),m.C$b(la.altText,la.altTextDescription,la.name),la.altTextDescription)};m.WOh=function(la){return F.a.instance.ga(la.bbf()?837:838)};m.C$b=function(la,Ea,ra){return la||Ea?la:ra};m.fWg=
function(la){var Ea=la.Oa.Yb;la=Ea.floatingObject;var ra=la.Oc,na=ra.ChartTitle,ba=la.altText,sa=la.altTextDescription,ya=!!(ra.Attributes&4);return(Ea=Ea.getSelectionDescription())?Ea:ra.DataRangeForDisplay?String.format(F.a.instance.lb(ya?49:47),m.C$b(ba,sa,la.name),sa,na,F.a.instance.ga(n(ra.ChartCategory)),ra.DataRangeForDisplay):String.format(F.a.instance.lb(ya?50:48),m.C$b(ba,sa,la.name),sa,na,F.a.instance.ga(n(ra.ChartCategory)))};m.Dvj=function(la){return C.EwaSettings.ma(103)&&(la.O5a||la.Wfc)};
m.JJg=function(la,Ea){if(!Ea.hSa)E.ULS.shipAssertTag(537153924,0,!1,"SelectionReadoutHandler.AppendAriaDynamicArrayFormulaDescription: This method should only be called with a valid dynamic array range.");else if(Ea.O5a)Ea=Ea.hSa.topLeft.toString(),B(la,String.format(F.a.instance.lb(26),Ea));else if(Ea.Wfc){var ra=Ea.hSa.oS();Ea=(ra.LastColumn-ra.FirstColumn+1).toString();ra=(ra.LastRow-ra.FirstRow+1).toString();B(la,String.format(F.a.instance.lb(27),Ea,ra))}};m.Cvj=function(la,Ea,ra){return la.pH||
!C.EwaSettings.ma(139)?!1:(la=ra.da.za(271))?la.ufc(Ea):!1};m.Kni=function(la){return la.top===la.bottom&&la.left+1===la.right||la.top+1===la.bottom&&la.left===la.right};Af.Object.defineProperties(m.prototype,{activeCell:{configurable:!0,enumerable:!0,get:function(){return J.g(this.$).Ub(null)}}});m.jXj=268435712;m.eTc=500;Object(u.a)(m,"SelectionReadoutHandler",null,[594,10]);var ab=b(58),Na=G.a;Rk(l,Na);l.prototype.create=function(){var la=this,Ea=this.$.da,ra=ea.GetServiceTaskFactory.Ra(Ea,211,
212,this.hb),na=ea.GetServiceTaskFactory.Ra(Ea,66,134,this.hb),ba=ea.GetServiceTaskFactory.Ra(Ea,240,239,this.hb),sa=ab.Task.Ua(null);C.EwaSettings.tb()&&(sa=ea.GetServiceTaskFactory.Ra(Ea,244,315,this.hb));ka.TaskExtensions.Ba(ka.TaskExtensions.Wd([ra,na,ba,sa],this.la),function(){var ya=Ea.za(226)||new m(ra.result,la.$,na.result,ba.result,sa.result);la.pb(ya)},this.$.la,3)};l.ka=function(la){la.da.Ga(227,new l(la))};Object(u.a)(l,"SelectionReadoutHandlerFactory",G.a,[]);k.prototype.zLf=function(){var la=
this.hIh();this.ariaLiveNotifier.rab(la,U.a.Qnb)};k.prototype.hIh=function(){var la=new Sys.StringBuilder;this.$.workbookContext&&B(la,this.$.workbookContext.WorkbookFileName);B(la,F.a.instance.ga(853));B(la,this.jIh());B(la,this.iIh());B(la,F.a.instance.ga(854));return la.toString()};k.prototype.jIh=function(){return this.$.isEditMode?F.a.instance.ga(858):F.a.instance.ga(859)};k.prototype.iIh=function(){var la=this.rWj(),Ea=this.$.va.pa;la=1!==la?String.format(F.a.instance.lb(32),la):F.a.instance.ga(852);
la=new Sys.StringBuilder(la);Ea&&Ea.sheetName&&(la.append(y.Ytd),la.append(String.format(F.a.instance.lb(33),Ea.sheetName)));return la.toString()};k.prototype.rWj=function(){for(var la=0,Ea=ak(this.$.va.items),ra=Ea.next();!ra.done;ra=Ea.next())ra.value.visible&&la++;return la};Object(u.a)(k,"WorkbookReadout",null,[]);e.prototype.dispose=function(){this.X9b&&this.X9b.vbj(this.hyf);this.X9b=this.ariaLiveNotifier=this.$=null};Object(u.a)(e,"EmbeddedWorkbookReadoutHandler",null,[10]);d.prototype.dispose=
function(){this.Uj();this.ariaLiveNotifier=this.VY=null;this.Ad=!0};d.prototype.Ti=function(){if(this.VY){this.VY.Ft(this.WV);this.VY.Ea.mx(this.WV);this.VY.XD(this.WV);var la=Object(fa.a)(417,this.VY);la&&(la.Wb.Bk(this.WV),la.ha.yG(this.WV),la.ha.kJ(this.WV),la.ha.Oa.r2(this.WV))}else E.ULS.sendTraceTag(537153923,0,15,"WorkbookReadoutHandler.RegisterEvents: Can't register to view events")};d.prototype.Uj=function(){if(this.VY){this.VY.Ea.fv(this.WV);this.VY.DF(this.WV);var la=Object(fa.a)(417,this.VY);
la&&(la.Wb.wk(this.WV),la.ha.EF(this.WV),la.ha.UN(this.WV),la.ha.Oa.Ima(this.WV))}};d.prototype.jpe=function(){this.b_d.zLf();this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.Cpj();this.dispose()};Object(u.a)(d,"WorkbookReadoutHandler",null,[10]);var Ka=G.a;Rk(c,Ka);c.prototype.create=function(){var la=this,Ea=ea.GetServiceTaskFactory.Ra(this.$.da,211,212,this.hb);if(this.$.VM){var ra=ea.GetServiceTaskFactory.Ra(this.$.da,12,477,this.hb);ka.TaskExtensions.Ba(ka.TaskExtensions.Wd([Ea,ra],
this.$.la),function(){var na=new e(Ea.result,la.$,ra.result);la.pb(na)},this.$.la,3)}else ka.TaskExtensions.Ba(Ea,function(na){na=new d(na.result,la.$);la.pb(na)},this.$.la,3)};c.ka=function(la){la.da.Ga(229,new c(la))};Object(u.a)(c,"WorkbookReadoutHandlerFactory",G.a,[]);b.d(D,"a",function(){return a})},1364:function(u,D,b){function a(){C.a.Fa(function(Ma){c.ka(Ma)})}function c(Ma){return fb.call(this,Ma)||this}function d(Ma,Hb,Kb,Ub){var gb=this;this.menuId=null;this.PQa=-1;this.KCf=function(){gb.$ca()};
this.oTi=function(Db){if(!(gb.sa.xLa()||(!ha.EwaSettings.isChangeGateEnabled("OfficeVSO:4124510_JsCrashOnToggleTableStyleOptionSuccessful")||fa.a(Db)||gb.PLa())&&fa.a(Db)&&gb.PLa())){Db=gb.sa.activeCell;var Va=gb.sa.activeRange,yb=gb.tableManager.qg.usedRange;2===gb.PQa&&Z.g(gb.tableManager.qg)&&Db.bottom===yb.bottom&&(Va=Va.l5?new K.Range(Va.top-1,Va.left,Va.bottom-1,Va.right,!1,!0):new K.Range(Va.top,Va.left,Va.bottom-1,Va.right,!1,!0),Db=Va.contains(Db)?Db:K.Range.Tc(Va.bottom,Db.left),S.g(gb.$).ha.updateSelection(Va,
Db,0,3))}};this.GSi=function(Db){fa.a(Db)?(U.ULS.sendTraceTag(594130062,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename failed due invalid user input"),gb.$.jf()):U.ULS.sendTraceTag(594130061,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename successful")};this.FSi=function(){U.ULS.sendTraceTag(594130060,0,15,"TableManager.OnTableRenameFailure-Rename table failed");gb.$.jf()};this.HSi=function(Db,Va){Va&&gb.jL(Va);fa.b(Db,-569193796)&&(La.a(gb.$).fd.hJ(-569193796),gb.ori(Db.Errors[0]))};
this.$=Ma;this.tableManager=Hb;this.namedSheetViewPublic=Kb;this.frame=this.$.frame;this.ha=S.g(this.$).ha;this.sa=this.ha.sa;this.Ux=ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");this.tableStyleManager=Ub;this.tableStyleManager.vGg(this.KCf)}function e(Ma){Ma=sa.call(this,Ma)||this;var Hb=S.g(Ma.$);Hb=Hb.Ab.dk(Hb.ha.sa.activeCell);wa.a.uh(Hb.ASa)?Ma.KBd="":Ma.KBd=Hb.ASa;wa.a.uh(Hb.BSa)?Ma.IBd="":Ma.IBd=Hb.BSa;Hb=Ma.DM(Ma.KBd,Ma.IBd);Ma.initializeAndShow(la.a.instance.ga(745),
Ma.nHj,Hb);return Ma}function k(Ma){var Hb=ba.call(this,Ma)||this;Hb.xHj=function(Kb,Ub){1===Kb&&Hb.iMj(H.D(Hb.iFf(Ub[k.JKf])))};Hb.ivb=function(Kb){Kb=Hb.hed(Kb);return Hb.Ebd(Kb)};Hb.gridView=S.g(Ma);Hb.sa=Hb.gridView.ha.sa;Hb.Qoc=Hb.gridView.Ab.dk(Hb.sa.activeCell).usedRange;Ma=Hb.DM(Hb.Qoc.toString());Hb.initializeAndShow(la.a.instance.ga(736),Hb.xHj,Ma);return Hb}function l(Ma,Hb){Ma=ra.call(this,Ma)||this;Ma.VAa=Hb;return Ma}function m(Ma,Hb){Ma=Ea.call(this,Ma,la.a.instance.ga(735))||this;
Ma.VAa=Hb;return Ma}function f(Ma,Hb,Kb){this.gpd=!1;this.sharedSheetRange=Hb;this.$=Ma;this.Ph=this.$.Fb.Lg("UserAction","ConvertToRangeManager");this.tableName=Kb}function w(Ma){this.tableName=null;this.tableName=Ma}function n(Ma,Hb,Kb){this.isPivotTable=!1;this.tableRange=null;this.optionType=0;this.tableRange=Ma;this.optionType=Hb;this.isPivotTable=Kb}function z(Ma){this.originalRange=null;this.originalRange=Ma}function r(Ma,Hb){this.newName=this.oldName=null;this.oldName=Ma;this.newName=Hb}function v(Ma,
Hb,Kb){this.description=this.title=this.tableRange=null;this.tableRange=Ma;this.title=Hb;this.description=Kb}function A(Ma,Hb,Kb,Ub){Ma=B.call(this,Ma,Kb)||this;Ma.hasHeaders=!1;Ma.isCreation=!1;Ma.hasHeaders=Hb;Ma.isCreation=Ub;return Ma}function B(Ma,Hb){this.tableRange=this.tableRanges=null;this.styleIndex=0;this.tableRanges=Ma;this.tableRange=H.l(Ma.Ranges[0],Ma.SheetName);this.styleIndex=Hb}function y(Ma){this.autoFilterOptions=null;this.autoFilterOptions=Ma}function x(Ma,Hb){this.autoFilterOptions=
null;this.sortType=0;this.autoFilterOptions=Ma;this.sortType=Hb}var C=b(11);u=b(0);var G=b(905),E=b(51),I=b(37),U=b(15),M=b(4),T=b(31),F=b(5),K=b(24),J=b(76),O=b(54);x.prototype.XU=function(){return this.autoFilterOptions};Object(u.a)(x,"MacroRecorderRangeColumnSortedOrFilteredPayload",null,[409]);y.prototype.XU=function(){return this.autoFilterOptions};Object(u.a)(y,"MacroRecorderRangeItemFilteredPayload",null,[409]);var N=b(1136),H=b(45),Q=b(389),ca=b(177),X=b(61),Z=b(169),ea=b(249),ka=b(47),Y=
b(44),qa=b(12),fa=b(296),ha=b(1),ia=b(186),wa=b(22),Qa=b(295),S=b(21);Object(u.a)(B,"MacroRecorderTableStyleAppliedPayload",null,[409]);Rk(A,B);Object(u.a)(A,"MacroRecorderRangeFormatedAsTablePayload",B,[]);v.prototype.Xm=function(){return this.tableRange};v.prototype.getTitle=function(){return this.title};v.prototype.getDescription=function(){return this.description};Object(u.a)(v,"MacroRecorderTableAltTextEditedPayload",null,[409]);Object(u.a)(r,"MacroRecorderTableRenamedPayload",null,[409]);Object(u.a)(z,
"MacroRecorderTableResizedPayload",null,[409]);Object(u.a)(n,"MacroRecorderTableStyleOptionToggledPayload",null,[409]);var da=b(29),xa=b(42);Object(u.a)(w,"MacroRecorderTableConvertedToRangePayload",null,[409]);var ta=b(954);f.prototype.w$a=function(){var Ma=this;this.Ph.start();var Hb=this.$.oa.xa.Pb();return ta.h(this.$.oa.xa,this.sharedSheetRange,function(Kb){Ma.showDialog(Kb)},null,null,null,Hb)};f.prototype.showDialog=function(Ma){var Hb=this;U.ULS.sendTraceTag(537151193,0,50,"ConvertToRangeManager.ShowDialog: Time taken to show Get IsRangeQueryTable is {0} milliseconds",
this.Ph.qc);Ma&&!fa.a(Ma)&&((this.gpd=Ma.Result)?(Ma=da.a.Wc(3,2,0,741,0,-66108047,"ConvertToRange"),I.TaskExtensions.Ba(xa.a(this.$).kj(Ma),function(Kb){U.ULS.sendTraceTag(537151192,0,50,"ConvertToRangeManager.ShowDialog: Time taken for User Input is {0} milliseconds",Hb.Ph.qc);0===Kb.result&&Hb.d3g()},this.$.la,11)):this.e3g());this.Ph.stop();U.ULS.sendTraceTag(537151191,0,50,"ConvertToRangeManager.ShowDialog: Total Time taken for complete operation is {0} milliseconds",this.Ph.qc)};f.prototype.Mte=
function(){var Ma={};Ma.IsQueryTable=this.gpd;Ma.Range=this.sharedSheetRange;return Ma};f.prototype.d3g=function(){var Ma=this,Hb=this.$.oa.xa;U.ULS.sendTraceTag(537151190,0,50,"Convert To Range initiated for Query Table");this.naf(194,function(Kb,Ub,gb){return ta.d(Hb,Ma.Mte(),Kb,Ub,gb,null)});U.ULS.sendTraceTag(537151189,0,50,"Convert To Range completed for Query Table")};f.prototype.e3g=function(){var Ma=this,Hb=this.$.oa.xa;U.ULS.sendTraceTag(537151188,0,50,"Convert To Range initiated for Normal Table");
this.naf(193,function(Kb,Ub,gb){return ta.c(Hb,Ma.Mte(),Kb,Ub,gb,null)},function(){return new w(Ma.tableName)});U.ULS.sendTraceTag(537151187,0,50,"Convert To Range completed for Normal Table")};f.prototype.naf=function(Ma,Hb,Kb){Kb=void 0===Kb?null:Kb;Q.a(this.$.userOperationManager,Hb,function(Ub){return new ca.a(Ma,0,Ub,void 0,Kb)},null)};Object(u.a)(f,"ConvertToRangeManager",null,[]);var ab=b(1336),Na=b(1335),Ka=b(1467),la=b(14),Ea=Ka.a;Rk(m,Ea);m.prototype.dj=function(){var Ma=this,Hb=H.s(this.pC.TableRange);
return function(){return new A(Hb,Ma.F4a.checked,Ma.VAa,!0)}};m.prototype.Py=function(){var Ma=this,Hb=H.s(this.pC.TableRange);return function(Kb,Ub,gb){return ta.g(Ma.$.oa.xa,Hb,Ma.F4a.checked,!1,Ma.pC.HasTotalRow,Ma.VAa,Kb,Ub,gb,null)}};m.prototype.fy=function(Ma,Hb,Kb){Ea.prototype.fy.call(this,Ma,Hb,Kb)};Af.Object.defineProperties(m.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"FormatAsTableDialog"}},uv:{configurable:!0,enumerable:!0,get:function(){return 215}}});Object(u.a)(m,
"FormatAsTableDialogDeprecated",Ka.a,[]);Ka=b(1158);var ra=Ka.a;Rk(l,ra);l.prototype.dj=function(){var Ma=this,Hb=H.s(this.pC.TableRange);return function(){return new A(Hb,Ma.hasHeaders,Ma.VAa,!0)}};l.prototype.Py=function(){var Ma=this,Hb=H.s(this.pC.TableRange),Kb=this.pC.HasTotalRow;return function(Ub,gb,Db){return ta.g(Ma.$.oa.xa,Hb,Ma.hasHeaders,!1,Kb,Ma.VAa,Ub,gb,Db,null)}};Af.Object.defineProperties(l.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"FormatAsTableDialog"}},
uv:{configurable:!0,enumerable:!0,get:function(){return 215}},Al:{configurable:!0,enumerable:!0,get:function(){return la.a.instance.ga(735)}}});Object(u.a)(l,"FormatAsTableReactDialog",Ka.a,[]);Ka=b(390);var na=b(98),ba=Ka.a;Rk(k,ba);k.prototype.iFf=function(Ma){Ma=Ma.startsWith("=")?Ma.substring(1,Ma.length):Ma;var Hb=H.Z(Ma,this.$.va);Ma=Hb.sheetName;var Kb=Hb.range;return Hb.returnValue&&Kb?(Kb=H.v(Kb,this.$),Kb.SheetName=wa.a.equals(Ma,"",!0)?this.$.pa.name:Ma,Kb):null};k.prototype.DM=function(Ma){var Hb=
{};return Hb[k.z4]="ResizeTableDialog",Hb[k.JKf]=Ma,Hb.getInputErrorIfInvalid=this.ivb,Hb};k.prototype.hed=function(Ma){Ma=this.iFf(Ma);if(!Ma)return 1;var Hb=H.D(Ma);return wa.a.equals(Ma.SheetName,this.$.pa.sheetName,!0)&&this.Qoc.top===Hb.top&&this.Qoc.xd(Hb)?0:2};k.prototype.Ebd=function(Ma){var Hb="";switch(Ma){case 1:Hb=la.a.instance.ga(75);break;case 2:Hb=na.a.rh(la.a.instance.ga(74))}return Hb};k.prototype.iMj=function(Ma){var Hb={};Ma=(Hb.ResizeTableRange=Ma,Hb.OriginalTableRange=this.Qoc,
Hb);this.$.Fd(-1400250766,J.a.Cb,8,Ma)};Af.Object.defineProperties(k.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"ResizeTableDialog"}}});k.z4="id";k.JKf="range";Object(u.a)(k,"ResizeTableDialog",Ka.a,[]);var sa=Ka.a;Rk(e,sa);e.prototype.nHj=function(Ma,Hb){if(1===Ma&&(Ma=Hb[e.QJj],Hb=Hb[e.wdh],Ma!==this.KBd||Hb!==this.IBd)){var Kb={};Ma=(Kb.Title=Ma,Kb.Description=Hb,Kb);this.$.Fd(868579142,J.a.Cb,8,Ma)}};e.prototype.DM=function(Ma,Hb){var Kb={};return Kb.id="AltTextDialog",
Kb.title=Ma,Kb.description=Hb,Kb};Af.Object.defineProperties(e.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"TableAltTextDialog"}}});e.z4="id";e.QJj="title";e.wdh="description";Object(u.a)(e,"TableAltTextDialog",Ka.a,[]);var ya=b(983),va=b(984),W=b(112),La=b(67),Ia=b(58),mb=b(36);d.prototype.Lc=function(Ma,Hb){switch(Hb){case -544558380:return!(this.tableManager&&this.sa.ZJ()&&!this.PLa()&&Z.d(this.tableManager.qg));case 1544516694:return!(this.tableManager&&(this.sa.ZJ()?!this.PLa():
this.sa.xLa()));case -697806646:case 323142015:return!this.sa.ZJ();case 341449783:case 2128797448:return ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6083078_HeaderAndTotalRowDisabledFix")?!(this.tableManager&&(this.sa.ZJ()?!this.PLa():this.sa.xLa())):!(this.tableManager&&this.tableManager.pqd(this.sa.activeCell));case -123538519:return!(this.sa.ZJ()&&this.tableStyleManager&&this.tableStyleManager.Zhc());case 756677940:return!(ha.EwaSettings.ma(409)&&this.Odi());case 753331043:case 2105103744:case -585683120:return!(this.tableStyleManager&&
this.Pdi());case 844144422:return!this.sa.ZJ();case -723113214:return!(ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableMissingContextMenuOptions",!1)&&this.sa.ZJ())}return!1};d.prototype.executeCommand=function(Ma,Hb,Kb){var Ub=this,gb;Ma=I.TaskExtensions.jk();var Db=this.$.oa.xa,Va=null,yb=1,qb=Hb.command,dc=this.$.oa.xa.Pb(),bb=null;switch(qb){case -2058042992:var db=O.a.Vh(Kb[J.a.Vf]);d.FXf(this.$,db);Va=function(lb,ac,Dc){return ta.a(Db,db,null,null,!1,!1,!1,ya.a.nva(W.a.$ra,
va.a.clearAutoFilter,lb),ac,Dc,null)};yb=176;bb=function(){return new y(db)};break;case 504133448:case -798968736:case 477776686:var wc=O.a.Vh(Kb[J.a.Vf]),nb=Kb.TopCellAddress;d.FXf(this.$,wc);var zb=504133448===Hb.command?1:-798968736===Hb.command?2:3;if(ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6516289_SheetProtectionSettings")&&nb){Kb=this.tableManager.Xm(nb);if(!Kb&&ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")){var ma=this.$.va.pa;(null===(gb=H.D(ma.x0))||
void 0===gb?0:gb.contains(nb))?Kb=H.D(ma.x0):U.ULS.sendTraceTag(527700033,0,15,"TableCommandHandler.executeCommand: unknown sort range; unable to check for protected ranges")}if(!this.$.isEditMode){if(!ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")||Kb&&!this.$.rWc([Kb],!0,1))break}else if(Kb&&!this.$.kq([Kb],!0,1))break}Va=function(lb,ac,Dc){return X.I(Db,wc,zb,Qa.b(lb,Ub.HSi),ac,Dc,nb,dc)};yb=177;bb=function(){return new x(wc,zb)};break;case 341449783:case 2128797448:this.PQa=
341449783===qb?0:2;gb=this.toggleTableStyleOption(Db,dc);Va=gb.RBa;yb=gb.operationName;bb=gb.dj;break;case -712419744:this.Ux?this.Z$e(Kb[F.a.event]):this.Z$e(null);break;case 1868184698:if(ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6224451_CreateTableInEmptyCell")&&(Kb=this.z$f(null,dc),gb=Kb.oyb,Va=Kb.RBa,bb=Kb.dj,gb)){yb=206;break}ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TablesReactDialog",!1)?new Na.a(this.$):(gb=new ab.a(this.$),gb.initialize(),gb.hf());break;case 844144422:new k(this.$);
break;case 1544516694:case -544558380:if(gb=Kb[J.a.Nc])this.PQa=this.uYh(gb),-1!==this.PQa&&(gb=this.toggleTableStyleOption(Db,dc),Va=gb.RBa,yb=gb.operationName,bb=gb.dj);break;case 756677940:if(this.PLa()&&this.$ef()){U.ULS.sendTraceTag(537151177,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while executing rename command");break}var P=Kb.Text,oa=this.IQh();if(oa){Va=function(lb,ac,Dc){return ta.i(Db,P,oa,Qa.b(lb,Ub.GSi),Qa.a(ac,
Ub.FSi),Dc,dc)};yb=217;var Ja=null;this.tableManager.qg?Ja=this.tableManager.qg.name:this.tableManager.qEd?Ja=this.tableManager.qEd.name:U.ULS.sendTraceTag(537151176,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while fetching oldName during executing rename command");Ja&&(bb=function(){return new r(Ja,P)})}else return U.ULS.sendTraceTag(537151175,0,10,"TableCommandHandler.RenameTable: Selected Table Range is null"),Ia.Task.Ua(!1);
break;case 323142015:if(this.PLa())break;return(new f(this.$,this.Wbd(),this.tableManager.qg.name)).w$a();case -1400250766:yb=211;Va=this.xgj(Kb,Db,dc);var $a=H.m(Kb.OriginalTableRange,this.$.va.pa);bb=function(){return new z($a)};break;case 1872288872:this.tableManager.c3i();break;case -123538519:var Ta=this.tYh(Kb);gb=wa.a.contains(Kb[J.a.Nc],F.a.hGb,!0)||wa.a.contains(Kb[F.a.TF],"TableStyleIcon",!0)?"Preview Gallery":"Pop-out Gallery";U.ULS.sendTraceTag(51181323,0,50,"TableStyleManager.ApplyTableStyleWebInvocation - Apply Table Style Invoked from {0} with style index {1}",
gb,Ta.toString());var pa=this.r1e();pa&&(Va=function(lb,ac,Dc){return ta.b(Db,pa,Ta,lb,ac,Dc,null,dc)},bb=function(){return new B(pa,Ta)},yb=212);break;case 753331043:gb=Kb[J.a.Nc];if(!gb)break;var Da=Number.parseInvariant(gb);if(this.sa.ZJ()){U.ULS.sendTraceTag(51181321,0,50,"TableCommandHandler.FormatAsTable invoked on existing table with style index: {0}",Da);var rb=this.r1e();rb&&(Va=function(lb,ac,Dc){return ta.g(Db,rb,!1,!1,!1,Da,lb,ac,Dc,null,dc)},bb=function(){return new A(rb,!1,Da,!1)},yb=
215);break}if(ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6224451_CreateTableInEmptyCell")&&(ma=this.z$f(Da,dc),Kb=ma.oyb,Va=ma.RBa,bb=ma.dj,Kb)){yb=215;break}U.ULS.sendTraceTag(51181322,0,50,"TableCommandHandler.FormatAsTable invoked on newly created table with style index: {0}",Da);ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TablesReactDialog",!1)?new l(this.$,Number.parseInvariant(gb)):(gb=new m(this.$,Number.parseInvariant(gb)),gb.initialize(),gb.hf());break;case 71074531:var Ab=
Kb.HasHeader,ob=Kb.TableRange;Va=function(lb,ac,Dc){return ta.e(Db,ob,Ab,!1,!1,lb,ac,Dc,null)};bb=function(){return new N.a(Ab,ob)};yb=206;break;case -723113214:new e(this.$);break;case 868579142:U.ULS.sendTraceTag(526463700,0,50,"AltText on table changed.");yb=1022;var sb=Kb.Title,Pb=Kb.Description,Aa=this.Wbd();Va=function(lb,ac,Dc){return ta.f(Db,sb,Pb,Aa,lb,ac,Dc,null)};if(this.tableManager.qg){ma=wa.a.uh(this.tableManager.qg.ASa)?"":this.tableManager.qg.ASa;var Ya=wa.a.uh(this.tableManager.qg.BSa)?
"":this.tableManager.qg.BSa}bb=sb==ma?function(){return new v(Aa,void 0,Pb)}:Pb==Ya?function(){return new v(Aa,sb,void 0)}:function(){return new v(Aa,sb,Pb)};break;default:return ia.a(qb)}if(Va){var kb=function(lb){return new ca.a(yb,0,lb,void 0,bb)};Ma=!this.namedSheetViewPublic||-2058042992!==qb&&504133448!==qb&&-798968736!==qb&&477776686!==qb?Q.a(this.$.userOperationManager,Va,kb,Hb):this.namedSheetViewPublic.FAa().continueWith(function(lb){lb.result&&Q.a(Ub.$.userOperationManager,Va,kb,Hb)})}return Ma};
d.prototype.toggleTableStyleOption=function(Ma,Hb){var Kb=this,Ub=this.sa.xLa();U.ULS.sendTraceTag(41996800,0,50,"TableCommandHandler: The selected {0} style option {1} was toggled.",Ub?"PivotTable":"table",this.PQa);var gb=this.Wbd();return{RBa:function(Db,Va,yb){return ta.k(Ma,gb,Kb.PQa,Qa.b(Db,Kb.oTi),Va,yb,null,Hb)},operationName:196,dj:function(){return new n(gb,Kb.PQa,Ub)}}};d.prototype.xgj=function(Ma,Hb,Kb){function Ub(qb){qb.Errors&&Db.tableManager.D7f(Va)}function gb(){Db.tableManager.D7f(Va)}
var Db=this,Va=Ma.OriginalTableRange,yb=H.m(Ma.ResizeTableRange,this.$.va.pa);return function(qb,dc,bb){return ta.j(Hb,yb,Qa.b(qb,Ub),Qa.a(dc,gb),bb,null,Kb)}};d.prototype.tYh=function(Ma){var Hb=-1;Ma[J.a.Nc]&&(Hb=Ma[J.a.Nc],Hb=wa.a.contains(Hb,F.a.hGb,!0)?this.tableStyleManager.hvb(Hb):Number.parseInvariant(Ma[J.a.Nc]));return Hb};d.prototype.Ac=function(Ma,Hb){Ma=!1;switch(Hb.command){case -2058042992:case 504133448:case -798968736:case 477776686:case 341449783:case 2128797448:case -712419744:case 1868184698:case 1872288872:case 323142015:case 1544516694:case -544558380:case -1400250766:case -123538519:case 753331043:case 844144422:case 71074531:Ma=
!0;break;case 756677940:Ma=ha.EwaSettings.ma(409);break;case -723113214:case 868579142:Ma=ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableMissingContextMenuOptions",!1)}return Ma};d.prototype.Qc=function(Ma,Hb,Kb){Ma=!1;switch(Hb){case "PopulateTableMoreStylesMenu":this.menuId=Kb.MenuId;this.tableStyleManager.Zhc()||this.tableStyleManager.oKa("formatAsTableMenu");Ma=this.tableStyleManager.EGf(Hb,Kb);break;case "PopulateTableAccessibleStylesMenu":this.menuId=Kb.MenuId,this.tableStyleManager.Zhc()||
this.tableStyleManager.oKa("accessibilityTab"),Ma=this.tableStyleManager.EGf(Hb,Kb)}return Ma};d.prototype.dispose=function(){this.tableStyleManager.qcj(this.KCf)};d.prototype.$ca=function(){(wa.a.contains(this.menuId,"Format",!0)||wa.a.contains(this.menuId,"Accessible",!0))&&this.menuId&&this.frame.Qw(this.menuId)};d.prototype.Wbd=function(){return H.v(this.sa.activeCell,this.$)};d.prototype.IQh=function(){var Ma=this.tableManager.Brd;return Ma?H.v(Ma,this.$):null};d.prototype.Z$e=function(Ma){if(this.tableManager){var Hb=
S.g(this.$),Kb=this.sa.activeCell,Ub=this.tableManager.Xm(Kb),gb=null;if(!Ub||Ub.Lna)for(Hb=ak(Hb.U2),Ub=Hb.next();!Ub.done;Ub=Hb.next()){Ub=ak(Ub.value);for(var Db=Ub.next();!Db.done;Db=Ub.next()){Db=Db.value;var Va=Db.Fn;Kb.left>=Va[0]&&Kb.left<=Va[Va.length-1]&&(gb=(Db=Db.Nr(Kb).QJ())?qa.DOMElementExtensions.Cj(Db,T.a.soe):null)}}else{var yb=Hb.Ub(K.Range.Tc(Ub.top,Kb.left));if(this.Ux){ka.a.instance.create(function(){yb.invoke(8,Ma)},0,Y.a.w7f,!0,!0);return}gb=yb.WJa(56).s5a}gb&&ka.a.instance.create(function(){qa.DOMElementExtensions.Xec(gb,
null)},0,Y.a.w7f,!0,!0)}};d.prototype.uYh=function(Ma){Ma=Number.parseInvariant(Ma);return-1<Ma&&8>=Ma?Ma:-1};d.prototype.PLa=function(){return!this.tableManager.qg};d.prototype.$ef=function(){return this.tableManager.qEd?!1:(U.ULS.sendTraceTag(537151173,0,15,"TableCommandHandler.IsPreviousSelectedTableObjectNull PreviousSelectedTableObject is null"),!0)};d.prototype.Pdi=function(){var Ma=this.sa.ZJ(),Hb=this.sa.tg&&!S.g(this.$).Ab.e5(this.sa.Vc);return Ma||Hb};d.prototype.Odi=function(){return this.sa.ZJ()||
!this.$ef()};d.prototype.wYh=function(Ma){var Hb=[];Ma=ak(Ma);for(var Kb=Ma.next();!Kb.done;Kb=Ma.next())if(Kb=ea.b(this.$,Kb.value),null===Kb||void 0===Kb?0:Kb.length){Kb=ak(Kb);for(var Ub=Kb.next();!Ub.done;Ub=Kb.next())Ub=Ub.value,Ub.usedRange&&!Array.contains(Hb,Ub.usedRange)&&Hb.push(Ub.usedRange)}return Hb};d.prototype.r1e=function(){var Ma=this.sa.selectedRanges,Hb=[];if(ha.EwaSettings.isChangeGateEnabled("OfficeVSO:3987000_ApplyTableStylesOnMultipleTablesInSingleRange"))Hb=this.wYh(Ma);else{Ma=
ak(Ma);for(var Kb=Ma.next();!Kb.done;Kb=Ma.next())Kb=Kb.value,S.g(this.$).Ab.e5(Kb)&&Hb.push(Kb)}return Hb&&Hb.length?H.r(Hb,this.$):null};d.prototype.jL=function(Ma){mb.a.Bba(this.$)&&I.TaskExtensions.Ba(E.GetServiceTaskFactory.Ra(this.$.da,430,431,1),function(Hb){Hb.result.iea(Ma);U.ULS.sendTraceTag(537151172,306,50,"TableCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.la,3)};d.prototype.ori=function(Ma){var Hb=this;I.TaskExtensions.Ba(E.GetServiceTaskFactory.Ra(this.$.da,
446,447,0),function(Kb){Kb.result.Z9g(Hb.$,Ma)},this.$.la,3)};d.FXf=function(Ma,Hb){Hb.SheetName=Ma.pa.name;Hb.NamedObjectView=Ma.ea.isNamedObjectViewMode};d.prototype.z$f=function(Ma,Hb){var Kb=this;if(!this.sa.tg||1!=this.sa.Vc.aM)return{oyb:!1,RBa:Va,dj:yb};var Ub=H.v(this.sa.Vc,this.$);Ub.LastColumn=Ub.FirstColumn+3-1;Ub.LastRow=Ub.FirstRow+4-1;var gb=H.D(Ub),Db=S.g(this.$);if(!gb.isValidRange||!Db.Ab.Owa(gb))return{oyb:!1,RBa:Va,dj:yb};M.AFrameworkApplication.p_("XLS-CreateTableInEmptyCell-Treatment;XLS-CreateTableInEmptyCell-Control");
if(!ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateTableInEmptyCell",!1))return{oyb:!1,RBa:Va,dj:yb};if(null==Ma){var Va=function(dc,bb,db){return ta.e(Kb.$.oa.xa,Ub,!1,!1,!1,dc,bb,db,Hb)};var yb=function(){return new N.a(!1,Ub)}}else{var qb=H.s(Ub);Va=function(dc,bb,db){return ta.g(Kb.$.oa.xa,qb,!1,!1,!1,Ma,dc,bb,db,Hb)};yb=function(){return new A(qb,!1,Ma,!0)}}return{oyb:!0,RBa:Va,dj:yb}};Object(u.a)(d,"TableCommandHandler",null,[403]);var fb=G.a;Rk(c,fb);c.prototype.dispose=
function(){fb.prototype.dispose.call(this)};c.prototype.zd=function(){var Ma=this,Hb=E.GetServiceTaskFactory.create(this.$.da,134,this.la,this.hb),Kb=E.GetServiceTaskFactory.create(this.$.da,330,this.la,this.hb),Ub=E.GetServiceTaskFactory.Ra(this.$.da,309,310,this.hb);I.TaskExtensions.Ba(Ia.Task.qL(Hb,Ub,Kb),function(){Ma.jd([new d(Ma.$,Hb.result,Ub.result,Kb.result)],[2128797448,341449783,1544516694,-544558380,-123538519,753331043,756677940])},this.$.la,3)};c.ka=function(Ma){G.a.Qd(86,new c(Ma))};
Object(u.a)(c,"TableCommandHandlerFactory",G.a,[]);b.d(D,"a",function(){return a})},1370:function(u,D,b){function a(){Type.registerNamespace("Common.App.NewAndOpen.Core");ia.a.instance.Ui(new c)}function c(){this.Vlb=this.Ide=this.fb=null;this.qm=!1}function d(wa,Qa,S,da,xa,ta,ab){this.cgb={};this.I1=wa;this.Wrg=Qa;this.Pqa=new k(C.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",5E3),C.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",
3),this.vw.Clc);this.sra=new k(C.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),C.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.vw.Clc);this.oug=S;this.Lie=da;this.Gyg={};this.aT=new l;this.Qog=xa;this.iUb="";this.zv=ta;this.Y4d=ab;this.pug=C.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.WordOnline.recentLinksCount",25);return this}function e(){this.mruItemId=this.app=this.documentExt=
this.documentName=this.folderName=this.documentUrl=null}function k(wa,Qa,S){this.task=null;this.Aec=wa;this.qzi=Qa;this.taskManager=S;this.retryCount=this.Txb=0;this.AOc=this.NAb=null}function l(){this._state=0;this.Kae=this.Mae=this.Lae=null;this.state=this.xhe=0;this.cKc=!1;return this}function m(wa,Qa,S,da,xa){this.Zpg=6E4;this.T8e="inactive";this.tje="active";this.YS=!0;this.de=wa;this.Uog=Qa;this.IIc=S;this.$Wb=da;this.$a=new ca.a;xa&&this.qEj();this.D9d=this.EZe()}function f(wa,Qa){this.cgb=
{};this.I1=wa;this.Xkb=new w(Qa,this.BCb.Clc,"GetMoreInfo");this.Eo=new z;return this}function w(wa,Qa,S){this.$Vb=this.Hi=null;this.tPc=0;this.wvg=wa;this.de=Qa;this.$3d=S}function n(wa,Qa,S,da,xa,ta,ab,Na){this.La=wa;this.Pg=Qa;this.tkg=S;this.d1=da;this.de=xa;this.IIc=ta;this.tpg=ab;this.NWb=Na}function z(){this._state=0;this.fRc=this.vkb=null;this.state=0;this.cKc=this.E7d=!1;return this}function r(){this._state=0}function v(){this.cgb={}}u=b(0);var A=b(83),B=b(615),y=b(15);v.prototype.pzg=function(wa){this.cgb[wa.id.toString()]=
wa};v.prototype.ODi=function(wa){var Qa=this.cgb,S;for(S in Qa)Qa[S].notify(wa,!1);this.cgb={}};v.prototype.q2i=function(wa,Qa){Qa&&this.pzg(Qa);return this.WAf(wa,Qa)};v.prototype.g7c=function(wa){this.ODi(wa)};v.prototype.aKe=function(wa,Qa){wa.notify(Qa,!0)};Object(u.a)(v,"AEventEmitter",null,[588]);var x;(function(wa){wa[wa.notStarted=0]="notStarted";wa[wa.waiting=1]="waiting";wa[wa.shouldRetry=2]="shouldRetry";wa[wa.complete=3]="complete"})(x||(x={}));Object(u.b)("EventResultState",x);Af.Object.defineProperties(r.prototype,
{state:{configurable:!0,enumerable:!0,get:function(){return this._state},set:function(wa){var Qa={};y.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",(Qa.OldState=x[this._state],Qa.NewState=x[wa],Qa),"ResultType",this.U0e());this._state=wa}}});Object(u.a)(r,"AEventResult",null,[717]);Rk(z,r);z.prototype.U0e=function(){return"GetMoreInfo Result"};Af.Object.defineProperties(z.prototype,{wR:{configurable:!0,enumerable:!0,get:function(){return this.vkb}},Sna:{configurable:!0,enumerable:!0,
get:function(){return this.fRc}},ici:{configurable:!0,enumerable:!0,get:function(){return this.E7d}}});Object(u.a)(z,"GetMoreInfoResult",r,[716,717]);var C=b(4),G=b(81),E=b(39),I=b(897),U=b(392),M=b(170),T=b(740),F=b(640),K=b(107),J=b(27);n.prototype.D7i=function(){this.I8a.Mb(J.a.openUrlInNewTab,K.a.frame,Object(A.a)(this,this.openUrlInNewTab,"openUrlInNewTab"));this.I8a.Mb(J.a.IOa,K.a.frame,Object(A.a)(this,this.IOa,"openDocumentUrl"));C.AFrameworkApplication.eQ?this.ylf():this.I8a.Ie(J.a.T6b,K.a.frame,
Object(A.a)(this,this.T6b,"documentLoaded"),96)};n.prototype.openUrlInNewTab=function(wa,Qa,S,da,xa){xa&&xa.MenuItemId&&(wa={},y.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",(wa.Id=xa.SourceControlId,wa.AppType=F.a[this.gca],wa)),E.a.Ze(xa.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32};n.prototype.IOa=function(wa,Qa,S,da,xa){if(xa&&xa.MenuItemId){var ta=C.AFrameworkApplication.fa.ra("WacInTabOpenMRUIsEnabledForUiHost"),ab=C.AFrameworkApplication.fa.ra("UiHostSupportsDocRebootFeatures");
y.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",ta,ab);if(ta&&ab){wa={};y.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",(wa.Id=xa.SourceControlId,wa.AppType=F.a[this.gca],wa));xa=xa.MenuItemId.toString();var Na={};Na[U.a.DPa]="1";Na[U.a.documentUrl]=xa;Na[U.a.reason]=T.a.open;y.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");C.AFrameworkApplication.eV().execute(function(Ka){Ka.xj(M.a.Fta,
Na)})}else this.openUrlInNewTab(wa,Qa,S,da,xa)}return 32};n.prototype.T6b=function(){this.ylf();return 32};n.prototype.Xba=function(wa,Qa,S){S=void 0===S?"":S;if(Qa&&Qa.bF){var da=I.a[Qa.status];Qa=Qa.bF.getTime();var xa=this.ew()-Qa,ta={};y.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",(ta.Caller=wa,ta.RequestStatus=da,ta.ElapsedMs=xa,ta.StartTime=Qa,ta.Notes=S,ta))}else S={},y.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",
(S.Caller=wa,S))};n.prototype.ylf=function(){var wa=C.AFrameworkApplication.fa.ra("QPGVCI"),Qa=G.a.cB(document.URL,"wdNewAndOpenCt",wa);if(Qa){Qa=parseInt(Qa);var S=G.a.cB(document.URL,"wdPreviousSession",wa);wa=G.a.cB(document.URL,"wdPreviousCorrelation",wa);var da=C.AFrameworkApplication.fa.ra("NAOPLP");if(C.AFrameworkApplication.eQ){var xa=C.AFrameworkApplication.eQ.getTime();if(!Qa||Qa>xa)da={},y.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",
(da.ClickTimestamp=Qa,da.DocumentLoadedTime=xa,da.SessionId=S,da.Correlation=wa,da));else{var ta={};y.ULS.sendTraceTag(5849683,202,da?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",(ta.ClickToLoadTime=xa-Qa,ta.ClickTimestamp=Qa,ta.SessionId=S,ta.Correlation=wa,ta))}}else xa={},y.ULS.sendTraceTag(5849681,202,da?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",(xa.ClickTimestamp=Qa,xa.SessionId=S,xa.Correlation=
wa,xa))}};n.yM=function(){return new n(new B.a(function(){return C.AFrameworkApplication.ub}),new B.a(function(){return C.AFrameworkApplication.qd}),new B.a(function(){return C.AFrameworkApplication.ta}),new B.a(function(){return C.AFrameworkApplication.ta.Pa.Fj}),new B.a(function(){return C.AFrameworkApplication.Bi}),function(){return(new Date).getTime()},new B.a(function(){return C.AFrameworkApplication.ta.Pa.QV}),new B.a(function(){return C.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage}))};
Af.Object.defineProperties(n.prototype,{I8a:{configurable:!0,enumerable:!0,get:function(){return this.La.value}},WCb:{configurable:!0,enumerable:!0,get:function(){return this.Pg.value}},Tqf:{configurable:!0,enumerable:!0,get:function(){return this.tkg.value}},gca:{configurable:!0,enumerable:!0,get:function(){return this.d1.value}},Clc:{configurable:!0,enumerable:!0,get:function(){return this.de.value}},ew:{configurable:!0,enumerable:!0,get:function(){return this.IIc}},QV:{configurable:!0,enumerable:!0,
get:function(){return this.tpg.value}},supportsGetMoreInfoForPersonalStorage:{configurable:!0,enumerable:!0,get:function(){return this.NWb.value}}});Af.Object.defineProperties(n,{instance:{configurable:!0,enumerable:!0,get:function(){return n.Ma||(n.Ma=n.yM())}}});n.Ma=null;Object(u.a)(n,"NewAndOpenCommonHelpers",null,[587]);var O=b(108);w.prototype.hIg=function(){this.tPc=this.Fbb+1};w.prototype.wKd=function(wa){this.Hi&&(this.de.Ip(this.Hi),this.Hi=null);wa&&(this.tPc=0)};w.prototype.yEj=function(wa){var Qa=
this.GJj;0<=Qa?(this.hIg(),this.wKd(!1),this.Hi=new O.a(4,1,Qa,wa,107),this.de.Eg(this.Hi)):(this.wKd(!0),wa={},y.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",(wa.Action=this.$3d,wa)))};Af.Object.defineProperties(w.prototype,{Fbb:{configurable:!0,enumerable:!0,get:function(){return this.tPc}},GJj:{configurable:!0,enumerable:!0,get:function(){return this.Fbb>=this.jXf.length?-1:this.jXf[this.Fbb]}},jXf:{configurable:!0,enumerable:!0,get:function(){if(!this.$Vb){var wa=(this.wvg.value||"0").split(",");
this.$Vb=[];for(var Qa=0;Qa<wa.length;Qa++){var S=parseInt(wa[Qa]);isNaN(S)?(S={},y.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",(S.Action=this.$3d,S.Entry=wa[Qa],S))):Array.add(this.$Vb,S)}}return this.$Vb}}});Object(u.a)(w,"RetryHelper",null,[]);var N=b(41),H=b(30);Rk(f,v);f.prototype.Nxi=function(){this.Qud("Document opened")};f.prototype.s7g=function(wa){var Qa=this;return function(){Qa.Qud(wa,!0)}};f.prototype.WAf=function(wa,Qa){Qa=void 0===Qa?null:Qa;
var S={};y.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",(S.Trigger=wa,S));3===this.Eo.state?(Qa&&this.aKe(Qa,this.Eo),Qa={},y.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",(Qa.Trigger=wa,Qa))):this.Qud(wa);return this.Eo};f.prototype.Qud=function(wa,Qa){this.Xkb.wKd(!(void 0===Qa?0:Qa));1===this.Eo.state?(Qa={},y.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",(Qa.Trigger=wa,Qa.RetryIndex=this.Xkb.Fbb,
Qa))):(Qa={},y.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",(Qa.Trigger=wa,Qa.RetryIndex=this.Xkb.Fbb,Qa)),this.Eo.state=1,Qa=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.BCb.QV,C.AFrameworkApplication.aj),this.BCb.WCb.z9(Qa,1,null,null,[f.Jce,f.Fge],!1,5,this.y6g(),this.x6g(wa),null))};f.prototype.y6g=function(){var wa=this;return function(Qa){var S=!1,da=!1,xa=!1;if(C.AFrameworkApplication.fa.ra("GetMoreInfoDataFromResponseBody"))if(Qa.data.Ud){var ta=N.d(Qa.data.Ud);
var ab=ta.Pt;ta.returnValue?ab?(xa=!0,wa.Eo.fRc=ab.StorageServiceDisplayName,wa.Eo.vkb=f.thf(ab.PersonalFileStorageUrl)?ab.PersonalFileStorageUrl:"",""===wa.Eo.wR&&"SharePointOnlineConsumer"===C.AFrameworkApplication.fa.Wa("FileSource")&&(wa.Eo.vkb=G.a.bda(C.AFrameworkApplication.breadcrumbFolderUrl)),S=""===wa.Eo.wR&&""!==wa.Eo.Sna):y.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):y.ULS.sendTraceTag(25298112,
202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers")}else y.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers");xa||((ab=Qa.data.responseHeaders)?(wa.Eo.fRc=(ab[f.Fge]||"").toString(),S=(ab[f.Jce]||"").toString(),wa.Eo.vkb=f.thf(S)?S:"",""===wa.Eo.wR&&"SharePointOnlineConsumer"===C.AFrameworkApplication.fa.Wa("FileSource")?(wa.Eo.vkb=G.a.bda(C.AFrameworkApplication.breadcrumbFolderUrl),
S=""===wa.Eo.wR&&""!==wa.Eo.Sna):S=""===S&&""!==wa.Eo.Sna):(y.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),da=!0));xa=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",wa.Xkb.Fbb,da,S,xa);wa.BCb.Xba("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",Qa.data,xa);wa.zXf(3,S,da)}};f.prototype.x6g=function(wa){var Qa=this;return function(S){Qa.BCb.Xba("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",
S.data,"Failure");Qa.zXf(2);Qa.Xkb.yEj(Qa.s7g(wa))}};f.prototype.zXf=function(wa,Qa,S){this.Eo.state=wa;this.Eo.E7d=void 0===Qa?!1:Qa;this.Eo.cKc=void 0===S?!1:S;this.g7c(this.Eo)};f.yM=function(){return new f(new B.a(function(){return n.instance}),new B.a(function(){return C.AFrameworkApplication.TRh}))};f.thf=function(wa){if(!wa)return y.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(H.a.rl(wa).startsWith("https://"))return!0;y.ULS.sendTraceTag(5849625,
202,10,"StorageUrl has invalid scheme.");return!1};Af.Object.defineProperties(f.prototype,{BCb:{configurable:!0,enumerable:!0,get:function(){return this.I1.value}}});Af.Object.defineProperties(f,{instance:{configurable:!0,enumerable:!0,get:function(){return f.Ma||(f.Ma=f.yM())}}});f.Jce="PersonalFileStorageUrl";f.Fge="StorageServiceDisplayName";f.Ma=null;Object(u.a)(f,"GetMoreInfoActor",v,[]);var Q=b(104),ca=b(97);m.prototype.FTc=function(wa){this.$a.addHandler(this.tje,wa)};m.prototype.JBg=function(wa){this.$a.addHandler(this.T8e,
wa)};m.prototype.qEj=function(){var wa=new O.a(5,2,this.Zpg,Object(A.a)(this,this.k8h,"inactiveLoop"),108);this.l8h.Eg(wa)};m.prototype.k8h=function(){var wa=this.EZe(),Qa=this.ew()-wa;if(Qa>this.Ozc&&this.YS){var S={};y.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",(S.TimeSinceLastActive=Qa,S));this.YS=!1;this.$a.raiseEvent(this.T8e)}wa-this.D9d>this.Ozc&&(this.YS=!0,this.$a.raiseEvent(this.tje));this.D9d=wa};m.yM=function(){return new m(new B.a(function(){return Q.a.instance}),function(){return C.AFrameworkApplication.njf.getTime()},
function(){return(new Date).getTime()},new B.a(function(){return C.AFrameworkApplication.Ozc}),!0)};Af.Object.defineProperties(m.prototype,{l8h:{configurable:!0,enumerable:!0,get:function(){return this.de.value}},EZe:{configurable:!0,enumerable:!0,get:function(){return this.Uog}},ew:{configurable:!0,enumerable:!0,get:function(){return this.IIc}},Ozc:{configurable:!0,enumerable:!0,get:function(){return this.$Wb.value}}});Af.Object.defineProperties(m,{instance:{configurable:!0,enumerable:!0,get:function(){return m.Ma||
(m.Ma=m.yM())}}});m.Ma=null;Object(u.a)(m,"InactivityManager",null,[]);var X=b(85),Z=b(1114);Rk(l,r);l.prototype.U0e=function(){return"MruActor Result"};Af.Object.defineProperties(l.prototype,{gwd:{configurable:!0,enumerable:!0,get:function(){return this.Lae}},gqf:{configurable:!0,enumerable:!0,get:function(){return this.Mae}},fwd:{configurable:!0,enumerable:!0,get:function(){return this.Kae}},LJj:{configurable:!0,enumerable:!0,get:function(){return this.xhe}}});Object(u.a)(l,"MruResult",r,[718,717]);
var ea=b(247);k.prototype.pki=function(wa,Qa){return wa===ea.a.Nad||20===Qa||18===Qa||3===Qa};k.prototype.Cli=function(wa){return 3===wa||5===wa||6===wa||7===wa||9===wa||10===wa||11===wa||12===wa||13===wa||14===wa||15===wa||16===wa||23===wa||26===wa||27===wa||28===wa};k.prototype.reset=function(){this.Txb=this.retryCount=0;this.AOc=this.NAb=null;this.task&&(this.taskManager.Ip(this.task),this.task=null)};k.prototype.kbi=function(wa,Qa,S,da){this.AOc=String.format("{0}_{1}",S,da);if(this.retryCount>=
this.qzi)return y.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.pki(S,da))return y.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.Cli(da)&&1<=this.Txb)return this.NAb=S,!1;Qa=Math.max(Qa,this.Aec*Math.pow(2,this.Txb));if(26===da)Qa=Math.max(Qa,3E4);else if(27===da||28===da)Qa=Math.max(Qa,6E4);9===da||412===S&&(null==this.NAb||412!==this.NAb)?Qa=500:this.Txb+=1;this.NAb=S;this.retryCount+=1;this.task&&this.taskManager.Ip(this.task);
y.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",Qa);this.task=new O.a(2,1,Qa,wa,107);this.taskManager.Eg(this.task);return!0};Af.Object.defineProperties(k.prototype,{qqc:{configurable:!0,enumerable:!0,get:function(){return this.AOc}}});Object(u.a)(k,"RetryManager",null,[]);var ka=b(99),Y=b(136),qa=b(167);Object(u.a)(e,"WriteOptions",null,[]);var fa=b(619),ha=b(190);Rk(d,v);d.prototype.o9i=function(){this.vw.I8a.Mb(J.a.renameMostRecentlyUsedFileEntry,K.a.frame,Object(A.a)(this,
this.hdj,"renameMruEntry"))};d.prototype.hdj=function(){return this.h_d("Rename")};d.prototype.Yxi=function(){this.gof("File Opened")};d.prototype.Zxi=function(){this.gof("IntervalUpdate")};d.prototype.gof=function(wa){var Qa={};y.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",(Qa.Trigger=wa,Qa));this.h_d(wa)};d.prototype.b4=function(wa){(wa=H.a.b4(wa))&&wa.startsWith(".")&&(wa=wa.substring(1,wa.length));return wa};d.prototype.VVe=function(){switch(this.vw.gca){case 3:return"Word";
case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}};d.prototype.c_h=function(wa){var Qa=this.Qog();if(!Qa)return null;var S=new e;S.documentUrl=this.Y4d.value?encodeURI(Qa):Qa;S.mruItemId=this.iUb;S.app=this.VVe();if(Qa=this.zv())S.folderName=Qa.breadcrumbFolderName,Qa=Qa.Qm,S.documentName=H.a.qq(Qa),S.documentExt=this.b4(Qa);wa&&(S.documentName?S.documentName.length?255<=S.documentName.length?wa.set("DocumentNameLength","Long"):2084<=
S.documentName.length&&wa.set("DocumentNameLength","VeryLong"):wa.set("DocumentNameLength","0"):wa.set("DocumentNameLength","Null"));return JSON.stringify(S)};d.prototype.h_d=function(wa,Qa){Qa=void 0===Qa?!1:Qa;if(4===this.vw.gca&&!C.AFrameworkApplication.Eta)return 2;var S=Y.a.Fr();S&&(S.set("Trigger",wa),S.set("IsRetry",Qa?"true":"false"),S.set("MruIdSent",this.iUb?"true":"false"),S.set("URLEncoded",this.Y4d.value?"true":"false"));ka.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",S);wa=
this.c_h(S);if(!wa)return Qa=!C.AFrameworkApplication.webEditingEnabled,S&&(S.set("WebEditingIsEnabled",C.AFrameworkApplication.webEditingEnabled?"true":"false"),S.set("ProtectedFile",C.AFrameworkApplication.Bqc?"true":"false")),ka.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",Qa,!1,Object.assign(new ha.a,{extendedProperties:S})),2;this.sra&&!Qa&&this.sra.reset();S=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.vw.QV,this.localeName);this.Lie?this.bDc["X-FileId"]=C.AFrameworkApplication.aj:
S+=String.format("&{0}",C.AFrameworkApplication.aj);C.AFrameworkApplication.Ob&&(this.bDc["X-Office-AudienceGroup"]=Object(X.a)(String,C.AFrameworkApplication.Ob.AudienceGroup)||"");this.bDc["X-Timeout"]=15E3;return this.vw.WCb.Yl(S,2,wa,this.bDc,!0,5,Object(A.a)(this,this.RXj,"writeMruV2EntryOnServerSuccessCallback"),Object(A.a)(this,this.$$g,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")};d.prototype.RXj=function(wa){this.Y4e(wa.data)};d.prototype.Y4e=function(wa){var Qa=
Y.a.Fr();this.sra&&(Qa&&this.sra.qqc&&(Qa.set("LastError",this.sra.qqc),Qa.set("NumRetries",this.sra.retryCount.toString())),this.sra.reset());var S=Z.c(wa.Ud);S&&S.diagnostics_data&&(this.iUb=S.diagnostics_data.mru_id);wa=+wa.Z2-+wa.bF;Qa&&Qa.set("RequestDuration",wa.toString());ka.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new ha.a,{extendedProperties:Qa}))};d.prototype.$$g=function(wa){if(wa.data.httpStatus===ea.a.mrb)this.Y4e(wa.data);else{var Qa=wa.data.httpStatus===ea.a.bGb,S=
Y.a.Fr();this.k5e(this.sra,wa,this.P$g(),S);S&&(S.set("StatusCode",wa.data.httpStatus.toString()),Qa||this.NTc(wa.data,S));ka.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",wa.data.httpStatus),Qa,!1,Object.assign(new ha.a,{extendedProperties:S}))}};d.prototype.P$g=function(){var wa=this;return function(){wa.h_d("Retry",!0)}};d.prototype.$Rh=function(){this.l8a("Polling")};d.prototype.ZRh=function(){this.l8a("Retry",!0)};d.prototype.Rxi=function(){this.l8a("Open")};d.prototype.Qxi=
function(){this.l8a("Activity")};d.prototype.Pxi=function(){this.l8a("OpenRecentLinks",!1,!0)};d.prototype.Oxi=function(){this.l8a("ActivityRecentLinks",!1,!0)};d.prototype.l8a=function(wa,Qa,S){Qa=void 0===Qa?!1:Qa;S=void 0===S?!1:S;var da={};y.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",(da.Trigger=wa,da));if(da=Y.a.Fr())da.set("Trigger",wa),da.set("IsRetry",Qa?"true":"false"),S&&da.set("RecentLinks","true");ka.Health.instance.recordKpiUsage("GetMru",0,"smartfio",da);this.Pqa&&!Qa&&
this.Pqa.reset();S?this.bDe(Object(A.a)(this,this.aSh,"getMruV2ForRecentLinksFromServerSuccessCallback"),Object(A.a)(this,this.XRh,"getMruForRecentLinksFromServerFailureCallback"),!0):this.bDe(Object(A.a)(this,this.bSh,"getMruV2FromServerSuccessCallback"),Object(A.a)(this,this.YRh,"getMruFromServerFailureCallback"))};d.prototype.NTc=function(wa,Qa){wa&&wa.responseHeaders&&(wa=wa.responseHeaders["X-CorrelationId"])&&Qa.set("ServerCorrelationId",wa)};d.prototype.Jui=function(wa,Qa){wa&&(Qa&&Qa.set("RequestDuration",
(+wa.Z2-+wa.bF).toString()),ka.Health.instance.recordKpiSuccess("GetMru",Object.assign(new ha.a,{extendedProperties:Qa})))};d.prototype.bSh=function(wa){this.f_e(wa)};d.prototype.f_e=function(wa,Qa){Qa=void 0===Qa?!1:Qa;var S="",da=null,xa=null,ta=null,ab=Z.c(wa.data.Ud);ab&&(da=ab.places?ab.places.items:[],xa=ab.documents?ab.documents.items:[],(ta=Z.a(ab,Qa))&&(S=N.c(ta)));C.AFrameworkApplication.ta&&C.AFrameworkApplication.ta.Pa.a_&&qa.c()&&!Qa&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(S,
!0));S=Y.a.Fr();this.Pqa&&(S&&this.Pqa.qqc&&(S.set("LastError",this.Pqa.qqc),S.set("NumRetries",this.Pqa.retryCount.toString())),this.Pqa.reset());Qa&&S&&S.set("RecentLinks","true");ta||da||xa?(Qa?this.vw.Xba("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",wa.data,"Success"):this.vw.Xba("MruActor.GetMruV2FromServerSuccessCallback",wa.data,"Success"),this.FBc(3,ta,da,xa),this.Jui(wa.data,S)):(Qa?this.vw.Xba("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",wa.data,"Failure: Invalid JSON"):
this.vw.Xba("MruActor.GetMruV2FromServerSuccessCallback",wa.data,"Failure: Invalid JSON"),S&&this.NTc(wa.data,S),ka.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new ha.a,{extendedProperties:S})),this.FBc(3,null,null,null,!0));this.g7c(this.aT)};d.prototype.aSh=function(wa){this.f_e(wa,!0)};d.prototype.k5e=function(wa,Qa,S,da){var xa=0,ta=0,ab=Z.c(Qa.data.Ud);ab&&(null!=ab.response_code&&(xa=ab.response_code,da&&da.set("MruResponseCode",xa.toString()),9===xa&&(this.iUb=
"")),ab.error_data&&null!=ab.error_data.retry_after_ms&&(ta=ab.error_data.retry_after_ms,da&&da.set("ExpectedRetryAfter",ta.toString())));wa&&(Qa=wa.kbi(S,ta,Qa.data.httpStatus,xa),da&&(da.set("CurrentRetryCount",wa.retryCount.toString()),da.set("RetryScheduled",Qa?"true":"false")))};d.prototype.YRh=function(wa){this.e_e(wa)};d.prototype.e_e=function(wa,Qa){Qa=void 0===Qa?!1:Qa;var S=wa.data.httpStatus===ea.a.bGb,da=Y.a.Fr();da&&(da.set("StatusCode",wa.data.httpStatus.toString()),Qa&&da.set("RecentLinks",
"true"),S||this.NTc(wa.data,da));Qa?this.vw.Xba("MruActor.GetMruForRecentLinksFromServerFailureCallback",wa.data,"Failure"):this.vw.Xba("MruActor.GetMruFromServerFailureCallback",wa.data,"Failure");this.FBc(2);this.k5e(this.Pqa,wa,Object(A.a)(this,this.ZRh,"getMruFromServerRetryTask"),da);ka.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",wa.data.httpStatus),S,!1,Object.assign(new ha.a,{extendedProperties:da}));this.g7c(this.aT);C.AFrameworkApplication.ta&&C.AFrameworkApplication.ta.Pa.a_&&
qa.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),Qa||appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)))};d.prototype.XRh=function(wa){this.e_e(wa,!0)};d.prototype.FBc=function(wa,Qa,S,da,xa){if(3!==this.aT.state||3===wa)this.aT.Lae=void 0===Qa?null:Qa,this.aT.Mae=void 0===S?null:S,this.aT.Kae=void 0===da?null:da,this.aT.state=wa,this.aT.cKc=void 0===xa?!1:xa,this.aT.xhe=this.vw.ew()};d.prototype.WAf=function(wa,Qa){var S={};y.ULS.sendTraceTag(6029918,
202,50,"MRU result requested {0}",(S.Trigger=wa,S.ResultState=this.aT.state,S));Qa&&3===this.aT.state&&this.aKe(Qa,this.aT);return this.aT};d.prototype.bDe=function(wa,Qa,S){S=void 0===S?!1:S;this.FBc(1);var da={};var xa=S?String.format(this.vw.QV+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",this.pug,"OfficeSuite",this.localeName,"ClassicMru"):String.format(this.vw.QV+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.VVe(),this.localeName);this.oug.value||
(xa+="&entity=docs");C.AFrameworkApplication.Ob&&(da["X-Office-AudienceGroup"]=Object(X.a)(String,C.AFrameworkApplication.Ob.AudienceGroup)||"");S&&(da["X-Office-Application"]="147");this.Lie?da["X-FileId"]=C.AFrameworkApplication.aj:xa+=String.format("&{0}",C.AFrameworkApplication.aj);this.vw.WCb.Yl(xa,1,null,da,!0,5,wa,Qa,null)};d.yM=function(){return new d(new B.a(function(){return n.instance}),new B.a(function(){return fa.a.cH(C.AFrameworkApplication.lcid).name}),new B.a(function(){return C.AFrameworkApplication.ta.Pa.Wu}),
C.AFrameworkApplication.fa.ra("MruWriteFileIdInHeader"),function(){return C.AFrameworkApplication.ta.Pa.vx},function(){return C.AFrameworkApplication.am},new B.a(function(){return C.AFrameworkApplication.fa.ra("OICEncodeUrlIsEnabled")}))};Af.Object.defineProperties(d.prototype,{bDc:{configurable:!0,enumerable:!0,get:function(){return this.Gyg}},vw:{configurable:!0,enumerable:!0,get:function(){return this.I1.value}},localeName:{configurable:!0,enumerable:!0,get:function(){return this.Wrg.value}}});
Af.Object.defineProperties(d,{instance:{configurable:!0,enumerable:!0,get:function(){return d.Ma||(d.Ma=d.yM())}}});d.Ma=null;Object(u.a)(d,"MruActor",v,[]);c.prototype.Sh=function(wa){this.fb=wa;wa.register(587,"Common.INewAndOpenCommonHelpers").tc().Cc(function(){return n.instance});wa.register(588,"Common.IEventEmitter<Common.IGetMoreInfoResult>").tc().Cc(function(){return f.instance});wa.register(588,"Common.IEventEmitter<Common.IMruResult>").tc().Cc(function(){return d.instance})};c.prototype.init=
function(){var wa=this;C.AFrameworkApplication.fa.Tu(function(){wa.Dxb()})};c.prototype.Dxb=function(){this.fb.resolve("Common.INewAndOpenCommonHelpers");this.fb.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.fb.resolve("Common.IEventEmitter<Common.IMruResult>");var wa=!1;n.instance.D7i();C.AFrameworkApplication.tla&&(wa=!0);C.AFrameworkApplication.sLf&&(d.instance.Rxi(),C.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&d.instance.Pxi(),
0<C.AFrameworkApplication.hqf&&this.Nke(),this.vuj(),wa=!0);C.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage&&wa&&f.instance.Nxi();C.AFrameworkApplication.fSj&&(wa=d.instance,wa.o9i(),wa.Yxi(),Q.a.instance.Eg(this.gSj))};c.prototype.vuj=function(){m.instance.FTc(Object(A.a)(d.instance,d.instance.Qxi,"makeGetMruRequestActivityTrigger"));C.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&m.instance.FTc(Object(A.a)(d.instance,d.instance.Oxi,
"makeGetMruForRecentLinksRequestActivityTrigger"));m.instance.FTc(Object(A.a)(this,this.Nke,"addGetMruFromServerTask"));m.instance.JBg(Object(A.a)(this,this.ddh,"deleteGetMruFromServerTask"))};c.prototype.ddh=function(){Q.a.instance.Ip(this.iqf)};c.prototype.Nke=function(){Q.a.instance.Eg(this.iqf)};c.prototype.dispose=function(){this.qm||(this.qm=!0,this.Vlb&&(Q.a.instance.Ip(this.Vlb),this.Vlb=null))};Af.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.NewAndOpen.Core"}},
iqf:{configurable:!0,enumerable:!0,get:function(){return this.Ide||(this.Ide=new O.a(5,2,C.AFrameworkApplication.hqf,Object(A.a)(d.instance,d.instance.$Rh,"getMruFromServerTask"),109))}},gSj:{configurable:!0,enumerable:!0,get:function(){return this.Vlb||(this.Vlb=new O.a(2,2,6E4*C.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(A.a)(d.instance,d.instance.Zxi,"makeUpdateMruTask"),197))}}});Object(u.a)(c,"CorePackageManager",null,[3,
4,10]);var ia=b(257);b.d(D,"a",function(){return a})},1373:function(u,D,b){function a(){va.a.Fa(c.ka)}function c(W){var La=ya.call(this)||this;La.$=W;La.Eb();return La}function d(){this.ZKd=B.AFrameworkApplication.tXj;this.szi=B.AFrameworkApplication.rXj;this.BO=B.AFrameworkApplication.k0h();this.priority=B.AFrameworkApplication.ZZd;this.iee=this.bsj();this.ESc=B.AFrameworkApplication.j0h()}function e(W,La,Ia,mb,fb,Ma,Hb){var Kb=this;mb=void 0===mb?null:mb;fb=void 0===fb?!1:fb;Ma=void 0===Ma?null:
Ma;Hb=void 0===Hb?!1:Hb;this.Tqa=0;this.iga=this.Hi=null;this.cXb=new ta.a;this.VS=new ta.a;this.Wl=null;this.ATb=!1;this.de=W;this.Yce=La;this.Yce.execute(function(Ub){Ub.Ml(ra.a.wjd,Object(C.a)(Kb,Kb.MMi,"onHostResponseReceived"))});this.i9=Ia;this.yhe=new na.a("WebServiceCall","TokenRefresh");this.Zi=mb||new k(W);this.uvg=fb;this.kT=Ma?Ma:la.SessionStatusManager.instance;this.X4d=Hb}function k(W){this.Do={};this.zX={};this.Jtg={};this.slf=15;this.j9d=!1;this.Bvg=new Date;this.GTb=new Date;this.de=
W;this.TWb=new Na.a(2,2,6E4*this.slf,Object(C.a)(this,this.sgg,"writeMeasures"),135,"SL",!1);this.de.Eg(this.TWb);this.kai()}function l(){}function m(W,La){var Ia=this;this.documentVisibilityObserver=null;this.Qa=new U.a;this.rx=null;this.Ddb=this.Pkb=!1;this.yrc=null;this.lHb=!1;this.Utd=!0;this.O9d=this.o9d=this.VG=this.Rlb=!1;this.JS=null;this.Z4e=function(){if(!Ia.N9b||Ia.N9b&&Ia.$.ea.dc)Ia.z5e(!1);else if(Ia.Utd){Ia.Utd=!1;var mb=H.a(Ia.$);x.ULS.sendTraceTag(537170709,0,50,"EwaAccessTokenExpirationRefreshManager.HandleOnTokenExpiring - session is not active - postponing refresh current-activity [{0}] TimeUntilTokenExpirationInMin [{1}]",
mb.ji?mb.ji.activityName:"None",Ia.W8f())}};this.Uc=function(mb,fb){Ia.context&&(mb=Ia.$.ea,fb.wH&&Ia.context.gHb&&!Ia.context.Zzc?(Ia.context.Zzc=!0,fb={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - reconnect"},fb.IsUserActive=mb.df.Tr,fb.RefreshAccessTokenCorrelationID=Ia.context.correlationID,fb=ka.a.xc(fb),x.ULS.sendTraceTag(537170708,0,50,fb)):Ia.N9b&&Ia.Pkb&&!mb.dc&&!Ia.context.W3c&&(fb={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - consider abort ongoing refresh due to reopen"},
Ia.rx&&(Ia.rx.cancel(),fb.Aborted=!0,wa.EwaSettings.isChangeGateEnabled("OfficeVSO:4877031_allowRefreshExpiringAfterAbort")&&(fb.ResetStopRefreshRetriesUntilTokenExpired=!0,Ia.Ddb=!1)),fb.TimeUntilTokenExpirationInMin=Ia.W8f(),fb.RefreshAccessTokenCorrelationID=Ia.context.correlationID,fb=ka.a.xc(fb),x.ULS.sendTraceTag(572019856,0,50,fb)))};this.tya=function(){if(Ia.context&&Ia.context.gHb&&!Ia.context.Zzc){var mb={Name:"EwaAccessTokenExpirationRefreshManager.OnOpenWorkbookFailed"};mb.CreatedForExpired=
Ia.context.W3c;mb.RefreshAccessTokenCorrelationID=Ia.context.correlationID;mb.OpenWorkbookErrors=M.a.Dc(Ia.$.ea.vF);mb.ExecutionContextErrors=M.a.Dc(H.a(Ia.$).fd.errors);mb.accesstokenTTL=B.AFrameworkApplication.mk;mb=ka.a.xc(mb);x.ULS.sendTraceTag(537170707,0,15,mb)}};this.y5e=function(){Ia.Ddb=!1;Ia.z5e(!0)};this.kBd=function(){Ia.lHb&&(Ia.$.ea.df.ZPa(Ia.kBd),Ia.lHb=!1);Ia.s5f()};this.$=W;this.uVd=La;this.UGd=W.Fb.Lg("WebServiceCall","refreshToken");this.N9b=wa.EwaSettings.isChangeGateEnabled("OfficeVSO:4874136_fixRaceOpenWorkbookRefreshExpiringToken");
E.a.instance.ZUc(this.y5e);E.a.instance.XUc(this.Z4e);La=this.$.ea;La.Wj(this.Uc);La.oZb(this.tya);this.uAi=this.$.ya.MinTokenLifetimeForRegularExpirationPromptInMin;this.L0f=this.$.ya.ShortAccessTokenExpirationPromptSeconds;this.FMf=this.$.ya.RefreshAccessTokenDurationLimitInSec;this.ydg(W.ea.JEf,B.AFrameworkApplication.mk);W=new Date;La={};x.ULS.sendTraceTag(537170714,217,50,"Initializing EwaAccessTokenExpirationRefreshManager. {0}",(La.AccessTokenTtl=B.AFrameworkApplication.mk,La.NowGetTime=W.getTime(),
La.BootTime=B.AFrameworkApplication.jha,La.WopiTokenExpiresAfterMinutes=B.AFrameworkApplication.XZd,La.WopiTokenTaskItemPriority=B.AFrameworkApplication.ZZd,La));this.$.da.Za(291,function(mb){Ia.documentVisibilityObserver=mb})}function f(W,La){this.cXb=W;this.VS=La}function w(){return n.apply(this,arguments)||this}function n(){}function z(){}function r(W,La){this.gHb=!1;this.correlationID=W;this.W3c=La;this.Zzc=!1;this.creationTime=ea.a.Ta.Jb}function v(W){var La=A.call(this)||this;La.Qa=new U.a;
La.Rlb=!1;La.VG=!1;La.$=W;return La}function A(){this.wfe=this.kQc=!1;var W=B.AFrameworkApplication.mk;if(!(0>=W)){this.mk=W;W=new Date;var La={};x.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",(La.AccessTokenTtl=this.mk,La.NowGetTime=W.getTime(),La.BootTime=B.AFrameworkApplication.jha,La));E.a.instance.ZUc(Object(C.a)(this,this.AOa,"onSessionExpiredDetected"));E.a.instance.XUc(Object(C.a)(this,this.OBf,"onSessionExpiringDetected"))}}u=b(0);var B=b(4),y=b(232),x=b(15),
C=b(83),G=b(52),E=b(200);A.prototype.AOa=function(){E.a.instance.VId(Object(C.a)(this,this.AOa,"onSessionExpiredDetected"));x.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.K3h()};A.prototype.OBf=function(){E.a.instance.UId(Object(C.a)(this,this.OBf,"onSessionExpiringDetected"));this.wfe||this.kQc||(x.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.wfe=!0,this.eBj())};A.prototype.K3h=function(){this.kQc||(B.AFrameworkApplication.JF(G.a.mvc),
this.kQc=!0,this.dBj())};Object(u.a)(A,"ASessionExpirationManager",null,[]);var I=b(90),U=b(38),M=b(29),T=b(14),F=b(42),K=b(260),J=b(6),O=b(82),N=b(263),H=b(67);Rk(v,A);v.prototype.jne=function(W){this.Qa.addHandler("SessionExpired",W)};v.prototype.mZb=function(W){this.Qa.addHandler("TokenRefreshed",W)};v.prototype.IId=function(W){this.Qa.removeHandler("TokenRefreshed",W)};v.prototype.ldc=function(){return E.a.instance.aR(B.AFrameworkApplication.mk)};v.prototype.dispose=function(){I.a.Ia(this.Qa);
this.$=null};v.prototype.eBj=function(){this.$.isEditMode&&this.Kcc(!1)};v.prototype.dBj=function(){this.Rlb=!0;this.Kcc(!0);this.Qa.raiseEvent("SessionExpired")};v.prototype.Kcc=function(W){var La=this;x.ULS.sendTraceTag(537170715,0,15,"EwaAccessTokenExpirationManager.HandleAccessTokenExpirationDialog: isExpired {0}, GotDeploymentOrTimedOutError {1}",W,this.$.ea.Raa);var Ia=this.$.ob.Hp;W&&Ia&&Ia.isVisible&&1299163859===Ia.error.MessageId&&this.$.ob.Hp.Mt();var mb=this.Wc(W);F.a(this.$).ft(new K.a(J.a.fz,
5,function(){var fb=H.a(La.$),Ma=fb.fd.activityState;Ma[O.a.f2]=La.$.Sob(La.$.isEditMode);Ma[O.a.OL]=O.a.G8a;Ma[N.a.Rq]=J.a.accessTokenExpiringWarning;fb.fd.Bt([mb])}))};v.prototype.Wc=function(W){return W?M.a.cEe():this.L9g()};v.prototype.L9g=function(){var W=M.a.Wc(12,1,0,0,0,1299163859,"AccessTokenExpiringWarning");W.Description=this.accessTokenExpiringMessage;return W};Af.Object.defineProperties(v.prototype,{accessTokenExpiringMessage:{configurable:!0,enumerable:!0,get:function(){var W=(new Date(this.mk)).format(this.$.ya.ShortTimeFormat);
return String.format(T.a.instance.lb(78),W)}},tokenExpired:{configurable:!0,enumerable:!0,get:function(){return this.Rlb}},Rcb:{configurable:!0,enumerable:!0,get:function(){return!1}},Gba:{configurable:!0,enumerable:!0,get:function(){return!1}},WGd:{configurable:!0,enumerable:!0,get:function(){return!1}},r5:{configurable:!0,enumerable:!0,get:function(){return!1}}});Object(u.a)(v,"EwaAccessTokenExpirationManager",A,[651,290,10]);var Q=b(7),ca=b(178),X=b(81),Z=b(738),ea=b(28);Object(u.a)(r,"RefreshAccessTokenContext",
null,[]);var ka=b(54),Y=b(61),qa=b(179),fa=b(44),ha=b(111),ia=b(119),wa=b(1),Qa=b(22),S=b(147),da=b(35),xa=b(116);Object(u.a)(z,"Error",null,[]);Object(u.a)(n,"NamedResult",null,[]);Rk(w,n);Object(u.a)(w,"ErrorInfo",n,[]);Af.Object.defineProperties(f.prototype,{BO:{configurable:!0,enumerable:!0,get:function(){return this.cXb}},errors:{configurable:!0,enumerable:!0,get:function(){return this.VS}}});Object(u.a)(f,"TokenRefreshArgs",null,[668]);m.prototype.jne=function(W){this.Qa.addHandler("SessionExpired",
W)};m.prototype.mZb=function(W){this.Qa.addHandler("TokenRefreshed",W)};m.prototype.IId=function(W){this.Qa.removeHandler("TokenRefreshed",W)};m.prototype.ldc=function(){return E.a.instance.aR(B.AFrameworkApplication.mk)};m.prototype.dispose=function(){E.a.instance.VId(this.y5e);E.a.instance.UId(this.Z4e);var W=this.$.ea;W&&(W.xk(this.Uc),W.Fsc(this.tya));I.a.Ia(this.Qa);this.documentVisibilityObserver=this.$=null};m.prototype.W8f=function(){return this.ldc()?0:(B.AFrameworkApplication.mk-(new Date).getTime())/
6E4};m.prototype.ydg=function(W,La){if(0<La&&!this.ldc()){var Ia=B.AFrameworkApplication.fa.kd("AccessTokenExpirationPromptSeconds",B.AFrameworkApplication.cY),mb=(La-W.getTime())/6E4;x.ULS.shipAssertTag(537170713,0,0<=mb,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime the access-token expiration time should be after token creation time accessTokenTTL [{0}] creationTime [{1}] tokenLifetimeInMin [{2}]",La,W.getTime(),mb);mb<this.uAi?(x.ULS.sendTraceTag(537170712,0,15,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [{0}] tokenLifetimeInMin [{1}]",
this.L0f,mb),B.AFrameworkApplication.cY=this.L0f):B.AFrameworkApplication.cY!==Ia&&(x.ULS.sendTraceTag(537170711,0,15,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [{0}] tokenLifetimeInMin [{1}]",Ia,mb),B.AFrameworkApplication.cY=Ia)}};m.prototype.g4g=function(W){return!this.context||this.context.gHb||this.context.W3c!==W?(W=new r(ca.a.create().toString(),W),this.context&&!this.context.Zzc&&x.ULS.sendTraceTag(537170710,0,15,"TokenManager.InitContext: creating new context [{0}] although previeous one [{1}] not used successfully, isPreviousOneRefreshedSuccessfully [{2}] ",
W.correlationID,this.context.correlationID,this.context.gHb),this.JS=W,!0):!1};m.prototype.Lfj=function(W){W&&this.VG&&!this.Gba&&this.$.ea.df.Tr&&!this.r5&&(this.VG=!1)};m.prototype.z5e=function(W){var La=this;this.Lfj(W);if(!(this.Pkb||this.Ddb&&!W||this.VG)&&this.Rcb){this.Pkb=!0;var Ia=this.context?this.context.creationTime:null,mb=this.g4g(W);this.Utd=!0;var fb=this.$.ea,Ma={Name:"EwaAccessTokenExpirationRefreshManager.HandleTokenRefresh",newContextCreated:mb};Ma.IsUserActive=fb.df.Tr;Ma.IsSessionActive=
fb.dc;Ma.ContainsChangesWorkbookOperations=this.$.userOperationManager.hHa();Ma.isSessionExpired=W;Ma.stopRefreshRetriesUntilTokenExpired=this.Ddb;Ma.FailedToRefreshExpiredToken=this.VG;Ma.numOfFailuresWhileUserIsActive=xa.a.S5;Ma.numOfFailuresWhileUserIsInActive=xa.a.T5;Ma.numOfFailuresWhileOffline=xa.a.Zxa;Ma.RefreshAccessTokenCorrelationID=this.context.correlationID;mb&&Ia&&(Ma.TimeInMinFromPreviosContextCreation=Math.round(ia.b(ea.a.Ta,Ia)/60));Ia=ka.a.xc(Ma);x.ULS.sendTraceTag(40416199,0,50,
Ia);this.UGd.start();this.o9d=fb.df.Tr;this.rx=new Z.a;this.bsi(W);var Hb=this.uVd.n7i(!W,this.rx?this.rx.token:null);Hb.continueWith(function(){La.PXg();var Kb=La.uVd.B1i(Hb);La.UGd.stop();var Ub=La.ldc();if(!Kb||wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5348973_FishbowlFixDuringTokenRefresh")&&Ub){var gb=Hb.result.errors;Kb&&Ub&&La.RAg(gb);La.r3h(gb,W)}else La.Ddb=!1,La.t3h(Hb.result.BO,W);La.Pkb=!1},this.N9b?8:0)}};m.prototype.RAg=function(W){var La=[Object(Q.a)(new z,{Id:"200",Details:"Expired accesstoken recieved on successful token request."})];
W.add(Object(Q.a)(new w,{Name:"ExpiredTokenAfterSuccessfulRefresh",Errors:La}))};m.prototype.bsi=function(W){W&&(this.$.ea.df.Tr?this.s5f():(this.$.ea.df.Gra(this.kBd),this.lHb=!0))};m.prototype.s5f=function(){var W=this;this.yrc=qa.AsyncMethodContext.Ps(function(){W.m7i()},1E3*this.FMf,fa.a.T6i,this.yrc)};m.prototype.PXg=function(){this.yrc&&this.yrc.cancel();this.lHb&&(this.$.ea.df.ZPa(this.kBd),this.lHb=!1);this.rx=null};m.prototype.m7i=function(){x.ULS.sendTraceTag(537170706,0,15,"EwaAccessTokenExpirationRefreshManager.RefreshTokenDurationThresholdReached durationLimitInSec [{0}]",
this.FMf);this.rx.cancel()};m.prototype.r3h=function(W,La){this.Ddb=!0;La&&(this.VG||(this.Rlb=this.VG=!0),this.uVd.chc(W)&&(this.O9d=!0));var Ia=!La||this.Rcb&&!xa.a.Vwc?40380379:39982555;La=this.GCe(La);La.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshError";La.FailedToRefreshExpiredToken=this.VG;La.LastErrorIsPermanent=this.r5;if(0<W.count){var mb=W.na(0);La.errorName=mb.Name;0<mb.Errors.length&&(La.ErrorId=mb.Errors[0].Id,mb=mb.Errors[0].Details,La.ErrorDetails=this.khh(mb.toString())?
"PiiScrubbed":mb)}La=ka.a.xc(La);x.ULS.sendTraceTag(Ia,0,15,La);this.Qa.raiseEvent("TokenRefreshed",new f(null,W))};m.prototype.khh=function(W){return Qa.a.contains(W,"makes the internet safe for businesses",!0)};m.prototype.GCe=function(W){var La={},Ia=this.$.ea;La.Name="";La.IsUserActive=Ia.df.Tr;La.IsSessionActive=Ia.dc;La.GotDeploymentOrTimedOutError=Ia.Raa;La.TimeInSecFromLastStatefulSuccessfulRequest=Ia.G7;La.TimeFromLastUserActivityInMs=Ia.df.UMb;La.calledFromSessionExpiredFlow=W;La.RefreshTokenDurationInMS=
this.UGd.qc;La.numOfFailuresWhileUserIsActive=xa.a.S5;La.numOfFailuresWhileUserIsInActive=xa.a.T5;La.numOfFailuresWhileOffline=xa.a.Zxa;La.RefreshAccessTokenCorrelationID=this.context.correlationID;La.accessTokenTTL=B.AFrameworkApplication.mk;La.ContainsChangesWorkbookOperations=this.$.userOperationManager.hHa();La.IsDocumentHidden=this.documentVisibilityObserver?this.documentVisibilityObserver.Qi.toString():"Unknown";La.TimeFromFirstOpenInHr=Math.floor(ia.b(ea.a.Ta,ha.toUtc(Ia.JEf))/3600);return La};
m.prototype.t3h=function(W,La){this.VG=!1;this.JTj();this.ydg(new Date,B.AFrameworkApplication.mk);var Ia=this.$.ea,mb=!La&&Ia.df.Tr,fb=!this.$.isEditMode&&Ia.vab;La=this.GCe(La);La.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess";La.shouldTriggerSilentReloadAfterExpiring=mb;La.WopiTokenTaskItemPriority=B.AFrameworkApplication.ZZd;La.isDirtyViewSession=fb;La=ka.a.xc(La);x.ULS.sendTraceTag(39982556,0,15,La);this.Qa.raiseEvent("TokenRefreshed",new f(W,null));fb?Ia.df.Tr&&(x.ULS.sendTraceTag(537170705,
0,15,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: User active after refresh dirty view session. trigger request to connect the same server."),Ia.Sad()):Ia.df.Tr?mb&&(W=H.a(this.$).fd.activityState,W[xa.a.teb]=!0,W[S.a.gY]=!0,W[da.a.Cs]=this.$.isEditMode,F.a(this.$).ft(new K.a(J.a.hna,2,null))):Ia.dc&&Y.j(this.$.oa.xa,!0,!1,!1,null,null,null,null,null)};m.prototype.JTj=function(){void 0!==this.$.ea.workbookContext.WorkbookUri&&null!==this.$.ea.workbookContext.WorkbookUri?(this.$.ea.workbookContext.WorkbookUri=
X.a.uT(this.$.ea.workbookContext.WorkbookUri,B.AFrameworkApplication.oP,B.AFrameworkApplication.accessToken),this.$.ea.workbookContext.WorkbookUri=X.a.uT(this.$.ea.workbookContext.WorkbookUri,B.AFrameworkApplication.dY,B.AFrameworkApplication.mk.toString()),this.$.ea.Doc()):x.ULS.sendTraceTag(537170704,0,15,"EwaAccessTokenExpirationRefreshManager.UpdateTokensAtContext: WorkbookUri is null");this.$.ya.AccessToken=B.AFrameworkApplication.accessToken;this.$.ya.AccessTokenValidTo=B.AFrameworkApplication.mk;
void 0!==this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion&&null!==this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion&&(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion=X.a.uT(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion,B.AFrameworkApplication.oP,B.AFrameworkApplication.accessToken),this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion=X.a.uT(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion,B.AFrameworkApplication.dY,B.AFrameworkApplication.mk.toString()));void 0!==
this.$.ya.EmbedConfiguratorUrl&&null!==this.$.ya.EmbedConfiguratorUrl&&(this.$.ya.EmbedConfiguratorUrl=X.a.uT(this.$.ya.EmbedConfiguratorUrl,B.AFrameworkApplication.oP,B.AFrameworkApplication.accessToken),this.$.ya.EmbedConfiguratorUrl=X.a.uT(this.$.ya.EmbedConfiguratorUrl,B.AFrameworkApplication.dY,B.AFrameworkApplication.mk.toString()));this.context.gHb=!0};Af.Object.defineProperties(m.prototype,{tokenExpired:{configurable:!0,enumerable:!0,get:function(){return this.Rlb}},Gba:{configurable:!0,enumerable:!0,
get:function(){return this.o9d}},r5:{configurable:!0,enumerable:!0,get:function(){return this.O9d}},context:{configurable:!0,enumerable:!0,get:function(){return this.JS}},Rcb:{configurable:!0,enumerable:!0,get:function(){return this.r5?!1:this.$.ea.df.Tr?1>xa.a.S5:6>xa.a.T5}},WGd:{configurable:!0,enumerable:!0,get:function(){return this.Pkb}}});Object(u.a)(m,"EwaAccessTokenExpirationRefreshManager",null,[651,290,10]);var ta=b(202),ab=b(162);l.gYb="ActivityDuration";l.error="Error";l.Mlh="Errors";
l.failed="Failed";l.cBh="FirstActivity";l.initialized="Initialized";l.kqi="LastActivity";l.xhj="RetryOverride";l.jfj="RequestGroups";l.requests="Requests";l.TSf="Responses";l.nvc="SessionDuration";l.status="Status";l.success="Success";l.Una="Successful";l.BO="Tokens";Object(u.a)(l,"SessionExpirationStrings",null,[]);var Na=b(108);k.prototype.sgg=function(){var W={};x.ULS.sendTraceTag(41964821,217,50,x.ULS.xc((W.Aggregate=this.zX,W.Current=this.Do,W)))};k.prototype.kai=function(){this.zX[l.jfj]=0;
this.zX[l.requests]=0;this.zX[l.TSf]=0;this.zX[l.status]=l.initialized;this.zX[l.cBh]=new Date;this.zX[l.nvc]=0;this.zX[l.gYb]=0;this.zX[l.nvc]=0;this.Do[l.nvc]=0;this.zX[l.gYb]=0;this.Do[l.gYb]=0};k.prototype.rkd=function(W,La){var Ia=W[La];Ia=Ia?Ia:0;Ia++;W[La]=Ia;this.gOd(W)};k.prototype.gOd=function(W){var La=new Date;W[l.gYb]=+La-+this.GTb;this.GTb=La;W[l.nvc]=+this.GTb-+this.Bvg;W[l.kqi]=this.GTb};k.prototype.wcb=function(W,La){this.Do[W]=La;this.gOd(this.Do)};k.prototype.hYf=function(W,La){this.Do[W]=
La;this.gOd(this.Do)};k.prototype.incrementCounter=function(W){this.rkd(this.Do,W);this.rkd(this.zX,W);this.rkd(this.Jtg,W)};k.prototype.flush=function(){this.j9d||(this.zX[l.status]=this.Do[l.status],this.sgg(this.TWb),this.de.Qma(this.TWb,6E4*this.slf))};k.prototype.stop=function(){x.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.j9d=!0;this.de.Ip(this.TWb)};Object(u.a)(k,"SessionLogger",null,[670]);var Ka=b(99),la=b(739),Ea=b(392),ra=b(170),na=b(1148),
ba=b(190),sa=b(172);e.prototype.MMi=function(W){if(W.MessageId!==ra.a.wjd)sa.a(39408099,306,15,"Unexpected message.");else{var La=new ta.a,Ia=new ta.a;this.Zi.incrementCounter(l.TSf);var mb=W.Values[Ea.a.pXf];if(!mb||0>=mb.length)sa.a(40122317,306,15,"Found no tokens in the dictionary"),mb=W.Values;sa.a(40122318,306,100,"The Tokens array contains {0} tokens",mb.length);this.Zi.wcb("Correlation",W.CorrelationId);for(var fb="",Ma=0;Ma<mb.length;Ma++){this.Zi.hYf(l.BO,mb.length);var Hb=mb[Ma],Kb=Hb;
if(Kb&&Kb.Name){this.Zi.incrementCounter(Kb.Name);var Ub=Hb;if(Ub&&Ub.Value)sa.a(39408128,306,100,"Received token with name: {0}",Ub.Name),La.add(Ub),this.cXb.add(Ub),this.Zi.wcb(l.status,l.success),this.X4d&&this.kT&&this.kT.jgj();else if(Hb=this.uWh(Hb),sa.a(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",Kb.Name,JSON.stringify(Hb),this.iga),Ia.add(Hb),this.VS.add(Hb),fb=JSON.stringify(Hb),this.Zi.wcb(l.error,JSON.stringify(Hb)),this.Zi.wcb(l.status,l.failed),
this.X4d)for(Kb=ak(Hb.Errors),Hb=Kb.next();!Hb.done;Hb=Kb.next())Hb=this.wNh(Hb.value),this.kT&&this.kT.hDg(Hb)}}0<Ia.count&&""!==fb?(mb=Object.assign(new ba.a,{extendedProperties:new Map}),mb.extendedProperties.set("Errors",fb),Ka.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,mb)):Ka.Health.instance.recordKpiSuccess("WACTokenRefresh",null);sa.a(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",La.count,Ia.count,
W.CorrelationId,this.iga);0<Ia.count&&!this.chc(Ia)?(W=this.i9.PVh(Ia),W!==this.i9.ZKd&&(this.Zi.hYf(l.xhj,W),this.de.Qma(this.Hi,W))):(this.Zi.flush(),this.Hi&&(sa.a(39408131,306,100,"Deleting task {0} from task manager",this.Hi.name),this.de.Ip(this.Hi)),this.Wl&&!this.Wl.task.isCompleted&&this.Wl.setResult(new f(La,Ia)))}};e.prototype.uWh=function(W){if(!W)return null;var La=Object.assign(new w,{Name:W.Name,Errors:[]});W=ak(W.Errors);for(var Ia=W.next();!Ia.done;Ia=W.next()){Ia=Ia.value;var mb=
new z;mb.Id=Ia.Id;mb.Details=this.tWh(Ia.Details);La.Errors.push(mb)}return La};e.prototype.tWh=function(W){if(!W)return"";var La=W.toString().toLowerCase();return 0<La.indexOf("<!doctype")?this.qfd("Seems to contain HTML - Contains <!DOCTYPE"):0<La.indexOf("<html")?this.qfd("Seems to contain HTML - Contains <html>"):500<La.length?this.qfd(String.format("Error details content too long: Length: {0}",La.length)):W};e.prototype.qfd=function(W){return String.format("{0} - Reason: [{1}]","### REDACTED ###",
W)};e.prototype.requestTokensOnce=function(){this.bSf()};e.prototype.bSf=function(){B.AFrameworkApplication.Yjc("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.Tqa>=this.i9.szi?(sa.a(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.iga),this.MCe(this.Wl,"TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts")):(Ka.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.jmj())};
e.prototype.jmj=function(){var W={};W[Ea.a.pXf]=this.i9.BO;var La=ca.a.create().toString();sa.a(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.i9.BO),this.Tqa+1,La,this.iga);this.Yce.execute(function(Ia){Ia.xj(ra.a.ype,W,La)});this.Tqa++;this.Zi.incrementCounter(l.requests)};e.prototype.MCe=function(W,La,Ia){for(var mb=new ta.a,fb=0;fb<this.i9.BO.length;fb++){var Ma=Object.assign(new w,{Name:this.i9.BO[fb],Errors:[Object.assign(new z,{Id:La,
Details:Ia})]});mb.add(Ma);this.VS.add(Ma)}this.de.Ip(this.Hi);this.Zi.wcb(l.Mlh,JSON.stringify(this.VS));this.Zi.wcb(l.status,l.failed);W&&!W.task.isCompleted&&W.setResult(new f(new ta.a,this.VS))};e.prototype.n7i=function(W,La){var Ia=this;La=void 0===La?null:La;this.yhe.start();this.ATb=W;this.iga=ca.a.create().toString();sa.a(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.iga,this.ATb);this.Tqa=0;this.VS.clear();this.cXb.clear();var mb=new ab.a;this.Wl=mb;La&&
La.R(function(){var fb=!!mb&&!mb.task.isCompleted;sa.a(588096223,306,50,"RefreshTokens Cancelled, TaskId: [{0}]. IsTokenExpiring: [{1}]. isTaskStillRunning [{2}].",Ia.iga,Ia.ATb,fb);fb&&Ia.MCe(mb,"ABORTED_BY_CALLER","The refresh was aborted by the caller")});this.Hi=new Na.a(this.i9.priority,2,this.i9.ZKd,Object(C.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,ra.a.ype,!0);this.uvg&&this.bSf();this.de.Eg(this.Hi);return this.Wl.task};e.prototype.B1i=function(W){this.yhe.stop();var La=this.C4h(W.result.errors);
x.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",!La,this.iga,this.ATb,this.Tqa,this.VS.count,0<W.result.errors.count?W.result.errors.na(0).Name:"",0<W.result.errors.count&&0<W.result.errors.na(0).Errors.length?W.result.errors.na(0).Errors[0].Id:"",0<W.result.errors.count&&0<W.result.errors.na(0).Errors.length?W.result.errors.na(0).Errors[0].Details:
"");return La?!1:this.A1i(W.result.BO)};e.prototype.chc=function(W){return this.i9.chc(W)};e.prototype.A1i=function(W){for(var La=0;La<W.count;La++){var Ia=W.na(La);if(Ia.Name===Ea.a.accessToken){var mb=(new Date).getTime();if(Ia.Expiry>B.AFrameworkApplication.mk){var fb={};x.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",(fb.AccessTokenTtl=Ia.Expiry,fb.NowGetTime=mb,fb.BootTime=B.AFrameworkApplication.jha,fb),"PreviousAccessTokenTtl",B.AFrameworkApplication.mk);B.AFrameworkApplication.accessToken=
Ia.Value;B.AFrameworkApplication.mk=Math.floor(Ia.Expiry);B.AFrameworkApplication.YZd=mb;B.AFrameworkApplication.NXa=Math.floor(Ia.Expiry)}else fb={},x.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",(fb.AccessTokenTtl=Ia.Expiry,fb.NowGetTime=mb,fb.BootTime=B.AFrameworkApplication.jha,fb),"PreviousAccessTokenTtl",B.AFrameworkApplication.mk)}}return!0};e.prototype.C4h=function(W){for(var La=!1,Ia=0;Ia<W.count;Ia++){La=!0;var mb=W.na(Ia);x.ULS.sendTraceTag(39706829,
217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",mb.Name,JSON.stringify(mb.Errors),this.iga)}return La};e.prototype.wNh=function(W){var La=G.a.mvc;W=parseInt(W.Id);if(isNaN(W))La=G.a.nXj;else{switch(W){case 401:La=G.a.qXj;break;case 403:La=G.a.lXj;break;case 500:La=G.a.mXj;break;case 503:La=G.a.pXj}La===G.a.mvc&&(La=500<W?G.a.oXj:G.a.kXj)}return La};Object(u.a)(e,"TokenRefreshManager",null,[650]);d.prototype.chc=function(W){W=JSON.stringify(W);if(this.ESc&&0<this.ESc.length)for(var La=
ak(this.ESc),Ia=La.next();!Ia.done;Ia=La.next())if(Ia=Ia.value,0<Ia.length&&0<=W.indexOf(Ia))return!0;return!1};d.prototype.PVh=function(W){try{if(W)for(var La=ak(W),Ia=La.next();!Ia.done;Ia=La.next()){var mb=Ia.value;if(mb.Errors)for(var fb=ak(mb.Errors),Ma=fb.next();!Ma.done;Ma=fb.next()){var Hb=Ma.value;if(Hb.Id in this.iee)return Number.parseInvariant(this.iee[Hb.Id].toString())}}}catch(Kb){x.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",Kb.toString())}return this.ZKd};
d.prototype.bsj=function(){var W={};try{if(!B.AFrameworkApplication.ucc()||0>=B.AFrameworkApplication.ucc().length||""===B.AFrameworkApplication.ucc()[0])return W;for(var La=ak(B.AFrameworkApplication.ucc()),Ia=La.next();!Ia.done;Ia=La.next()){var mb=Ia.value;0<mb.length&&(W[mb]=B.AFrameworkApplication.sXj)}}catch(fb){x.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",fb.toString())}return W};Object(u.a)(d,"TokenRefreshPolicy",null,[641]);var ya=
y.a;Rk(c,ya);c.prototype.create=function(){B.AFrameworkApplication.cN("Microsoft.Office.Excel.Server.Flighting.IDenyListRefreshAccessTokenSilentlyV2_ManagerCreated");B.AFrameworkApplication.fa.ra("RefreshAccessTokenSilently")?this.pb(this.a6g()):this.pb(this.$.da.za(38)||this.$.da.Ga(38,new v(this.$)))};c.prototype.a6g=function(){var W=this.$.da.za(38);if(W)return W;W=new e(B.AFrameworkApplication.Bi,B.AFrameworkApplication.eV(),new d);return this.$.da.Ga(38,new m(this.$,W))};c.ka=function(W){W.da.Ga(39,
new c(W))};Object(u.a)(c,"AccessTokenExpirationManagerFactory",y.a,[]);var va=b(11);b.d(D,"a",function(){return a})},1405:function(u,D,b){function a(){Type.registerNamespace("Common.App.AccessibilitySettings");c.main()}function c(){this.fb=null}function d(){this.LVa=null}function e(C){return String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",A.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"",C,A.AFrameworkApplication.aj)}function k(C){var G=new v.a;A.AFrameworkApplication.qd.Yl(e(C),
1,null,null,!0,2,function(E){200===E.data.httpStatus?G.setResult("true"===E.data.Ud.toLowerCase()):G.setResult(!1)},function(){G.setResult(!1)},null,void 0,void 0,void 0,void 0,"7");return G.task}function l(C,G){this.La=C;this.TPb=G}function m(C){var G=n.call(this,!1,!1,!0)||this;G.TPb=C;return G}u=b(0);var f=b(83),w=b(150),n=w.a;Rk(m,n);m.prototype.start=function(){var C={},G={};C=(G.id="AccessibilitySettingsDialog",G.bodyControls=(C.tooltipPersistenceEnabled=this.TPb.b8e,C),G);this.initializeAndShow("",
Object(f.a)(this,this.ihj,"resultHandler"),C)};m.prototype.ihj=function(C,G){1===C&&(this.TPb.b8e=G.tooltipPersistenceEnabled)};Object(u.a)(m,"AccessibilitySettingsDialog",w.a,[]);var z=b(107),r=b(27);l.prototype.Cg=function(){this.La.Mb(r.a.Byj,z.a.frame,Object(f.a)(this,this.Cyj,"showAccessibilitySettingsDialogHandler"))};l.prototype.Cyj=function(){(new m(this.TPb)).start();return 32};Object(u.a)(l,"AccessibilitySettingsDialogActor",null,[598]);var v=b(162),A=b(4),B=b(167);d.prototype.Gsi=function(){var C=
this,G=new v.a;if(this.LVa)G.setResult(this.LVa);else if(this.Iff()){var E=k("getHoverableRibbonTooltipIsEnabled");E.continueWith(function(){C.LVa=E.result;B.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(E.result);G.setResult(E.result)},8)}else G.setResult(!1)};d.prototype.Iff=function(){var C=A.AFrameworkApplication.fa.ra("IsRoamingServiceEnabled"),G=A.AFrameworkApplication.fa.ra("IsAnonymousUser");return C&&!G};Af.Object.defineProperties(d.prototype,{b8e:{configurable:!0,
enumerable:!0,get:function(){return!!this.LVa},set:function(C){C!==this.LVa&&(this.LVa=C,B.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(C),this.Iff()&&A.AFrameworkApplication.qd.Yl(e("saveHoverableRibbonTooltipIsEnabled"),2,C.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}}});Object(u.a)(d,"AccessibilitySettingsInfo",null,[597]);var y=b(257),x=b(172);c.prototype.Sh=function(C){var G=this;this.fb=C;this.fb.register(d,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Cc(function(){return new d}).tc();
this.fb.register(l,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Cc(function(){return new l(A.AFrameworkApplication.ub,G.fb.nh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))}).tc()};c.prototype.init=function(){var C=this.fb.nh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),G=this.fb.nh("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");C&&G?(G.Cg(),C.Gsi()):
x.a(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")};c.prototype.dispose=function(){};c.main=function(){y.a.instance.Ui(new c)};Af.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.AccessibilitySettings"}}});Object(u.a)(c,"AccessibilitySettingsPackage",null,[3,4]);b.d(D,"a",function(){return a})},1406:function(u,D,b){function a(){m.a.Fa(function(ba){ba.da.Ga(134,
new c(ba));ba.da.Ga(330,new na.a(ba))})}function c(ba){var sa=ra.call(this)||this;sa.tableManager=null;sa.$=ba;sa.Eb();return sa}function d(ba){var sa=Ea.call(this,N.g(ba))||this;sa.kpb=null;sa.izc=null;sa.J0=null;sa.mpb=null;sa.qpe=!1;sa.C9d=null;sa.sRb=0;sa.k5b=null;sa.Z_b=function(){var ya={},va=sa.pfd(),W;for(W in va){var La=va[W];if(La){var Ia=sa.rYh(La);if(Ia){if(Ia in sa.nFa){var mb=sa.nFa[Ia];if(mb.jB){mb.Pn.equals(La)||(mb.Pn=La);delete sa.nFa[Ia];ya[Ia]=mb;continue}}(mb=l.createInstance(N.g(sa.$),
La,sa.EHh(),sa))?ya[Ia]=mb:w.ULS.sendTraceTag(537151239,0,15,"TableManager.AttachTableResizeBehavior - Attaching Grippie Failed for Range {0}",La.dB(!1))}}}sa.$1b(null,null);sa.XPb=ya};sa.$1b=function(){var ya=sa.nFa,va;for(va in ya){var W=va,La=ya[va];La&&(La.dispose(),delete sa.nFa[W])}sa.XPb={}};sa.NKf=function(){sa.$1b(null,null);sa.Z_b(null,null)};sa.onFocus=function(){sa.C9d=N.g(sa.$).ha.sa.activeCell};sa.X5=function(){sa.$.isEditMode&&sa.Fh(null,null)};sa.Fh=function(){!sa.qpe&&I.c(sa.$,sa.gridView.ha.sa.activeCell)&&
sa.Rsi()};sa.TV=function(){sa.Jxb(1);sa.$.ea.Ln(sa.TV)};sa.YFb=function(){sa.qpe=!0;sa.izc=new e(sa.$)};sa.$=ba;sa.gridView=N.g(sa.$);sa.$.da.Ga(66,sa);sa.XPb={};sa.Z_b(null,null);sa.$.va&&sa.$.va.Kf(sa.NKf);sa.mne(sa.Z_b);sa.$.ea.p2(sa.X5);sa.gridView.ha.kJ(sa.Fh);sa.$.isEditMode&&sa.Fh(null,null);return sa}function e(ba){var sa=la.call(this,document.createElement("div"))||this;sa.GQ=!1;sa.dFf=!1;sa.Wmd=!1;sa.hTc=!1;sa.CJb=null;sa.Fh=function(){I.c(sa.$,sa.gridView.ha.sa.activeCell)?(sa.yLa=!0,sa.Nqb(!1)):
(sa.yLa=!1,sa.N4=!1,sa.qbg())};sa.$s=function(){sa.yLa?sa.Nqb(!0):sa.N4=!1};sa.buf=function(){sa.hTc=!0;sa.yLa&&(sa.N4=!1)};sa.onContentReady=function(){sa.$.isEditMode?I.c(sa.$,sa.gridView.ha.sa.activeCell)&&(sa.yLa=!0,sa.Nqb(!1)):sa.N4=!1};sa.HDb=function(){sa.hTc=!1;sa.yLa?sa.Nqb(!1):sa.N4=!1};sa.ff=function(ya,va){sa.yLa&&(ya=sa.gridView.apc(va.Zc.block.je.BlockCachePosition.PaneType).gG(va.Zc.hash))&&(ya.bJd(sa.KKa),ya.gVc(sa.KKa))};sa.KKa=function(){sa.GQf()};sa.$=ba;sa.gridView=N.g(sa.$);sa.parentElement=
sa.domElement;sa.parentElement.className=k.ash;sa.vKa=sa.gridView.Bj;sa.yLa=!0;sa.S$h();sa.TLg();sa.Nqb(!1);w.ULS.sendTraceTag(537151201,0,50,"TableTotalRowOptions - React Component Created ");return sa}function k(){}function l(ba,sa,ya,va){var W=ia.call(this,ba)||this;W.E7f=[6];W.y7f=[26];W.Dr=null;W.hic=!1;W.izb=!1;W.Uaa=null;W.Ys=null;W.onPointerDown=function(La){if(1!==W.$.Ka.dH())return!0;La=ha.a(W.$).Sd(La);if(W.jB)return!0;var Ia=fa.a(W.$).Wnd||fa.a(W.$).Pp();if(W.Spd||Ia)return W.sbb(),!0;
W.Ys=W.Pn;W.IHd();W.gjd();Ia=2===La.mb&&La.Hn===Sys.UI.MouseButton.leftButton;var mb=3===La.mb;if(Ia||mb)La=W.ha.Kn(La.clientPoint,La.zb,5,void 0,void 0,!0),La||(La=W.Ys),W.izb=Ia,W.hic=mb,W.Ys=W.P2e(La),W.gjd(),Ia?W.v8i():mb&&W.i9i(),ka.b(W.$,!0);return!0};W.xh=function(La){La=ha.a(W.$).Sd(La);if(!W.jB)return!1;if(La=W.izb?W.ha.Kn(La.clientPoint,La.zb,5,void 0,void 0,!0):W.ha.Kn(La.clientPoint,La.zb,5,!0,!1,!0))La=W.P2e(W.HYa(La)),W.E0b(La.bottomRight),W.Ys.equals(La)||(W.Ys=La,W.yHb(!1),W.IHd(!1),
W.gjd(!1),W.u6h(),W.qb.update(!1)),W.QQj(W.Ys);return!0};W.pf=function(La){ha.a(W.$).Sd(La);if(!W.jB)return!1;W.resizeTable();W.sbb();return!0};W.UEb=function(La){ha.a(W.$).Sd(La);if(!W.jB)return w.ULS.shipAssertTag(537151233,0,!0,"TableResizeBehavior.OnTouchUp - OnTouchUp Called without Operation in Progress"),!1;W.resizeTable();W.sbb();return!0};W.sca=function(La){ha.a(W.$).Sd(La);W.sbb();return!0};W.Xtf=function(){W.jB&&W.sbb()};W.gridView=sa;W.$=sa.$;W.tableManager=va;W.ha=sa.ha;W.qb=sa.qb;W.parentElement=
ba;W.CRg();z.a.Zo||z.a.vka||Q.a.instance.qa(ca.a.pointerDown,W.Uaa,W.onPointerDown);W.Pn=ya;W.Spd=!1;W.hLc=!1;W.tableManager.PDg(W.Xtf);return W}var m=b(11);u=b(0);var f=b(232),w=b(15),n=b(90),z=b(25),r=b(440),v=b(1333),A=b(570),B=b(189),y=b(234),x=b(24),C=b(64),G=b(45),E=b(169),I=b(249),U=b(47),M=b(44),T=b(12),F=b(69),K=b(130),J=b(1),O=b(10),N=b(21),H=b(355),Q=b(245),ca=b(13),X=b(161),Z=b(87),ea=b(5),ka=b(246),Y=b(76),qa=b(95),fa=b(42),ha=b(33),ia=Z.a;Rk(l,ia);l.prototype.dispose=function(){this.sbb();
this.tableManager.kaj(this.Xtf);this.Jgf||z.a.Zo||z.a.vka||Q.a.instance.Aa(ca.a.pointerDown,this.Uaa,this.onPointerDown);if(this.jB){ka.b(this.$,!1);try{this.tv()}catch(ba){w.ULS.sendTraceTag(537151236,0,10,"TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception {0}",ba)}}this.parentElement&&this.parentElement.contains(this.Uaa)&&this.parentElement.removeChild(this.Uaa);this.Uaa=this.parentElement=null;ia.prototype.dispose.call(this)};l.prototype.P2e=function(ba){var sa=ba.bottom-
this.Pn.topLeft.bottom-1;return 0<=ba.right-this.Pn.topLeft.right+1&&0<=sa&&ba.bottom>=this.Pn.top&&ba.right>=this.Pn.left?new x.Range(this.Pn.top,this.Pn.left,ba.bottom,ba.right,!1,!1):this.Ys};l.prototype.gjd=function(ba){this.Pvc([this.Ys],6,void 0===ba?!0:ba);this.qb.qn(this.E7f)};l.prototype.yHb=function(ba){ba=void 0===ba?!0:ba;this.qb.eh(this.E7f);this.Pvc([null],6,ba)};l.prototype.IHd=function(ba){ba=void 0===ba?!0:ba;this.qb.eh(this.y7f);this.Pvc([null],26,ba)};l.prototype.u6h=function(){var ba=
!1;ba=void 0===ba?!0:ba;var sa=this.wHj();0<sa.length&&(this.Pvc(sa,26,ba),this.qb.qn(this.y7f))};l.prototype.wHj=function(){var ba=[];this.Pn.contains(this.Ys)&&(this.Pn.right!==this.Ys.right&&ba.push(new x.Range(this.Pn.top,this.Ys.right+1,this.Ys.bottom,this.Pn.right,!1,!1)),this.Pn.bottom!==this.Ys.bottom&&ba.push(new x.Range(this.Ys.bottom+1,this.Pn.left,this.Pn.bottom,this.Pn.right,!1,!1)));return ba};l.prototype.resizeTable=function(){if(!this.Ys.equals(this.Pn)){var ba=new x.Range(this.Pn.top,
this.Pn.left,this.Ys.bottom,this.Ys.right,!1,!1);this.nMj(ba);this.Spd=!0}};l.prototype.onKeyDown=function(ba){ha.a(this.$).Sd(ba);return!0};l.prototype.m9a=function(){this.Jgf&&(z.a.Zo||z.a.vka||(Q.a.instance.qa(ca.a.pointerDown,this.Uaa,this.onPointerDown),this.Uaa.classList.remove("ewr-table-resize-default-cursor"),this.hLc=this.Uaa.disabled=!1),this.hLc=!1)};l.prototype.CRg=function(){var ba=document.createElement("div");ba.className="ewr-table-resize-handle";var sa=document.createElement("div");
sa.className="ewr-table-resize-fillhandle-higher";var ya=document.createElement("div");ya.className="ewr-table-resize-fillhandle-broader";ba.appendChild(sa);ba.appendChild(ya);this.Uaa=ba;this.parentElement.appendChild(this.Uaa)};l.prototype.E0b=function(ba){var sa=this,ya=this.Ys.contains(ba),va=ba.top,W=ba.bottom,La=ba.left;ba=ba.right;var Ia=null;if(ya){if(this.gridView.YQ(this.Pn.topLeft)&&!this.Pn.Lna)return;va=Math.max(1,W-5,this.Pn.top);La=Math.max(1,ba-5,this.Pn.left);W=va;ba=La;Ia=new x.Range(va,
La,va,La,!1,!1)}else W+=5,ba+=5,va=W,La=ba,Ia=new x.Range(W,ba,W,ba,!1,!1);this.gridView.YQ(Ia)||(this.Dr?this.Dr.Qp||(this.Dr=U.a.instance.create(function(){sa.gridView.hr(Ia,60,qa.a.B7f)},40,M.a.C7f)):this.Dr=U.a.instance.create(function(){sa.gridView.hr(Ia,60,qa.a.B7f)},40,M.a.C7f))};l.prototype.HYa=function(ba){var sa=ba;if(this.gridView.eb.p4){if(!this.gridView.Ub(ba.topLeft)){var ya=this.gridView.pk("TableResizeBehavior.AdjustHiddenRowColumns",this.gridView.$G,this.Ys.top!==ba.top?1:2);try{ya.Vk=
this.Ys.top<ba.top||this.Ys.left<ba.left,ya.Vr(ba.topLeft),sa=ya.$$cu().range}finally{ya&&ya.dispose()}}sa.right=sa.left+ba.width-1;sa.bottom=sa.top+ba.height-1}return sa};l.prototype.Pvc=function(ba,sa,ya){ya=void 0===ya?!0:ya;var va=[];ba=ak(ba);for(var W=ba.next();!W.done;W=ba.next())va.push(new H.a(W.value,C.d(this.$.pa)));this.qb.Lw(va,[sa],!0,void 0,ya)};l.prototype.v8i=function(){for(var ba=ak(this.gridView.hn),sa=ba.next();!sa.done;sa=ba.next())Q.a.instance.qa(ca.a.hh,sa.value.domElement,
this.xh);Q.a.instance.qa(ca.a.Nd,document.documentElement,this.pf);this.oHe()};l.prototype.i9i=function(){for(var ba=ak(this.gridView.hn),sa=ba.next();!sa.done;sa=ba.next())X.a.instance.qa(ca.a.mg,sa.value.domElement,this.xh);X.a.instance.qa(ca.a.qe,document.documentElement,this.UEb);this.oHe()};l.prototype.tv=function(){this.izb&&this.fPj();this.hic&&this.qPj()};l.prototype.fPj=function(){for(var ba=ak(this.gridView.hn),sa=ba.next();!sa.done;sa=ba.next())Q.a.instance.Aa(ca.a.hh,sa.value.domElement,
this.xh);Q.a.instance.Aa(ca.a.Nd,document.documentElement,this.pf);this.DMf()};l.prototype.qPj=function(){for(var ba=ak(this.gridView.hn),sa=ba.next();!sa.done;sa=ba.next())X.a.instance.Aa(ca.a.mg,sa.value.domElement,this.xh);X.a.instance.Aa(ca.a.qe,document.documentElement,this.UEb);this.DMf()};l.prototype.oHe=function(){Q.a.instance.qa(ca.a.my,document.documentElement,this.sca);this.gridView.$b.w7b(!0)};l.prototype.DMf=function(){Q.a.instance.Aa(ca.a.my,document.documentElement,this.sca);this.gridView.$b.w7b(!1)};
l.prototype.nMj=function(ba){var sa={};ba=(sa.ResizeTableRange=ba,sa.OriginalTableRange=this.Pn,sa);this.$.Fd(-1400250766,Y.a.Cb,30,ba)};l.prototype.QQj=function(ba){if(!this.Pn.contains(ba)){ba=this.vHj();ba=ak(ba);for(var sa=ba.next();!sa.done;sa=ba.next())if(this.tableManager.pqd(sa.value)){this.gridView.ig.zo(ea.a.BDi);return}}this.gridView.rtl?this.gridView.ig.zo(ea.a.FCi):this.gridView.ig.zo(ea.a.SEi)};l.prototype.sbb=function(){if(this.jB){ka.b(this.$,!1);try{this.tv()}catch(ba){w.ULS.sendTraceTag(537151232,
0,10,"TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception {0}",ba)}}this.Dr&&(this.Dr.cancel(),this.Dr.dispose());this.hic=this.izb=!1;this.yHb();this.IHd();ka.b(this.$,!1);this.gridView.ig.zo(ea.a.m4)};l.prototype.vHj=function(){var ba=[];this.Pn.right!==this.Ys.right&&ba.push(new x.Range(this.Pn.top,this.Pn.right+1,this.Ys.bottom,this.Ys.right,!1,!1));this.Pn.bottom!==this.Ys.bottom&&ba.push(new x.Range(this.Pn.bottom+1,this.Pn.left,this.Ys.bottom,this.Pn.right,!1,!1));
return ba};l.createInstance=function(ba,sa,ya,va){if(!sa)return null;var W=ba.qb;W.Lw(ya,[27],!0);W.qn(l.qHj);ya=W.fw(27,ba.eb.gj(sa.bottomRight),l.NMh(sa,ya)).mf;return new l(ya,ba,sa,va)};l.NMh=function(ba,sa){for(var ya,va=0;va<sa.length;va++)if((null===(ya=sa[va])||void 0===ya?0:ya.range)&&sa[va].range.equals(ba))return va;return 0};Af.Object.defineProperties(l.prototype,{jB:{configurable:!0,enumerable:!0,get:function(){return this.izb||this.hic}},Jgf:{configurable:!0,enumerable:!0,get:function(){return this.hLc}}});
l.qHj=[27];Object(u.a)(l,"TableResizeBehavior",Z.a,[]);var wa=b(7);Z=b(244);k.ash="ewa-ttrd-buttonarea";Object(u.a)(k,"CssClassNames",null,[]);var Qa=b(48),S=b(133),da=b(92),xa=b(22),ta=b(14),ab=b(250),Na=b(134),Ka=b(275),la=Z.a;Rk(e,la);e.prototype.dispose=function(){this.$&&this.Rdh();this.$=this.gridView=this.parentElement=this.vKa=null;la.prototype.dispose.call(this)};e.prototype.FKh=function(ba){var sa=this.qZh(this.gridView.Ub(null).range);return sa?String.format("=SUBTOTAL({0},{1})",ba,sa):
null};e.prototype.qZh=function(ba){var sa=N.g(this.$).Ab.dk(ba);if(!sa)return null;sa=E.a(sa,!1);sa.right=sa.left=ba.left;return sa.toString()};e.prototype.S$h=function(){e.VL={};e.VL["100"]=ta.a.instance.ga(1082);e.VL["101"]=ta.a.instance.ga(1085);e.VL["102"]=ta.a.instance.ga(1084);e.VL["103"]=ta.a.instance.ga(1089);e.VL["104"]=ta.a.instance.ga(1086);e.VL["105"]=ta.a.instance.ga(1087);e.VL["109"]=ta.a.instance.ga(1083);e.VL["107"]=ta.a.instance.ga(1090);e.VL["110"]=ta.a.instance.ga(1092);e.VL["111"]=
ta.a.instance.ga(1143)};e.prototype.wWi=function(){var ba=this.gridView.Ub(null);if(ba&&(ba=ba.pH?ba.formulaBarText:null))if("=SUBTOTAL("===ba.substring(0,10)){if(ba=ba.substring(10,13),ba in e.VL)return ba}else return"111";return"100"};e.prototype.TLg=function(){this.gridView.Ea.Fs(this.ff);this.gridView.ha.kJ(this.Fh);this.gridView.Ft(this.onContentReady);this.gridView.$b.Bk(this.buf);this.gridView.$b.vm(this.HDb)};e.prototype.Rdh=function(){this.gridView&&(this.gridView.ha&&(this.gridView.ha.UN(this.Fh),
this.gridView.Ea.Gq(this.ff)),this.gridView.Fw(this.onContentReady),this.gridView.$b&&(this.gridView.$b.wk(this.buf),this.gridView.$b.Nl(this.HDb)),this.qbg())};e.prototype.Nqb=function(ba){this.aRj(ba);this.$zb&&(this.UFj(),this.pmb?(this.dFf||this.dMg(),this.hTc?this.N4=!1:(this.N4=!0,this.GQf())):(w.ULS.sendTraceTag(537151199,0,15,"TableTotalRowOptions.CreateAndShowDropdownInUpdatedPosition : Offset bounds could not be determined"),this.N4=!1))};e.prototype.GQf=function(){var ba=this;appChrome.renderTableTotalRowOptions(this.parentElement,
e.VL,e.VL[this.wWi()].toString(),Math.round(ha.a(this.$).ii(17)),function(sa){w.ULS.sendTraceTag(537151198,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option : {0}",sa);var ya={};ya=(ya.SelectedOption=e.VL[sa],ya.FunctionKeyCode=sa,ya.Location="canvas",ya);Na.b(ba.$).Cd(S.a.AHj,ya,null,!0);if("111"===sa)return ba.tdi(),!0;if("100"!==sa){ba.CJb=ba.FKh(sa);if(!ba.CJb)return w.ULS.sendTraceTag(537151197,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option was null"),
!0;ba.dRa(ba.CJb)}else ba.dRa("");T.DOMElementExtensions.setFocus(ba.gridView.Wb.textBox.domElement);return!0})};e.prototype.tdi=function(){w.ULS.sendTraceTag(537151196,0,50,"TableTotalRowOptions.InvokeMoreFunctionsDialog - More Functions dialog invoked");var ba=new da.a(753860909,0,this.$.isEditMode?2:1,19,null);this.$.Ka.Kb(ba)};e.prototype.eva=function(ba){if(!ba)return null;var sa=this.gridView.$b.textBox.domElement;var ya=0<T.DOMElementExtensions.getHeight(sa)&&0<T.DOMElementExtensions.getWidth(sa)&&
0<=sa.offsetTop&&0<=sa.offsetLeft;if(ya)sa=T.DOMElementExtensions.eva(sa,this.gridView.Bj);else{sa=this.gridView.getCellBounds(ba.cell);var va=T.DOMElementExtensions.getBoundingClientRect(this.gridView.Bj);sa=new Sys.UI.Bounds(sa.x-va.x,sa.y-va.y,sa.width,sa.height)}if(sa)if(ya)2<sa.height&&2<sa.height&&(sa.x+=1,sa.y+=1,sa.height-=2,sa.width-=2);else if(ya=N.g(this.$).OJ(ba.cell))ya=ya.width,va=xa.a.equals(ab.a.p3a(ba.cell,this.gridView.rtl),"right",!0),this.gridView.rtl&&va&&(sa.x=sa.x+sa.width-
ya),ba.Fka&&this.gridView.rtl===va&&(sa.width=ya);else return null;return sa};e.prototype.aRj=function(ba){var sa=this.pmb;if(sa){var ya=17>=sa.height?sa.y:sa.y+sa.height-17-2;sa=this.bji?this.gridView.rtl?sa.x:sa.x+sa.width-(17<sa.height?17:sa.height):this.gridView.rtl?sa.x-(17<sa.height?17:sa.height):sa.x+sa.width;var va=ha.a(this.$).xja(new Sys.UI.Point(sa,ya));this.parentElement.style.top=O.HelperMethods.hc(va.y);this.parentElement.style.left=O.HelperMethods.hc(va.x);ha.a(this.$).wrj(this.parentElement);
ba&&(this.N4=this.gridView.qic(new Qa.a(sa,ya)))}else this.N4=!1};e.prototype.dMg=function(){this.vKa.insertBefore(this.parentElement,this.vKa.firstChild);this.dFf=!0};e.prototype.UFj=function(){this.GQ||(this.gridView.view.Gs(this.$s),this.GQ=!0)};e.prototype.qbg=function(){this.GQ&&this.gridView.view&&(this.gridView.view.Iq(this.$s),this.GQ=!1)};e.prototype.dRa=function(ba){var sa=this.gridView.Wb,ya=this.gridView.Ub(null);ya&&(ba=Object(wa.a)(new Ka.a,{Text:ba}),this.gridView.setCell(ba,ya.range,
0,127,null),sa.endEdit(!0,"TableTotalRowOptions.SetCellContent",0))};Af.Object.defineProperties(e.prototype,{N4:{configurable:!0,enumerable:!0,get:function(){return this.Wmd},set:function(ba){this.Wmd!==ba&&(this.Wmd=this.isVisible=ba)}},$zb:{configurable:!0,enumerable:!0,get:function(){return!!(this.$.Bd&16)}},bji:{configurable:!0,enumerable:!0,get:function(){var ba=this.gridView.ha.sa.activeCell;return ba.right===ba.maxColumns}},pmb:{configurable:!0,enumerable:!0,get:function(){var ba=this.gridView.Ub(null);
return ba&&this.gridView.d5(ba.range)?this.eva(ba):(ba&&w.ULS.sendTraceTag(537151200,0,50,"TableTotalRowOptions.ActiveCellOffsetBounds - Active Cell not in viewport area"),null)}}});e.zHj="TableTotalRowDropDownIconButtonId";e.VL=null;Object(u.a)(e,"TableTotalRowOptions",Z.a,[10]);var Ea=v.a;Rk(d,Ea);d.prototype.mne=function(ba){this.addHandler(v.a.IFd,ba)};d.prototype.YPf=function(ba){this.removeHandler(v.a.IFd,ba)};d.prototype.PDg=function(ba){this.addHandler("tce",ba)};d.prototype.kaj=function(ba){this.removeHandler("tce",
ba)};d.prototype.pqd=function(ba){return!!this.X_e(ba)};d.prototype.Xm=function(ba){return this.TUh(this.B0e(ba))};d.prototype.wub=function(ba){return this.B0e(ba)};d.prototype.e9i=function(ba){ba?(this.mpb?this.mpb!==ba&&(n.a.Ia(this.J0),this.J0=null,this.mpb=ba):this.mpb=ba,this.J0||(this.J0=K.a.instance.Td(this.mpb)),this.J0.an("focusin")||this.J0.ka("focusin",this.onFocus)):w.ULS.sendTraceTag(537151245,0,15,"TableManager.RegisterToTextboxFocusEvent empty textBoxDomElement recieved")};d.prototype.Xcf=
function(ba,sa){return ba?ba.Yaa&&ba.top===sa.top:(w.ULS.shipAssertTag(537151244,0,!!ba,"autofilterRange can't be null"),!1)};d.prototype.iva=function(ba){ba=this.kpb?G.I(ba,this.kpb):this.view.getRangeInformation(ba);return 0<ba.length&&Object(r.a)(y.PivotTableRange,ba[0])?ba[0]:null};d.prototype.Kfi=function(ba,sa){return ba?!ba.Yfc&&!!ba.iM&&ba.iM.xd(sa):(w.ULS.shipAssertTag(537151243,0,!!ba,"Pivot table can't be null"),!1)};d.prototype.Kli=function(ba,sa){return ba?!ba.Yfc&&!!ba.PW&&ba.PW.xd(sa):
(w.ULS.shipAssertTag(537151242,0,!!ba,"Pivot table can't be null"),!1)};d.prototype.LYb=function(ba){Ea.prototype.LYb.call(this,ba);if((ba=O.HelperMethods.h0e(ba))&&0<ba.length){this.kpb=Array(ba.length);for(var sa=0;sa<ba.length;sa++)this.kpb[sa]=B.a.vQ(ba[sa])}};d.prototype.rHb=function(){Ea.prototype.rHb.call(this);this.kpb=null};d.prototype.D3g=function(ba,sa){return this.QBe(ba,sa).returnValue};d.prototype.QBe=function(ba,sa){var ya=this;var va=!1;if(!ba||!sa)return{returnValue:!1,vY:va};ba=
ba.clone();ba.right+=1;ba.left=ba.right;if(!ba.isValidRange)return{returnValue:!1,vY:va};if(ba.top<sa.eb.Li){var W=ba.clone();W.bottom>=sa.eb.Li&&(W.bottom=sa.eb.Li-1);if(!function(){var Ia=ya.PBe(W,sa);va=Ia.vY;return Ia}().returnValue)return{returnValue:!1,vY:va}}if(ba.bottom>=sa.eb.Li){var La=ba.clone();La.top<=sa.eb.Li&&(La.top=sa.eb.Li);if(!function(){var Ia=ya.PBe(La,sa);va=Ia.vY;return Ia}().returnValue)return{returnValue:!1,vY:va}}return{returnValue:!0,vY:va}};d.prototype.D7f=function(ba){(ba=
this.Xm(ba.topLeft))&&ba.toString()in this.nFa&&(this.nFa[ba.toString()].Spd=!1)};d.prototype.c3i=function(){this.raiseEvent("tce")};d.prototype.Kh=function(ba,sa){if(!this.izc)return!1;switch(sa){case -569786022:case 541421805:if(this.izc.N4){var ya=document.getElementById(e.zHj);ya&&U.a.instance.create(function(){T.DOMElementExtensions.Xec(ya,null)},0,M.a.tHj,!0,!0)}return!0;default:return!1}};d.prototype.dispose=function(){this.$1b(null,null);this.YPf(this.Z_b);this.$.va.wg(this.NKf);this.$.Ol(this.$1b);
this.XPb=null;this.$.ea&&this.$.ea.e0(this.X5);this.gridView.ha.UN(this.Fh);this.izc=null;J.EwaSettings.ma(409)&&this.J0&&(n.a.Ia(this.J0),this.J0=null);Ea.prototype.dispose.call(this)};d.prototype.Z3h=function(ba,sa,ya,va){var W=this.gridView.Ab.dk(new x.Range(sa,ya,sa,ya,!1,!1));if(this.k5b=W){var La=W.usedRange,Ia=ba.ctrlKey||z.a.isMac&&F.b(ba),mb=!ba.shiftKey&&Ia;ba=ba.shiftKey&&!Ia;J.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&(N.g(this.$).ha.selectionType=3);
switch(va){case 0:this.sRb=0;J.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(sa=this.S3c(ba,La.top,ya,La.bottom,ya),this.JOd(sa,mb,ba)):this.KOd(La.top,ya,La.bottom,ya,E.d(W),E.g(W),mb);break;case 1:this.sRb=1;J.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(sa=this.S3c(ba,sa,La.left,sa,La.right),this.JOd(sa,mb,ba)):this.KOd(sa,La.left,sa,La.right,!1,!1,mb);break;case 2:this.sRb=2;J.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?
(sa=this.S3c(ba,La.top,La.left,La.bottom,La.right),this.JOd(sa,mb,ba)):this.KOd(La.top,La.left,La.bottom,La.right,E.d(W),E.g(W),mb);break;default:w.ULS.shipAssertTag(537151240,0,!1,"TableManager.HandleTableSelectorsSelection: Table Selector can not be of type: {0}",va.toString());return}J.EwaSettings.isChangeGateEnabled("OfficeVSO:5501896_TableSelectionDragSelection")&&(N.g(this.$).ha.selectionType=3);w.ULS.sendTraceTag(527212953,0,50,"TableManager.handleTableSelectorsSelection: A table selector was clicked using hover arrows")}else w.ULS.shipAssertTag(537151241,
0,!1,"TableManager.HandleTableSelectorsSelection: Table for table selector selection can't be null")};d.prototype.$vj=function(ba){var sa=this.k5b.usedRange;return this.fff(ba)||1!==this.QHa&&this.fff(new x.Range(sa.top,ba.left,sa.bottom,ba.right,!1,!1))?!0:!1};d.prototype.HFd=function(ba){return ba.Autofilters};d.prototype.PBe=function(ba,sa){var ya=!1;var va=sa.eb.gj(ba),W=sa.Ef(va).Ug;if(!W)return w.ULS.sendTraceTag(537151238,0,15,"TableManager.CouldExpandImpl - loadedRange is null. PaneType={0}",
va),{returnValue:!1,vY:ya};if(!W.Ae(ba))return{returnValue:!0,vY:ya};ba=sa.pk("TableManager.CouldExpandImpl",ba,2);try{for(;ba.$$mn();){if(ba.$$cu().text||ba.zn.e6e)return ya=!0,{returnValue:!1,vY:ya};if(ba.$$cu().dF)return{returnValue:!1,vY:ya}}}finally{ba&&ba.dispose()}return{returnValue:!0,vY:ya}};d.prototype.TUh=function(ba){if(!ba)return null;var sa=new A.AutofilterRange(ba.top,ba.left,ba.bottom,ba.right,null,null,null,ba.id,ba.Yaa);sa.Lna=ba.Lna;if(J.EwaSettings.isChangeGateEnabled("OfficeVSO:6424701_fixIssueWithTheGrippieButton")){var ya=
this.gridView.Ab.dk(ba,!0);if(!ya)return null;for(var va=0,W=this.rangeList.length;va<W;va++){var La=this.rangeList[va],Ia=this.gridView.Ab.dk(La,!0);Ia&&Ia.name===ya.name&&La!==ba&&this.jff(La)&&(sa.union(La),La.Lna&&(sa.Lna=!0))}}else for(ya=0,va=this.rangeList.length;ya<va;ya++)W=this.rangeList[ya],W.id===ba.id&&W!==ba&&this.jff(W)&&(sa.union(W),W.Lna&&(sa.Lna=!0));return sa};d.prototype.jff=function(ba){return!!N.g(this.$).Ab.dk(ba)};d.prototype.EHh=function(){for(var ba=[],sa=ak(this.rangeList),
ya=sa.next();!ya.done;ya=sa.next())ya=new H.a(this.Xm(ya.value.topLeft),C.d(this.$.pa)),ba.push(ya);return ba};d.prototype.pfd=function(){for(var ba={},sa=ak(this.rangeList),ya=sa.next();!ya.done;ya=sa.next())if(ya=ya.value){var va=this.Xm(ya.topLeft);va&&(ba[va.toString()]=this.Xm(ya.topLeft))}return ba};d.prototype.Rsi=function(){this.$.ea.fh?this.Jxb(0):this.$.ea.wl(this.TV)};d.prototype.Jxb=function(ba){var sa=this;this.$.eB(function(ya){ya.gja(ba).then(sa.YFb)})};d.prototype.rYh=function(ba){var sa=
this.gridView.Ab.dk(ba);return sa?sa.name:ba.toString()};d.prototype.KOd=function(ba,sa,ya,va,W,La,Ia){var mb=ba+(W?1:0),fb=ya-(La?1:0),Ma=this.gridView.inRangePicker||this.gridView.xi,Hb=!1,Kb=new x.Range(mb,sa,fb,va,!1,!1);if(W||La)for(W=Ma?H.a.frb(this.gridView.ha.rangePicker.zK):this.gridView.ha.sa.selectedRanges,W=ak(W),La=W.next();!La.done;La=W.next()){La=La.value;Hb=this.oqb(La,mb,sa,fb,va);var Ub=this.oqb(La,ba,sa,ya,va);if(Ma&&Hb)break;if(!Ma&&(Hb||Ub)){this.gridView.ha.updateSelection(La,
La.topLeft,0,1);if(Ia&&Ub)return;break}}Hb&&(Kb.top=ba,Kb.bottom=ya);ba=Kb.topLeft;Ia?this.gridView.ha.updateSelection(Kb,ba,0,1):Ma?this.gridView.ha.BB([Kb],0,ba,0):this.gridView.ha.updateSelection(Kb,ba,0,3)};d.prototype.JOd=function(ba,sa,ya){ba&&(ya=ya?N.g(this.$).ha.sa.activeCell:ba.topLeft,sa?this.gridView.ha.updateSelection(ba,ya,0,1):this.gridView.ha.BB([ba],0,ya,0))};d.prototype.S3c=function(ba,sa,ya,va,W){var La=E.d(this.k5b),Ia=E.g(this.k5b),mb=sa+(1!==this.QHa&&La?1:0),fb=va-(1!==this.QHa&&
Ia?1:0),Ma=this.gridView.inRangePicker||this.gridView.xi;if(ba){var Hb=J.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&Ma&&!H.a.frb(this.gridView.ha.rangePicker.zK).length?new x.Range(mb,ya,fb,W,!1,!1):Ma?this.gridView.ha.rangePicker.activeCell:this.gridView.ha.sa.activeCell;Hb=new x.Range(Hb.top<mb?Hb.top:mb,Hb.left<ya?Hb.left:ya,Hb.bottom>fb?Hb.bottom:fb,Hb.right>W?Hb.right:W,!1,!1)}else Hb=new x.Range(mb,ya,fb,W,!1,!1);if(1!==this.QHa&&(La||Ia)&&(!ba||ba&&this.oqb(Hb,
mb,ya,fb,W)))for(ba=Ma?H.a.frb(this.gridView.ha.rangePicker.zK):this.gridView.ha.sa.selectedRanges,ba=ak(ba),La=ba.next();!La.done;La=ba.next())if(this.oqb(La.value,mb,ya,fb,W)){Hb.top=sa;Hb.bottom=va;break}return Hb};d.prototype.fff=function(ba){var sa=this.gridView.inRangePicker||this.gridView.xi?H.a.frb(this.gridView.ha.rangePicker.zK):this.gridView.ha.sa.selectedRanges;sa=ak(sa);for(var ya=sa.next();!ya.done;ya=sa.next())if(this.oqb(ya.value,ba.top,ba.left,ba.bottom,ba.right))return!0;return!1};
d.prototype.oqb=function(ba,sa,ya,va,W){return!!ba&&ba.top===sa&&ba.bottom===va&&ba.left===ya&&ba.right===W};Af.Object.defineProperties(d.prototype,{nFa:{configurable:!0,enumerable:!0,get:function(){return this.XPb}},Brd:{configurable:!0,enumerable:!0,get:function(){return this.C9d}},QHa:{configurable:!0,enumerable:!0,get:function(){return this.sRb}},qg:{configurable:!0,enumerable:!0,get:function(){var ba=N.g(this.$);return ba.Ab.dk(ba.ha.sa.activeCell,!1)}},qEd:{configurable:!0,enumerable:!0,get:function(){return this.Brd?
N.g(this.$).Ab.dk(this.Brd,!1):null}}});Object(u.a)(d,"TableManager",v.a,[589,10]);var ra=f.a;Rk(c,ra);c.prototype.create=function(){this.pb(this.tableManager||(this.tableManager=new d(this.$)))};Object(u.a)(c,"TableManagerFactory",f.a,[]);var na=b(1420);b.d(D,"a",function(){return a})},1420:function(u,D,b){function a(fa){var ha=qa.call(this)||this;ha.tableStyleManager=null;ha.$=fa;ha.Eb();return ha}function c(fa,ha,ia){var wa=ka.call(this)||this;var Qa={};wa.n0i=(Qa.height="100%",Qa);wa.jHb={};wa.egd=
0;wa.HHa=0;wa.lastSyncTime=new Date;wa.zda=-1;wa.JN=null;wa.qma={};wa.eL=null;wa.WF={};wa.CSa={};wa.vrc=null;wa.Xef=!1;wa.isInitialized=!1;wa.a6a=!1;wa.Wzb=!1;wa.xuc=null;wa.ZTe=!1;wa.jMb=!1;wa.Fyc=!1;wa.Cyh=function(){wa.Zhc()?wa.$.ea.qId(wa.Cyh):wa.oKa("tableStyleManagerInitialization")};wa.gxf=function(S,da,xa){var ta=!1,ab=O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1);if(J.a(S))-315732528!==S.Errors[0].MessageId&&(n.ULS.sendTraceTag(42821707,0,10,"TableStyleManager.OnGetTableStyleSuccess - Webservice call failed with Unexpected error : {0}",
K.a.Dc(S.Errors)),wa.Hzd(null,da,xa));else if(n.ULS.sendTraceTag(537151202,0,50,"TableStyleManager.OnGetTableStyleSuccess - Webservice call Success"),(S=S.Result)&&S.TableStyleItems.length){xa=60<S.TableStyleItems.length;var Na=!1,Ka=!1;if(wa.eL)for(var la=0;60>la;++la){var Ea=S.TableStyleItems[la],ra=wa.eL.TableStyleItems[la];if(ab&&Ea.HasStyleViolations!==ra.HasStyleViolations){ta=Ka=!0;break}for(var na=0;9>na&&!(na>=Ea.TableStyleElementsList.length);na++)if(!N.a.equals(Ea.TableStyleElementsList[na].BackgroundColor,
ra.TableStyleElementsList[na].BackgroundColor,!1)){ta=Na=!0;break}}else for(wa.HHa=0,la=ak(S.TableStyleItems),Ea=la.next();!Ea.done;Ea=la.next())Ea=Ea.value,Ea.TableStyleElementsList&&Ea.TableStyleElementsList.sort(e.zmf),wa.WF[Ea.Name]=Ea;if(Na||Ka)for(Na=0;60>Na;++Na)Ka=S.TableStyleItems[Na],wa.WF[Ka.Name]=Ka;if(xa&&wa.eL)for(n.ULS.sendTraceTag(42821700,0,50,"TableStyleManager.OnGetTableStyleSuccess, Number Custom Styles present - {0}",S.TableStyleItems.length-60),ta=!0,xa=60;xa<S.TableStyleItems.length;++xa)Na=
S.TableStyleItems[xa],Na.Name in wa.WF||Na.TableStyleElementsList&&Na.TableStyleElementsList.sort(e.zmf),wa.WF[Na.Name]=Na;if(ea.a(wa.WF).length!==S.TableStyleItems.length)for(ta=!0,Na=xa=60;Na<wa.eL.TableStyleItems.length;)xa>=S.TableStyleItems.length?delete wa.WF[wa.eL.TableStyleItems[Na].Name]:xa>=S.TableStyleItems.length||!N.a.equals(S.TableStyleItems[xa].Name,wa.eL.TableStyleItems[Na].Name,!1)?delete wa.WF[wa.eL.TableStyleItems[Na].Name]:++xa,++Na;wa.eL=S;wa.$Mf(ta);ta&&wa.vYc();ab&&da&&("accessibility"===
da?(wa.jMb=!1,wa.Fyc=!0):wa.Fyc=!1);wa.Xef||(wa.hni()&&wa.$.jf(),wa.Xef=!0);wa.egd=0;wa.Wzb||wa.ZTe?ab&&wa.Fyc&&wa.raiseEvent("RefreshTableStyleGallery"):(wa.raiseEvent("RefreshTableStyleGallery"),wa.ZTe=!0)}};wa.Hzd=function(){n.ULS.sendTraceTag(42821712,0,10,"TableStyleManager.OnGetTableStyleFailed - Webservice call failed");wa.egd++;5>wa.egd&&U.a.instance.create(function(){wa.oKa("getTableStylesFailed")},1E3,M.a.F7f,!0,!0)};wa.JCf=function(){wa.Wzb&&(wa.Wzb=!1,wa.xuc&&wa.xuc(),U.a.instance.create(function(){wa.oKa("galleryMenuClosed")},
1E3,M.a.F7f,!0,!0))};wa.$=fa;wa.Va=ha;wa.tableManager=ia;wa.$.da.Ga(329,wa);wa.SYc=wa.Pub();wa.$.Ka.vYa(wa.JCf);return wa}function d(fa,ha,ia,wa,Qa,S){this.headerRow=fa;this.totalRow=ha;this.firstCol=ia;this.lastCol=wa;this.PR=Qa;this.Jha=S}function e(){}function k(){}u=b(0);var l=b(232),m=b(51),f=b(37),w=b(7),n=b(15),z=b(113),r=b(1025),v=b(1663),A=b(934),B=b(1594),y=b(38),x=b(5),C=b(168),G=b(76),E=b(61),I=b(169),U=b(47),M=b(44),T=b(111);b(28);var F=b(198),K=b(29),J=b(296),O=b(1),N=b(22),H=b(14);
b(30);Object(u.a)(k,"TableStyleElement",null,[]);var Q=b(961),ca=b(217),X=b(88),Z=b(590);e.zmf=function(fa,ha){return e.G7f[fa.Type]-e.G7f[ha.Type]};e.F3a=function(fa,ha){try{return appChrome.buildTableStyleGalleryIconNew(e.TAa,e.Zna,fa,ha)}catch(ia){return null}};e.Lgf=function(fa){return fa&&G.a.Nc in fa&&(fa=fa[G.a.Nc])?N.a.cL(fa,x.a.hGb):!1};e.Rsa=function(fa){var ha=[],ia=0;fa=ak(fa);for(var wa=fa.next();!wa.done;wa=fa.next()){wa=wa.value;ha[ia]={};ha[ia].backgroundColor="white";ha[ia].color=
"black";for(var Qa in wa){var S=wa[Qa];switch(Qa){case "background-color":ha[ia].backgroundColor=S;break;case "color":ha[ia].color=S;break;case "font-size":ha[ia].fontSize=S;break;case "border-bottom":ha[ia].borderBottom=S;break;case "border-right":ha[ia].borderRight=S;break;case "border-left":ha[ia].borderLeft=S;break;case "border-top":ha[ia].borderTop=S}}ia++}return ha};e.K3b=function(fa,ha){var ia=[];if(null===fa||void 0===fa?0:fa.TableStyleElementsList)for(var wa=0===fa.Category,Qa=0;Qa<e.Zna;Qa++)ia.push.apply(ia,
yk(e.CLh(fa,ha,wa,Qa)));else{if(e.n5c)return e.n5c;fa={color:"black","background-color":"white"};for(ha=0;ha<e.Zna;ha++)for(wa=0;wa<e.TAa;wa++)ia.push(fa);e.n5c=ia}return ia};e.sYh=function(fa,ha){if(!fa.TableStyleElementsList)return"";var ia="";fa=ak(fa.TableStyleElementsList);for(var wa=fa.next();!wa.done;wa=fa.next())if(wa=wa.value,wa.BackgroundColor&&"#000000"!==wa.BackgroundColor)switch(wa.Type){case 0:ia=wa.BackgroundColor;break;case 5:case 7:if(ha.Jha||ha.PR)ia=wa.BackgroundColor;break;case 3:case 4:if(ha.firstCol||
ha.lastCol)ia=wa.BackgroundColor;break;case 2:ha.totalRow&&(ia=wa.BackgroundColor);break;case 1:ha.headerRow&&(ia=wa.BackgroundColor)}return ia};e.J2b=function(fa){fa=new ca.a(parseInt(String("0x"+fa.substr(1,2)),16),parseInt(String("0x"+fa.substr(3,2)),16),parseInt(String("0x"+fa.substr(5,2)),16));return Q.a.ZJa(fa)};e.l2e=function(fa,ha){if(!fa||!ha)return"";ha=(ha=e.sYh(fa,ha))?e.J2b(ha)+", ":H.a.instance.ga(2040)+", ";switch(fa.Index){case 0:return ha+H.a.instance.ga(1974);case 1:return ha+H.a.instance.ga(1975);
case 2:return ha+H.a.instance.ga(1976);case 3:return ha+H.a.instance.ga(1977);case 4:return ha+H.a.instance.ga(1978);case 5:return ha+H.a.instance.ga(1979);case 6:return ha+H.a.instance.ga(1980);case 7:return ha+H.a.instance.ga(1981);case 8:return ha+H.a.instance.ga(1982);case 9:return ha+H.a.instance.ga(1983);case 10:return ha+H.a.instance.ga(1984);case 11:return ha+H.a.instance.ga(1985);case 12:return ha+H.a.instance.ga(1986);case 13:return ha+H.a.instance.ga(1987);case 14:return ha+H.a.instance.ga(1988);
case 15:return ha+H.a.instance.ga(1989);case 16:return ha+H.a.instance.ga(1990);case 17:return ha+H.a.instance.ga(1991);case 18:return ha+H.a.instance.ga(1992);case 19:return ha+H.a.instance.ga(1993);case 20:return ha+H.a.instance.ga(1994);case 21:return ha+H.a.instance.ga(1995);case 22:return ha+H.a.instance.ga(1996);case 23:return ha+H.a.instance.ga(1997);case 24:return ha+H.a.instance.ga(1998);case 25:return ha+H.a.instance.ga(1999);case 26:return ha+H.a.instance.ga(2E3);case 27:return ha+H.a.instance.ga(2001);
case 28:return ha+H.a.instance.ga(2002);case 29:return ha+H.a.instance.ga(2003);case 30:return ha+H.a.instance.ga(2004);case 31:return ha+H.a.instance.ga(2005);case 32:return ha+H.a.instance.ga(2006);case 33:return ha+H.a.instance.ga(2007);case 34:return ha+H.a.instance.ga(2008);case 35:return ha+H.a.instance.ga(2009);case 36:return ha+H.a.instance.ga(2010);case 37:return ha+H.a.instance.ga(2011);case 38:return ha+H.a.instance.ga(2012);case 39:return ha+H.a.instance.ga(2013);case 40:return ha+H.a.instance.ga(2014);
case 41:return ha+H.a.instance.ga(2015);case 42:return ha+H.a.instance.ga(2016);case 43:return ha+H.a.instance.ga(2017);case 44:return ha+H.a.instance.ga(2018);case 45:return ha+H.a.instance.ga(2019);case 46:return ha+H.a.instance.ga(2020);case 47:return ha+H.a.instance.ga(2021);case 48:return ha+H.a.instance.ga(2022);case 49:return ha+H.a.instance.ga(2023);case 50:return ha+H.a.instance.ga(2024);case 51:return ha+H.a.instance.ga(2025);case 52:return ha+H.a.instance.ga(2026);case 53:return ha+H.a.instance.ga(2027);
case 54:return ha+H.a.instance.ga(2028);case 55:return ha+H.a.instance.ga(2029);case 56:return ha+H.a.instance.ga(2030);case 57:return ha+H.a.instance.ga(2031);case 58:return ha+H.a.instance.ga(2032);case 59:return ha+H.a.instance.ga(2033);default:return fa.Name?fa.Name:""}};e.ySh=function(fa){return(fa+1)%e.r7h};e.Tvb=function(fa,ha,ia){ia=void 0===ia?"":ia;return fa||!ia?String.format("{0}, {1}, -version, {2}",e.r8e,fa.Index.toString(),ha.toString()):String.format("{0}, {1}, -version, {2}",e.r8e,
ia,ha.toString())};e.CLh=function(fa,ha,ia,wa){for(var Qa=[],S=0;S<e.TAa;S++)Qa.push(e.Ocd(fa,ha,ia,wa,S));return Qa};e.Ocd=function(fa,ha,ia,wa,Qa){var S=fa.TableStyleElementsList;fa=new k;var da={};if(!S)return da;for(var xa=ak(S),ta=xa.next();!ta.done;ta=xa.next())if(ta=ta.value,0===ta.Type){fa=ta;break}xa=!!fa.BackgroundColor;var ab="";!ia&&fa.TableStyleBorderFromatList&&0<fa.TableStyleBorderFromatList.length&&(ab=fa.TableStyleBorderFromatList[0].Color);da["background-color"]=xa?fa.BackgroundColor:
"#FFFFFF";fa.FontColor||(fa.FontColor="#000000");da.color=fa.FontColor;e.Ywe(wa,Qa,da,fa,ab,ia,xa);S=ak(S);for(ta=S.next();!ta.done;ta=S.next())(ta=ta.value)&&0!==ta.Type&&(2!==ta.Type||xa||(ta.BackgroundColor=fa.BackgroundColor),e.jqd(ta,wa,Qa,ha)&&(ta.BackgroundColor&&(da["background-color"]=ta.BackgroundColor),da.color=ta.FontColor||fa.FontColor,e.Ywe(wa,Qa,da,ta,ab,ia,xa)));return da};e.aV=function(fa,ha,ia,wa,Qa,S){ia&&(ia.Color&&!ia.Style&&(ia.Style=1),ia.Style&&!ia.Color&&(ia.Color=Qa?"#000000":
wa?wa:S?"#FFFFFF":"#000000"),ha[e.borders[fa]]="1px "+e.IV[ia.Style]+" "+ia.Color)};e.jqd=function(fa,ha,ia,wa){return-1===fa.Type?!1:e.kqd(fa,ha,ia,wa)||e.Smi(fa,ha,ia,wa)||e.lqd(fa,ha,ia,wa)};e.Smi=function(fa,ha,ia,wa){return!ha&&wa.headerRow||ha===e.Zna-1&&wa.totalRow?!1:1===ha%2&&5===fa.Type&&wa.PR&&wa.headerRow||1<ha&&!!((ha-1)%(fa.BandSize+1))&&6===fa.Type&&wa.PR&&wa.headerRow||!(ha%2)&&5===fa.Type&&wa.PR&&!wa.headerRow||!!(ha%(fa.BandSize+1))&&6===fa.Type&&wa.PR&&!wa.headerRow||!(ia%2)&&7===
fa.Type&&wa.Jha||!!(ia%(fa.BandSize+1))&&8===fa.Type&&wa.Jha};e.lqd=function(fa,ha,ia,wa){return ha===e.Zna-1&&2===fa.Type&&wa.totalRow||ia===e.TAa-1&&ha===e.Zna-1&&12===fa.Type&&wa.totalRow&&wa.lastCol||!ia&&ha===e.Zna-1&&11===fa.Type&&wa.totalRow&&wa.firstCol||ia===e.TAa-1&&4===fa.Type&&wa.lastCol};e.kqd=function(fa,ha,ia,wa){return!ha&&1===fa.Type&&wa.headerRow||!ia&&3===fa.Type&&wa.firstCol||!ia&&!ha&&9===fa.Type&&wa.headerRow&&wa.firstCol||ia===e.TAa-1&&!ha&&10===fa.Type&&wa.headerRow&&wa.lastCol};
e.Ywe=function(fa,ha,ia,wa,Qa,S,da){if(wa.TableStyleBorderFromatList)for(var xa=ak(wa.TableStyleBorderFromatList),ta=xa.next();!ta.done;ta=xa.next())if(ta=ta.value,ta.Style)switch(ta.Position){case 0:fa&&12!==wa.Type&&11!==wa.Type&&2!==wa.Type&&5!==wa.Type&&6!==wa.Type||e.aV(0,ia,ta,Qa,S,da);break;case 1:fa!==e.Zna-1&&1!==wa.Type&&10!==wa.Type&&9!==wa.Type&&5!==wa.Type&&6!==wa.Type||e.aV(1,ia,ta,Qa,S,da);break;case 2:ha&&12!==wa.Type&&10!==wa.Type&&7!==wa.Type&&8!==wa.Type&&4!==wa.Type||e.aV(2,ia,
ta,Qa,S,da);break;case 3:ha!==e.TAa-1&&9!==wa.Type&&11!==wa.Type&&3!==wa.Type&&7!==wa.Type&&8!==wa.Type||e.aV(3,ia,ta,Qa,S,da);break;case 5:ha!==e.TAa-1&&3!==wa.Type&&4!==wa.Type&&7!==wa.Type&&8!==wa.Type&&e.aV(3,ia,ta,Qa,S,da);break;case 6:fa!==e.Zna-1&&2!==wa.Type&&1!==wa.Type&&5!==wa.Type&&6!==wa.Type&&e.aV(1,ia,ta,Qa,S,da)}};e.vYh=function(){var fa=Array(12);fa[0]=0;fa[7]=1;fa[8]=2;fa[5]=3;fa[6]=4;fa[4]=5;fa[3]=6;fa[1]=7;fa[2]=8;fa[9]=9;fa[10]=10;fa[11]=11;fa[12]=13;return fa};e.Zna=5;e.TAa=5;
e.r7h=5;e.r8e="TableStyleIcon";e.IV=[null,X.a.solid,X.a.dashed,X.a.dotted,X.a.dashed,X.a.dotted,X.a.dashed,X.a.double];e.borders=[Z.a.borderTop,Z.a.borderBottom,Z.a.borderLeft,Z.a.borderRight];e.G7f=e.vYh();e.n5c=null;Object(u.a)(e,"TableStyleHelper",null,[]);d.prototype.equals=function(fa){return fa?this.headerRow===fa.headerRow&&this.totalRow===fa.totalRow&&this.firstCol===fa.firstCol&&this.lastCol===fa.lastCol&&this.Jha===fa.Jha&&this.PR===fa.PR:!1};Object(u.a)(d,"TableStyleOptions",null,[]);var ea=
b(1003),ka=y.a;Rk(c,ka);c.prototype.v5e=function(fa){var ha=this.tableManager.qg;if(!ha)return!1;fa=fa[G.a.Nc];if(!fa)return!1;switch(Number.parseInvariant(fa)){case 0:return I.d(ha);case 1:return I.c(ha);case 2:return I.g(ha);case 3:return I.e(ha);case 4:return I.f(ha);case 5:return I.b(ha);case 6:return ha.hasAutoFilter}return!1};c.prototype.EGf=function(fa,ha){if(z.a.isEmpty(this.WF))return!0;if("PopulateTableMoreStylesMenu"!==fa&&"PopulateTableAccessibleStylesMenu"!==fa)return!1;if(O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",
!1)&&"PopulateTableAccessibleStylesMenu"===fa&&!this.Fyc)return this.jMb||(this.jMb=!0,this.oKa("accessibilityTab")),!0;this.Wzb=!0;var ia=this.Va.mq("TableStylesMenu"),wa=this.Va.qC("Ribbon.TableTools.TableStyles.Gallery.Custom",7,"Size48by48"),Qa=this.Va.qC("Ribbon.TableTools.TableStyles.Gallery.Dark",7,"Size48by48"),S=this.Va.qC("Ribbon.TableTools.TableStyles.Gallery.Medium",7,"Size48by48"),da=this.Va.qC("Ribbon.TableTools.TableStyles.Gallery.Light",7,"Size48by48"),xa=-123538519;if(ha.MenuId)if(N.a.contains(ha.MenuId,
"FormatAsTable",!0))xa=753331043,this.a6a=!0;else{var ta=H.a.instance.ga(1973);var ab=e.Tvb(null,1,"-1");O.EwaSettings.isChangeGateEnabled("OfficeVSO:4185429_NonNullIconNameForSLRGalleryItem")?da.Dt("-1",xa,"QueryTableStyle",0,"-1",ab,void 0,void 0,ta):da.Dt("-1",xa,"QueryTableStyle",0,"-1",void 0,void 0,void 0,ta);this.a6a=!1}ab=0;var Na=this.WF,Ka;for(Ka in Na){var la=Na[Ka];if(!O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)||"PopulateTableAccessibleStylesMenu"!==
fa||!la.HasStyleViolations){ta=e.l2e(la,this.Pub());var Ea=e.Tvb(la,this.HHa);if(la)switch(la.Category){case 0:wa.Dt(la.Index.toString(),xa,"QueryTableStyle",0,la.Index.toString(),Ea,void 0,void 0,ta);ab++;break;case 3:Qa.Dt(la.Index.toString(),xa,"QueryTableStyle",0,la.Index.toString(),Ea,void 0,void 0,ta);break;case 2:S.Dt(la.Index.toString(),xa,"QueryTableStyle",0,la.Index.toString(),Ea,void 0,void 0,ta);break;case 1:da.Dt(la.Index.toString(),xa,"QueryTableStyle",0,la.Index.toString(),Ea,void 0,
void 0,ta)}}}0<ab&&this.n2(ia,wa,1941);this.n2(ia,da,1942);this.n2(ia,S,1943);this.n2(ia,Qa,1944);ha.MenuItems=ia.eE();this.isInitialized||(this.isInitialized=!0);return!0};c.prototype.Qhd=function(fa){var ha=this;fa[r.a.On]=!1;var ia=fa[G.a.Nc];if(ia&&!z.a.isEmpty(this.WF)){N.a.contains(fa.ParentMenuId,"FormatAsTable",!0)?this.a6a=!0:this.a6a=!1;this.a6a||this.acg();e.Lgf(fa)&&(ia=this.hvb(ia).toString());var wa=this.Pub();fa[r.a.Alt]="-1"===ia?H.a.instance.ga(1973):e.l2e(this.dgd(ia),wa);if(ia in
this.CSa&&wa.equals(this.SYc))this.GGf(fa,ia,wa,!0);else{if(!this.vrc||this.vrc&&!this.vrc.Qp)this.qma={},this.vrc=U.a.instance.create(function(){ha.$Mf();ha.SYc=ha.Pub()},0,M.a.yHj,!0,!0);this.kDd(wa,fa,ia)}}};c.prototype.getTableStyleIndexFromName=function(fa){if(!fa||z.a.isEmpty(this.WF))return-1;if(fa in this.WF)return this.WF[fa].Index;this.oKa("getTableStyleIndexFromName");return-1};c.prototype.Zhc=function(){return!!this.eL};c.prototype.hvb=function(fa){this.JN||this.vYc();return fa in this.JN?
this.JN[fa]:-1};c.prototype.oKa=function(fa){if(this.$.isEditMode)if(O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)){var ha=new Date;if(30<T.getElapsedSeconds(this.lastSyncTime,ha)||z.a.isEmpty(this.WF)||this.jMb){var ia=this.$.oa.xa.Pb();this.lastSyncTime=ha;fa=this.jMb&&"accessibilityTab"===fa||"galleryMenuClosed"===fa;E.n(this.$.oa.xa,fa,this.gxf,this.Hzd,null,fa?"accessibility":"normal",ia)}}else if(ia=new Date,30<T.getElapsedSeconds(this.lastSyncTime,
ia)||z.a.isEmpty(this.WF))fa=this.$.oa.xa.Pb(),this.lastSyncTime=ia,E.m(this.$.oa.xa,this.gxf,this.Hzd,null,null,fa)};c.prototype.dispose=function(){this.JN=this.CSa=this.eL=this.WF=null;this.$.Ka.UHb(this.JCf);ka.prototype.dispose.call(this)};c.prototype.vGg=function(fa){this.addHandler("RefreshTableStyleGallery",fa)};c.prototype.qcj=function(fa){this.removeHandler("RefreshTableStyleGallery",fa)};c.prototype.vYc=function(){var fa={};this.tableManager.qg&&(this.zda=this.getTableStyleIndexFromName(this.tableManager.qg.gzc));
for(var ha=1;7>=ha;ha++)fa["preview"+ha]=this.BRh(ha);this.JN=fa};c.prototype.BRh=function(fa){var ha=this.eL.TableStyleItems.length;ha=4>=this.zda?this.zda+fa-1:4<this.zda&&this.zda<ha-4?4===fa?this.zda:Math.floor(this.zda+fa-4):this.zda+fa-1;-1===ha||ha.toString()in this.CSa||(ha=fa-3);return ha};c.prototype.acg=function(){if(this.tableManager.qg){var fa=!1,ha=this.getTableStyleIndexFromName(this.tableManager.qg.gzc);if(ha!==this.zda){if(this.JN){var ia=this.JN,wa;for(wa in ia)ia[wa]===ha&&(fa=
!0)}this.zda=ha;fa||z.a.isEmpty(this.CSa)||this.vYc()}}};c.prototype.n2=function(fa,ha,ia){var wa=this.Va.Bc();wa.Jp="Thin";wa.title=H.a.instance.ga(ia);wa.buttons.push(ha);fa.pc.push(wa)};c.prototype.Pub=function(){var fa=this.tableManager.qg;return this.a6a||!fa?new d(!0,!1,!1,!1,!0,!1):new d(I.d(fa),I.g(fa),I.c(fa),I.e(fa),I.f(fa),I.b(fa))};c.prototype.$Mf=function(fa){fa=void 0===fa?!1:fa;var ha={},ia={},wa=this.Pub();if(!z.a.isEmpty(this.WF)&&(this.tableManager.qg&&this.acg(),!wa.equals(this.SYc)||
fa||z.a.isEmpty(this.CSa))){this.HHa=e.ySh(this.HHa);fa=this.WF;for(var Qa in fa){var S=fa[Qa],da=e.Tvb(S,this.HHa);ha[S.Index.toString()]=e.F3a(e.Rsa(e.K3b(S,wa)),da);ia[da]=ha[S.Index.toString()];this.iHb(ia)}Qa=e.Tvb(null,this.HHa,"-1");ha["-1"]=e.F3a(e.Rsa(e.K3b(null,wa)),Qa);ia[Qa]=ha["-1"];this.iHb(ia);F.c(this.CSa,ha,!1)}};c.prototype.hni=function(){var fa=C.a(this.$);return fa?fa.Ql.AB===x.a.oza:!1};c.prototype.kDd=function(fa,ha,ia){Number.parseInvariant(ia);"-1"===ia&&N.a.contains(ha.ParentMenuId,
"FormatAsTable",!0)||this.GGf(ha,ia,fa,!1)};c.prototype.GGf=function(fa,ha,ia,wa){var Qa=e.Tvb(null,this.HHa,ha);e.Lgf(fa)?(Qa in this.qma?ia=this.qma[Qa]:(ia=e.Rsa(e.K3b(this.dgd(ha),ia)),this.qma[Qa]=ia),fa[r.a.GalleryButtonProps]=Object(w.a)(new v.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:Qa,Alt:fa[r.a.Alt],MenuItemId:ha,TableCellStyles:ia,TableStyles:this.n0i})):(fa[A.a.Icon]=Qa,fa[r.a.GalleryButtonProps]=Object(w.a)(new B.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",
Id:Qa,Alt:fa[r.a.Alt],MenuItemId:ha}),wa||(wa=[],this.dgd(ha),"-1"===ha||N.a.contains(fa.ParentMenuId,"FormatAsTable",!0)||(wa=e.K3b(this.eL.TableStyleItems[Number.parseInvariant(ha)],ia)),this.CSa[ha]=e.F3a(e.Rsa(wa),Qa)))};c.prototype.iHb=function(fa){var ha=this;if(this.Wzb)this.xuc=function(){ha.iHb(fa)};else{this.xuc=null;var ia=[],wa;for(wa in fa){var Qa=wa;Qa in this.jHb?ia.push(Qa):this.jHb[Qa]=!0}try{0<ia.length&&appChrome.api.unregisterIcons(ia),z.a.isEmpty(fa)||appChrome.api.registerIconProvider(function(){return fa})}catch(S){}}};
c.prototype.dgd=function(fa){fa=Number.parseInvariant(fa);if(-1===fa||!this.eL)return null;if(60<fa)for(var ha=60;ha<this.eL.TableStyleItems.length;++ha){var ia=this.eL.TableStyleItems[ha];if(ia.Index===fa)return ia}return this.eL.TableStyleItems[fa]};Object(u.a)(c,"TableStyleManager",y.a,[590,10]);var Y=b(58);b.d(D,"a",function(){return a});var qa=l.a;Rk(a,qa);a.prototype.create=function(){var fa=this,ha=m.GetServiceTaskFactory.create(this.$.da,102,this.la,this.hb),ia=m.GetServiceTaskFactory.Ra(this.$.da,
66,134,this.hb);f.TaskExtensions.Ba(Y.Task.qL(ha,ia),function(){fa.pb(fa.tableStyleManager||(fa.tableStyleManager=new c(fa.$,ha.result,ia.result)))},this.$.la,8)};Object(u.a)(a,"TableStyleManagerFactory",l.a,[])},1436:function(u,D,b){function a(){O.a.Fa(c.ka)}function c(N){var H=J.call(this)||this;H.$=N;H.Eb();return H}function d(N){var H=e.call(this,document.documentElement,N)||this;H.SB=0;H.uNg=[f.a.EBe,f.a.vxd,f.a.tdc,f.a.yVd,f.a.dLd,f.a.xYc,f.a.abd,f.a.U3e,f.a.FXc,f.a.ozc,f.a.bCj,f.a.Ecc,f.a.NZc,
f.a.Mtb,f.a.NPd,f.a.VZc,f.a.E5f,f.a.bkf,f.a.aYc];H.SVj=[f.a.tdc,f.a.afg,f.a.$eg,f.a.bfg];H.D0i=[f.a.tdc,f.a.gIf,f.a.hIf,f.a.kIf];H.uVg=[f.a.iUe,f.a.T3e,f.a.Zad,f.a.Wad];H.e0i=[f.a.EBe,f.a.vxd,f.a.xYc,f.a.abd,f.a.FXc,f.a.ozc,f.a.Ecc,f.a.NZc,f.a.Mtb,f.a.NPd,f.a.CHf,f.a.VZc,f.a.aYc];H.o0i=[f.a.Ecc,f.a.oUe];var Q=K.a.instance.Xa(251);H.hqj=H.$.shortcutKeyManager.UJa(Q);H.mode=0;N.da.Ga(15,H);G.TaskExtensions.Ba(C.GetServiceTaskFactory.Ra(N.da,21,137,1),function(ca){ca=ca.result;ca.Wn(m.a.dmb);ca.Ml(m.a.dmb,
H.EIb)},N.la);return H}function e(N,H){var Q=M.call(this,N)||this;Q.Q8=[];Q.y9d=null;Q.EIb=function(ca){var X="forward";ca.Values[w.a.direction]?X=ca.Values[w.a.direction].toLowerCase():l.ULS.sendTraceTag(537166664,0,15,"Didn't find direction in message values");ca=0;var Z=!0;"backward"===X?(ca=Q.zrd.length-1,Z=!1):"forward"===X?(ca=0,Z=!0):l.ULS.sendTraceTag(537166663,0,15,"Received unknown direction to resume focus: {0}",X);Q.$pf(Z,ca,!1)};Q.gyf=function(){Q.Q8=[]};Q.sOa=function(ca){if(-411645385===
Q.$.shortcutKeyManager.Ut(ca,!0)&&Q.zdf()){var X={};Q.$.Ka.Kb(new E.a(-411645385,1,Q.$.Jc,6,null),(X.event=ca,X),ca);ca.stopPropagation()}};Q.INi=function(ca){Q.Tla(ca)};Q.jb=H;Q.yc.ka("keydown",Q.INi);Q.yc.ka("keyup",Q.sOa);A.a(H).HGg(Q.gyf);y.a(H.ya,27)&&G.TaskExtensions.Ba(C.GetServiceTaskFactory.Ra(H.da,21,137,1),function(ca){ca=ca.result;ca.Wn(m.a.H7e);ca.Ml(m.a.H7e,Q.EIb)},H.la);return Q}u=b(0);var k=b(232),l=b(15),m=b(170),f=b(256),w=b(392),n=b(4),z=b(741),r=b(89),v=b(87),A=b(273),B=b(168),
y=b(78),x=b(395),C=b(51),G=b(37),E=b(92),I=b(69),U=b(637),M=v.a;Rk(e,M);e.prototype.dispose=function(){this.$&&A.a(this.$).Ecj(this.gyf);this.jb=null;Array.clear(this.Q8);M.prototype.dispose.call(this)};e.prototype.c1i=function(N){this.Tla(N)};e.prototype.$pf=function(N,H,Q,ca){ca=void 0===ca?null:ca;var X=this.OGj(N,H,void 0===Q?!0:Q,ca);if(!X){Q=H;var Z=N?1:-1,ea=this.zrd;do{X=!1;if(y.a(this.$.ya,27)){if(Q+=Z,Q>=ea.length||0>Q)X=!0}else Q=(Q+Z+ea.length)%ea.length;if(X){this.Mwi(N,H,ca);break}else if(X=
this.NGj(N,H,Q,ca))break}while(Q!==H)}};e.prototype.OGj=function(N,H,Q,ca){ca=void 0===ca?null:ca;var X=null;0<=H&&(X=this.Q8[H]);return(null===X||void 0===X?0:X.canReceiveFocus)&&X.Uf(N,void 0===Q?!0:Q)?(ca&&I.g(ca),l.ULS.sendTraceTag(537166669,0,50,"Switched focus inside current section {0} into a sub region",X.Zd),X.hj(),!0):!1};e.prototype.NGj=function(N,H,Q,ca){ca=void 0===ca?null:ca;Q=this.Q8[Q];if((null===Q||void 0===Q?0:Q.canReceiveFocus)&&Q.Uf(N,!1)){ca&&I.g(ca);Q.hj();if(N=this.Q8[H])N.Dj(),
l.ULS.sendTraceTag(537166668,0,50,"Switched focus from section {0} to {1}",N.Zd,Q.Zd);return!0}return!1};e.prototype.Mwi=function(N,H,Q){(Q=void 0===Q?null:Q)&&I.g(Q);if(H=this.Q8[H])H.Dj(),l.ULS.sendTraceTag(537166666,0,50,"Lost focus from section {0}",H.Zd);G.TaskExtensions.Ba(C.GetServiceTaskFactory.Ra(this.$.da,21,137,0),function(ca){var X={};ca.result.xj(m.a.dmb,(X[w.a.direction]=N?"forward":"backward",X))},this.$.la)};e.prototype.Tla=function(N){var H=this.$.isEditMode?B.a(this.$):null;if(!this.$.ob.Hwa||
e.Eii(H))if(117===N.keyCode&&(N.ctrlKey||I.b(N))){H=this.vWh(N.target);var Q=!N.shiftKey;l.ULS.sendTraceTag(537166662,0,50,"AccessibilityManager.OnKeyDownHandler: Ctrl+F6 loop. The root index section is: {0}",H);n.AFrameworkApplication.ta.Pa.rz&&this.$.Eka&&1===H&&1===this.$.Kxc&&z.ShyRibbon.GP(1,0);this.$pf(Q,H,!0,N)}else 117!==N.keyCode||e.lRe?-411645385===this.$.shortcutKeyManager.Ut(N)?this.zdf()&&(H={},this.$.Ka.Kb(new E.a(-411645385,1,this.$.Jc,6,null),(H.event=N,H),N),N.stopPropagation()):
1588554917===this.$.shortcutKeyManager.Ut(N)?0===this.mode?(U.a(this.$)||(H={},this.$.Ka.Kb(new E.a(1588554917,1,this.$.Jc,6,null),(H.event=N,H),N)),N.preventDefault(),N.stopPropagation()):3===this.mode&&(N.preventDefault(),N.stopPropagation()):this.f2h(N):(N=x.a.Iy.notificationBar.G$(r.a.INh(),!1),N.image=0,x.a.Iy.notificationBar.VD(N),e.lRe=!0)};e.prototype.vWh=function(N){for(var H=this.zrd,Q=0,ca=H.length;Q<ca;++Q){var X=H[Q];if(X&&X.$g(N))return Q}return-1};e.prototype.BZe=function(){for(var N=
[],H=0,Q=this.hxa.length;H<Q;H++){var ca=A.a(this.$).FM(this.hxa[H]);ca&&N.push(ca)}return N};e.prototype.zdf=function(){return 0===this.mode||4===this.mode};e.Eii=function(N){return N?N.inKeytipMode:!1};Af.Object.defineProperties(e.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.jb}},zrd:{configurable:!0,enumerable:!0,get:function(){this.Q8.length||(this.Q8=this.BZe());return this.Q8}},hxa:{configurable:!0,enumerable:!0,get:function(){return this.y9d},set:function(N){this.y9d=
N;this.Q8=this.BZe()}}});e.lRe=!1;Object(u.a)(e,"AccessibilityManager",v.a,[621,10]);var T=b(155),F=b(22),K=b(14);Rk(d,e);d.prototype.Tla=function(N){this.$.Bd&65536&&e.prototype.Tla.call(this,N)};d.prototype.f2h=function(N){if(F.a.equals(this.hqj,this.$.shortcutKeyManager.Rdd(N),!1)){var H=T.b(this.$);if(null===H||void 0===H?0:H.canReceiveFocus)I.g(N),H.Uf(!0,!1)}};Af.Object.defineProperties(d.prototype,{mode:{configurable:!0,enumerable:!0,get:function(){return this.SB},set:function(N){this.SB=N;
switch(N){case 0:this.hxa=this.uNg;break;case 2:this.hxa=this.SVj;break;case 3:this.hxa=this.D0i;break;case 4:this.hxa=this.uVg;break;case 5:this.hxa=this.e0i;break;case 6:this.hxa=this.o0i;break;default:l.ULS.shipAssertTag(537170759,0,!0,"Accessibility Mode value is not in allowed values")}}}});Object(u.a)(d,"EwaAccessibilityManager",e,[]);var J=k.a;Rk(c,J);c.prototype.create=function(){this.pb(this.$.da.za(15)||new d(this.$))};c.ka=function(N){N.da.Ga(157,new c(N))};Object(u.a)(c,"AccessibilityManagerFactory",
k.a,[]);var O=b(11);b.d(D,"a",function(){return a})},1437:function(u,D,b){function a(){k.a.Fa(c.ka)}function c(C){var G=x.call(this)||this;G.$=C;G.Eb();return G}function d(C){var G=this;this.ug=function(){G.gkf();G.$.ea.Ln(G.ug)};this.$=C;this.l7f={};this.$Td={};var E=n.EwaSettings.isChangeGateEnabled("OfficeVSO:4431502_UseCommonIconSpriteInEwa")?"excelInitialAppSprite":"excelAppSprite",I=this.iZe(E);I?(this.Gle(I),this.$.ea.fh?this.gkf():C.ea.wl(this.ug),this.$.da.Ga(388,this)):l.ULS.sendTraceTag(537151263,
0,15,"window[{0}].icons returned null.",E)}function e(){}var k=b(11);u=b(0);var l=b(15),m=b(232),f=b(37),w=b(53),n=b(1),z=b(304),r=b(224);e.INe="ewa-svg-icon";Object(u.a)(e,"CssClassNames",null,[]);var v=b(51),A=b(12),B=b(326),y=b(259);d.prototype.dispose=function(){this.$Td=null;this.$.ea.Ln(this.ug)};d.prototype.ova=function(C,G,E,I,U){I=void 0===I?null:I;U=void 0===U?null:U;var M;(M=this.$Td[C])||(this.$Td[C]=M=this.YWi(this.l7f[C]));if(!M)return l.ULS.shipAssertTag(537151262,0,!1,"SvgIconProvider.GetSvgElement: id {0} was not found in loaded SVG sprites.",
C),null;var T=M.cloneNode(!0);if(!T.style){var F=B.b(M),K=B.b(T),J={};J.iconId=C;J.isOriginalNodeStyleNull=void 0===M.style||null===M.style;J.isOriginalNodeCurrentStyleNull=void 0===M.currentStyle||null===M.currentStyle;J.isClonedNodeCurrentStyleNull=void 0===T.currentStyle||null===T.currentStyle;J.originalNode=F.substring(0,F.indexOf(">")+1);J.clonedNode=K.substring(0,K.indexOf(">")+1);l.ULS.sendTraceTag(537151261,0,10,"SvgIconProvider.GetSvgElement: cloned element's style is undefined. data: {0}",
JSON.stringify(J))}C=String.format("height: {0}px; width: {0}px;",G,E);T.setAttribute("style",C);U&&(C=document.createElement("title"),C.innerHTML=U,T.insertBefore(C,T.childNodes[0]));if(I)for(I=ak(I),U=I.next();!U.done;U=I.next())Sys.UI.DomElement.addCssClass(T,U.value);return T};d.prototype.hba=function(C,G,E,I,U,M,T,F){U=void 0===U?0:U;M=void 0===M?0:M;T=void 0===T?null:T;F=void 0===F?null:F;U&&M||(M=A.DOMElementExtensions.getBoundingClientRect(I),U=M.height,M=M.width);if(T=this.ova(C,G,E,T,F))I.appendChild(T),
(I=A.DOMElementExtensions.oZ(T,"style",null))?T.setAttribute("style",I+String.format(" margin: {0}px {1}px;",(U-G)/2,(M-E)/2)):l.ULS.sendTraceTag(537151260,0,10,'SvgIconProvider.InsertAndCenterSvgElement: svgElement\'s GetAttribte("styl") returned null. Icon ID: {0}',C);return T};d.prototype.gkf=function(){var C=this;f.TaskExtensions.Ba(v.GetServiceTaskFactory.Ra(this.$.da,283,284,0),function(G){G=y.c(G.result.tn.loadScript("excel-uiSlice20-sprite"));f.TaskExtensions.Ba(G,function(){var E=C.iZe("excelUiSlice20Sprite");
E?C.Gle(E):l.ULS.sendTraceTag(537151259,0,15,"window[{0}].icons returned null.","excelUiSlice20Sprite")},C.$.la,3)},this.$.da.la,3)};d.prototype.Gle=function(C){C=ak(C);for(var G=C.next();!G.done;G=C.next())G=G.value,G.type===r.a.YTd&&(this.l7f[G.id]=G)};d.prototype.YWi=function(C){if(!C)return null;var G=C.viewBox;C=C.children;var E=document.createElementNS(z.a.bUd,r.a.YTd);Sys.UI.DomElement.addCssClass(E,e.INe);E.setAttribute("focusable","false");E.setAttribute("viewBox",G);this.PCg(E,C);return E};
d.prototype.PCg=function(C,G){G=ak(G);for(var E=G.next();!E.done;E=G.next()){E=E.value;var I=document.createElementNS(z.a.bUd,E.type),U;for(U in E){var M=U,T=E[U];"className"===M?I.setAttribute("class",T):I.setAttribute(M,T)}C.appendChild(I)}};d.prototype.iZe=function(C){return(C=window[C])?C.icons:null};Object(u.a)(d,"SvgIconProvider",null,[616,10]);var x=m.a;Rk(c,x);c.prototype.create=function(){var C=this;f.TaskExtensions.Ba(w.a.KV([128],4,this.hb,void 0,void 0,void 0,387),function(){var G=n.EwaSettings.isChangeGateEnabled("OfficeVSO:4431502_UseCommonIconSpriteInEwa")?
"excelInitialAppSprite":"excelAppSprite";window[G]?C.pb(C.$.da.za(388)||new d(C.$)):l.ULS.sendTraceTag(537151258,0,50,"window.[{0}] returned null.",G)},this.la,3)};c.ka=function(C){C.da.Ga(387,new c(C))};Object(u.a)(c,"SvgIconProviderFactory",m.a,[]);b.d(D,"a",function(){return a})},1461:function(u,D,b){function a(){e.a.Fa(c.ka)}function c(n){var z=w.call(this)||this;z.sparklineManager=null;z.$=n;z.Eb();return z}function d(n,z){n=f.call(this,n)||this;z.Ga(240,n);return n}var e=b(11);u=b(0);var k=
b(232),l=b(21),m=b(1333),f=m.a;Rk(d,f);d.prototype.BXh=function(n){for(var z=ak(this.rangeList),r=z.next();!r.done;r=z.next())if(r=r.value,n.range.contains(r))return r;return null};d.prototype.HFd=function(n){return n.GridBlockModel&&(n=gridRenderer.CanvasRendererFactoryGlobal.getModelAccessor(n.GridBlockModel))?n.getSparklineRanges():null};Object(u.a)(d,"SparklineManager",m.a,[592]);var w=k.a;Rk(c,w);c.prototype.create=function(){this.pb(this.sparklineManager||(this.sparklineManager=new d(l.g(this.$),
this.$.da)))};c.ka=function(n){n.da.Ga(239,new c(n))};Object(u.a)(c,"SparklineManagerFactory",k.a,[]);b.d(D,"a",function(){return a})},1482:function(u,D,b){function a(){l.a.jl.Ga(141,new c)}function c(){return k.call(this)||this}u=b(0);var d=b(149),e=b(695),k=e.a;Rk(c,k);c.prototype.dispose=function(){d.WacAirSpace.Qld()&&d.WacAirSpace.Tzc()};c.prototype.animate=function(m,f,w,n,z){f&&d.WacAirSpace.VK(m.element,f);d.WacAirSpace.animate(m,n,z);w&&d.WacAirSpace.L9i(m.element,w)};Object(u.a)(c,"AnimationManager",
e.a,[10]);var l=b(102);b.d(D,"a",function(){return a})},1654:function(u,D,b){function a(J){var O=U.call(this)||this;O.$=J;O.Eb();return O}function c(J){var O=I.call(this)||this;O.qsd=null;O.$=J;A.ULS.sendTraceTag(537155201,0,50,"NewAndOpenCoreManager created");return O}b.r(D);u=b(1405);D=b(1370);var d=b(1329),e=b(1330),k=b(1331),l=b(1334);b(1332);var m=b(1436),f=b(1482),w=b(11),n=b(0),z=b(232),r=b(202),v=b(615),A=b(15),B=b(1019),y=b(567),x=b(84),C=b(4),G=b(79),E=b(1114),I=G.a;Rk(c,I);c.prototype.rhj=
function(){var J=new r.a,O=y.a.Mq(x.a.instance.Tb("Common.IEventEmitter<Common.IMruResult>")),N=new v.a(function(){return O.result});this.qsd=new v.a(function(){return new B.a(N.value,null)});if(!this.qsd)return J;var H=this.qsd.value.yZ("NewAndOpenCoreManager",!1);if(!H||3!==H.state||!H.fwd)return H?A.ULS.sendTraceTag(544289226,0,50,"NewAndOpenCoreManager.RetrieveMruFiles - the mruResult state: {0}, mruResult MruDocuments is null: {1}",H.state,!H.fwd):A.ULS.sendTraceTag(544289227,0,50,"NewAndOpenCoreManager.RetrieveMruFiles: the mruResult is null"),
null;H=H.fwd;for(var Q=["xlsx","xlsb","xlsm"],ca=0;ca<H.length;ca++){var X=H[ca];if(!(0>Array.indexOf(Q,X.extension))){var Z=String.format("{0}.{1}",X.title,X.extension),ea=E.b(X,C.AFrameworkApplication.isRtl);X=X.url;if(Z&&ea&&X){var ka={};J.add((ka[c.fileName]=Z,ka[c.friendlyPath]=ea,ka[c.section]="mru",ka[c.absoluteUrl]=X,ka))}else X||A.ULS.sendTraceTag(537155200,0,50,"ChangeSourceDialog.GetMruFiles: the DAV url of the file is null")}}return J};c.prototype.dispose=function(){I.prototype.dispose.call(this)};
c.fileName="FileName";c.friendlyPath="FriendlyPath";c.section="Section";c.absoluteUrl="AbsoluteUrl";Object(n.a)(c,"NewAndOpenCoreManager",G.a,[748,10]);var U=z.a;Rk(a,U);a.prototype.create=function(){this.pb(this.$.da.za(451)||this.$.da.Ga(451,new c(this.$)))};a.ka=function(J){J.da.Ga(164,new a(J))};Object(n.a)(a,"NewAndOpenCoreFactory",z.a,[]);n=b(1363);z=b(1461);G=b(1437);var M=b(1406),T=b(1364),F=b(1354),K=b(1373);b=b(1347);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.GridHighlightsBehavior");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SheetTabBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SvgIconProvider");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Table");Type.registerNamespace("_Ewa");Object(u.a)();Type.registerNamespace("Common.App.AltTextDialog");Object(D.a)();Object(d.a)();Object(e.a)();Object(k.a)();Object(m.a)();w.a.Fa(a.ka);Object(f.a)();Object(n.a)();Object(z.a)();Object(G.a)();Object(l.a)();Object(M.a)();Object(T.a)();Object(F.a)();
Type.registerNamespace("Common.App.SessionExpiration");Object(K.a)();Object(b.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.acc.js.map/f6bbbde5c81b6e48158240cad1381388/EwaDS.acc.js.map