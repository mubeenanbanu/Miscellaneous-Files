(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[13],{1440:function(u,D,b){function a(qa,fa,ha,ia){var wa=Y.call(this)||this;wa.isMac=m.a.isMac;wa.WXa=-1;wa.R4b=null;wa.dta=-1;wa.kse=!1;wa.h_=!1;wa.NRd=!1;wa.Bic=!1;wa.aN=!1;wa.NT=null;wa.vg=function(){wa.hwa&&wa.gridView&&wa.bX()};wa.Fc=function(){wa.Px()};wa.$c=function(){wa.oHa();K.g(wa.$).Uf(!0,!1)};wa.e6=function(S,da){da?(wa.Gbg(wa.R4b),wa.mdb()):(S=[29],wa.gridView.qb.eh(S),wa.gridView.qb.Wi(null,S),wa.NT&&wa.NT.Y6e())};
wa.Ri=function(){wa.o6a()&&wa.Mh.hide();1===wa.gridView.ha.Qe&&wa.bX()};wa.pR=function(){var S=wa.gridView.ha.Qe;wa.gridView.ha.sa.activeCell&&1===S&&wa.bX()};wa.onKeyUp=function(S){return wa.hBb?wa.h_?!1:17===S.Ca.keyCode&&wa.NRd?(wa.aN?(wa.mdb(),wa.pda()):wa.rKb(),!0):!1:wa.h_=!1};wa.onKeyDown=function(S){if(!wa.hBb)return wa.h_=!1;wa.NRd=!1;wa.h_=S.ctrlKey;switch(S.Ca.keyCode){case 27:return wa.aN?(wa.e6(null,!1),wa.pda()):wa.NT&&(wa.NT.Y6e(),wa.rKb()),!0;case 13:if(wa.aN)return wa.aN=!1,wa.oHa(),
!0;break;case 17:return wa.NRd=!0}return!1};var Qa=b(1547).AutoDetectActionButton;wa.$=qa;wa.oob=M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AutoDetectRichTooltip",!1);fa||l.ULS.sendTraceTag(537166983,0,15,"AutoDetectManager: SVG icons are enabled, but svgIconProvider is null");wa.convertToLinkedEntityManager=ia;ia.E$a();wa.Mh=new Qa(qa,fa,wa.$c,ha,"");wa.FMg=new c(wa.$,ia);wa.gridView=K.g(wa.$);wa.gridView.ha.sP(wa.vg);wa.gridView.Wb.nYa(wa.vg);wa.gridView.Ft(wa.pR);qa.Ck(wa.Fc);
qa.xA(wa.Ri);wa.gridBlockManager=Object(n.a)(379,wa.gridView.Ea);wa.kr=qa.frame.pt;wa.bX();return wa}function c(qa,fa){var ha=O.call(this)||this;ha.$=qa;ha.gridView=K.g(qa);ha.convertToLinkedEntityManager=fa;ha.U0c=new J.a;return ha}function d(qa,fa){var ha=U.call(this)||this;ha.$c=function(ia){if(ia.zb.id===ha.pIa.firstChild.id){ia=ha.jse;var wa={};wa.Id=ia.nob;ha.convertToLinkedEntityManager.d2c(wa,!0,ia);ha.pIa.removeChild(ha.pIa.firstChild);return!0}return!1};ha.jse=qa;ha.convertToLinkedEntityManager=
fa;ha.pIa=document.createElement("div");ha.pIa.className="clip16x16";ha.Xva=String.format('<input type="image" id="{0}" class="{1}" src="{2}" alt="Convert To Linked Entities Column Header Button">',C.a.Ag("autodetectid"+ha.jse.left),E.a.Z8c,I.a.Te(11));ha.pIa.innerHTML=ha.Xva;qa=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");G.a.instance.qa(w.a.click,qa,ha.$c);return ha}function e(qa,fa){this.helpId=this.helpText=this.imageAltText=this.urlValue=this.longDescription=this.convertToDomainName=
this.cardViewManager=null;this.$=fa;this.parentElement=qa}u=b(0);var k=b(7),l=b(15),m=b(25),f=b(90),w=b(13),n=b(85),z=b(440),r=b(79),v=b(8),A=b(66),B=b(493);e.prototype.F4g=function(){var qa=this,fa=this.G4g();B.a(this.$,243,242,0,function(ha){qa.cardViewManager=ha;ha.A2f(qa.parentElement,2,fa)})};e.prototype.Y6e=function(){this.cardViewManager&&this.cardViewManager.SKa(-1,-1,this.parentElement)};e.prototype.G4g=function(){var qa={layoutId:"AutoDetectTooltip"};qa.description=this.longDescription;
qa.convertToDomainName=this.convertToDomainName;qa.longDescription=this.longDescription;qa.urlValue=this.urlValue;qa.imageAltText=this.imageAltText;qa.helpText=this.helpText;qa.helpId=this.helpId;return qa};Object(u.a)(e,"AutoDetectCardManager",null,[]);var y=b(31),x=b(219),C=b(30),G=b(233),E=b(18),I=b(53),U=r.a;Rk(d,U);d.prototype.dispose=function(){if(this.pIa){var qa=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");G.a.instance.Aa(w.a.click,qa,this.$c)}U.prototype.dispose.call(this)};
Af.Object.defineProperties(d.prototype,{domElement:{configurable:!0,enumerable:!0,get:function(){return this.pIa}}});Af.Object.defineProperties(d,{gSg:{configurable:!0,enumerable:!0,get:function(){return"clip16x16"}}});Object(u.a)(d,"AutoDetectColumnHeaderButton",r.a,[]);var M=b(1),T=b(1295),F=b(10),K=b(21),J=b(171),O=r.a;Rk(c,O);c.prototype.dispose=function(){O.prototype.dispose.call(this)};c.prototype.Qfh=function(qa){for(var fa=ak(this.gridView.U2),ha=fa.next();!ha.done;ha=fa.next()){ha=ak(ha.value);
for(var ia=ha.next();!ia.done;ia=ha.next()){ia=ia.value;var wa=ia.Fn,Qa=T.a(ia.r4);this.wAg(qa,Qa,wa);ia.aOd(Qa)}}};c.prototype.wAg=function(qa,fa,ha){if(fa.length){var ia=ha.length;ha[ia-1]<qa.left||(ha=F.HelperMethods.ox(new x.a(ha),0,ia,qa.left,F.HelperMethods.TC),0>ha||!(fa=fa[ha]))||(this.gridView.rtl?fa.classList.add(y.a.Xth):fa.classList.add(y.a.Wth),this.U0c.kb(qa.left)||this.U0c.add(qa.left,new d(qa,this.convertToLinkedEntityManager)),qa=this.U0c.na(qa.left).domElement,!fa.getElementsByClassName(d.gSg).length&&
this.oDj(fa)&&fa.appendChild(qa))}};c.prototype.oDj=function(qa){var fa=parseInt(qa.style.width,10),ha=document.querySelector(".ewrch-col-cellsel")?"bold":"normal";ha=c.p6g(ha);qa=gridRenderer.CanvasRendererGlobals.measureTextWidth(qa.firstChild.innerHTML,ha,!0,M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1));return 18.4<fa-(fa/2+qa/2)?!0:!1};c.p6g=function(qa){return String.format("{0} {1} {2} {3}/{4} {5}","normal","normal",qa,"10pt","normal",'"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif')};
Object(u.a)(c,"AutoDetectColumnHeaderManager",r.a,[]);var N=b(460),H=b(24),Q=b(64),ca=b(151),X=b(12),Z=b(14),ea=b(187),ka=b(80);b.d(D,"a",function(){return a});var Y=r.a;Rk(a,Y);a.prototype.dispose=function(){this.gridView&&this.gridView.ha.zW(this.vg);if(this.$){var qa=this.$;qa.Ol(this.Fc);qa.kD(this.Ri);K.g(qa).Fw(this.pR)}f.a.Ia(this.Mh);this.kr=this.$=this.gridView=this.Mh=null;Y.prototype.dispose.call(this)};a.prototype.Px=function(){this.e6(null,!1);this.WXa=-1;this.Mh.hide();this.uOj();this.aN=
!1};a.prototype.pda=function(){this.Mh.getButton(a.rea).tbb();this.aN=!1};a.prototype.rKb=function(){this.Mh.getButton(a.rea).QFb();this.Gbg(this.R4b);this.aN=!0;this.$.da.Za(211,function(qa){qa.zPa(Z.a.instance.ga(1726))})};a.prototype.onAutoDetectUIShown=function(){if(this.hwa&&-1!==this.WXa)this.convertToLinkedEntityManager.onAutoDetectUIShown()};a.prototype.GMg=function(qa){var fa=new H.Range(1===qa.top?1:qa.top-1,qa.left,qa.bottom,qa.right,!0,!1);fa=this.gridView.getRangeInformation(fa);fa=ak(fa);
for(var ha=fa.next();!ha.done;ha=fa.next())if(ha=ha.value,Object(z.a)(N.AutoDetectRange,ha)&&this.ufc(qa,!1,ha))return!0;return!1};a.prototype.oHa=function(){if(this.hwa&&-1!==this.WXa){this.Mh.getButton(a.rea).QFb();var qa={};qa.Id=this.dta;qa.StringId=null;this.convertToLinkedEntityManager.d2c(qa,!0,this.R4b);l.ULS.sendTraceTag(594612633,0,50,"AutoDetectManager.Convert (AssistedAutoConvertMenuConvertClicked)");qa=[Object(k.a)(new ka.a,{name:"Domain",int64:this.dta})];ea.a("AssistedAutoConvertMenuConvertClicked",
void 0,void 0,qa);this.dta=-1}};a.prototype.lJh=function(){var qa=Z.a.instance.ga(1722);if(-1!==this.dta){qa+=" ";try{qa+=this.convertToLinkedEntityManager.AAb(this.dta.toString())}catch(fa){l.ULS.sendTraceTag(537166982,0,10,"AutoDetectManager.GetButtonAccessibilityString: Could not obtain name from domain {0}",this.dta)}}qa+=" ";return qa=this.oob?qa+Z.a.instance.ga(1725):qa+Z.a.instance.ga(this.isMac?1724:1723)};a.prototype.mdb=function(){this.oob&&(this.NT||(this.NT=new e(this.jc,this.$),this.NT.convertToDomainName=
Z.a.instance.ga(1727),this.NT.urlValue="https://support.content.office.net/en-us/media/758743e7-a2ca-42db-9f43-a45b05b1b077.png",this.NT.imageAltText=Z.a.instance.ga(1729),this.NT.helpId="HID_DataTypes_Wolfram",this.NT.helpText=Z.a.instance.ga(1728)),this.NT.longDescription=this.convertToLinkedEntityManager.EVd(this.WXa.toString()),this.NT.F4g())};a.prototype.ufc=function(qa,fa,ha){if((new H.Range(ha.top,ha.left,ha.bottom===v.a.vh?ha.bottom:ha.bottom+1,ha.right,!0,!1)).xd(qa)){if(fa){if(ha&&ha.nob!==
this.WXa){this.WXa=ha.nob;qa=ha.nob.toString();fa=this.oob?"":this.convertToLinkedEntityManager.EVd(qa);var ia=this.convertToLinkedEntityManager.p7h(qa);this.Mh.afb(this.convertToLinkedEntityManager.AAb(qa),fa,ia,a.rea)}this.dta=ha.nob;this.R4b=ha}return!0}return!1};a.prototype.bX=function(){if(this.convertToLinkedEntityManager){var qa=this.gridView.ha.Qe;if(this.gridBlockManager&&this.gridBlockManager.Vhd){var fa=this.gridView.ha.sa.activeCell,ha=!this.gridBlockManager.Mr(fa),ia=this.gridView.getRangeInformation(this.gridView.Ug);
ia=ak(ia);for(var wa=ia.next();!wa.done;wa=ia.next())if(wa=wa.value,Object(z.a)(N.AutoDetectRange,wa))switch(wa.tXg){case 3:if(this.ufc(fa,!0,wa)){if(1!==qa||ha){this.Px();return}l.ULS.sendTraceTag(537166981,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.iHd();this.Mh.BAa(fa,this.e6);this.kse||(this.kse=!0,this.onAutoDetectUIShown());return}break;case 2:case 1:(M.EwaSettings.ma(473)||M.EwaSettings.ma(474))&&this.FMg.Qfh(wa);break;default:l.ULS.sendTraceTag(537166980,
0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (Invalid LinkedEntityClassifierTrigger used)")}}this.Px()}};a.prototype.Gbg=function(qa){var fa=[29];this.gridView.qb.Wi(qa,fa);this.gridView.qb.qn(fa)};a.prototype.o6a=function(){return this.$.ea.isNamedObjectViewMode&&Q.f(this.$.pa)};a.prototype.iHd=function(){this.oob&&!this.Bic&&this.kr&&(this.kr.jt(w.a.Lb,this.$.domElement,this.onKeyDown,!0),this.kr.jt(w.a.Gd,this.$.domElement,this.onKeyUp,!0),this.Bic=!0)};a.prototype.uOj=function(){this.oob&&this.Bic&&
this.kr&&(this.kr.tt(w.a.Lb,this.$.domElement,this.onKeyDown,!0),this.kr.tt(w.a.Gd,this.$.domElement,this.onKeyUp,!0),this.Bic=!1)};a.qLh=function(qa){return Z.a.instance.ga(1783)+A.a.space+qa};Af.Object.defineProperties(a.prototype,{jc:{configurable:!0,enumerable:!0,get:function(){return this.Mh.domElement(1)}},hBb:{configurable:!0,enumerable:!0,get:function(){var qa=this.Mh.domElement(a.rea);return qa?X.DOMElementExtensions.isVisible(qa):!1}},hwa:{configurable:!0,enumerable:!0,get:function(){return this.$.isEditMode&&
M.EwaSettings.ma(136)&&M.EwaSettings.ma(139)&&(new ca.a(this.$.va)).ij?!1:-1!==this.dta}}});Af.Object.defineProperties(a,{rea:{configurable:!0,enumerable:!0,get:function(){return 1}}});Object(u.a)(a,"AutoDetectManager",r.a,[])},1547:function(u,D,b){function a(m,f,w,n,z){var r=l.call(this)||this;r.$=m;r.Dp=n.w4b(m,f,w,"",d.a.Te(11),z,"AutoDetectPointerDown",e.a.instance.ga(1783)+"...");return r}b.r(D);b.d(D,"AutoDetectActionButton",function(){return a});u=b(0);D=b(79);var c=b(1440),d=b(53),e=b(14),
k=b(21),l=D.a;Rk(a,l);a.prototype.dispose=function(){this.Dp.dispose();this.$=null;l.prototype.dispose.call(this)};a.prototype.domElement=function(m){return this.Dp.domElement(m)};a.prototype.getButton=function(m){return this.Dp.getButton(m,!1)};a.prototype.afb=function(m,f,w,n){this.Dp.uTa(c.a.qLh(m),f,n);this.Dp.Acg(w,f,n)};a.prototype.BAa=function(m,f){var w=k.g(this.$),n=w.eb.gj(m);m=w.gg(m,n);var z=w.Ef(n).jn;if(m&&0<=m.x&&0<=m.y&&z.width>m.width+160){var r=m.bottomRight.x+this.jz,v=m.topLeft.y+
this.jz,A=!1;r+160>z.bottomRight.x&&(r=m.topLeft.x-this.jz,A=!0);if(v<z.topLeft.y+this.jz){if(w.eb.USa){this.hide();return}v=z.topLeft.y+this.jz}this.Dp.v7b(f,n);this.np(r,v,w.rtl,n,A)}else this.hide()};a.prototype.np=function(m,f,w,n,z){this.Dp.np(m,f,w,n,!1,z)};a.prototype.hide=function(){this.Dp.hide()};Af.Object.defineProperties(a.prototype,{jz:{configurable:!0,enumerable:!0,get:function(){return this.Dp.jz}}});Object(u.a)(a,"AutoDetectActionButton",D.a,[])},1653:function(u,D,b){function a(X){var Z=
Q.call(this)||this;Z.hi=null;Z.Wg=null;Z.$=X;Z.Eb();return Z}function c(X,Z,ea){var ka=H.call(this,X)||this;ka.mu=0;ka.rp=!1;ka.Fc=function(){ka.$f(!1)};ka.$=Z;ka.taskPaneManager=ea;U.a(Z).Oh(ka);ka.$.Ck(ka.Fc);M.a.ud(ka.$)&&(ka.isVisible=!1);return ka}function d(X){var Z=E.call(this)||this;Z.$=X;Z.Eb();return Z}function e(X){return y.call(this,X)||this}function k(X,Z){this.$=Z;this.convertToLinkedEntityManager=X}b.r(D);u=b(0);var l=b(905),m=b(15),f=b(5),w=b(76),n=b(37),z=b(1),r=b(186),v=b(21),A=
b(187);k.prototype.Lc=function(X,Z){switch(Z){case -1203788282:case 48568533:case -1662108744:return X=v.g(this.$),Z=this.convertToLinkedEntityManager.Gzi||7E3,(null===X||void 0===X?0:X.ha)&&X.ha.sa.Vc.aM>Z?!0:!1;default:return!1}};k.prototype.executeCommand=function(X,Z,ea){X=n.TaskExtensions.jk();Z=Z.command;switch(Z){case -1203788282:this.convertToLinkedEntityManager.b3g(ea[w.a.Nc].toString());break;case 311599363:this.convertToLinkedEntityManager.convertLinkedEntityToText();break;case 439914789:this.convertToLinkedEntityManager.refreshLinkedEntitiesInRange();
break;case 2127195269:this.convertToLinkedEntityManager.launchDisambiguationPaneForSearch();break;case -1662108744:this.convertToLinkedEntityManager.launchLinkedEntityDataTypeSelectorPane(ea[w.a.Nc].toString());break;case 1266950951:this.convertToLinkedEntityManager.Qqi();break;case 49813714:this.convertToLinkedEntityManager.convertToLinkedEntityFromAutoDetect();break;case -1081442996:z.EwaSettings.ma(657)&&this.convertToLinkedEntityManager.oKe();break;case 1702917262:z.EwaSettings.ma(657)&&this.convertToLinkedEntityManager.showHelpArticle(f.a.NPj);
break;case -90814711:z.EwaSettings.ma(657)&&this.convertToLinkedEntityManager.showUntrustedImageBusinessBarIfNecessary();break;case 48568533:case -1027730316:if(48568533===Z||ea[w.a.zjf]&&"ConvertToLinkedEntityGallery"===ea[w.a.zjf].toString())m.ULS.sendTraceTag(559982275,0,50,"ConvertToLinkedEntityCommandHandler.ExecuteCommand() - Expanding data types preview gallery"),A.a("ExpandDataTypeGallery");break;default:X=r.a(Z)}return X};k.prototype.Ac=function(X,Z){switch(Z.command){case -1203788282:case 439914789:case 2127195269:case 49813714:return z.EwaSettings.ma(131);
case -1081442996:case 1702917262:case -90814711:return z.EwaSettings.ma(657);case 48568533:case -1027730316:case -1662108744:case 311599363:case 1266950951:return!0;default:return!1}};k.prototype.Qc=function(X,Z,ea){return"PopulateConvertToLinkedEntityMenu"===Z&&z.EwaSettings.ma(131)?this.convertToLinkedEntityManager.Qc(X,Z,ea):!1};Object(u.a)(k,"ConvertToLinkedEntityCommandHandler",null,[403]);var B=b(493),y=l.a;Rk(e,y);e.prototype.zd=function(){var X=this;B.a(this.$,271,272,this.hb,function(Z){X.jd([new k(Z,
X.$)])})};e.ka=function(X){l.a.Qd(273,new e(X))};Object(u.a)(e,"ConvertToLinkedEntityCommandHandlerFactory",l.a,[]);D=b(232);var x=b(971),C=b(51),G=b(441),E=D.a;Rk(d,E);d.prototype.create=function(){var X=this,Z=C.GetServiceTaskFactory.create(this.$.da,102,this.$.la,this.hb),ea=C.GetServiceTaskFactory.Ra(this.$.da,5,4,this.hb),ka=C.GetServiceTaskFactory.Ra(this.$.da,388,387,this.hb);if(this.$.Fl)n.TaskExtensions.Ba(n.TaskExtensions.Wd([Z,ea,ka],this.la),function(){X.pb(X.$.da.za(271)||new x.ConvertToLinkedEntityManager(X.$,
Z.result,ka.result,null,null,ea.result))},this.$.la,3);else{var Y=C.GetServiceTaskFactory.Ra(this.$.da,257,258,this.hb),qa=G.a(this.$);n.TaskExtensions.Ba(n.TaskExtensions.Wd([Z,Y,qa,ea,ka],this.la),function(){X.pb(X.$.da.za(271)||new x.ConvertToLinkedEntityManager(X.$,Z.result,ka.result,Y.result,qa.result,ea.result))},this.$.la,3)}};d.ka=function(X){X.da.Ga(272,new d(X))};Object(u.a)(d,"ConvertToLinkedEntityManagerFactory",D.a,[]);var I=b(244),U=b(273),M=b(36),T=b(256),F=b(12),K=b(913),J=b(18),O=
b(70),N=J.a.Fth,H=I.a;Rk(c,H);c.prototype.rP=function(X){this.get_events().addHandler("EnrichmentTaskPaneRemoved",X)};c.prototype.IR=function(X){this.get_events().removeHandler("EnrichmentTaskPaneRemoved",X)};c.prototype.$D=function(X){this.addHandler("EnrichmentTaskPaneVilibilityChanged",X)};c.prototype.GF=function(X){this.removeHandler("EnrichmentTaskPaneVilibilityChanged",X)};c.prototype.OFg=function(X){this.addHandler("EnrichmentTaskPaneOnFocus",X)};c.prototype.Tbj=function(X){this.removeHandler("EnrichmentTaskPaneOnFocus",
X)};c.prototype.uH=function(){};c.prototype.Yo=function(){return this.rp};c.prototype.Rr=function(){return this.rp};c.prototype.tR=function(){};c.prototype.dispose=function(){this.$&&this.$.Ol(this.Fc);this.taskPaneManager=this.$=null;H.prototype.dispose.call(this)};c.prototype.Uf=function(X,Z){Z||this.raiseEvent("EnrichmentTaskPaneOnFocus");return!Z};c.prototype.$g=function(X){return F.DOMElementExtensions.nf(this.jc,X)};c.prototype.hj=function(){};c.prototype.Dj=function(){};c.prototype.$f=function(X){this.rp=
X;var Z=this.taskPaneManager;this.isVisible=X;M.a.ud(this.$)?X?this.taskPaneManager.s6("EnrichmentTaskPane",this.XF):this.taskPaneManager.hideTaskPane("EnrichmentTaskPane"):(X&&0<Z.Sz.length&&(!Z.yg||10!==Z.yg.taskPane.Og||Z.isCollapsed)&&Z.MF(this,!0),Z.Pw());X||(v.g(this.$).Uf(!0,!1),this.$.jf())};c.prototype.HQ=function(){return!1};c.ka=function(X,Z){var ea=X.yb,ka=document.getElementById(ea+f.a.LKe);ka||(ka=K.a("div",X.yb+f.a.LKe,"cui-taskpane"),M.a.ud(X)||(ea=document.getElementById(ea+f.a.nR),
void 0!==ea&&null!==ea?ea.appendChild(ka):m.ULS.sendTraceTag(537166720,0,10,"EnrichmentTaskPane.Attach: couldn't find novTaskPaneBodyDiv. IsAppUnloading: {0}",X.cF)));ea=X.da;return ea.za(257)||ea.Ga(257,new c(ka,X,Z))};Af.Object.defineProperties(c.prototype,{isVisible:{configurable:!0,enumerable:!0,get:function(){return Object(O.a)(c.prototype,this,"isVisible")},set:function(X){Object(O.b)(c.prototype,this,"isVisible",X);this.raiseEvent("EnrichmentTaskPaneVilibilityChanged")}},canReceiveFocus:{configurable:!0,
enumerable:!0,get:function(){return this.isVisible}},Zd:{configurable:!0,enumerable:!0,get:function(){return T.a.Jkh}},Og:{configurable:!0,enumerable:!0,get:function(){return 10}},Kk:{configurable:!0,enumerable:!0,get:function(){return N}},PM:{configurable:!0,enumerable:!0,get:function(){return this.titleText}},titleText:{configurable:!0,enumerable:!0,get:function(){return"Enrichment"}},qo:{configurable:!0,enumerable:!0,get:function(){return 300}},isResizable:{configurable:!0,enumerable:!0,get:function(){return!1}},
jc:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},height:{configurable:!0,enumerable:!0,get:function(){return this.taskPaneManager.uO.offsetHeight}},XF:{configurable:!0,enumerable:!0,get:function(){var X=this;return this.taskPaneManager.Dua(this.jc,this.titleText,this.qo,this.isResizable,function(){X.isVisible=!0},function(){X.isVisible=!1},function(){X.isVisible=!0},function(){X.isVisible=!1},this.qo)}}});Object(u.a)(c,"EnrichmentTaskPane",I.a,[958,10,537,422]);var Q=D.a;
Rk(a,Q);a.prototype.create=function(){var X=this,Z=C.GetServiceTaskFactory.create(this.$.da,203,this.la,this.hb),ea=C.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb);n.TaskExtensions.Ba(n.TaskExtensions.ts(n.TaskExtensions.Wd([Z,ea],this.la),function(){return X.$C},this.la),function(){X.pb(X.Wg)},this.la,3)};a.prototype.dispose=function(){this.Wg=this.hi=this.$=null;Q.prototype.dispose.call(this)};a.ka=function(X){X.da.Ga(258,new a(X))};Af.Object.defineProperties(a.prototype,{$C:{configurable:!0,
enumerable:!0,get:function(){var X=this;this.hi||(this.hi=n.TaskExtensions.Ba(G.a(this.$),function(Z){X.Wg=c.ka(X.$,Z.result)},this.la,3));return this.hi}}});Object(u.a)(a,"EnrichmentTaskPaneFactory",D.a,[]);var ca=b(11);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.Enrichment");(function(){ca.a.Fa(function(X){a.ka(X);d.ka(X);e.ka(X)})})()},971:function(u,D,b){function a(Ta,pa,Da,rb,Ab,ob){var sb=$a.call(this)||this;sb.Uld=null;sb.y6a=null;sb.Xod=null;sb.Yod=null;sb.Vqd=null;sb.hqd=
null;sb.zgf=null;sb.z4a=0;sb.jDb=0;sb.pwb=0;sb.Tba=null;sb.emd=!1;sb.lLd=null;sb.Tm=null;sb.nbd=null;sb.Ur=0;sb.yY=null;sb.VZj=null;sb.DKa=8;sb.POa=!1;sb.ycf=!1;sb.Ujf=!1;sb.lZc=!1;sb.lSe=null;sb.tVe=null;sb.Rya=null;sb.hXc=0;sb.UMg=5;sb.e0b=3E4;sb.X9f=!1;sb.X9=null;sb.lia=Array(5);sb.sXd=!1;sb.wbg=!1;sb.Fsd=0;sb.yTf=0;sb.hae=null;sb.N3f=!0;sb.Uc=function(Pb,Aa){Aa.dc&&!Aa.Phc&&sb.showUntrustedImageBusinessBarIfNecessary()};sb.XLi=function(Pb){if(Pb.Result){var Aa=Pb.Result;if(Aa&&Aa.length){y.ULS.sendTraceTag(537166922,
0,50,"OnGetRichDataClassificationLabelsSuccess: Received {0} labels",Aa.length);var Ya=db.GetServiceTaskFactory.Ra(sb.$.da,274,275,0);nb.TaskExtensions.Ba(Ya,function(){Ya.result.ZWc(Aa,2)||y.ULS.sendTraceTag(537166921,0,10,"OnGetRichDataClassificationLabelsSuccess - Failed to apply the policy label.")},sb.$.la,3)}}else y.ULS.sendTraceTag(537166923,0,50,"OnGetRichDataClassificationLabelsSuccess: Received no result")};sb.Sf=function(){sb.bzb&&(sb.OMj(),sb.F2h(sb.$.ea.lo.LinkedEntityAsyncRefreshStateId));
sb.F6a?sb.H3h(sb.$.ea.lo.RichDataClassificationLabelStateId):sb.Q5a&&sb.FWd(!0)};sb.CJi=function(){sb.sXd=!0;sb.Tm&&sb.Tm.a7i()};sb.qLi=function(Pb){if(Pb&&!P.a(Pb))try{Pb.Result.HasUntrustedImageUrl&&(sb.businessBar.Jf(58,null),sb.wbg=!0)}catch(Aa){y.ULS.sendTraceTag(574718945,0,10,"ConvertToLinkedEntityManager.OnGetHasUntrustedImageUrlsFromServerSuccess: GetHasUntrustedImageUrls encountered exception {0}.",Aa)}};sb.ujf=function(){if(!sb.Ujf&&sb.syb()&&!sb.Tmd())if(yb.a("DataTabActive"),bb.a.rg.ZQ)if(document.querySelector("#ConvertToLinkedEntityGallery-previewExpandButton")){var Pb=
sb.f4b();if(Pb){var Aa={};Aa.InputMethod=Ea.a.Cb;Aa.CalloutName=8;Aa.Target="[data-unique-id=Ribbon-ConvertToLinkedEntityGallery-previewExpandButton]";sb.$.Ka.Kb(Pb,Aa);sb.Ujf=!0}else y.ULS.sendTraceTag(537166880,0,10,"RibbonCommandInfo is null for LinkedEntityGalleryCallout")}else y.ULS.sendTraceTag(537166881,0,10,"Could not locate anchor for the LinkedEntityGalleryCallout");else y.ULS.sendTraceTag(537166882,0,50,"ConvertToLinkedEntityManager:LaunchLinkedEntityGalleryCallout() - Attempted to launch linked entity gallery callout but callout not enabled")};
sb.xIi=function(Pb){W.a.Rg(Pb.Errors)||(sb.F6a||sb.FWd(!1),sb.raiseEvent("LinkedEntityConverted"))};sb.xSi=function(){sb.$.da.Za(211,function(Pb){Pb.readText(Ka.a.instance.ga(1788))})};sb.Yc=function(Pb,Aa){y.ULS.sendTraceTag(537166867,0,50,"ConvertToLinkedEntityManager.OnWorkbookOpened called");Aa.zV?y.ULS.sendTraceTag(537166865,0,15,"ConvertToLinkedEntityManager.OnWorkbookOpened called while rendering cached content"):(sb.$.isEditMode?sb.jxe():sb.Ofj(),La.EwaSettings.ma(657)&&sb.sXd&&sb.oKe())};
sb.yLi=function(Pb){sb.f2b();if(Pb.Result){Pb=Pb.Result;var Aa=Pb.DomainDataArray;sb.Tba=Pb.Ribbon;if(sb.Wwa&&sb.Tba){var Ya={};Ya.Name=Ka.a.instance.ga(1778);Ya.DomainIds=sb.gK;Array.insert(sb.Tba.Categories,a.M7a,Ya)}0<Pb.MaximumCellsToConvert&&(sb.hae=Pb.MaximumCellsToConvert);sb.Ur=2;Pb=!1;if(Aa){y.ULS.sendTraceTag(39949271,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received {0} domains",Aa.length);sb.iNa||(sb.iNa=[]);Ya=Ka.a.instance.ga(1775);var kb=Ka.a.instance.ga(1777);Aa=ak(Aa);for(var lb=
Aa.next();!lb.done;lb=Aa.next())if(lb=lb.value,lb.DomainId)if(sb.iNa.push(lb),lb.DomainBlocked){var ac=!!lb.DomainId.StringId;y.ULS.sendTraceTag(537166861,0,50,"Domain: {0} is telemetry only, do not show in menu (Has String ID: {1})",ac?lb.DomainId.Id.toString():lb.Name,ac)}else sb.AU.ia(a.q1a(lb.DomainId),lb),lb.Name===Ya||268435456===lb.DomainId.Id?sb.lSe=lb.DomainId.Id.toString():lb.Name===kb||536870912===lb.DomainId.Id?sb.tVe=lb.DomainId.Id.toString():268435712===lb.DomainId.Id&&lb.ShowInRibbon&&
(sb.lZc=!0),Pb=!0;else y.ULS.sendTraceTag(537166862,0,10,"OnGetLinkedEntityServiceDomainsSuccess: DomainId is null.")}Pb||(sb.iNa=null);sb.hcg();sb.mpd&&sb.lLd.fVh();sb.X9f||(sb.KMj(),sb.X9f=!0)}else sb.iNa=null,sb.Ur=3,-1<sb.DKa&&window.setTimeout(function(){sb.E$a()},100*(8-sb.DKa)),y.ULS.sendTraceTag(537166863,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received no result");sb.xrc();sb.jDe();sb.lZc&&sb.Ndf&&wc.b(sb.ujf,sb.$.la,500);sb.Q5a&&!sb.F6a&&sb.FWd(!0)};sb.xLi=function(Pb){Pb=Va.a.Of(Pb.data);
y.ULS.sendTraceTag(34415007,0,15,"OnGetLinkedEntityServiceDomainsFailure [Errors: {0}].",W.a.Dc(Pb));sb.iNa=null;sb.Ur=3;sb.POa=!0;sb.xrc()};sb.onContentReady=function(){sb.gag()&&sb.gridView.Fw(sb.onContentReady);sb.N3f&&sb.$.workbookContext.Options&1048576&&(sb.businessBar.DBj(),sb.N3f=!1)};sb.Ri=function(){sb.f2b()};sb.bOi=function(Pb){if(P.a(Pb)){var Aa=db.GetServiceTaskFactory.Ra(sb.$.da,5,4,0);nb.TaskExtensions.Ba(Aa,function(){var kb=null;if(null===Pb||void 0===Pb?0:Pb.Errors)kb=Pb.Errors[0];
Aa.result.u3f(kb,null)},sb.$.la,3);y.ULS.sendTraceTag(537166800,0,15,"ConvertToLinkedEntityManager.OnLinkedEntityTryAutoRefreshSuccessCore. LinkedEntityTryAutoRefresh returned with errors [Errors: {0}].",W.a.Dc(Pb.Errors));var Ya=W.a.CF(Pb.Errors,[-1100324317,-2133389873],"ConvertToLinkedEntityManager:OnLinkedEntityTryAutoRefreshSuccessCore");sb.$.ea.kp(Ya)}};sb.cZc=function(){y.ULS.sendTraceTag(537166796,0,50,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck. Checking after a {0} millisecond interval",
sb.e0b);sb.eaf("Periodic auto-refresh check",sb.OGi,sb.NGi)};sb.OGi=function(Pb){P.a(Pb)?(y.ULS.sendTraceTag(537166795,0,15,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. LinkedEntityTryAutoRefresh returned with errors [Errors: {0}].",W.a.Dc(Pb.Errors)),++sb.hXc):sb.hXc=0;x.a.Ia(sb.Rya);sb.hXc>=sb.UMg?(y.ULS.sendTraceTag(537166794,0,10,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Failed too many consecutive times. Will stop trying to auto-refresh"),sb.Rya=
null):(y.ULS.sendTraceTag(537166793,0,50,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Re-creating periodicAutoRefreshCheckContext"),sb.Rya=zb.a.instance.create(sb.cZc,sb.e0b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck"))};sb.NGi=function(Pb){Pb=Va.a.Of(Pb.data);C.a.uh(Pb)?y.ULS.sendTraceTag(537166791,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed with an HTTP error"):y.ULS.sendTraceTag(537166792,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed [Errors: {0}].",
W.a.Dc(Pb));x.a.Ia(sb.Rya);sb.Rya=zb.a.instance.create(sb.cZc,sb.e0b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")};sb.dPi=function(Pb){Pb=!!Pb.Result&&Pb.Result;y.ULS.sendTraceTag(537166790,0,50,"OnNotifyFeatureLicensingStatusSuccess- operationSucceeded? = {0}",Pb.toString());Pb?(y.ULS.sendTraceTag(537166789,0,50,"OnNotifyFeatureLicensingStatusSuccess- successful handshake duration = {0} ms, retry count = {1}",ma.a.Ta.Xd.m-sb.z4a,sb.jDb),sb.E$a()):sb.oyc()};sb.cPi=function(){y.ULS.sendTraceTag(537166788,
0,15,"OnNotifyFeatureLicensingStatusFailed");sb.oyc()};sb.oQi=function(Pb){Pb=!!Pb.Result&&Pb.Result;y.ULS.sendTraceTag(537166731,0,50,"OnRefreshHandshakeSuccess- operationSucceeded? = {0}",Pb.toString());Pb?(y.ULS.sendTraceTag(537166730,0,50,"OnRefreshHandshakeSuccess- successful handshake duration = {0} ms, retry count = {1}",ma.a.Ta.Xd.m-sb.z4a,sb.pwb),sb.E$a()):sb.OMf()};sb.nQi=function(){y.ULS.sendTraceTag(570769947,0,15,"OnRefreshHandshakeFailed");sb.OMf()};sb.aLi=function(Pb){Pb.Result?(Pb=
Pb.Result)?(sb.bId(),sb.businessBar.u3f(null,Pb)):y.ULS.sendTraceTag(537166725,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result"):y.ULS.sendTraceTag(537166726,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result")};sb.$=Ta;sb.businessBar=ob;sb.svgIconProvider=Da;sb.iNa=[];sb.gK=[];sb.gridView=mb.g(sb.$);sb.cdc=-1;sb.nji=La.EwaSettings.isChangeGateEnabled("OfficeVSO:4294127_LongButtonVisibleWhenAnyDomainOverrideShowsInRibbon");sb.Q5a=sb.$.ma(442)&&sb.$.ma(292);
sb.F6a=sb.$.ma(679);sb.bzb=La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityAutoRefresh",!1);sb.Wwa=sb.$.ma(678);sb.mpd=sb.Wwa&&La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReadAndWriteRecentlyUsedListToTheRoamingService",!1);sb.Ndf=La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityGalleryTeachUIEnabled",!1);sb.AU=new Ja.a;sb.t8a=new d(Ta,pa,sb);rb&&(sb.Tm=new e(Ta,rb,Ab,sb,sb));sb.$.Tk(sb.Yc);N.a(sb.$)&&N.a(sb.$).Zoj(sb);sb.jxe();(sb.bzb||
sb.Q5a||sb.F6a)&&sb.$.ea.Bu(sb.Sf);La.EwaSettings.ma(131)&&La.EwaSettings.ma(139)&&(sb.gag()||sb.gridView.Ft(sb.onContentReady));sb.$.xA(sb.Ri);La.EwaSettings.ma(657)&&(sb.$.ea.Wj(sb.Uc),sb.showUntrustedImageBusinessBarIfNecessary());sb.mpd&&(sb.lLd=new c(sb.$,sb));return sb}function c(Ta,pa){var Da=this;this.nid=this.vid=!1;this.fQi=function(rb){y.ULS.sendTraceTag(537166680,0,50,"OnReadRoamingStringSuccess called.");Da.vid=!0;if(W.a.Rg(rb.Errors))y.ULS.sendTraceTag(537166679,0,10,"OnReadRoamingStringSuccess encountered an error. Errors: {0}",
W.a.Dc(rb.Errors));else{var Ab=0,ob=[],sb=!1;try{if(!rb.Result)return;var Pb=rb.Result;if(!Pb){y.ULS.sendTraceTag(537166678,0,50,"OnReadRoamingStringSuccess - Received an empty roamingXml.");return}ob=Da.PWi(Pb);if(!ob||!ob.length)return;Ab=ob.length;Da.Zzi(ob);Da.Qza.mSf();y.ULS.sendTraceTag(537166677,0,50,"OnReadRoamingStringSuccess MruCount:{0}",Da.Qza.XGb.length);if(La.EwaSettings.isChangeGateEnabled("OfficeVSO:5199912_LinkedEntityMruWolfram")){for(var Aa=ak(Da.Qza.XGb),Ya=Aa.next();!Ya.done;Ya=
Aa.next())if(1===(Ya.value.Id&1048320)>>8){sb=!0;break}y.ULS.sendTraceTag(537166676,0,50,"OnReadRoamingStringSuccess MruWolframAvailable:{0}",sb)}}finally{y.ULS.sendTraceTag(537166675,0,50,"ParseRecentlyUsedLinkedDataTypes returned {0} data types.",Ab),rb=[],rb.push(Object(fb.a)(new qb.a,{name:"MruCount",int64:Ab})),rb.push(Object(fb.a)(new qb.a,{name:"MruWolframAvailable",bool:sb})),yb.a("ReadRecentlyUsedLinkedDataTypes",void 0,void 0,rb)}Da.nid&&(Da.tgg(Da.Qza.XGb),Da.nid=!1)}};this.uUi=function(rb){y.ULS.sendTraceTag(537166674,
0,50,"OnWriteRoamingStringSuccess called.");W.a.Rg(rb.Errors)?y.ULS.sendTraceTag(537166673,0,10,"OnWriteRoamingStringSuccess encountered an error. Errors: {0}",W.a.Dc(rb.Errors)):rb.Result&&(rb.Result||y.ULS.sendTraceTag(537166672,0,15,"OnWriteRoamingStringSuccess - Failed to write to the roaming service."))};this.fBf=function(rb,Ab,ob){rb=Va.a.Of(rb.data);y.ULS.sendTraceTag(537166671,0,10,"OnRoamingOperationFailure: Encountered errors for {0}. Errors: {1}.",ob,W.a.Dc(rb))};this.$=Ta;this.Qza=pa}
function d(Ta,pa,Da){this.Wjf=2;this.Vjf="Size64by48";this.$=Ta;this.Va=pa;this.convertToLinkedEntityManager=Da;this.Wwa=La.EwaSettings.ma(678)}function e(Ta,pa,Da,rb,Ab){var ob=this;this.Ata=this.wHe=!1;this.$bb=this.xwa=!0;this.dFb=this.fLb=!1;this.sdb=null;this.dpc=0;this.pR=function(){(ob.$bb||ob.Ata)&&2!==ob.dpc&&(ob.dFb||ob.hsd(!1))};this.Uc=function(){y.ULS.sendTraceTag(537166944,0,15,"Session ID changed while ambiguous linked entities are present")};this.vg=function(){(ob.$bb||ob.Ata)&&ob.hsd(!1)};
this.Ymc=function(sb,Pb){W.a.Rg(sb.Errors)?y.ULS.sendTraceTag(36975688,0,10,"Failed to retrieve disambiguation data for Ambiguous Linked Entity. errors: {0}",W.a.Dc(sb.Errors)):sb.Result&&(sb=sb.Result,sb.DisambiguationJson?(ob.fLb=!1,ob.LZf(Pb),ob.sdb=sb.SkydanceFeatureBitmask,Pb=sb.DisambiguationJson,y.ULS.sendTraceTag(537166940,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Calling LaunchOrUpdateDisambiguationPane"),ob.dFb=!1,ob.xjf(Pb)):y.ULS.sendTraceTag(537166941,
0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Json is null"))};this.XKi=function(sb,Pb){W.a.Rg(sb.Errors)?y.ULS.sendTraceTag(36975689,0,10,"Failed to retrieve disambiguation data for search. errors: {0}",W.a.Dc(sb.Errors)):sb.Result&&(sb=sb.Result,sb.DisambiguationJson?(ob.LZf(Pb),ob.sdb=sb.SkydanceFeatureBitmask,Pb=sb.DisambiguationJson,y.ULS.sendTraceTag(537166938,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Calling LaunchOrUpdateDisambiguationPane"),
ob.dFb=!0,ob.xjf(Pb)):y.ULS.sendTraceTag(537166939,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Json is null"))};this.DOi=function(sb){W.a.Rg(sb.Errors)?(y.ULS.sendTraceTag(36975690,0,10,"Failed to move to the next ambiguous Linked Entity. errors: {0}",W.a.Dc(sb.Errors)),ob.$bb=!0):sb.Result&&(sb=sb.Result,ob.sdb=sb.SkydanceFeatureBitmask,ob.dwd(sb),ob.fLb=!0)};this.uRi=function(sb){W.a.Rg(sb.Errors)&&y.ULS.sendTraceTag(36975691,0,10,"Failed to select Linked Entity for Disambiguation.. errors: {0}",
W.a.Dc(sb.Errors));sb.Result?(ob.dwd(sb.Result),ob.fLb=!0):ob.Dsa()};this.yBf=function(sb){W.a.Rg(sb.Errors)?y.ULS.sendTraceTag(36975692,0,15,"Failed to retrieve data for searching in Disambiguation Pane.  Error id names: {0}",W.a.Dc(sb.Errors)):sb.Result?ob.F7b.sBc(sb.Result,null):(y.ULS.sendTraceTag(537166927,0,50,"ConvertToLinkedEntityDisambiguationPane:OnSearchLinkedEntitySucceeded: Calling CloseDisambiguationPane"),ob.Dsa())};this.lNi=function(sb){W.a.Rg(sb.Errors)?y.ULS.sendTraceTag(537166926,
0,15,"Failed to insert starter data table. Error id names: {0}",W.a.Dc(sb.Errors)):ob.Dsa()};this.$=Ta;this.gridView=mb.g(this.$);this.gridView.ha.sP(this.vg);this.gridView.Ft(this.pR);this.mLe=rb;this.convertToLinkedEntityManager=Ab;ya.a.ud(this.$)||Da.MQ(pa);Ta=new w(pa);this.F7b=new m(Ta);M.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(sb){sb.isFeatureEnabled("mso_sendASmile",!0).then(function(Pb){ob.xwa=Pb;return null})})}function k(){this.market=
this.appCorrelationId=this.sessionId=this.anid=this.applicationVersion=this.applicationName=null;this.featuresBitMask=this.themeId=0;this.disambiguationJson=this.uiLanguage=null}function l(Ta){this.campaignId=this.commentQuestion=null;this.isZeroBased=!1;this.ratingValuesAscending=this.ratingQuestion=this.aditionalDataRequested=null;this.showPrompt=this.showEmailRequest=!1;this.surveyType=0;this.title=null;this.campaignId=Ta;this.commentQuestion=Ka.a.instance.lb(194);this.isZeroBased=!1;this.aditionalDataRequested=
["EmailAddress"];this.ratingQuestion=Ka.a.instance.lb(190);this.ratingValuesAscending=[Ka.a.instance.lb(191),Ka.a.instance.lb(192),Ka.a.instance.lb(193)];this.showPrompt=!1;this.showEmailRequest=!0;this.surveyType=4;this.title=Ka.a.instance.lb(189)}function m(Ta){return f.call(this,Ta)||this}function f(Ta){this.Fy=null;this.gfa=Ta}function w(Ta){var pa=n.call(this,G.AFrameworkApplication.ta.yy,G.AFrameworkApplication.ta.pt,G.AFrameworkApplication.ta.dea,G.AFrameworkApplication.ta.ye,G.AFrameworkApplication.ub)||
this;pa.taskPane=Ta;pa.taskPane.OFg(Object(T.a)(pa,pa.MYf,"setFocusOnIFrame"));return pa}function n(Ta,pa,Da,rb,Ab){this.Nq=this.Vj=this.t7d=this.s7d=this.Bv=this.vu=null;this.Xw=!1;this.oi=Ta;this.Yd=pa;this.cP=Da;this.Vb=rb;this.La=Ab;this.Jpa=Qa.KeyInputManager.kl(wa.a.JBa,0)}function z(Ta,pa,Da){Ta=r.call(this,Ta,pa)||this;Ta.telemetryJson=null;Ta.telemetryJson=Da;return Ta}function r(Ta,pa){Ta=v.call(this,Ta)||this;Ta.messageContent=null;Ta.messageContent=pa;return Ta}function v(Ta){this.messageType=
0;this.messageType=Ta}function A(){}function B(Ta,pa,Da,rb,Ab,ob,sb,Pb,Aa,Ya,kb){kb=Ta.Na(1,void 0===kb?null:kb);kb.selectedRanges=pa;kb.isChangeObject=Da;kb.isFloodgateEnabled=rb;kb.isStarterData=Ab;kb.starterDataDomainId=ob;return ea.g(Ta,"GetDataSelectorPaneData",kb,sb,Pb,Aa,Ya,4)}b.r(D);u=b(0);var y=b(15),x=b(90),C=b(279),G=b(4),E=b(30),I=b(1025),U=b(142),M=b(84),T=b(83),F=b(85),K=b(38),J=b(18),O=b(5),N=b(168),H=b(1440),Q=b(1443),ca=b(178),X=b(619),Z=b(358),ea=b(61),ka=b(913),Y=b(1001);A.j7h=
"EnrichmentContentFrame";A.width=320;Object(u.a)(A,"EnrichmentConstants",null,[]);Object(u.a)(v,"EnrichmentResponseMessage",null,[]);Rk(r,v);Object(u.a)(r,"EnrichmentResponseMessageWithContent",v,[]);Rk(z,r);Object(u.a)(z,"EnrichmentResponseMessageWithContentAndTelemetryData",r,[]);var qa=b(274),fa=b(13),ha=b(96),ia=b(43),wa=b(86),Qa=b(109),S=b(41),da=b(81),xa=b(25),ta=b(107),ab=b(906),Na=b(27);n.prototype.dispose=function(){this.YKb&&this.Nq&&(this.oi.Aa(fa.a.click,this.Nq,Object(T.a)(this,this.Sj,
"onClosePaneClick")),this.Yd.Aa(fa.a.Gd,this.Nq,Object(T.a)(this,this.fyf,"onKeyHide")));this.Nq=null;this.Bv&&(this.cPj(),this.Bv.parentNode.removeChild(this.Bv),this.Bv=null);this.Vb.mi("EnrichmentPaneId").hk(this.Jpa)};n.prototype.show=function(Ta,pa,Da){this.vu=Ta;this.Xw||(this.Vj=this.o0a(),this.wQa.appendChild(this.Vj),this.m8i(),this.La.Mb(Na.a.Kye,ta.a.frame,Object(T.a)(this,this.W1h,"handleEscapeKeyAction")),this.xRa(),this.Xw=!0);this.Bv.src=this.Lsb&&this.Lsb.length?this.Lsb+"?culture="+
pa.market+"&appName="+pa.applicationName+"&themeId="+pa.themeId+"&featuresBitMask="+pa.featuresBitMask:n.Urf;this.s7d=pa;this.t7d=Da;this.hdb()};n.prototype.sBc=function(Ta,pa){Ta=new z(2,Ta,pa);this.Spc(Ta)};n.prototype.xRa=function(){var Ta=this.Vb.mi("EnrichmentPaneId");Ta.parent=qa.AFrame.GNa;this.oi.Lmb("EnrichmentPaneId",this.Vj);Ta.bindAction(this.Jpa,Na.a.Kye)};n.prototype.MYf=function(){if(this.Bv){ha.FocusManager.moa(this.Bv.contentWindow);var Ta=new z(4,null,null);this.Spc(Ta)}};n.prototype.Sj=
function(){this.y2b();return!0};n.prototype.fyf=function(Ta){Ta=Ta.Ca.keyCode;return Ta===Sys.UI.Key.enter||Ta===Sys.UI.Key.space?(this.y2b(),!0):!1};n.prototype.y2b=function(){this.hide();if(this.vu)this.vu.onPaneClosed()};n.prototype.o0a=function(){var Ta=ka.a("div","EnrichmentPaneId","EnrichmentPane");this.YKb&&Ta.appendChild(this.b3c());this.Y$h(Ta);return Ta};n.prototype.b3c=function(){var Ta=ka.b("div","EnrichmentPaneHeaderId","EnrichmentPaneHeader"),pa=ka.b("div","EnrichmentPaneTitleId","cui-taskPaneTitle EnrichmentPaneTitle");
pa.innerText=CommonUIStrings.l_EnrichmentPaneTitle;pa.title=CommonUIStrings.l_EnrichmentPaneTitle;var Da=Y.a.nb("CloseEnrichmentPane","EnrichmentPaneCloseButton",CommonUIStrings.l_Close,"ClosePaneGlyph_16x16x32",!1);this.oi.qa(fa.a.click,Da,Object(T.a)(this,this.Sj,"onClosePaneClick"));this.Yd.qa(fa.a.Gd,Da,Object(T.a)(this,this.fyf,"onKeyHide"));Ta.appendChild(pa);Ta.appendChild(Da);this.Nq=Da;return Ta};n.prototype.Y$h=function(Ta){this.Bv=ka.b("iframe","","EnrichmentFrame");Ta.appendChild(this.Bv);
this.Bv.id=A.j7h;this.Bv.setAttribute("role","presentation")};n.prototype.m8i=function(){ia.a.addHandler(this.Bv,"load",Object(T.a)(this,this.Ixf,"onIFrameLoad"));ia.a.addHandler(this.Bv,"error",Object(T.a)(this,this.dnc,"onIFrameError"));$addHandler(window,"message",Object(T.a)(this,this.Jxf,"onIFrameMessage"))};n.prototype.cPj=function(){ia.a.removeHandler(this.Bv,"load",Object(T.a)(this,this.Ixf,"onIFrameLoad"));ia.a.removeHandler(this.Bv,"error",Object(T.a)(this,this.dnc,"onIFrameError"));$removeHandler(window,
"message",Object(T.a)(this,this.Jxf,"onIFrameMessage"))};n.prototype.Mbh=function(){this.Bv.src=n.Urf};n.prototype.hide=function(){this.Fdc();this.Mbh()};n.prototype.W1h=function(Ta,pa,Da){if(1!==Da&&(this.hide(),this.vu))this.vu.onPaneClosed();return 32};n.prototype.Ixf=function(){};n.prototype.dnc=function(){};n.prototype.Jxf=function(Ta){Ta=Ta.rawEvent;if(!this.Bv||-1!==this.Bv.src.indexOf(Ta.origin)){try{var pa=S.a(Ta.data)}catch(Da){return}if(!ab.c(pa.messageType)){Ta=window.g_badCastCallback;
window.g_badCastCallback=null;switch(pa.messageType){case 2:this.Spc(new z(1,S.c(this.s7d),this.t7d));break;case 1:this.Spc(new r(0,this.KHh()));break;case 3:this.vu&&this.vu.selectEntity(pa.messageContent);break;case 5:this.vu&&this.vu.FCb(pa.messageContent);break;case 8:this.vu&&(pa=S.a(pa.messageContent),0<pa.DomainId?this.vu.lMd(pa.Query,pa.TelemetryJson,pa.DomainId,pa.DomainIdString):this.vu.searchEntity(pa.Query,pa.TelemetryJson));break;case 6:this.vu&&this.vu.cancelSearch();break;case 11:pa=
S.a(pa.messageContent);pa=n.r4b("keydown","f6",wa.a.IDc,!0,!1,pa,!0,!1);this.Bv&&this.Bv.dispatchEvent(pa);break;case 12:if(S.a(pa.messageContent).keyCode===wa.a.lL&&(pa=n.r4b("keydown","esc",wa.a.lL,!0,!1,!1,!1,!1),this.Bv&&(this.Bv.dispatchEvent(pa),this.hide(),this.vu)))this.vu.onPaneClosed();break;case 13:this.vu&&this.vu.selectDataType(pa.messageContent);break;case 14:this.vu&&this.vu.showHelpArticle(pa.messageContent);break;case 15:this.vu&&this.vu.showSurveyDialog(pa.messageContent);break;
case 16:this.vu&&(pa=S.a(pa.messageContent),this.vu.insertTable(pa.DomainId,pa.DomainIdString))}window.g_badCastCallback=Ta}}};n.prototype.KHh=function(){return S.c([2,1,3,5,8,6])};n.prototype.Spc=function(Ta){Ta=S.c(Ta);this.Bv.contentWindow.postMessage(Ta,da.a.Maa(this.Lsb))};n.r4b=function(Ta,pa,Da,rb,Ab,ob,sb,Pb){xa.a.Vu?(ob=String.format("{0} {1} {2}",ob?"Shift":"",sb?"Control":"",Pb?"Alt":""),ob.trim(),Da=document.createEvent("KeyboardEvent"),Da.initKeyboardEvent(Ta,rb,Ab,window.self,pa,0,ob,
!1,"en-US")):(pa={},pa.keyCode=Da,pa.ctrlKey=sb,pa.shiftKey=ob,pa.altKey=Pb,pa.bubbles=rb,pa.cancelable=Ab,Da=new KeyboardEvent(Ta,pa));return Da};Af.Object.defineProperties(n.prototype,{YKb:{configurable:!0,enumerable:!0,get:function(){return!0}},Lsb:{configurable:!0,enumerable:!0,get:function(){return G.AFrameworkApplication.fa.Wa("EnrichmentPaneUrl")}}});n.Urf="about:blank";Object(u.a)(n,"EnrichmentPane",null,[988,10]);Rk(w,n);w.prototype.hdb=function(){this.taskPane.isVisible||this.taskPane.$f(!0)};
w.prototype.Fdc=function(){this.taskPane.$f(!1)};w.prototype.dispose=function(){this.taskPane&&(this.taskPane.Tbj(Object(T.a)(this,this.MYf,"setFocusOnIFrame")),this.taskPane=null);n.prototype.dispose.call(this)};Af.Object.defineProperties(w.prototype,{wQa:{configurable:!0,enumerable:!0,get:function(){return this.taskPane.jc},set:function(Ta){this.taskPane.jc.innerHTML=Ta.innerHTML}}});Object(u.a)(w,"EnrichmentTaskPaneWrapper",n,[]);f.prototype.Tqi=function(Ta,pa){this.Fy=Ta;this.gfa&&this.gfa.show(this,
pa,null)};f.prototype.sBc=function(Ta,pa){this.gfa&&this.gfa.sBc(Ta,pa)};f.prototype.Zwb=function(){this.gfa&&this.gfa.hide()};f.prototype.dispose=function(){this.gfa&&(this.gfa.dispose(),this.gfa=null)};f.prototype.selectEntity=function(Ta){return this.Fy?this.Fy.selectEntity(Ta):!1};f.prototype.searchEntity=function(Ta,pa){this.Fy&&this.Fy.searchEntity(Ta,pa)};f.prototype.lMd=function(Ta,pa,Da,rb){this.Fy&&this.Fy.lMd(Ta,pa,Da,rb)};f.prototype.FCb=function(Ta){return this.Fy?this.Fy.FCb(Ta):!1};
f.prototype.onPaneClosed=function(){if(this.Fy)this.Fy.onPaneClosed()};f.prototype.cancelSearch=function(){this.Fy&&this.Fy.cancelSearch()};f.prototype.selectDataType=function(Ta){this.Fy&&this.Fy.selectDataType(Ta)};f.prototype.showHelpArticle=function(Ta){this.Fy&&this.Fy.showHelpArticle(Ta)};f.prototype.showSurveyDialog=function(Ta){this.Fy&&this.Fy.showSurveyDialog(Ta)};f.prototype.insertTable=function(Ta,pa){this.Fy&&this.Fy.insertTable(Ta,pa)};Object(u.a)(f,"EnrichmentManager",null,[987,10]);
Rk(m,f);m.prototype.dispose=function(){f.prototype.dispose.call(this)};Object(u.a)(m,"ExcelEnrichmentManager",f,[]);var Ka=b(14);Object(u.a)(l,"FloodgateSurvey",null,[]);var la=b(24),Ea=b(76),ra=b(443),na=b(45),ba=b(389),sa=b(177),ya=b(36),va=b(92),W=b(29),La=b(1),Ia=b(295),mb=b(21);Object(u.a)(k,"EnrichmentMessageContentAppProperties",null,[]);e.prototype.dispose=function(){this.$&&(this.gridView.ha.zW(this.vg),this.gridView.Fw(this.pR))};e.prototype.selectEntity=function(Ta){function pa(){return new ra.a}
var Da=this,rb=na.o(this.gridView.ha.sa.activeCell,this.$);ba.a(this.$.userOperationManager,function(Ab,ob,sb){var Pb=Da.$.oa.xa;Ab=Ia.b(Ab,Da.uRi);var Aa=Pb.Na(9,null);Aa.activeCell=rb;Aa.selectionIndex=Ta;return ea.g(Pb,"SelectLinkedEntityForDisambiguation",Aa,Ab,ob,sb,null,4)},function(Ab){return new sa.a(109,0,Ab,void 0,pa)},null);return!0};e.prototype.searchEntity=function(Ta,pa,Da,rb,Ab){var ob=this;Da=void 0===Da?!1:Da;rb=void 0===rb?0:rb;Ab=void 0===Ab?null:Ab;y.ULS.sendTraceTag(38846755,
0,50,"ConvertToLinkedEntityManager:SearchEntity() - Search attempted with TelemetryJSON: {0}",pa);var sb=na.o(this.gridView.ha.sa.activeCell,this.$);ba.a(this.$.userOperationManager,function(Pb,Aa,Ya){var kb=ob.$.oa.xa,lb=ob.xwa,ac=Da,Dc=rb,Zb=Ab;Pb=Ia.b(Pb,ob.yBf);var mc=kb.Na(1,null);mc.searchCell=sb;mc.searchQuery=Ta;mc.isFloodgateEnabled=lb;mc.isStarterData=ac;mc.starterDataDomainId=Dc;mc.starterDataDomainIdString=Zb;return ea.g(kb,"LinkedEntitySearch",mc,Pb,Aa,Ya,null,4)},function(Pb){return new sa.a(110,
0,Pb,16)},null)};e.prototype.FCb=function(Ta){var pa=this,Da=na.o(this.gridView.ha.sa.activeCell,this.$);this.$bb=!1;ba.a(this.$.userOperationManager,function(rb,Ab,ob){var sb=pa.$.oa.xa;rb=Ia.b(rb,pa.DOi);var Pb=sb.Na(1,null);Pb.activeCell=Da;Pb.isBackward=Ta;return ea.g(sb,"MoveToNextAmbiguousLinkedEntity",Pb,rb,Ab,ob,null,4)},function(rb){return new sa.a(111,0,rb,16)},null);return!0};e.prototype.onPaneClosed=function(){this.Ata=!1;this.wHe=!0;this.dpc=0;this.dFb=!1};e.prototype.cancelSearch=function(){var Ta=
this,pa=this.EMd();pa&&ba.a(this.$.userOperationManager,function(Da,rb,Ab){var ob=Ta.$.oa.xa;Da=Ia.b(Da,Ta.yBf);var sb=ob.Na(9,null);sb.activeCell=pa;return ea.g(ob,"CancelSearchLinkedEntity",sb,Da,rb,Ab,null,4)},function(Da){return new sa.a(112,0,Da,16)},null)};e.prototype.selectDataType=function(Ta){y.ULS.sendTraceTag(537166977,0,50,"ConvertToLinkedEntityDisambiguationPane:SelectDataType: Calling CloseDisambiguationPane");this.Dsa();if(Ta&&Ta.length)if(Ta=JSON.parse(Ta))if(null==Ta.domainId)y.ULS.sendTraceTag(537166946,
0,10,"Data Selector Pane invoked SelectDataType without passing a DomainId");else{var pa={};pa.Id=Ta.domainId;pa.StringId=Ta.stringId;this.convertToLinkedEntityManager.convertToLinkedEntity(pa)}else y.ULS.sendTraceTag(537166947,0,10,"Failed to parse the dataTypeJson from the Data Type Selector Pane");else y.ULS.sendTraceTag(537166976,0,10,"Recevied an empty dataTypeJson payload from the Data Type Selector Pane")};e.prototype.showHelpArticle=function(Ta){var pa=new va.a(-859308420,Ea.a.Cb,this.$.Jc,
9,null),Da={};Ta=(Da[Ea.a.Vf]="HelpID="+Ta,Da.InputMethod=Ea.a.Cb,Da.ShouldCanvasTakeFocus=!0,Da[Ea.a.Nc]=O.a.JQ,Da);this.$.Ka.Kb(pa,Ta)};e.prototype.showSurveyDialog=function(Ta){Q.a.HLb(new l(Ta))};e.prototype.insertTable=function(Ta,pa){var Da=this,rb=this.EMd();rb&&ba.a(this.$.userOperationManager,function(Ab,ob,sb){var Pb=Da.$.oa.xa;Ab=Ia.b(Ab,Da.lNi);var Aa=Pb.Na(1,null);Aa.cell=rb;Aa.starterDataDomainId=Ta;Aa.starterDataDomainIdString=pa;return ea.g(Pb,"InsertStarterDataTable",Aa,Ab,ob,sb,
null,4)},function(Ab){return new sa.a(259,0,Ab,1)},null)};e.prototype.hsd=function(Ta){this.launchOrCloseDisambiguationPane(Ta)};e.prototype.launchDisambiguationPaneForSearch=function(){var Ta=this;y.ULS.sendTraceTag(36975685,0,50,"ConvertToLinkedEntityManager:LaunchDisambiguationPaneForSearch() - Launch Disambiguation Pane For Search attempted");var pa=this.Mlj();pa&&ba.a(this.$.userOperationManager,function(Da,rb,Ab){return B(Ta.$.oa.xa,pa,!0,Ta.xwa,!1,null,Ia.b(Da,Ta.XKi),rb,Ab,1)},function(Da){return new sa.a(114,
0,Da,16)},null)};e.prototype.launchLinkedEntityDataTypeSelectorPane=function(Ta,pa){var Da=this;ba.a(this.$.userOperationManager,function(rb,Ab,ob){var sb=Da.$.oa.xa;rb=Ia.b(rb,Da.Ymc);var Pb=sb.Na(1,null);Pb.selectedRanges=Ta;Pb.letyDomainId=pa;return ea.g(sb,"GetDataTypeSelectorData",Pb,rb,Ab,ob,2,4)},function(rb){return new sa.a(233,0,rb,16)},null)};e.prototype.Nqi=function(Ta,pa){var Da=this;Ta&&ba.a(this.$.userOperationManager,function(rb,Ab,ob){return B(Da.$.oa.xa,Ta,!1,!1,!0,pa,Ia.b(rb,Da.Ymc),
Ab,ob,2)},function(rb){return new sa.a(257,0,rb,16)},null)};e.prototype.wIi=function(Ta){W.a.Rg(Ta.Errors)?(Ta=W.a.Dc(Ta.Errors),Ta.includes("OperationSucceededWithAlert")?y.ULS.sendTraceTag(537166942,0,50,"Convert to Linked Entity failed with an alert"):y.ULS.sendTraceTag(36975687,0,10,"Failed to Convert to Linked Entity. errors: {0}",Ta)):Ta.Result&&(this.$.ea.xk(this.Uc),this.$.ea.Wj(this.Uc),Ta=Ta.Result,this.sdb=Ta.SkydanceFeatureBitmask,this.dwd(Ta),this.fLb=!0)};e.prototype.LZf=function(Ta){Ta&&
(this.dpc=Ta)};e.prototype.xjf=function(Ta){if(La.EwaSettings.ma(657)){var pa=new va.a(-90814711,Ea.a.Cb,0,10,null);this.$.Ka.Kb(pa,null)}this.Ata?this.F7b.sBc(Ta,null):(pa=3,null!=this.sdb?pa=this.sdb:y.ULS.shipAssertTag(537166937,0,!1,"SkydanceFeatureBitmask was not set"),(Ta=this.uNh(Ta,pa))||y.ULS.sendTraceTag(537166936,0,15,"LaunchOrUpdateDisambiguationPane: null appProperties"),this.mLe||y.ULS.sendTraceTag(537166935,0,15,"LaunchOrUpdateDisambiguationPane: null entitymanager"),this.F7b.Tqi(this.mLe,
Ta),this.Ata=!0)};e.prototype.Dsa=function(){this.Ata&&(y.ULS.sendTraceTag(537166934,0,100,"ConvertToLinkedEntityDisambiguationPane:CloseDisambiguationPane"),this.F7b.Zwb(),this.Ata=!1,this.dpc=0,this.dFb=!1)};e.prototype.dwd=function(Ta){var pa=Ta.Row+1;Ta=Ta.Column+1;0>pa||0>Ta?(y.ULS.sendTraceTag(537166933,0,50,"ConvertToLinkedEntityDisambiguationPane:MoveToAmbiguousLinkedEntity: Calling CloseDisambiguationPane"),this.Dsa(),this.$.ea.xk(this.Uc)):(pa=new la.Range(pa,Ta,pa,Ta,!0,!1),this.gridView.ha.updateSelection(pa,
pa,60),this.$bb=!0)};e.prototype.uNh=function(Ta,pa){var Da=new k;Da.applicationVersion=G.AFrameworkApplication.buildVersion;Da.applicationName="ExcelWac";Da.anid="00000000-0000-0000-0000-000000000000";Da.sessionId=G.AFrameworkApplication.userSessionId;Da.appCorrelationId=ca.a.create().toString();var rb=X.a.cH(G.AFrameworkApplication.lcid);rb=rb?rb.name:null;Da.uiLanguage=rb;Da.market=this.tac(rb);Da.themeId=0;Da.disambiguationJson=Ta;pa<=Z.a.yS?Da.featuresBitMask=pa:y.ULS.sendTraceTag(537166932,
0,10,"SkydanceFeaturesBitmask is too large for EnrichmentMessageContentAppProperties");return Da};e.prototype.tac=function(Ta){Ta=Ta.split("-");return Ta[Ta.length-1]};e.prototype.launchOrCloseDisambiguationPane=function(Ta){var pa=this,Da=this.gridView.ha.sa.activeCell;if(this.EMd()&&Da)if(this.gridView.Ab.gfc(Da)){if((!this.wHe||Ta||this.fLb)&&!this.gridView.isEditing){Ta&&(this.$bb=!0);var rb=na.q(Da,this.$);ba.a(this.$.userOperationManager,function(Ab,ob,sb){return B(pa.$.oa.xa,rb,!1,pa.xwa,!1,
null,Ia.b(Ab,pa.Ymc),ob,sb,1)},function(Ab){return new sa.a(114,0,Ab,16)},null)}}else this.Dsa();else this.Dsa()};e.prototype.a7i=function(){var Ta=this;if(this.Ata){var pa=this.gridView.ha.sa.activeCell;if(pa){var Da=na.q(pa,this.$);ba.a(this.$.userOperationManager,function(rb,Ab,ob){return B(Ta.$.oa.xa,Da,!1,Ta.xwa,!1,null,Ia.b(rb,Ta.Ymc),Ab,ob,1)},function(rb){return new sa.a(114,0,rb,16)},null)}else this.Dsa()}};e.prototype.EMd=function(){var Ta=this.gridView.ha.sa;return Ta.Eba()?na.o(Ta.activeCell,
this.$):null};e.prototype.Mlj=function(){var Ta=this.gridView.ha.sa;return Ta.Eba()?na.q(Ta.activeCell,this.$):null};Object(u.a)(e,"ConvertToLinkedEntityDisambiguationPane",null,[10]);var fb=b(7),Ma=b(394),Hb=b(1594),Kb=b(53),Ub=b(920);d.prototype.DFh=function(Ta,pa){var Da=b(971).ConvertToLinkedEntityManager;this.zRj();pa=this.Va.mq(pa).eE();for(var rb=0,Ab=0,ob=!1,sb=ak(Ta.Categories),Pb=sb.next();!Pb.done;Pb=sb.next()){if(Pb=this.jGh(Pb.value,rb))this.Wwa&&Ab===Da.M7a&&(ob=!0),pa.MenuSectionList.push(Pb),
++rb;++Ab}this.Wwa&&ob&&rb<=Da.Xjf&&Array.removeAt(pa.MenuSectionList,Da.M7a);Da=this.Va.Bc().L0b();rb=Kb.a.Te(11);Ta=ak(Ta.LongButtons);for(Ab=Ta.next();!Ab.done;Ab=Ta.next())Ab=Ab.value,this.convertToLinkedEntityManager.Oxj(Ab)&&this.rCg(Da,Ab,rb);0<Da.ControlList.length&&pa.MenuSectionList.push(Da);return pa};d.prototype.rCg=function(Ta,pa,Da){if(pa){var rb="Data.ConvertToLinkedEntityMenuItem_"+pa.Name,Ab=this.convertToLinkedEntityManager.fQ(pa.DomainId);Ab&&(pa=Object(fb.a)(new Ma.a,{Id:rb,ExternalId:rb,
Command:"-1662108744",LabelText:pa.Name,Alt:pa.SuperTip,Visible:!0,MenuItemId:b(971).ConvertToLinkedEntityManager.q1a(pa.DomainId),Image16by16:Da,Image16by16Class:this.T7h(Ab.FontLocator)}),Ta.ControlList.push(pa))}};d.prototype.dGh=function(Ta,pa){var Da={};Da=(Da.width=24,Da["min-width"]=24,Da.height=24,Da);var rb={};return Object(fb.a)(new Hb.a,{Id:b(971).ConvertToLinkedEntityManager.gJe+Ta.toString(),ExternalId:b(971).ConvertToLinkedEntityManager.gJe+Ta.toString(),MenuItemId:b(971).ConvertToLinkedEntityManager.I6c+
Ta.toString(),Command:"-1203788282",QueryCommand:"QueryLinkedEntityGalleryButtons",Icon:this.q8e(pa.FontLocator),LabelText:pa.Name,PreviewIconStyle:(rb.root=Da,rb),Alt:this.Wcd(pa)})};d.prototype.HMg=function(Ta){switch(Ta){case "Animal":return Ub.a.cJg;case "Apple":return Ub.a.eKg;case "Atom":return Ub.a.CLg;case "Beaker":return Ub.a.ANg;case "Bridge":return Ub.a.aPg;case "Cat":return Ub.a.cVg;case "City":return Ub.a.qXg;case "Constellation":return Ub.a.o1g;case "Dog":return Ub.a.qhh;case "Finance":return Ub.a.sNg;
case "GradCap":return Ub.a.D0h;case "HumanAnatomy":return Ub.a.e7h;case "LocationPointer":return Ub.a.tti;case "Map":return Ub.a.VUi;case "MedicineNeedle":return Ub.a.Kzi;case "Mountain":return Ub.a.fBi;case "Movie":return Ub.a.ABi;case "Music":return Ub.a.NBi;case "OuterSpace":return Ub.a.zVi;case "Planet":return Ub.a.wYi;case "Satellite":return Ub.a.ljj;case "WolframGeneric":return Ub.a.eij;default:return Ub.a.a3g}};d.prototype.T7h=function(Ta){if("PowerBIRibbon"!==Ta)return J.a.Z8c;switch(Ta){case "AnimalRibbon":return J.a.Tsh;
case "AppleRibbon":return J.a.Ush;case "AtomRibbon":return J.a.Vsh;case "BeakerRibbon":return J.a.Wsh;case "BridgeRibbon":return J.a.Xsh;case "CenterMapRibbon":return J.a.Ysh;case "CityRibbon":return J.a.Zsh;case "CurrencyRibbon":return J.a.$sh;case "ExerciseRibbon":return J.a.ath;case "FinanceRibbon":return J.a.kPe;case "FirstAidRibbon":return J.a.bth;case "GlobeLightningRibbon":return J.a.cth;case "GradCapRibbon":return J.a.dth;case "HumanAnatomyRibbon":return J.a.eth;case "LeafRibbon":return J.a.fth;
case "LocationPointerRibbon":return J.a.hth;case "MapRibbon":return J.a.iPe;case "MountainRibbon":return J.a.ith;case "MovieRibbon":return J.a.jth;case "MusicRibbon":return J.a.kth;case "NotablePeopleRibbon":return J.a.lth;case "OuterSpaceRibbon":return J.a.mth;case "PartlySunnyWeatherRibbon":return J.a.nth;case "PowerBIRibbon":return J.a.jPe;case "SatelliteRibbon":return J.a.pth;case "WolframGenericRibbon":return J.a.gth;case "YogaRibbon":return J.a.rth;default:return J.a.hPe}};d.prototype.q8e=function(Ta){switch(Ta){case "AnimalRibbon":return"AnimalExcelDataTypes_24";
case "AppleRibbon":return"AppleExcelDataTypes_24";case "AtomRibbon":return"AtomExcelDataTypes_24";case "BeakerRibbon":return"BeakerExcelDataTypes_24";case "BridgeRibbon":return"BridgeExcelDataTypes_24";case "CenterMapRibbon":return"CenterMapExcelDataTypes_24";case "CityRibbon":return"CityExcelDataTypes_24";case "CurrencyRibbon":return"CurrencyExcelDataTypes_24";case "ExerciseRibbon":return"ExerciseExcelDataTypes_24";case "FinanceRibbon":return"Bank_32";case "FirstAidRibbon":return"FirstAidExcelDataTypes_24";
case "GlobeLightningRibbon":return"GlobeLightning_24";case "GradCapRibbon":return"GradCapExcelDataTypes_24";case "HumanAnatomyRibbon":return"HumanAnatomyExcelDataTypes_24";case "LeafRibbon":return"LeafExcelDataTypes_24";case "LocationPointerRibbon":return"LocationPointerExcelDataTypes_24";case "MapRibbon":return"OpenMap_24";case "MountainRibbon":return"MountainExcelDataTypes_24";case "MovieRibbon":return"MovieExcelDataTypes_24";case "MusicRibbon":return"MusicExcelDataTypes_24";case "NotablePeopleRibbon":return"NotablePeopleExcelDataTypes_24";
case "OuterSpaceRibbon":return"OuterSpaceExcelDataTypes_24";case "PartlySunnyWeatherRibbon":return"PartlySunnyWeatherExcelDataTypes_24";case "PowerBIRibbon":return"DataProtectionExcelDataTypes_24";case "SatelliteRibbon":return"SatelliteExcelDataTypes_24";case "WolframGenericRibbon":return"Lightning_24";case "YogaRibbon":return"YogaExcelDataTypes_24";default:return"ConvertToEntity_20"}};d.prototype.jGh=function(Ta,pa){pa=this.Va.qC("ConvertToLinkedEntitySection_"+pa,this.Wjf,this.Vjf);for(var Da=!1,
rb=ak(Ta.DomainIds),Ab=rb.next();!Ab.done;Ab=rb.next()){var ob=Ab.value;(Ab=this.convertToLinkedEntityManager.fQ(ob))&&!Ab.DomainBlocked&&Ab.ShowInRibbon&&(Da=Ab.Name,ob=b(971).ConvertToLinkedEntityManager.q1a(ob),pa.Dt("Data.ConvertToLinkedEntityMenuItem_"+ob,-1203788282,"QueryLinkedEntityGalleryIcon",void 0,ob,this.q8e(Ab.FontLocator),void 0,void 0,this.Wcd(Ab),Da),Da=!0)}if(!Da)return null;pa=pa.I0b(!0);rb=this.Va.Bc();rb.title=Ta.Name;Ta=rb.L0b();Ta.ControlList.push(pa);return Ta};d.prototype.zRj=
function(){this.Wjf=5;this.Vjf="Size112by64"};d.prototype.Wcd=function(Ta){return Ta.RibbonTooltipHeader?Ta.RibbonTooltipHeader+"\n\n"+Ta.RibbonTooltip:Ta.RibbonTooltip};Object(u.a)(d,"ConvertToLinkedEntityMenuRenderer",null,[965]);var gb=b(54),Db=b(258),Va=b(121),yb=b(187),qb=b(80);c.prototype.fVh=function(){this.vid||La.EwaSettings.isChangeGateEnabled("OfficeVSO:6422438_RoamingHandlerNoSessionIdPresent")&&!this.$.ea.dc||(y.ULS.sendTraceTag(537166691,0,50,"GetRecentlyUsedLinkedDataTypesFromRoamingService - Invoking the GetRecentlyUsedDataTypes operation."),
Db.v(this.$.oa.xa,0,this.fQi,this.fBf,null,null))};c.prototype.tgg=function(Ta){Ta&&Ta.length?this.vid?(Ta=this.ynj(Ta))?(y.ULS.sendTraceTag(537166688,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Invoking the WriteRecentlyUsedDataTypes operation."),Db.B(this.$.oa.xa,0,Ta,this.uUi,this.fBf,null,null)):y.ULS.sendTraceTag(537166689,0,15,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Created an empty serialized string."):this.nid=!0:y.ULS.sendTraceTag(537166690,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Tried writing an empty list of data types.")};
c.prototype.ynj=function(Ta){if(!Ta||!Ta.length)return y.ULS.sendTraceTag(537166687,0,15,"SerializeRecentlyUsedLinkedDataTypes - Received an empty list of data types."),null;var pa=[];Ta=ak(Ta);for(var Da=Ta.next();!Da.done;Da=Ta.next()){Da=Da.value;var rb={};rb.Id=Da.Id;Da.StringId&&(rb.StringId=Da.StringId);pa.push(rb)}pa="<DataTypes>"+gb.a.xc(pa)+"</DataTypes>";return 1906<pa.length?(y.ULS.sendTraceTag(537166686,0,15,"SerializeRecentlyUsedLinkedDataTypes - Exceeded the MaxSize for ridExcelRecentlyUsedLinkedDataTypes."),
null):pa};c.prototype.PWi=function(Ta){if(!Ta)return y.ULS.sendTraceTag(537166685,0,15,"ParseRecentlyUsedLinkedDataTypes - Received an empty roamingXml."),null;if(!Ta.startsWith("<DataTypes>")||!Ta.endsWith("</DataTypes>"))return y.ULS.sendTraceTag(537166684,0,15,"ParseRecentlyUsedLinkedDataTypes - Received a string without a prefix/postfix."),null;Ta=Ta.substring(11,Ta.length-12);if(!Ta)return y.ULS.sendTraceTag(537166683,0,15,"ParseRecentlyUsedLinkedDataTypes - Created an empty substring."),null;
var pa=[];try{pa=gb.a.Vh(Ta)}catch(Da){return y.ULS.sendTraceTag(537166682,0,10,"ParseRecentlyUsedLinkedDataTypes - Encountered an exception. Message: {0}",Da.message),null}y.ULS.sendTraceTag(537166681,0,50,"ParseRecentlyUsedLinkedDataTypes returned {0} data types.",pa.length);return pa};c.prototype.Zzi=function(Ta){var pa=this.Qza.XGb,Da=this.Qza.d6i;if(pa.length!==Da){for(var rb=0;rb<Ta.length&&pa.length<Da;++rb){var Ab=Ta[rb];this.Qza.fQ(Ab)&&!Array.contains(pa,Ab)&&pa.push(Ab)}this.Qza.XGb=pa}};
Object(u.a)(c,"LinkedDataTypeRoamingHandler",null,[]);var dc=b(564),bb=b(59),db=b(51),wc=b(266),nb=b(37),zb=b(47),ma=b(28),P=b(296),oa=b(22),Ja=b(100);b.d(D,"ConvertToLinkedEntityManager",function(){return a});var $a=K.a;Rk(a,$a);a.prototype.dispose=function(){(this.bzb||this.Q5a||this.F6a)&&this.$.ea.Gw(this.Sf);La.EwaSettings.ma(657)&&this.$.ea.xk(this.Uc);!this.X9&&La.EwaSettings.ma(131)&&La.EwaSettings.ma(139)&&this.gridView.Fw(this.onContentReady);this.Tm&&this.Tm.dispose();this.$.kD(this.Ri);
this.$.ol(this.Yc);this.Q5a&&(this.Uld=null);x.a.Ia(this.Rya)};a.prototype.sFg=function(Ta){this.addHandler("LinkedEntityConverted",Ta)};a.prototype.Bbj=function(Ta){this.removeHandler("LinkedEntityConverted",Ta)};a.prototype.selectEntity=function(Ta){return this.Tm?this.Tm.selectEntity(Ta):!1};a.prototype.searchEntity=function(Ta,pa){this.Tm&&this.Tm.searchEntity(Ta,pa)};a.prototype.lMd=function(Ta,pa,Da,rb){this.Tm&&this.Tm.searchEntity(Ta,pa,!0,Da,rb)};a.prototype.FCb=function(Ta){return this.Tm?
this.Tm.FCb(Ta):!1};a.prototype.onPaneClosed=function(){if(this.Tm)this.Tm.onPaneClosed()};a.prototype.cancelSearch=function(){this.Tm&&this.Tm.cancelSearch()};a.prototype.selectDataType=function(Ta){this.Tm&&this.Tm.selectDataType(Ta)};a.prototype.showHelpArticle=function(Ta){this.Tm&&this.Tm.showHelpArticle(Ta)};a.prototype.showSurveyDialog=function(Ta){this.Tm&&this.Tm.showSurveyDialog(Ta)};a.prototype.insertTable=function(Ta,pa){this.Tm&&this.Tm.insertTable(Ta,pa)};a.prototype.H3h=function(Ta){if(this.$.isEditMode&&
this.yTf!==Ta&&G.AFrameworkApplication.fa.ra("SupportsPolicies")){this.yTf=Ta;y.ULS.sendTraceTag(537166925,0,50,"HandleRichDataClassificationLabelStateIdChanged - Getting rich data classification labels");Ta=this.$.oa.xa;var pa=this.XLi,Da=Ta.Na(1,null);ea.g(Ta,"GetRichDataClassificationLabels",Da,pa,null,null,null,4)}};a.prototype.oKe=function(){function Ta(Da,rb,Ab){var ob=pa.$.oa.xa;Da=Ia.b(Da,pa.CJi);var sb=ob.Na(1,null);return ea.g(ob,"LinkedEntitiesEnableUntrustedImages",sb,Da,rb,Ab,null,0)}
var pa=this;La.EwaSettings.Zb()?this.$.userOperationManager.Sb(new sa.a(589,0,Ta,80),null):this.$.userOperationManager.Sb(new dc.a(589,0,Ta,16),null)};a.prototype.showUntrustedImageBusinessBarIfNecessary=function(){this.sXd||this.wbg||!this.$.ea.dc||this.Dmj()};a.prototype.Dmj=function(){function Ta(Da,rb,Ab){var ob=pa.$.oa.xa;Da=Ia.b(Da,pa.qLi);var sb=ob.Na(1,null);return ea.g(ob,"GetHasUntrustedImageUrls",sb,Da,rb,Ab,null,4)}var pa=this;La.EwaSettings.Zb()?this.$.userOperationManager.Sb(new sa.a(588,
0,Ta,80),null):this.$.userOperationManager.Sb(new dc.a(588,0,Ta,16),null)};a.prototype.FWd=function(Ta){var pa=this;if(this.Q5a&&null==this.Uld&&!this.F6a&&G.AFrameworkApplication.fa.ra("SupportsPolicies")&&null!=this.y6a&&this.y6a&&(!Ta||this.$.workbookContext.Options&262144)){var Da=db.GetServiceTaskFactory.Ra(this.$.da,274,275,0);nb.TaskExtensions.Ba(Da,function(){pa.Uld=Da.result.gNf(2)},this.$.la,3)}};a.prototype.b3g=function(Ta){(Ta=this.uhh(Ta))?this.convertToLinkedEntity(Ta):y.ULS.sendTraceTag(537166920,
0,10,"Could not convert key into domain ID")};a.prototype.convertToLinkedEntity=function(Ta){y.ULS.sendTraceTag(34415004,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - conversion attempted  [ServiceEndpoint: {0}].",Ta.Id);if(this.gridView){var pa=this.gridView.ha.sa.Vc,Da=pa.Ae(this.gridView.$G);this.Wwa&&this.emd&&this.dDg(Ta);if(Da){Da=this.gridView.Ab.Owa(Da);if(!this.R5e(Ta)&&this.Uef(Ta.Id)){y.ULS.sendTraceTag(537166918,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert to organization data type without curated data");
if(bb.a.rg.ZQ){pa=this.ocd();if(!pa){y.ULS.sendTraceTag(537166917,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Da=this.f4b();if(!Da){y.ULS.sendTraceTag(537166916,0,50,"RibbonCommandInfo is null for blankCellConvert");return}var rb={};rb=(rb.InputMethod=Ea.a.Cb,rb);rb.CalloutName=3;rb.Target=pa;rb.RibbonButtonLabel=La.EwaSettings.isChangeGateEnabled("OfficeVSO:4244626_BlankCellCalloutRibbonButtonLabel")?this.nTf(Ta):this.AAb(Ta.Id.toString());rb.ExampleEntities=this.lQe(Ta);this.$.Ka.Kb(Da,
rb);return}y.ULS.sendTraceTag(537166915,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert to organization data without curated data, teaching callout not enabled")}if(this.Uef(Ta.Id)&&!Ta.StringId)this.launchLinkedEntityDataTypeSelectorPane(a.q1a(Ta));else{if(Da){y.ULS.sendTraceTag(537166914,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range");if(La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LaunchStarterDataForBlankCell",
!1)&&this.AGj(Ta)){pa=na.r(this.gridView.ha.sa.selectedRanges,this.$);this.Tm.Nqi(pa,Ta);return}if(bb.a.rg.ZQ){pa=this.ocd();if(!pa){y.ULS.sendTraceTag(537166913,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Da=this.f4b();if(!Da){y.ULS.sendTraceTag(537166912,0,50,"RibbonCommandInfo is null for blankCellConvert");return}rb={};rb=(rb.InputMethod=Ea.a.Cb,rb);rb.CalloutName=2;rb.Target=pa;rb.RibbonButtonLabel=this.nTf(Ta);rb.ExampleEntities=this.lQe(Ta);rb.BlankCellResourceId=this.bOg(Ta);
rb.HasBlankCellWalkthrough=this.s4h(Ta);rb.ServiceDomain=Ta.Id;this.$.Ka.Kb(Da,rb);return}y.ULS.sendTraceTag(537166883,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}this.d2c(Ta,!1,pa)}}}else y.ULS.shipAssertTag(537166919,0,!1,"grid view should not be null")};a.prototype.convertToLinkedEntityFromAutoDetect=function(){this.X9&&this.X9.oHa()};a.prototype.onAutoDetectUIShown=function(){function Ta(Da,rb,Ab){var ob=pa.$.oa.xa,
sb=ob.Na(1,null);return ea.g(ob,"OnAutoDetectUIShown",sb,Da,rb,Ab,null,4)}var pa=this;La.EwaSettings.Zb()?ba.a(this.$.userOperationManager,Ta,function(Da){return new sa.a(230,0,Da,80)},null):ba.a(this.$.userOperationManager,Ta,function(Da){return new dc.a(230,0,Da,16)},null)};a.prototype.d2c=function(Ta,pa,Da){function rb(){return new ra.a}var Ab=this,ob=na.q(Da,this.$);ba.a(this.$.userOperationManager,function(sb,Pb,Aa){var Ya=Ab.$.oa.xa;sb=Ia.b(sb,Ab.xIi,Ab.xSi,Object(T.a)(Ab.Tm,Ab.Tm.wIi,"onConvertToLinkedEntitySucceeded"));
var kb=Ya.Na(1,null);kb.selectedRanges=ob;kb.domainId=Ta;kb.autodetect=pa;return ea.g(Ya,"ConvertToLinkedEntity",kb,sb,Pb,Aa,null,4)},function(sb){return new sa.a(115,0,sb,void 0,rb)},null)};a.prototype.dDg=function(Ta){if(this.Wwa&&this.emd){var pa={};pa.Id=Ta.Id;Ta.StringId&&(pa.StringId=Ta.StringId);if(!(0<this.gK.length&&this.gK[0].Id===pa.Id&&this.gK[0].StringId===pa.StringId)){Ta=!1;Array.insert(this.gK,0,pa);for(var Da=1;Da<this.gK.length;++Da)if(this.gK[Da].Id===pa.Id&&this.gK[Da].StringId===
pa.StringId){Array.removeAt(this.gK,Da);Ta=!0;break}for(;5<this.gK.length;)Array.removeAt(this.gK,this.gK.length-1);this.Tba.Categories[a.M7a].DomainIds=this.gK;this.mSf();this.mpd&&!Ta&&this.lLd.tgg(this.gK)}}};a.prototype.convertLinkedEntityToText=function(){var Ta=this;y.ULS.sendTraceTag(34719501,0,50,"ConvertToLinkedEntityManager:ConvertLinkedEntityToText() - conversion attempted");if(this.gridView){var pa=na.q(this.gridView.ha.sa.Vc,this.$);ba.a(this.$.userOperationManager,function(Da,rb,Ab){var ob=
Ta.$.oa.xa,sb=ob.Na(1,null);sb.selectedRanges=pa;return ea.g(ob,"ConvertLinkedEntityToText",sb,Da,rb,Ab,null,4)},function(Da){return new sa.a(116,0,Da)},null)}else y.ULS.shipAssertTag(537166879,0,!1,"grid view should not be null")};a.prototype.refreshLinkedEntitiesInRange=function(){var Ta=this;y.ULS.sendTraceTag(537166878,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange() - refresh attempted");if(mb.g(this.$)){this.$.isEditMode||y.ULS.sendTraceTag(537166876,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange(): Refreshing selection during view mode");
this.bId();var pa=na.r(this.gridView.ha.sa.selectedRanges,this.$);ba.a(this.$.userOperationManager,function(Da,rb,Ab){var ob=Ta.$.oa.xa,sb=ob.Na(1,null);sb.selectedRanges=pa;return ea.g(ob,"RefreshLinkedEntitiesInRange",sb,Da,rb,Ab,null,4)},function(Da){return new sa.a(248,0,Da)},null)}else y.ULS.shipAssertTag(537166877,0,!1,"grid view should not be null")};a.prototype.Oxj=function(Ta){Ta=this.fQ(Ta.DomainId);if(!Ta||Ta.DomainBlocked||La.EwaSettings.isChangeGateEnabled("OfficeVSO:4465309_NoCuratedDataNoLongButton")&&
!Ta.HasCuratedData)return!1;if(this.nji){for(var pa=ak(this.AU),Da=pa.next();!Da.done;Da=pa.next())if(Da=Da.value,Da.value.DomainId.Id===Ta.DomainId.Id&&Da.value.ShowInRibbon)return!0;return!1}return Ta.ShowInRibbon};a.prototype.Ewj=function(Ta){return 2!==this.Ur||!this.lia[Ta]};a.prototype.launchDisambiguationPaneForSearch=function(){this.Tm&&this.Tm.launchDisambiguationPaneForSearch()};a.prototype.Qc=function(Ta,pa,Da){if("PopulateConvertToLinkedEntityMenu"!==pa)return!1;this.nbd=Da.MenuId;if(0===
this.Ur||3===this.Ur)return this.YYi(),!0;if(!this.Tba)return y.ULS.sendTraceTag(537166873,0,10,"PopulateMenu: Encountered null ribbon section info"),!1;if(!this.AU)return y.ULS.sendTraceTag(537166872,0,10,"PopulateMenu: Encountered null domain collection"),!1;this.yY=this.yY||this.t8a.DFh(this.Tba,Da.MenuId);Da.MenuItems=this.yY;return this.emd=!0};a.prototype.YYi=function(){var Ta=this;-1===this.cdc&&(this.E$a(),this.cdc=window.setInterval(function(){Ta.E$a()},2E3))};a.prototype.E$a=function(){if(this.$.ea.dc&&
2!==this.Ur){this.DKa--;y.ULS.sendTraceTag(537166870,0,50,"ConvertToLinkedEntityManager:PopulateDomainData() - populating domains attempted.");this.Ur=1;var Ta=this.$.oa.xa,pa=this.yLi,Da=this.xLi,rb=Ta.Na(1,null);ea.g(Ta,"GetLinkedEntityMetadata",rb,pa,Da,null,null,4)}};a.prototype.Tmd=function(){return this.$.isEditMode&&2!==this.Ur&&(0<=this.DKa||!this.POa)};a.prototype.bYd=function(Ta){G.AFrameworkApplication.Bg?y.ULS.sendTraceTag(537166869,0,50,"UpdatePreviewGalleryVisibility bailed out on shutting down."):
N.a(this.$)?(this.XRj(),Ta&&this.$.jf()):y.ULS.sendTraceTag(537166868,0,50,"UpdatePreviewGalleryVisibility bailed out on null RibbonManager.")};a.prototype.Ofj=function(){this.pwb=this.jDb=0;this.DKa=8;this.POa=!1;this.Ur=this.cdc=0;this.iNa=this.Tba=null;this.f2b();for(var Ta=0;Ta<this.INa;++Ta)this.lia[Ta]=null;this.syb()&&this.bYd(!0)};a.prototype.f2b=function(){this.yY=null};a.prototype.syb=function(){var Ta=O.a.QGb,pa=N.a(this.$);return!!pa&&pa.Ql.AB===Ta};a.prototype.hcg=function(){if(this.Tba){var Ta=
0;if(this.Wwa){var pa=-1,Da=-1,rb=0,Ab=0,ob=0,sb=0,Pb=[null,null,null,null,null],Aa=ak(this.Tba.Categories);for(lb=Aa.next();!lb.done;lb=Aa.next()){var Ya=!1;lb=ak(lb.value.DomainIds);for(ac=lb.next();!ac.done;ac=lb.next()){ac=ac.value;var kb=this.fQ(ac);kb&&!kb.DomainBlocked&&kb.ShowInRibbon&&(Ta<this.INa?(this.lia[Ta]=ac,Ab===a.M7a&&(-1===pa&&(pa=Ta),Da=Ta,sb=Da-pa+1),++Ta):Ta===this.INa&&rb<sb&&Ab!==a.M7a&&(Pb[rb]=ac,++rb),Ya=!0)}Ya&&++ob;++Ab}if(-1<pa&&ob<=a.Xjf){for(;Da>=pa;--Da)Array.removeAt(this.lia,
Da);for(pa=0;pa<sb;++pa)Array.insert(this.lia,Ta+pa,Pb[pa])}}else{sb=ak(this.Tba.Categories);for(var lb=sb.next();!lb.done;lb=sb.next()){Pb=ak(lb.value.DomainIds);for(var ac=Pb.next();!ac.done&&!(pa=ac.value,(Da=this.fQ(pa))&&!Da.DomainBlocked&&Da.ShowInRibbon&&(this.lia[Ta]=pa,++Ta,Ta>=this.INa));ac=Pb.next());if(Ta>=this.INa)break}}for(;Ta<this.INa;)this.lia[Ta]=null,++Ta}};a.prototype.gag=function(){var Ta=Object(F.a)(379,mb.g(this.$).Ea),pa=this.gridView.ha.Qe;return Ta&&Ta.Vhd&&1===pa&&this.gridView.ha.sa.activeCell?
(Ta=db.GetServiceTaskFactory.Ra(this.$.da,12,477,1),this.X9=new H.a(this.$,this.svgIconProvider,Ta.result,this),!0):!1};a.prototype.Qqi=function(){this.Tm&&this.Tm.hsd(!0)};a.prototype.launchLinkedEntityDataTypeSelectorPane=function(Ta){if(this.Tm)if(Ta=this.o6c(Ta))if(Ta.DomainId.StringId)y.ULS.sendTraceTag(537166855,0,10,"Domain with a string ID used when launching Data Type Selector pane");else{var pa=na.r(this.gridView.ha.sa.selectedRanges,this.$);this.Tm.launchLinkedEntityDataTypeSelectorPane(pa,
Ta.DomainId.Id)}else y.ULS.sendTraceTag(537166856,0,10,"Unknown domain used when launching Data Type Selector pane")};a.prototype.s1g=function(Ta){var pa=this.S7h(Ta),Da=E.a.Ag(this.AAb(Ta));Ta=E.a.Ag(this.EVd(Ta));return a.gFh(pa,Kb.a.Te(11),Da,Ta)};a.prototype.EVd=function(Ta){try{return this.tIe(parseInt(Ta,10)).Description}catch(pa){}return Ka.a.instance.ga(1772)};a.prototype.AAb=function(Ta){try{return this.tIe(parseInt(Ta,10)).Name}catch(pa){}return Ka.a.instance.ga(1758)};a.prototype.nTf=function(Ta){try{return this.fQ(Ta).Name}catch(pa){}return this.AAb(Ta.Id.toString())};
a.prototype.bOg=function(Ta){try{return this.fQ(Ta).BlankCellResourceId}catch(pa){}return null};a.prototype.s4h=function(Ta){try{return this.fQ(Ta).HasBlankCellWalkthrough}catch(pa){}return!1};a.prototype.R5e=function(Ta){try{var pa=a.q1a(Ta);if(this.AU.kb(pa))return this.AU.na(pa).HasCuratedData}catch(Da){}return!1};a.prototype.AGj=function(Ta){try{return this.fQ(Ta).SupportsStarterData}catch(pa){}return!1};a.prototype.Uef=function(Ta){return 268435968===Ta};a.prototype.ocd=function(){return 2===
N.a(this.$).MW?"[data-unique-id=LinkedEntity_MLR]":"[data-unique-id=LinkedEntity]"};a.prototype.f4b=function(){return new va.a(-847286761,Ea.a.Cb,this.$.Jc,0,O.a.sW)};a.prototype.jDe=function(){if(this.syb()&&!this.Tmd()&&!this.ycf&&La.EwaSettings.ma(442)&&this.R5e({Id:268435968,StringId:null}))if(y.ULS.sendTraceTag(537166819,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - tried to launch first org data teaching callout"),bb.a.rg.ZQ){var Ta=this.ocd();if(Ta){var pa=
this.f4b();if(pa){var Da={};Da=(Da.InputMethod=Ea.a.Cb,Da);Da.CalloutName=6;Da.Target=Ta;Da.ShouldCanvasTakeFocus=!0;this.$.Ka.Kb(pa,Da);this.ycf=!0}else y.ULS.sendTraceTag(537166817,0,10,"RibbonCommandInfo is null for firstOrgData")}else y.ULS.sendTraceTag(537166818,0,10,"CalloutAnchorElement is null for firstOrgData")}else y.ULS.sendTraceTag(537166816,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - Attempted to launch firstOrgData callout, teaching callout not enabled")};
a.prototype.p7h=function(Ta){Ta=this.o6c(Ta);return Ta?this.t8a.HMg(Ta.SubdomainFontLocator):(y.ULS.sendTraceTag(537166815,0,10,"ConvertToLinkedEntityManager.IconFromDomainFontLocator: Requested domain that doesn't exist in collection"),null)};a.prototype.ufc=function(Ta){return this.X9?this.X9.GMg(Ta):!1};a.prototype.sIh=function(){return this.X9?this.X9.lJh():""};a.prototype.Aei=function(){return this.X9?this.X9.hBb:!1};a.prototype.dNh=function(Ta,pa){var Da=this.d9e(Ta);if(0>Da)y.ULS.sendTraceTag(537166813,
0,10,"Unexpected menuItemKey for dynamic preview gallery button: {0}",Ta);else if(Ta=(Ta=this.uIe(Ta))?this.fQ(Ta):null)pa[I.a.GalleryButtonProps]=this.t8a.dGh(Da,Ta),pa[I.a.Alt]=this.t8a.Wcd(Ta)};a.prototype.mSf=function(){this.hcg();this.syb()&&this.bYd(!0);this.f2b()};a.prototype.S7h=function(Ta){return Ta===this.lSe?J.a.kPe:Ta===this.tVe?J.a.iPe:J.a.hPe};a.prototype.lQe=function(Ta){try{return this.fQ(Ta).ExampleEntities}catch(pa){}return Ka.a.instance.ga(1780)};a.prototype.xrc=function(){(0>
this.DKa||this.POa)&&y.ULS.sendTraceTag(537166811,0,15,"RefreshFullGalleryIfOpened: Out of GetLinkedEntityServiceDomain retries");(2===this.Ur||0>this.DKa||this.POa)&&window.clearInterval(this.cdc);this.Tmd()?this.nbd&&this.$.frame.Qw(this.nbd):this.bYd(this.syb())};a.prototype.Bb=function(Ta){return this.$.yb+Ta};a.prototype.XRj=function(){var Ta=!0,pa=Array(this.INa),Da=N.a(this.$)?N.a(this.$).Ql:null;if(Da){for(var rb=0;rb<pa.length;++rb)this.Ewj(rb)?pa[rb]=!0:Ta=pa[rb]=!1;Da.AOd(["ConvertToLinkedEntityGallery"],
Ta);if(!Ta)for(Ta=0;Ta<pa.length;++Ta)pa[Ta]&&Da.AOd([this.cNh(Ta)],!0)}else y.ULS.sendTraceTag(537166809,0,15,"UpdateLinkedEntityGalleryButtonsVisibility: ribbonUser should not be null")};a.prototype.fQ=function(Ta){var pa=a.q1a(Ta);if(this.AU.kb(pa))return this.AU.na(pa);y.ULS.sendTraceTag(592729218,0,15,"No domain data for domain ID {0} (Has String ID: {1})",Ta.Id,!!Ta.StringId);return null};a.prototype.cNh=function(Ta){return"ConvertToLinkedEntityPreview"+Ta.toString()};a.prototype.TXd=function(){var Ta=
this;U.a.get_instance().ak(10,function(){Ta.jDe();Ta.lZc&&Ta.Ndf&&wc.b(Ta.ujf,Ta.$.la,500)})};a.prototype.Rcc=function(Ta,pa){switch(Ta){case "QueryLinkedEntityGalleryButtons":if(!pa[I.a.InnerHTML]){Ta=pa[Ea.a.Nc].toString();var Da=oa.a.equals(Ta,Ka.a.instance.ga(1775),!0)||oa.a.equals(Ta,Ka.a.instance.ga(1776),!0),rb=oa.a.equals(Ta,Ka.a.instance.ga(1777),!0);Da||rb||this.dNh(Ta,pa)}break;case "QueryLinkedEntityMenuGalleryButtons":pa[I.a.InnerHTML]||(pa[I.a.InnerHTML]=this.s1g(pa[Ea.a.Nc]))}return pa};
a.prototype.uhh=function(Ta){var pa=this.uIe(Ta);if(pa)return pa;if(pa=this.o6c(Ta))return pa.DomainId;y.ULS.sendTraceTag(537166805,0,10,"Could not convert key into domain: {0}",Ta);return null};a.prototype.tIe=function(Ta){var pa={};pa.Id=Ta;return this.fQ(pa)};a.prototype.o6c=function(Ta){return this.AU.kb(Ta)?this.AU.na(Ta):null};a.prototype.d9e=function(Ta){if(!Ta.startsWith(a.I6c))return-1;var pa=parseInt(Ta.substr(a.I6c.length),10);return isNaN(pa)?(y.ULS.sendTraceTag(537166802,0,10,"Unexpected index in preview gallery button key: {0}",
Ta),-1):pa};a.prototype.uIe=function(Ta){Ta=this.d9e(Ta);return 0>Ta?null:this.lia[Ta]};a.prototype.eaf=function(Ta,pa,Da){if(this.bzb&&this.AU&&this.AU.count){y.ULS.sendTraceTag(537166801,0,50,"ConvertToLinkedEntityManager.InvokeLinkedEntityTryAutoRefresh. ({0})",Ta);var rb=this.$.oa.xa.Pb();this.$.ea.dc&&(Ta=this.$.oa.xa,pa=Ia.b(this.bOi,pa),rb=Ta.Na(1,void 0===rb?null:rb),ea.g(Ta,"LinkedEntityTryAutoRefresh",rb,pa,Da,null,null,0))}};a.prototype.KMj=function(){this.eaf("Auto-refresh on load",null,
null)};a.prototype.OMj=function(){this.bzb&&this.AU&&this.AU.count&&(this.Rya?y.ULS.sendTraceTag(537166799,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. A periodic auto-refresh check context already exists. No need to create another one"):this.$.ea.lo.HasAutoRefreshableLinkedEntityDomainsEver?(y.ULS.sendTraceTag(537166797,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book has auto-refreshable domains. Creating periodic auto refresh check context"),
this.Rya=zb.a.instance.create(this.cZc,this.e0b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")):y.ULS.sendTraceTag(537166798,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book doesn't have any auto-refreshable domains. Periodic auto refresh check context will NOT be created"))};a.prototype.oyc=function(){if(this.$.ea.dc&&null!=this.y6a&&null!=this.Xod&&null!=this.Yod&&null!=this.Vqd&&null!=this.hqd)if(++this.jDb,12>=this.jDb){1===this.jDb&&(this.z4a=ma.a.Ta.Xd.m,
y.ULS.sendTraceTag(537166752,0,50,"StartLinkedEntityDelayedHandshake - starting handshake."));var Ta=this.$.oa.xa.Pb();Db.t(this.$.oa.xa,this.Ijf,this.Jjf(),this.dPi,this.cPi,null,Ta)}else y.ULS.sendTraceTag(537166751,0,15,"StartLinkedEntityDelayedHandshake - Retry count expired - failed handshake duration {0} ms",ma.a.Ta.Xd.m-this.z4a),this.POa=!0,this.xrc()};a.prototype.jxe=function(){var Ta=this;if(this.$.isEditMode)if(null!=this.y6a)this.oyc();else{var pa=ma.a.Ta.Xd.m,Da=[];M.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(rb){rb.isFeatureEnabled("ExcelPowerBiPro",
!1).then(function(Ab){y.ULS.sendTraceTag(537166747,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelPowerBiPro",ma.a.Ta.Xd.m-pa);y.ULS.sendTraceTag(537166746,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelPowerBiPro",Ab);return Ta.y6a=Ab}).then(function(){Da.push(rb.isFeatureEnabled("ExcelWolframAlpha",!1).then(function(Ab){y.ULS.sendTraceTag(590960588,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.",
"ExcelWolframAlpha",ma.a.Ta.Xd.m-pa);y.ULS.sendTraceTag(537166743,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelWolframAlpha",Ab);return Ta.Vqd=Ab}))}).then(function(){Da.push(rb.isFeatureEnabled("ExcelDisableStockGeographyDataTypes",!1).then(function(Ab){y.ULS.sendTraceTag(537166741,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelDisableStockGeographyDataTypes",ma.a.Ta.Xd.m-pa);y.ULS.sendTraceTag(537166740,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]",
"ExcelDisableStockGeographyDataTypes",Ab);var ob,sb=[(ob=new qb.a,ob.name="IsRestrictedByLicense",ob.bool=Ab,ob)];yb.a("SatoriStockGeographyLicensingRestrictions",void 0,void 0,sb);Ta.zgf=Ab&&La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StockGeographyLicensingCheck",!1);return Ab}))}).then(function(){Da.push(rb.isFeatureEnabled("StockHistory",!1).then(function(Ab){y.ULS.sendTraceTag(537166739,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","StockHistory",
ma.a.Ta.Xd.m-pa);y.ULS.sendTraceTag(537166738,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","StockHistory",Ab);return Ta.hqd=Ab}))}).then(function(){Da.push(rb.isFeatureEnabled("ExcelPowerBiFree",!1).then(function(Ab){y.ULS.sendTraceTag(537166736,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelPowerBiFree",ma.a.Ta.Xd.m-pa);y.ULS.sendTraceTag(537166735,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]",
"ExcelPowerBiFree",Ab);return Ta.Xod=Ab}))}).then(function(){Da.push(rb.isFeatureEnabled("ExcelPowerBiPremiumPerUser",!1).then(function(Ab){y.ULS.sendTraceTag(537166734,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelPowerBiPremiumPerUser",ma.a.Ta.Xd.m-pa);y.ULS.sendTraceTag(537166733,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelPowerBiPremiumPerUser",Ab);return Ta.Yod=Ab}))}).then(function(){Promise.all(Da).then(function(){Ta.oyc()})})})}};
a.prototype.OMf=function(){++this.pwb;if(12>=this.pwb){1===this.pwb&&(this.z4a=ma.a.Ta.Xd.m,y.ULS.sendTraceTag(570769946,0,50,"ConvertToLinkedEntityManager.RefreshHandshake - starting handshake refresh."));var Ta=this.$.oa.xa,pa=this.Ijf,Da=this.Jjf(),rb=this.oQi,Ab=this.nQi,ob=Ta.Na(1,null);ob.featureNames=pa;ob.isEnabledValues=Da;ea.g(Ta,"RefreshLinkedEntityWebServiceHandshake",ob,rb,Ab,null,null,4)}else y.ULS.sendTraceTag(570769945,0,15,"ConvertToLinkedEntityManager.RefreshHandshake - Retry count expired - failed handshake duration {0} ms",
ma.a.Ta.Xd.m-this.z4a),this.POa=!0,this.xrc()};a.prototype.Jjf=function(){return[this.y6a,this.Vqd,this.hqd,this.Xod,this.Yod,this.zgf]};a.prototype.bId=function(){this.businessBar&&this.businessBar.ULa(57)&&this.businessBar.removeEntry(57)};a.prototype.F2h=function(Ta){if(this.Fsd!==Ta&&this.businessBar)if(this.Fsd=Ta){Ta=this.$.oa.xa;var pa=this.aLi,Da=Ta.Na(1,null);ea.g(Ta,"GetErrorMessageForLinkedDataTypeRefresh",Da,pa,null,null,null,4)}else this.bId()};a.gFh=function(Ta,pa,Da,rb){Ta=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"></span>',
Ta,pa,rb);Da=String.format('<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}</p></div>',Da);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}</div>',Ta,Da)};a.q1a=function(Ta){return Ta.StringId?Ta.Id.toString()+"."+Ta.StringId:Ta.Id.toString()};Af.Object.defineProperties(a.prototype,{d6i:{configurable:!0,enumerable:!0,get:function(){return 5}},XGb:{configurable:!0,enumerable:!0,get:function(){return this.gK},
set:function(Ta){this.gK=Ta}},INa:{configurable:!0,enumerable:!0,get:function(){return this.lia.length}},Gzi:{configurable:!0,enumerable:!0,get:function(){return this.hae}},Ijf:{configurable:!0,enumerable:!0,get:function(){return"ExcelPowerBiPro ExcelWolframAlpha StockHistory ExcelPowerBiFree ExcelPowerBiPremiumPerUser ExcelDisableStockGeographyDataTypes".split(" ")}}});a.gJe="ConvertToLinkedEntityPreview";a.I6c="PreviewGalleryButtonIndex.";a.M7a=0;a.Xjf=2;Object(u.a)(a,"ConvertToLinkedEntityManager",
K.a,[955,956,10,957])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.le.js.map/6b64b984f77d33d44c17b1a5d6e35d9a/EwaDS.le.js.map